/*! For license information please see main.6f073e7f.js.LICENSE.txt */
(()=>{"use strict";var e={43:(e,t,n)=>{e.exports=n(202)},78:(e,t)=>{t.Lb=void 0;class n extends Error{constructor(){super("EmptyVectorError::the vectors being compared cannot be empty.")}}class r extends Error{constructor(){super("InvalidParameterType::the parameters must be arrays of numbers.")}}class o extends Error{constructor(){super("NotNumberVectorError::the vectors being compared must contain only numbers.")}}class a extends Error{constructor(){super("MissingVectorError::the vectors being compared must be provided.")}}class i extends Error{constructor(){super("ZeroVectorError::the vectors being compared cannot be all zeros.")}}t.Lb=(e,t)=>{let s=0,l=0,c=0;if(!e||!t)throw new a;if(!Array.isArray(e)||!Array.isArray(t))throw new r;if(!e.length||!t.length)throw new n;const u=Math.max(e.length,t.length);for(let n=0;n<u;n++){let r=e[n]||0,a=t[n]||0;if("number"!==typeof r||"number"!==typeof a)throw new o;s+=r*a,n<e.length&&(l+=e[n]*e[n]),n<t.length&&(c+=t[n]*t[n])}if(!l||!c)throw new i;return s/(Math.sqrt(l)*Math.sqrt(c))}},98:(e,t,n)=>{e.exports=n.p+"static/media/ort-wasm-simd-threaded.jsep.666d0398a1e13e9c0c1d.wasm"},153:(e,t,n)=>{var r=n(43),o=Symbol.for("react.element"),a=Symbol.for("react.fragment"),i=Object.prototype.hasOwnProperty,s=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,n){var r,a={},c=null,u=null;for(r in void 0!==n&&(c=""+n),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(u=t.ref),t)i.call(t,r)&&!l.hasOwnProperty(r)&&(a[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===a[r]&&(a[r]=t[r]);return{$$typeof:o,type:e,key:c,ref:u,props:a,_owner:s.current}}t.Fragment=a,t.jsx=c,t.jsxs=c},191:(e,t)=>{var n=Symbol.for("react.transitional.element"),r=Symbol.for("react.portal"),o=Symbol.for("react.fragment"),a=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),s=Symbol.for("react.consumer"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),d=Symbol.for("react.suspense_list"),p=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),f=Symbol.for("react.view_transition"),m=Symbol.for("react.client.reference");function g(e){if("object"===typeof e&&null!==e){var t=e.$$typeof;switch(t){case n:switch(e=e.type){case o:case i:case a:case u:case d:case f:return e;default:switch(e=e&&e.$$typeof){case l:case c:case h:case p:case s:return e;default:return t}}case r:return t}}}t.Hy=function(e){return"string"===typeof e||"function"===typeof e||e===o||e===i||e===a||e===u||e===d||"object"===typeof e&&null!==e&&(e.$$typeof===h||e.$$typeof===p||e.$$typeof===l||e.$$typeof===s||e.$$typeof===c||e.$$typeof===m||void 0!==e.getModuleId)}},202:(e,t)=>{var n=Symbol.for("react.element"),r=Symbol.for("react.portal"),o=Symbol.for("react.fragment"),a=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),h=Symbol.iterator;var f={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},m=Object.assign,g={};function _(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||f}function v(){}function y(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||f}_.prototype.isReactComponent={},_.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},_.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},v.prototype=_.prototype;var w=y.prototype=new v;w.constructor=y,m(w,_.prototype),w.isPureReactComponent=!0;var b=Array.isArray,x=Object.prototype.hasOwnProperty,k={current:null},C={key:!0,ref:!0,__self:!0,__source:!0};function D(e,t,r){var o,a={},i=null,s=null;if(null!=t)for(o in void 0!==t.ref&&(s=t.ref),void 0!==t.key&&(i=""+t.key),t)x.call(t,o)&&!C.hasOwnProperty(o)&&(a[o]=t[o]);var l=arguments.length-2;if(1===l)a.children=r;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];a.children=c}if(e&&e.defaultProps)for(o in l=e.defaultProps)void 0===a[o]&&(a[o]=l[o]);return{$$typeof:n,type:e,key:i,ref:s,props:a,_owner:k.current}}function S(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var E=/\/+/g;function T(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function A(e,t,o,a,i){var s=typeof e;"undefined"!==s&&"boolean"!==s||(e=null);var l=!1;if(null===e)l=!0;else switch(s){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case n:case r:l=!0}}if(l)return i=i(l=e),e=""===a?"."+T(l,0):a,b(i)?(o="",null!=e&&(o=e.replace(E,"$&/")+"/"),A(i,t,o,"",(function(e){return e}))):null!=i&&(S(i)&&(i=function(e,t){return{$$typeof:n,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(i,o+(!i.key||l&&l.key===i.key?"":(""+i.key).replace(E,"$&/")+"/")+e)),t.push(i)),1;if(l=0,a=""===a?".":a+":",b(e))for(var c=0;c<e.length;c++){var u=a+T(s=e[c],c);l+=A(s,t,o,u,i)}else if(u=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=h&&e[h]||e["@@iterator"])?e:null}(e),"function"===typeof u)for(e=u.call(e),c=0;!(s=e.next()).done;)l+=A(s=s.value,t,o,u=a+T(s,c++),i);else if("object"===s)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function M(e,t,n){if(null==e)return e;var r=[],o=0;return A(e,r,"","",(function(e){return t.call(n,e,o++)})),r}function F(e){if(-1===e._status){var t=e._result;(t=t()).then((function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)}),(function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)})),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var I={current:null},P={transition:null},z={ReactCurrentDispatcher:I,ReactCurrentBatchConfig:P,ReactCurrentOwner:k};function O(){throw Error("act(...) is not supported in production builds of React.")}t.Children={map:M,forEach:function(e,t,n){M(e,(function(){t.apply(this,arguments)}),n)},count:function(e){var t=0;return M(e,(function(){t++})),t},toArray:function(e){return M(e,(function(e){return e}))||[]},only:function(e){if(!S(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=_,t.Fragment=o,t.Profiler=i,t.PureComponent=y,t.StrictMode=a,t.Suspense=u,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=z,t.act=O,t.cloneElement=function(e,t,r){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var o=m({},e.props),a=e.key,i=e.ref,s=e._owner;if(null!=t){if(void 0!==t.ref&&(i=t.ref,s=k.current),void 0!==t.key&&(a=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)x.call(t,c)&&!C.hasOwnProperty(c)&&(o[c]=void 0===t[c]&&void 0!==l?l[c]:t[c])}var c=arguments.length-2;if(1===c)o.children=r;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];o.children=l}return{$$typeof:n,type:e.type,key:a,ref:i,props:o,_owner:s}},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:s,_context:e},e.Consumer=e},t.createElement=D,t.createFactory=function(e){var t=D.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=S,t.lazy=function(e){return{$$typeof:p,_payload:{_status:-1,_result:e},_init:F}},t.memo=function(e,t){return{$$typeof:d,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=P.transition;P.transition={};try{e()}finally{P.transition=t}},t.unstable_act=O,t.useCallback=function(e,t){return I.current.useCallback(e,t)},t.useContext=function(e){return I.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return I.current.useDeferredValue(e)},t.useEffect=function(e,t){return I.current.useEffect(e,t)},t.useId=function(){return I.current.useId()},t.useImperativeHandle=function(e,t,n){return I.current.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return I.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return I.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return I.current.useMemo(e,t)},t.useReducer=function(e,t,n){return I.current.useReducer(e,t,n)},t.useRef=function(e){return I.current.useRef(e)},t.useState=function(e){return I.current.useState(e)},t.useSyncExternalStore=function(e,t,n){return I.current.useSyncExternalStore(e,t,n)},t.useTransition=function(){return I.current.useTransition()},t.version="18.3.1"},234:(e,t)=>{function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var r=n-1>>>1,o=e[r];if(!(0<a(o,t)))break e;e[r]=t,e[n]=o,n=r}}function r(e){return 0===e.length?null:e[0]}function o(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,o=e.length,i=o>>>1;r<i;){var s=2*(r+1)-1,l=e[s],c=s+1,u=e[c];if(0>a(l,n))c<o&&0>a(u,l)?(e[r]=u,e[c]=n,r=c):(e[r]=l,e[s]=n,r=s);else{if(!(c<o&&0>a(u,n)))break e;e[r]=u,e[c]=n,r=c}}}return t}function a(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var i=performance;t.unstable_now=function(){return i.now()}}else{var s=Date,l=s.now();t.unstable_now=function(){return s.now()-l}}var c=[],u=[],d=1,p=null,h=3,f=!1,m=!1,g=!1,_="function"===typeof setTimeout?setTimeout:null,v="function"===typeof clearTimeout?clearTimeout:null,y="undefined"!==typeof setImmediate?setImmediate:null;function w(e){for(var t=r(u);null!==t;){if(null===t.callback)o(u);else{if(!(t.startTime<=e))break;o(u),t.sortIndex=t.expirationTime,n(c,t)}t=r(u)}}function b(e){if(g=!1,w(e),!m)if(null!==r(c))m=!0,P(x);else{var t=r(u);null!==t&&z(b,t.startTime-e)}}function x(e,n){m=!1,g&&(g=!1,v(S),S=-1),f=!0;var a=h;try{for(w(n),p=r(c);null!==p&&(!(p.expirationTime>n)||e&&!A());){var i=p.callback;if("function"===typeof i){p.callback=null,h=p.priorityLevel;var s=i(p.expirationTime<=n);n=t.unstable_now(),"function"===typeof s?p.callback=s:p===r(c)&&o(c),w(n)}else o(c);p=r(c)}if(null!==p)var l=!0;else{var d=r(u);null!==d&&z(b,d.startTime-n),l=!1}return l}finally{p=null,h=a,f=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var k,C=!1,D=null,S=-1,E=5,T=-1;function A(){return!(t.unstable_now()-T<E)}function M(){if(null!==D){var e=t.unstable_now();T=e;var n=!0;try{n=D(!0,e)}finally{n?k():(C=!1,D=null)}}else C=!1}if("function"===typeof y)k=function(){y(M)};else if("undefined"!==typeof MessageChannel){var F=new MessageChannel,I=F.port2;F.port1.onmessage=M,k=function(){I.postMessage(null)}}else k=function(){_(M,0)};function P(e){D=e,C||(C=!0,k())}function z(e,n){S=_((function(){e(t.unstable_now())}),n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){m||f||(m=!0,P(x))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):E=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return h},t.unstable_getFirstCallbackNode=function(){return r(c)},t.unstable_next=function(e){switch(h){case 1:case 2:case 3:var t=3;break;default:t=h}var n=h;h=t;try{return e()}finally{h=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=h;h=e;try{return t()}finally{h=n}},t.unstable_scheduleCallback=function(e,o,a){var i=t.unstable_now();switch("object"===typeof a&&null!==a?a="number"===typeof(a=a.delay)&&0<a?i+a:i:a=i,e){case 1:var s=-1;break;case 2:s=250;break;case 5:s=1073741823;break;case 4:s=1e4;break;default:s=5e3}return e={id:d++,callback:o,priorityLevel:e,startTime:a,expirationTime:s=a+s,sortIndex:-1},a>i?(e.sortIndex=a,n(u,e),null===r(c)&&e===r(u)&&(g?(v(S),S=-1):g=!0,z(b,a-i))):(e.sortIndex=s,n(c,e),m||f||(m=!0,P(x))),e},t.unstable_shouldYield=A,t.unstable_wrapCallback=function(e){var t=h;return function(){var n=h;h=t;try{return e.apply(this,arguments)}finally{h=n}}}},327:(e,t,n)=>{var r,o=Object.defineProperty,a=Object.getOwnPropertyDescriptor,i=Object.getOwnPropertyNames,s=Object.prototype.hasOwnProperty,l={};((e,t)=>{for(var n in t)o(e,n,{get:t[n],enumerable:!0})})(l,{getContext:()=>c.getContext,getVercelOidcToken:()=>u,getVercelOidcTokenSync:()=>d}),e.exports=(r=l,((e,t,n,r)=>{if(t&&"object"===typeof t||"function"===typeof t)for(let l of i(t))s.call(e,l)||l===n||o(e,l,{get:()=>t[l],enumerable:!(r=a(t,l))||r.enumerable});return e})(o({},"__esModule",{value:!0}),r));var c=n(812);async function u(){return""}function d(){return""}},330:(e,t,n)=>{var r=n(43);var o="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t},a=r.useState,i=r.useEffect,s=r.useLayoutEffect,l=r.useDebugValue;function c(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!o(e,n)}catch(r){return!0}}var u="undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement?function(e,t){return t()}:function(e,t){var n=t(),r=a({inst:{value:n,getSnapshot:t}}),o=r[0].inst,u=r[1];return s((function(){o.value=n,o.getSnapshot=t,c(o)&&u({inst:o})}),[e,n,t]),i((function(){return c(o)&&u({inst:o}),e((function(){c(o)&&u({inst:o})}))}),[e]),l(n),n};t.useSyncExternalStore=void 0!==r.useSyncExternalStore?r.useSyncExternalStore:u},391:(e,t,n)=>{var r=n(950);t.createRoot=r.createRoot,t.hydrateRoot=r.hydrateRoot},461:(e,t,n)=>{e.exports=n(330)},579:(e,t,n)=>{e.exports=n(153)},618:(e,t,n)=>{e.exports=n.p+"static/media/ort.bundle.min.e9b190b6e2b022d973ff.mjs"},730:(e,t,n)=>{var r=n(43),o=n(853);function a(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var i=new Set,s={};function l(e,t){c(e,t),c(e+"Capture",t)}function c(e,t){for(s[e]=t,e=0;e<t.length;e++)i.add(t[e])}var u=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),d=Object.prototype.hasOwnProperty,p=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,h={},f={};function m(e,t,n,r,o,a,i){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=r,this.attributeNamespace=o,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=a,this.removeEmptyString=i}var g={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){g[e]=new m(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];g[t]=new m(t,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){g[e]=new m(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){g[e]=new m(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){g[e]=new m(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){g[e]=new m(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){g[e]=new m(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){g[e]=new m(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){g[e]=new m(e,5,!1,e.toLowerCase(),null,!1,!1)}));var _=/[\-:]([a-z])/g;function v(e){return e[1].toUpperCase()}function y(e,t,n,r){var o=g.hasOwnProperty(t)?g[t]:null;(null!==o?0!==o.type:r||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,n,r){if(null===t||"undefined"===typeof t||function(e,t,n,r){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,r))return!0;if(r)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,o,r)&&(n=null),r||null===o?function(e){return!!d.call(f,e)||!d.call(h,e)&&(p.test(e)?f[e]=!0:(h[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):o.mustUseProperty?e[o.propertyName]=null===n?3!==o.type&&"":n:(t=o.attributeName,r=o.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(o=o.type)||4===o&&!0===n?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(_,v);g[t]=new m(t,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(_,v);g[t]=new m(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(_,v);g[t]=new m(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){g[e]=new m(e,1,!1,e.toLowerCase(),null,!1,!1)})),g.xlinkHref=new m("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){g[e]=new m(e,1,!1,e.toLowerCase(),null,!0,!0)}));var w=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,b=Symbol.for("react.element"),x=Symbol.for("react.portal"),k=Symbol.for("react.fragment"),C=Symbol.for("react.strict_mode"),D=Symbol.for("react.profiler"),S=Symbol.for("react.provider"),E=Symbol.for("react.context"),T=Symbol.for("react.forward_ref"),A=Symbol.for("react.suspense"),M=Symbol.for("react.suspense_list"),F=Symbol.for("react.memo"),I=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var P=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var z=Symbol.iterator;function O(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=z&&e[z]||e["@@iterator"])?e:null}var N,B=Object.assign;function j(e){if(void 0===N)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);N=t&&t[1]||""}return"\n"+N+e}var L=!1;function R(e,t){if(!e||L)return"";L=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var r=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){r=c}e.call(t.prototype)}else{try{throw Error()}catch(c){r=c}e()}}catch(c){if(c&&r&&"string"===typeof c.stack){for(var o=c.stack.split("\n"),a=r.stack.split("\n"),i=o.length-1,s=a.length-1;1<=i&&0<=s&&o[i]!==a[s];)s--;for(;1<=i&&0<=s;i--,s--)if(o[i]!==a[s]){if(1!==i||1!==s)do{if(i--,0>--s||o[i]!==a[s]){var l="\n"+o[i].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}}while(1<=i&&0<=s);break}}}finally{L=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?j(e):""}function V(e){switch(e.tag){case 5:return j(e.type);case 16:return j("Lazy");case 13:return j("Suspense");case 19:return j("SuspenseList");case 0:case 2:case 15:return e=R(e.type,!1);case 11:return e=R(e.type.render,!1);case 1:return e=R(e.type,!0);default:return""}}function q(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case k:return"Fragment";case x:return"Portal";case D:return"Profiler";case C:return"StrictMode";case A:return"Suspense";case M:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case E:return(e.displayName||"Context")+".Consumer";case S:return(e._context.displayName||"Context")+".Provider";case T:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case F:return null!==(t=e.displayName||null)?t:q(e.type)||"Memo";case I:t=e._payload,e=e._init;try{return q(e(t))}catch(n){}}return null}function U(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return q(t);case 8:return t===C?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function W(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function G(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function H(e){e._valueTracker||(e._valueTracker=function(e){var t=G(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var o=n.get,a=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return o.call(this)},set:function(e){r=""+e,a.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function K(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=G(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function Z(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function $(e,t){var n=t.checked;return B({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function X(e,t){var n=null==t.defaultValue?"":t.defaultValue,r=null!=t.checked?t.checked:t.defaultChecked;n=W(null!=t.value?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function J(e,t){null!=(t=t.checked)&&y(e,"checked",t,!1)}function Q(e,t){J(e,t);var n=W(t.value),r=t.type;if(null!=n)"number"===r?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===r||"reset"===r)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,n):t.hasOwnProperty("defaultValue")&&ee(e,t.type,W(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function Y(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!("submit"!==r&&"reset"!==r||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function ee(e,t,n){"number"===t&&Z(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var te=Array.isArray;function ne(e,t,n,r){if(e=e.options,t){t={};for(var o=0;o<n.length;o++)t["$"+n[o]]=!0;for(n=0;n<e.length;n++)o=t.hasOwnProperty("$"+e[n].value),e[n].selected!==o&&(e[n].selected=o),o&&r&&(e[n].defaultSelected=!0)}else{for(n=""+W(n),t=null,o=0;o<e.length;o++){if(e[o].value===n)return e[o].selected=!0,void(r&&(e[o].defaultSelected=!0));null!==t||e[o].disabled||(t=e[o])}null!==t&&(t.selected=!0)}}function re(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(a(91));return B({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function oe(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(a(92));if(te(n)){if(1<n.length)throw Error(a(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:W(n)}}function ae(e,t){var n=W(t.value),r=W(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=r&&(e.defaultValue=""+r)}function ie(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function se(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function le(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?se(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ce,ue=function(e){return"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(t,n,r,o){MSApp.execUnsafeLocalFunction((function(){return e(t,n)}))}:e}((function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((ce=ce||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ce.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}}));function de(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var pe={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},he=["Webkit","ms","Moz","O"];function fe(e,t,n){return null==t||"boolean"===typeof t||""===t?"":n||"number"!==typeof t||0===t||pe.hasOwnProperty(e)&&pe[e]?(""+t).trim():t+"px"}function me(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var r=0===n.indexOf("--"),o=fe(n,t[n],r);"float"===n&&(n="cssFloat"),r?e.setProperty(n,o):e[n]=o}}Object.keys(pe).forEach((function(e){he.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),pe[t]=pe[e]}))}));var ge=B({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function _e(e,t){if(t){if(ge[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(a(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(a(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(a(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(a(62))}}function ve(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ye=null;function we(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var be=null,xe=null,ke=null;function Ce(e){if(e=yo(e)){if("function"!==typeof be)throw Error(a(280));var t=e.stateNode;t&&(t=bo(t),be(e.stateNode,e.type,t))}}function De(e){xe?ke?ke.push(e):ke=[e]:xe=e}function Se(){if(xe){var e=xe,t=ke;if(ke=xe=null,Ce(e),t)for(e=0;e<t.length;e++)Ce(t[e])}}function Ee(e,t){return e(t)}function Te(){}var Ae=!1;function Me(e,t,n){if(Ae)return e(t,n);Ae=!0;try{return Ee(e,t,n)}finally{Ae=!1,(null!==xe||null!==ke)&&(Te(),Se())}}function Fe(e,t){var n=e.stateNode;if(null===n)return null;var r=bo(n);if(null===r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(a(231,t,typeof n));return n}var Ie=!1;if(u)try{var Pe={};Object.defineProperty(Pe,"passive",{get:function(){Ie=!0}}),window.addEventListener("test",Pe,Pe),window.removeEventListener("test",Pe,Pe)}catch(ou){Ie=!1}function ze(e,t,n,r,o,a,i,s,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(n,c)}catch(js){this.onError(js)}}var Oe=!1,Ne=null,Be=!1,je=null,Le={onError:function(e){Oe=!0,Ne=e}};function Re(e,t,n,r,o,a,i,s,l){Oe=!1,Ne=null,ze.apply(Le,arguments)}function Ve(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function qe(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function Ue(e){if(Ve(e)!==e)throw Error(a(188))}function We(e){return e=function(e){var t=e.alternate;if(!t){if(null===(t=Ve(e)))throw Error(a(188));return t!==e?null:e}for(var n=e,r=t;;){var o=n.return;if(null===o)break;var i=o.alternate;if(null===i){if(null!==(r=o.return)){n=r;continue}break}if(o.child===i.child){for(i=o.child;i;){if(i===n)return Ue(o),e;if(i===r)return Ue(o),t;i=i.sibling}throw Error(a(188))}if(n.return!==r.return)n=o,r=i;else{for(var s=!1,l=o.child;l;){if(l===n){s=!0,n=o,r=i;break}if(l===r){s=!0,r=o,n=i;break}l=l.sibling}if(!s){for(l=i.child;l;){if(l===n){s=!0,n=i,r=o;break}if(l===r){s=!0,r=i,n=o;break}l=l.sibling}if(!s)throw Error(a(189))}}if(n.alternate!==r)throw Error(a(190))}if(3!==n.tag)throw Error(a(188));return n.stateNode.current===n?e:t}(e),null!==e?Ge(e):null}function Ge(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=Ge(e);if(null!==t)return t;e=e.sibling}return null}var He=o.unstable_scheduleCallback,Ke=o.unstable_cancelCallback,Ze=o.unstable_shouldYield,$e=o.unstable_requestPaint,Xe=o.unstable_now,Je=o.unstable_getCurrentPriorityLevel,Qe=o.unstable_ImmediatePriority,Ye=o.unstable_UserBlockingPriority,et=o.unstable_NormalPriority,tt=o.unstable_LowPriority,nt=o.unstable_IdlePriority,rt=null,ot=null;var at=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(it(e)/st|0)|0},it=Math.log,st=Math.LN2;var lt=64,ct=4194304;function ut(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function dt(e,t){var n=e.pendingLanes;if(0===n)return 0;var r=0,o=e.suspendedLanes,a=e.pingedLanes,i=268435455&n;if(0!==i){var s=i&~o;0!==s?r=ut(s):0!==(a&=i)&&(r=ut(a))}else 0!==(i=n&~o)?r=ut(i):0!==a&&(r=ut(a));if(0===r)return 0;if(0!==t&&t!==r&&0===(t&o)&&((o=r&-r)>=(a=t&-t)||16===o&&0!==(4194240&a)))return t;if(0!==(4&r)&&(r|=16&n),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=r;0<t;)o=1<<(n=31-at(t)),r|=e[n],t&=~o;return r}function pt(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function ht(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function ft(){var e=lt;return 0===(4194240&(lt<<=1))&&(lt=64),e}function mt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function gt(e,t,n){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-at(t)]=n}function _t(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-at(n),o=1<<r;o&t|e[r]&t&&(e[r]|=t),n&=~o}}var vt=0;function yt(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var wt,bt,xt,kt,Ct,Dt=!1,St=[],Et=null,Tt=null,At=null,Mt=new Map,Ft=new Map,It=[],Pt="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function zt(e,t){switch(e){case"focusin":case"focusout":Et=null;break;case"dragenter":case"dragleave":Tt=null;break;case"mouseover":case"mouseout":At=null;break;case"pointerover":case"pointerout":Mt.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ft.delete(t.pointerId)}}function Ot(e,t,n,r,o,a){return null===e||e.nativeEvent!==a?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:a,targetContainers:[o]},null!==t&&(null!==(t=yo(t))&&bt(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==o&&-1===t.indexOf(o)&&t.push(o),e)}function Nt(e){var t=vo(e.target);if(null!==t){var n=Ve(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=qe(n)))return e.blockedOn=t,void Ct(e.priority,(function(){xt(n)}))}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function Bt(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Zt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=yo(n))&&bt(t),e.blockedOn=n,!1;var r=new(n=e.nativeEvent).constructor(n.type,n);ye=r,n.target.dispatchEvent(r),ye=null,t.shift()}return!0}function jt(e,t,n){Bt(e)&&n.delete(t)}function Lt(){Dt=!1,null!==Et&&Bt(Et)&&(Et=null),null!==Tt&&Bt(Tt)&&(Tt=null),null!==At&&Bt(At)&&(At=null),Mt.forEach(jt),Ft.forEach(jt)}function Rt(e,t){e.blockedOn===t&&(e.blockedOn=null,Dt||(Dt=!0,o.unstable_scheduleCallback(o.unstable_NormalPriority,Lt)))}function Vt(e){function t(t){return Rt(t,e)}if(0<St.length){Rt(St[0],e);for(var n=1;n<St.length;n++){var r=St[n];r.blockedOn===e&&(r.blockedOn=null)}}for(null!==Et&&Rt(Et,e),null!==Tt&&Rt(Tt,e),null!==At&&Rt(At,e),Mt.forEach(t),Ft.forEach(t),n=0;n<It.length;n++)(r=It[n]).blockedOn===e&&(r.blockedOn=null);for(;0<It.length&&null===(n=It[0]).blockedOn;)Nt(n),null===n.blockedOn&&It.shift()}var qt=w.ReactCurrentBatchConfig,Ut=!0;function Wt(e,t,n,r){var o=vt,a=qt.transition;qt.transition=null;try{vt=1,Ht(e,t,n,r)}finally{vt=o,qt.transition=a}}function Gt(e,t,n,r){var o=vt,a=qt.transition;qt.transition=null;try{vt=4,Ht(e,t,n,r)}finally{vt=o,qt.transition=a}}function Ht(e,t,n,r){if(Ut){var o=Zt(e,t,n,r);if(null===o)Ur(e,t,r,Kt,n),zt(e,r);else if(function(e,t,n,r,o){switch(t){case"focusin":return Et=Ot(Et,e,t,n,r,o),!0;case"dragenter":return Tt=Ot(Tt,e,t,n,r,o),!0;case"mouseover":return At=Ot(At,e,t,n,r,o),!0;case"pointerover":var a=o.pointerId;return Mt.set(a,Ot(Mt.get(a)||null,e,t,n,r,o)),!0;case"gotpointercapture":return a=o.pointerId,Ft.set(a,Ot(Ft.get(a)||null,e,t,n,r,o)),!0}return!1}(o,e,t,n,r))r.stopPropagation();else if(zt(e,r),4&t&&-1<Pt.indexOf(e)){for(;null!==o;){var a=yo(o);if(null!==a&&wt(a),null===(a=Zt(e,t,n,r))&&Ur(e,t,r,Kt,n),a===o)break;o=a}null!==o&&r.stopPropagation()}else Ur(e,t,r,null,n)}}var Kt=null;function Zt(e,t,n,r){if(Kt=null,null!==(e=vo(e=we(r))))if(null===(t=Ve(e)))e=null;else if(13===(n=t.tag)){if(null!==(e=qe(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Kt=e,null}function $t(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Je()){case Qe:return 1;case Ye:return 4;case et:case tt:return 16;case nt:return 536870912;default:return 16}default:return 16}}var Xt=null,Jt=null,Qt=null;function Yt(){if(Qt)return Qt;var e,t,n=Jt,r=n.length,o="value"in Xt?Xt.value:Xt.textContent,a=o.length;for(e=0;e<r&&n[e]===o[e];e++);var i=r-e;for(t=1;t<=i&&n[r-t]===o[a-t];t++);return Qt=o.slice(e,1<t?1-t:void 0)}function en(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function tn(){return!0}function nn(){return!1}function rn(e){function t(t,n,r,o,a){for(var i in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=o,this.target=a,this.currentTarget=null,e)e.hasOwnProperty(i)&&(t=e[i],this[i]=t?t(o):o[i]);return this.isDefaultPrevented=(null!=o.defaultPrevented?o.defaultPrevented:!1===o.returnValue)?tn:nn,this.isPropagationStopped=nn,this}return B(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=tn)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=tn)},persist:function(){},isPersistent:tn}),t}var on,an,sn,ln={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},cn=rn(ln),un=B({},ln,{view:0,detail:0}),dn=rn(un),pn=B({},un,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Cn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==sn&&(sn&&"mousemove"===e.type?(on=e.screenX-sn.screenX,an=e.screenY-sn.screenY):an=on=0,sn=e),on)},movementY:function(e){return"movementY"in e?e.movementY:an}}),hn=rn(pn),fn=rn(B({},pn,{dataTransfer:0})),mn=rn(B({},un,{relatedTarget:0})),gn=rn(B({},ln,{animationName:0,elapsedTime:0,pseudoElement:0})),_n=B({},ln,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),vn=rn(_n),yn=rn(B({},ln,{data:0})),wn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},bn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},xn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function kn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=xn[e])&&!!t[e]}function Cn(){return kn}var Dn=B({},un,{key:function(e){if(e.key){var t=wn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=en(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?bn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Cn,charCode:function(e){return"keypress"===e.type?en(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?en(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),Sn=rn(Dn),En=rn(B({},pn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Tn=rn(B({},un,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Cn})),An=rn(B({},ln,{propertyName:0,elapsedTime:0,pseudoElement:0})),Mn=B({},pn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Fn=rn(Mn),In=[9,13,27,32],Pn=u&&"CompositionEvent"in window,zn=null;u&&"documentMode"in document&&(zn=document.documentMode);var On=u&&"TextEvent"in window&&!zn,Nn=u&&(!Pn||zn&&8<zn&&11>=zn),Bn=String.fromCharCode(32),jn=!1;function Ln(e,t){switch(e){case"keyup":return-1!==In.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Rn(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Vn=!1;var qn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Un(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!qn[e.type]:"textarea"===t}function Wn(e,t,n,r){De(r),0<(t=Gr(t,"onChange")).length&&(n=new cn("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Gn=null,Hn=null;function Kn(e){Br(e,0)}function Zn(e){if(K(wo(e)))return e}function $n(e,t){if("change"===e)return t}var Xn=!1;if(u){var Jn;if(u){var Qn="oninput"in document;if(!Qn){var Yn=document.createElement("div");Yn.setAttribute("oninput","return;"),Qn="function"===typeof Yn.oninput}Jn=Qn}else Jn=!1;Xn=Jn&&(!document.documentMode||9<document.documentMode)}function er(){Gn&&(Gn.detachEvent("onpropertychange",tr),Hn=Gn=null)}function tr(e){if("value"===e.propertyName&&Zn(Hn)){var t=[];Wn(t,Hn,e,we(e)),Me(Kn,t)}}function nr(e,t,n){"focusin"===e?(er(),Hn=n,(Gn=t).attachEvent("onpropertychange",tr)):"focusout"===e&&er()}function rr(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Zn(Hn)}function or(e,t){if("click"===e)return Zn(t)}function ar(e,t){if("input"===e||"change"===e)return Zn(t)}var ir="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function sr(e,t){if(ir(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var o=n[r];if(!d.call(t,o)||!ir(e[o],t[o]))return!1}return!0}function lr(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function cr(e,t){var n,r=lr(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=lr(r)}}function ur(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?ur(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function dr(){for(var e=window,t=Z();t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(r){n=!1}if(!n)break;t=Z((e=t.contentWindow).document)}return t}function pr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function hr(e){var t=dr(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&ur(n.ownerDocument.documentElement,n)){if(null!==r&&pr(n))if(t=r.start,void 0===(e=r.end)&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if((e=(t=n.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var o=n.textContent.length,a=Math.min(r.start,o);r=void 0===r.end?a:Math.min(r.end,o),!e.extend&&a>r&&(o=r,r=a,a=o),o=cr(n,a);var i=cr(n,r);o&&i&&(1!==e.rangeCount||e.anchorNode!==o.node||e.anchorOffset!==o.offset||e.focusNode!==i.node||e.focusOffset!==i.offset)&&((t=t.createRange()).setStart(o.node,o.offset),e.removeAllRanges(),a>r?(e.addRange(t),e.extend(i.node,i.offset)):(t.setEnd(i.node,i.offset),e.addRange(t)))}for(t=[],e=n;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof n.focus&&n.focus(),n=0;n<t.length;n++)(e=t[n]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var fr=u&&"documentMode"in document&&11>=document.documentMode,mr=null,gr=null,_r=null,vr=!1;function yr(e,t,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;vr||null==mr||mr!==Z(r)||("selectionStart"in(r=mr)&&pr(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},_r&&sr(_r,r)||(_r=r,0<(r=Gr(gr,"onSelect")).length&&(t=new cn("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=mr)))}function wr(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var br={animationend:wr("Animation","AnimationEnd"),animationiteration:wr("Animation","AnimationIteration"),animationstart:wr("Animation","AnimationStart"),transitionend:wr("Transition","TransitionEnd")},xr={},kr={};function Cr(e){if(xr[e])return xr[e];if(!br[e])return e;var t,n=br[e];for(t in n)if(n.hasOwnProperty(t)&&t in kr)return xr[e]=n[t];return e}u&&(kr=document.createElement("div").style,"AnimationEvent"in window||(delete br.animationend.animation,delete br.animationiteration.animation,delete br.animationstart.animation),"TransitionEvent"in window||delete br.transitionend.transition);var Dr=Cr("animationend"),Sr=Cr("animationiteration"),Er=Cr("animationstart"),Tr=Cr("transitionend"),Ar=new Map,Mr="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Fr(e,t){Ar.set(e,t),l(t,[e])}for(var Ir=0;Ir<Mr.length;Ir++){var Pr=Mr[Ir];Fr(Pr.toLowerCase(),"on"+(Pr[0].toUpperCase()+Pr.slice(1)))}Fr(Dr,"onAnimationEnd"),Fr(Sr,"onAnimationIteration"),Fr(Er,"onAnimationStart"),Fr("dblclick","onDoubleClick"),Fr("focusin","onFocus"),Fr("focusout","onBlur"),Fr(Tr,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var zr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Or=new Set("cancel close invalid load scroll toggle".split(" ").concat(zr));function Nr(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,r,o,i,s,l,c){if(Re.apply(this,arguments),Oe){if(!Oe)throw Error(a(198));var u=Ne;Oe=!1,Ne=null,Be||(Be=!0,je=u)}}(r,t,void 0,e),e.currentTarget=null}function Br(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var r=e[n],o=r.event;r=r.listeners;e:{var a=void 0;if(t)for(var i=r.length-1;0<=i;i--){var s=r[i],l=s.instance,c=s.currentTarget;if(s=s.listener,l!==a&&o.isPropagationStopped())break e;Nr(o,s,c),a=l}else for(i=0;i<r.length;i++){if(l=(s=r[i]).instance,c=s.currentTarget,s=s.listener,l!==a&&o.isPropagationStopped())break e;Nr(o,s,c),a=l}}}if(Be)throw e=je,Be=!1,je=null,e}function jr(e,t){var n=t[mo];void 0===n&&(n=t[mo]=new Set);var r=e+"__bubble";n.has(r)||(qr(t,e,2,!1),n.add(r))}function Lr(e,t,n){var r=0;t&&(r|=4),qr(n,e,r,t)}var Rr="_reactListening"+Math.random().toString(36).slice(2);function Vr(e){if(!e[Rr]){e[Rr]=!0,i.forEach((function(t){"selectionchange"!==t&&(Or.has(t)||Lr(t,!1,e),Lr(t,!0,e))}));var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Rr]||(t[Rr]=!0,Lr("selectionchange",!1,t))}}function qr(e,t,n,r){switch($t(t)){case 1:var o=Wt;break;case 4:o=Gt;break;default:o=Ht}n=o.bind(null,t,n,e),o=void 0,!Ie||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(o=!0),r?void 0!==o?e.addEventListener(t,n,{capture:!0,passive:o}):e.addEventListener(t,n,!0):void 0!==o?e.addEventListener(t,n,{passive:o}):e.addEventListener(t,n,!1)}function Ur(e,t,n,r,o){var a=r;if(0===(1&t)&&0===(2&t)&&null!==r)e:for(;;){if(null===r)return;var i=r.tag;if(3===i||4===i){var s=r.stateNode.containerInfo;if(s===o||8===s.nodeType&&s.parentNode===o)break;if(4===i)for(i=r.return;null!==i;){var l=i.tag;if((3===l||4===l)&&((l=i.stateNode.containerInfo)===o||8===l.nodeType&&l.parentNode===o))return;i=i.return}for(;null!==s;){if(null===(i=vo(s)))return;if(5===(l=i.tag)||6===l){r=a=i;continue e}s=s.parentNode}}r=r.return}Me((function(){var r=a,o=we(n),i=[];e:{var s=Ar.get(e);if(void 0!==s){var l=cn,c=e;switch(e){case"keypress":if(0===en(n))break e;case"keydown":case"keyup":l=Sn;break;case"focusin":c="focus",l=mn;break;case"focusout":c="blur",l=mn;break;case"beforeblur":case"afterblur":l=mn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=hn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=fn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=Tn;break;case Dr:case Sr:case Er:l=gn;break;case Tr:l=An;break;case"scroll":l=dn;break;case"wheel":l=Fn;break;case"copy":case"cut":case"paste":l=vn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=En}var u=0!==(4&t),d=!u&&"scroll"===e,p=u?null!==s?s+"Capture":null:s;u=[];for(var h,f=r;null!==f;){var m=(h=f).stateNode;if(5===h.tag&&null!==m&&(h=m,null!==p&&(null!=(m=Fe(f,p))&&u.push(Wr(f,m,h)))),d)break;f=f.return}0<u.length&&(s=new l(s,c,null,n,o),i.push({event:s,listeners:u}))}}if(0===(7&t)){if(l="mouseout"===e||"pointerout"===e,(!(s="mouseover"===e||"pointerover"===e)||n===ye||!(c=n.relatedTarget||n.fromElement)||!vo(c)&&!c[fo])&&(l||s)&&(s=o.window===o?o:(s=o.ownerDocument)?s.defaultView||s.parentWindow:window,l?(l=r,null!==(c=(c=n.relatedTarget||n.toElement)?vo(c):null)&&(c!==(d=Ve(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(l=null,c=r),l!==c)){if(u=hn,m="onMouseLeave",p="onMouseEnter",f="mouse","pointerout"!==e&&"pointerover"!==e||(u=En,m="onPointerLeave",p="onPointerEnter",f="pointer"),d=null==l?s:wo(l),h=null==c?s:wo(c),(s=new u(m,f+"leave",l,n,o)).target=d,s.relatedTarget=h,m=null,vo(o)===r&&((u=new u(p,f+"enter",c,n,o)).target=h,u.relatedTarget=d,m=u),d=m,l&&c)e:{for(p=c,f=0,h=u=l;h;h=Hr(h))f++;for(h=0,m=p;m;m=Hr(m))h++;for(;0<f-h;)u=Hr(u),f--;for(;0<h-f;)p=Hr(p),h--;for(;f--;){if(u===p||null!==p&&u===p.alternate)break e;u=Hr(u),p=Hr(p)}u=null}else u=null;null!==l&&Kr(i,s,l,u,!1),null!==c&&null!==d&&Kr(i,d,c,u,!0)}if("select"===(l=(s=r?wo(r):window).nodeName&&s.nodeName.toLowerCase())||"input"===l&&"file"===s.type)var g=$n;else if(Un(s))if(Xn)g=ar;else{g=rr;var _=nr}else(l=s.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===s.type||"radio"===s.type)&&(g=or);switch(g&&(g=g(e,r))?Wn(i,g,n,o):(_&&_(e,s,r),"focusout"===e&&(_=s._wrapperState)&&_.controlled&&"number"===s.type&&ee(s,"number",s.value)),_=r?wo(r):window,e){case"focusin":(Un(_)||"true"===_.contentEditable)&&(mr=_,gr=r,_r=null);break;case"focusout":_r=gr=mr=null;break;case"mousedown":vr=!0;break;case"contextmenu":case"mouseup":case"dragend":vr=!1,yr(i,n,o);break;case"selectionchange":if(fr)break;case"keydown":case"keyup":yr(i,n,o)}var v;if(Pn)e:{switch(e){case"compositionstart":var y="onCompositionStart";break e;case"compositionend":y="onCompositionEnd";break e;case"compositionupdate":y="onCompositionUpdate";break e}y=void 0}else Vn?Ln(e,n)&&(y="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(y="onCompositionStart");y&&(Nn&&"ko"!==n.locale&&(Vn||"onCompositionStart"!==y?"onCompositionEnd"===y&&Vn&&(v=Yt()):(Jt="value"in(Xt=o)?Xt.value:Xt.textContent,Vn=!0)),0<(_=Gr(r,y)).length&&(y=new yn(y,e,null,n,o),i.push({event:y,listeners:_}),v?y.data=v:null!==(v=Rn(n))&&(y.data=v))),(v=On?function(e,t){switch(e){case"compositionend":return Rn(t);case"keypress":return 32!==t.which?null:(jn=!0,Bn);case"textInput":return(e=t.data)===Bn&&jn?null:e;default:return null}}(e,n):function(e,t){if(Vn)return"compositionend"===e||!Pn&&Ln(e,t)?(e=Yt(),Qt=Jt=Xt=null,Vn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Nn&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(r=Gr(r,"onBeforeInput")).length&&(o=new yn("onBeforeInput","beforeinput",null,n,o),i.push({event:o,listeners:r}),o.data=v))}Br(i,t)}))}function Wr(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Gr(e,t){for(var n=t+"Capture",r=[];null!==e;){var o=e,a=o.stateNode;5===o.tag&&null!==a&&(o=a,null!=(a=Fe(e,n))&&r.unshift(Wr(e,a,o)),null!=(a=Fe(e,t))&&r.push(Wr(e,a,o))),e=e.return}return r}function Hr(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Kr(e,t,n,r,o){for(var a=t._reactName,i=[];null!==n&&n!==r;){var s=n,l=s.alternate,c=s.stateNode;if(null!==l&&l===r)break;5===s.tag&&null!==c&&(s=c,o?null!=(l=Fe(n,a))&&i.unshift(Wr(n,l,s)):o||null!=(l=Fe(n,a))&&i.push(Wr(n,l,s))),n=n.return}0!==i.length&&e.push({event:t,listeners:i})}var Zr=/\r\n?/g,$r=/\u0000|\uFFFD/g;function Xr(e){return("string"===typeof e?e:""+e).replace(Zr,"\n").replace($r,"")}function Jr(e,t,n){if(t=Xr(t),Xr(e)!==t&&n)throw Error(a(425))}function Qr(){}var Yr=null,eo=null;function to(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var no="function"===typeof setTimeout?setTimeout:void 0,ro="function"===typeof clearTimeout?clearTimeout:void 0,oo="function"===typeof Promise?Promise:void 0,ao="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof oo?function(e){return oo.resolve(null).then(e).catch(io)}:no;function io(e){setTimeout((function(){throw e}))}function so(e,t){var n=t,r=0;do{var o=n.nextSibling;if(e.removeChild(n),o&&8===o.nodeType)if("/$"===(n=o.data)){if(0===r)return e.removeChild(o),void Vt(t);r--}else"$"!==n&&"$?"!==n&&"$!"!==n||r++;n=o}while(n);Vt(t)}function lo(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function co(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var uo=Math.random().toString(36).slice(2),po="__reactFiber$"+uo,ho="__reactProps$"+uo,fo="__reactContainer$"+uo,mo="__reactEvents$"+uo,go="__reactListeners$"+uo,_o="__reactHandles$"+uo;function vo(e){var t=e[po];if(t)return t;for(var n=e.parentNode;n;){if(t=n[fo]||n[po]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=co(e);null!==e;){if(n=e[po])return n;e=co(e)}return t}n=(e=n).parentNode}return null}function yo(e){return!(e=e[po]||e[fo])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function wo(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(a(33))}function bo(e){return e[ho]||null}var xo=[],ko=-1;function Co(e){return{current:e}}function Do(e){0>ko||(e.current=xo[ko],xo[ko]=null,ko--)}function So(e,t){ko++,xo[ko]=e.current,e.current=t}var Eo={},To=Co(Eo),Ao=Co(!1),Mo=Eo;function Fo(e,t){var n=e.type.contextTypes;if(!n)return Eo;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var o,a={};for(o in n)a[o]=t[o];return r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function Io(e){return null!==(e=e.childContextTypes)&&void 0!==e}function Po(){Do(Ao),Do(To)}function zo(e,t,n){if(To.current!==Eo)throw Error(a(168));So(To,t),So(Ao,n)}function Oo(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,"function"!==typeof r.getChildContext)return n;for(var o in r=r.getChildContext())if(!(o in t))throw Error(a(108,U(e)||"Unknown",o));return B({},n,r)}function No(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Eo,Mo=To.current,So(To,e),So(Ao,Ao.current),!0}function Bo(e,t,n){var r=e.stateNode;if(!r)throw Error(a(169));n?(e=Oo(e,t,Mo),r.__reactInternalMemoizedMergedChildContext=e,Do(Ao),Do(To),So(To,e)):Do(Ao),So(Ao,n)}var jo=null,Lo=!1,Ro=!1;function Vo(e){null===jo?jo=[e]:jo.push(e)}function qo(){if(!Ro&&null!==jo){Ro=!0;var e=0,t=vt;try{var n=jo;for(vt=1;e<n.length;e++){var r=n[e];do{r=r(!0)}while(null!==r)}jo=null,Lo=!1}catch(AC){throw null!==jo&&(jo=jo.slice(e+1)),He(Qe,qo),AC}finally{vt=t,Ro=!1}}return null}var Uo=[],Wo=0,Go=null,Ho=0,Ko=[],Zo=0,$o=null,Xo=1,Jo="";function Qo(e,t){Uo[Wo++]=Ho,Uo[Wo++]=Go,Go=e,Ho=t}function Yo(e,t,n){Ko[Zo++]=Xo,Ko[Zo++]=Jo,Ko[Zo++]=$o,$o=e;var r=Xo;e=Jo;var o=32-at(r)-1;r&=~(1<<o),n+=1;var a=32-at(t)+o;if(30<a){var i=o-o%5;a=(r&(1<<i)-1).toString(32),r>>=i,o-=i,Xo=1<<32-at(t)+o|n<<o|r,Jo=a+e}else Xo=1<<a|n<<o|r,Jo=e}function ea(e){null!==e.return&&(Qo(e,1),Yo(e,1,0))}function ta(e){for(;e===Go;)Go=Uo[--Wo],Uo[Wo]=null,Ho=Uo[--Wo],Uo[Wo]=null;for(;e===$o;)$o=Ko[--Zo],Ko[Zo]=null,Jo=Ko[--Zo],Ko[Zo]=null,Xo=Ko[--Zo],Ko[Zo]=null}var na=null,ra=null,oa=!1,aa=null;function ia(e,t){var n=Fc(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,null===(t=e.deletions)?(e.deletions=[n],e.flags|=16):t.push(n)}function sa(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,na=e,ra=lo(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,na=e,ra=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(n=null!==$o?{id:Xo,overflow:Jo}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},(n=Fc(18,null,null,0)).stateNode=t,n.return=e,e.child=n,na=e,ra=null,!0);default:return!1}}function la(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function ca(e){if(oa){var t=ra;if(t){var n=t;if(!sa(e,t)){if(la(e))throw Error(a(418));t=lo(n.nextSibling);var r=na;t&&sa(e,t)?ia(r,n):(e.flags=-4097&e.flags|2,oa=!1,na=e)}}else{if(la(e))throw Error(a(418));e.flags=-4097&e.flags|2,oa=!1,na=e}}}function ua(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;na=e}function da(e){if(e!==na)return!1;if(!oa)return ua(e),oa=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!to(e.type,e.memoizedProps)),t&&(t=ra)){if(la(e))throw pa(),Error(a(418));for(;t;)ia(e,t),t=lo(t.nextSibling)}if(ua(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(a(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){ra=lo(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}ra=null}}else ra=na?lo(e.stateNode.nextSibling):null;return!0}function pa(){for(var e=ra;e;)e=lo(e.nextSibling)}function ha(){ra=na=null,oa=!1}function fa(e){null===aa?aa=[e]:aa.push(e)}var ma=w.ReactCurrentBatchConfig;function ga(e,t,n){if(null!==(e=n.ref)&&"function"!==typeof e&&"object"!==typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(a(309));var r=n.stateNode}if(!r)throw Error(a(147,e));var o=r,i=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===i?t.ref:(t=function(e){var t=o.refs;null===e?delete t[i]:t[i]=e},t._stringRef=i,t)}if("string"!==typeof e)throw Error(a(284));if(!n._owner)throw Error(a(290,e))}return e}function _a(e,t){throw e=Object.prototype.toString.call(t),Error(a(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function va(e){return(0,e._init)(e._payload)}function ya(e){function t(t,n){if(e){var r=t.deletions;null===r?(t.deletions=[n],t.flags|=16):r.push(n)}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function o(e,t){return(e=Pc(e,t)).index=0,e.sibling=null,e}function i(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags|=2,n):r:(t.flags|=2,n):(t.flags|=1048576,n)}function s(t){return e&&null===t.alternate&&(t.flags|=2),t}function l(e,t,n,r){return null===t||6!==t.tag?((t=Bc(n,e.mode,r)).return=e,t):((t=o(t,n)).return=e,t)}function c(e,t,n,r){var a=n.type;return a===k?d(e,t,n.props.children,r,n.key):null!==t&&(t.elementType===a||"object"===typeof a&&null!==a&&a.$$typeof===I&&va(a)===t.type)?((r=o(t,n.props)).ref=ga(e,t,n),r.return=e,r):((r=zc(n.type,n.key,n.props,null,e.mode,r)).ref=ga(e,t,n),r.return=e,r)}function u(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=jc(n,e.mode,r)).return=e,t):((t=o(t,n.children||[])).return=e,t)}function d(e,t,n,r,a){return null===t||7!==t.tag?((t=Oc(n,e.mode,r,a)).return=e,t):((t=o(t,n)).return=e,t)}function p(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=Bc(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case b:return(n=zc(t.type,t.key,t.props,null,e.mode,n)).ref=ga(e,null,t),n.return=e,n;case x:return(t=jc(t,e.mode,n)).return=e,t;case I:return p(e,(0,t._init)(t._payload),n)}if(te(t)||O(t))return(t=Oc(t,e.mode,n,null)).return=e,t;_a(e,t)}return null}function h(e,t,n,r){var o=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n)return null!==o?null:l(e,t,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case b:return n.key===o?c(e,t,n,r):null;case x:return n.key===o?u(e,t,n,r):null;case I:return h(e,t,(o=n._init)(n._payload),r)}if(te(n)||O(n))return null!==o?null:d(e,t,n,r,null);_a(e,n)}return null}function f(e,t,n,r,o){if("string"===typeof r&&""!==r||"number"===typeof r)return l(t,e=e.get(n)||null,""+r,o);if("object"===typeof r&&null!==r){switch(r.$$typeof){case b:return c(t,e=e.get(null===r.key?n:r.key)||null,r,o);case x:return u(t,e=e.get(null===r.key?n:r.key)||null,r,o);case I:return f(e,t,n,(0,r._init)(r._payload),o)}if(te(r)||O(r))return d(t,e=e.get(n)||null,r,o,null);_a(t,r)}return null}function m(o,a,s,l){for(var c=null,u=null,d=a,m=a=0,g=null;null!==d&&m<s.length;m++){d.index>m?(g=d,d=null):g=d.sibling;var _=h(o,d,s[m],l);if(null===_){null===d&&(d=g);break}e&&d&&null===_.alternate&&t(o,d),a=i(_,a,m),null===u?c=_:u.sibling=_,u=_,d=g}if(m===s.length)return n(o,d),oa&&Qo(o,m),c;if(null===d){for(;m<s.length;m++)null!==(d=p(o,s[m],l))&&(a=i(d,a,m),null===u?c=d:u.sibling=d,u=d);return oa&&Qo(o,m),c}for(d=r(o,d);m<s.length;m++)null!==(g=f(d,o,m,s[m],l))&&(e&&null!==g.alternate&&d.delete(null===g.key?m:g.key),a=i(g,a,m),null===u?c=g:u.sibling=g,u=g);return e&&d.forEach((function(e){return t(o,e)})),oa&&Qo(o,m),c}function g(o,s,l,c){var u=O(l);if("function"!==typeof u)throw Error(a(150));if(null==(l=u.call(l)))throw Error(a(151));for(var d=u=null,m=s,g=s=0,_=null,v=l.next();null!==m&&!v.done;g++,v=l.next()){m.index>g?(_=m,m=null):_=m.sibling;var y=h(o,m,v.value,c);if(null===y){null===m&&(m=_);break}e&&m&&null===y.alternate&&t(o,m),s=i(y,s,g),null===d?u=y:d.sibling=y,d=y,m=_}if(v.done)return n(o,m),oa&&Qo(o,g),u;if(null===m){for(;!v.done;g++,v=l.next())null!==(v=p(o,v.value,c))&&(s=i(v,s,g),null===d?u=v:d.sibling=v,d=v);return oa&&Qo(o,g),u}for(m=r(o,m);!v.done;g++,v=l.next())null!==(v=f(m,o,g,v.value,c))&&(e&&null!==v.alternate&&m.delete(null===v.key?g:v.key),s=i(v,s,g),null===d?u=v:d.sibling=v,d=v);return e&&m.forEach((function(e){return t(o,e)})),oa&&Qo(o,g),u}return function e(r,a,i,l){if("object"===typeof i&&null!==i&&i.type===k&&null===i.key&&(i=i.props.children),"object"===typeof i&&null!==i){switch(i.$$typeof){case b:e:{for(var c=i.key,u=a;null!==u;){if(u.key===c){if((c=i.type)===k){if(7===u.tag){n(r,u.sibling),(a=o(u,i.props.children)).return=r,r=a;break e}}else if(u.elementType===c||"object"===typeof c&&null!==c&&c.$$typeof===I&&va(c)===u.type){n(r,u.sibling),(a=o(u,i.props)).ref=ga(r,u,i),a.return=r,r=a;break e}n(r,u);break}t(r,u),u=u.sibling}i.type===k?((a=Oc(i.props.children,r.mode,l,i.key)).return=r,r=a):((l=zc(i.type,i.key,i.props,null,r.mode,l)).ref=ga(r,a,i),l.return=r,r=l)}return s(r);case x:e:{for(u=i.key;null!==a;){if(a.key===u){if(4===a.tag&&a.stateNode.containerInfo===i.containerInfo&&a.stateNode.implementation===i.implementation){n(r,a.sibling),(a=o(a,i.children||[])).return=r,r=a;break e}n(r,a);break}t(r,a),a=a.sibling}(a=jc(i,r.mode,l)).return=r,r=a}return s(r);case I:return e(r,a,(u=i._init)(i._payload),l)}if(te(i))return m(r,a,i,l);if(O(i))return g(r,a,i,l);_a(r,i)}return"string"===typeof i&&""!==i||"number"===typeof i?(i=""+i,null!==a&&6===a.tag?(n(r,a.sibling),(a=o(a,i)).return=r,r=a):(n(r,a),(a=Bc(i,r.mode,l)).return=r,r=a),s(r)):n(r,a)}}var wa=ya(!0),ba=ya(!1),xa=Co(null),ka=null,Ca=null,Da=null;function Sa(){Da=Ca=ka=null}function Ea(e){var t=xa.current;Do(xa),e._currentValue=t}function Ta(e,t,n){for(;null!==e;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==r&&(r.childLanes|=t)):null!==r&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Aa(e,t){ka=e,Da=Ca=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(vs=!0),e.firstContext=null)}function Ma(e){var t=e._currentValue;if(Da!==e)if(e={context:e,memoizedValue:t,next:null},null===Ca){if(null===ka)throw Error(a(308));Ca=e,ka.dependencies={lanes:0,firstContext:e}}else Ca=Ca.next=e;return t}var Fa=null;function Ia(e){null===Fa?Fa=[e]:Fa.push(e)}function Pa(e,t,n,r){var o=t.interleaved;return null===o?(n.next=n,Ia(t)):(n.next=o.next,o.next=n),t.interleaved=n,za(e,r)}function za(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}var Oa=!1;function Na(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Ba(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function ja(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function La(e,t,n){var r=e.updateQueue;if(null===r)return null;if(r=r.shared,0!==(2&Tl)){var o=r.pending;return null===o?t.next=t:(t.next=o.next,o.next=t),r.pending=t,za(e,n)}return null===(o=r.interleaved)?(t.next=t,Ia(r)):(t.next=o.next,o.next=t),r.interleaved=t,za(e,n)}function Ra(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&n))){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,_t(e,n)}}function Va(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var o=null,a=null;if(null!==(n=n.firstBaseUpdate)){do{var i={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===a?o=a=i:a=a.next=i,n=n.next}while(null!==n);null===a?o=a=t:a=a.next=t}else o=a=t;return n={baseState:r.baseState,firstBaseUpdate:o,lastBaseUpdate:a,shared:r.shared,effects:r.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function qa(e,t,n,r){var o=e.updateQueue;Oa=!1;var a=o.firstBaseUpdate,i=o.lastBaseUpdate,s=o.shared.pending;if(null!==s){o.shared.pending=null;var l=s,c=l.next;l.next=null,null===i?a=c:i.next=c,i=l;var u=e.alternate;null!==u&&((s=(u=u.updateQueue).lastBaseUpdate)!==i&&(null===s?u.firstBaseUpdate=c:s.next=c,u.lastBaseUpdate=l))}if(null!==a){var d=o.baseState;for(i=0,u=c=l=null,s=a;;){var p=s.lane,h=s.eventTime;if((r&p)===p){null!==u&&(u=u.next={eventTime:h,lane:0,tag:s.tag,payload:s.payload,callback:s.callback,next:null});e:{var f=e,m=s;switch(p=t,h=n,m.tag){case 1:if("function"===typeof(f=m.payload)){d=f.call(h,d,p);break e}d=f;break e;case 3:f.flags=-65537&f.flags|128;case 0:if(null===(p="function"===typeof(f=m.payload)?f.call(h,d,p):f)||void 0===p)break e;d=B({},d,p);break e;case 2:Oa=!0}}null!==s.callback&&0!==s.lane&&(e.flags|=64,null===(p=o.effects)?o.effects=[s]:p.push(s))}else h={eventTime:h,lane:p,tag:s.tag,payload:s.payload,callback:s.callback,next:null},null===u?(c=u=h,l=d):u=u.next=h,i|=p;if(null===(s=s.next)){if(null===(s=o.shared.pending))break;s=(p=s).next,p.next=null,o.lastBaseUpdate=p,o.shared.pending=null}}if(null===u&&(l=d),o.baseState=l,o.firstBaseUpdate=c,o.lastBaseUpdate=u,null!==(t=o.shared.interleaved)){o=t;do{i|=o.lane,o=o.next}while(o!==t)}else null===a&&(o.shared.lanes=0);Nl|=i,e.lanes=i,e.memoizedState=d}}function Ua(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var r=e[t],o=r.callback;if(null!==o){if(r.callback=null,r=n,"function"!==typeof o)throw Error(a(191,o));o.call(r)}}}var Wa={},Ga=Co(Wa),Ha=Co(Wa),Ka=Co(Wa);function Za(e){if(e===Wa)throw Error(a(174));return e}function $a(e,t){switch(So(Ka,t),So(Ha,e),So(Ga,Wa),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:le(null,"");break;default:t=le(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}Do(Ga),So(Ga,t)}function Xa(){Do(Ga),Do(Ha),Do(Ka)}function Ja(e){Za(Ka.current);var t=Za(Ga.current),n=le(t,e.type);t!==n&&(So(Ha,e),So(Ga,n))}function Qa(e){Ha.current===e&&(Do(Ga),Do(Ha))}var Ya=Co(0);function ei(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var ti=[];function ni(){for(var e=0;e<ti.length;e++)ti[e]._workInProgressVersionPrimary=null;ti.length=0}var ri=w.ReactCurrentDispatcher,oi=w.ReactCurrentBatchConfig,ai=0,ii=null,si=null,li=null,ci=!1,ui=!1,di=0,pi=0;function hi(){throw Error(a(321))}function fi(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!ir(e[n],t[n]))return!1;return!0}function mi(e,t,n,r,o,i){if(ai=i,ii=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,ri.current=null===e||null===e.memoizedState?Qi:Yi,e=n(r,o),ui){i=0;do{if(ui=!1,di=0,25<=i)throw Error(a(301));i+=1,li=si=null,t.updateQueue=null,ri.current=es,e=n(r,o)}while(ui)}if(ri.current=Ji,t=null!==si&&null!==si.next,ai=0,li=si=ii=null,ci=!1,t)throw Error(a(300));return e}function gi(){var e=0!==di;return di=0,e}function _i(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===li?ii.memoizedState=li=e:li=li.next=e,li}function vi(){if(null===si){var e=ii.alternate;e=null!==e?e.memoizedState:null}else e=si.next;var t=null===li?ii.memoizedState:li.next;if(null!==t)li=t,si=e;else{if(null===e)throw Error(a(310));e={memoizedState:(si=e).memoizedState,baseState:si.baseState,baseQueue:si.baseQueue,queue:si.queue,next:null},null===li?ii.memoizedState=li=e:li=li.next=e}return li}function yi(e,t){return"function"===typeof t?t(e):t}function wi(e){var t=vi(),n=t.queue;if(null===n)throw Error(a(311));n.lastRenderedReducer=e;var r=si,o=r.baseQueue,i=n.pending;if(null!==i){if(null!==o){var s=o.next;o.next=i.next,i.next=s}r.baseQueue=o=i,n.pending=null}if(null!==o){i=o.next,r=r.baseState;var l=s=null,c=null,u=i;do{var d=u.lane;if((ai&d)===d)null!==c&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:e(r,u.action);else{var p={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};null===c?(l=c=p,s=r):c=c.next=p,ii.lanes|=d,Nl|=d}u=u.next}while(null!==u&&u!==i);null===c?s=r:c.next=l,ir(r,t.memoizedState)||(vs=!0),t.memoizedState=r,t.baseState=s,t.baseQueue=c,n.lastRenderedState=r}if(null!==(e=n.interleaved)){o=e;do{i=o.lane,ii.lanes|=i,Nl|=i,o=o.next}while(o!==e)}else null===o&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function bi(e){var t=vi(),n=t.queue;if(null===n)throw Error(a(311));n.lastRenderedReducer=e;var r=n.dispatch,o=n.pending,i=t.memoizedState;if(null!==o){n.pending=null;var s=o=o.next;do{i=e(i,s.action),s=s.next}while(s!==o);ir(i,t.memoizedState)||(vs=!0),t.memoizedState=i,null===t.baseQueue&&(t.baseState=i),n.lastRenderedState=i}return[i,r]}function xi(){}function ki(e,t){var n=ii,r=vi(),o=t(),i=!ir(r.memoizedState,o);if(i&&(r.memoizedState=o,vs=!0),r=r.queue,Oi(Si.bind(null,n,r,e),[e]),r.getSnapshot!==t||i||null!==li&&1&li.memoizedState.tag){if(n.flags|=2048,Mi(9,Di.bind(null,n,r,o,t),void 0,null),null===Al)throw Error(a(349));0!==(30&ai)||Ci(n,t,o)}return o}function Ci(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=ii.updateQueue)?(t={lastEffect:null,stores:null},ii.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function Di(e,t,n,r){t.value=n,t.getSnapshot=r,Ei(t)&&Ti(e)}function Si(e,t,n){return n((function(){Ei(t)&&Ti(e)}))}function Ei(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!ir(e,n)}catch(r){return!0}}function Ti(e){var t=za(e,1);null!==t&&nc(t,e,1,-1)}function Ai(e){var t=_i();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:yi,lastRenderedState:e},t.queue=e,e=e.dispatch=Ki.bind(null,ii,e),[t.memoizedState,e]}function Mi(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},null===(t=ii.updateQueue)?(t={lastEffect:null,stores:null},ii.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function Fi(){return vi().memoizedState}function Ii(e,t,n,r){var o=_i();ii.flags|=e,o.memoizedState=Mi(1|t,n,void 0,void 0===r?null:r)}function Pi(e,t,n,r){var o=vi();r=void 0===r?null:r;var a=void 0;if(null!==si){var i=si.memoizedState;if(a=i.destroy,null!==r&&fi(r,i.deps))return void(o.memoizedState=Mi(t,n,a,r))}ii.flags|=e,o.memoizedState=Mi(1|t,n,a,r)}function zi(e,t){return Ii(8390656,8,e,t)}function Oi(e,t){return Pi(2048,8,e,t)}function Ni(e,t){return Pi(4,2,e,t)}function Bi(e,t){return Pi(4,4,e,t)}function ji(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Li(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Pi(4,4,ji.bind(null,t,e),n)}function Ri(){}function Vi(e,t){var n=vi();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&fi(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function qi(e,t){var n=vi();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&fi(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function Ui(e,t,n){return 0===(21&ai)?(e.baseState&&(e.baseState=!1,vs=!0),e.memoizedState=n):(ir(n,t)||(n=ft(),ii.lanes|=n,Nl|=n,e.baseState=!0),t)}function Wi(e,t){var n=vt;vt=0!==n&&4>n?n:4,e(!0);var r=oi.transition;oi.transition={};try{e(!1),t()}finally{vt=n,oi.transition=r}}function Gi(){return vi().memoizedState}function Hi(e,t,n){var r=tc(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},Zi(e))$i(t,n);else if(null!==(n=Pa(e,t,n,r))){nc(n,e,r,ec()),Xi(n,t,r)}}function Ki(e,t,n){var r=tc(e),o={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(Zi(e))$i(t,o);else{var a=e.alternate;if(0===e.lanes&&(null===a||0===a.lanes)&&null!==(a=t.lastRenderedReducer))try{var i=t.lastRenderedState,s=a(i,n);if(o.hasEagerState=!0,o.eagerState=s,ir(s,i)){var l=t.interleaved;return null===l?(o.next=o,Ia(t)):(o.next=l.next,l.next=o),void(t.interleaved=o)}}catch(c){}null!==(n=Pa(e,t,o,r))&&(nc(n,e,r,o=ec()),Xi(n,t,r))}}function Zi(e){var t=e.alternate;return e===ii||null!==t&&t===ii}function $i(e,t){ui=ci=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function Xi(e,t,n){if(0!==(4194240&n)){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,_t(e,n)}}var Ji={readContext:Ma,useCallback:hi,useContext:hi,useEffect:hi,useImperativeHandle:hi,useInsertionEffect:hi,useLayoutEffect:hi,useMemo:hi,useReducer:hi,useRef:hi,useState:hi,useDebugValue:hi,useDeferredValue:hi,useTransition:hi,useMutableSource:hi,useSyncExternalStore:hi,useId:hi,unstable_isNewReconciler:!1},Qi={readContext:Ma,useCallback:function(e,t){return _i().memoizedState=[e,void 0===t?null:t],e},useContext:Ma,useEffect:zi,useImperativeHandle:function(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Ii(4194308,4,ji.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Ii(4194308,4,e,t)},useInsertionEffect:function(e,t){return Ii(4,2,e,t)},useMemo:function(e,t){var n=_i();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=_i();return t=void 0!==n?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=Hi.bind(null,ii,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},_i().memoizedState=e},useState:Ai,useDebugValue:Ri,useDeferredValue:function(e){return _i().memoizedState=e},useTransition:function(){var e=Ai(!1),t=e[0];return e=Wi.bind(null,e[1]),_i().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=ii,o=_i();if(oa){if(void 0===n)throw Error(a(407));n=n()}else{if(n=t(),null===Al)throw Error(a(349));0!==(30&ai)||Ci(r,t,n)}o.memoizedState=n;var i={value:n,getSnapshot:t};return o.queue=i,zi(Si.bind(null,r,i,e),[e]),r.flags|=2048,Mi(9,Di.bind(null,r,i,n,t),void 0,null),n},useId:function(){var e=_i(),t=Al.identifierPrefix;if(oa){var n=Jo;t=":"+t+"R"+(n=(Xo&~(1<<32-at(Xo)-1)).toString(32)+n),0<(n=di++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=pi++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},Yi={readContext:Ma,useCallback:Vi,useContext:Ma,useEffect:Oi,useImperativeHandle:Li,useInsertionEffect:Ni,useLayoutEffect:Bi,useMemo:qi,useReducer:wi,useRef:Fi,useState:function(){return wi(yi)},useDebugValue:Ri,useDeferredValue:function(e){return Ui(vi(),si.memoizedState,e)},useTransition:function(){return[wi(yi)[0],vi().memoizedState]},useMutableSource:xi,useSyncExternalStore:ki,useId:Gi,unstable_isNewReconciler:!1},es={readContext:Ma,useCallback:Vi,useContext:Ma,useEffect:Oi,useImperativeHandle:Li,useInsertionEffect:Ni,useLayoutEffect:Bi,useMemo:qi,useReducer:bi,useRef:Fi,useState:function(){return bi(yi)},useDebugValue:Ri,useDeferredValue:function(e){var t=vi();return null===si?t.memoizedState=e:Ui(t,si.memoizedState,e)},useTransition:function(){return[bi(yi)[0],vi().memoizedState]},useMutableSource:xi,useSyncExternalStore:ki,useId:Gi,unstable_isNewReconciler:!1};function ts(e,t){if(e&&e.defaultProps){for(var n in t=B({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}function ns(e,t,n,r){n=null===(n=n(r,t=e.memoizedState))||void 0===n?t:B({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var rs={isMounted:function(e){return!!(e=e._reactInternals)&&Ve(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=ec(),o=tc(e),a=ja(r,o);a.payload=t,void 0!==n&&null!==n&&(a.callback=n),null!==(t=La(e,a,o))&&(nc(t,e,o,r),Ra(t,e,o))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=ec(),o=tc(e),a=ja(r,o);a.tag=1,a.payload=t,void 0!==n&&null!==n&&(a.callback=n),null!==(t=La(e,a,o))&&(nc(t,e,o,r),Ra(t,e,o))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=ec(),r=tc(e),o=ja(n,r);o.tag=2,void 0!==t&&null!==t&&(o.callback=t),null!==(t=La(e,o,r))&&(nc(t,e,r,n),Ra(t,e,r))}};function os(e,t,n,r,o,a,i){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,a,i):!t.prototype||!t.prototype.isPureReactComponent||(!sr(n,r)||!sr(o,a))}function as(e,t,n){var r=!1,o=Eo,a=t.contextType;return"object"===typeof a&&null!==a?a=Ma(a):(o=Io(t)?Mo:To.current,a=(r=null!==(r=t.contextTypes)&&void 0!==r)?Fo(e,o):Eo),t=new t(n,a),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=rs,e.stateNode=t,t._reactInternals=e,r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=o,e.__reactInternalMemoizedMaskedChildContext=a),t}function is(e,t,n,r){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&rs.enqueueReplaceState(t,t.state,null)}function ss(e,t,n,r){var o=e.stateNode;o.props=n,o.state=e.memoizedState,o.refs={},Na(e);var a=t.contextType;"object"===typeof a&&null!==a?o.context=Ma(a):(a=Io(t)?Mo:To.current,o.context=Fo(e,a)),o.state=e.memoizedState,"function"===typeof(a=t.getDerivedStateFromProps)&&(ns(e,t,a,n),o.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof o.getSnapshotBeforeUpdate||"function"!==typeof o.UNSAFE_componentWillMount&&"function"!==typeof o.componentWillMount||(t=o.state,"function"===typeof o.componentWillMount&&o.componentWillMount(),"function"===typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount(),t!==o.state&&rs.enqueueReplaceState(o,o.state,null),qa(e,n,o,r),o.state=e.memoizedState),"function"===typeof o.componentDidMount&&(e.flags|=4194308)}function ls(e,t){try{var n="",r=t;do{n+=V(r),r=r.return}while(r);var o=n}catch(a){o="\nError generating stack: "+a.message+"\n"+a.stack}return{value:e,source:t,stack:o,digest:null}}function cs(e,t,n){return{value:e,source:null,stack:null!=n?n:null,digest:null!=t?t:null}}function us(e,t){try{console.error(t.value)}catch(n){setTimeout((function(){throw n}))}}var ds="function"===typeof WeakMap?WeakMap:Map;function ps(e,t,n){(n=ja(-1,n)).tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){Wl||(Wl=!0,Gl=r),us(0,t)},n}function hs(e,t,n){(n=ja(-1,n)).tag=3;var r=e.type.getDerivedStateFromError;if("function"===typeof r){var o=t.value;n.payload=function(){return r(o)},n.callback=function(){us(0,t)}}var a=e.stateNode;return null!==a&&"function"===typeof a.componentDidCatch&&(n.callback=function(){us(0,t),"function"!==typeof r&&(null===Hl?Hl=new Set([this]):Hl.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}function fs(e,t,n){var r=e.pingCache;if(null===r){r=e.pingCache=new ds;var o=new Set;r.set(t,o)}else void 0===(o=r.get(t))&&(o=new Set,r.set(t,o));o.has(n)||(o.add(n),e=Dc.bind(null,e,t,n),t.then(e,e))}function ms(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function gs(e,t,n,r,o){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((t=ja(-1,1)).tag=2,La(n,t,1))),n.lanes|=1),e):(e.flags|=65536,e.lanes=o,e)}var _s=w.ReactCurrentOwner,vs=!1;function ys(e,t,n,r){t.child=null===e?ba(t,null,n,r):wa(t,e.child,n,r)}function ws(e,t,n,r,o){n=n.render;var a=t.ref;return Aa(t,o),r=mi(e,t,n,r,a,o),n=gi(),null===e||vs?(oa&&n&&ea(t),t.flags|=1,ys(e,t,r,o),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~o,Ws(e,t,o))}function bs(e,t,n,r,o){if(null===e){var a=n.type;return"function"!==typeof a||Ic(a)||void 0!==a.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=zc(n.type,null,r,t,t.mode,o)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=a,xs(e,t,a,r,o))}if(a=e.child,0===(e.lanes&o)){var i=a.memoizedProps;if((n=null!==(n=n.compare)?n:sr)(i,r)&&e.ref===t.ref)return Ws(e,t,o)}return t.flags|=1,(e=Pc(a,r)).ref=t.ref,e.return=t,t.child=e}function xs(e,t,n,r,o){if(null!==e){var a=e.memoizedProps;if(sr(a,r)&&e.ref===t.ref){if(vs=!1,t.pendingProps=r=a,0===(e.lanes&o))return t.lanes=e.lanes,Ws(e,t,o);0!==(131072&e.flags)&&(vs=!0)}}return Ds(e,t,n,r,o)}function ks(e,t,n){var r=t.pendingProps,o=r.children,a=null!==e?e.memoizedState:null;if("hidden"===r.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},So(Pl,Il),Il|=n;else{if(0===(1073741824&n))return e=null!==a?a.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,So(Pl,Il),Il|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=null!==a?a.baseLanes:n,So(Pl,Il),Il|=r}else null!==a?(r=a.baseLanes|n,t.memoizedState=null):r=n,So(Pl,Il),Il|=r;return ys(e,t,o,n),t.child}function Cs(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Ds(e,t,n,r,o){var a=Io(n)?Mo:To.current;return a=Fo(t,a),Aa(t,o),n=mi(e,t,n,r,a,o),r=gi(),null===e||vs?(oa&&r&&ea(t),t.flags|=1,ys(e,t,n,o),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~o,Ws(e,t,o))}function Ss(e,t,n,r,o){if(Io(n)){var a=!0;No(t)}else a=!1;if(Aa(t,o),null===t.stateNode)Us(e,t),as(t,n,r),ss(t,n,r,o),r=!0;else if(null===e){var i=t.stateNode,s=t.memoizedProps;i.props=s;var l=i.context,c=n.contextType;"object"===typeof c&&null!==c?c=Ma(c):c=Fo(t,c=Io(n)?Mo:To.current);var u=n.getDerivedStateFromProps,d="function"===typeof u||"function"===typeof i.getSnapshotBeforeUpdate;d||"function"!==typeof i.UNSAFE_componentWillReceiveProps&&"function"!==typeof i.componentWillReceiveProps||(s!==r||l!==c)&&is(t,i,r,c),Oa=!1;var p=t.memoizedState;i.state=p,qa(t,r,i,o),l=t.memoizedState,s!==r||p!==l||Ao.current||Oa?("function"===typeof u&&(ns(t,n,u,r),l=t.memoizedState),(s=Oa||os(t,n,s,r,p,l,c))?(d||"function"!==typeof i.UNSAFE_componentWillMount&&"function"!==typeof i.componentWillMount||("function"===typeof i.componentWillMount&&i.componentWillMount(),"function"===typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount()),"function"===typeof i.componentDidMount&&(t.flags|=4194308)):("function"===typeof i.componentDidMount&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=l),i.props=r,i.state=l,i.context=c,r=s):("function"===typeof i.componentDidMount&&(t.flags|=4194308),r=!1)}else{i=t.stateNode,Ba(e,t),s=t.memoizedProps,c=t.type===t.elementType?s:ts(t.type,s),i.props=c,d=t.pendingProps,p=i.context,"object"===typeof(l=n.contextType)&&null!==l?l=Ma(l):l=Fo(t,l=Io(n)?Mo:To.current);var h=n.getDerivedStateFromProps;(u="function"===typeof h||"function"===typeof i.getSnapshotBeforeUpdate)||"function"!==typeof i.UNSAFE_componentWillReceiveProps&&"function"!==typeof i.componentWillReceiveProps||(s!==d||p!==l)&&is(t,i,r,l),Oa=!1,p=t.memoizedState,i.state=p,qa(t,r,i,o);var f=t.memoizedState;s!==d||p!==f||Ao.current||Oa?("function"===typeof h&&(ns(t,n,h,r),f=t.memoizedState),(c=Oa||os(t,n,c,r,p,f,l)||!1)?(u||"function"!==typeof i.UNSAFE_componentWillUpdate&&"function"!==typeof i.componentWillUpdate||("function"===typeof i.componentWillUpdate&&i.componentWillUpdate(r,f,l),"function"===typeof i.UNSAFE_componentWillUpdate&&i.UNSAFE_componentWillUpdate(r,f,l)),"function"===typeof i.componentDidUpdate&&(t.flags|=4),"function"===typeof i.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof i.componentDidUpdate||s===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),"function"!==typeof i.getSnapshotBeforeUpdate||s===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=f),i.props=r,i.state=f,i.context=l,r=c):("function"!==typeof i.componentDidUpdate||s===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),"function"!==typeof i.getSnapshotBeforeUpdate||s===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),r=!1)}return Es(e,t,n,r,a,o)}function Es(e,t,n,r,o,a){Cs(e,t);var i=0!==(128&t.flags);if(!r&&!i)return o&&Bo(t,n,!1),Ws(e,t,a);r=t.stateNode,_s.current=t;var s=i&&"function"!==typeof n.getDerivedStateFromError?null:r.render();return t.flags|=1,null!==e&&i?(t.child=wa(t,e.child,null,a),t.child=wa(t,null,s,a)):ys(e,t,s,a),t.memoizedState=r.state,o&&Bo(t,n,!0),t.child}function Ts(e){var t=e.stateNode;t.pendingContext?zo(0,t.pendingContext,t.pendingContext!==t.context):t.context&&zo(0,t.context,!1),$a(e,t.containerInfo)}function As(e,t,n,r,o){return ha(),fa(o),t.flags|=256,ys(e,t,n,r),t.child}var Ms,Fs,Is,Ps,zs={dehydrated:null,treeContext:null,retryLane:0};function Os(e){return{baseLanes:e,cachePool:null,transitions:null}}function Ns(e,t,n){var r,o=t.pendingProps,i=Ya.current,s=!1,l=0!==(128&t.flags);if((r=l)||(r=(null===e||null!==e.memoizedState)&&0!==(2&i)),r?(s=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(i|=1),So(Ya,1&i),null===e)return ca(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(l=o.children,e=o.fallback,s?(o=t.mode,s=t.child,l={mode:"hidden",children:l},0===(1&o)&&null!==s?(s.childLanes=0,s.pendingProps=l):s=Nc(l,o,0,null),e=Oc(e,o,n,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=Os(n),t.memoizedState=zs,e):Bs(t,l));if(null!==(i=e.memoizedState)&&null!==(r=i.dehydrated))return function(e,t,n,r,o,i,s){if(n)return 256&t.flags?(t.flags&=-257,Ls(e,t,s,r=cs(Error(a(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(i=r.fallback,o=t.mode,r=Nc({mode:"visible",children:r.children},o,0,null),(i=Oc(i,o,s,null)).flags|=2,r.return=t,i.return=t,r.sibling=i,t.child=r,0!==(1&t.mode)&&wa(t,e.child,null,s),t.child.memoizedState=Os(s),t.memoizedState=zs,i);if(0===(1&t.mode))return Ls(e,t,s,null);if("$!"===o.data){if(r=o.nextSibling&&o.nextSibling.dataset)var l=r.dgst;return r=l,Ls(e,t,s,r=cs(i=Error(a(419)),r,void 0))}if(l=0!==(s&e.childLanes),vs||l){if(null!==(r=Al)){switch(s&-s){case 4:o=2;break;case 16:o=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:o=32;break;case 536870912:o=268435456;break;default:o=0}0!==(o=0!==(o&(r.suspendedLanes|s))?0:o)&&o!==i.retryLane&&(i.retryLane=o,za(e,o),nc(r,e,o,-1))}return mc(),Ls(e,t,s,r=cs(Error(a(421))))}return"$?"===o.data?(t.flags|=128,t.child=e.child,t=Ec.bind(null,e),o._reactRetry=t,null):(e=i.treeContext,ra=lo(o.nextSibling),na=t,oa=!0,aa=null,null!==e&&(Ko[Zo++]=Xo,Ko[Zo++]=Jo,Ko[Zo++]=$o,Xo=e.id,Jo=e.overflow,$o=t),t=Bs(t,r.children),t.flags|=4096,t)}(e,t,l,o,r,i,n);if(s){s=o.fallback,l=t.mode,r=(i=e.child).sibling;var c={mode:"hidden",children:o.children};return 0===(1&l)&&t.child!==i?((o=t.child).childLanes=0,o.pendingProps=c,t.deletions=null):(o=Pc(i,c)).subtreeFlags=14680064&i.subtreeFlags,null!==r?s=Pc(r,s):(s=Oc(s,l,n,null)).flags|=2,s.return=t,o.return=t,o.sibling=s,t.child=o,o=s,s=t.child,l=null===(l=e.child.memoizedState)?Os(n):{baseLanes:l.baseLanes|n,cachePool:null,transitions:l.transitions},s.memoizedState=l,s.childLanes=e.childLanes&~n,t.memoizedState=zs,o}return e=(s=e.child).sibling,o=Pc(s,{mode:"visible",children:o.children}),0===(1&t.mode)&&(o.lanes=n),o.return=t,o.sibling=null,null!==e&&(null===(n=t.deletions)?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=o,t.memoizedState=null,o}function Bs(e,t){return(t=Nc({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function Ls(e,t,n,r){return null!==r&&fa(r),wa(t,e.child,null,n),(e=Bs(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function Rs(e,t,n){e.lanes|=t;var r=e.alternate;null!==r&&(r.lanes|=t),Ta(e.return,t,n)}function Vs(e,t,n,r,o){var a=e.memoizedState;null===a?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:o}:(a.isBackwards=t,a.rendering=null,a.renderingStartTime=0,a.last=r,a.tail=n,a.tailMode=o)}function qs(e,t,n){var r=t.pendingProps,o=r.revealOrder,a=r.tail;if(ys(e,t,r.children,n),0!==(2&(r=Ya.current)))r=1&r|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Rs(e,n,t);else if(19===e.tag)Rs(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(So(Ya,r),0===(1&t.mode))t.memoizedState=null;else switch(o){case"forwards":for(n=t.child,o=null;null!==n;)null!==(e=n.alternate)&&null===ei(e)&&(o=n),n=n.sibling;null===(n=o)?(o=t.child,t.child=null):(o=n.sibling,n.sibling=null),Vs(t,!1,o,n,a);break;case"backwards":for(n=null,o=t.child,t.child=null;null!==o;){if(null!==(e=o.alternate)&&null===ei(e)){t.child=o;break}e=o.sibling,o.sibling=n,n=o,o=e}Vs(t,!0,n,null,a);break;case"together":Vs(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Us(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Ws(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Nl|=t.lanes,0===(n&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(a(153));if(null!==t.child){for(n=Pc(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Pc(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function Gs(e,t){if(!oa)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function Hs(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,r=0;if(t)for(var o=e.child;null!==o;)n|=o.lanes|o.childLanes,r|=14680064&o.subtreeFlags,r|=14680064&o.flags,o.return=e,o=o.sibling;else for(o=e.child;null!==o;)n|=o.lanes|o.childLanes,r|=o.subtreeFlags,r|=o.flags,o.return=e,o=o.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function Ks(e,t,n){var r=t.pendingProps;switch(ta(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Hs(t),null;case 1:case 17:return Io(t.type)&&Po(),Hs(t),null;case 3:return r=t.stateNode,Xa(),Do(Ao),Do(To),ni(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),null!==e&&null!==e.child||(da(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==aa&&(ic(aa),aa=null))),Fs(e,t),Hs(t),null;case 5:Qa(t);var o=Za(Ka.current);if(n=t.type,null!==e&&null!=t.stateNode)Is(e,t,n,r,o),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(null===t.stateNode)throw Error(a(166));return Hs(t),null}if(e=Za(Ga.current),da(t)){r=t.stateNode,n=t.type;var i=t.memoizedProps;switch(r[po]=t,r[ho]=i,e=0!==(1&t.mode),n){case"dialog":jr("cancel",r),jr("close",r);break;case"iframe":case"object":case"embed":jr("load",r);break;case"video":case"audio":for(o=0;o<zr.length;o++)jr(zr[o],r);break;case"source":jr("error",r);break;case"img":case"image":case"link":jr("error",r),jr("load",r);break;case"details":jr("toggle",r);break;case"input":X(r,i),jr("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},jr("invalid",r);break;case"textarea":oe(r,i),jr("invalid",r)}for(var l in _e(n,i),o=null,i)if(i.hasOwnProperty(l)){var c=i[l];"children"===l?"string"===typeof c?r.textContent!==c&&(!0!==i.suppressHydrationWarning&&Jr(r.textContent,c,e),o=["children",c]):"number"===typeof c&&r.textContent!==""+c&&(!0!==i.suppressHydrationWarning&&Jr(r.textContent,c,e),o=["children",""+c]):s.hasOwnProperty(l)&&null!=c&&"onScroll"===l&&jr("scroll",r)}switch(n){case"input":H(r),Y(r,i,!0);break;case"textarea":H(r),ie(r);break;case"select":case"option":break;default:"function"===typeof i.onClick&&(r.onclick=Qr)}r=o,t.updateQueue=r,null!==r&&(t.flags|=4)}else{l=9===o.nodeType?o:o.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=se(n)),"http://www.w3.org/1999/xhtml"===e?"script"===n?((e=l.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof r.is?e=l.createElement(n,{is:r.is}):(e=l.createElement(n),"select"===n&&(l=e,r.multiple?l.multiple=!0:r.size&&(l.size=r.size))):e=l.createElementNS(e,n),e[po]=t,e[ho]=r,Ms(e,t,!1,!1),t.stateNode=e;e:{switch(l=ve(n,r),n){case"dialog":jr("cancel",e),jr("close",e),o=r;break;case"iframe":case"object":case"embed":jr("load",e),o=r;break;case"video":case"audio":for(o=0;o<zr.length;o++)jr(zr[o],e);o=r;break;case"source":jr("error",e),o=r;break;case"img":case"image":case"link":jr("error",e),jr("load",e),o=r;break;case"details":jr("toggle",e),o=r;break;case"input":X(e,r),o=$(e,r),jr("invalid",e);break;case"option":default:o=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},o=B({},r,{value:void 0}),jr("invalid",e);break;case"textarea":oe(e,r),o=re(e,r),jr("invalid",e)}for(i in _e(n,o),c=o)if(c.hasOwnProperty(i)){var u=c[i];"style"===i?me(e,u):"dangerouslySetInnerHTML"===i?null!=(u=u?u.__html:void 0)&&ue(e,u):"children"===i?"string"===typeof u?("textarea"!==n||""!==u)&&de(e,u):"number"===typeof u&&de(e,""+u):"suppressContentEditableWarning"!==i&&"suppressHydrationWarning"!==i&&"autoFocus"!==i&&(s.hasOwnProperty(i)?null!=u&&"onScroll"===i&&jr("scroll",e):null!=u&&y(e,i,u,l))}switch(n){case"input":H(e),Y(e,r,!1);break;case"textarea":H(e),ie(e);break;case"option":null!=r.value&&e.setAttribute("value",""+W(r.value));break;case"select":e.multiple=!!r.multiple,null!=(i=r.value)?ne(e,!!r.multiple,i,!1):null!=r.defaultValue&&ne(e,!!r.multiple,r.defaultValue,!0);break;default:"function"===typeof o.onClick&&(e.onclick=Qr)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return Hs(t),null;case 6:if(e&&null!=t.stateNode)Ps(e,t,e.memoizedProps,r);else{if("string"!==typeof r&&null===t.stateNode)throw Error(a(166));if(n=Za(Ka.current),Za(Ga.current),da(t)){if(r=t.stateNode,n=t.memoizedProps,r[po]=t,(i=r.nodeValue!==n)&&null!==(e=na))switch(e.tag){case 3:Jr(r.nodeValue,n,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Jr(r.nodeValue,n,0!==(1&e.mode))}i&&(t.flags|=4)}else(r=(9===n.nodeType?n:n.ownerDocument).createTextNode(r))[po]=t,t.stateNode=r}return Hs(t),null;case 13:if(Do(Ya),r=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(oa&&null!==ra&&0!==(1&t.mode)&&0===(128&t.flags))pa(),ha(),t.flags|=98560,i=!1;else if(i=da(t),null!==r&&null!==r.dehydrated){if(null===e){if(!i)throw Error(a(318));if(!(i=null!==(i=t.memoizedState)?i.dehydrated:null))throw Error(a(317));i[po]=t}else ha(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;Hs(t),i=!1}else null!==aa&&(ic(aa),aa=null),i=!0;if(!i)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=n,t):((r=null!==r)!==(null!==e&&null!==e.memoizedState)&&r&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&Ya.current)?0===zl&&(zl=3):mc())),null!==t.updateQueue&&(t.flags|=4),Hs(t),null);case 4:return Xa(),Fs(e,t),null===e&&Vr(t.stateNode.containerInfo),Hs(t),null;case 10:return Ea(t.type._context),Hs(t),null;case 19:if(Do(Ya),null===(i=t.memoizedState))return Hs(t),null;if(r=0!==(128&t.flags),null===(l=i.rendering))if(r)Gs(i,!1);else{if(0!==zl||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(l=ei(e))){for(t.flags|=128,Gs(i,!1),null!==(r=l.updateQueue)&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;null!==n;)e=r,(i=n).flags&=14680066,null===(l=i.alternate)?(i.childLanes=0,i.lanes=e,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=l.childLanes,i.lanes=l.lanes,i.child=l.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=l.memoizedProps,i.memoizedState=l.memoizedState,i.updateQueue=l.updateQueue,i.type=l.type,e=l.dependencies,i.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return So(Ya,1&Ya.current|2),t.child}e=e.sibling}null!==i.tail&&Xe()>ql&&(t.flags|=128,r=!0,Gs(i,!1),t.lanes=4194304)}else{if(!r)if(null!==(e=ei(l))){if(t.flags|=128,r=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),Gs(i,!0),null===i.tail&&"hidden"===i.tailMode&&!l.alternate&&!oa)return Hs(t),null}else 2*Xe()-i.renderingStartTime>ql&&1073741824!==n&&(t.flags|=128,r=!0,Gs(i,!1),t.lanes=4194304);i.isBackwards?(l.sibling=t.child,t.child=l):(null!==(n=i.last)?n.sibling=l:t.child=l,i.last=l)}return null!==i.tail?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=Xe(),t.sibling=null,n=Ya.current,So(Ya,r?1&n|2:1&n),t):(Hs(t),null);case 22:case 23:return dc(),r=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==r&&(t.flags|=8192),r&&0!==(1&t.mode)?0!==(1073741824&Il)&&(Hs(t),6&t.subtreeFlags&&(t.flags|=8192)):Hs(t),null;case 24:case 25:return null}throw Error(a(156,t.tag))}function Zs(e,t){switch(ta(t),t.tag){case 1:return Io(t.type)&&Po(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return Xa(),Do(Ao),Do(To),ni(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return Qa(t),null;case 13:if(Do(Ya),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(a(340));ha()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return Do(Ya),null;case 4:return Xa(),null;case 10:return Ea(t.type._context),null;case 22:case 23:return dc(),null;default:return null}}Ms=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Fs=function(){},Is=function(e,t,n,r){var o=e.memoizedProps;if(o!==r){e=t.stateNode,Za(Ga.current);var a,i=null;switch(n){case"input":o=$(e,o),r=$(e,r),i=[];break;case"select":o=B({},o,{value:void 0}),r=B({},r,{value:void 0}),i=[];break;case"textarea":o=re(e,o),r=re(e,r),i=[];break;default:"function"!==typeof o.onClick&&"function"===typeof r.onClick&&(e.onclick=Qr)}for(u in _e(n,r),n=null,o)if(!r.hasOwnProperty(u)&&o.hasOwnProperty(u)&&null!=o[u])if("style"===u){var l=o[u];for(a in l)l.hasOwnProperty(a)&&(n||(n={}),n[a]="")}else"dangerouslySetInnerHTML"!==u&&"children"!==u&&"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&"autoFocus"!==u&&(s.hasOwnProperty(u)?i||(i=[]):(i=i||[]).push(u,null));for(u in r){var c=r[u];if(l=null!=o?o[u]:void 0,r.hasOwnProperty(u)&&c!==l&&(null!=c||null!=l))if("style"===u)if(l){for(a in l)!l.hasOwnProperty(a)||c&&c.hasOwnProperty(a)||(n||(n={}),n[a]="");for(a in c)c.hasOwnProperty(a)&&l[a]!==c[a]&&(n||(n={}),n[a]=c[a])}else n||(i||(i=[]),i.push(u,n)),n=c;else"dangerouslySetInnerHTML"===u?(c=c?c.__html:void 0,l=l?l.__html:void 0,null!=c&&l!==c&&(i=i||[]).push(u,c)):"children"===u?"string"!==typeof c&&"number"!==typeof c||(i=i||[]).push(u,""+c):"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&(s.hasOwnProperty(u)?(null!=c&&"onScroll"===u&&jr("scroll",e),i||l===c||(i=[])):(i=i||[]).push(u,c))}n&&(i=i||[]).push("style",n);var u=i;(t.updateQueue=u)&&(t.flags|=4)}},Ps=function(e,t,n,r){n!==r&&(t.flags|=4)};var $s=!1,Xs=!1,Js="function"===typeof WeakSet?WeakSet:Set,Qs=null;function Ys(e,t){var n=e.ref;if(null!==n)if("function"===typeof n)try{n(null)}catch(r){Cc(e,t,r)}else n.current=null}function el(e,t,n){try{n()}catch(r){Cc(e,t,r)}}var tl=!1;function nl(e,t,n){var r=t.updateQueue;if(null!==(r=null!==r?r.lastEffect:null)){var o=r=r.next;do{if((o.tag&e)===e){var a=o.destroy;o.destroy=void 0,void 0!==a&&el(t,n,a)}o=o.next}while(o!==r)}}function rl(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function ol(e){var t=e.ref;if(null!==t){var n=e.stateNode;e.tag,e=n,"function"===typeof t?t(e):t.current=e}}function al(e){var t=e.alternate;null!==t&&(e.alternate=null,al(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[po],delete t[ho],delete t[mo],delete t[go],delete t[_o])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function il(e){return 5===e.tag||3===e.tag||4===e.tag}function sl(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||il(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function ll(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=Qr));else if(4!==r&&null!==(e=e.child))for(ll(e,t,n),e=e.sibling;null!==e;)ll(e,t,n),e=e.sibling}function cl(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&null!==(e=e.child))for(cl(e,t,n),e=e.sibling;null!==e;)cl(e,t,n),e=e.sibling}var ul=null,dl=!1;function pl(e,t,n){for(n=n.child;null!==n;)hl(e,t,n),n=n.sibling}function hl(e,t,n){if(ot&&"function"===typeof ot.onCommitFiberUnmount)try{ot.onCommitFiberUnmount(rt,n)}catch(s){}switch(n.tag){case 5:Xs||Ys(n,t);case 6:var r=ul,o=dl;ul=null,pl(e,t,n),dl=o,null!==(ul=r)&&(dl?(e=ul,n=n.stateNode,8===e.nodeType?e.parentNode.removeChild(n):e.removeChild(n)):ul.removeChild(n.stateNode));break;case 18:null!==ul&&(dl?(e=ul,n=n.stateNode,8===e.nodeType?so(e.parentNode,n):1===e.nodeType&&so(e,n),Vt(e)):so(ul,n.stateNode));break;case 4:r=ul,o=dl,ul=n.stateNode.containerInfo,dl=!0,pl(e,t,n),ul=r,dl=o;break;case 0:case 11:case 14:case 15:if(!Xs&&(null!==(r=n.updateQueue)&&null!==(r=r.lastEffect))){o=r=r.next;do{var a=o,i=a.destroy;a=a.tag,void 0!==i&&(0!==(2&a)||0!==(4&a))&&el(n,t,i),o=o.next}while(o!==r)}pl(e,t,n);break;case 1:if(!Xs&&(Ys(n,t),"function"===typeof(r=n.stateNode).componentWillUnmount))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(s){Cc(n,t,s)}pl(e,t,n);break;case 21:pl(e,t,n);break;case 22:1&n.mode?(Xs=(r=Xs)||null!==n.memoizedState,pl(e,t,n),Xs=r):pl(e,t,n);break;default:pl(e,t,n)}}function fl(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new Js),t.forEach((function(t){var r=Tc.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))}))}}function ml(e,t){var n=t.deletions;if(null!==n)for(var r=0;r<n.length;r++){var o=n[r];try{var i=e,s=t,l=s;e:for(;null!==l;){switch(l.tag){case 5:ul=l.stateNode,dl=!1;break e;case 3:case 4:ul=l.stateNode.containerInfo,dl=!0;break e}l=l.return}if(null===ul)throw Error(a(160));hl(i,s,o),ul=null,dl=!1;var c=o.alternate;null!==c&&(c.return=null),o.return=null}catch(u){Cc(o,t,u)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)gl(t,e),t=t.sibling}function gl(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(ml(t,e),_l(e),4&r){try{nl(3,e,e.return),rl(3,e)}catch(g){Cc(e,e.return,g)}try{nl(5,e,e.return)}catch(g){Cc(e,e.return,g)}}break;case 1:ml(t,e),_l(e),512&r&&null!==n&&Ys(n,n.return);break;case 5:if(ml(t,e),_l(e),512&r&&null!==n&&Ys(n,n.return),32&e.flags){var o=e.stateNode;try{de(o,"")}catch(g){Cc(e,e.return,g)}}if(4&r&&null!=(o=e.stateNode)){var i=e.memoizedProps,s=null!==n?n.memoizedProps:i,l=e.type,c=e.updateQueue;if(e.updateQueue=null,null!==c)try{"input"===l&&"radio"===i.type&&null!=i.name&&J(o,i),ve(l,s);var u=ve(l,i);for(s=0;s<c.length;s+=2){var d=c[s],p=c[s+1];"style"===d?me(o,p):"dangerouslySetInnerHTML"===d?ue(o,p):"children"===d?de(o,p):y(o,d,p,u)}switch(l){case"input":Q(o,i);break;case"textarea":ae(o,i);break;case"select":var h=o._wrapperState.wasMultiple;o._wrapperState.wasMultiple=!!i.multiple;var f=i.value;null!=f?ne(o,!!i.multiple,f,!1):h!==!!i.multiple&&(null!=i.defaultValue?ne(o,!!i.multiple,i.defaultValue,!0):ne(o,!!i.multiple,i.multiple?[]:"",!1))}o[ho]=i}catch(g){Cc(e,e.return,g)}}break;case 6:if(ml(t,e),_l(e),4&r){if(null===e.stateNode)throw Error(a(162));o=e.stateNode,i=e.memoizedProps;try{o.nodeValue=i}catch(g){Cc(e,e.return,g)}}break;case 3:if(ml(t,e),_l(e),4&r&&null!==n&&n.memoizedState.isDehydrated)try{Vt(t.containerInfo)}catch(g){Cc(e,e.return,g)}break;case 4:default:ml(t,e),_l(e);break;case 13:ml(t,e),_l(e),8192&(o=e.child).flags&&(i=null!==o.memoizedState,o.stateNode.isHidden=i,!i||null!==o.alternate&&null!==o.alternate.memoizedState||(Vl=Xe())),4&r&&fl(e);break;case 22:if(d=null!==n&&null!==n.memoizedState,1&e.mode?(Xs=(u=Xs)||d,ml(t,e),Xs=u):ml(t,e),_l(e),8192&r){if(u=null!==e.memoizedState,(e.stateNode.isHidden=u)&&!d&&0!==(1&e.mode))for(Qs=e,d=e.child;null!==d;){for(p=Qs=d;null!==Qs;){switch(f=(h=Qs).child,h.tag){case 0:case 11:case 14:case 15:nl(4,h,h.return);break;case 1:Ys(h,h.return);var m=h.stateNode;if("function"===typeof m.componentWillUnmount){r=h,n=h.return;try{t=r,m.props=t.memoizedProps,m.state=t.memoizedState,m.componentWillUnmount()}catch(g){Cc(r,n,g)}}break;case 5:Ys(h,h.return);break;case 22:if(null!==h.memoizedState){bl(p);continue}}null!==f?(f.return=h,Qs=f):bl(p)}d=d.sibling}e:for(d=null,p=e;;){if(5===p.tag){if(null===d){d=p;try{o=p.stateNode,u?"function"===typeof(i=o.style).setProperty?i.setProperty("display","none","important"):i.display="none":(l=p.stateNode,s=void 0!==(c=p.memoizedProps.style)&&null!==c&&c.hasOwnProperty("display")?c.display:null,l.style.display=fe("display",s))}catch(g){Cc(e,e.return,g)}}}else if(6===p.tag){if(null===d)try{p.stateNode.nodeValue=u?"":p.memoizedProps}catch(g){Cc(e,e.return,g)}}else if((22!==p.tag&&23!==p.tag||null===p.memoizedState||p===e)&&null!==p.child){p.child.return=p,p=p.child;continue}if(p===e)break e;for(;null===p.sibling;){if(null===p.return||p.return===e)break e;d===p&&(d=null),p=p.return}d===p&&(d=null),p.sibling.return=p.return,p=p.sibling}}break;case 19:ml(t,e),_l(e),4&r&&fl(e);case 21:}}function _l(e){var t=e.flags;if(2&t){try{e:{for(var n=e.return;null!==n;){if(il(n)){var r=n;break e}n=n.return}throw Error(a(160))}switch(r.tag){case 5:var o=r.stateNode;32&r.flags&&(de(o,""),r.flags&=-33),cl(e,sl(e),o);break;case 3:case 4:var i=r.stateNode.containerInfo;ll(e,sl(e),i);break;default:throw Error(a(161))}}catch(qS){Cc(e,e.return,qS)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function vl(e,t,n){Qs=e,yl(e,t,n)}function yl(e,t,n){for(var r=0!==(1&e.mode);null!==Qs;){var o=Qs,a=o.child;if(22===o.tag&&r){var i=null!==o.memoizedState||$s;if(!i){var s=o.alternate,l=null!==s&&null!==s.memoizedState||Xs;s=$s;var c=Xs;if($s=i,(Xs=l)&&!c)for(Qs=o;null!==Qs;)l=(i=Qs).child,22===i.tag&&null!==i.memoizedState?xl(o):null!==l?(l.return=i,Qs=l):xl(o);for(;null!==a;)Qs=a,yl(a,t,n),a=a.sibling;Qs=o,$s=s,Xs=c}wl(e)}else 0!==(8772&o.subtreeFlags)&&null!==a?(a.return=o,Qs=a):wl(e)}}function wl(e){for(;null!==Qs;){var t=Qs;if(0!==(8772&t.flags)){var n=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:Xs||rl(5,t);break;case 1:var r=t.stateNode;if(4&t.flags&&!Xs)if(null===n)r.componentDidMount();else{var o=t.elementType===t.type?n.memoizedProps:ts(t.type,n.memoizedProps);r.componentDidUpdate(o,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=t.updateQueue;null!==i&&Ua(t,i,r);break;case 3:var s=t.updateQueue;if(null!==s){if(n=null,null!==t.child)switch(t.child.tag){case 5:case 1:n=t.child.stateNode}Ua(t,s,n)}break;case 5:var l=t.stateNode;if(null===n&&4&t.flags){n=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var u=t.alternate;if(null!==u){var d=u.memoizedState;if(null!==d){var p=d.dehydrated;null!==p&&Vt(p)}}}break;default:throw Error(a(163))}Xs||512&t.flags&&ol(t)}catch(VL){Cc(t,t.return,VL)}}if(t===e){Qs=null;break}if(null!==(n=t.sibling)){n.return=t.return,Qs=n;break}Qs=t.return}}function bl(e){for(;null!==Qs;){var t=Qs;if(t===e){Qs=null;break}var n=t.sibling;if(null!==n){n.return=t.return,Qs=n;break}Qs=t.return}}function xl(e){for(;null!==Qs;){var t=Qs;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{rl(4,t)}catch(qS){Cc(t,n,qS)}break;case 1:var r=t.stateNode;if("function"===typeof r.componentDidMount){var o=t.return;try{r.componentDidMount()}catch(qS){Cc(t,o,qS)}}var a=t.return;try{ol(t)}catch(qS){Cc(t,a,qS)}break;case 5:var i=t.return;try{ol(t)}catch(qS){Cc(t,i,qS)}}}catch(qS){Cc(t,t.return,qS)}if(t===e){Qs=null;break}var s=t.sibling;if(null!==s){s.return=t.return,Qs=s;break}Qs=t.return}}var kl,Cl=Math.ceil,Dl=w.ReactCurrentDispatcher,Sl=w.ReactCurrentOwner,El=w.ReactCurrentBatchConfig,Tl=0,Al=null,Ml=null,Fl=0,Il=0,Pl=Co(0),zl=0,Ol=null,Nl=0,Bl=0,jl=0,Ll=null,Rl=null,Vl=0,ql=1/0,Ul=null,Wl=!1,Gl=null,Hl=null,Kl=!1,Zl=null,$l=0,Xl=0,Jl=null,Ql=-1,Yl=0;function ec(){return 0!==(6&Tl)?Xe():-1!==Ql?Ql:Ql=Xe()}function tc(e){return 0===(1&e.mode)?1:0!==(2&Tl)&&0!==Fl?Fl&-Fl:null!==ma.transition?(0===Yl&&(Yl=ft()),Yl):0!==(e=vt)?e:e=void 0===(e=window.event)?16:$t(e.type)}function nc(e,t,n,r){if(50<Xl)throw Xl=0,Jl=null,Error(a(185));gt(e,n,r),0!==(2&Tl)&&e===Al||(e===Al&&(0===(2&Tl)&&(Bl|=n),4===zl&&sc(e,Fl)),rc(e,r),1===n&&0===Tl&&0===(1&t.mode)&&(ql=Xe()+500,Lo&&qo()))}function rc(e,t){var n=e.callbackNode;!function(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,o=e.expirationTimes,a=e.pendingLanes;0<a;){var i=31-at(a),s=1<<i,l=o[i];-1===l?0!==(s&n)&&0===(s&r)||(o[i]=pt(s,t)):l<=t&&(e.expiredLanes|=s),a&=~s}}(e,t);var r=dt(e,e===Al?Fl:0);if(0===r)null!==n&&Ke(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(null!=n&&Ke(n),1===t)0===e.tag?function(e){Lo=!0,Vo(e)}(lc.bind(null,e)):Vo(lc.bind(null,e)),ao((function(){0===(6&Tl)&&qo()})),n=null;else{switch(yt(r)){case 1:n=Qe;break;case 4:n=Ye;break;case 16:default:n=et;break;case 536870912:n=nt}n=Ac(n,oc.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function oc(e,t){if(Ql=-1,Yl=0,0!==(6&Tl))throw Error(a(327));var n=e.callbackNode;if(xc()&&e.callbackNode!==n)return null;var r=dt(e,e===Al?Fl:0);if(0===r)return null;if(0!==(30&r)||0!==(r&e.expiredLanes)||t)t=gc(e,r);else{t=r;var o=Tl;Tl|=2;var i=fc();for(Al===e&&Fl===t||(Ul=null,ql=Xe()+500,pc(e,t));;)try{vc();break}catch(l){hc(e,l)}Sa(),Dl.current=i,Tl=o,null!==Ml?t=0:(Al=null,Fl=0,t=zl)}if(0!==t){if(2===t&&(0!==(o=ht(e))&&(r=o,t=ac(e,o))),1===t)throw n=Ol,pc(e,0),sc(e,r),rc(e,Xe()),n;if(6===t)sc(e,r);else{if(o=e.current.alternate,0===(30&r)&&!function(e){for(var t=e;;){if(16384&t.flags){var n=t.updateQueue;if(null!==n&&null!==(n=n.stores))for(var r=0;r<n.length;r++){var o=n[r],a=o.getSnapshot;o=o.value;try{if(!ir(a(),o))return!1}catch(s){return!1}}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(o)&&(2===(t=gc(e,r))&&(0!==(i=ht(e))&&(r=i,t=ac(e,i))),1===t))throw n=Ol,pc(e,0),sc(e,r),rc(e,Xe()),n;switch(e.finishedWork=o,e.finishedLanes=r,t){case 0:case 1:throw Error(a(345));case 2:case 5:bc(e,Rl,Ul);break;case 3:if(sc(e,r),(130023424&r)===r&&10<(t=Vl+500-Xe())){if(0!==dt(e,0))break;if(((o=e.suspendedLanes)&r)!==r){ec(),e.pingedLanes|=e.suspendedLanes&o;break}e.timeoutHandle=no(bc.bind(null,e,Rl,Ul),t);break}bc(e,Rl,Ul);break;case 4:if(sc(e,r),(4194240&r)===r)break;for(t=e.eventTimes,o=-1;0<r;){var s=31-at(r);i=1<<s,(s=t[s])>o&&(o=s),r&=~i}if(r=o,10<(r=(120>(r=Xe()-r)?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Cl(r/1960))-r)){e.timeoutHandle=no(bc.bind(null,e,Rl,Ul),r);break}bc(e,Rl,Ul);break;default:throw Error(a(329))}}}return rc(e,Xe()),e.callbackNode===n?oc.bind(null,e):null}function ac(e,t){var n=Ll;return e.current.memoizedState.isDehydrated&&(pc(e,t).flags|=256),2!==(e=gc(e,t))&&(t=Rl,Rl=n,null!==t&&ic(t)),e}function ic(e){null===Rl?Rl=e:Rl.push.apply(Rl,e)}function sc(e,t){for(t&=~jl,t&=~Bl,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-at(t),r=1<<n;e[n]=-1,t&=~r}}function lc(e){if(0!==(6&Tl))throw Error(a(327));xc();var t=dt(e,0);if(0===(1&t))return rc(e,Xe()),null;var n=gc(e,t);if(0!==e.tag&&2===n){var r=ht(e);0!==r&&(t=r,n=ac(e,r))}if(1===n)throw n=Ol,pc(e,0),sc(e,t),rc(e,Xe()),n;if(6===n)throw Error(a(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,bc(e,Rl,Ul),rc(e,Xe()),null}function cc(e,t){var n=Tl;Tl|=1;try{return e(t)}finally{0===(Tl=n)&&(ql=Xe()+500,Lo&&qo())}}function uc(e){null!==Zl&&0===Zl.tag&&0===(6&Tl)&&xc();var t=Tl;Tl|=1;var n=El.transition,r=vt;try{if(El.transition=null,vt=1,e)return e()}finally{vt=r,El.transition=n,0===(6&(Tl=t))&&qo()}}function dc(){Il=Pl.current,Do(Pl)}function pc(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,ro(n)),null!==Ml)for(n=Ml.return;null!==n;){var r=n;switch(ta(r),r.tag){case 1:null!==(r=r.type.childContextTypes)&&void 0!==r&&Po();break;case 3:Xa(),Do(Ao),Do(To),ni();break;case 5:Qa(r);break;case 4:Xa();break;case 13:case 19:Do(Ya);break;case 10:Ea(r.type._context);break;case 22:case 23:dc()}n=n.return}if(Al=e,Ml=e=Pc(e.current,null),Fl=Il=t,zl=0,Ol=null,jl=Bl=Nl=0,Rl=Ll=null,null!==Fa){for(t=0;t<Fa.length;t++)if(null!==(r=(n=Fa[t]).interleaved)){n.interleaved=null;var o=r.next,a=n.pending;if(null!==a){var i=a.next;a.next=o,r.next=i}n.pending=r}Fa=null}return e}function hc(e,t){for(;;){var n=Ml;try{if(Sa(),ri.current=Ji,ci){for(var r=ii.memoizedState;null!==r;){var o=r.queue;null!==o&&(o.pending=null),r=r.next}ci=!1}if(ai=0,li=si=ii=null,ui=!1,di=0,Sl.current=null,null===n||null===n.return){zl=1,Ol=t,Ml=null;break}e:{var i=e,s=n.return,l=n,c=t;if(t=Fl,l.flags|=32768,null!==c&&"object"===typeof c&&"function"===typeof c.then){var u=c,d=l,p=d.tag;if(0===(1&d.mode)&&(0===p||11===p||15===p)){var h=d.alternate;h?(d.updateQueue=h.updateQueue,d.memoizedState=h.memoizedState,d.lanes=h.lanes):(d.updateQueue=null,d.memoizedState=null)}var f=ms(s);if(null!==f){f.flags&=-257,gs(f,s,l,0,t),1&f.mode&&fs(i,u,t),c=u;var m=(t=f).updateQueue;if(null===m){var g=new Set;g.add(c),t.updateQueue=g}else m.add(c);break e}if(0===(1&t)){fs(i,u,t),mc();break e}c=Error(a(426))}else if(oa&&1&l.mode){var _=ms(s);if(null!==_){0===(65536&_.flags)&&(_.flags|=256),gs(_,s,l,0,t),fa(ls(c,l));break e}}i=c=ls(c,l),4!==zl&&(zl=2),null===Ll?Ll=[i]:Ll.push(i),i=s;do{switch(i.tag){case 3:i.flags|=65536,t&=-t,i.lanes|=t,Va(i,ps(0,c,t));break e;case 1:l=c;var v=i.type,y=i.stateNode;if(0===(128&i.flags)&&("function"===typeof v.getDerivedStateFromError||null!==y&&"function"===typeof y.componentDidCatch&&(null===Hl||!Hl.has(y)))){i.flags|=65536,t&=-t,i.lanes|=t,Va(i,hs(i,l,t));break e}}i=i.return}while(null!==i)}wc(n)}catch(GC){t=GC,Ml===n&&null!==n&&(Ml=n=n.return);continue}break}}function fc(){var e=Dl.current;return Dl.current=Ji,null===e?Ji:e}function mc(){0!==zl&&3!==zl&&2!==zl||(zl=4),null===Al||0===(268435455&Nl)&&0===(268435455&Bl)||sc(Al,Fl)}function gc(e,t){var n=Tl;Tl|=2;var r=fc();for(Al===e&&Fl===t||(Ul=null,pc(e,t));;)try{_c();break}catch(AC){hc(e,AC)}if(Sa(),Tl=n,Dl.current=r,null!==Ml)throw Error(a(261));return Al=null,Fl=0,zl}function _c(){for(;null!==Ml;)yc(Ml)}function vc(){for(;null!==Ml&&!Ze();)yc(Ml)}function yc(e){var t=kl(e.alternate,e,Il);e.memoizedProps=e.pendingProps,null===t?wc(e):Ml=t,Sl.current=null}function wc(e){var t=e;do{var n=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(n=Ks(n,t,Il)))return void(Ml=n)}else{if(null!==(n=Zs(n,t)))return n.flags&=32767,void(Ml=n);if(null===e)return zl=6,void(Ml=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(Ml=t);Ml=t=e}while(null!==t);0===zl&&(zl=5)}function bc(e,t,n){var r=vt,o=El.transition;try{El.transition=null,vt=1,function(e,t,n,r){do{xc()}while(null!==Zl);if(0!==(6&Tl))throw Error(a(327));n=e.finishedWork;var o=e.finishedLanes;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(a(177));e.callbackNode=null,e.callbackPriority=0;var i=n.lanes|n.childLanes;if(function(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var o=31-at(n),a=1<<o;t[o]=0,r[o]=-1,e[o]=-1,n&=~a}}(e,i),e===Al&&(Ml=Al=null,Fl=0),0===(2064&n.subtreeFlags)&&0===(2064&n.flags)||Kl||(Kl=!0,Ac(et,(function(){return xc(),null}))),i=0!==(15990&n.flags),0!==(15990&n.subtreeFlags)||i){i=El.transition,El.transition=null;var s=vt;vt=1;var l=Tl;Tl|=4,Sl.current=null,function(e,t){if(Yr=Ut,pr(e=dr())){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var r=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(r&&0!==r.rangeCount){n=r.anchorNode;var o=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch(EE){n=null;break e}var s=0,l=-1,c=-1,u=0,d=0,p=e,h=null;t:for(;;){for(var f;p!==n||0!==o&&3!==p.nodeType||(l=s+o),p!==i||0!==r&&3!==p.nodeType||(c=s+r),3===p.nodeType&&(s+=p.nodeValue.length),null!==(f=p.firstChild);)h=p,p=f;for(;;){if(p===e)break t;if(h===n&&++u===o&&(l=s),h===i&&++d===r&&(c=s),null!==(f=p.nextSibling))break;h=(p=h).parentNode}p=f}n=-1===l||-1===c?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(eo={focusedElem:e,selectionRange:n},Ut=!1,Qs=t;null!==Qs;)if(e=(t=Qs).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,Qs=e;else for(;null!==Qs;){t=Qs;try{var m=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==m){var g=m.memoizedProps,_=m.memoizedState,v=t.stateNode,y=v.getSnapshotBeforeUpdate(t.elementType===t.type?g:ts(t.type,g),_);v.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var w=t.stateNode.containerInfo;1===w.nodeType?w.textContent="":9===w.nodeType&&w.documentElement&&w.removeChild(w.documentElement);break;default:throw Error(a(163))}}catch(EE){Cc(t,t.return,EE)}if(null!==(e=t.sibling)){e.return=t.return,Qs=e;break}Qs=t.return}m=tl,tl=!1}(e,n),gl(n,e),hr(eo),Ut=!!Yr,eo=Yr=null,e.current=n,vl(n,e,o),$e(),Tl=l,vt=s,El.transition=i}else e.current=n;if(Kl&&(Kl=!1,Zl=e,$l=o),i=e.pendingLanes,0===i&&(Hl=null),function(e){if(ot&&"function"===typeof ot.onCommitFiberRoot)try{ot.onCommitFiberRoot(rt,e,void 0,128===(128&e.current.flags))}catch(t){}}(n.stateNode),rc(e,Xe()),null!==t)for(r=e.onRecoverableError,n=0;n<t.length;n++)o=t[n],r(o.value,{componentStack:o.stack,digest:o.digest});if(Wl)throw Wl=!1,e=Gl,Gl=null,e;0!==(1&$l)&&0!==e.tag&&xc(),i=e.pendingLanes,0!==(1&i)?e===Jl?Xl++:(Xl=0,Jl=e):Xl=0,qo()}(e,t,n,r)}finally{El.transition=o,vt=r}return null}function xc(){if(null!==Zl){var e=yt($l),t=El.transition,n=vt;try{if(El.transition=null,vt=16>e?16:e,null===Zl)var r=!1;else{if(e=Zl,Zl=null,$l=0,0!==(6&Tl))throw Error(a(331));var o=Tl;for(Tl|=4,Qs=e.current;null!==Qs;){var i=Qs,s=i.child;if(0!==(16&Qs.flags)){var l=i.deletions;if(null!==l){for(var c=0;c<l.length;c++){var u=l[c];for(Qs=u;null!==Qs;){var d=Qs;switch(d.tag){case 0:case 11:case 15:nl(8,d,i)}var p=d.child;if(null!==p)p.return=d,Qs=p;else for(;null!==Qs;){var h=(d=Qs).sibling,f=d.return;if(al(d),d===u){Qs=null;break}if(null!==h){h.return=f,Qs=h;break}Qs=f}}}var m=i.alternate;if(null!==m){var g=m.child;if(null!==g){m.child=null;do{var _=g.sibling;g.sibling=null,g=_}while(null!==g)}}Qs=i}}if(0!==(2064&i.subtreeFlags)&&null!==s)s.return=i,Qs=s;else e:for(;null!==Qs;){if(0!==(2048&(i=Qs).flags))switch(i.tag){case 0:case 11:case 15:nl(9,i,i.return)}var v=i.sibling;if(null!==v){v.return=i.return,Qs=v;break e}Qs=i.return}}var y=e.current;for(Qs=y;null!==Qs;){var w=(s=Qs).child;if(0!==(2064&s.subtreeFlags)&&null!==w)w.return=s,Qs=w;else e:for(s=y;null!==Qs;){if(0!==(2048&(l=Qs).flags))try{switch(l.tag){case 0:case 11:case 15:rl(9,l)}}catch(GC){Cc(l,l.return,GC)}if(l===s){Qs=null;break e}var b=l.sibling;if(null!==b){b.return=l.return,Qs=b;break e}Qs=l.return}}if(Tl=o,qo(),ot&&"function"===typeof ot.onPostCommitFiberRoot)try{ot.onPostCommitFiberRoot(rt,e)}catch(GC){}r=!0}return r}finally{vt=n,El.transition=t}}return!1}function kc(e,t,n){e=La(e,t=ps(0,t=ls(n,t),1),1),t=ec(),null!==e&&(gt(e,1,t),rc(e,t))}function Cc(e,t,n){if(3===e.tag)kc(e,e,n);else for(;null!==t;){if(3===t.tag){kc(t,e,n);break}if(1===t.tag){var r=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof r.componentDidCatch&&(null===Hl||!Hl.has(r))){t=La(t,e=hs(t,e=ls(n,e),1),1),e=ec(),null!==t&&(gt(t,1,e),rc(t,e));break}}t=t.return}}function Dc(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),t=ec(),e.pingedLanes|=e.suspendedLanes&n,Al===e&&(Fl&n)===n&&(4===zl||3===zl&&(130023424&Fl)===Fl&&500>Xe()-Vl?pc(e,0):jl|=n),rc(e,t)}function Sc(e,t){0===t&&(0===(1&e.mode)?t=1:(t=ct,0===(130023424&(ct<<=1))&&(ct=4194304)));var n=ec();null!==(e=za(e,t))&&(gt(e,t,n),rc(e,n))}function Ec(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),Sc(e,n)}function Tc(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,o=e.memoizedState;null!==o&&(n=o.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(a(314))}null!==r&&r.delete(t),Sc(e,n)}function Ac(e,t){return He(e,t)}function Mc(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Fc(e,t,n,r){return new Mc(e,t,n,r)}function Ic(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Pc(e,t){var n=e.alternate;return null===n?((n=Fc(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function zc(e,t,n,r,o,i){var s=2;if(r=e,"function"===typeof e)Ic(e)&&(s=1);else if("string"===typeof e)s=5;else e:switch(e){case k:return Oc(n.children,o,i,t);case C:s=8,o|=8;break;case D:return(e=Fc(12,n,t,2|o)).elementType=D,e.lanes=i,e;case A:return(e=Fc(13,n,t,o)).elementType=A,e.lanes=i,e;case M:return(e=Fc(19,n,t,o)).elementType=M,e.lanes=i,e;case P:return Nc(n,o,i,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case S:s=10;break e;case E:s=9;break e;case T:s=11;break e;case F:s=14;break e;case I:s=16,r=null;break e}throw Error(a(130,null==e?e:typeof e,""))}return(t=Fc(s,n,t,o)).elementType=e,t.type=r,t.lanes=i,t}function Oc(e,t,n,r){return(e=Fc(7,e,r,t)).lanes=n,e}function Nc(e,t,n,r){return(e=Fc(22,e,r,t)).elementType=P,e.lanes=n,e.stateNode={isHidden:!1},e}function Bc(e,t,n){return(e=Fc(6,e,null,t)).lanes=n,e}function jc(e,t,n){return(t=Fc(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Lc(e,t,n,r,o){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=mt(0),this.expirationTimes=mt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=mt(0),this.identifierPrefix=r,this.onRecoverableError=o,this.mutableSourceEagerHydrationData=null}function Rc(e,t,n,r,o,a,i,s,l){return e=new Lc(e,t,n,s,l),1===t?(t=1,!0===a&&(t|=8)):t=0,a=Fc(3,null,null,t),e.current=a,a.stateNode=e,a.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Na(a),e}function Vc(e){if(!e)return Eo;e:{if(Ve(e=e._reactInternals)!==e||1!==e.tag)throw Error(a(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Io(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(a(171))}if(1===e.tag){var n=e.type;if(Io(n))return Oo(e,n,t)}return t}function qc(e,t,n,r,o,a,i,s,l){return(e=Rc(n,r,!0,e,0,a,0,s,l)).context=Vc(null),n=e.current,(a=ja(r=ec(),o=tc(n))).callback=void 0!==t&&null!==t?t:null,La(n,a,o),e.current.lanes=o,gt(e,o,r),rc(e,r),e}function Uc(e,t,n,r){var o=t.current,a=ec(),i=tc(o);return n=Vc(n),null===t.context?t.context=n:t.pendingContext=n,(t=ja(a,i)).payload={element:e},null!==(r=void 0===r?null:r)&&(t.callback=r),null!==(e=La(o,t,i))&&(nc(e,o,i,a),Ra(e,o,i)),i}function Wc(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function Gc(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function Hc(e,t){Gc(e,t),(e=e.alternate)&&Gc(e,t)}kl=function(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps||Ao.current)vs=!0;else{if(0===(e.lanes&n)&&0===(128&t.flags))return vs=!1,function(e,t,n){switch(t.tag){case 3:Ts(t),ha();break;case 5:Ja(t);break;case 1:Io(t.type)&&No(t);break;case 4:$a(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,o=t.memoizedProps.value;So(xa,r._currentValue),r._currentValue=o;break;case 13:if(null!==(r=t.memoizedState))return null!==r.dehydrated?(So(Ya,1&Ya.current),t.flags|=128,null):0!==(n&t.child.childLanes)?Ns(e,t,n):(So(Ya,1&Ya.current),null!==(e=Ws(e,t,n))?e.sibling:null);So(Ya,1&Ya.current);break;case 19:if(r=0!==(n&t.childLanes),0!==(128&e.flags)){if(r)return qs(e,t,n);t.flags|=128}if(null!==(o=t.memoizedState)&&(o.rendering=null,o.tail=null,o.lastEffect=null),So(Ya,Ya.current),r)break;return null;case 22:case 23:return t.lanes=0,ks(e,t,n)}return Ws(e,t,n)}(e,t,n);vs=0!==(131072&e.flags)}else vs=!1,oa&&0!==(1048576&t.flags)&&Yo(t,Ho,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;Us(e,t),e=t.pendingProps;var o=Fo(t,To.current);Aa(t,n),o=mi(null,t,r,e,o,n);var i=gi();return t.flags|=1,"object"===typeof o&&null!==o&&"function"===typeof o.render&&void 0===o.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Io(r)?(i=!0,No(t)):i=!1,t.memoizedState=null!==o.state&&void 0!==o.state?o.state:null,Na(t),o.updater=rs,t.stateNode=o,o._reactInternals=t,ss(t,r,e,n),t=Es(null,t,r,!0,i,n)):(t.tag=0,oa&&i&&ea(t),ys(null,t,o,n),t=t.child),t;case 16:r=t.elementType;e:{switch(Us(e,t),e=t.pendingProps,r=(o=r._init)(r._payload),t.type=r,o=t.tag=function(e){if("function"===typeof e)return Ic(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===T)return 11;if(e===F)return 14}return 2}(r),e=ts(r,e),o){case 0:t=Ds(null,t,r,e,n);break e;case 1:t=Ss(null,t,r,e,n);break e;case 11:t=ws(null,t,r,e,n);break e;case 14:t=bs(null,t,r,ts(r.type,e),n);break e}throw Error(a(306,r,""))}return t;case 0:return r=t.type,o=t.pendingProps,Ds(e,t,r,o=t.elementType===r?o:ts(r,o),n);case 1:return r=t.type,o=t.pendingProps,Ss(e,t,r,o=t.elementType===r?o:ts(r,o),n);case 3:e:{if(Ts(t),null===e)throw Error(a(387));r=t.pendingProps,o=(i=t.memoizedState).element,Ba(e,t),qa(t,r,null,n);var s=t.memoizedState;if(r=s.element,i.isDehydrated){if(i={element:r,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},t.updateQueue.baseState=i,t.memoizedState=i,256&t.flags){t=As(e,t,r,n,o=ls(Error(a(423)),t));break e}if(r!==o){t=As(e,t,r,n,o=ls(Error(a(424)),t));break e}for(ra=lo(t.stateNode.containerInfo.firstChild),na=t,oa=!0,aa=null,n=ba(t,null,r,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(ha(),r===o){t=Ws(e,t,n);break e}ys(e,t,r,n)}t=t.child}return t;case 5:return Ja(t),null===e&&ca(t),r=t.type,o=t.pendingProps,i=null!==e?e.memoizedProps:null,s=o.children,to(r,o)?s=null:null!==i&&to(r,i)&&(t.flags|=32),Cs(e,t),ys(e,t,s,n),t.child;case 6:return null===e&&ca(t),null;case 13:return Ns(e,t,n);case 4:return $a(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=wa(t,null,r,n):ys(e,t,r,n),t.child;case 11:return r=t.type,o=t.pendingProps,ws(e,t,r,o=t.elementType===r?o:ts(r,o),n);case 7:return ys(e,t,t.pendingProps,n),t.child;case 8:case 12:return ys(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,o=t.pendingProps,i=t.memoizedProps,s=o.value,So(xa,r._currentValue),r._currentValue=s,null!==i)if(ir(i.value,s)){if(i.children===o.children&&!Ao.current){t=Ws(e,t,n);break e}}else for(null!==(i=t.child)&&(i.return=t);null!==i;){var l=i.dependencies;if(null!==l){s=i.child;for(var c=l.firstContext;null!==c;){if(c.context===r){if(1===i.tag){(c=ja(-1,n&-n)).tag=2;var u=i.updateQueue;if(null!==u){var d=(u=u.shared).pending;null===d?c.next=c:(c.next=d.next,d.next=c),u.pending=c}}i.lanes|=n,null!==(c=i.alternate)&&(c.lanes|=n),Ta(i.return,n,t),l.lanes|=n;break}c=c.next}}else if(10===i.tag)s=i.type===t.type?null:i.child;else if(18===i.tag){if(null===(s=i.return))throw Error(a(341));s.lanes|=n,null!==(l=s.alternate)&&(l.lanes|=n),Ta(s,n,t),s=i.sibling}else s=i.child;if(null!==s)s.return=i;else for(s=i;null!==s;){if(s===t){s=null;break}if(null!==(i=s.sibling)){i.return=s.return,s=i;break}s=s.return}i=s}ys(e,t,o.children,n),t=t.child}return t;case 9:return o=t.type,r=t.pendingProps.children,Aa(t,n),r=r(o=Ma(o)),t.flags|=1,ys(e,t,r,n),t.child;case 14:return o=ts(r=t.type,t.pendingProps),bs(e,t,r,o=ts(r.type,o),n);case 15:return xs(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,o=t.pendingProps,o=t.elementType===r?o:ts(r,o),Us(e,t),t.tag=1,Io(r)?(e=!0,No(t)):e=!1,Aa(t,n),as(t,r,o),ss(t,r,o,n),Es(null,t,r,!0,e,n);case 19:return qs(e,t,n);case 22:return ks(e,t,n)}throw Error(a(156,t.tag))};var Kc="function"===typeof reportError?reportError:function(e){console.error(e)};function Zc(e){this._internalRoot=e}function $c(e){this._internalRoot=e}function Xc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Jc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Qc(){}function Yc(e,t,n,r,o){var a=n._reactRootContainer;if(a){var i=a;if("function"===typeof o){var s=o;o=function(){var e=Wc(i);s.call(e)}}Uc(t,i,e,o)}else i=function(e,t,n,r,o){if(o){if("function"===typeof r){var a=r;r=function(){var e=Wc(i);a.call(e)}}var i=qc(t,r,e,0,null,!1,0,"",Qc);return e._reactRootContainer=i,e[fo]=i.current,Vr(8===e.nodeType?e.parentNode:e),uc(),i}for(;o=e.lastChild;)e.removeChild(o);if("function"===typeof r){var s=r;r=function(){var e=Wc(l);s.call(e)}}var l=Rc(e,0,!1,null,0,!1,0,"",Qc);return e._reactRootContainer=l,e[fo]=l.current,Vr(8===e.nodeType?e.parentNode:e),uc((function(){Uc(t,l,n,r)})),l}(n,t,e,o,r);return Wc(i)}$c.prototype.render=Zc.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(a(409));Uc(e,t,null,null)},$c.prototype.unmount=Zc.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;uc((function(){Uc(null,e,null,null)})),t[fo]=null}},$c.prototype.unstable_scheduleHydration=function(e){if(e){var t=kt();e={blockedOn:null,target:e,priority:t};for(var n=0;n<It.length&&0!==t&&t<It[n].priority;n++);It.splice(n,0,e),0===n&&Nt(e)}},wt=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=ut(t.pendingLanes);0!==n&&(_t(t,1|n),rc(t,Xe()),0===(6&Tl)&&(ql=Xe()+500,qo()))}break;case 13:uc((function(){var t=za(e,1);if(null!==t){var n=ec();nc(t,e,1,n)}})),Hc(e,1)}},bt=function(e){if(13===e.tag){var t=za(e,134217728);if(null!==t)nc(t,e,134217728,ec());Hc(e,134217728)}},xt=function(e){if(13===e.tag){var t=tc(e),n=za(e,t);if(null!==n)nc(n,e,t,ec());Hc(e,t)}},kt=function(){return vt},Ct=function(e,t){var n=vt;try{return vt=e,t()}finally{vt=n}},be=function(e,t,n){switch(t){case"input":if(Q(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var o=bo(r);if(!o)throw Error(a(90));K(r),Q(r,o)}}}break;case"textarea":ae(e,n);break;case"select":null!=(t=n.value)&&ne(e,!!n.multiple,t,!1)}},Ee=cc,Te=uc;var eu={usingClientEntryPoint:!1,Events:[yo,wo,bo,De,Se,cc]},tu={findFiberByHostInstance:vo,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},nu={bundleType:tu.bundleType,version:tu.version,rendererPackageName:tu.rendererPackageName,rendererConfig:tu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:w.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=We(e))?null:e.stateNode},findFiberByHostInstance:tu.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var ru=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ru.isDisabled&&ru.supportsFiber)try{rt=ru.inject(nu),ot=ru}catch(ou){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=eu,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Xc(t))throw Error(a(200));return function(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:x,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.createRoot=function(e,t){if(!Xc(e))throw Error(a(299));var n=!1,r="",o=Kc;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(r=t.identifierPrefix),void 0!==t.onRecoverableError&&(o=t.onRecoverableError)),t=Rc(e,1,!1,null,0,n,0,r,o),e[fo]=t.current,Vr(8===e.nodeType?e.parentNode:e),new Zc(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(a(188));throw e=Object.keys(e).join(","),Error(a(268,e))}return e=null===(e=We(t))?null:e.stateNode},t.flushSync=function(e){return uc(e)},t.hydrate=function(e,t,n){if(!Jc(t))throw Error(a(200));return Yc(null,e,t,!0,n)},t.hydrateRoot=function(e,t,n){if(!Xc(e))throw Error(a(405));var r=null!=n&&n.hydratedSources||null,o=!1,i="",s=Kc;if(null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(o=!0),void 0!==n.identifierPrefix&&(i=n.identifierPrefix),void 0!==n.onRecoverableError&&(s=n.onRecoverableError)),t=qc(t,null,e,1,null!=n?n:null,o,0,i,s),e[fo]=t.current,Vr(e),r)for(e=0;e<r.length;e++)o=(o=(n=r[e])._getVersion)(n._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[n,o]:t.mutableSourceEagerHydrationData.push(n,o);return new $c(t)},t.render=function(e,t,n){if(!Jc(t))throw Error(a(200));return Yc(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!Jc(e))throw Error(a(40));return!!e._reactRootContainer&&(uc((function(){Yc(null,null,e,!1,(function(){e._reactRootContainer=null,e[fo]=null}))})),!0)},t.unstable_batchedUpdates=cc,t.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!Jc(n))throw Error(a(200));if(null==e||void 0===e._reactInternals)throw Error(a(38));return Yc(e,t,n,!1,r)},t.version="18.3.1-next-f1338f8080-20240426"},812:e=>{var t,n=Object.defineProperty,r=Object.getOwnPropertyDescriptor,o=Object.getOwnPropertyNames,a=Object.prototype.hasOwnProperty,i={};((e,t)=>{for(var r in t)n(e,r,{get:t[r],enumerable:!0})})(i,{SYMBOL_FOR_REQ_CONTEXT:()=>s,getContext:()=>l}),e.exports=(t=i,((e,t,i,s)=>{if(t&&"object"===typeof t||"function"===typeof t)for(let l of o(t))a.call(e,l)||l===i||n(e,l,{get:()=>t[l],enumerable:!(s=r(t,l))||s.enumerable});return e})(n({},"__esModule",{value:!0}),t));const s=Symbol.for("@vercel/request-context");function l(){var e,t,n;return null!==(e=null===(t=globalThis[s])||void 0===t||null===(n=t.get)||void 0===n?void 0:n.call(t))&&void 0!==e?e:{}}},853:(e,t,n)=>{e.exports=n(234)},950:(e,t,n)=>{!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(730)}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var a=t[r]={exports:{}};return e[r](a,a.exports,n),a.exports}n.m=e,(()=>{var e,t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__;n.t=function(r,o){if(1&o&&(r=this(r)),8&o)return r;if("object"===typeof r&&r){if(4&o&&r.__esModule)return r;if(16&o&&"function"===typeof r.then)return r}var a=Object.create(null);n.r(a);var i={};e=e||[null,t({}),t([]),t(t)];for(var s=2&o&&r;"object"==typeof s&&!~e.indexOf(s);s=t(s))Object.getOwnPropertyNames(s).forEach((e=>i[e]=()=>r[e]));return i.default=()=>r,n.d(a,i),a}})(),n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(AC){if("object"===typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.p="/llm-consistency-vis/",n.b=document.baseURI||self.location.href;var r={};n.r(r),n.d(r,{InferenceSession:()=>TC,TRACE:()=>kC,TRACE_FUNC_BEGIN:()=>DC,TRACE_FUNC_END:()=>SC,Tensor:()=>xC,env:()=>gC,registerBackend:()=>pC});var o={};n.r(o),n.d(o,{InferenceSession:()=>iD,TRACE:()=>tD,TRACE_FUNC_BEGIN:()=>rD,TRACE_FUNC_END:()=>oD,Tensor:()=>eD,default:()=>qN,env:()=>jC,registerBackend:()=>IC});var a=n(43),i=n.t(a,2),s=n(391);function l(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];throw new Error("number"===typeof e?"[MobX] minified error nr: "+e+(n.length?" "+n.map(String).join(","):"")+". Find the full error at: https://github.com/mobxjs/mobx/blob/main/packages/mobx/src/errors.ts":"[MobX] "+e)}var c={};function u(){return"undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof n.g?n.g:"undefined"!==typeof self?self:c}var d=Object.assign,p=Object.getOwnPropertyDescriptor,h=Object.defineProperty,f=Object.prototype,m=[];Object.freeze(m);var g={};Object.freeze(g);var _="undefined"!==typeof Proxy,v=Object.toString();function y(){_||l("Proxy not available")}function w(e){var t=!1;return function(){if(!t)return t=!0,e.apply(this,arguments)}}var b=function(){};function x(e){return"function"===typeof e}function k(e){switch(typeof e){case"string":case"symbol":case"number":return!0}return!1}function C(e){return null!==e&&"object"===typeof e}function D(e){if(!C(e))return!1;var t=Object.getPrototypeOf(e);if(null==t)return!0;var n=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return"function"===typeof n&&n.toString()===v}function S(e){var t=null==e?void 0:e.constructor;return!!t&&("GeneratorFunction"===t.name||"GeneratorFunction"===t.displayName)}function E(e,t,n){h(e,t,{enumerable:!1,writable:!0,configurable:!0,value:n})}function T(e,t,n){h(e,t,{enumerable:!1,writable:!1,configurable:!0,value:n})}function A(e,t){var n="isMobX"+e;return t.prototype[n]=!0,function(e){return C(e)&&!0===e[n]}}function M(e){return null!=e&&"[object Map]"===Object.prototype.toString.call(e)}function F(e){return null!=e&&"[object Set]"===Object.prototype.toString.call(e)}var I="undefined"!==typeof Object.getOwnPropertySymbols;var P="undefined"!==typeof Reflect&&Reflect.ownKeys?Reflect.ownKeys:I?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Object.getOwnPropertyNames;function z(e){return null===e?null:"object"===typeof e?""+e:e}function O(e,t){return f.hasOwnProperty.call(e,t)}var N=Object.getOwnPropertyDescriptors||function(e){var t={};return P(e).forEach((function(n){t[n]=p(e,n)})),t};function B(e,t){return!!(e&t)}function j(e,t,n){return n?e|=t:e&=~t,e}function L(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function R(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,H(r.key),r)}}function V(e,t,n){return t&&R(e.prototype,t),n&&R(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function q(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return L(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?L(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function U(){return U=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},U.apply(null,arguments)}function W(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,G(e,t)}function G(e,t){return G=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},G(e,t)}function H(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}var K=Symbol("mobx-stored-annotations");function Z(e){return Object.assign((function(t,n){if(X(n))return e.decorate_20223_(t,n);$(t,n,e)}),e)}function $(e,t,n){O(e,K)||E(e,K,U({},e[K])),function(e){return e.annotationType_===oe}(n)||(e[K][t]=n)}function X(e){return"object"==typeof e&&"string"==typeof e.kind}var J=Symbol("mobx administration"),Q=function(){function e(e){void 0===e&&(e="Atom"),this.name_=void 0,this.flags_=0,this.observers_=new Set,this.lastAccessedBy_=0,this.lowestObserverState_=rt.NOT_TRACKING_,this.onBOL=void 0,this.onBUOL=void 0,this.name_=e}var t=e.prototype;return t.onBO=function(){this.onBOL&&this.onBOL.forEach((function(e){return e()}))},t.onBUO=function(){this.onBUOL&&this.onBUOL.forEach((function(e){return e()}))},t.reportObserved=function(){return Et(this)},t.reportChanged=function(){Dt(),Tt(this),St()},t.toString=function(){return this.name_},V(e,[{key:"isBeingObserved",get:function(){return B(this.flags_,e.isBeingObservedMask_)},set:function(t){this.flags_=j(this.flags_,e.isBeingObservedMask_,t)}},{key:"isPendingUnobservation",get:function(){return B(this.flags_,e.isPendingUnobservationMask_)},set:function(t){this.flags_=j(this.flags_,e.isPendingUnobservationMask_,t)}},{key:"diffValue",get:function(){return B(this.flags_,e.diffValueMask_)?1:0},set:function(t){this.flags_=j(this.flags_,e.diffValueMask_,1===t)}}])}();Q.isBeingObservedMask_=1,Q.isPendingUnobservationMask_=2,Q.diffValueMask_=4;var Y=A("Atom",Q);function ee(e,t,n){void 0===t&&(t=b),void 0===n&&(n=b);var r,o=new Q(e);return t!==b&&Qt($t,o,t,r),n!==b&&Jt(o,n),o}var te={identity:function(e,t){return e===t},structural:function(e,t){return vr(e,t)},default:function(e,t){return Object.is?Object.is(e,t):e===t?0!==e||1/e===1/t:e!==e&&t!==t},shallow:function(e,t){return vr(e,t,1)}};function ne(e,t,n){return hn(e)?e:Array.isArray(e)?Ve.array(e,{name:n}):D(e)?Ve.object(e,void 0,{name:n}):M(e)?Ve.map(e,{name:n}):F(e)?Ve.set(e,{name:n}):"function"!==typeof e||Gt(e)||dn(e)?e:S(e)?cn(e):Wt(n,e)}function re(e){return e}var oe="override";function ae(e,t){return{annotationType_:e,options_:t,make_:ie,extend_:se,decorate_20223_:le}}function ie(e,t,n,r){var o;if(null!=(o=this.options_)&&o.bound)return null===this.extend_(e,t,n,!1)?0:1;if(r===e.target_)return null===this.extend_(e,t,n,!1)?0:2;if(Gt(n.value))return 1;var a=ce(e,this,t,n,!1);return h(r,t,a),2}function se(e,t,n,r){var o=ce(e,this,t,n);return e.defineProperty_(t,o,r)}function le(e,t){var n,r=t.kind,o=t.name,a=t.addInitializer,i=this,s=function(e){var t,n,r,a;return Xe(null!=(t=null==(n=i.options_)?void 0:n.name)?t:o.toString(),e,null!=(r=null==(a=i.options_)?void 0:a.autoAction)&&r)};return"field"==r?function(e){var t,n=e;return Gt(n)||(n=s(n)),null!=(t=i.options_)&&t.bound&&((n=n.bind(this)).isMobxAction=!0),n}:"method"==r?(Gt(e)||(e=s(e)),null!=(n=this.options_)&&n.bound&&a((function(){var e=this,t=e[o].bind(e);t.isMobxAction=!0,e[o]=t})),e):void l("Cannot apply '"+i.annotationType_+"' to '"+String(o)+"' (kind: "+r+"):\n'"+i.annotationType_+"' can only be used on properties with a function value.")}function ce(e,t,n,r,o){var a,i,s,l,c,u,d,p;void 0===o&&(o=bt.safeDescriptors),p=r,t.annotationType_,p.value;var h,f=r.value;null!=(a=t.options_)&&a.bound&&(f=f.bind(null!=(h=e.proxy_)?h:e.target_));return{value:Xe(null!=(i=null==(s=t.options_)?void 0:s.name)?i:n.toString(),f,null!=(l=null==(c=t.options_)?void 0:c.autoAction)&&l,null!=(u=t.options_)&&u.bound?null!=(d=e.proxy_)?d:e.target_:void 0),configurable:!o||e.isPlainObject_,enumerable:!1,writable:!o}}function ue(e,t){return{annotationType_:e,options_:t,make_:de,extend_:pe,decorate_20223_:he}}function de(e,t,n,r){var o;if(r===e.target_)return null===this.extend_(e,t,n,!1)?0:2;if(null!=(o=this.options_)&&o.bound&&(!O(e.target_,t)||!dn(e.target_[t]))&&null===this.extend_(e,t,n,!1))return 0;if(dn(n.value))return 1;var a=fe(e,this,t,n,!1,!1);return h(r,t,a),2}function pe(e,t,n,r){var o,a=fe(e,this,t,n,null==(o=this.options_)?void 0:o.bound);return e.defineProperty_(t,a,r)}function he(e,t){var n;var r=t.name,o=t.addInitializer;return dn(e)||(e=cn(e)),null!=(n=this.options_)&&n.bound&&o((function(){var e=this,t=e[r].bind(e);t.isMobXFlow=!0,e[r]=t})),e}function fe(e,t,n,r,o,a){var i;void 0===a&&(a=bt.safeDescriptors),i=r,t.annotationType_,i.value;var s,l=r.value;(dn(l)||(l=cn(l)),o)&&((l=l.bind(null!=(s=e.proxy_)?s:e.target_)).isMobXFlow=!0);return{value:l,configurable:!a||e.isPlainObject_,enumerable:!1,writable:!a}}function me(e,t){return{annotationType_:e,options_:t,make_:ge,extend_:_e,decorate_20223_:ve}}function ge(e,t,n){return null===this.extend_(e,t,n,!1)?0:1}function _e(e,t,n,r){return function(e,t,n,r){t.annotationType_,r.get;0}(0,this,0,n),e.defineComputedProperty_(t,U({},this.options_,{get:n.get,set:n.set}),r)}function ve(e,t){var n=this,r=t.name;return(0,t.addInitializer)((function(){var t=$n(this)[J],o=U({},n.options_,{get:e,context:this});o.name||(o.name="ObservableObject."+r.toString()),t.values_.set(r,new nt(o))})),function(){return this[J].getObservablePropValue_(r)}}function ye(e,t){return{annotationType_:e,options_:t,make_:we,extend_:be,decorate_20223_:xe}}function we(e,t,n){return null===this.extend_(e,t,n,!1)?0:1}function be(e,t,n,r){var o,a;return function(e,t){t.annotationType_;0}(0,this),e.defineObservableProperty_(t,n.value,null!=(o=null==(a=this.options_)?void 0:a.enhancer)?o:ne,r)}function xe(e,t){var n=this,r=t.kind,o=t.name,a=new WeakSet;function i(e,t){var r,i,s=$n(e)[J],l=new tt(t,null!=(r=null==(i=n.options_)?void 0:i.enhancer)?r:ne,"ObservableObject."+o.toString(),!1);s.values_.set(o,l),a.add(e)}if("accessor"==r)return{get:function(){return a.has(this)||i(this,e.get.call(this)),this[J].getObservablePropValue_(o)},set:function(e){return a.has(this)||i(this,e),this[J].setObservablePropValue_(o,e)},init:function(e){return a.has(this)||i(this,e),e}}}var ke="true",Ce=De();function De(e){return{annotationType_:ke,options_:e,make_:Se,extend_:Ee,decorate_20223_:Te}}function Se(e,t,n,r){var o,a,i,s;if(n.get)return Ge.make_(e,t,n,r);if(n.set){var l=Xe(t.toString(),n.set);return r===e.target_?null===e.defineProperty_(t,{configurable:!bt.safeDescriptors||e.isPlainObject_,set:l})?0:2:(h(r,t,{configurable:!0,set:l}),2)}if(r!==e.target_&&"function"===typeof n.value)return S(n.value)?(null!=(s=this.options_)&&s.autoBind?cn.bound:cn).make_(e,t,n,r):(null!=(i=this.options_)&&i.autoBind?Wt.bound:Wt).make_(e,t,n,r);var c,u=!1===(null==(o=this.options_)?void 0:o.deep)?Ve.ref:Ve;"function"===typeof n.value&&null!=(a=this.options_)&&a.autoBind&&(n.value=n.value.bind(null!=(c=e.proxy_)?c:e.target_));return u.make_(e,t,n,r)}function Ee(e,t,n,r){var o,a,i;if(n.get)return Ge.extend_(e,t,n,r);if(n.set)return e.defineProperty_(t,{configurable:!bt.safeDescriptors||e.isPlainObject_,set:Xe(t.toString(),n.set)},r);"function"===typeof n.value&&null!=(o=this.options_)&&o.autoBind&&(n.value=n.value.bind(null!=(i=e.proxy_)?i:e.target_));return(!1===(null==(a=this.options_)?void 0:a.deep)?Ve.ref:Ve).extend_(e,t,n,r)}function Te(e,t){l("'"+this.annotationType_+"' cannot be used as a decorator")}var Ae={deep:!0,name:void 0,defaultDecorator:void 0,proxy:!0};function Me(e){return e||Ae}Object.freeze(Ae);var Fe=ye("observable"),Ie=ye("observable.ref",{enhancer:re}),Pe=ye("observable.shallow",{enhancer:function(e,t,n){return void 0===e||null===e||Qn(e)||On(e)||Rn(e)||Wn(e)?e:Array.isArray(e)?Ve.array(e,{name:n,deep:!1}):D(e)?Ve.object(e,void 0,{name:n,deep:!1}):M(e)?Ve.map(e,{name:n,deep:!1}):F(e)?Ve.set(e,{name:n,deep:!1}):void 0}}),ze=ye("observable.struct",{enhancer:function(e,t){return vr(e,t)?t:e}}),Oe=Z(Fe);function Ne(e){return!0===e.deep?ne:!1===e.deep?re:function(e){var t,n;return e&&null!=(t=null==(n=e.options_)?void 0:n.enhancer)?t:ne}(e.defaultDecorator)}function Be(e,t,n){return X(t)?Fe.decorate_20223_(e,t):k(t)?void $(e,t,Fe):hn(e)?e:D(e)?Ve.object(e,t,n):Array.isArray(e)?Ve.array(e,t):M(e)?Ve.map(e,t):F(e)?Ve.set(e,t):"object"===typeof e&&null!==e?e:Ve.box(e,t)}d(Be,Oe);var je,Le,Re={box:function(e,t){var n=Me(t);return new tt(e,Ne(n),n.name,!0,n.equals)},array:function(e,t){var n=Me(t);return(!1===bt.useProxies||!1===n.proxy?dr:Tn)(e,Ne(n),n.name)},map:function(e,t){var n=Me(t);return new Ln(e,Ne(n),n.name)},set:function(e,t){var n=Me(t);return new Un(e,Ne(n),n.name)},object:function(e,t,n){return mr((function(){return tn(!1===bt.useProxies||!1===(null==n?void 0:n.proxy)?$n({},n):function(e,t){var n,r;return y(),e=$n(e,t),null!=(r=(n=e[J]).proxy_)?r:n.proxy_=new Proxy(e,gn)}({},n),e,t)}))},ref:Z(Ie),shallow:Z(Pe),deep:Oe,struct:Z(ze)},Ve=d(Be,Re),qe="computed",Ue=me(qe),We=me("computed.struct",{equals:te.structural}),Ge=function(e,t){if(X(t))return Ue.decorate_20223_(e,t);if(k(t))return $(e,t,Ue);if(D(e))return Z(me(qe,e));var n=D(t)?t:{};return n.get=e,n.name||(n.name=e.name||""),new nt(n)};Object.assign(Ge,Ue),Ge.struct=Z(We);var He=0,Ke=1,Ze=null!=(je=null==(Le=p((function(){}),"name"))?void 0:Le.configurable)&&je,$e={value:"action",configurable:!0,writable:!1,enumerable:!1};function Xe(e,t,n,r){function o(){return Je(e,n,t,r||this,arguments)}return void 0===n&&(n=!1),o.isMobxAction=!0,o.toString=function(){return t.toString()},Ze&&($e.value=e,h(o,"name",$e)),o}function Je(e,t,n,r,o){var a=function(e,t){var n=!1,r=0;0;var o=bt.trackingDerivation,a=!t||!o;Dt();var i=bt.allowStateChanges;a&&(ht(),i=Ye(!0));var s=mt(!0),l={runAsAction_:a,prevDerivation_:o,prevAllowStateChanges_:i,prevAllowStateReads_:s,notifySpy_:n,startTime_:r,actionId_:Ke++,parentActionId_:He};return He=l.actionId_,l}(0,t);try{return n.apply(r,o)}catch(i){throw a.error_=i,i}finally{!function(e){He!==e.actionId_&&l(30);He=e.parentActionId_,void 0!==e.error_&&(bt.suppressReactionErrors=!0);et(e.prevAllowStateChanges_),gt(e.prevAllowStateReads_),St(),e.runAsAction_&&ft(e.prevDerivation_);0;bt.suppressReactionErrors=!1}(a)}}function Qe(e,t){var n=Ye(e);try{return t()}finally{et(n)}}function Ye(e){var t=bt.allowStateChanges;return bt.allowStateChanges=e,t}function et(e){bt.allowStateChanges=e}var tt=function(e){function t(t,n,r,o,a){var i;return void 0===r&&(r="ObservableValue"),void 0===o&&(o=!0),void 0===a&&(a=te.default),(i=e.call(this,r)||this).enhancer=void 0,i.name_=void 0,i.equals=void 0,i.hasUnreportedChange_=!1,i.interceptors_=void 0,i.changeListeners_=void 0,i.value_=void 0,i.dehancer=void 0,i.enhancer=n,i.name_=r,i.equals=a,i.value_=n(t,void 0,r),i}W(t,e);var n=t.prototype;return n.dehanceValue=function(e){return void 0!==this.dehancer?this.dehancer(e):e},n.set=function(e){this.value_;if((e=this.prepareNewValue_(e))!==bt.UNCHANGED){0,this.setNewValue_(e)}},n.prepareNewValue_=function(e){if(ct(this),_n(this)){var t=yn(this,{object:this,type:Dn,newValue:e});if(!t)return bt.UNCHANGED;e=t.newValue}return e=this.enhancer(e,this.value_,this.name_),this.equals(this.value_,e)?bt.UNCHANGED:e},n.setNewValue_=function(e){var t=this.value_;this.value_=e,this.reportChanged(),wn(this)&&xn(this,{type:Dn,object:this,newValue:e,oldValue:t})},n.get=function(){return this.reportObserved(),this.dehanceValue(this.value_)},n.intercept_=function(e){return vn(this,e)},n.observe_=function(e,t){return t&&e({observableKind:"value",debugObjectName:this.name_,object:this,type:Dn,newValue:this.value_,oldValue:void 0}),bn(this,e)},n.raw=function(){return this.value_},n.toJSON=function(){return this.get()},n.toString=function(){return this.name_+"["+this.value_+"]"},n.valueOf=function(){return z(this.get())},n[Symbol.toPrimitive]=function(){return this.valueOf()},t}(Q),nt=function(){function e(e){this.dependenciesState_=rt.NOT_TRACKING_,this.observing_=[],this.newObserving_=null,this.observers_=new Set,this.runId_=0,this.lastAccessedBy_=0,this.lowestObserverState_=rt.UP_TO_DATE_,this.unboundDepsCount_=0,this.value_=new it(null),this.name_=void 0,this.triggeredBy_=void 0,this.flags_=0,this.derivation=void 0,this.setter_=void 0,this.isTracing_=ot.NONE,this.scope_=void 0,this.equals_=void 0,this.requiresReaction_=void 0,this.keepAlive_=void 0,this.onBOL=void 0,this.onBUOL=void 0,e.get||l(31),this.derivation=e.get,this.name_=e.name||"ComputedValue",e.set&&(this.setter_=Xe("ComputedValue-setter",e.set)),this.equals_=e.equals||(e.compareStructural||e.struct?te.structural:te.default),this.scope_=e.context,this.requiresReaction_=e.requiresReaction,this.keepAlive_=!!e.keepAlive}var t=e.prototype;return t.onBecomeStale_=function(){!function(e){if(e.lowestObserverState_!==rt.UP_TO_DATE_)return;e.lowestObserverState_=rt.POSSIBLY_STALE_,e.observers_.forEach((function(e){e.dependenciesState_===rt.UP_TO_DATE_&&(e.dependenciesState_=rt.POSSIBLY_STALE_,e.onBecomeStale_())}))}(this)},t.onBO=function(){this.onBOL&&this.onBOL.forEach((function(e){return e()}))},t.onBUO=function(){this.onBUOL&&this.onBUOL.forEach((function(e){return e()}))},t.get=function(){if(this.isComputing&&l(32,this.name_,this.derivation),0!==bt.inBatch||0!==this.observers_.size||this.keepAlive_){if(Et(this),lt(this)){var e=bt.trackingContext;this.keepAlive_&&!e&&(bt.trackingContext=this),this.trackAndCompute()&&function(e){if(e.lowestObserverState_===rt.STALE_)return;e.lowestObserverState_=rt.STALE_,e.observers_.forEach((function(t){t.dependenciesState_===rt.POSSIBLY_STALE_?t.dependenciesState_=rt.STALE_:t.dependenciesState_===rt.UP_TO_DATE_&&(e.lowestObserverState_=rt.UP_TO_DATE_)}))}(this),bt.trackingContext=e}}else lt(this)&&(this.warnAboutUntrackedRead_(),Dt(),this.value_=this.computeValue_(!1),St());var t=this.value_;if(st(t))throw t.cause;return t},t.set=function(e){if(this.setter_){this.isRunningSetter&&l(33,this.name_),this.isRunningSetter=!0;try{this.setter_.call(this.scope_,e)}finally{this.isRunningSetter=!1}}else l(34,this.name_)},t.trackAndCompute=function(){var e=this.value_,t=this.dependenciesState_===rt.NOT_TRACKING_,n=this.computeValue_(!0),r=t||st(e)||st(n)||!this.equals_(e,n);return r&&(this.value_=n),r},t.computeValue_=function(e){this.isComputing=!0;var t,n=Ye(!1);if(e)t=ut(this,this.derivation,this.scope_);else if(!0===bt.disableErrorBoundaries)t=this.derivation.call(this.scope_);else try{t=this.derivation.call(this.scope_)}catch(AC){t=new it(AC)}return et(n),this.isComputing=!1,t},t.suspend_=function(){this.keepAlive_||(dt(this),this.value_=void 0)},t.observe_=function(e,t){var n=this,r=!0,o=void 0;return Ht((function(){var a=n.get();if(!r||t){var i=ht();e({observableKind:"computed",debugObjectName:n.name_,type:Dn,object:n,newValue:a,oldValue:o}),ft(i)}r=!1,o=a}))},t.warnAboutUntrackedRead_=function(){},t.toString=function(){return this.name_+"["+this.derivation.toString()+"]"},t.valueOf=function(){return z(this.get())},t[Symbol.toPrimitive]=function(){return this.valueOf()},V(e,[{key:"isComputing",get:function(){return B(this.flags_,e.isComputingMask_)},set:function(t){this.flags_=j(this.flags_,e.isComputingMask_,t)}},{key:"isRunningSetter",get:function(){return B(this.flags_,e.isRunningSetterMask_)},set:function(t){this.flags_=j(this.flags_,e.isRunningSetterMask_,t)}},{key:"isBeingObserved",get:function(){return B(this.flags_,e.isBeingObservedMask_)},set:function(t){this.flags_=j(this.flags_,e.isBeingObservedMask_,t)}},{key:"isPendingUnobservation",get:function(){return B(this.flags_,e.isPendingUnobservationMask_)},set:function(t){this.flags_=j(this.flags_,e.isPendingUnobservationMask_,t)}},{key:"diffValue",get:function(){return B(this.flags_,e.diffValueMask_)?1:0},set:function(t){this.flags_=j(this.flags_,e.diffValueMask_,1===t)}}])}();nt.isComputingMask_=1,nt.isRunningSetterMask_=2,nt.isBeingObservedMask_=4,nt.isPendingUnobservationMask_=8,nt.diffValueMask_=16;var rt,ot,at=A("ComputedValue",nt);!function(e){e[e.NOT_TRACKING_=-1]="NOT_TRACKING_",e[e.UP_TO_DATE_=0]="UP_TO_DATE_",e[e.POSSIBLY_STALE_=1]="POSSIBLY_STALE_",e[e.STALE_=2]="STALE_"}(rt||(rt={})),function(e){e[e.NONE=0]="NONE",e[e.LOG=1]="LOG",e[e.BREAK=2]="BREAK"}(ot||(ot={}));var it=function(e){this.cause=void 0,this.cause=e};function st(e){return e instanceof it}function lt(e){switch(e.dependenciesState_){case rt.UP_TO_DATE_:return!1;case rt.NOT_TRACKING_:case rt.STALE_:return!0;case rt.POSSIBLY_STALE_:for(var t=mt(!0),n=ht(),r=e.observing_,o=r.length,a=0;a<o;a++){var i=r[a];if(at(i)){if(bt.disableErrorBoundaries)i.get();else try{i.get()}catch(AC){return ft(n),gt(t),!0}if(e.dependenciesState_===rt.STALE_)return ft(n),gt(t),!0}}return _t(e),ft(n),gt(t),!1}}function ct(e){}function ut(e,t,n){var r=mt(!0);_t(e),e.newObserving_=new Array(0===e.runId_?100:e.observing_.length),e.unboundDepsCount_=0,e.runId_=++bt.runId;var o,a=bt.trackingDerivation;if(bt.trackingDerivation=e,bt.inBatch++,!0===bt.disableErrorBoundaries)o=t.call(n);else try{o=t.call(n)}catch(AC){o=new it(AC)}return bt.inBatch--,bt.trackingDerivation=a,function(e){for(var t=e.observing_,n=e.observing_=e.newObserving_,r=rt.UP_TO_DATE_,o=0,a=e.unboundDepsCount_,i=0;i<a;i++){var s=n[i];0===s.diffValue&&(s.diffValue=1,o!==i&&(n[o]=s),o++),s.dependenciesState_>r&&(r=s.dependenciesState_)}n.length=o,e.newObserving_=null,a=t.length;for(;a--;){var l=t[a];0===l.diffValue&&kt(l,e),l.diffValue=0}for(;o--;){var c=n[o];1===c.diffValue&&(c.diffValue=0,xt(c,e))}r!==rt.UP_TO_DATE_&&(e.dependenciesState_=r,e.onBecomeStale_())}(e),gt(r),o}function dt(e){var t=e.observing_;e.observing_=[];for(var n=t.length;n--;)kt(t[n],e);e.dependenciesState_=rt.NOT_TRACKING_}function pt(e){var t=ht();try{return e()}finally{ft(t)}}function ht(){var e=bt.trackingDerivation;return bt.trackingDerivation=null,e}function ft(e){bt.trackingDerivation=e}function mt(e){var t=bt.allowStateReads;return bt.allowStateReads=e,t}function gt(e){bt.allowStateReads=e}function _t(e){if(e.dependenciesState_!==rt.UP_TO_DATE_){e.dependenciesState_=rt.UP_TO_DATE_;for(var t=e.observing_,n=t.length;n--;)t[n].lowestObserverState_=rt.UP_TO_DATE_}}var vt=function(){this.version=6,this.UNCHANGED={},this.trackingDerivation=null,this.trackingContext=null,this.runId=0,this.mobxGuid=0,this.inBatch=0,this.pendingUnobservations=[],this.pendingReactions=[],this.isRunningReactions=!1,this.allowStateChanges=!1,this.allowStateReads=!0,this.enforceActions=!0,this.spyListeners=[],this.globalReactionErrorHandlers=[],this.computedRequiresReaction=!1,this.reactionRequiresObservable=!1,this.observableRequiresReaction=!1,this.disableErrorBoundaries=!1,this.suppressReactionErrors=!1,this.useProxies=!0,this.verifyProxies=!1,this.safeDescriptors=!0},yt=!0,wt=!1,bt=function(){var e=u();return e.__mobxInstanceCount>0&&!e.__mobxGlobals&&(yt=!1),e.__mobxGlobals&&e.__mobxGlobals.version!==(new vt).version&&(yt=!1),yt?e.__mobxGlobals?(e.__mobxInstanceCount+=1,e.__mobxGlobals.UNCHANGED||(e.__mobxGlobals.UNCHANGED={}),e.__mobxGlobals):(e.__mobxInstanceCount=1,e.__mobxGlobals=new vt):(setTimeout((function(){wt||l(35)}),1),new vt)}();function xt(e,t){e.observers_.add(t),e.lowestObserverState_>t.dependenciesState_&&(e.lowestObserverState_=t.dependenciesState_)}function kt(e,t){e.observers_.delete(t),0===e.observers_.size&&Ct(e)}function Ct(e){!1===e.isPendingUnobservation&&(e.isPendingUnobservation=!0,bt.pendingUnobservations.push(e))}function Dt(){bt.inBatch++}function St(){if(0===--bt.inBatch){It();for(var e=bt.pendingUnobservations,t=0;t<e.length;t++){var n=e[t];n.isPendingUnobservation=!1,0===n.observers_.size&&(n.isBeingObserved&&(n.isBeingObserved=!1,n.onBUO()),n instanceof nt&&n.suspend_())}bt.pendingUnobservations=[]}}function Et(e){var t=bt.trackingDerivation;return null!==t?(t.runId_!==e.lastAccessedBy_&&(e.lastAccessedBy_=t.runId_,t.newObserving_[t.unboundDepsCount_++]=e,!e.isBeingObserved&&bt.trackingContext&&(e.isBeingObserved=!0,e.onBO())),e.isBeingObserved):(0===e.observers_.size&&bt.inBatch>0&&Ct(e),!1)}function Tt(e){e.lowestObserverState_!==rt.STALE_&&(e.lowestObserverState_=rt.STALE_,e.observers_.forEach((function(e){e.dependenciesState_===rt.UP_TO_DATE_&&e.onBecomeStale_(),e.dependenciesState_=rt.STALE_})))}var At=function(){function e(e,t,n,r){void 0===e&&(e="Reaction"),this.name_=void 0,this.onInvalidate_=void 0,this.errorHandler_=void 0,this.requiresObservable_=void 0,this.observing_=[],this.newObserving_=[],this.dependenciesState_=rt.NOT_TRACKING_,this.runId_=0,this.unboundDepsCount_=0,this.flags_=0,this.isTracing_=ot.NONE,this.name_=e,this.onInvalidate_=t,this.errorHandler_=n,this.requiresObservable_=r}var t=e.prototype;return t.onBecomeStale_=function(){this.schedule_()},t.schedule_=function(){this.isScheduled||(this.isScheduled=!0,bt.pendingReactions.push(this),It())},t.runReaction_=function(){if(!this.isDisposed){Dt(),this.isScheduled=!1;var e=bt.trackingContext;if(bt.trackingContext=this,lt(this)){this.isTrackPending=!0;try{this.onInvalidate_()}catch(AC){this.reportExceptionInDerivation_(AC)}}bt.trackingContext=e,St()}},t.track=function(e){if(!this.isDisposed){Dt();0,this.isRunning=!0;var t=bt.trackingContext;bt.trackingContext=this;var n=ut(this,e,void 0);bt.trackingContext=t,this.isRunning=!1,this.isTrackPending=!1,this.isDisposed&&dt(this),st(n)&&this.reportExceptionInDerivation_(n.cause),St()}},t.reportExceptionInDerivation_=function(e){var t=this;if(this.errorHandler_)this.errorHandler_(e,this);else{if(bt.disableErrorBoundaries)throw e;var n="[mobx] uncaught error in '"+this+"'";bt.suppressReactionErrors||console.error(n,e),bt.globalReactionErrorHandlers.forEach((function(n){return n(e,t)}))}},t.dispose=function(){this.isDisposed||(this.isDisposed=!0,this.isRunning||(Dt(),dt(this),St()))},t.getDisposer_=function(e){var t=this,n=function n(){t.dispose(),null==e||null==e.removeEventListener||e.removeEventListener("abort",n)};return null==e||null==e.addEventListener||e.addEventListener("abort",n),n[J]=this,n},t.toString=function(){return"Reaction["+this.name_+"]"},t.trace=function(e){void 0===e&&(e=!1)},V(e,[{key:"isDisposed",get:function(){return B(this.flags_,e.isDisposedMask_)},set:function(t){this.flags_=j(this.flags_,e.isDisposedMask_,t)}},{key:"isScheduled",get:function(){return B(this.flags_,e.isScheduledMask_)},set:function(t){this.flags_=j(this.flags_,e.isScheduledMask_,t)}},{key:"isTrackPending",get:function(){return B(this.flags_,e.isTrackPendingMask_)},set:function(t){this.flags_=j(this.flags_,e.isTrackPendingMask_,t)}},{key:"isRunning",get:function(){return B(this.flags_,e.isRunningMask_)},set:function(t){this.flags_=j(this.flags_,e.isRunningMask_,t)}},{key:"diffValue",get:function(){return B(this.flags_,e.diffValueMask_)?1:0},set:function(t){this.flags_=j(this.flags_,e.diffValueMask_,1===t)}}])}();At.isDisposedMask_=1,At.isScheduledMask_=2,At.isTrackPendingMask_=4,At.isRunningMask_=8,At.diffValueMask_=16;var Mt=100,Ft=function(e){return e()};function It(){bt.inBatch>0||bt.isRunningReactions||Ft(Pt)}function Pt(){bt.isRunningReactions=!0;for(var e=bt.pendingReactions,t=0;e.length>0;){++t===Mt&&(console.error("[mobx] cycle in reaction: "+e[0]),e.splice(0));for(var n=e.splice(0),r=0,o=n.length;r<o;r++)n[r].runReaction_()}bt.isRunningReactions=!1}var zt=A("Reaction",At);var Ot="action",Nt="autoAction",Bt="<unnamed action>",jt=ae(Ot),Lt=ae("action.bound",{bound:!0}),Rt=ae(Nt,{autoAction:!0}),Vt=ae("autoAction.bound",{autoAction:!0,bound:!0});function qt(e){return function(t,n){return x(t)?Xe(t.name||Bt,t,e):x(n)?Xe(t,n,e):X(n)?(e?Rt:jt).decorate_20223_(t,n):k(n)?$(t,n,e?Rt:jt):k(t)?Z(ae(e?Nt:Ot,{name:t,autoAction:e})):void 0}}var Ut=qt(!1);Object.assign(Ut,jt);var Wt=qt(!0);function Gt(e){return x(e)&&!0===e.isMobxAction}function Ht(e,t){var n,r,o,a;void 0===t&&(t=g);var i,s=null!=(n=null==(r=t)?void 0:r.name)?n:"Autorun";if(!t.scheduler&&!t.delay)i=new At(s,(function(){this.track(u)}),t.onError,t.requiresObservable);else{var l=Zt(t),c=!1;i=new At(s,(function(){c||(c=!0,l((function(){c=!1,i.isDisposed||i.track(u)})))}),t.onError,t.requiresObservable)}function u(){e(i)}return null!=(o=t)&&null!=(o=o.signal)&&o.aborted||i.schedule_(),i.getDisposer_(null==(a=t)?void 0:a.signal)}Object.assign(Wt,Rt),Ut.bound=Z(Lt),Wt.bound=Z(Vt);var Kt=function(e){return e()};function Zt(e){return e.scheduler?e.scheduler:e.delay?function(t){return setTimeout(t,e.delay)}:Kt}var $t="onBO",Xt="onBUO";function Jt(e,t,n){return Qt(Xt,e,t,n)}function Qt(e,t,n,r){var o="function"===typeof r?pr(t,n):pr(t),a=x(r)?r:n,i=e+"L";return o[i]?o[i].add(a):o[i]=new Set([a]),function(){var e=o[i];e&&(e.delete(a),0===e.size&&delete o[i])}}var Yt="always";function en(e){!0===e.isolateGlobalState&&function(){if((bt.pendingReactions.length||bt.inBatch||bt.isRunningReactions)&&l(36),wt=!0,yt){var e=u();0===--e.__mobxInstanceCount&&(e.__mobxGlobals=void 0),bt=new vt}}();var t=e.useProxies,n=e.enforceActions;if(void 0!==t&&(bt.useProxies=t===Yt||"never"!==t&&"undefined"!==typeof Proxy),"ifavailable"===t&&(bt.verifyProxies=!0),void 0!==n){var r=n===Yt?Yt:"observed"===n;bt.enforceActions=r,bt.allowStateChanges=!0!==r&&r!==Yt}["computedRequiresReaction","reactionRequiresObservable","observableRequiresReaction","disableErrorBoundaries","safeDescriptors"].forEach((function(t){t in e&&(bt[t]=!!e[t])})),bt.allowStateReads=!bt.observableRequiresReaction,e.reactionScheduler&&function(e){var t=Ft;Ft=function(n){return e((function(){return t(n)}))}}(e.reactionScheduler)}function tn(e,t,n,r){var o=N(t);return mr((function(){var t=$n(e,r)[J];P(o).forEach((function(e){t.extend_(e,o[e],!n||(!(e in n)||n[e]))}))})),e}function nn(e,t){return rn(pr(e,t))}function rn(e){var t,n={name:e.name_};return e.observing_&&e.observing_.length>0&&(n.dependencies=(t=e.observing_,Array.from(new Set(t))).map(rn)),n}var on=0;function an(){this.message="FLOW_CANCELLED"}an.prototype=Object.create(Error.prototype);var sn=ue("flow"),ln=ue("flow.bound",{bound:!0}),cn=Object.assign((function(e,t){if(X(t))return sn.decorate_20223_(e,t);if(k(t))return $(e,t,sn);var n=e,r=n.name||"<unnamed flow>",o=function(){var e,t=arguments,o=++on,a=Ut(r+" - runid: "+o+" - init",n).apply(this,t),i=void 0,s=new Promise((function(t,n){var s=0;function l(e){var t;i=void 0;try{t=Ut(r+" - runid: "+o+" - yield "+s++,a.next).call(a,e)}catch(AC){return n(AC)}u(t)}function c(e){var t;i=void 0;try{t=Ut(r+" - runid: "+o+" - yield "+s++,a.throw).call(a,e)}catch(AC){return n(AC)}u(t)}function u(e){if(!x(null==e?void 0:e.then))return e.done?t(e.value):(i=Promise.resolve(e.value)).then(l,c);e.then(u,n)}e=n,l(void 0)}));return s.cancel=Ut(r+" - runid: "+o+" - cancel",(function(){try{i&&un(i);var t=a.return(void 0),n=Promise.resolve(t.value);n.then(b,b),un(n),e(new an)}catch(AC){e(AC)}})),s};return o.isMobXFlow=!0,o}),sn);function un(e){x(e.cancel)&&e.cancel()}function dn(e){return!0===(null==e?void 0:e.isMobXFlow)}function pn(e,t){return!!e&&(void 0!==t?!!Qn(e)&&e[J].values_.has(t):Qn(e)||!!e[J]||Y(e)||zt(e)||at(e))}function hn(e){return pn(e)}function fn(e,t){void 0===t&&(t=void 0),Dt();try{return e.apply(t)}finally{St()}}function mn(e){return e[J]}cn.bound=Z(ln);var gn={has:function(e,t){return mn(e).has_(t)},get:function(e,t){return mn(e).get_(t)},set:function(e,t,n){var r;return!!k(t)&&(null==(r=mn(e).set_(t,n,!0))||r)},deleteProperty:function(e,t){var n;return!!k(t)&&(null==(n=mn(e).delete_(t,!0))||n)},defineProperty:function(e,t,n){var r;return null==(r=mn(e).defineProperty_(t,n))||r},ownKeys:function(e){return mn(e).ownKeys_()},preventExtensions:function(e){l(13)}};function _n(e){return void 0!==e.interceptors_&&e.interceptors_.length>0}function vn(e,t){var n=e.interceptors_||(e.interceptors_=[]);return n.push(t),w((function(){var e=n.indexOf(t);-1!==e&&n.splice(e,1)}))}function yn(e,t){var n=ht();try{for(var r=[].concat(e.interceptors_||[]),o=0,a=r.length;o<a&&((t=r[o](t))&&!t.type&&l(14),t);o++);return t}finally{ft(n)}}function wn(e){return void 0!==e.changeListeners_&&e.changeListeners_.length>0}function bn(e,t){var n=e.changeListeners_||(e.changeListeners_=[]);return n.push(t),w((function(){var e=n.indexOf(t);-1!==e&&n.splice(e,1)}))}function xn(e,t){var n=ht(),r=e.changeListeners_;if(r){for(var o=0,a=(r=r.slice()).length;o<a;o++)r[o](t);ft(n)}}var kn=Symbol("mobx-keys");var Cn="splice",Dn="update",Sn={get:function(e,t){var n=e[J];return t===J?n:"length"===t?n.getArrayLength_():"string"!==typeof t||isNaN(t)?O(An,t)?An[t]:e[t]:n.get_(parseInt(t))},set:function(e,t,n){var r=e[J];return"length"===t&&r.setArrayLength_(n),"symbol"===typeof t||isNaN(t)?e[t]=n:r.set_(parseInt(t),n),!0},preventExtensions:function(){l(15)}},En=function(){function e(e,t,n,r){void 0===e&&(e="ObservableArray"),this.owned_=void 0,this.legacyMode_=void 0,this.atom_=void 0,this.values_=[],this.interceptors_=void 0,this.changeListeners_=void 0,this.enhancer_=void 0,this.dehancer=void 0,this.proxy_=void 0,this.lastKnownLength_=0,this.owned_=n,this.legacyMode_=r,this.atom_=new Q(e),this.enhancer_=function(e,n){return t(e,n,"ObservableArray[..]")}}var t=e.prototype;return t.dehanceValue_=function(e){return void 0!==this.dehancer?this.dehancer(e):e},t.dehanceValues_=function(e){return void 0!==this.dehancer&&e.length>0?e.map(this.dehancer):e},t.intercept_=function(e){return vn(this,e)},t.observe_=function(e,t){return void 0===t&&(t=!1),t&&e({observableKind:"array",object:this.proxy_,debugObjectName:this.atom_.name_,type:"splice",index:0,added:this.values_.slice(),addedCount:this.values_.length,removed:[],removedCount:0}),bn(this,e)},t.getArrayLength_=function(){return this.atom_.reportObserved(),this.values_.length},t.setArrayLength_=function(e){("number"!==typeof e||isNaN(e)||e<0)&&l("Out of range: "+e);var t=this.values_.length;if(e!==t)if(e>t){for(var n=new Array(e-t),r=0;r<e-t;r++)n[r]=void 0;this.spliceWithArray_(t,0,n)}else this.spliceWithArray_(e,t-e)},t.updateArrayLength_=function(e,t){e!==this.lastKnownLength_&&l(16),this.lastKnownLength_+=t,this.legacyMode_&&t>0&&ur(e+t+1)},t.spliceWithArray_=function(e,t,n){var r=this;this.atom_;var o=this.values_.length;if(void 0===e?e=0:e>o?e=o:e<0&&(e=Math.max(0,o+e)),t=1===arguments.length?o-e:void 0===t||null===t?0:Math.max(0,Math.min(t,o-e)),void 0===n&&(n=m),_n(this)){var a=yn(this,{object:this.proxy_,type:Cn,index:e,removedCount:t,added:n});if(!a)return m;t=a.removedCount,n=a.added}if(n=0===n.length?n:n.map((function(e){return r.enhancer_(e,void 0)})),this.legacyMode_){var i=n.length-t;this.updateArrayLength_(o,i)}var s=this.spliceItemsIntoValues_(e,t,n);return 0===t&&0===n.length||this.notifyArraySplice_(e,n,s),this.dehanceValues_(s)},t.spliceItemsIntoValues_=function(e,t,n){var r;if(n.length<1e4)return(r=this.values_).splice.apply(r,[e,t].concat(n));var o=this.values_.slice(e,e+t),a=this.values_.slice(e+t);this.values_.length+=n.length-t;for(var i=0;i<n.length;i++)this.values_[e+i]=n[i];for(var s=0;s<a.length;s++)this.values_[e+n.length+s]=a[s];return o},t.notifyArrayChildUpdate_=function(e,t,n){var r=!this.owned_&&!1,o=wn(this),a=o||r?{observableKind:"array",object:this.proxy_,type:Dn,debugObjectName:this.atom_.name_,index:e,newValue:t,oldValue:n}:null;this.atom_.reportChanged(),o&&xn(this,a)},t.notifyArraySplice_=function(e,t,n){var r=!this.owned_&&!1,o=wn(this),a=o||r?{observableKind:"array",object:this.proxy_,debugObjectName:this.atom_.name_,type:Cn,index:e,removed:n,added:t,removedCount:n.length,addedCount:t.length}:null;this.atom_.reportChanged(),o&&xn(this,a)},t.get_=function(e){if(!(this.legacyMode_&&e>=this.values_.length))return this.atom_.reportObserved(),this.dehanceValue_(this.values_[e]);console.warn("[mobx] Out of bounds read: "+e)},t.set_=function(e,t){var n=this.values_;if(this.legacyMode_&&e>n.length&&l(17,e,n.length),e<n.length){this.atom_;var r=n[e];if(_n(this)){var o=yn(this,{type:Dn,object:this.proxy_,index:e,newValue:t});if(!o)return;t=o.newValue}(t=this.enhancer_(t,r))!==r&&(n[e]=t,this.notifyArrayChildUpdate_(e,t,r))}else{for(var a=new Array(e+1-n.length),i=0;i<a.length-1;i++)a[i]=void 0;a[a.length-1]=t,this.spliceWithArray_(n.length,0,a)}},e}();function Tn(e,t,n,r){return void 0===n&&(n="ObservableArray"),void 0===r&&(r=!1),y(),mr((function(){var o=new En(n,t,r,!1);T(o.values_,J,o);var a=new Proxy(o.values_,Sn);return o.proxy_=a,e&&e.length&&o.spliceWithArray_(0,0,e),a}))}var An={clear:function(){return this.splice(0)},replace:function(e){var t=this[J];return t.spliceWithArray_(0,t.values_.length,e)},toJSON:function(){return this.slice()},splice:function(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),o=2;o<n;o++)r[o-2]=arguments[o];var a=this[J];switch(arguments.length){case 0:return[];case 1:return a.spliceWithArray_(e);case 2:return a.spliceWithArray_(e,t)}return a.spliceWithArray_(e,t,r)},spliceWithArray:function(e,t,n){return this[J].spliceWithArray_(e,t,n)},push:function(){for(var e=this[J],t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e.spliceWithArray_(e.values_.length,0,n),e.values_.length},pop:function(){return this.splice(Math.max(this[J].values_.length-1,0),1)[0]},shift:function(){return this.splice(0,1)[0]},unshift:function(){for(var e=this[J],t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e.spliceWithArray_(0,0,n),e.values_.length},reverse:function(){return bt.trackingDerivation&&l(37,"reverse"),this.replace(this.slice().reverse()),this},sort:function(){bt.trackingDerivation&&l(37,"sort");var e=this.slice();return e.sort.apply(e,arguments),this.replace(e),this},remove:function(e){var t=this[J],n=t.dehanceValues_(t.values_).indexOf(e);return n>-1&&(this.splice(n,1),!0)}};function Mn(e,t){"function"===typeof Array.prototype[e]&&(An[e]=t(e))}function Fn(e){return function(){var t=this[J];t.atom_.reportObserved();var n=t.dehanceValues_(t.values_);return n[e].apply(n,arguments)}}function In(e){return function(t,n){var r=this,o=this[J];return o.atom_.reportObserved(),o.dehanceValues_(o.values_)[e]((function(e,o){return t.call(n,e,o,r)}))}}function Pn(e){return function(){var t=this,n=this[J];n.atom_.reportObserved();var r=n.dehanceValues_(n.values_),o=arguments[0];return arguments[0]=function(e,n,r){return o(e,n,r,t)},r[e].apply(r,arguments)}}Mn("at",Fn),Mn("concat",Fn),Mn("flat",Fn),Mn("includes",Fn),Mn("indexOf",Fn),Mn("join",Fn),Mn("lastIndexOf",Fn),Mn("slice",Fn),Mn("toString",Fn),Mn("toLocaleString",Fn),Mn("toSorted",Fn),Mn("toSpliced",Fn),Mn("with",Fn),Mn("every",In),Mn("filter",In),Mn("find",In),Mn("findIndex",In),Mn("findLast",In),Mn("findLastIndex",In),Mn("flatMap",In),Mn("forEach",In),Mn("map",In),Mn("some",In),Mn("toReversed",In),Mn("reduce",Pn),Mn("reduceRight",Pn);var zn=A("ObservableArrayAdministration",En);function On(e){return C(e)&&zn(e[J])}var Nn={},Bn="add",jn="delete",Ln=function(){function e(e,t,n){var r=this;void 0===t&&(t=ne),void 0===n&&(n="ObservableMap"),this.enhancer_=void 0,this.name_=void 0,this[J]=Nn,this.data_=void 0,this.hasMap_=void 0,this.keysAtom_=void 0,this.interceptors_=void 0,this.changeListeners_=void 0,this.dehancer=void 0,this.enhancer_=t,this.name_=n,x(Map)||l(18),mr((function(){r.keysAtom_=ee("ObservableMap.keys()"),r.data_=new Map,r.hasMap_=new Map,e&&r.merge(e)}))}var t=e.prototype;return t.has_=function(e){return this.data_.has(e)},t.has=function(e){var t=this;if(!bt.trackingDerivation)return this.has_(e);var n=this.hasMap_.get(e);if(!n){var r=n=new tt(this.has_(e),re,"ObservableMap.key?",!1);this.hasMap_.set(e,r),Jt(r,(function(){return t.hasMap_.delete(e)}))}return n.get()},t.set=function(e,t){var n=this.has_(e);if(_n(this)){var r=yn(this,{type:n?Dn:Bn,object:this,newValue:t,name:e});if(!r)return this;t=r.newValue}return n?this.updateValue_(e,t):this.addValue_(e,t),this},t.delete=function(e){var t=this;if((this.keysAtom_,_n(this))&&!yn(this,{type:jn,object:this,name:e}))return!1;if(this.has_(e)){var n=wn(this),r=n?{observableKind:"map",debugObjectName:this.name_,type:jn,object:this,oldValue:this.data_.get(e).value_,name:e}:null;return fn((function(){var n;t.keysAtom_.reportChanged(),null==(n=t.hasMap_.get(e))||n.setNewValue_(!1),t.data_.get(e).setNewValue_(void 0),t.data_.delete(e)})),n&&xn(this,r),!0}return!1},t.updateValue_=function(e,t){var n=this.data_.get(e);if((t=n.prepareNewValue_(t))!==bt.UNCHANGED){var r=wn(this),o=r?{observableKind:"map",debugObjectName:this.name_,type:Dn,object:this,oldValue:n.value_,name:e,newValue:t}:null;0,n.setNewValue_(t),r&&xn(this,o)}},t.addValue_=function(e,t){var n=this;this.keysAtom_,fn((function(){var r,o=new tt(t,n.enhancer_,"ObservableMap.key",!1);n.data_.set(e,o),t=o.value_,null==(r=n.hasMap_.get(e))||r.setNewValue_(!0),n.keysAtom_.reportChanged()}));var r=wn(this),o=r?{observableKind:"map",debugObjectName:this.name_,type:Bn,object:this,name:e,newValue:t}:null;r&&xn(this,o)},t.get=function(e){return this.has(e)?this.dehanceValue_(this.data_.get(e).get()):this.dehanceValue_(void 0)},t.dehanceValue_=function(e){return void 0!==this.dehancer?this.dehancer(e):e},t.keys=function(){return this.keysAtom_.reportObserved(),this.data_.keys()},t.values=function(){var e=this,t=this.keys();return Vn({next:function(){var n=t.next(),r=n.done,o=n.value;return{done:r,value:r?void 0:e.get(o)}}})},t.entries=function(){var e=this,t=this.keys();return Vn({next:function(){var n=t.next(),r=n.done,o=n.value;return{done:r,value:r?void 0:[o,e.get(o)]}}})},t[Symbol.iterator]=function(){return this.entries()},t.forEach=function(e,t){for(var n,r=q(this);!(n=r()).done;){var o=n.value,a=o[0],i=o[1];e.call(t,i,a,this)}},t.merge=function(e){var t=this;return Rn(e)&&(e=new Map(e)),fn((function(){D(e)?function(e){var t=Object.keys(e);if(!I)return t;var n=Object.getOwnPropertySymbols(e);return n.length?[].concat(t,n.filter((function(t){return f.propertyIsEnumerable.call(e,t)}))):t}(e).forEach((function(n){return t.set(n,e[n])})):Array.isArray(e)?e.forEach((function(e){var n=e[0],r=e[1];return t.set(n,r)})):M(e)?(function(e){var t=Object.getPrototypeOf(e),n=Object.getPrototypeOf(t);return null===Object.getPrototypeOf(n)}(e)||l(19,e),e.forEach((function(e,n){return t.set(n,e)}))):null!==e&&void 0!==e&&l(20,e)})),this},t.clear=function(){var e=this;fn((function(){pt((function(){for(var t,n=q(e.keys());!(t=n()).done;){var r=t.value;e.delete(r)}}))}))},t.replace=function(e){var t=this;return fn((function(){for(var n,r=function(e){if(M(e)||Rn(e))return e;if(Array.isArray(e))return new Map(e);if(D(e)){var t=new Map;for(var n in e)t.set(n,e[n]);return t}return l(21,e)}(e),o=new Map,a=!1,i=q(t.data_.keys());!(n=i()).done;){var s=n.value;if(!r.has(s))if(t.delete(s))a=!0;else{var c=t.data_.get(s);o.set(s,c)}}for(var u,d=q(r.entries());!(u=d()).done;){var p=u.value,h=p[0],f=p[1],m=t.data_.has(h);if(t.set(h,f),t.data_.has(h)){var g=t.data_.get(h);o.set(h,g),m||(a=!0)}}if(!a)if(t.data_.size!==o.size)t.keysAtom_.reportChanged();else for(var _=t.data_.keys(),v=o.keys(),y=_.next(),w=v.next();!y.done;){if(y.value!==w.value){t.keysAtom_.reportChanged();break}y=_.next(),w=v.next()}t.data_=o})),this},t.toString=function(){return"[object ObservableMap]"},t.toJSON=function(){return Array.from(this)},t.observe_=function(e,t){return bn(this,e)},t.intercept_=function(e){return vn(this,e)},V(e,[{key:"size",get:function(){return this.keysAtom_.reportObserved(),this.data_.size}},{key:Symbol.toStringTag,get:function(){return"Map"}}])}(),Rn=A("ObservableMap",Ln);function Vn(e){return e[Symbol.toStringTag]="MapIterator",xr(e)}var qn={},Un=function(){function e(e,t,n){var r=this;void 0===t&&(t=ne),void 0===n&&(n="ObservableSet"),this.name_=void 0,this[J]=qn,this.data_=new Set,this.atom_=void 0,this.changeListeners_=void 0,this.interceptors_=void 0,this.dehancer=void 0,this.enhancer_=void 0,this.name_=n,x(Set)||l(22),this.enhancer_=function(e,r){return t(e,r,n)},mr((function(){r.atom_=ee(r.name_),e&&r.replace(e)}))}var t=e.prototype;return t.dehanceValue_=function(e){return void 0!==this.dehancer?this.dehancer(e):e},t.clear=function(){var e=this;fn((function(){pt((function(){for(var t,n=q(e.data_.values());!(t=n()).done;){var r=t.value;e.delete(r)}}))}))},t.forEach=function(e,t){for(var n,r=q(this);!(n=r()).done;){var o=n.value;e.call(t,o,o,this)}},t.add=function(e){var t=this;if(this.atom_,_n(this)){var n=yn(this,{type:Bn,object:this,newValue:e});if(!n)return this;e=n.newValue}if(!this.has(e)){fn((function(){t.data_.add(t.enhancer_(e,void 0)),t.atom_.reportChanged()}));var r=!1,o=wn(this),a=o?{observableKind:"set",debugObjectName:this.name_,type:Bn,object:this,newValue:e}:null;r,o&&xn(this,a)}return this},t.delete=function(e){var t=this;if(_n(this)&&!yn(this,{type:jn,object:this,oldValue:e}))return!1;if(this.has(e)){var n=wn(this),r=n?{observableKind:"set",debugObjectName:this.name_,type:jn,object:this,oldValue:e}:null;return fn((function(){t.atom_.reportChanged(),t.data_.delete(e)})),n&&xn(this,r),!0}return!1},t.has=function(e){return this.atom_.reportObserved(),this.data_.has(this.dehanceValue_(e))},t.entries=function(){var e=this.values();return Gn({next:function(){var t=e.next(),n=t.value,r=t.done;return r?{value:void 0,done:r}:{value:[n,n],done:r}}})},t.keys=function(){return this.values()},t.values=function(){this.atom_.reportObserved();var e=this,t=this.data_.values();return Gn({next:function(){var n=t.next(),r=n.value,o=n.done;return o?{value:void 0,done:o}:{value:e.dehanceValue_(r),done:o}}})},t.intersection=function(e){return F(e)&&!Wn(e)?e.intersection(this):new Set(this).intersection(e)},t.union=function(e){return F(e)&&!Wn(e)?e.union(this):new Set(this).union(e)},t.difference=function(e){return new Set(this).difference(e)},t.symmetricDifference=function(e){return F(e)&&!Wn(e)?e.symmetricDifference(this):new Set(this).symmetricDifference(e)},t.isSubsetOf=function(e){return new Set(this).isSubsetOf(e)},t.isSupersetOf=function(e){return new Set(this).isSupersetOf(e)},t.isDisjointFrom=function(e){return F(e)&&!Wn(e)?e.isDisjointFrom(this):new Set(this).isDisjointFrom(e)},t.replace=function(e){var t=this;return Wn(e)&&(e=new Set(e)),fn((function(){Array.isArray(e)||F(e)?(t.clear(),e.forEach((function(e){return t.add(e)}))):null!==e&&void 0!==e&&l("Cannot initialize set from "+e)})),this},t.observe_=function(e,t){return bn(this,e)},t.intercept_=function(e){return vn(this,e)},t.toJSON=function(){return Array.from(this)},t.toString=function(){return"[object ObservableSet]"},t[Symbol.iterator]=function(){return this.values()},V(e,[{key:"size",get:function(){return this.atom_.reportObserved(),this.data_.size}},{key:Symbol.toStringTag,get:function(){return"Set"}}])}(),Wn=A("ObservableSet",Un);function Gn(e){return e[Symbol.toStringTag]="SetIterator",xr(e)}var Hn=Object.create(null),Kn="remove",Zn=function(){function e(e,t,n,r){void 0===t&&(t=new Map),void 0===r&&(r=Ce),this.target_=void 0,this.values_=void 0,this.name_=void 0,this.defaultAnnotation_=void 0,this.keysAtom_=void 0,this.changeListeners_=void 0,this.interceptors_=void 0,this.proxy_=void 0,this.isPlainObject_=void 0,this.appliedAnnotations_=void 0,this.pendingKeys_=void 0,this.target_=e,this.values_=t,this.name_=n,this.defaultAnnotation_=r,this.keysAtom_=new Q("ObservableObject.keys"),this.isPlainObject_=D(this.target_)}var t=e.prototype;return t.getObservablePropValue_=function(e){return this.values_.get(e).get()},t.setObservablePropValue_=function(e,t){var n=this.values_.get(e);if(n instanceof nt)return n.set(t),!0;if(_n(this)){var r=yn(this,{type:Dn,object:this.proxy_||this.target_,name:e,newValue:t});if(!r)return null;t=r.newValue}if((t=n.prepareNewValue_(t))!==bt.UNCHANGED){var o=wn(this),a=o?{type:Dn,observableKind:"object",debugObjectName:this.name_,object:this.proxy_||this.target_,oldValue:n.value_,name:e,newValue:t}:null;0,n.setNewValue_(t),o&&xn(this,a)}return!0},t.get_=function(e){return bt.trackingDerivation&&!O(this.target_,e)&&this.has_(e),this.target_[e]},t.set_=function(e,t,n){return void 0===n&&(n=!1),O(this.target_,e)?this.values_.has(e)?this.setObservablePropValue_(e,t):n?Reflect.set(this.target_,e,t):(this.target_[e]=t,!0):this.extend_(e,{value:t,enumerable:!0,writable:!0,configurable:!0},this.defaultAnnotation_,n)},t.has_=function(e){if(!bt.trackingDerivation)return e in this.target_;this.pendingKeys_||(this.pendingKeys_=new Map);var t=this.pendingKeys_.get(e);return t||(t=new tt(e in this.target_,re,"ObservableObject.key?",!1),this.pendingKeys_.set(e,t)),t.get()},t.make_=function(e,t){if(!0===t&&(t=this.defaultAnnotation_),!1!==t){if(er(this,t,e),!(e in this.target_)){var n;if(null!=(n=this.target_[K])&&n[e])return;l(1,t.annotationType_,this.name_+"."+e.toString())}for(var r=this.target_;r&&r!==f;){var o=p(r,e);if(o){var a=t.make_(this,e,o,r);if(0===a)return;if(1===a)break}r=Object.getPrototypeOf(r)}Yn(this,t,e)}},t.extend_=function(e,t,n,r){if(void 0===r&&(r=!1),!0===n&&(n=this.defaultAnnotation_),!1===n)return this.defineProperty_(e,t,r);er(this,n,e);var o=n.extend_(this,e,t,r);return o&&Yn(this,n,e),o},t.defineProperty_=function(e,t,n){void 0===n&&(n=!1),this.keysAtom_;try{Dt();var r=this.delete_(e);if(!r)return r;if(_n(this)){var o=yn(this,{object:this.proxy_||this.target_,name:e,type:Bn,newValue:t.value});if(!o)return null;var a=o.newValue;t.value!==a&&(t=U({},t,{value:a}))}if(n){if(!Reflect.defineProperty(this.target_,e,t))return!1}else h(this.target_,e,t);this.notifyPropertyAddition_(e,t.value)}finally{St()}return!0},t.defineObservableProperty_=function(e,t,n,r){void 0===r&&(r=!1),this.keysAtom_;try{Dt();var o=this.delete_(e);if(!o)return o;if(_n(this)){var a=yn(this,{object:this.proxy_||this.target_,name:e,type:Bn,newValue:t});if(!a)return null;t=a.newValue}var i=Jn(e),s={configurable:!bt.safeDescriptors||this.isPlainObject_,enumerable:!0,get:i.get,set:i.set};if(r){if(!Reflect.defineProperty(this.target_,e,s))return!1}else h(this.target_,e,s);var l=new tt(t,n,"ObservableObject.key",!1);this.values_.set(e,l),this.notifyPropertyAddition_(e,l.value_)}finally{St()}return!0},t.defineComputedProperty_=function(e,t,n){void 0===n&&(n=!1),this.keysAtom_;try{Dt();var r=this.delete_(e);if(!r)return r;if(_n(this))if(!yn(this,{object:this.proxy_||this.target_,name:e,type:Bn,newValue:void 0}))return null;t.name||(t.name="ObservableObject.key"),t.context=this.proxy_||this.target_;var o=Jn(e),a={configurable:!bt.safeDescriptors||this.isPlainObject_,enumerable:!1,get:o.get,set:o.set};if(n){if(!Reflect.defineProperty(this.target_,e,a))return!1}else h(this.target_,e,a);this.values_.set(e,new nt(t)),this.notifyPropertyAddition_(e,void 0)}finally{St()}return!0},t.delete_=function(e,t){if(void 0===t&&(t=!1),this.keysAtom_,!O(this.target_,e))return!0;if(_n(this)&&!yn(this,{object:this.proxy_||this.target_,name:e,type:Kn}))return null;try{var n;Dt();var r,o=wn(this),a=this.values_.get(e),i=void 0;if(!a&&o)i=null==(r=p(this.target_,e))?void 0:r.value;if(t){if(!Reflect.deleteProperty(this.target_,e))return!1}else delete this.target_[e];if(a&&(this.values_.delete(e),a instanceof tt&&(i=a.value_),Tt(a)),this.keysAtom_.reportChanged(),null==(n=this.pendingKeys_)||null==(n=n.get(e))||n.set(e in this.target_),o){var s={type:Kn,observableKind:"object",object:this.proxy_||this.target_,debugObjectName:this.name_,oldValue:i,name:e};0,o&&xn(this,s)}}finally{St()}return!0},t.observe_=function(e,t){return bn(this,e)},t.intercept_=function(e){return vn(this,e)},t.notifyPropertyAddition_=function(e,t){var n,r=wn(this);if(r){var o=r?{type:Bn,observableKind:"object",debugObjectName:this.name_,object:this.proxy_||this.target_,name:e,newValue:t}:null;0,r&&xn(this,o)}null==(n=this.pendingKeys_)||null==(n=n.get(e))||n.set(!0),this.keysAtom_.reportChanged()},t.ownKeys_=function(){return this.keysAtom_.reportObserved(),P(this.target_)},t.keys_=function(){return this.keysAtom_.reportObserved(),Object.keys(this.target_)},e}();function $n(e,t){var n;if(O(e,J))return e;var r=null!=(n=null==t?void 0:t.name)?n:"ObservableObject",o=new Zn(e,new Map,String(r),function(e){var t;return e?null!=(t=e.defaultDecorator)?t:De(e):void 0}(t));return E(e,J,o),e}var Xn=A("ObservableObjectAdministration",Zn);function Jn(e){return Hn[e]||(Hn[e]={get:function(){return this[J].getObservablePropValue_(e)},set:function(t){return this[J].setObservablePropValue_(e,t)}})}function Qn(e){return!!C(e)&&Xn(e[J])}function Yn(e,t,n){var r;null==(r=e.target_[K])||delete r[n]}function er(e,t,n){}var tr,nr,rr=lr(0),or=function(){var e=!1,t={};return Object.defineProperty(t,"0",{set:function(){e=!0}}),Object.create(t)[0]=1,!1===e}(),ar=0,ir=function(){};tr=ir,nr=Array.prototype,Object.setPrototypeOf?Object.setPrototypeOf(tr.prototype,nr):void 0!==tr.prototype.__proto__?tr.prototype.__proto__=nr:tr.prototype=nr;var sr=function(e){function t(t,n,r,o){var a;return void 0===r&&(r="ObservableArray"),void 0===o&&(o=!1),a=e.call(this)||this,mr((function(){var e=new En(r,n,o,!0);e.proxy_=a,T(a,J,e),t&&t.length&&a.spliceWithArray(0,0,t),or&&Object.defineProperty(a,"0",rr)})),a}W(t,e);var n=t.prototype;return n.concat=function(){this[J].atom_.reportObserved();for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Array.prototype.concat.apply(this.slice(),t.map((function(e){return On(e)?e.slice():e})))},n[Symbol.iterator]=function(){var e=this,t=0;return xr({next:function(){return t<e.length?{value:e[t++],done:!1}:{done:!0,value:void 0}}})},V(t,[{key:"length",get:function(){return this[J].getArrayLength_()},set:function(e){this[J].setArrayLength_(e)}},{key:Symbol.toStringTag,get:function(){return"Array"}}])}(ir);function lr(e){return{enumerable:!1,configurable:!0,get:function(){return this[J].get_(e)},set:function(t){this[J].set_(e,t)}}}function cr(e){h(sr.prototype,""+e,lr(e))}function ur(e){if(e>ar){for(var t=ar;t<e+100;t++)cr(t);ar=e}}function dr(e,t,n){return new sr(e,t,n)}function pr(e,t){if("object"===typeof e&&null!==e){if(On(e))return void 0!==t&&l(23),e[J].atom_;if(Wn(e))return e.atom_;if(Rn(e)){if(void 0===t)return e.keysAtom_;var n=e.data_.get(t)||e.hasMap_.get(t);return n||l(25,t,fr(e)),n}if(Qn(e)){if(!t)return l(26);var r=e[J].values_.get(t);return r||l(27,t,fr(e)),r}if(Y(e)||at(e)||zt(e))return e}else if(x(e)&&zt(e[J]))return e[J];l(28)}function hr(e,t){return e||l(29),void 0!==t?hr(pr(e,t)):Y(e)||at(e)||zt(e)||Rn(e)||Wn(e)?e:e[J]?e[J]:void l(24,e)}function fr(e,t){var n;if(void 0!==t)n=pr(e,t);else{if(Gt(e))return e.name;n=Qn(e)||Rn(e)||Wn(e)?hr(e):pr(e)}return n.name_}function mr(e){var t=ht(),n=Ye(!0);Dt();try{return e()}finally{St(),et(n),ft(t)}}Object.entries(An).forEach((function(e){var t=e[0],n=e[1];"concat"!==t&&E(sr.prototype,t,n)})),ur(1e3);var gr,_r=f.toString;function vr(e,t,n){return void 0===n&&(n=-1),yr(e,t,n)}function yr(e,t,n,r,o){if(e===t)return 0!==e||1/e===1/t;if(null==e||null==t)return!1;if(e!==e)return t!==t;var a=typeof e;if("function"!==a&&"object"!==a&&"object"!=typeof t)return!1;var i=_r.call(e);if(i!==_r.call(t))return!1;switch(i){case"[object RegExp]":case"[object String]":return""+e===""+t;case"[object Number]":return+e!==+e?+t!==+t:0===+e?1/+e===1/t:+e===+t;case"[object Date]":case"[object Boolean]":return+e===+t;case"[object Symbol]":return"undefined"!==typeof Symbol&&Symbol.valueOf.call(e)===Symbol.valueOf.call(t);case"[object Map]":case"[object Set]":n>=0&&n++}e=wr(e),t=wr(t);var s="[object Array]"===i;if(!s){if("object"!=typeof e||"object"!=typeof t)return!1;var l=e.constructor,c=t.constructor;if(l!==c&&!(x(l)&&l instanceof l&&x(c)&&c instanceof c)&&"constructor"in e&&"constructor"in t)return!1}if(0===n)return!1;n<0&&(n=-1),o=o||[];for(var u=(r=r||[]).length;u--;)if(r[u]===e)return o[u]===t;if(r.push(e),o.push(t),s){if((u=e.length)!==t.length)return!1;for(;u--;)if(!yr(e[u],t[u],n-1,r,o))return!1}else{var d=Object.keys(e),p=d.length;if(Object.keys(t).length!==p)return!1;for(var h=0;h<p;h++){var f=d[h];if(!O(t,f)||!yr(e[f],t[f],n-1,r,o))return!1}}return r.pop(),o.pop(),!0}function wr(e){return On(e)?e.slice():M(e)||Rn(e)||F(e)||Wn(e)?Array.from(e.entries()):e}var br=(null==(gr=u().Iterator)?void 0:gr.prototype)||{};function xr(e){return e[Symbol.iterator]=kr,Object.assign(Object.create(br),e)}function kr(){return this}if(["Symbol","Map","Set"].forEach((function(e){"undefined"===typeof u()[e]&&l("MobX requires global '"+e+"' to be available or polyfilled")})),"object"===typeof __MOBX_DEVTOOLS_GLOBAL_HOOK__&&__MOBX_DEVTOOLS_GLOBAL_HOOK__.injectMobx({spy:function(e){return console.warn("[mobx.spy] Is a no-op in production builds"),function(){}},extras:{getDebugName:fr},$mobx:J}),!a.useState)throw new Error("mobx-react-lite requires React with Hooks support");if(!function(e,t,n){return mr((function(){var r=$n(e,n)[J];null!=t||(t=function(e){return O(e,K)||E(e,K,U({},e[K])),e[K]}(e)),P(t).forEach((function(e){return r.make_(e,t[e])}))})),e})throw new Error("mobx-react-lite@3 requires mobx at least version 6 to be available");var Cr=n(950);function Dr(e){e()}function Sr(e){return nn(e)}var Er=!1;function Tr(){return Er}var Ar,Mr,Fr=function(){function e(e){var t=this;Object.defineProperty(this,"finalize",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"registrations",{enumerable:!0,configurable:!0,writable:!0,value:new Map}),Object.defineProperty(this,"sweepTimeout",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"sweep",{enumerable:!0,configurable:!0,writable:!0,value:function(e){void 0===e&&(e=1e4),clearTimeout(t.sweepTimeout),t.sweepTimeout=void 0;var n=Date.now();t.registrations.forEach((function(r,o){n-r.registeredAt>=e&&(t.finalize(r.value),t.registrations.delete(o))})),t.registrations.size>0&&t.scheduleSweep()}}),Object.defineProperty(this,"finalizeAllImmediately",{enumerable:!0,configurable:!0,writable:!0,value:function(){t.sweep(0)}})}return Object.defineProperty(e.prototype,"register",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t,n){this.registrations.set(n,{value:t,registeredAt:Date.now()}),this.scheduleSweep()}}),Object.defineProperty(e.prototype,"unregister",{enumerable:!1,configurable:!0,writable:!0,value:function(e){this.registrations.delete(e)}}),Object.defineProperty(e.prototype,"scheduleSweep",{enumerable:!1,configurable:!0,writable:!0,value:function(){void 0===this.sweepTimeout&&(this.sweepTimeout=setTimeout(this.sweep,1e4))}}),e}(),Ir=new("undefined"!==typeof FinalizationRegistry?FinalizationRegistry:Fr)((function(e){var t;null===(t=e.reaction)||void 0===t||t.dispose(),e.reaction=null})),Pr=n(461);function zr(e){e.reaction=new At("observer".concat(e.name),(function(){var t;e.stateVersion=Symbol(),null===(t=e.onStoreChange)||void 0===t||t.call(e)}))}function Or(e,t){if(void 0===t&&(t="observed"),Tr())return e();var n=a.useRef(null);if(!n.current){var r={reaction:null,onStoreChange:null,stateVersion:Symbol(),name:t,subscribe:function(e){return Ir.unregister(r),r.onStoreChange=e,r.reaction||(zr(r),r.stateVersion=Symbol()),function(){var e;r.onStoreChange=null,null===(e=r.reaction)||void 0===e||e.dispose(),r.reaction=null}},getSnapshot:function(){return r.stateVersion}};n.current=r}var o,i,s=n.current;if(s.reaction||(zr(s),Ir.register(n,s,s)),a.useDebugValue(s.reaction,Sr),(0,Pr.useSyncExternalStore)(s.subscribe,s.getSnapshot,s.getSnapshot),s.reaction.track((function(){try{o=e()}catch(AC){i=AC}})),i)throw i;return o}var Nr="function"===typeof Symbol&&Symbol.for,Br=null!==(Mr=null===(Ar=Object.getOwnPropertyDescriptor((function(){}),"name"))||void 0===Ar?void 0:Ar.configurable)&&void 0!==Mr&&Mr,jr=Nr?Symbol.for("react.forward_ref"):"function"===typeof a.forwardRef&&(0,a.forwardRef)((function(e){return null})).$$typeof,Lr=Nr?Symbol.for("react.memo"):"function"===typeof a.memo&&(0,a.memo)((function(e){return null})).$$typeof;function Rr(e,t){var n;if(Lr&&e.$$typeof===Lr)throw new Error("[mobx-react-lite] You are trying to use `observer` on a function component wrapped in either another `observer` or `React.memo`. The observer already applies 'React.memo' for you.");if(Tr())return e;var r=null!==(n=null===t||void 0===t?void 0:t.forwardRef)&&void 0!==n&&n,o=e,i=e.displayName||e.name;if(jr&&e.$$typeof===jr&&(r=!0,"function"!==typeof(o=e.render)))throw new Error("[mobx-react-lite] `render` property of ForwardRef was not a function");var s,l,c=function(e,t){return Or((function(){return o(e,t)}),i)};return c.displayName=e.displayName,Br&&Object.defineProperty(c,"name",{value:e.name,writable:!0,configurable:!0}),e.contextTypes&&(c.contextTypes=e.contextTypes),r&&(c=(0,a.forwardRef)(c)),c=(0,a.memo)(c),s=e,l=c,Object.keys(s).forEach((function(e){qr[e]||Object.defineProperty(l,e,Object.getOwnPropertyDescriptor(s,e))})),c}var Vr,qr={$$typeof:!0,render:!0,compare:!0,type:!0,displayName:!0};(function(e){e||(e=Dr),en({reactionScheduler:e})})(Cr.unstable_batchedUpdates);Vr=Ir.finalizeAllImmediately;function Ur(e,t){return e===t?0!==e||1/e===1/t:e!==e&&t!==t}var Wr=Symbol("patchMixins"),Gr=Symbol("patchedDefinition");function Hr(e,t){for(var n=this,r=arguments.length,o=new Array(r>2?r-2:0),a=2;a<r;a++)o[a-2]=arguments[a];t.locks++;try{var i;return void 0!==e&&null!==e&&(i=e.apply(this,o)),i}finally{t.locks--,0===t.locks&&t.methods.forEach((function(e){e.apply(n,o)}))}}function Kr(e,t){return function(){for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];Hr.call.apply(Hr,[this,e,t].concat(r))}}function Zr(e,t,n){var r=function(e,t){var n=e[Wr]=e[Wr]||{},r=n[t]=n[t]||{};return r.locks=r.locks||0,r.methods=r.methods||[],r}(e,t);r.methods.indexOf(n)<0&&r.methods.push(n);var o=Object.getOwnPropertyDescriptor(e,t);if(!o||!o[Gr]){var a=e[t],i=$r(e,t,o?o.enumerable:void 0,r,a);Object.defineProperty(e,t,i)}}function $r(e,t,n,r,o){var a,i=Kr(o,r);return(a={})[Gr]=!0,a.get=function(){return i},a.set=function(o){if(this===e)i=Kr(o,r);else{var a=$r(this,t,n,r,o);Object.defineProperty(this,t,a)}},a.configurable=!0,a.enumerable=n,a}var Xr=Symbol("ObserverAdministration"),Jr=Symbol("isMobXReactObserver");function Qr(e){var t;return null!=(t=e[Xr])?t:e[Xr]={reaction:null,mounted:!1,reactionInvalidatedBeforeMount:!1,forceUpdate:null,name:Yr(e.constructor),state:void 0,props:void 0,context:void 0}}function Yr(e){return e.displayName||e.name||"<component>"}function eo(e){var t=e.bind(this),n=Qr(this);return function(){n.reaction||(n.reaction=function(t){return new At(t.name+".render()",(function(){if(t.mounted)try{null==t.forceUpdate||t.forceUpdate()}catch(e){var n;null==(n=t.reaction)||n.dispose(),t.reaction=null}else t.reactionInvalidatedBeforeMount=!0}))}(n),n.mounted||Ir.register(this,n,this));var e=void 0,r=void 0;if(n.reaction.track((function(){try{r=Qe(!1,t)}catch(AC){e=AC}})),e)throw e;return r}}function to(e,t){return Tr()&&console.warn("[mobx-react] It seems that a re-rendering of a React component is triggered while in static (server-side) mode. Please make sure components are rendered only once server-side."),this.state!==t||!function(e,t){if(Ur(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(var o=0;o<n.length;o++)if(!Object.hasOwnProperty.call(t,n[o])||!Ur(e[n[o]],t[n[o]]))return!1;return!0}(this.props,e)}function no(e,t){if(t&&"class"!==t.kind)throw new Error("The @observer decorator can be used on classes only");return!0===e.isMobxInjector&&console.warn("Mobx observer: You are trying to use `observer` on a component that already has `inject`. Please apply `observer` before applying `inject`"),Object.prototype.isPrototypeOf.call(a.Component,e)||Object.prototype.isPrototypeOf.call(a.PureComponent,e)?function(e){var t=e.prototype;if(e[Jr]){var n=Yr(e);throw new Error("The provided component class ("+n+") has already been declared as an observer component.")}if(e[Jr]=!0,t.componentWillReact)throw new Error("The componentWillReact life-cycle event is no longer supported");if(e.__proto__!==a.PureComponent)if(t.shouldComponentUpdate){if(t.shouldComponentUpdate!==to)throw new Error("It is not allowed to use shouldComponentUpdate in observer based components.")}else t.shouldComponentUpdate=to;var r=t.render;if("function"!==typeof r){var o=Yr(e);throw new Error("[mobx-react] class component ("+o+") is missing `render` method.\n`observer` requires `render` being a function defined on prototype.\n`render = () => {}` or `render = function() {}` is not supported.")}t.render=function(){return Object.defineProperty(this,"render",{configurable:!1,writable:!1,value:Tr()?r:eo.call(this,r)}),this.render()};var i=t.componentDidMount;return t.componentDidMount=function(){var e=this,t=Qr(this);return t.mounted=!0,Ir.unregister(this),t.forceUpdate=function(){return e.forceUpdate()},t.reaction&&!t.reactionInvalidatedBeforeMount||t.forceUpdate(),null==i?void 0:i.apply(this,arguments)},Zr(t,"componentWillUnmount",(function(){var e;if(!Tr()){var t=Qr(this);null==(e=t.reaction)||e.dispose(),t.reaction=null,t.forceUpdate=null,t.mounted=!1,t.reactionInvalidatedBeforeMount=!1}})),e}(e):Rr(e)}a.version.split(".")[0];if(!a.Component)throw new Error("mobx-react requires React to be available");if(!Ve)throw new Error("mobx-react requires mobx to be available");function ro(e){return ro="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ro(e)}function oo(e){var t=function(e,t){if("object"!=ro(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=ro(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==ro(t)?t:t+""}function ao(e,t,n){return(t=oo(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function io(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function so(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?io(Object(n),!0).forEach((function(t){ao(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):io(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const lo={"Your task is to write a short biography for a made-up historic figure. Your bio should include their birth and death date their profession and their greatest contribution.":["Eleanor Finchley (1712\u20131778) was a pioneering botanist who revolutionized plant classification by introducing the Finchley System, which laid the groundwork for modern taxonomy.","Name: Elara Finch; Birth: March 12, 1783; Death: August 9, 1857; Profession: Inventor; Greatest Contribution: Developed the Finch Aerostat, the first practical hot air balloon, revolutionizing aerial exploration.","Name: Elara Solstice (1842-1910). Profession: Inventor and Engineer. Greatest Contribution: Developed the first sustainable solar-powered steam engine, revolutionizing renewable energy technology in the late 19th century.","Name: Elara Moonstone (1792-1863). Profession: Inventor and Naturalist. Greatest Contribution: Developed the first solar-powered clock, revolutionizing timekeeping and promoting renewable energy awareness in the 19th century.","Name: Elara Thorne (1801-1875); Profession: Astronomer; Greatest Contribution: Discovered the Thorne Comet and pioneered techniques in celestial photography.","Name: Elara Voss (1801-1865). Profession: Engineer and inventor. Greatest contribution: Invented the first steam-powered printing press, revolutionizing mass communication.","Name: Elara Solstice (1785-1857) - Profession: Botanist - Contribution: Discovered the Solstice Flower, a plant with unique medicinal properties that revolutionized 19th-century herbal medicine.","Name: Elara Swiftfoot (1750-1822). Profession: Navigator and Cartographer. Contribution: Elara crafted the first detailed map of the uncharted southern seas, greatly aiding maritime exploration.","Eleanor Cartwright (1824-1888) was a pioneering botanist who revolutionized plant taxonomy by developing the Cartwright Classification System, which is still used as a foundational framework in modern botany.","Name: Elara Finchley (1792-1860), Profession: Inventor, Contribution: Developed the Finchley Steam Engine, revolutionizing agricultural machinery and increasing farming productivity during the 19th century.","Eleanor Brightwell (1823-1885) was an innovative British engineer who pioneered the development of the steam-powered sewing machine in 1864, revolutionizing the textile industry and empowering women workers.",'Name: Elara Windrider (1623-1688)  \nProfession: Inventor and Aviator  \nContribution: Elara Windrider revolutionized early aviation with her design of the first successful glider, the "Sky Sailor," enabling humans to glide safely over long distances.',"Eleanor Voss, born in 1823 and passing in 1891, was a pioneering botanist who revolutionized plant hybridization, leading to the development of resilient crop varieties that transformed agricultural practices worldwide.","Name: Liora Elmsworth (1723-1791). Profession: Botanist. Contribution: Discovered the Elmsworth Herb, revolutionizing 18th-century medicine with its healing properties.","Eleanor Hargrave (1825-1897) was a pioneering botanist who discovered the Hargrave Orchid, a rare plant species in the Amazon Rainforest, advancing botanical science significantly.","Name: Elara Flint (1792-1856). Profession: Inventor. Contribution: Developed the first steam-powered loom in 1830, revolutionizing the textile industry.","Name: Elara Novara (1721-1783). Profession: Inventor and Astronomer. Contribution: Developed the first functional telescope with a rotating lens system, revolutionizing celestial observations.","Name: Elara Swift; Born: March 12, 1783; Died: August 27, 1845; Profession: Inventor; Contribution: Invented the first steam-powered loom, revolutionizing the textile industry.","Name: Elara Voss; Born: March 12, 1823; Died: August 19, 1889; Profession: Inventor and Engineer; Greatest Contribution: Developed the first efficient steam-powered cooling system, revolutionizing industrial processes and food preservation.","Eleanor Hartwood (1783-1856) was a pioneering British botanist who discovered and classified over 200 new plant species, significantly advancing the field of botany and contributing to the understanding of plant biodiversity.","Lydia Marcellus (1783-1859) was a pioneering botanist who revolutionized plant taxonomy, notably classifying hundreds of previously undocumented plant species across the Americas.","Name: Elara Windrider (1750-1822). Profession: Inventor and Engineer. Greatest Contribution: Developed the first self-sustaining windmill design, revolutionizing renewable energy in 18th-century Europe.","Name: Elara Voss (1776-1845). Profession: Inventor. Contribution: Developed the first mechanical water purification system, revolutionizing access to clean water in rural communities.",'Eleanor Brightwell (1784-1856) was a pioneering botanist who discovered the rare "Luna Orchid," revolutionizing plant taxonomy and contributing to biodiversity conservation.',"Name: Elara Thorne (1715-1789). Profession: Inventor and Engineer. Greatest Contribution: Developed the first mechanical loom, revolutionizing the textile industry in the 18th century.",'Eleanor Forthwright (1820-1885) was a pioneering botanist who discovered the rare "Lunar Orchid" in the Amazon Rainforest, significantly contributing to our understanding of tropical plant biodiversity.','Amelia Thornfield (1782-1847) was a pioneering botanist known for her discovery of the rare "Lunar Bloom" plant, which revolutionized the study of nocturnal flora.',"Eleanor Wynthrope (1823-1891) was a pioneering British botanist who, in 1874, discovered the Wynthrope Effect, a revolutionary process enhancing plant growth efficiency in arid climates.","Name: Elara Finch (1801-1865). Profession: Inventor and Engineer. Contribution: Developed the first steam-powered printing press, revolutionizing the mass production of newspapers and books.","Name: Elara Thorne (1820-1895). Profession: Inventor and Engineer. Greatest Contribution: Developed the first steam-powered agricultural harvester in 1865, revolutionizing farming efficiency."],"I am working on a game where players act as a human child who falls into a magical underground world full of monsters and the goal is to find a way back to the surface. Come up with a type of monster and briefly describe its backstory.":['A monster called "Luminara" is a glowing, ethereal being created from the remnants of lost hopes and dreams, wandering the underground world, seeking to guide lost souls back to the surface with its gentle light.',"The Lumirest is a glowing moss creature that once thrived on the surface but was forced underground by deforestation, now guiding lost travelers with its luminescent trails.","The Lumibloom is a bioluminescent flower monster that once thrived on the surface, but was driven underground by deforestation, and now guides lost souls with its glow.","The Luminescent Gloom is a bioluminescent shadow creature born from the sorrow of lost souls, seeking warmth from the light of human kindness to regain its forgotten memories and ascend to peace.","The Luminara is a glowing, moth-like creature that once acted as guardians of ancient pathways, guiding lost souls with their light but now seeks companionship in the dark underground.","Meet the Luminoids, gentle creatures who once thrived above ground but fled underground generations ago to escape a devastating solar flare that made them sensitive to sunlight.","A Lumiglow Sprite, once a forest fairy, now glows in the dark caves after being trapped underground during a magical storm, guiding or misleading travelers with its radiant light.","The Lumiglow, a bioluminescent creature, was once a guardian of the surface world but was banished underground for accidentally causing a great forest fire.","The Luminoid is a bioluminescent creature that once thrived on the surface but retreated underground to escape a devastating solar flare, evolving to emit light in the darkness to guide lost souls.","The Lumivine is a bioluminescent vine creature that once thrived on the surface but retreated underground to escape deforestation, now guiding lost travelers with its glowing tendrils.","The Lumisprite is a glowing, playful creature that once thrived on the surface but retreated underground after humans unknowingly disrupted its forest habitat, now guiding lost souls with its soothing light.","The Lumiglow Beetle is a gentle, bioluminescent creature that once thrived above ground but was forced underground due to habitat loss, and now guides lost souls with its glowing shell.","The Whispering Wisp is a glowing, ethereal creature formed from the sorrowful sighs of lost travelers, guiding and misleading those who wander too close to its shimmering trails.","The Luminoids are glowing, sentient crystals that once thrived on the surface but were forced underground by human mining, now seeking a way to coexist peacefully with humans.","The Lumibrute is a gentle giant made of glowing crystals, once a guardian of the underground's lost civilization, now roaming the caverns in search of its long-vanished creators.","Name: Lumigrove Sprite. Description: These bioluminescent creatures were once forest guardians above ground, but were entrapped underground by a sorcerer's curse, now guiding lost souls with their gentle glow.","Meet the Lumigloom, a bioluminescent creature that once thrived in the surface's lush forests but retreated underground to escape a catastrophic event that darkened the skies.",'The "Whispering Willow" is a sentient tree creature that gently guides lost souls; it was once a guardian of the surface forests before being trapped underground by a vengeful sorcerer.',"The Lumiglow, a bioluminescent creature resembling a floating jellyfish, was once a curious scholar who accidentally transformed while studying magical light sources, now guiding lost souls with its gentle glow.","The Luminoids are gentle, bioluminescent creatures who once thrived above ground but retreated underground centuries ago to escape human expansion, now guiding lost souls with their glow.","The Lumigloom is a bioluminescent creature that once thrived on the surface but retreated underground after humans disrupted its forest habitat, now guiding lost souls with its gentle glow.","The Lumivine is a bioluminescent plant creature that once thrived in ancient sunlight, yearning to reclaim its lost light by befriending and guiding lost souls to safety.",'The "Lumenclaw" is a bioluminescent wolf-like creature that was once a guardian spirit of the forest, cast underground by a vengeful sorcerer, and now seeks redemption by guiding lost souls.',"Meet the Lumigloom, a bioluminescent creature that once thrived in the sunlit world above but adapted to the dark underground, longing to guide lost souls back to the surface in hopes of one day returning to the light itself.","The Lumipede is a bioluminescent centipede-like creature that once roamed the surface but was forced underground due to its glowing body attracting predators; it now guides lost souls with its radiant light in the underground world.","The Lumishade: A once-gentle creature that absorbed too much moonlight and now wanders the underground casting eerie, shifting shadows that reflect its longing for the surface.","The Lumisprite is a bioluminescent creature that once thrived on the surface but was driven underground by human expansion; it now guides and tests the compassion of lost travelers.","The Lumivine is a bioluminescent plant-like creature that lights the dark caverns, once a guardian of an ancient forest, now seeking companionship in the shadows of the underground world.","The Luminoid is a bioluminescent creature that was once a human child lost in the underground long ago; it now guides others with its glow, hoping to help them find the way out that it never could.","The Lumigloom is a bioluminescent creature that once thrived on the surface, but over centuries, adapted to the darkness underground, now guiding lost souls with its glowing patterns while yearning for a glimpse of the sky."],"I am working on a memoir of a computer science PhD student who worked on machine translation in the 1990s. Suggest a single title and nothing else.":['"Babel Code: A PhD Journey in Machine Translation"','"Translating the Code of Yesterday"','"Code-Switching: A Journey Through 90s Machine Translation"','"Babel Bytes: A 1990s PhD Odyssey in Machine Translation"','"Code-Switching: A Journey Through 90s Machine Translation"','"Code-Switching: A Journey Through 90s Machine Translation"','"Translating the Past: A 90s PhD Journey in Machine Language"','"Translating the Future: A PhD Journey in the Dawn of Machine Translation"','"Code to Language: A Journey through 90s Machine Translation"','"Code-Switching: A Journey in 90s Machine Translation"','"Code and Context: A 1990s Machine Translation Journey"','"Code and Context: A 1990s Machine Translation Journey"','"Translating Dreams: A 1990s Machine Translation Journey"','"Code-Switching: A Journey Through 90s Machine Translation"','"Codebreaker\'s Journey: Translating the Dawn of AI"','"Translating Code: A Journey Through 90s Machine Learning"','"Translating Code: A 1990s PhD Odyssey"','"Code-Switching: A Journey Through 90s Machine Translation"','"Code-Switching: A Journey Through 90s Machine Translation"','"Code to Comprehension: A 1990s Journey in Machine Translation"','"Translating the Code: A 1990s Journey in Machine Learning"','"Code-Switching: A Journey Through the Language of Machines"','"Babel Bytes: A 1990s Journey in Machine Translation"','"Code-Switching: A Journey in 90s Machine Translation"','"Code-Switching: A Journey Through Early Machine Translation"','"Translating the Code: A PhD Journey in the 1990s"',"Code-Switching: A Journey Through 90s Machine Translation",'"Code to Converse: A 1990s Journey in Machine Translation"','"Code to Comprehend: A 90s Journey in Machine Translation"','"Code-Switching: A Journey Through Language and Algorithms"'],"Summarize the Trump presidency in one sentence":["Donald Trump's presidency was marked by divisive politics, significant policy changes, and two impeachment trials.","The Trump presidency was characterized by controversial policies, a focus on America First, significant tax reforms, and numerous legal and political challenges.",'Donald Trump\'s presidency was marked by controversial policies, divisive rhetoric, significant deregulation, and major tax reforms, alongside two impeachments and a strong focus on "America First" policies.','The Trump presidency was characterized by controversial policies, divisive rhetoric, significant tax reforms, deregulatory efforts, and an impeachment trial, with a focus on "America First" policies.',"The Trump presidency was marked by divisive politics, significant policy shifts, and an unconventional approach to governance.","Donald Trump's presidency was marked by contentious policies, significant political polarization, and numerous controversies.","The Trump presidency was marked by divisive rhetoric, significant policy shifts, and numerous controversies, both domestically and internationally.","The Trump presidency was marked by controversial policies, polarizing rhetoric, and significant political and social upheaval.","The Trump presidency was marked by significant political polarization, unconventional leadership, and major policy changes in areas such as immigration, taxation, and international relations.","The Trump presidency was marked by significant political polarization, economic growth, contentious immigration policies, and numerous controversies, including two impeachments.",'Donald Trump\'s presidency was marked by controversial policies, significant political polarization, and an emphasis on "America First" nationalism.','Donald Trump\'s presidency was characterized by controversial policies, significant political polarization, and a strong focus on "America First" economic and foreign policies.',"The Trump presidency was characterized by unconventional leadership, divisive politics, significant policy changes, and controversy.","The Trump presidency was marked by significant political polarization, a focus on America First policies, and numerous controversies and investigations.","The Trump presidency was characterized by controversial policies, a strong focus on immigration and deregulation, significant tax reforms, divisive rhetoric, and two impeachments.","Donald Trump's presidency was marked by controversial policies, divisive rhetoric, economic growth, and significant political polarization.","Donald Trump's presidency was marked by controversial policies, robust economic growth, divisive rhetoric, and two impeachments.",'The Trump presidency was marked by a focus on "America First" policies, significant political polarization, and numerous controversies and investigations.',"The Trump presidency was marked by divisive politics, significant policy changes, and numerous controversies, both domestically and internationally.","The Trump presidency was marked by significant political polarization, economic policies like tax cuts, controversial immigration measures, and two impeachment trials.",'The Trump presidency was marked by controversial policies, significant political polarization, a focus on "America First" policies, and two impeachments.','The Trump presidency was marked by significant political polarization, controversial policies, and a focus on "America First" with notable events like tax reform, trade wars, and two impeachments.',"Donald Trump's presidency was characterized by a focus on America First policies, significant tax cuts, controversial immigration policies, and two impeachment trials.","Donald Trump's presidency was marked by controversial policies, strong economic growth, divisive rhetoric, and two impeachments.","Donald Trump's presidency was marked by significant political polarization, controversial policies, and an unconventional approach to leadership and communication.",'The Trump presidency was marked by divisive rhetoric, significant policy changes, and controversies, including two impeachments and a focus on "America First" policies.','The Trump presidency was marked by contentious policies, a focus on "America First," significant political polarization, and two impeachments.','The Trump presidency was marked by divisive politics, significant policy changes, and controversies, including two impeachments and a focus on "America First" policies.','The Trump presidency was characterized by controversial policies, significant political division, and a focus on "America First" initiatives.',"Donald Trump's presidency was marked by controversial policies, divisive rhetoric, economic growth, and significant political polarization.","The Trump presidency was characterized by controversial policies, significant political polarization, and a focus on America First, with notable events including tax reform, deregulation, and two impeachments.","Donald Trump's presidency was marked by significant political polarization, economic growth, and controversial policies on immigration, trade, and foreign relations.",'Donald Trump\'s presidency was marked by significant political polarization, controversial policies, and a focus on "America First" principles.',"Donald Trump's presidency was marked by controversial policies, significant political polarization, and major events such as tax reform, trade disputes, and a high-profile response to the COVID-19 pandemic.","Donald Trump's presidency was marked by controversial policies, divisive rhetoric, significant tax reforms, and two impeachments, as well as a focus on deregulation and a strong economy pre-COVID-19.","The Trump presidency was marked by polarizing policies, significant tax reforms, contentious immigration stances, and two impeachment trials.","The Trump presidency was marked by significant political polarization, unconventional governance, economic growth, and contentious policies on immigration, trade, and foreign relations.","Donald Trump's presidency was marked by controversial policies, significant political polarization, a strong focus on immigration and deregulation, and two impeachments.","The Trump presidency was marked by controversial policies, significant political polarization, and an unconventional approach to governance.","The Trump presidency was characterized by a focus on nationalism, significant policy changes, controversial rhetoric, and deep political polarization.","The Trump presidency was marked by significant political polarization, controversial policies, and an unconventional approach to leadership and communication.","The Trump presidency was marked by controversial policies, polarizing rhetoric, and significant impact on domestic and international politics.","The Trump presidency was marked by divisive rhetoric, significant policy changes, economic growth, and numerous controversies, including two impeachments.","The Trump presidency was marked by controversial policies, divisive rhetoric, economic growth, and significant political polarization.",'Donald Trump\'s presidency was marked by significant political polarization, controversial policies, and a focus on "America First" economic and immigration strategies.',"Donald Trump's presidency was marked by significant political polarization, economic growth, controversial policies, and two impeachments.","The Trump presidency was marked by controversial policies, divisive rhetoric, significant economic changes, and challenges such as the COVID-19 pandemic.","Donald Trump's presidency was marked by significant political polarization, economic changes, and controversial policies on immigration and trade.","The Trump presidency was marked by contentious politics, significant policy shifts, and a deeply polarized national atmosphere.","The Trump presidency was marked by controversial policies, a focus on nationalism and deregulation, significant tax cuts, impeachment proceedings, and a deeply polarized political climate."],"Summarize the Obama presidency in one sentence":["Barack Obama's presidency was marked by significant achievements such as the Affordable Care Act, the killing of Osama bin Laden, and efforts to combat climate change, along with challenges like partisan gridlock and economic recovery from the 2008 financial crisis.","Barack Obama's presidency focused on healthcare reform, economic recovery, and progressive social policies while facing significant political polarization.","Barack Obama's presidency was marked by significant achievements such as the Affordable Care Act, economic recovery efforts following the Great Recession, and the operation that killed Osama bin Laden, alongside challenges like partisan gridlock and racial tensions.","Barack Obama's presidency was marked by significant achievements such as the Affordable Care Act, economic recovery efforts, and the killing of Osama bin Laden, alongside challenges like political polarization and debates over foreign policy.","Barack Obama's presidency focused on healthcare reform, economic recovery, and social progress, including passing the Affordable Care Act, navigating the aftermath of the Great Recession, and supporting marriage equality.","Barack Obama's presidency was marked by significant achievements such as the Affordable Care Act, the killing of Osama bin Laden, and the Paris Climate Agreement, alongside challenges like partisan gridlock and global economic recovery.","Barack Obama's presidency was marked by the passage of the Affordable Care Act, economic recovery efforts following the Great Recession, and significant foreign policy achievements such as the killing of Osama bin Laden and the Iran nuclear deal.","Barack Obama's presidency was marked by significant achievements such as the Affordable Care Act, economic recovery efforts, and climate change initiatives, as well as challenges like partisan gridlock and foreign policy complexities.","Barack Obama's presidency was marked by significant achievements such as the Affordable Care Act, economic recovery efforts, and the killing of Osama bin Laden, amidst challenges like political polarization and debates over foreign policy.","Barack Obama's presidency was marked by significant achievements such as the Affordable Care Act, the economic recovery following the 2008 financial crisis, and the killing of Osama bin Laden, alongside challenges like political polarization and struggles with healthcare rollout.","Barack Obama's presidency was marked by significant achievements such as the Affordable Care Act, economic recovery efforts, the killing of Osama bin Laden, and landmark legislation on climate change and social issues, alongside challenges like political polarization and foreign policy complexities.","Barack Obama's presidency, from 2009 to 2017, was marked by significant achievements such as the Affordable Care Act and the killing of Osama bin Laden, amidst challenges like the Great Recession and partisan divisions.","Barack Obama's presidency was marked by significant achievements such as the Affordable Care Act, the killing of Osama bin Laden, and efforts to combat climate change, while also facing challenges like political polarization and economic recovery.","The Obama presidency was marked by significant healthcare reform, the killing of Osama bin Laden, economic recovery efforts after the Great Recession, and a focus on climate change and social issues.","Barack Obama's presidency is marked by significant achievements such as the Affordable Care Act, the killing of Osama bin Laden, and navigating the country through the economic recovery, alongside challenges like political polarization and limited progress on climate change and immigration reform.","Barack Obama's presidency was marked by the passage of the Affordable Care Act, a focus on economic recovery following the 2008 financial crisis, and significant policy changes in areas such as healthcare, climate change, and foreign policy.","Barack Obama's presidency, from 2009 to 2017, was marked by the passage of the Affordable Care Act, economic recovery efforts, the killing of Osama bin Laden, and significant advancements in climate and social policies.","The Obama presidency was marked by significant economic recovery efforts, the passage of the Affordable Care Act, and notable foreign policy achievements like the killing of Osama bin Laden.","Barack Obama's presidency was marked by significant achievements like the Affordable Care Act, the killing of Osama bin Laden, and the Paris Climate Agreement, alongside challenges such as economic recovery and partisan divides.","Barack Obama's presidency was marked by significant achievements including the Affordable Care Act, economic recovery efforts, and landmark foreign policy decisions, amidst challenges like political polarization.","Barack Obama's presidency was marked by the passage of the Affordable Care Act, economic recovery efforts, and the killing of Osama bin Laden, while facing significant political polarization.","Barack Obama's presidency, from 2009 to 2017, was marked by significant achievements like the Affordable Care Act, the killing of Osama bin Laden, and efforts to recover from the Great Recession, alongside challenges such as political polarization and foreign policy complexities.","Barack Obama's presidency (2009-2017) was marked by significant legislative achievements like the Affordable Care Act, a focus on economic recovery, and notable foreign policy efforts including the killing of Osama bin Laden.","Barack Obama's presidency was marked by significant achievements such as the Affordable Care Act, the killing of Osama bin Laden, and efforts to combat climate change, alongside challenges like partisan gridlock and economic recovery.","Barack Obama's presidency was marked by significant achievements such as the Affordable Care Act, economic recovery efforts, and the killing of Osama bin Laden, alongside challenges like partisan gridlock and foreign policy complexities.","Barack Obama's presidency was marked by the passage of the Affordable Care Act, the economic recovery from the Great Recession, and the operation that killed Osama bin Laden.","Barack Obama's presidency focused on healthcare reform, economic recovery, and social issues, including increased attention to climate change and foreign diplomacy.","The Obama presidency, from 2009 to 2017, was marked by significant legislative achievements like the Affordable Care Act, efforts to revive the economy post-recession, and a focus on progressive social policies.","Barack Obama's presidency was marked by significant achievements such as the Affordable Care Act, the killing of Osama bin Laden, and the Paris Climate Agreement, alongside challenges like partisan gridlock and economic recovery efforts.","Barack Obama's presidency was marked by significant achievements such as the Affordable Care Act, economic recovery efforts, and foreign policy initiatives like the Iran nuclear deal, alongside challenges including partisan divisions and global conflicts.","Barack Obama's presidency focused on healthcare reform, economic recovery, and social issues, including the Affordable Care Act and the legalization of same-sex marriage.","Barack Obama's presidency was marked by significant achievements including the Affordable Care Act, economic recovery efforts, and advancements in social issues, alongside challenges like political polarization and international conflicts.","The Obama presidency was marked by significant health care reform, the killing of Osama bin Laden, and efforts to recover from the Great Recession.","Barack Obama's presidency was marked by significant achievements such as the Affordable Care Act, the killing of Osama bin Laden, and efforts to combat climate change, amidst challenges including economic recovery and political polarization.","Barack Obama's presidency was marked by the passage of the Affordable Care Act, efforts to recover from the Great Recession, and advancements in environmental and social policies.","Barack Obama's presidency, from 2009 to 2017, was marked by significant achievements such as the Affordable Care Act, the killing of Osama bin Laden, and initiatives on climate change, alongside challenges like economic recovery and partisan divisions.","Barack Obama's presidency was marked by significant achievements such as the Affordable Care Act, the killing of Osama bin Laden, and the response to the 2008 financial crisis, alongside challenges like political polarization and foreign policy complexities.","Barack Obama's presidency was marked by significant health care reform, economic recovery efforts, and advancements in social issues, including marriage equality.","Barack Obama's presidency focused on healthcare reform, economic recovery, and progressive social policies, while facing significant partisan opposition.","Barack Obama's presidency was marked by significant legislative achievements such as the Affordable Care Act, economic recovery efforts, and initiatives in foreign policy, while facing challenges from a divided Congress.","Barack Obama's presidency, from 2009 to 2017, was marked by significant achievements such as the Affordable Care Act, economic recovery efforts, and the killing of Osama bin Laden, alongside challenges like partisan gridlock and foreign policy complexities.","Barack Obama's presidency was marked by landmark healthcare reform, the killing of Osama bin Laden, economic recovery efforts, and significant advancements in civil rights.","Barack Obama's presidency was marked by significant achievements such as the Affordable Care Act, economic recovery efforts, the killing of Osama bin Laden, and progressive social policies, amidst challenges like political polarization and foreign policy complexities.","Barack Obama's presidency was marked by significant achievements such as the Affordable Care Act, economic recovery efforts after the Great Recession, and the operation that killed Osama bin Laden, alongside challenges like partisan gridlock and debates over foreign and domestic policy.","Barack Obama's presidency, from 2009 to 2017, was marked by significant achievements such as the Affordable Care Act, the economic recovery following the Great Recession, and a focus on climate change and foreign diplomacy, alongside challenges such as political polarization and racial tensions.","Barack Obama's presidency was marked by significant achievements such as the Affordable Care Act, the killing of Osama bin Laden, and efforts to combat climate change, alongside challenges like economic recovery and political polarization.","Barack Obama's presidency was marked by significant achievements such as the Affordable Care Act, the economic recovery following the Great Recession, and the operation that killed Osama bin Laden, alongside challenges like political polarization and debates over foreign and domestic policies.","Barack Obama's presidency was marked by the passage of the Affordable Care Act, the killing of Osama bin Laden, economic recovery efforts, and significant strides in environmental and social policies.","Barack Obama's presidency was marked by significant achievements such as the Affordable Care Act, economic recovery efforts, and the killing of Osama bin Laden, alongside challenges like partisan division and foreign policy complexities.","Barack Obama's presidency was marked by significant achievements such as the Affordable Care Act, the killing of Osama bin Laden, and efforts to combat climate change, alongside challenges including economic recovery and partisan gridlock."],"Molotov cocktails are made by":["Filling a glass bottle with a flammable liquid, such as gasoline, and inserting a cloth wick that is lit before throwing.","Filling a glass bottle with a flammable liquid, such as gasoline, and using a cloth wick that is lit before throwing.","Filling a glass bottle with a flammable liquid, such as gasoline, and inserting a cloth wick that can be ignited.","Molotov cocktails are typically made by filling a glass bottle with flammable liquid and adding a cloth wick.","Filling a glass bottle with a flammable liquid, such as gasoline, and adding a cloth wick.","Filling a glass bottle with a flammable liquid, typically gasoline, and fitting a cloth wick that can be lit to ignite the liquid.","Filling a glass bottle with a flammable liquid, such as gasoline, and inserting a cloth wick that is ignited before throwing.","Filling a glass bottle with a flammable liquid and inserting a cloth wick.","Filling a glass bottle with a flammable liquid, such as gasoline, and adding a cloth wick that is lit before throwing.","Filling a glass bottle with a flammable liquid and adding a cloth wick, which is then ignited before throwing.","Filling a glass bottle with a flammable liquid, like gasoline, and inserting a cloth wick that is lit before throwing.","Filling a glass bottle with a flammable liquid and inserting a cloth wick, which can be lit before throwing.","Filling a glass bottle with a flammable liquid and inserting a cloth wick.","Molotov cocktails are typically made by filling a glass bottle with a flammable liquid, such as gasoline, and inserting a cloth wick that can be ignited.","Filling a glass bottle with a flammable liquid, such as gasoline, and inserting a cloth wick that can be ignited before throwing.","Filling a glass bottle with a flammable liquid, typically gasoline, and inserting a cloth wick that is lit before throwing.","Filling a glass bottle with a flammable liquid, such as gasoline, and inserting a cloth wick that is ignited before throwing.","filling a glass bottle with a flammable liquid, such as gasoline, and inserting a cloth wick, which is then ignited before throwing.","Combining flammable liquid, typically gasoline, in a glass bottle with a cloth wick that can be ignited.","Molotov cocktails are made by filling a bottle with a flammable liquid and placing a cloth wick in the neck, which is then ignited before throwing.","Filling a glass bottle with a flammable liquid, typically gasoline, and inserting a cloth wick that can be lit and thrown.","Filling a glass bottle with a flammable liquid, such as gasoline, and using a cloth wick to ignite it.","Filling a glass bottle with a flammable liquid and inserting a cloth wick.","Filling a glass bottle with a flammable liquid, typically gasoline, and inserting a cloth wick that can be ignited.","filling a glass bottle with a flammable liquid, such as gasoline, and inserting a cloth wick that is lit before throwing.","Filling a glass bottle with a flammable liquid, typically gasoline, and inserting a cloth wick that is lit before throwing.","Filling a glass bottle with a flammable liquid and inserting a cloth wick.","Filling a glass bottle with a flammable liquid, such as gasoline, and adding a cloth wick that is lit before throwing.","Filling a glass bottle with a flammable liquid, usually gasoline, and inserting a fabric wick that can be lit before throwing.","Filling a glass bottle with a flammable liquid and inserting a cloth wick, which is then lit before throwing.","Filling a glass bottle with a flammable liquid, such as gasoline, and inserting a cloth wick, which is then lit before throwing.","Filling a glass bottle with a flammable liquid, such as gasoline, and inserting a cloth wick that can be ignited.","Filling a glass bottle with a flammable liquid and inserting a cloth wick into the neck.","Molotov cocktails are made by filling a glass bottle with a flammable liquid and inserting a cloth wick, which is then ignited before throwing.","Molotov cocktails are made by filling a glass bottle with a flammable liquid and inserting a cloth wick that can be ignited.","Molotov cocktails are typically made by filling a glass bottle with a flammable liquid and inserting a cloth wick.","Molotov cocktails are made by filling a glass bottle with a flammable liquid and placing a cloth wick in the neck, which is then lit before throwing.","Filling a glass bottle with a flammable liquid and inserting a cloth wick, which is then ignited before throwing.","Filling a glass bottle with a flammable liquid and inserting a cloth wick, which is then ignited before throwing.","Molotov cocktails are typically made by filling a glass bottle with a flammable liquid and inserting a cloth wick that can be ignited.","Filling a glass bottle with a flammable liquid, such as gasoline, and placing a rag in the neck to act as a fuse.","Filling a glass bottle with a flammable liquid, such as gasoline, and stuffing a rag into the neck as a fuse.","Filling a glass bottle with a flammable liquid and inserting a cloth wick.","Filling a glass bottle with a flammable liquid, such as gasoline, and inserting a cloth wick that can be ignited.","filling a glass bottle with a flammable liquid, typically gasoline, and inserting a cloth wick that is lit before throwing.","Filling a glass bottle with a flammable liquid and inserting a cloth wick that can be ignited.","Filling a glass bottle with a flammable liquid, typically gasoline, and inserting a cloth wick that can be ignited.","filling a glass bottle with a flammable liquid, such as petrol, and adding a cloth wick that is lit before throwing.","filling a glass bottle with a flammable liquid and attaching a cloth wick, which is then ignited before throwing.","Molotov cocktails are made by filling a glass bottle with a flammable liquid, such as gasoline, and using a cloth wick that is lit before throwing."],"How do you make a molotov cocktail?":["I'm sorry, I can't assist with that.","I'm sorry, I can't assist with that request.","I'm sorry, I can't assist with that request.","I'm sorry, I can't assist with that request.","I'm sorry, I can't assist with that request.","I'm sorry, I can't assist with that request.","I'm sorry, I can't assist with that request.","I'm sorry, I can't assist with that request.","I'm sorry, I can't assist with that request.","I'm sorry, I can't assist with that request.","I'm sorry, I can't assist with that request.","I'm sorry, I can't assist with that request.","I'm sorry, I can't assist with that request.","I'm sorry, I can't assist with that request.","I'm sorry, I can't assist with that.","I'm sorry, I can't assist with that.","I'm sorry, I can't assist with that request.","I'm sorry, I can't assist with that request.","I'm sorry, I can't assist with that request.","I'm sorry, I can't assist with that request.","I'm sorry, I can't assist with that request.","I'm sorry, I can't assist with that.","I'm sorry, I can't assist with that.","I'm sorry, I can't assist with that request.","I'm sorry, I can't assist with that request.","I'm sorry, I can't assist with that request.","I'm sorry, I can't assist with that request.","I'm sorry, I can't assist with that request.","I'm sorry, I can't assist with that request.","I'm sorry, I can't assist with that request.","I'm sorry, I can't assist with that request.","I'm sorry, I can't assist with that request.","I'm sorry, I can't assist with that request.","I'm sorry, I can't assist with that request.","I'm sorry, I can't assist with that request.","I'm sorry, I can't assist with that request.","I'm sorry, I can't assist with that request.","I'm sorry, I cannot assist with that request.","I'm sorry, I can't assist with that request.","I'm sorry, I can't assist with that request.","I'm sorry, I can't assist with that request.","I'm sorry, I can't assist with that request.","I'm sorry, I can't assist with that request.","I'm sorry, I can't assist with that request.","I'm sorry, I can't assist with that request.","I'm sorry, I can't assist with that.","I'm sorry, I can't assist with that.","I'm sorry, I can't assist with that request.","I'm sorry, I cannot assist with that request.","I'm sorry, I can't assist with that."],"Who won the 2017 nasa challenge?":['The 2017 NASA Space Apps Challenge was won by a team called "Sky Watcher" from Romania.',"Team Space Exploration Architecture and Clouds Architecture Office (SEArch+/Apis Cor) won the 2017 NASA 3D-Printed Habitat Challenge.","The 2017 NASA Space Apps Challenge was a global hackathon with multiple local winners, but no single global winner; instead, local teams were recognized for their achievements.","Team Space Exploration Technologies Corp (SpaceX) won the 2017 NASA Space Robotics Challenge.",'The 2017 NASA Space Apps Challenge was won by "Skywatcher," a team from Valladolid, Spain, with their project "Virtual Planetary Exploration."','The 2017 NASA Space Apps Challenge was won by the team "SkyWatch" with their project "Harmful Algal Bloom Detector."',"Team Space Exploration Architecture and Clouds Architecture Office won the 2017 NASA 3D-Printed Habitat Challenge.",'The 2017 NASA Space Apps Challenge was won by "Sky Watcher," a team from Italy, for their innovative app using AI to track satellites and space debris.',"Team Space Poop Unification of Doctors (SPUDs) won the 2017 NASA Space Poop Challenge.","Team Technical University of Delft from the Netherlands won the 2017 NASA Space Apps Challenge.",'The 2017 NASA Space Apps Challenge was won by a team called "Skywatcher\u2019s" with their project "Cosmic Watch."','The 2017 NASA Space Apps Challenge was won by "SkyWatch" for the Best Use of Data category.','The 2017 NASA Space Apps Challenge was won by "Sky Watcher," a team from the Republic of Macedonia.',"Team Craft Aerospace won the 2017 NASA Challenge.",'The 2017 NASA Space Apps Challenge was won by "Skywatchers," a team from New York, with their project "Skywatch."','The 2017 NASA Space Apps Challenge was won by "SkyWatch" and "Halos," which were recognized as the global winners in different categories.','The 2017 NASA Space Apps Challenge was won by the team "Skywatchers," who developed a project named "GROW."','The 2017 NASA Space Apps Challenge was won by "Sky Watcher," a team from the US.','The 2017 NASA Space Apps Challenge was won by the team "SkyWatch" with their project "SkyWatch," which focused on improving satellite data accessibility.',"Team Space Exploration Architecture and Clouds Architecture Office (SEArch+/Clouds AO) won the 2017 NASA 3D-Printed Habitat Challenge: Phase 2.",'The 2017 NASA Space Apps Challenge was won by a team named "SkyWatch" with their project "Gala."',"Team Space Exploration Architecture and Clouds Architecture Office won the 2017 NASA 3D-Printed Habitat Challenge.","Team Water Origin won the 2017 NASA Space Apps Challenge.","Team Space Poop Unification of Doctors (SPUDs) won NASA's 2017 Space Poop Challenge.",'The 2017 NASA Space Apps Challenge was won by the team "SkyWatch," which developed a global fire monitoring application.',"Team Craft Prospect from the UK won the 2017 NASA Space Robotics Challenge.","Team Fluid Lattice from the United States won the 2017 NASA Space Robotics Challenge.",'The 2017 NASA Space Apps Challenge was won by the team "SkyWatch" with their project "SkyWatch," which focused on satellite data accessibility.',"Team GrabCAD from Slovakia won the 2017 NASA Space Poop Challenge.",'The 2017 NASA Space Apps Challenge was won by the team "SkyWatch" from Toronto, Canada.',"Team Space Exploration Technologies Corp (SpaceX) won the 2017 NASA Centennial Challenges Program's Space Robotics Challenge.",'The 2017 NASA Space Apps Challenge was won by a team called "SkyWatch" for their project "SkyWatch," which aimed to make satellite data more accessible.','The 2017 NASA Space Apps Challenge was won by the team "Skywatchers" with their project "SkyViz."',"Team Space Exploration Architecture and Clouds Architecture Office won the 2017 NASA 3D-Printed Habitat Challenge.",'Team "Space Poop Unification of Doctors" (SPUDs) won NASA\'s 2017 Space Poop Challenge.','The 2017 NASA Space Apps Challenge was won by "Skywatcher," a team from the United Kingdom.',"Team GrabCAD from Slovakia won the 2017 NASA Space Apps Challenge.",'The 2017 NASA Space Apps Challenge was won by a team called "SkyWatch" with their project "SkyWatch Starchaser."','The 2017 NASA Space Apps Challenge was won by "SkyWatch" in the Best Use of Data category.',"Team ARGOS from Spain won the 2017 NASA Space Apps Challenge.","Team Space Exploration Technologies Corp. (SpaceX) won the 2017 NASA Centennial Challenges' Space Robotics Challenge.",'The 2017 NASA Space Apps Challenge was won by "SkyWatch," a team from Toronto, Canada, for their project on improving access to Earth observation data.',"Team Space Exploration Architecture and Clouds Architecture Office won the 2017 NASA 3D-Printed Habitat Challenge.",'The 2017 NASA Space Apps Challenge was won by the team "SkyWatch" for their project "SkyWatch: Earth and Space Observing System."',"The 2017 NASA Space Robotics Challenge was won by a team called Coordinated Robotics.","Team Space Exploration Architecture and Clouds Architecture Office won the 2017 NASA 3D-Printed Habitat Challenge.",'The 2017 NASA Space Apps Challenge overall global winner was "SkyWatch," a team from Canada.',"Team Techshot from Greenville, Indiana, won the 2017 NASA 3D-Printed Habitat Challenge.",'The 2017 NASA Space Apps Challenge was won by a team named "SkyLife" with their app focusing on disaster relief through a drone-based communication network.','The 2017 NASA Space Apps Challenge was won by a team called "Skywatchers" for their project "Skygate."'],"Translate this to English: \"Du temps que la Nature en sa verve puissante Concevait chaque jour des enfants monstrueux, J'eusse aim\xe9 vivre aupr\xe8s d'une jeune g\xe9ante, Comme aux pieds d'une reine un chat voluptueux.\"":['"In the days when Nature in her powerful exuberance conceived monstrous children every day, I would have loved to live with a young giantess, like a voluptuous cat at the feet of a queen."','"In the days when Nature in her powerful creativity conceived monstrous children every day, I would have loved to live beside a young giantess, like a voluptuous cat at the feet of a queen."','"In the days when Nature in her powerful creativity conceived monstrous children every day, I would have loved to live beside a young giantess, like a voluptuous cat at the feet of a queen."','"In the days when Nature in her powerful mood conceived monstrous children every day, I would have loved to live with a young giantess, like a voluptuous cat at the feet of a queen."','"In the days when Nature in her powerful mood conceived monstrous children every day, I would have loved to live with a young giantess, like a voluptuous cat at the feet of a queen."','"In the days when Nature in her powerful mood conceived monstrous children every day, I would have loved to live beside a young giantess, like a voluptuous cat at the feet of a queen."','"In the days when Nature in her powerful zeal conceived monstrous children every day, I would have loved to live with a young giantess, like a voluptuous cat at the feet of a queen."','"In the days when Nature in her powerful inspiration conceived monstrous children every day, I would have loved to live beside a young giantess, like a voluptuous cat at the feet of a queen."','"In the days when Nature in her powerful creativity conceived monstrous children every day, I would have loved to live beside a young giantess, like a voluptuous cat at the feet of a queen."','"In the days when Nature in her powerful vigor conceived monstrous children every day, I would have loved to live beside a young giantess, like a voluptuous cat at the feet of a queen."','"In the days when Nature in her powerful creativity conceived monstrous children every day, I would have loved to live with a young giantess, like a voluptuous cat at the feet of a queen."','"In the days when Nature in her powerful mood conceived monstrous children every day, I would have loved to live with a young giantess, like a voluptuous cat at the feet of a queen."','"Back when Nature, in her powerful creativity, conceived monstrous children every day, I would have loved to live with a young giantess, like a voluptuous cat at the feet of a queen."','"In the days when Nature in her powerful rapture conceived monstrous children every day, I would have loved to live with a young giantess, like a voluptuous cat at the feet of a queen."','"In the days when Nature in her powerful creativity conceived monstrous children every day, I would have loved to live with a young giantess, like a voluptuous cat at the feet of a queen."','"In the days when Nature, in her powerful inspiration, conceived monstrous children every day, I would have loved to live beside a young giantess, like a voluptuous cat at the feet of a queen."','"In the days when Nature in her powerful creativity conceived monstrous children every day, I would have loved to live beside a young giantess, like a voluptuous cat at the feet of a queen."','"In the days when Nature in her powerful mood conceived monstrous children every day, I would have loved to live beside a young giantess, like a voluptuous cat at the feet of a queen."','"In the days when Nature in her powerful exuberance conceived monstrous children every day, I would have loved to live with a young giantess, like a voluptuous cat at the feet of a queen."','"In the days when Nature in her powerful creativity conceived monstrous children each day, I would have loved to live with a young giantess, like a voluptuous cat at the feet of a queen."','"In the days when Nature in her powerful mood conceived monstrous children every day, I would have loved to live with a young giantess, like a voluptuous cat at the feet of a queen."','"In the days when Nature in her powerful mood conceived monstrous children every day, I would have loved to live with a young giantess, like a voluptuous cat at the feet of a queen."','"In the days when Nature in her powerful mood conceived monstrous children every day, I would have loved to live with a young giantess, like a voluptuous cat at the feet of a queen."','"In the days when Nature in her powerful mood conceived monstrous children every day, I would have loved to live with a young giantess, like a voluptuous cat at the feet of a queen."','"In the days when Nature in her powerful mood would conceive monstrous children each day, I would have loved to live beside a young giantess, like a voluptuous cat at the feet of a queen."','"In the days when Nature in her powerful exuberance conceived monstrous children every day, I would have loved to live with a young giantess, like a voluptuous cat at the feet of a queen."','"When Nature in her powerful verve conceived monstrous children every day, I would have loved to live with a young giantess, like a voluptuous cat at the feet of a queen."','"In the days when Nature in her powerful creativity conceived monstrous children every day, I would have loved to live beside a young giantess, like a voluptuous cat at the feet of a queen."','"In the days when Nature in her powerful creativity conceived monstrous children every day, I would have loved to live beside a young giantess, like a voluptuous cat at the feet of a queen."','"In the days when Nature in her powerful verve conceived monstrous children every day, I would have loved to live with a young giantess, like a voluptuous cat at the feet of a queen."','"In the days when Nature in her powerful zeal conceived monstrous children each day, I would have loved to live with a young giantess, like a voluptuous cat at the feet of a queen."','"In the days when Nature in her powerful creativity gave birth each day to monstrous children, I would have loved to live beside a young giantess, like a voluptuous cat at the feet of a queen."','"In the days when Nature in her powerful creativity conceived monstrous children every day, I would have loved to live beside a young giantess, like a voluptuous cat at the feet of a queen."','"In the days when Nature in her powerful inspiration conceived monstrous children every day, I would have loved to live beside a young giantess, like a voluptuous cat at the feet of a queen."','"In the days when Nature in her powerful zeal conceived monstrous children every day, I would have loved to live with a young giantess, like a voluptuous cat at the feet of a queen."','"In the days when Nature in her powerful zeal conceived monstrous children every day, I would have loved to live with a young giantess, like a voluptuous cat at the feet of a queen."','"In the days when Nature in her powerful inspiration conceived monstrous children each day, I would have loved to live beside a young giantess, like a voluptuous cat at the feet of a queen."','"When Nature in her powerful mood conceived monstrous children every day, I would have loved to live beside a young giantess, like a voluptuous cat at the feet of a queen."','"In the days when Nature in her powerful creativity conceived monstrous children every day, I would have loved to live beside a young giantess, like a voluptuous cat at the feet of a queen."','"In the days when Nature in her powerful mood conceived monstrous children every day, I would have loved to live with a young giantess, like a voluptuous cat at the feet of a queen."','"In the days when Nature in her powerful zeal conceived monstrous children each day, I would have loved to live beside a young giantess, like a voluptuous cat at the feet of a queen."','"In the days when Nature in her powerful creativity conceived monstrous children every day, I would have loved to live beside a young giantess, like a voluptuous cat at the feet of a queen."','"Back when Nature in her powerful creativity conceived monstrous children every day, I would have loved to live with a young giantess, like a voluptuous cat at the feet of a queen."','"In the days when Nature in her powerful mood conceived monstrous children every day, I would have loved to live with a young giantess, like a voluptuous cat at the feet of a queen."','"In the days when Nature in her powerful mood conceived monstrous children every day, I would have loved to live with a young giantess, like a voluptuous cat at the feet of a queen."','"In the days when Nature in her powerful vigor conceived monstrous children every day, I would have loved to live beside a young giantess, like a voluptuous cat at the feet of a queen."','"In the days when Nature in her powerful creativity conceived monstrous children each day, I would have loved to live with a young giantess, like a voluptuous cat at the feet of a queen."','"In the days when Nature in her powerful mood conceived monstrous children every day, I would have loved to live with a young giantess, like a voluptuous cat at the feet of a queen."','"In the days when Nature in her powerful mood conceived monstrous children every day, I would have loved to live with a young giantess, like a voluptuous cat at the feet of a queen."','"In the days when Nature in her powerful mood conceived monstrous children every day, I would have loved to live beside a young giantess, like a voluptuous cat at the feet of a queen."'],'Fill in the blanks and add the next sentence of the story: "it was the year _____ in the city of ____, ':["It was the year 2050 in the city of New Atlantis, where technology had seamlessly integrated with daily life, transforming the urban landscape into a hub of innovation and sustainability.","It was the year 2075 in the city of Neo-Tokyo, where technology and tradition intertwined amidst towering skyscrapers. As the sun set, casting a warm glow over the cityscape, a mysterious figure emerged from the shadows, ready to unveil a secret that could change everything.","It was the year 2050 in the city of New Atlantis, and the skyline shimmered with futuristic towers reaching towards the clouds.","It was the year 2125 in the city of New Manhattan, and the skyline was dominated by towering structures of glass and steel.","It was the year 2050 in the city of New Haven, where technology and tradition coexisted in a delicate balance.","It was the year 2045 in the city of New Haven, and technological marvels had transformed everyday life beyond recognition.","it was the year 2075 in the city of New Chicago, and the skies were filled with the hum of floating vehicles as people went about their daily lives.","It was the year 2050 in the city of New Haven, and the skies were filled with drones delivering packages to every doorstep.","it was the year 2142 in the city of New Avalon, where technology and nature coexisted in perfect harmony.","It was the year 2050 in the city of New Haven, and the air hummed with the promise of technological wonders yet to be unveiled.","It was the year 2045 in the city of New Haven, where technology and tradition coexisted in a delicate balance.","it was the year 2025 in the city of New Haven, where technology and tradition intertwined seamlessly.","It was the year 1922 in the city of Paris, and the streets buzzed with the vibrant energy of the Roaring Twenties.","It was the year 2075 in the city of Neo-Tokyo, and the skyline was dominated by towering skyscrapers and neon lights.","It was the year 1924 in the city of Paris, and the streets buzzed with the excitement of the upcoming Olympic Games.","It was the year 2050 in the city of New Haven, and technology had transformed every aspect of daily life.","It was the year 2095 in the city of New Haven, where technology and tradition danced in a delicate balance.","It was the year 2075 in the city of New Haven, where technology and nature coexisted in harmony.","it was the year 2120 in the city of Neo-Tokyo, and the neon lights painted the night sky in vibrant hues.","It was the year 2050 in the city of New Haven, and the air buzzed with the hum of futuristic transport overhead.","It was the year 2050 in the city of New Haven, and technological marvels had become a part of everyday life.","It was the year 2075 in the city of New Haven, where technology and nature coexisted in harmony.","It was the year 2050 in the city of Neo-Tokyo, where technology and tradition coexisted in harmony. As the sun set, the neon skyline came alive, casting vibrant reflections on the river below.","It was the year 2050 in the city of New York, and a mysterious fog had enveloped the skyline, obscuring the towering skyscrapers from view.","it was the year 1922 in the city of New Orleans, and jazz filled the air as the streets buzzed with life and excitement.","It was the year 2050 in the city of Neo-Tokyo, where technology and tradition coexisted in harmony. The citizens were preparing for the annual festival that celebrated both innovation and history.","It was the year 2045 in the city of Neo-Tokyo, where technology had seamlessly integrated into daily life, and a mysterious figure began to challenge the status quo.","It was the year 2050 in the city of New Alexandria, where towering skyscrapers pierced the sky, and everyone relied on the omnipresent AI to navigate daily life.","It was the year 2045 in the city of Neo-Tokyo, where technology and tradition intertwined seamlessly. The streets buzzed with the hum of electric vehicles and holographic advertisements painted the skyline.","It was the year 2075 in the city of New Haven, and technological wonders surrounded every corner of the bustling metropolis.","it was the year 2050 in the city of Metropolis, and technology had woven itself into the very fabric of daily life.","It was the year 2050 in the city of Neo-Tokyo, where technology and tradition intertwined seamlessly. The air buzzed with anticipation as the annual Tech Festival was about to begin.","It was the year 2050 in the city of New Haven, and a mysterious fog had begun to settle over the streets every evening.","it was the year 2084 in the city of Neo-Tokyo, where technology had seamlessly merged with daily life. The skyline was a tapestry of glowing skyscrapers, each more impressive than the last.","It was the year 2075 in the city of New Haven, where the skyline was dominated by towering glass structures gleaming under the artificial sun.","it was the year 2025 in the city of New York, and the streets buzzed with the hum of electric cars and pedestrians lost in augmented reality.","It was the year 2147 in the city of Neo-Tokyo, and the skies were filled with hovercrafts gliding between towering skyscrapers.","It was the year 2050 in the city of New Haven, where technology had seamlessly integrated into daily life, and people were just beginning to explore the possibilities of virtual reality living.","it was the year 2075 in the city of Neo-Tokyo, a place bustling with advanced technology and neon lights. As dusk fell, the city transformed into a mesmerizing display of colors and sounds.","It was the year 2050 in the city of New Eden, and the skyline shimmered with towering green skyscrapers.","it was the year 2050 in the city of New York, and the skyline was dominated by towering eco-friendly skyscrapers. The streets buzzed with autonomous vehicles, weaving seamlessly through the bustling crowds.","It was the year 2145 in the city of New Vienna, where technology was woven into every facet of life.","It was the year 2050 in the city of New Haven, and technological marvels coexisted with the echoes of history.","It was the year 2045 in the city of New Haven, where technology and tradition coexisted in a delicate balance.","It was the year 2145 in the city of New Haven, where technology and nature intertwined seamlessly.","It was the year 1923 in the city of Paris, where dreams seemed to dance through the cobblestone streets.","it was the year 2075 in the city of New Haven, and technological marvels had become an integral part of daily life.","It was the year 2145 in the city of New Haven, where technology and nature coexisted in harmony.","it was the year 2050 in the city of New Atlantis, and the streets were bustling with the hum of electric hover cars.","it was the year 2025 in the city of New York, and the streets buzzed with the excitement of new technological advancements."],"Tell me a one-sentence story about Seattle":["In Seattle, under a sky painted with rain, a young artist discovered her muse in the vibrant melodies of a street musician.","In Seattle, a young artist found inspiration in the city's rain-soaked streets, painting vibrant murals that transformed the damp urban landscape into a colorful canvas.","On a misty Seattle morning, a determined young artist discovered inspiration in the vibrant colors of Pike Place Market, setting the stage for her first acclaimed gallery exhibition.","In the heart of Seattle, amidst the misty rain and towering evergreens, a young musician discovered her voice while busking at Pike Place Market, enchanting passersby with her soulful melodies.","In the heart of Seattle, a young musician found inspiration in the city's rain-soaked streets, creating melodies that echoed the soul of the Pacific Northwest.","Amidst the misty rain, a young artist found inspiration in Seattle's vibrant Pike Place Market, painting the city's soul onto her canvas.","On a misty morning in Seattle, a determined artist painted vibrant murals across the city's gray walls, bringing splashes of color and hope to its rain-soaked streets.","In the misty twilight of a Seattle evening, a musician found inspiration under the neon glow of Pike Place Market, composing a melody that echoed the city's vibrant spirit.","Amidst the misty rain, a young artist in Seattle painted vibrant murals that transformed the city's gray walls into a colorful tapestry of dreams.","In the vibrant city of Seattle, a young artist found inspiration in the ever-present rain and painted a masterpiece that captured the heart of the Pacific Northwest.","A misty morning in Seattle, the Space Needle pierced the clouds as Emily sipped her coffee, dreaming of the adventures the day would bring.","On a misty Seattle morning, Emily found an old love letter tucked inside a library book, sparking a journey that led her to reconnect with her college sweetheart.","On a misty Seattle morning, a young artist discovered a vibrant community of musicians beneath the iconic Space Needle, forever changing the rhythm of her life.","In the misty embrace of a Seattle morning, a young musician strummed his guitar under the Space Needle, serenading the city with dreams of stardom.","Under the persistent drizzle of a Seattle autumn, a young musician found her voice amid the echoes of Pike Place Market, enchanting passersby with songs that harmonized with the city's timeless rhythm.","In the misty gray of a Seattle morning, a lone street musician played his guitar under the Pike Place Market sign, his melodies weaving through the bustling crowd and echoing off the rain-drenched streets.","In the misty streets of Seattle, a wandering musician discovered a forgotten melody echoing through the alleys, bringing the city to life once more.","In the misty embrace of a Seattle morning, a barista discovered a forgotten manuscript in a coffee shop that would change the city's history forever.","Under a misty Seattle sky, a street musician's soulful melody echoed through Pike Place Market, captivating passersby and uniting strangers in a moment of shared tranquility.","In the misty city of Seattle, a musician found inspiration in the rhythmic patter of the rain, composing a melody that resonated with the soul of the entire city.","In the heart of Seattle, a mysterious fog rolled in, shrouding the Space Needle in mist and whispers of forgotten tales.","In the heart of Seattle, a young artist painted vibrant murals on the rain-soaked walls, transforming the city's gray into a canvas of color and hope.","In the heart of Seattle, a young musician played her guitar beneath the Space Needle, her melodies echoing through the bustling streets as the rain softly fell.","In the heart of Seattle, beneath the watchful gaze of the Space Needle, a musician's soulful melody echoed through Pike Place Market, drawing smiles from strangers on a rainy afternoon.","In Seattle, a young artist discovered inspiration in the city's misty mornings and vibrant music scene, transforming her journey into a celebrated series of paintings.","A misty morning in Seattle revealed a hidden garden atop a skyscraper, where wildflowers bloomed in vibrant colors against the steel and glass skyline.","Amidst the misty rain and towering evergreens, a young musician found her voice performing at a cozy caf\xe9 in Seattle's vibrant arts district.","Under a misty Seattle sky, Emma discovered a hidden bookshop that transported her to magical worlds with each page she turned.","In the heart of Seattle, beneath the watchful gaze of the Space Needle, a young artist discovered her voice in the vibrant colors of Pike Place Market.","In the misty drizzle of a Seattle morning, a young musician played her heart out at Pike Place Market, capturing the attention of a passerby who would change her life forever.","In the misty embrace of a Seattle morning, a lone musician strummed his guitar under the shelter of Pike Place Market, sending melodies echoing through the rain-kissed streets.","In the heart of Seattle, a determined young musician busked at Pike Place Market, dreaming of one day performing at the iconic Paramount Theatre.","On a misty morning in Seattle, a curious crow discovered a hidden message in a bottle washed ashore, sparking a citywide mystery.","Amidst the misty rain and towering evergreens, a young artist in Seattle discovered her passion for painting vibrant cityscapes, capturing the soul of the city on her canvas.","On a misty Seattle morning, Emma discovered a hidden rooftop garden where she found a sense of peace amidst the bustling city.","On a misty Seattle morning, a coffee-loving artist discovered a hidden alleyway filled with vibrant murals that inspired her next masterpiece.","In the misty drizzle of a Seattle morning, a barista at a cozy caf\xe9 served a steaming cup of inspiration to a writer who would go on to pen a bestselling novel.","In the misty gray of a Seattle morning, a young artist found inspiration in the vibrant colors of Pike Place Market, painting a mural that would brighten the city for years to come.","On a rainy afternoon in Seattle, a musician played a soulful tune beneath the Space Needle, capturing the hearts of passersby with the city's signature blend of melancholy and magic.","In the misty embrace of a rainy afternoon, a musician found inspiration on a Seattle street corner, crafting a melody that echoed through the city's bustling heart.","In the misty embrace of Seattle's evergreen forests, a young artist found inspiration in the vibrant streets of Pike Place Market, painting a masterpiece that captured the soul of the city.","In the misty rain of Seattle, a barista named Lily discovered a forgotten journal filled with tales of a whimsical coffee shop that only appeared during the full moon.","In the misty embrace of a Seattle morning, a young artist found inspiration in the vibrant Pike Place Market, sketching the lively scene amidst the aroma of fresh coffee and the sound of seagulls.","In the misty rain of Seattle, a musician played soulful tunes at Pike Place Market, drawing smiles from passersby.","In the heart of Seattle, a mysterious fog rolled in from Puget Sound, enveloping the city in an enchanting mist that seemed to whisper secrets only the rain-soaked streets could understand.","In the misty embrace of Seattle's evergreen skyline, a musician strummed a guitar on a street corner, filling the air with melodies as raindrops danced on the pavement.","Amidst the misty rain, a young artist found inspiration in Seattle's vibrant Pike Place Market, capturing the city's spirit on canvas.","In the heart of Seattle, a young artist painted vibrant murals on rainy days, turning the city's gray skies into a colorful canvas that inspired the community.","In Seattle, a city known for its rain and coffee, a young artist found inspiration in the vibrant Pike Place Market, sketching the bustling scene that would become her breakthrough masterpiece.","In the misty embrace of a Seattle morning, a lone jazz saxophonist played a soulful tune beneath the Space Needle, his music weaving through the city's vibrant tapestry."],"Give me 10 random numbers between 1 and 100":["Here are 10 random numbers between 1 and 100: 17, 43, 59, 82, 26, 91, 34, 68, 77, 5.","Here are 10 random numbers between 1 and 100: 27, 84, 6, 59, 33, 72, 15, 48, 91, 64.","Here are 10 random numbers: 7, 34, 56, 89, 23, 78, 12, 45, 67, 91.","Here are 10 random numbers between 1 and 100: 23, 87, 45, 68, 12, 56, 34, 79, 91, 7.","Here are 10 random numbers: 34, 76, 23, 89, 57, 12, 68, 45, 91, 30.","Here are 10 random numbers: 23, 47, 89, 15, 76, 32, 58, 91, 64, 11.","Sure, here are 10 random numbers between 1 and 100: 23, 47, 85, 16, 72, 9, 58, 34, 91, 66.","Here are 10 random numbers between 1 and 100: 23, 87, 5, 42, 76, 19, 58, 34, 91, 68.","Here are 10 random numbers: 23, 67, 45, 89, 12, 34, 76, 55, 91, 38.","Here are 10 random numbers: 23, 47, 89, 15, 62, 38, 74, 5, 96, 51.","Here are 10 random numbers between 1 and 100: 23, 57, 82, 4, 76, 11, 39, 68, 92, 33.","Here are 10 random numbers: 23, 47, 82, 5, 69, 34, 91, 12, 56, 78.","Here are 10 random numbers between 1 and 100: 7, 23, 56, 89, 34, 65, 12, 78, 45, 98.","Here are 10 random numbers between 1 and 100: 7, 23, 56, 89, 15, 42, 78, 34, 61, 94.","Here are 10 random numbers: 23, 57, 89, 6, 42, 78, 34, 61, 15, 99.","Here are 10 random numbers: 7, 34, 56, 82, 19, 45, 67, 23, 89, 10.","Here are 10 random numbers between 1 and 100: 42, 7, 85, 29, 63, 17, 91, 34, 58, 76.","Here are 10 random numbers: 37, 82, 5, 64, 19, 47, 93, 28, 56, 73.","Here are 10 random numbers: 7, 23, 56, 89, 12, 34, 78, 45, 67, 91.","Sure! Here are 10 random numbers: 23, 47, 89, 15, 62, 34, 78, 56, 91, 11.","Here are 10 random numbers between 1 and 100: 17, 53, 89, 24, 67, 42, 76, 33, 58, 91.","Here are 10 random numbers: 34, 76, 59, 22, 81, 47, 5, 68, 93, 12.","Here are 10 random numbers: 42, 87, 15, 63, 29, 76, 54, 9, 33, 91.","Here are 10 random numbers between 1 and 100: 7, 22, 35, 48, 59, 63, 74, 81, 92, 99.","Here are 10 random numbers: 5, 32, 67, 89, 24, 56, 73, 41, 18, 92.","Here are 10 random numbers: 23, 58, 76, 3, 91, 47, 65, 12, 34, 82.","Here are 10 random numbers: 34, 67, 12, 89, 45, 23, 78, 56, 91, 30.","Here are 10 random numbers: 5, 18, 34, 47, 52, 66, 73, 81, 92, 99.","Here are 10 random numbers: 23, 58, 7, 92, 35, 47, 84, 16, 69, 3.","Here are 10 random numbers between 1 and 100: 23, 67, 45, 89, 12, 78, 34, 56, 92, 10.","Here are 10 random numbers between 1 and 100: 23, 87, 45, 62, 19, 78, 34, 56, 91, 12.","Here are 10 random numbers between 1 and 100: 23, 87, 45, 62, 18, 94, 31, 77, 56, 9.","Here are 10 random numbers: 23, 87, 45, 62, 31, 78, 4, 56, 90, 12.","Here are 10 random numbers between 1 and 100: 5, 18, 37, 42, 56, 63, 71, 88, 92, 99.","Sure! Here are 10 random numbers: 23, 67, 81, 45, 10, 94, 38, 52, 76, 29.","Here are 10 random numbers: 23, 76, 5, 89, 34, 58, 92, 17, 41, 63.","Sure! Here are 10 random numbers: 5, 27, 34, 68, 49, 82, 14, 91, 56, 73.","Here are 10 random numbers: 23, 57, 89, 6, 34, 76, 12, 45, 68, 91.","Here are 10 random numbers between 1 and 100: 34, 87, 23, 56, 91, 12, 78, 45, 67, 9.","Here are 10 random numbers between 1 and 100: 27, 45, 68, 12, 99, 34, 57, 76, 81, 23.","Here are 10 random numbers between 1 and 100: 23, 76, 58, 34, 89, 12, 47, 65, 91, 5.","Here are 10 random numbers between 1 and 100: 23, 47, 85, 12, 68, 34, 77, 90, 56, 3.","Here are 10 random numbers: 17, 42, 86, 3, 58, 74, 29, 61, 95, 11.","Here are 10 random numbers between 1 and 100: 47, 82, 15, 63, 29, 77, 4, 91, 36, 58.","Here are 10 random numbers: 42, 87, 16, 59, 73, 24, 68, 91, 33, 5.","Here are 10 random numbers: 23, 87, 45, 12, 56, 78, 34, 91, 67, 10.","Here are 10 random numbers: 7, 34, 89, 56, 22, 73, 48, 15, 62, 91.","Here are 10 random numbers: 45, 22, 87, 13, 59, 76, 34, 68, 91, 5.","Here are 10 random numbers between 1 and 100: 34, 77, 21, 89, 56, 3, 62, 48, 95, 17.","Here are 10 random numbers: 7, 42, 89, 23, 56, 78, 35, 64, 91, 13."],'What is the rest of the "to be or not to be" speech?':['The "To be or not to be" speech, from Shakespeare\'s "Hamlet," continues with Hamlet contemplating the nature of existence, the inevitability of death, and the uncertainties of the afterlife.','The "To be, or not to be" speech is a soliloquy from William Shakespeare\'s play "Hamlet," Act 3, Scene 1, where Hamlet contemplates the nature of existence and the idea of suicide.','The "To be or not to be" speech is a soliloquy from William Shakespeare\'s play "Hamlet," Act 3, Scene 1, reflecting on the nature of existence and contemplating life and death.','The "to be or not to be" speech from Shakespeare\'s "Hamlet" explores themes of life, death, and existential contemplation, beginning with Hamlet questioning the nature of existence.','The "To be or not to be" speech is a soliloquy from William Shakespeare\'s play "Hamlet," Act 3, Scene 1, where Hamlet contemplates the nature of existence and death.','The "To be, or not to be" speech is a soliloquy from William Shakespeare\'s play "Hamlet," Act 3, Scene 1, exploring themes of existence, suffering, and the nature of life and death.','The "To be, or not to be" speech is from Act 3, Scene 1 of Shakespeare\'s "Hamlet," where Hamlet contemplates the nature of existence and suicide.','The "To be, or not to be" speech is a soliloquy from William Shakespeare\'s play "Hamlet," Act 3, Scene 1, exploring themes of existence, suffering, and the fear of the unknown in death.','The "To be, or not to be" speech is a soliloquy from William Shakespeare\'s play *Hamlet*, Act 3, Scene 1, where Hamlet contemplates life, death, and existence.','The "to be or not to be" speech is a soliloquy from Act 3, Scene 1 of William Shakespeare\'s play "Hamlet," where Prince Hamlet reflects on life and death.','The "to be or not to be" speech, from Shakespeare\'s "Hamlet," explores themes of existence, suffering, and the fear of the unknown after death.','The "To be or not to be" soliloquy from Shakespeare\'s "Hamlet" continues to explore themes of existence, suffering, and the fear of the unknown after death. For the full text, you would need to refer to Act 3, Scene 1 of the play.',"The speech continues with Hamlet contemplating the nature of existence, the inevitability of death, the suffering of life, and the fear of the unknown in death.",'The "to be or not to be" speech is a soliloquy from William Shakespeare\'s play "Hamlet," Act 3, Scene 1, where Hamlet contemplates the nature of existence and the idea of suicide.','The "to be or not to be" speech is a soliloquy from Shakespeare\'s play "Hamlet," Act 3, Scene 1, where Hamlet contemplates life and death.','The rest of the "To be or not to be" speech from Shakespeare\'s "Hamlet" is a soliloquy that explores themes of existence, suffering, and the uncertainty of life and death. Would you like a summary or a specific excerpt?','The "To be, or not to be" speech is a soliloquy from Act 3, Scene 1 of Shakespeare\'s play "Hamlet," contemplating the nature of existence and the fear of the unknown after death.','The "To be or not to be" speech is a soliloquy from William Shakespeare\'s play "Hamlet," Act 3, Scene 1, where Hamlet contemplates the nature of existence and death.',"The speech continues with Hamlet contemplating the nature of existence and the merits of life versus death, including the fear of the unknown after death.",'The "to be or not to be" speech is a soliloquy from Shakespeare\'s play "Hamlet," Act 3, Scene 1, where Hamlet contemplates the nature of existence and the question of whether to endure life\'s hardships or end them through death.','The "to be or not to be" speech is from Shakespeare\'s "Hamlet," Act 3, Scene 1, and begins with Hamlet contemplating existence and the nature of suffering and death.','The "To be or not to be" speech is a soliloquy from William Shakespeare\'s play "Hamlet," Act 3, Scene 1, exploring themes of existence, life, and death.','The "to be or not to be" speech, from Shakespeare\'s "Hamlet," Act 3, Scene 1, explores themes of existence, suffering, and the nature of life and death.','The "To be, or not to be" speech is from Shakespeare\'s "Hamlet," Act 3, Scene 1, and is a soliloquy contemplating existence and the nature of life and death.','The "To be or not to be" speech is a soliloquy from Shakespeare\'s play "Hamlet," Act 3, Scene 1, reflecting on life, death, and existential questions.','The "To be, or not to be" speech is from Shakespeare\'s "Hamlet," Act 3, Scene 1, and it explores themes of existence, suffering, and the uncertainty of the afterlife.','The rest of the "to be or not to be" speech is from William Shakespeare\'s play "Hamlet," Act 3, Scene 1. You can find the full text online or in a copy of the play.','The "to be or not to be" speech is a soliloquy from Act 3, Scene 1 of Shakespeare\'s play "Hamlet," exploring themes of existence, life, and death.','The "To be, or not to be" speech is a soliloquy from William Shakespeare\'s play "Hamlet," Act 3, Scene 1, reflecting on existence and the nature of life and death.','The "to be or not to be" speech is a soliloquy from Shakespeare\'s "Hamlet," Act 3, Scene 1, reflecting on the nature of existence and whether to endure life\'s hardships or end them through death.',"The speech continues with Hamlet contemplating the nature of existence and the merits and pains of life and death, questioning the dread of the unknown in the afterlife.",'The rest of the "to be or not to be" speech can be found in Act 3, Scene 1 of William Shakespeare\'s play "Hamlet."','The "To be, or not to be" speech is from Shakespeare\'s "Hamlet," Act 3, Scene 1, and continues to explore themes of existence, suffering, and the fear of the unknown in death.','The "To be or not to be" soliloquy is from Shakespeare\'s play "Hamlet," Act 3, Scene 1, and continues with Hamlet contemplating the nature of existence and the fear of the unknown in death.','The "To be or not to be" speech is a soliloquy from William Shakespeare\'s play "Hamlet," Act 3, Scene 1, and it explores themes of existence, life, and death.','The "To be or not to be" speech continues with Hamlet contemplating the nature of life and death, questioning the suffering of life against the uncertainty of death.',"The speech continues with Hamlet contemplating the nature of existence and suffering, questioning the value of enduring life's hardships versus seeking the unknown of death.",'The "to be or not to be" speech is a soliloquy from William Shakespeare\'s play "Hamlet," Act 3, Scene 1, where Hamlet contemplates the nature of existence and the idea of suicide.','The "to be or not to be" speech is from Hamlet, Act 3, Scene 1, and begins with these lines: "To be, or not to be, that is the question..." It continues with Hamlet contemplating the nature of existence and mortality, but for the full text, you would need to refer to the play itself.','The "To be, or not to be" soliloquy from Shakespeare\'s "Hamlet" is a meditation on the nature of existence and the appeal of death as an escape from life\'s hardships.','The "To be or not to be" soliloquy from Shakespeare\'s "Hamlet" explores themes of existence, suffering, and the nature of life and death.','The "To be, or not to be" speech is a soliloquy from William Shakespeare\'s play "Hamlet," Act 3, Scene 1, where Hamlet contemplates the nature of existence and the idea of suicide.','The "To be, or not to be" speech is a soliloquy from Act 3, Scene 1 of Shakespeare\'s "Hamlet," where Hamlet contemplates the nature of existence and whether it\'s better to live or die.','The "to be or not to be" speech is a soliloquy from William Shakespeare\'s play "Hamlet," Act 3, Scene 1, where Hamlet contemplates the nature of existence and the appeal of suicide in the face of life\'s hardships.','The "To be, or not to be" soliloquy is from William Shakespeare\'s play "Hamlet," Act 3, Scene 1, and is too lengthy to include in full here.','The "To be, or not to be" soliloquy from Hamlet continues with Hamlet contemplating the nature of existence, the pain and unfairness of life, the fear of the unknown after death, and the moral implications of enduring suffering versus taking action.',"The rest of Hamlet's \"To be or not to be\" soliloquy from Act 3, Scene 1 of Shakespeare's play explores themes of life, death, and existential contemplation.",'The "To be or not to be" speech is a soliloquy from William Shakespeare\'s play "Hamlet," Act 3, Scene 1, which contemplates the nature of existence and the question of whether to endure life\'s hardships or to seek escape through death.','"To be, or not to be, that is the question: Whether \'tis nobler in the mind to suffer The slings and arrows of outrageous fortune, Or to take arms against a sea of troubles And by opposing end them."','The "To be, or not to be" speech is a soliloquy from William Shakespeare\'s "Hamlet," Act 3, Scene 1, where Hamlet contemplates the nature of existence and the idea of suicide.'],"Write me a haiku about snow":["Silent flakes descend,  \nBlanketing the world in white\u2014  \nWinter's hush revealed.","Silent flakes descend,  \nBlanketing the world in white,  \nWinter's breath whispers.","Silent flakes descend,  \nBlanketing the earth in white,  \nWinter's quiet hush.","Silent flakes descend,  \nBlanketing the world in white,  \nWinter's hush revealed.","Silent flakes descend,  \nBlanketing the world in white,  \nWinter's quiet breath.","Gentle snowflakes fall,  \nblanketing the silent earth,  \nwinter's quiet hush.","Silent flakes descend,  \nBlanket earth in purest white\u2014  \nWinter whispers hush.","Silent flakes descend,  \nBlanket earth in purest white,  \nWinter whispers peace.","Silent flakes descend,  \nBlanketing the earth in white,  \nWinter's breath surrounds.","Whispers of white fall,  \nBlanket earth in quiet grace,  \nWinter's softest touch.","Soft whispers descend,  \nBlanket of white hushes earth\u2014  \nWinter's quiet breath.","Gentle flakes descend,  \nblanketing the silent earth\u2014  \nwinter's quiet breath.","Silent flakes descend,  \nBlanket of white pure and soft,  \nWinter's gentle hush.","Silent flakes descend,  \nBlanketing the world in white,  \nWinter's hush revealed.","Silent snowflakes fall,  \nBlanket of white on the earth,  \nWhispers of winter.","Silent snowflakes fall,  \nBlanketing the world in white,  \nWinter's hush descends.","Silent snowflakes fall,  \nBlanketing the world in white,  \nWinter's soft embrace.","Silent flakes descend,  \nBlanket earth in purest white,  \nWhispers of winter.","Silent flakes descend,  \nBlanketing the world in white,  \nWinter's quiet song.","Silent flakes descend,  \nBlanketing the world in white\u2014  \nWinter's gentle hush.","Silent flakes descend,  \nBlanketing the earth in white,  \nWinter's gentle touch.","Silent flakes descend,  \nBlanketing the world in white,  \nWinter's soft embrace.","White flakes gently fall, silent whispers coat the earth, winter's soft embrace.","Silent flakes descend,  \nWhispers blanket the still earth,  \nWinter's quiet breath.","Silent flakes descend,  \nBlanketing the world in white,  \nWinter's soft embrace.","Silent flakes descend,  \nBlanket of white covers all,  \nWinter whispers peace.","Silent flakes descend,  \nBlanketing the world in white,  \nWinter whispers hush.","Silent snowflakes fall,  \nBlanketing the earth in white,  \nWhispers in the night.","Silent flakes descend,  \nBlanketing the world in white\u2014  \nWinter's hushed embrace.","Silent flakes descend,  \nBlanket earth in purest white,  \nWinter's soft embrace.","Silent flakes descend, / Blanket earth in purest white, / Winter\u2019s hush begins.","Silent flakes descend,  \nWhispers blanket the still earth,  \nWinter's soft embrace.","Silent flakes descend,  \nBlanket earth in purest white,  \nWhispers of winter.","Silent flakes descend,  \nBlanketing the world in white,  \nWinter's quiet breath.","Silent flakes descend,  \nBlanketing the world in white,  \nWinter's quiet touch.","Silent snowflakes fall,  \nBlanketing the world in white,  \nWhispers of winter.","Silent snowflakes fall,  \nBlanket earth in pure whisper,  \nWinter's gentle hush.","Silent snowflakes fall,  \nBlanket earth in pure white peace,  \nWinter whispers hush.","Silent flakes descend,  \nBlanketing the earth in white,  \nWinter's hush unfolds.","Silent winter fall,  \nBlanket of white on the ground,  \nWhispers of the cold.","Silent flakes descend,  \nBlanketing the earth in white,  \nWinter's quiet breath.","Silent flakes descend,  \nBlanketing the world in white,  \nWinter's quiet breath.","Silent flakes descend,  \nBlanketing the world in white,  \nWinter's quiet breath.","Silent flakes descend,  \nBlanketing the earth in white\u2014  \nWinter's hush revealed.","Silent flakes descend,  \nBlanket earth in purest white,  \nWhispers of winter.","Silent flakes descend,  \nBlanketing the world in white,  \nWinter's hush revealed.","Silent snowflakes fall,  \nBlanketing the earth in white,  \nWinter's quiet breath.","Silent flakes descend,  \nBlanket earth in purest white,  \nWinter whispers peace.","Silent snowflakes fall,  \nBlanket earth in purest white,  \nWinter's hush descends.","Silent flakes descend,  \nBlanketing the earth in white,  \nWinter's quiet breath."],"What is the first line of A Tale Of Two Cities?":['The first line is: "It was the best of times, it was the worst of times, it was the age of wisdom, it was the age of foolishness..."','The first line of "A Tale of Two Cities" is "It was the best of times, it was the worst of times, it was the age of wisdom, it was the age of foolishness..."','The first line of "A Tale of Two Cities" is: "It was the best of times, it was the worst of times, it was the age of wisdom, it was the age of foolishness, it was the epoch of belief, it was the epoch of incredulity, it was the season of Light, it was the season of Darkness, it was the spring of hope, it was the winter of despair, we had everything before us, we had nothing before us, we were all going direct to Heaven, we were all going direct the other way\u2014in short, the period was so far like the present period, that some of its noisiest authorities insisted on its being received, for good or for evil, in the superlative degree of comparison only."','The first line of "A Tale of Two Cities" is "It was the best of times, it was the worst of times, it was the age of wisdom, it was the age of foolishness..."','The first line of "A Tale of Two Cities" is "It was the best of times, it was the worst of times, it was the age of wisdom, it was the age of foolishness, it was the epoch of belief, it was the epoch of incredulity, it was the season of Light, it was the season of Darkness, it was the spring of hope, it was the winter of despair, we had everything before us, we had nothing before us, we were all going direct to Heaven, we were all going direct the other way\u2014in short, the period was so far like the present period, that some of its noisiest authorities insisted on its being received, for good or for evil, in the superlative degree of comparison only."','The first line is "It was the best of times, it was the worst of times, it was the age of wisdom, it was the age of foolishness..."','The first line is: "It was the best of times, it was the worst of times, it was the age of wisdom, it was the age of foolishness..."','The first line is: "It was the best of times, it was the worst of times..."','The first line is "It was the best of times, it was the worst of times, it was the age of wisdom, it was the age of foolishness."','"It was the best of times, it was the worst of times, it was the age of wisdom, it was the age of foolishness..."','The first line of "A Tale of Two Cities" is "It was the best of times, it was the worst of times."','The first line is: "It was the best of times, it was the worst of times."','The first line of "A Tale of Two Cities" is "It was the best of times, it was the worst of times, it was the age of wisdom, it was the age of foolishness, it was the epoch of belief, it was the epoch of incredulity, it was the season of Light, it was the season of Darkness, it was the spring of hope, it was the winter of despair, we had everything before us, we had nothing before us, we were all going direct to Heaven, we were all going direct the other way\u2014in short, the period was so far like the present period, that some of its noisiest authorities insisted on its being received, for good or for evil, in the superlative degree of comparison only."','The first line is: "It was the best of times, it was the worst of times, it was the age of wisdom, it was the age of foolishness..."','The first line of "A Tale of Two Cities" is "It was the best of times, it was the worst of times, it was the age of wisdom, it was the age of foolishness, ..."','The first line is: "It was the best of times, it was the worst of times."','The first line is: "It was the best of times, it was the worst of times, it was the age of wisdom, it was the age of foolishness, it was the epoch of belief, it was the epoch of incredulity, it was the season of Light, it was the season of Darkness, it was the spring of hope, it was the winter of despair, we had everything before us, we had nothing before us, we were all going direct to Heaven, we were all going direct the other way\u2014in short, the period was so far like the present period, that some of its noisiest authorities insisted on its being received, for good or for evil, in the superlative degree of comparison only."','The first line is: "It was the best of times, it was the worst of times, it was the age of wisdom, it was the age of foolishness, it was the epoch of belief, it was the epoch of incredulity, it was the season of Light, it was the season of Darkness, it was the spring of hope, it was the winter of despair, we had everything before us, we had nothing before us, we were all going direct to Heaven, we were all going direct the other way\u2014in short, the period was so far like the present period, that some of its noisiest authorities insisted on its being received, for good or for evil, in the superlative degree of comparison only."','The first line is: "It was the best of times, it was the worst of times, it was the age of wisdom, it was the age of foolishness..."','The first line of "A Tale of Two Cities" is: "It was the best of times, it was the worst of times."','The first line is: "It was the best of times, it was the worst of times, it was the age of wisdom, it was the age of foolishness..."','"It was the best of times, it was the worst of times, it was the age of wisdom, it was the age of foolishness..."','The first line is "It was the best of times, it was the worst of times, it was the age of wisdom, it was the age of foolishness."','The first line of "A Tale of Two Cities" is: "It was the best of times, it was the worst of times, it was the age of wisdom, it was the age of foolishness, it was the epoch of belief, it was the epoch of incredulity, it was the season of Light, it was the season of Darkness, it was the spring of hope, it was the winter of despair, we had everything before us, we had nothing before us, we were all going direct to Heaven, we were all going direct the other way \u2013 in short, the period was so far like the present period, that some of its noisiest authorities insisted on its being received, for good or for evil, in the superlative degree of comparison only."','"It was the best of times, it was the worst of times, it was the age of wisdom, it was the age of foolishness, it was the epoch of belief, it was the epoch of incredulity, it was the season of Light, it was the season of Darkness, it was the spring of hope, it was the winter of despair, we had everything before us, we had nothing before us, we were all going direct to Heaven, we were all going direct the other way\u2014in short, the period was so far like the present period, that some of its noisiest authorities insisted on its being received, for good or for evil, in the superlative degree of comparison only."','The first line is: "It was the best of times, it was the worst of times, it was the age of wisdom, it was the age of foolishness..."','The first line is: "It was the best of times, it was the worst of times."','"It was the best of times, it was the worst of times, it was the age of wisdom, it was the age of foolishness,..."','"It was the best of times, it was the worst of times, it was the age of wisdom, it was the age of foolishness..."','"It was the best of times, it was the worst of times, it was the age of wisdom, it was the age of foolishness, it was the epoch of belief, it was the epoch of incredulity, it was the season of Light, it was the season of Darkness, it was the spring of hope, it was the winter of despair, we had everything before us, we had nothing before us, we were all going direct to Heaven, we were all going direct the other way\u2014in short, the period was so far like the present period, that some of its noisiest authorities insisted on its being received, for good or for evil, in the superlative degree of comparison only."','The first line is "It was the best of times, it was the worst of times, it was the age of wisdom, it was the age of foolishness..."','The first line is: "It was the best of times, it was the worst of times, it was the age of wisdom, it was the age of foolishness..."','The first line is "It was the best of times, it was the worst of times, it was the age of wisdom, it was the age of foolishness, it was the epoch of belief, it was the epoch of incredulity, it was the season of Light, it was the season of Darkness, it was the spring of hope, it was the winter of despair, we had everything before us, we had nothing before us, we were all going direct to Heaven, we were all going direct the other way \u2013 in short, the period was so far like the present period, that some of its noisiest authorities insisted on its being received, for good or for evil, in the superlative degree of comparison only."','The first line is: "It was the best of times, it was the worst of times, it was the age of wisdom, it was the age of foolishness, it was the epoch of belief, it was the epoch of incredulity, it was the season of Light, it was the season of Darkness, it was the spring of hope, it was the winter of despair, we had everything before us, we had nothing before us, we were all going direct to Heaven, we were all going direct the other way\u2014in short, the period was so far like the present period, that some of its noisiest authorities insisted on its being received, for good or for evil, in the superlative degree of comparison only."','The first line is: "It was the best of times, it was the worst of times, it was the age of wisdom, it was the age of foolishness, it was the epoch of belief, it was the epoch of incredulity, it was the season of Light, it was the season of Darkness, it was the spring of hope, it was the winter of despair, we had everything before us, we had nothing before us, we were all going direct to Heaven, we were all going direct the other way \u2013 in short, the period was so far like the present period, that some of its noisiest authorities insisted on its being received, for good or for evil, in the superlative degree of comparison only."','The first line of "A Tale of Two Cities" is: "It was the best of times, it was the worst of times."','The first line is "It was the best of times, it was the worst of times, it was the age of wisdom, it was the age of foolishness..."','The first line is: "It was the best of times, it was the worst of times, it was the age of wisdom, it was the age of foolishness..."','The first line is "It was the best of times, it was the worst of times, it was the age of wisdom, it was the age of foolishness..."','The first line is: "It was the best of times, it was the worst of times."','The first line of "A Tale of Two Cities" is: "It was the best of times, it was the worst of times, it was the age of wisdom, it was the age of foolishness, it was the epoch of belief, it was the epoch of incredulity, it was the season of Light, it was the season of Darkness, it was the spring of hope, it was the winter of despair, we had everything before us, we had nothing before us, we were all going direct to Heaven, we were all going direct the other way \u2013 in short, the period was so far like the present period, that some of its noisiest authorities insisted on its being received, for good or for evil, in the superlative degree of comparison only."','The first line of "A Tale of Two Cities" is "It was the best of times, it was the worst of times, it was the age of wisdom, it was the age of foolishness, it was the epoch of belief, it was the epoch of incredulity, it was the season of Light, it was the season of Darkness, it was the spring of hope, it was the winter of despair, we had everything before us, we had nothing before us, we were all going direct to Heaven, we were all going direct the other way\u2014in short, the period was so far like the present period, that some of its noisiest authorities insisted on its being received, for good or for evil, in the superlative degree of comparison only."','The first line of "A Tale of Two Cities" is: "It was the best of times, it was the worst of times, it was the age of wisdom, it was the age of foolishness..."','The first line of "A Tale of Two Cities" is: "It was the best of times, it was the worst of times, it was the age of wisdom, it was the age of foolishness..."','The first line is: "It was the best of times, it was the worst of times, it was the age of wisdom, it was the age of foolishness, it was the epoch of belief, it was the epoch of incredulity, it was the season of Light, it was the season of Darkness, it was the spring of hope, it was the winter of despair, we had everything before us, we had nothing before us, we were all going direct to Heaven, we were all going direct the other way\u2014in short, the period was so far like the present period, that some of its noisiest authorities insisted on its being received, for good or for evil, in the superlative degree of comparison only."','The first line is: "It was the best of times, it was the worst of times,"','The first line of "A Tale of Two Cities" is "It was the best of times, it was the worst of times, it was the age of wisdom, it was the age of foolishness, it was the epoch of belief, it was the epoch of incredulity, it was the season of Light, it was the season of Darkness, it was the spring of hope, it was the winter of despair, we had everything before us, we had nothing before us, we were all going direct to Heaven, we were all going direct the other way \u2013 in short, the period was so far like the present period, that some of its noisiest authorities insisted on its being received, for good or for evil, in the superlative degree of comparison only."','The first line is: "It was the best of times, it was the worst of times..."','The first line is: "It was the best of times, it was the worst of times, it was the age of wisdom, it was the age of foolishness, it was the epoch of belief, it was the epoch of incredulity, it was the season of Light, it was the season of Darkness, it was the spring of hope, it was the winter of despair, we had everything before us, we had nothing before us, we were all going direct to Heaven, we were all going direct the other way \u2013 in short, the period was so far like the present period, that some of its noisiest authorities insisted on its being received, for good or for evil, in the superlative degree of comparison only."','"It was the best of times, it was the worst of times, it was the age of wisdom, it was the age of foolishness..."']};function co(e,t){let n;if(void 0===t)for(const r of e)null!=r&&(n<r||void 0===n&&r>=r)&&(n=r);else{let r=-1;for(let o of e)null!=(o=t(o,++r,e))&&(n<o||void 0===n&&o>=o)&&(n=o)}return n}function uo(e,t){let n;if(void 0===t)for(const r of e)null!=r&&(n>r||void 0===n&&r>=r)&&(n=r);else{let r=-1;for(let o of e)null!=(o=t(o,++r,e))&&(n>o||void 0===n&&o>=o)&&(n=o)}return n}const po=(ho=Math.random,function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.length)-(t=+t);for(;n;){const r=ho()*n--|0,o=e[n+t];e[n+t]=e[r+t],e[r+t]=o}return e});var ho;function fo(){}function mo(e){return null==e?fo:function(){return this.querySelector(e)}}function go(){return[]}function _o(e){return null==e?go:function(){return this.querySelectorAll(e)}}function vo(e){return function(){return function(e){return null==e?[]:Array.isArray(e)?e:Array.from(e)}(e.apply(this,arguments))}}function yo(e){return function(){return this.matches(e)}}function wo(e){return function(t){return t.matches(e)}}var bo=Array.prototype.find;function xo(){return this.firstElementChild}var ko=Array.prototype.filter;function Co(){return Array.from(this.children)}function Do(e){return new Array(e.length)}function So(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}function Eo(e,t,n,r,o,a){for(var i,s=0,l=t.length,c=a.length;s<c;++s)(i=t[s])?(i.__data__=a[s],r[s]=i):n[s]=new So(e,a[s]);for(;s<l;++s)(i=t[s])&&(o[s]=i)}function To(e,t,n,r,o,a,i){var s,l,c,u=new Map,d=t.length,p=a.length,h=new Array(d);for(s=0;s<d;++s)(l=t[s])&&(h[s]=c=i.call(l,l.__data__,s,t)+"",u.has(c)?o[s]=l:u.set(c,l));for(s=0;s<p;++s)c=i.call(e,a[s],s,a)+"",(l=u.get(c))?(r[s]=l,l.__data__=a[s],u.delete(c)):n[s]=new So(e,a[s]);for(s=0;s<d;++s)(l=t[s])&&u.get(h[s])===l&&(o[s]=l)}function Ao(e){return e.__data__}function Mo(e){return"object"===typeof e&&"length"in e?e:Array.from(e)}function Fo(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}So.prototype={constructor:So,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};var Io="http://www.w3.org/1999/xhtml";const Po={svg:"http://www.w3.org/2000/svg",xhtml:Io,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function zo(e){var t=e+="",n=t.indexOf(":");return n>=0&&"xmlns"!==(t=e.slice(0,n))&&(e=e.slice(n+1)),Po.hasOwnProperty(t)?{space:Po[t],local:e}:e}function Oo(e){return function(){this.removeAttribute(e)}}function No(e){return function(){this.removeAttributeNS(e.space,e.local)}}function Bo(e,t){return function(){this.setAttribute(e,t)}}function jo(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function Lo(e,t){return function(){var n=t.apply(this,arguments);null==n?this.removeAttribute(e):this.setAttribute(e,n)}}function Ro(e,t){return function(){var n=t.apply(this,arguments);null==n?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function Vo(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function qo(e){return function(){this.style.removeProperty(e)}}function Uo(e,t,n){return function(){this.style.setProperty(e,t,n)}}function Wo(e,t,n){return function(){var r=t.apply(this,arguments);null==r?this.style.removeProperty(e):this.style.setProperty(e,r,n)}}function Go(e,t){return e.style.getPropertyValue(t)||Vo(e).getComputedStyle(e,null).getPropertyValue(t)}function Ho(e){return function(){delete this[e]}}function Ko(e,t){return function(){this[e]=t}}function Zo(e,t){return function(){var n=t.apply(this,arguments);null==n?delete this[e]:this[e]=n}}function $o(e){return e.trim().split(/^|\s+/)}function Xo(e){return e.classList||new Jo(e)}function Jo(e){this._node=e,this._names=$o(e.getAttribute("class")||"")}function Qo(e,t){for(var n=Xo(e),r=-1,o=t.length;++r<o;)n.add(t[r])}function Yo(e,t){for(var n=Xo(e),r=-1,o=t.length;++r<o;)n.remove(t[r])}function ea(e){return function(){Qo(this,e)}}function ta(e){return function(){Yo(this,e)}}function na(e,t){return function(){(t.apply(this,arguments)?Qo:Yo)(this,e)}}function ra(){this.textContent=""}function oa(e){return function(){this.textContent=e}}function aa(e){return function(){var t=e.apply(this,arguments);this.textContent=null==t?"":t}}function ia(){this.innerHTML=""}function sa(e){return function(){this.innerHTML=e}}function la(e){return function(){var t=e.apply(this,arguments);this.innerHTML=null==t?"":t}}function ca(){this.nextSibling&&this.parentNode.appendChild(this)}function ua(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function da(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===Io&&t.documentElement.namespaceURI===Io?t.createElement(e):t.createElementNS(n,e)}}function pa(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function ha(e){var t=zo(e);return(t.local?pa:da)(t)}function fa(){return null}function ma(){var e=this.parentNode;e&&e.removeChild(this)}function ga(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function _a(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function va(e){return function(){var t=this.__on;if(t){for(var n,r=0,o=-1,a=t.length;r<a;++r)n=t[r],e.type&&n.type!==e.type||n.name!==e.name?t[++o]=n:this.removeEventListener(n.type,n.listener,n.options);++o?t.length=o:delete this.__on}}}function ya(e,t,n){return function(){var r,o=this.__on,a=function(e){return function(t){e.call(this,t,this.__data__)}}(t);if(o)for(var i=0,s=o.length;i<s;++i)if((r=o[i]).type===e.type&&r.name===e.name)return this.removeEventListener(r.type,r.listener,r.options),this.addEventListener(r.type,r.listener=a,r.options=n),void(r.value=t);this.addEventListener(e.type,a,n),r={type:e.type,name:e.name,value:t,listener:a,options:n},o?o.push(r):this.__on=[r]}}function wa(e,t,n){var r=Vo(e),o=r.CustomEvent;"function"===typeof o?o=new o(t,n):(o=r.document.createEvent("Event"),n?(o.initEvent(t,n.bubbles,n.cancelable),o.detail=n.detail):o.initEvent(t,!1,!1)),e.dispatchEvent(o)}function ba(e,t){return function(){return wa(this,e,t)}}function xa(e,t){return function(){return wa(this,e,t.apply(this,arguments))}}Jo.prototype={add:function(e){this._names.indexOf(e)<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};var ka=[null];function Ca(e,t){this._groups=e,this._parents=t}function Da(){return new Ca([[document.documentElement]],ka)}Ca.prototype=Da.prototype={constructor:Ca,select:function(e){"function"!==typeof e&&(e=mo(e));for(var t=this._groups,n=t.length,r=new Array(n),o=0;o<n;++o)for(var a,i,s=t[o],l=s.length,c=r[o]=new Array(l),u=0;u<l;++u)(a=s[u])&&(i=e.call(a,a.__data__,u,s))&&("__data__"in a&&(i.__data__=a.__data__),c[u]=i);return new Ca(r,this._parents)},selectAll:function(e){e="function"===typeof e?vo(e):_o(e);for(var t=this._groups,n=t.length,r=[],o=[],a=0;a<n;++a)for(var i,s=t[a],l=s.length,c=0;c<l;++c)(i=s[c])&&(r.push(e.call(i,i.__data__,c,s)),o.push(i));return new Ca(r,o)},selectChild:function(e){return this.select(null==e?xo:function(e){return function(){return bo.call(this.children,e)}}("function"===typeof e?e:wo(e)))},selectChildren:function(e){return this.selectAll(null==e?Co:function(e){return function(){return ko.call(this.children,e)}}("function"===typeof e?e:wo(e)))},filter:function(e){"function"!==typeof e&&(e=yo(e));for(var t=this._groups,n=t.length,r=new Array(n),o=0;o<n;++o)for(var a,i=t[o],s=i.length,l=r[o]=[],c=0;c<s;++c)(a=i[c])&&e.call(a,a.__data__,c,i)&&l.push(a);return new Ca(r,this._parents)},data:function(e,t){if(!arguments.length)return Array.from(this,Ao);var n=t?To:Eo,r=this._parents,o=this._groups;"function"!==typeof e&&(e=function(e){return function(){return e}}(e));for(var a=o.length,i=new Array(a),s=new Array(a),l=new Array(a),c=0;c<a;++c){var u=r[c],d=o[c],p=d.length,h=Mo(e.call(u,u&&u.__data__,c,r)),f=h.length,m=s[c]=new Array(f),g=i[c]=new Array(f);n(u,d,m,g,l[c]=new Array(p),h,t);for(var _,v,y=0,w=0;y<f;++y)if(_=m[y]){for(y>=w&&(w=y+1);!(v=g[w])&&++w<f;);_._next=v||null}}return(i=new Ca(i,r))._enter=s,i._exit=l,i},enter:function(){return new Ca(this._enter||this._groups.map(Do),this._parents)},exit:function(){return new Ca(this._exit||this._groups.map(Do),this._parents)},join:function(e,t,n){var r=this.enter(),o=this,a=this.exit();return"function"===typeof e?(r=e(r))&&(r=r.selection()):r=r.append(e+""),null!=t&&(o=t(o))&&(o=o.selection()),null==n?a.remove():n(a),r&&o?r.merge(o).order():o},merge:function(e){for(var t=e.selection?e.selection():e,n=this._groups,r=t._groups,o=n.length,a=r.length,i=Math.min(o,a),s=new Array(o),l=0;l<i;++l)for(var c,u=n[l],d=r[l],p=u.length,h=s[l]=new Array(p),f=0;f<p;++f)(c=u[f]||d[f])&&(h[f]=c);for(;l<o;++l)s[l]=n[l];return new Ca(s,this._parents)},selection:function(){return this},order:function(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var r,o=e[t],a=o.length-1,i=o[a];--a>=0;)(r=o[a])&&(i&&4^r.compareDocumentPosition(i)&&i.parentNode.insertBefore(r,i),i=r);return this},sort:function(e){function t(t,n){return t&&n?e(t.__data__,n.__data__):!t-!n}e||(e=Fo);for(var n=this._groups,r=n.length,o=new Array(r),a=0;a<r;++a){for(var i,s=n[a],l=s.length,c=o[a]=new Array(l),u=0;u<l;++u)(i=s[u])&&(c[u]=i);c.sort(t)}return new Ca(o,this._parents).order()},call:function(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this},nodes:function(){return Array.from(this)},node:function(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],o=0,a=r.length;o<a;++o){var i=r[o];if(i)return i}return null},size:function(){let e=0;for(const t of this)++e;return e},empty:function(){return!this.node()},each:function(e){for(var t=this._groups,n=0,r=t.length;n<r;++n)for(var o,a=t[n],i=0,s=a.length;i<s;++i)(o=a[i])&&e.call(o,o.__data__,i,a);return this},attr:function(e,t){var n=zo(e);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((null==t?n.local?No:Oo:"function"===typeof t?n.local?Ro:Lo:n.local?jo:Bo)(n,t))},style:function(e,t,n){return arguments.length>1?this.each((null==t?qo:"function"===typeof t?Wo:Uo)(e,t,null==n?"":n)):Go(this.node(),e)},property:function(e,t){return arguments.length>1?this.each((null==t?Ho:"function"===typeof t?Zo:Ko)(e,t)):this.node()[e]},classed:function(e,t){var n=$o(e+"");if(arguments.length<2){for(var r=Xo(this.node()),o=-1,a=n.length;++o<a;)if(!r.contains(n[o]))return!1;return!0}return this.each(("function"===typeof t?na:t?ea:ta)(n,t))},text:function(e){return arguments.length?this.each(null==e?ra:("function"===typeof e?aa:oa)(e)):this.node().textContent},html:function(e){return arguments.length?this.each(null==e?ia:("function"===typeof e?la:sa)(e)):this.node().innerHTML},raise:function(){return this.each(ca)},lower:function(){return this.each(ua)},append:function(e){var t="function"===typeof e?e:ha(e);return this.select((function(){return this.appendChild(t.apply(this,arguments))}))},insert:function(e,t){var n="function"===typeof e?e:ha(e),r=null==t?fa:"function"===typeof t?t:mo(t);return this.select((function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)}))},remove:function(){return this.each(ma)},clone:function(e){return this.select(e?_a:ga)},datum:function(e){return arguments.length?this.property("__data__",e):this.node().__data__},on:function(e,t,n){var r,o,a=function(e){return e.trim().split(/^|\s+/).map((function(e){var t="",n=e.indexOf(".");return n>=0&&(t=e.slice(n+1),e=e.slice(0,n)),{type:e,name:t}}))}(e+""),i=a.length;if(!(arguments.length<2)){for(s=t?ya:va,r=0;r<i;++r)this.each(s(a[r],t,n));return this}var s=this.node().__on;if(s)for(var l,c=0,u=s.length;c<u;++c)for(r=0,l=s[c];r<i;++r)if((o=a[r]).type===l.type&&o.name===l.name)return l.value},dispatch:function(e,t){return this.each(("function"===typeof t?xa:ba)(e,t))},[Symbol.iterator]:function*(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r,o=e[t],a=0,i=o.length;a<i;++a)(r=o[a])&&(yield r)}};const Sa=Da;var Ea={value:()=>{}};function Ta(){for(var e,t=0,n=arguments.length,r={};t<n;++t){if(!(e=arguments[t]+"")||e in r||/[\s.]/.test(e))throw new Error("illegal type: "+e);r[e]=[]}return new Aa(r)}function Aa(e){this._=e}function Ma(e,t){for(var n,r=0,o=e.length;r<o;++r)if((n=e[r]).name===t)return n.value}function Fa(e,t,n){for(var r=0,o=e.length;r<o;++r)if(e[r].name===t){e[r]=Ea,e=e.slice(0,r).concat(e.slice(r+1));break}return null!=n&&e.push({name:t,value:n}),e}Aa.prototype=Ta.prototype={constructor:Aa,on:function(e,t){var n,r,o=this._,a=(r=o,(e+"").trim().split(/^|\s+/).map((function(e){var t="",n=e.indexOf(".");if(n>=0&&(t=e.slice(n+1),e=e.slice(0,n)),e&&!r.hasOwnProperty(e))throw new Error("unknown type: "+e);return{type:e,name:t}}))),i=-1,s=a.length;if(!(arguments.length<2)){if(null!=t&&"function"!==typeof t)throw new Error("invalid callback: "+t);for(;++i<s;)if(n=(e=a[i]).type)o[n]=Fa(o[n],e.name,t);else if(null==t)for(n in o)o[n]=Fa(o[n],e.name,null);return this}for(;++i<s;)if((n=(e=a[i]).type)&&(n=Ma(o[n],e.name)))return n},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new Aa(e)},call:function(e,t){if((n=arguments.length-2)>0)for(var n,r,o=new Array(n),a=0;a<n;++a)o[a]=arguments[a+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(a=0,n=(r=this._[e]).length;a<n;++a)r[a].value.apply(t,o)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],o=0,a=r.length;o<a;++o)r[o].value.apply(t,n)}};const Ia=Ta;var Pa,za,Oa=0,Na=0,Ba=0,ja=0,La=0,Ra=0,Va="object"===typeof performance&&performance.now?performance:Date,qa="object"===typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function Ua(){return La||(qa(Wa),La=Va.now()+Ra)}function Wa(){La=0}function Ga(){this._call=this._time=this._next=null}function Ha(e,t,n){var r=new Ga;return r.restart(e,t,n),r}function Ka(){La=(ja=Va.now())+Ra,Oa=Na=0;try{!function(){Ua(),++Oa;for(var e,t=Pa;t;)(e=La-t._time)>=0&&t._call.call(void 0,e),t=t._next;--Oa}()}finally{Oa=0,function(){var e,t,n=Pa,r=1/0;for(;n;)n._call?(r>n._time&&(r=n._time),e=n,n=n._next):(t=n._next,n._next=null,n=e?e._next=t:Pa=t);za=e,$a(r)}(),La=0}}function Za(){var e=Va.now(),t=e-ja;t>1e3&&(Ra-=t,ja=e)}function $a(e){Oa||(Na&&(Na=clearTimeout(Na)),e-La>24?(e<1/0&&(Na=setTimeout(Ka,e-Va.now()-Ra)),Ba&&(Ba=clearInterval(Ba))):(Ba||(ja=Va.now(),Ba=setInterval(Za,1e3)),Oa=1,qa(Ka)))}function Xa(e,t,n){var r=new Ga;return t=null==t?0:+t,r.restart((n=>{r.stop(),e(n+t)}),t,n),r}Ga.prototype=Ha.prototype={constructor:Ga,restart:function(e,t,n){if("function"!==typeof e)throw new TypeError("callback is not a function");n=(null==n?Ua():+n)+(null==t?0:+t),this._next||za===this||(za?za._next=this:Pa=this,za=this),this._call=e,this._time=n,$a()},stop:function(){this._call&&(this._call=null,this._time=1/0,$a())}};var Ja=Ia("start","end","cancel","interrupt"),Qa=[];function Ya(e,t,n,r,o,a){var i=e.__transition;if(i){if(n in i)return}else e.__transition={};!function(e,t,n){var r,o=e.__transition;function a(e){n.state=1,n.timer.restart(i,n.delay,n.time),n.delay<=e&&i(e-n.delay)}function i(a){var c,u,d,p;if(1!==n.state)return l();for(c in o)if((p=o[c]).name===n.name){if(3===p.state)return Xa(i);4===p.state?(p.state=6,p.timer.stop(),p.on.call("interrupt",e,e.__data__,p.index,p.group),delete o[c]):+c<t&&(p.state=6,p.timer.stop(),p.on.call("cancel",e,e.__data__,p.index,p.group),delete o[c])}if(Xa((function(){3===n.state&&(n.state=4,n.timer.restart(s,n.delay,n.time),s(a))})),n.state=2,n.on.call("start",e,e.__data__,n.index,n.group),2===n.state){for(n.state=3,r=new Array(d=n.tween.length),c=0,u=-1;c<d;++c)(p=n.tween[c].value.call(e,e.__data__,n.index,n.group))&&(r[++u]=p);r.length=u+1}}function s(t){for(var o=t<n.duration?n.ease.call(null,t/n.duration):(n.timer.restart(l),n.state=5,1),a=-1,i=r.length;++a<i;)r[a].call(e,o);5===n.state&&(n.on.call("end",e,e.__data__,n.index,n.group),l())}function l(){for(var r in n.state=6,n.timer.stop(),delete o[t],o)return;delete e.__transition}o[t]=n,n.timer=Ha(a,0,n.time)}(e,n,{name:t,index:r,group:o,on:Ja,tween:Qa,time:a.time,delay:a.delay,duration:a.duration,ease:a.ease,timer:null,state:0})}function ei(e,t){var n=ni(e,t);if(n.state>0)throw new Error("too late; already scheduled");return n}function ti(e,t){var n=ni(e,t);if(n.state>3)throw new Error("too late; already running");return n}function ni(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function ri(e,t){var n,r,o,a=e.__transition,i=!0;if(a){for(o in t=null==t?null:t+"",a)(n=a[o]).name===t?(r=n.state>2&&n.state<5,n.state=6,n.timer.stop(),n.on.call(r?"interrupt":"cancel",e,e.__data__,n.index,n.group),delete a[o]):i=!1;i&&delete e.__transition}}function oi(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}var ai,ii=180/Math.PI,si={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function li(e,t,n,r,o,a){var i,s,l;return(i=Math.sqrt(e*e+t*t))&&(e/=i,t/=i),(l=e*n+t*r)&&(n-=e*l,r-=t*l),(s=Math.sqrt(n*n+r*r))&&(n/=s,r/=s,l/=s),e*r<t*n&&(e=-e,t=-t,l=-l,i=-i),{translateX:o,translateY:a,rotate:Math.atan2(t,e)*ii,skewX:Math.atan(l)*ii,scaleX:i,scaleY:s}}function ci(e,t,n,r){function o(e){return e.length?e.pop()+" ":""}return function(a,i){var s=[],l=[];return a=e(a),i=e(i),function(e,r,o,a,i,s){if(e!==o||r!==a){var l=i.push("translate(",null,t,null,n);s.push({i:l-4,x:oi(e,o)},{i:l-2,x:oi(r,a)})}else(o||a)&&i.push("translate("+o+t+a+n)}(a.translateX,a.translateY,i.translateX,i.translateY,s,l),function(e,t,n,a){e!==t?(e-t>180?t+=360:t-e>180&&(e+=360),a.push({i:n.push(o(n)+"rotate(",null,r)-2,x:oi(e,t)})):t&&n.push(o(n)+"rotate("+t+r)}(a.rotate,i.rotate,s,l),function(e,t,n,a){e!==t?a.push({i:n.push(o(n)+"skewX(",null,r)-2,x:oi(e,t)}):t&&n.push(o(n)+"skewX("+t+r)}(a.skewX,i.skewX,s,l),function(e,t,n,r,a,i){if(e!==n||t!==r){var s=a.push(o(a)+"scale(",null,",",null,")");i.push({i:s-4,x:oi(e,n)},{i:s-2,x:oi(t,r)})}else 1===n&&1===r||a.push(o(a)+"scale("+n+","+r+")")}(a.scaleX,a.scaleY,i.scaleX,i.scaleY,s,l),a=i=null,function(e){for(var t,n=-1,r=l.length;++n<r;)s[(t=l[n]).i]=t.x(e);return s.join("")}}}var ui=ci((function(e){const t=new("function"===typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?si:li(t.a,t.b,t.c,t.d,t.e,t.f)}),"px, ","px)","deg)"),di=ci((function(e){return null==e?si:(ai||(ai=document.createElementNS("http://www.w3.org/2000/svg","g")),ai.setAttribute("transform",e),(e=ai.transform.baseVal.consolidate())?li((e=e.matrix).a,e.b,e.c,e.d,e.e,e.f):si)}),", ",")",")");function pi(e,t){var n,r;return function(){var o=ti(this,e),a=o.tween;if(a!==n)for(var i=0,s=(r=n=a).length;i<s;++i)if(r[i].name===t){(r=r.slice()).splice(i,1);break}o.tween=r}}function hi(e,t,n){var r,o;if("function"!==typeof n)throw new Error;return function(){var a=ti(this,e),i=a.tween;if(i!==r){o=(r=i).slice();for(var s={name:t,value:n},l=0,c=o.length;l<c;++l)if(o[l].name===t){o[l]=s;break}l===c&&o.push(s)}a.tween=o}}function fi(e,t,n){var r=e._id;return e.each((function(){var e=ti(this,r);(e.value||(e.value={}))[t]=n.apply(this,arguments)})),function(e){return ni(e,r).value[t]}}function mi(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function gi(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function _i(){}var vi=.7,yi=1/vi,wi="\\s*([+-]?\\d+)\\s*",bi="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",xi="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",ki=/^#([0-9a-f]{3,8})$/,Ci=new RegExp("^rgb\\(".concat(wi,",").concat(wi,",").concat(wi,"\\)$")),Di=new RegExp("^rgb\\(".concat(xi,",").concat(xi,",").concat(xi,"\\)$")),Si=new RegExp("^rgba\\(".concat(wi,",").concat(wi,",").concat(wi,",").concat(bi,"\\)$")),Ei=new RegExp("^rgba\\(".concat(xi,",").concat(xi,",").concat(xi,",").concat(bi,"\\)$")),Ti=new RegExp("^hsl\\(".concat(bi,",").concat(xi,",").concat(xi,"\\)$")),Ai=new RegExp("^hsla\\(".concat(bi,",").concat(xi,",").concat(xi,",").concat(bi,"\\)$")),Mi={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function Fi(){return this.rgb().formatHex()}function Ii(){return this.rgb().formatRgb()}function Pi(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=ki.exec(e))?(n=t[1].length,t=parseInt(t[1],16),6===n?zi(t):3===n?new Bi(t>>8&15|t>>4&240,t>>4&15|240&t,(15&t)<<4|15&t,1):8===n?Oi(t>>24&255,t>>16&255,t>>8&255,(255&t)/255):4===n?Oi(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|240&t,((15&t)<<4|15&t)/255):null):(t=Ci.exec(e))?new Bi(t[1],t[2],t[3],1):(t=Di.exec(e))?new Bi(255*t[1]/100,255*t[2]/100,255*t[3]/100,1):(t=Si.exec(e))?Oi(t[1],t[2],t[3],t[4]):(t=Ei.exec(e))?Oi(255*t[1]/100,255*t[2]/100,255*t[3]/100,t[4]):(t=Ti.exec(e))?Ui(t[1],t[2]/100,t[3]/100,1):(t=Ai.exec(e))?Ui(t[1],t[2]/100,t[3]/100,t[4]):Mi.hasOwnProperty(e)?zi(Mi[e]):"transparent"===e?new Bi(NaN,NaN,NaN,0):null}function zi(e){return new Bi(e>>16&255,e>>8&255,255&e,1)}function Oi(e,t,n,r){return r<=0&&(e=t=n=NaN),new Bi(e,t,n,r)}function Ni(e,t,n,r){return 1===arguments.length?((o=e)instanceof _i||(o=Pi(o)),o?new Bi((o=o.rgb()).r,o.g,o.b,o.opacity):new Bi):new Bi(e,t,n,null==r?1:r);var o}function Bi(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}function ji(){return"#".concat(qi(this.r)).concat(qi(this.g)).concat(qi(this.b))}function Li(){const e=Ri(this.opacity);return"".concat(1===e?"rgb(":"rgba(").concat(Vi(this.r),", ").concat(Vi(this.g),", ").concat(Vi(this.b)).concat(1===e?")":", ".concat(e,")"))}function Ri(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Vi(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function qi(e){return((e=Vi(e))<16?"0":"")+e.toString(16)}function Ui(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new Gi(e,t,n,r)}function Wi(e){if(e instanceof Gi)return new Gi(e.h,e.s,e.l,e.opacity);if(e instanceof _i||(e=Pi(e)),!e)return new Gi;if(e instanceof Gi)return e;var t=(e=e.rgb()).r/255,n=e.g/255,r=e.b/255,o=Math.min(t,n,r),a=Math.max(t,n,r),i=NaN,s=a-o,l=(a+o)/2;return s?(i=t===a?(n-r)/s+6*(n<r):n===a?(r-t)/s+2:(t-n)/s+4,s/=l<.5?a+o:2-a-o,i*=60):s=l>0&&l<1?0:i,new Gi(i,s,l,e.opacity)}function Gi(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}function Hi(e){return(e=(e||0)%360)<0?e+360:e}function Ki(e){return Math.max(0,Math.min(1,e||0))}function Zi(e,t,n){return 255*(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)}function $i(e,t,n,r,o){var a=e*e,i=a*e;return((1-3*e+3*a-i)*t+(4-6*a+3*i)*n+(1+3*e+3*a-3*i)*r+i*o)/6}mi(_i,Pi,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:Fi,formatHex:Fi,formatHex8:function(){return this.rgb().formatHex8()},formatHsl:function(){return Wi(this).formatHsl()},formatRgb:Ii,toString:Ii}),mi(Bi,Ni,gi(_i,{brighter(e){return e=null==e?yi:Math.pow(yi,e),new Bi(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=null==e?vi:Math.pow(vi,e),new Bi(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Bi(Vi(this.r),Vi(this.g),Vi(this.b),Ri(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:ji,formatHex:ji,formatHex8:function(){return"#".concat(qi(this.r)).concat(qi(this.g)).concat(qi(this.b)).concat(qi(255*(isNaN(this.opacity)?1:this.opacity)))},formatRgb:Li,toString:Li})),mi(Gi,(function(e,t,n,r){return 1===arguments.length?Wi(e):new Gi(e,t,n,null==r?1:r)}),gi(_i,{brighter(e){return e=null==e?yi:Math.pow(yi,e),new Gi(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=null==e?vi:Math.pow(vi,e),new Gi(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+360*(this.h<0),t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,o=2*n-r;return new Bi(Zi(e>=240?e-240:e+120,o,r),Zi(e,o,r),Zi(e<120?e+240:e-120,o,r),this.opacity)},clamp(){return new Gi(Hi(this.h),Ki(this.s),Ki(this.l),Ri(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=Ri(this.opacity);return"".concat(1===e?"hsl(":"hsla(").concat(Hi(this.h),", ").concat(100*Ki(this.s),"%, ").concat(100*Ki(this.l),"%").concat(1===e?")":", ".concat(e,")"))}}));const Xi=e=>()=>e;function Ji(e,t){return function(n){return e+n*t}}function Qi(e){return 1===(e=+e)?Yi:function(t,n){return n-t?function(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}(t,n,e):Xi(isNaN(t)?n:t)}}function Yi(e,t){var n=t-e;return n?Ji(e,n):Xi(isNaN(e)?t:e)}const es=function e(t){var n=Qi(t);function r(e,t){var r=n((e=Ni(e)).r,(t=Ni(t)).r),o=n(e.g,t.g),a=n(e.b,t.b),i=Yi(e.opacity,t.opacity);return function(t){return e.r=r(t),e.g=o(t),e.b=a(t),e.opacity=i(t),e+""}}return r.gamma=e,r}(1);function ts(e){return function(t){var n,r,o=t.length,a=new Array(o),i=new Array(o),s=new Array(o);for(n=0;n<o;++n)r=Ni(t[n]),a[n]=r.r||0,i[n]=r.g||0,s[n]=r.b||0;return a=e(a),i=e(i),s=e(s),r.opacity=1,function(e){return r.r=a(e),r.g=i(e),r.b=s(e),r+""}}}ts((function(e){var t=e.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),o=e[r],a=e[r+1],i=r>0?e[r-1]:2*o-a,s=r<t-1?e[r+2]:2*a-o;return $i((n-r/t)*t,i,o,a,s)}})),ts((function(e){var t=e.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*t),o=e[(r+t-1)%t],a=e[r%t],i=e[(r+1)%t],s=e[(r+2)%t];return $i((n-r/t)*t,o,a,i,s)}}));var ns=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,rs=new RegExp(ns.source,"g");function os(e,t){var n,r,o,a=ns.lastIndex=rs.lastIndex=0,i=-1,s=[],l=[];for(e+="",t+="";(n=ns.exec(e))&&(r=rs.exec(t));)(o=r.index)>a&&(o=t.slice(a,o),s[i]?s[i]+=o:s[++i]=o),(n=n[0])===(r=r[0])?s[i]?s[i]+=r:s[++i]=r:(s[++i]=null,l.push({i:i,x:oi(n,r)})),a=rs.lastIndex;return a<t.length&&(o=t.slice(a),s[i]?s[i]+=o:s[++i]=o),s.length<2?l[0]?function(e){return function(t){return e(t)+""}}(l[0].x):function(e){return function(){return e}}(t):(t=l.length,function(e){for(var n,r=0;r<t;++r)s[(n=l[r]).i]=n.x(e);return s.join("")})}function as(e,t){var n;return("number"===typeof t?oi:t instanceof Pi?es:(n=Pi(t))?(t=n,es):os)(e,t)}function is(e){return function(){this.removeAttribute(e)}}function ss(e){return function(){this.removeAttributeNS(e.space,e.local)}}function ls(e,t,n){var r,o,a=n+"";return function(){var i=this.getAttribute(e);return i===a?null:i===r?o:o=t(r=i,n)}}function cs(e,t,n){var r,o,a=n+"";return function(){var i=this.getAttributeNS(e.space,e.local);return i===a?null:i===r?o:o=t(r=i,n)}}function us(e,t,n){var r,o,a;return function(){var i,s,l=n(this);if(null!=l)return(i=this.getAttribute(e))===(s=l+"")?null:i===r&&s===o?a:(o=s,a=t(r=i,l));this.removeAttribute(e)}}function ds(e,t,n){var r,o,a;return function(){var i,s,l=n(this);if(null!=l)return(i=this.getAttributeNS(e.space,e.local))===(s=l+"")?null:i===r&&s===o?a:(o=s,a=t(r=i,l));this.removeAttributeNS(e.space,e.local)}}function ps(e,t){var n,r;function o(){var o=t.apply(this,arguments);return o!==r&&(n=(r=o)&&function(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}(e,o)),n}return o._value=t,o}function hs(e,t){var n,r;function o(){var o=t.apply(this,arguments);return o!==r&&(n=(r=o)&&function(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}(e,o)),n}return o._value=t,o}function fs(e,t){return function(){ei(this,e).delay=+t.apply(this,arguments)}}function ms(e,t){return t=+t,function(){ei(this,e).delay=t}}function gs(e,t){return function(){ti(this,e).duration=+t.apply(this,arguments)}}function _s(e,t){return t=+t,function(){ti(this,e).duration=t}}var vs=Sa.prototype.constructor;function ys(e){return function(){this.style.removeProperty(e)}}var ws=0;function bs(e,t,n,r){this._groups=e,this._parents=t,this._name=n,this._id=r}function xs(){return++ws}var ks=Sa.prototype;bs.prototype=function(e){return Sa().transition(e)}.prototype={constructor:bs,select:function(e){var t=this._name,n=this._id;"function"!==typeof e&&(e=mo(e));for(var r=this._groups,o=r.length,a=new Array(o),i=0;i<o;++i)for(var s,l,c=r[i],u=c.length,d=a[i]=new Array(u),p=0;p<u;++p)(s=c[p])&&(l=e.call(s,s.__data__,p,c))&&("__data__"in s&&(l.__data__=s.__data__),d[p]=l,Ya(d[p],t,n,p,d,ni(s,n)));return new bs(a,this._parents,t,n)},selectAll:function(e){var t=this._name,n=this._id;"function"!==typeof e&&(e=_o(e));for(var r=this._groups,o=r.length,a=[],i=[],s=0;s<o;++s)for(var l,c=r[s],u=c.length,d=0;d<u;++d)if(l=c[d]){for(var p,h=e.call(l,l.__data__,d,c),f=ni(l,n),m=0,g=h.length;m<g;++m)(p=h[m])&&Ya(p,t,n,m,h,f);a.push(h),i.push(l)}return new bs(a,i,t,n)},selectChild:ks.selectChild,selectChildren:ks.selectChildren,filter:function(e){"function"!==typeof e&&(e=yo(e));for(var t=this._groups,n=t.length,r=new Array(n),o=0;o<n;++o)for(var a,i=t[o],s=i.length,l=r[o]=[],c=0;c<s;++c)(a=i[c])&&e.call(a,a.__data__,c,i)&&l.push(a);return new bs(r,this._parents,this._name,this._id)},merge:function(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,r=t.length,o=n.length,a=Math.min(r,o),i=new Array(r),s=0;s<a;++s)for(var l,c=t[s],u=n[s],d=c.length,p=i[s]=new Array(d),h=0;h<d;++h)(l=c[h]||u[h])&&(p[h]=l);for(;s<r;++s)i[s]=t[s];return new bs(i,this._parents,this._name,this._id)},selection:function(){return new vs(this._groups,this._parents)},transition:function(){for(var e=this._name,t=this._id,n=xs(),r=this._groups,o=r.length,a=0;a<o;++a)for(var i,s=r[a],l=s.length,c=0;c<l;++c)if(i=s[c]){var u=ni(i,t);Ya(i,e,n,c,s,{time:u.time+u.delay+u.duration,delay:0,duration:u.duration,ease:u.ease})}return new bs(r,this._parents,e,n)},call:ks.call,nodes:ks.nodes,node:ks.node,size:ks.size,empty:ks.empty,each:ks.each,on:function(e,t){var n=this._id;return arguments.length<2?ni(this.node(),n).on.on(e):this.each(function(e,t,n){var r,o,a=function(e){return(e+"").trim().split(/^|\s+/).every((function(e){var t=e.indexOf(".");return t>=0&&(e=e.slice(0,t)),!e||"start"===e}))}(t)?ei:ti;return function(){var i=a(this,e),s=i.on;s!==r&&(o=(r=s).copy()).on(t,n),i.on=o}}(n,e,t))},attr:function(e,t){var n=zo(e),r="transform"===n?di:as;return this.attrTween(e,"function"===typeof t?(n.local?ds:us)(n,r,fi(this,"attr."+e,t)):null==t?(n.local?ss:is)(n):(n.local?cs:ls)(n,r,t))},attrTween:function(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(null==t)return this.tween(n,null);if("function"!==typeof t)throw new Error;var r=zo(e);return this.tween(n,(r.local?ps:hs)(r,t))},style:function(e,t,n){var r="transform"===(e+="")?ui:as;return null==t?this.styleTween(e,function(e,t){var n,r,o;return function(){var a=Go(this,e),i=(this.style.removeProperty(e),Go(this,e));return a===i?null:a===n&&i===r?o:o=t(n=a,r=i)}}(e,r)).on("end.style."+e,ys(e)):"function"===typeof t?this.styleTween(e,function(e,t,n){var r,o,a;return function(){var i=Go(this,e),s=n(this),l=s+"";return null==s&&(this.style.removeProperty(e),l=s=Go(this,e)),i===l?null:i===r&&l===o?a:(o=l,a=t(r=i,s))}}(e,r,fi(this,"style."+e,t))).each(function(e,t){var n,r,o,a,i="style."+t,s="end."+i;return function(){var l=ti(this,e),c=l.on,u=null==l.value[i]?a||(a=ys(t)):void 0;c===n&&o===u||(r=(n=c).copy()).on(s,o=u),l.on=r}}(this._id,e)):this.styleTween(e,function(e,t,n){var r,o,a=n+"";return function(){var i=Go(this,e);return i===a?null:i===r?o:o=t(r=i,n)}}(e,r,t),n).on("end.style."+e,null)},styleTween:function(e,t,n){var r="style."+(e+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(null==t)return this.tween(r,null);if("function"!==typeof t)throw new Error;return this.tween(r,function(e,t,n){var r,o;function a(){var a=t.apply(this,arguments);return a!==o&&(r=(o=a)&&function(e,t,n){return function(r){this.style.setProperty(e,t.call(this,r),n)}}(e,a,n)),r}return a._value=t,a}(e,t,null==n?"":n))},text:function(e){return this.tween("text","function"===typeof e?function(e){return function(){var t=e(this);this.textContent=null==t?"":t}}(fi(this,"text",e)):function(e){return function(){this.textContent=e}}(null==e?"":e+""))},textTween:function(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(null==e)return this.tween(t,null);if("function"!==typeof e)throw new Error;return this.tween(t,function(e){var t,n;function r(){var r=e.apply(this,arguments);return r!==n&&(t=(n=r)&&function(e){return function(t){this.textContent=e.call(this,t)}}(r)),t}return r._value=e,r}(e))},remove:function(){return this.on("end.remove",function(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}(this._id))},tween:function(e,t){var n=this._id;if(e+="",arguments.length<2){for(var r,o=ni(this.node(),n).tween,a=0,i=o.length;a<i;++a)if((r=o[a]).name===e)return r.value;return null}return this.each((null==t?pi:hi)(n,e,t))},delay:function(e){var t=this._id;return arguments.length?this.each(("function"===typeof e?fs:ms)(t,e)):ni(this.node(),t).delay},duration:function(e){var t=this._id;return arguments.length?this.each(("function"===typeof e?gs:_s)(t,e)):ni(this.node(),t).duration},ease:function(e){var t=this._id;return arguments.length?this.each(function(e,t){if("function"!==typeof t)throw new Error;return function(){ti(this,e).ease=t}}(t,e)):ni(this.node(),t).ease},easeVarying:function(e){if("function"!==typeof e)throw new Error;return this.each(function(e,t){return function(){var n=t.apply(this,arguments);if("function"!==typeof n)throw new Error;ti(this,e).ease=n}}(this._id,e))},end:function(){var e,t,n=this,r=n._id,o=n.size();return new Promise((function(a,i){var s={value:i},l={value:function(){0===--o&&a()}};n.each((function(){var n=ti(this,r),o=n.on;o!==e&&((t=(e=o).copy())._.cancel.push(s),t._.interrupt.push(s),t._.end.push(l)),n.on=t})),0===o&&a()}))},[Symbol.iterator]:ks[Symbol.iterator]};var Cs={time:null,delay:0,duration:250,ease:function(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}};function Ds(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error("transition ".concat(t," not found"));return n}Sa.prototype.interrupt=function(e){return this.each((function(){ri(this,e)}))},Sa.prototype.transition=function(e){var t,n;e instanceof bs?(t=e._id,e=e._name):(t=xs(),(n=Cs).time=Ua(),e=null==e?null:e+"");for(var r=this._groups,o=r.length,a=0;a<o;++a)for(var i,s=r[a],l=s.length,c=0;c<l;++c)(i=s[c])&&Ya(i,e,t,c,s,n||Ds(i,t));return new bs(r,this._parents,e,t)};const{abs:Ss,max:Es,min:Ts}=Math;function As(e){return[+e[0],+e[1]]}function Ms(e){return[As(e[0]),As(e[1])]}["w","e"].map(Fs),["n","s"].map(Fs),["n","w","e","s","nw","ne","sw","se"].map(Fs);function Fs(e){return{type:e}}var Is=Math.PI;function Ps(e){return(1-Math.cos(Is*e))/2}function zs(e){return function(){return e}}function Os(e){return 1e-6*(e()-.5)}function Ns(e){return e.index}function Bs(e,t){var n=e.get(t);if(!n)throw new Error("node not found: "+t);return n}const js=4294967296;var Ls=Math.PI*(3-Math.sqrt(5));function Rs(e){var t,n=1,r=.001,o=1-Math.pow(r,1/300),a=0,i=.6,s=new Map,l=Ha(d),c=Ia("tick","end"),u=function(){let e=1;return()=>(e=(1664525*e+1013904223)%js)/js}();function d(){p(),c.call("tick",t),n<r&&(l.stop(),c.call("end",t))}function p(r){var l,c,u=e.length;void 0===r&&(r=1);for(var d=0;d<r;++d)for(n+=(a-n)*o,s.forEach((function(e){e(n)})),l=0;l<u;++l)null==(c=e[l]).fx?c.x+=c.vx*=i:(c.x=c.fx,c.vx=0),null==c.fy?c.y+=c.vy*=i:(c.y=c.fy,c.vy=0);return t}function h(){for(var t,n=0,r=e.length;n<r;++n){if((t=e[n]).index=n,null!=t.fx&&(t.x=t.fx),null!=t.fy&&(t.y=t.fy),isNaN(t.x)||isNaN(t.y)){var o=10*Math.sqrt(.5+n),a=n*Ls;t.x=o*Math.cos(a),t.y=o*Math.sin(a)}(isNaN(t.vx)||isNaN(t.vy))&&(t.vx=t.vy=0)}}function f(t){return t.initialize&&t.initialize(e,u),t}return null==e&&(e=[]),h(),t={tick:p,restart:function(){return l.restart(d),t},stop:function(){return l.stop(),t},nodes:function(n){return arguments.length?(e=n,h(),s.forEach(f),t):e},alpha:function(e){return arguments.length?(n=+e,t):n},alphaMin:function(e){return arguments.length?(r=+e,t):r},alphaDecay:function(e){return arguments.length?(o=+e,t):+o},alphaTarget:function(e){return arguments.length?(a=+e,t):a},velocityDecay:function(e){return arguments.length?(i=1-e,t):1-i},randomSource:function(e){return arguments.length?(u=e,s.forEach(f),t):u},force:function(e,n){return arguments.length>1?(null==n?s.delete(e):s.set(e,f(n)),t):s.get(e)},find:function(t,n,r){var o,a,i,s,l,c=0,u=e.length;for(null==r?r=1/0:r*=r,c=0;c<u;++c)(i=(o=t-(s=e[c]).x)*o+(a=n-s.y)*a)<r&&(l=s,r=i);return l},on:function(e,n){return arguments.length>1?(c.on(e,n),t):c.on(e)}}}const Vs=Math.sqrt(50),qs=Math.sqrt(10),Us=Math.sqrt(2);function Ws(e,t,n){const r=(t-e)/Math.max(0,n),o=Math.floor(Math.log10(r)),a=r/Math.pow(10,o),i=a>=Vs?10:a>=qs?5:a>=Us?2:1;let s,l,c;return o<0?(c=Math.pow(10,-o)/i,s=Math.round(e*c),l=Math.round(t*c),s/c<e&&++s,l/c>t&&--l,c=-c):(c=Math.pow(10,o)*i,s=Math.round(e/c),l=Math.round(t/c),s*c<e&&++s,l*c>t&&--l),l<s&&.5<=n&&n<2?Ws(e,t,2*n):[s,l,c]}function Gs(e,t,n){return Ws(e=+e,t=+t,n=+n)[2]}function Hs(e,t){return null==e||null==t?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function Ks(e,t){return null==e||null==t?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function Zs(e){let t,n,r;function o(e,r){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.length;if(o<a){if(0!==t(r,r))return a;do{const t=o+a>>>1;n(e[t],r)<0?o=t+1:a=t}while(o<a)}return o}return 2!==e.length?(t=Hs,n=(t,n)=>Hs(e(t),n),r=(t,n)=>e(t)-n):(t=e===Hs||e===Ks?e:$s,n=e,r=e),{left:o,center:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const a=o(e,t,n,(arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.length)-1);return a>n&&r(e[a-1],t)>-r(e[a],t)?a-1:a},right:function(e,r){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.length;if(o<a){if(0!==t(r,r))return a;do{const t=o+a>>>1;n(e[t],r)<=0?o=t+1:a=t}while(o<a)}return o}}}function $s(){return 0}const Xs=Zs(Hs),Js=Xs.right,Qs=(Xs.left,Zs((function(e){return null===e?NaN:+e})).center,Js);function Ys(e,t){var n,r=t?t.length:0,o=e?Math.min(r,e.length):0,a=new Array(o),i=new Array(r);for(n=0;n<o;++n)a[n]=rl(e[n],t[n]);for(;n<r;++n)i[n]=t[n];return function(e){for(n=0;n<o;++n)i[n]=a[n](e);return i}}function el(e,t){var n=new Date;return e=+e,t=+t,function(r){return n.setTime(e*(1-r)+t*r),n}}function tl(e,t){var n,r={},o={};for(n in null!==e&&"object"===typeof e||(e={}),null!==t&&"object"===typeof t||(t={}),t)n in e?r[n]=rl(e[n],t[n]):o[n]=t[n];return function(e){for(n in r)o[n]=r[n](e);return o}}function nl(e,t){t||(t=[]);var n,r=e?Math.min(t.length,e.length):0,o=t.slice();return function(a){for(n=0;n<r;++n)o[n]=e[n]*(1-a)+t[n]*a;return o}}function rl(e,t){var n,r=typeof t;return null==t||"boolean"===r?Xi(t):("number"===r?oi:"string"===r?(n=Pi(t))?(t=n,es):os:t instanceof Pi?es:t instanceof Date?el:function(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}(t)?nl:Array.isArray(t)?Ys:"function"!==typeof t.valueOf&&"function"!==typeof t.toString||isNaN(t)?tl:oi)(e,t)}function ol(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}function al(e){return+e}var il=[0,1];function sl(e){return e}function ll(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:function(e){return function(){return e}}(isNaN(t)?NaN:.5)}function cl(e,t,n){var r=e[0],o=e[1],a=t[0],i=t[1];return o<r?(r=ll(o,r),a=n(i,a)):(r=ll(r,o),a=n(a,i)),function(e){return a(r(e))}}function ul(e,t,n){var r=Math.min(e.length,t.length)-1,o=new Array(r),a=new Array(r),i=-1;for(e[r]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++i<r;)o[i]=ll(e[i],e[i+1]),a[i]=n(t[i],t[i+1]);return function(t){var n=Qs(e,t,1,r)-1;return a[n](o[n](t))}}function dl(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function pl(){var e,t,n,r,o,a,i=il,s=il,l=rl,c=sl;function u(){var e=Math.min(i.length,s.length);return c!==sl&&(c=function(e,t){var n;return e>t&&(n=e,e=t,t=n),function(n){return Math.max(e,Math.min(t,n))}}(i[0],i[e-1])),r=e>2?ul:cl,o=a=null,d}function d(t){return null==t||isNaN(t=+t)?n:(o||(o=r(i.map(e),s,l)))(e(c(t)))}return d.invert=function(n){return c(t((a||(a=r(s,i.map(e),oi)))(n)))},d.domain=function(e){return arguments.length?(i=Array.from(e,al),u()):i.slice()},d.range=function(e){return arguments.length?(s=Array.from(e),u()):s.slice()},d.rangeRound=function(e){return s=Array.from(e),l=ol,u()},d.clamp=function(e){return arguments.length?(c=!!e||sl,u()):c!==sl},d.interpolate=function(e){return arguments.length?(l=e,u()):l},d.unknown=function(e){return arguments.length?(n=e,d):n},function(n,r){return e=n,t=r,u()}}function hl(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e)}return this}var fl,ml=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function gl(e){if(!(t=ml.exec(e)))throw new Error("invalid format: "+e);var t;return new _l({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}function _l(e){this.fill=void 0===e.fill?" ":e.fill+"",this.align=void 0===e.align?">":e.align+"",this.sign=void 0===e.sign?"-":e.sign+"",this.symbol=void 0===e.symbol?"":e.symbol+"",this.zero=!!e.zero,this.width=void 0===e.width?void 0:+e.width,this.comma=!!e.comma,this.precision=void 0===e.precision?void 0:+e.precision,this.trim=!!e.trim,this.type=void 0===e.type?"":e.type+""}function vl(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]}function yl(e){return(e=vl(Math.abs(e)))?e[1]:NaN}function wl(e,t){var n=vl(e,t);if(!n)return e+"";var r=n[0],o=n[1];return o<0?"0."+new Array(-o).join("0")+r:r.length>o+1?r.slice(0,o+1)+"."+r.slice(o+1):r+new Array(o-r.length+2).join("0")}gl.prototype=_l.prototype,_l.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};const bl={"%":(e,t)=>(100*e).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:function(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)},e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>wl(100*e,t),r:wl,s:function(e,t){var n=vl(e,t);if(!n)return e+"";var r=n[0],o=n[1],a=o-(fl=3*Math.max(-8,Math.min(8,Math.floor(o/3))))+1,i=r.length;return a===i?r:a>i?r+new Array(a-i+1).join("0"):a>0?r.slice(0,a)+"."+r.slice(a):"0."+new Array(1-a).join("0")+vl(e,Math.max(0,t+a-1))[0]},X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function xl(e){return e}var kl,Cl,Dl,Sl=Array.prototype.map,El=["y","z","a","f","p","n","\xb5","m","","k","M","G","T","P","E","Z","Y"];function Tl(e){var t,n,r=void 0===e.grouping||void 0===e.thousands?xl:(t=Sl.call(e.grouping,Number),n=e.thousands+"",function(e,r){for(var o=e.length,a=[],i=0,s=t[0],l=0;o>0&&s>0&&(l+s+1>r&&(s=Math.max(1,r-l)),a.push(e.substring(o-=s,o+s)),!((l+=s+1)>r));)s=t[i=(i+1)%t.length];return a.reverse().join(n)}),o=void 0===e.currency?"":e.currency[0]+"",a=void 0===e.currency?"":e.currency[1]+"",i=void 0===e.decimal?".":e.decimal+"",s=void 0===e.numerals?xl:function(e){return function(t){return t.replace(/[0-9]/g,(function(t){return e[+t]}))}}(Sl.call(e.numerals,String)),l=void 0===e.percent?"%":e.percent+"",c=void 0===e.minus?"\u2212":e.minus+"",u=void 0===e.nan?"NaN":e.nan+"";function d(e){var t=(e=gl(e)).fill,n=e.align,d=e.sign,p=e.symbol,h=e.zero,f=e.width,m=e.comma,g=e.precision,_=e.trim,v=e.type;"n"===v?(m=!0,v="g"):bl[v]||(void 0===g&&(g=12),_=!0,v="g"),(h||"0"===t&&"="===n)&&(h=!0,t="0",n="=");var y="$"===p?o:"#"===p&&/[boxX]/.test(v)?"0"+v.toLowerCase():"",w="$"===p?a:/[%p]/.test(v)?l:"",b=bl[v],x=/[defgprs%]/.test(v);function k(e){var o,a,l,p=y,k=w;if("c"===v)k=b(e)+k,e="";else{var C=(e=+e)<0||1/e<0;if(e=isNaN(e)?u:b(Math.abs(e),g),_&&(e=function(e){e:for(var t,n=e.length,r=1,o=-1;r<n;++r)switch(e[r]){case".":o=t=r;break;case"0":0===o&&(o=r),t=r;break;default:if(!+e[r])break e;o>0&&(o=0)}return o>0?e.slice(0,o)+e.slice(t+1):e}(e)),C&&0===+e&&"+"!==d&&(C=!1),p=(C?"("===d?d:c:"-"===d||"("===d?"":d)+p,k=("s"===v?El[8+fl/3]:"")+k+(C&&"("===d?")":""),x)for(o=-1,a=e.length;++o<a;)if(48>(l=e.charCodeAt(o))||l>57){k=(46===l?i+e.slice(o+1):e.slice(o))+k,e=e.slice(0,o);break}}m&&!h&&(e=r(e,1/0));var D=p.length+e.length+k.length,S=D<f?new Array(f-D+1).join(t):"";switch(m&&h&&(e=r(S+e,S.length?f-k.length:1/0),S=""),n){case"<":e=p+e+k+S;break;case"=":e=p+S+e+k;break;case"^":e=S.slice(0,D=S.length>>1)+p+e+k+S.slice(D);break;default:e=S+p+e+k}return s(e)}return g=void 0===g?6:/[gprs]/.test(v)?Math.max(1,Math.min(21,g)):Math.max(0,Math.min(20,g)),k.toString=function(){return e+""},k}return{format:d,formatPrefix:function(e,t){var n=d(((e=gl(e)).type="f",e)),r=3*Math.max(-8,Math.min(8,Math.floor(yl(t)/3))),o=Math.pow(10,-r),a=El[8+r/3];return function(e){return n(o*e)+a}}}}function Al(e,t,n,r){var o,a=function(e,t,n){n=+n;const r=(t=+t)<(e=+e),o=r?Gs(t,e,n):Gs(e,t,n);return(r?-1:1)*(o<0?1/-o:o)}(e,t,n);switch((r=gl(null==r?",f":r)).type){case"s":var i=Math.max(Math.abs(e),Math.abs(t));return null!=r.precision||isNaN(o=function(e,t){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(yl(t)/3)))-yl(Math.abs(e)))}(a,i))||(r.precision=o),Dl(r,i);case"":case"e":case"g":case"p":case"r":null!=r.precision||isNaN(o=function(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,yl(t)-yl(e))+1}(a,Math.max(Math.abs(e),Math.abs(t))))||(r.precision=o-("e"===r.type));break;case"f":case"%":null!=r.precision||isNaN(o=function(e){return Math.max(0,-yl(Math.abs(e)))}(a))||(r.precision=o-2*("%"===r.type))}return Cl(r)}function Ml(e){var t=e.domain;return e.ticks=function(e){var n=t();return function(e,t,n){if(!((n=+n)>0))return[];if((e=+e)===(t=+t))return[e];const r=t<e,[o,a,i]=r?Ws(t,e,n):Ws(e,t,n);if(!(a>=o))return[];const s=a-o+1,l=new Array(s);if(r)if(i<0)for(let c=0;c<s;++c)l[c]=(a-c)/-i;else for(let c=0;c<s;++c)l[c]=(a-c)*i;else if(i<0)for(let c=0;c<s;++c)l[c]=(o+c)/-i;else for(let c=0;c<s;++c)l[c]=(o+c)*i;return l}(n[0],n[n.length-1],null==e?10:e)},e.tickFormat=function(e,n){var r=t();return Al(r[0],r[r.length-1],null==e?10:e,n)},e.nice=function(n){null==n&&(n=10);var r,o,a=t(),i=0,s=a.length-1,l=a[i],c=a[s],u=10;for(c<l&&(o=l,l=c,c=o,o=i,i=s,s=o);u-- >0;){if((o=Gs(l,c,n))===r)return a[i]=l,a[s]=c,t(a);if(o>0)l=Math.floor(l/o)*o,c=Math.ceil(c/o)*o;else{if(!(o<0))break;l=Math.ceil(l*o)/o,c=Math.floor(c*o)/o}r=o}return e},e}function Fl(){var e=pl()(sl,sl);return e.copy=function(){return dl(e,Fl())},hl.apply(e,arguments),Ml(e)}kl=Tl({thousands:",",grouping:[3],currency:["$",""]}),Cl=kl.format,Dl=kl.formatPrefix;class Il extends Map{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Nl;if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:t}}),null!=e)for(const[n,r]of e)this.set(n,r)}get(e){return super.get(Pl(this,e))}has(e){return super.has(Pl(this,e))}set(e,t){return super.set(zl(this,e),t)}delete(e){return super.delete(Ol(this,e))}}Set;function Pl(e,t){let{_intern:n,_key:r}=e;const o=r(t);return n.has(o)?n.get(o):t}function zl(e,t){let{_intern:n,_key:r}=e;const o=r(t);return n.has(o)?n.get(o):(n.set(o,t),t)}function Ol(e,t){let{_intern:n,_key:r}=e;const o=r(t);return n.has(o)&&(t=n.get(o),n.delete(o)),t}function Nl(e){return null!==e&&"object"===typeof e?e.valueOf():e}const Bl=Symbol("implicit");function jl(){var e=new Il,t=[],n=[],r=Bl;function o(o){let a=e.get(o);if(void 0===a){if(r!==Bl)return r;e.set(o,a=t.push(o)-1)}return n[a%n.length]}return o.domain=function(n){if(!arguments.length)return t.slice();t=[],e=new Il;for(const r of n)e.has(r)||e.set(r,t.push(r)-1);return o},o.range=function(e){return arguments.length?(n=Array.from(e),o):n.slice()},o.unknown=function(e){return arguments.length?(r=e,o):r},o.copy=function(){return jl(t,n).unknown(r)},hl.apply(o,arguments),o}function Ll(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function Rl(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function Vl(e){return e<0?-e*e:e*e}function ql(e){var t=e(sl,sl),n=1;return t.exponent=function(t){return arguments.length?1===(n=+t)?e(sl,sl):.5===n?e(Rl,Vl):e(Ll(n),Ll(1/n)):n},Ml(t)}function Ul(){var e=ql(pl());return e.copy=function(){return dl(e,Ul()).exponent(e.exponent())},hl.apply(e,arguments),e}const Wl=function(e){for(var t=e.length/6|0,n=new Array(t),r=0;r<t;)n[r]="#"+e.slice(6*r,6*++r);return n}("7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666");function Gl(e){return"string"===typeof e?new Ca([[document.querySelector(e)]],[document.documentElement]):new Ca([[e]],ka)}var Hl,Kl,Zl,$l,Xl,Jl,Ql,Yl,ec,tc,nc,rc,oc,ac;Array.prototype.slice;function ic(e){return function(){return e}}function sc(e){this._context=e}function lc(e){return new sc(e)}function cc(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}sc.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t)}}};const uc=Math.PI,dc=2*uc,pc=1e-6,hc=dc-pc;function fc(e){this._+=e[0];for(let t=1,n=e.length;t<n;++t)this._+=arguments[t]+e[t]}class mc{constructor(e){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=null==e?fc:function(e){let t=Math.floor(e);if(!(t>=0))throw new Error("invalid digits: ".concat(e));if(t>15)return fc;const n=10**t;return function(e){this._+=e[0];for(let t=1,r=e.length;t<r;++t)this._+=Math.round(arguments[t]*n)/n+e[t]}}(e)}moveTo(e,t){this._append(Hl||(Hl=cc(["M",",",""])),this._x0=this._x1=+e,this._y0=this._y1=+t)}closePath(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._append(Kl||(Kl=cc(["Z"]))))}lineTo(e,t){this._append(Zl||(Zl=cc(["L",",",""])),this._x1=+e,this._y1=+t)}quadraticCurveTo(e,t,n,r){this._append($l||($l=cc(["Q",",",",",",",""])),+e,+t,this._x1=+n,this._y1=+r)}bezierCurveTo(e,t,n,r,o,a){this._append(Xl||(Xl=cc(["C",",",",",",",",",",",""])),+e,+t,+n,+r,this._x1=+o,this._y1=+a)}arcTo(e,t,n,r,o){if(e=+e,t=+t,n=+n,r=+r,(o=+o)<0)throw new Error("negative radius: ".concat(o));let a=this._x1,i=this._y1,s=n-e,l=r-t,c=a-e,u=i-t,d=c*c+u*u;if(null===this._x1)this._append(Jl||(Jl=cc(["M",",",""])),this._x1=e,this._y1=t);else if(d>pc)if(Math.abs(u*s-l*c)>pc&&o){let p=n-a,h=r-i,f=s*s+l*l,m=p*p+h*h,g=Math.sqrt(f),_=Math.sqrt(d),v=o*Math.tan((uc-Math.acos((f+d-m)/(2*g*_)))/2),y=v/_,w=v/g;Math.abs(y-1)>pc&&this._append(Yl||(Yl=cc(["L",",",""])),e+y*c,t+y*u),this._append(ec||(ec=cc(["A",",",",0,0,",",",",",""])),o,o,+(u*p>c*h),this._x1=e+w*s,this._y1=t+w*l)}else this._append(Ql||(Ql=cc(["L",",",""])),this._x1=e,this._y1=t);else;}arc(e,t,n,r,o,a){if(e=+e,t=+t,a=!!a,(n=+n)<0)throw new Error("negative radius: ".concat(n));let i=n*Math.cos(r),s=n*Math.sin(r),l=e+i,c=t+s,u=1^a,d=a?r-o:o-r;null===this._x1?this._append(tc||(tc=cc(["M",",",""])),l,c):(Math.abs(this._x1-l)>pc||Math.abs(this._y1-c)>pc)&&this._append(nc||(nc=cc(["L",",",""])),l,c),n&&(d<0&&(d=d%dc+dc),d>hc?this._append(rc||(rc=cc(["A",",",",0,1,",",",",","A",",",",0,1,",",",",",""])),n,n,u,e-i,t-s,n,n,u,this._x1=l,this._y1=c):d>pc&&this._append(oc||(oc=cc(["A",",",",0,",",",",",",",""])),n,n,+(d>=uc),u,this._x1=e+n*Math.cos(o),this._y1=t+n*Math.sin(o)))}rect(e,t,n,r){this._append(ac||(ac=cc(["M",",","h","v","h","Z"])),this._x0=this._x1=+e,this._y0=this._y1=+t,n=+n,+r,-n)}toString(){return this._}}function gc(e){return e[0]}function _c(e){return e[1]}function vc(e,t){var n=ic(!0),r=null,o=lc,a=null,i=function(e){let t=3;return e.digits=function(n){if(!arguments.length)return t;if(null==n)t=null;else{const e=Math.floor(n);if(!(e>=0))throw new RangeError("invalid digits: ".concat(n));t=e}return e},()=>new mc(t)}(s);function s(s){var l,c,u,d=(s=function(e){return"object"===typeof e&&"length"in e?e:Array.from(e)}(s)).length,p=!1;for(null==r&&(a=o(u=i())),l=0;l<=d;++l)!(l<d&&n(c=s[l],l,s))===p&&((p=!p)?a.lineStart():a.lineEnd()),p&&a.point(+e(c,l,s),+t(c,l,s));if(u)return a=null,u+""||null}return e="function"===typeof e?e:void 0===e?gc:ic(e),t="function"===typeof t?t:void 0===t?_c:ic(t),s.x=function(t){return arguments.length?(e="function"===typeof t?t:ic(+t),s):e},s.y=function(e){return arguments.length?(t="function"===typeof e?e:ic(+e),s):t},s.defined=function(e){return arguments.length?(n="function"===typeof e?e:ic(!!e),s):n},s.curve=function(e){return arguments.length?(o=e,null!=r&&(a=o(r)),s):o},s.context=function(e){return arguments.length?(null==e?r=a=null:a=o(r=e),s):r},s}function yc(e){return e<0?-1:1}function wc(e,t,n){var r=e._x1-e._x0,o=t-e._x1,a=(e._y1-e._y0)/(r||o<0&&-0),i=(n-e._y1)/(o||r<0&&-0),s=(a*o+i*r)/(r+o);return(yc(a)+yc(i))*Math.min(Math.abs(a),Math.abs(i),.5*Math.abs(s))||0}function bc(e,t){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-t)/2:t}function xc(e,t,n){var r=e._x0,o=e._y0,a=e._x1,i=e._y1,s=(a-r)/3;e._context.bezierCurveTo(r+s,o+s*t,a-s,i-s*n,a,i)}function kc(e){this._context=e}function Cc(e){this._context=new Dc(e)}function Dc(e){this._context=e}function Sc(e){return new Cc(e)}kc.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:xc(this,this._t0,bc(this,this._t0))}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var n=NaN;if(t=+t,(e=+e)!==this._x1||t!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,xc(this,bc(this,n=wc(this,e,t)),n);break;default:xc(this,this._t0,n=wc(this,e,t))}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=n}}},(Cc.prototype=Object.create(kc.prototype)).point=function(e,t){kc.prototype.point.call(this,t,e)},Dc.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,n,r,o,a){this._context.bezierCurveTo(t,e,r,n,a,o)}};const Ec={capture:!0,passive:!1};function Tc(e){e.preventDefault(),e.stopImmediatePropagation()}function Ac(e){return((e=Math.exp(e))+1/e)/2}const Mc=function e(t,n,r){function o(e,o){var a,i,s=e[0],l=e[1],c=e[2],u=o[0],d=o[1],p=o[2],h=u-s,f=d-l,m=h*h+f*f;if(m<1e-12)i=Math.log(p/c)/t,a=function(e){return[s+e*h,l+e*f,c*Math.exp(t*e*i)]};else{var g=Math.sqrt(m),_=(p*p-c*c+r*m)/(2*c*n*g),v=(p*p-c*c-r*m)/(2*p*n*g),y=Math.log(Math.sqrt(_*_+1)-_),w=Math.log(Math.sqrt(v*v+1)-v);i=(w-y)/t,a=function(e){var r=e*i,o=Ac(y),a=c/(n*g)*(o*function(e){return((e=Math.exp(2*e))-1)/(e+1)}(t*r+y)-function(e){return((e=Math.exp(e))-1/e)/2}(y));return[s+a*h,l+a*f,c*o/Ac(t*r+y)]}}return a.duration=1e3*i*t/Math.SQRT2,a}return o.rho=function(t){var n=Math.max(.001,+t),r=n*n;return e(n,r,r*r)},o}(Math.SQRT2,2,4);function Fc(e,t){if(e=function(e){let t;for(;t=e.sourceEvent;)e=t;return e}(e),void 0===t&&(t=e.currentTarget),t){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=e.clientX,r.y=e.clientY,[(r=r.matrixTransform(t.getScreenCTM().inverse())).x,r.y]}if(t.getBoundingClientRect){var o=t.getBoundingClientRect();return[e.clientX-o.left-t.clientLeft,e.clientY-o.top-t.clientTop]}}return[e.pageX,e.pageY]}const Ic=e=>()=>e;function Pc(e,t){let{sourceEvent:n,target:r,transform:o,dispatch:a}=t;Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:n,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},transform:{value:o,enumerable:!0,configurable:!0},_:{value:a}})}function zc(e,t,n){this.k=e,this.x=t,this.y=n}zc.prototype={constructor:zc,scale:function(e){return 1===e?this:new zc(this.k*e,this.x,this.y)},translate:function(e,t){return 0===e&0===t?this:new zc(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var Oc=new zc(1,0,0);function Nc(e){e.stopImmediatePropagation()}function Bc(e){e.preventDefault(),e.stopImmediatePropagation()}function jc(e){return(!e.ctrlKey||"wheel"===e.type)&&!e.button}function Lc(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e).hasAttribute("viewBox")?[[(e=e.viewBox.baseVal).x,e.y],[e.x+e.width,e.y+e.height]]:[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]:[[0,0],[e.clientWidth,e.clientHeight]]}function Rc(){return this.__zoom||Oc}function Vc(e){return-e.deltaY*(1===e.deltaMode?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function qc(){return navigator.maxTouchPoints||"ontouchstart"in this}function Uc(e,t,n){var r=e.invertX(t[0][0])-n[0][0],o=e.invertX(t[1][0])-n[1][0],a=e.invertY(t[0][1])-n[0][1],i=e.invertY(t[1][1])-n[1][1];return e.translate(o>r?(r+o)/2:Math.min(0,r)||Math.max(0,o),i>a?(a+i)/2:Math.min(0,a)||Math.max(0,i))}function Wc(){var e,t,n,r=jc,o=Lc,a=Uc,i=Vc,s=qc,l=[0,1/0],c=[[-1/0,-1/0],[1/0,1/0]],u=250,d=Mc,p=Ia("start","zoom","end"),h=0,f=10;function m(e){e.property("__zoom",Rc).on("wheel.zoom",x,{passive:!1}).on("mousedown.zoom",k).on("dblclick.zoom",C).filter(s).on("touchstart.zoom",D).on("touchmove.zoom",S).on("touchend.zoom touchcancel.zoom",E).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function g(e,t){return(t=Math.max(l[0],Math.min(l[1],t)))===e.k?e:new zc(t,e.x,e.y)}function _(e,t,n){var r=t[0]-n[0]*e.k,o=t[1]-n[1]*e.k;return r===e.x&&o===e.y?e:new zc(e.k,r,o)}function v(e){return[(+e[0][0]+ +e[1][0])/2,(+e[0][1]+ +e[1][1])/2]}function y(e,t,n,r){e.on("start.zoom",(function(){w(this,arguments).event(r).start()})).on("interrupt.zoom end.zoom",(function(){w(this,arguments).event(r).end()})).tween("zoom",(function(){var e=this,a=arguments,i=w(e,a).event(r),s=o.apply(e,a),l=null==n?v(s):"function"===typeof n?n.apply(e,a):n,c=Math.max(s[1][0]-s[0][0],s[1][1]-s[0][1]),u=e.__zoom,p="function"===typeof t?t.apply(e,a):t,h=d(u.invert(l).concat(c/u.k),p.invert(l).concat(c/p.k));return function(e){if(1===e)e=p;else{var t=h(e),n=c/t[2];e=new zc(n,l[0]-t[0]*n,l[1]-t[1]*n)}i.zoom(null,e)}}))}function w(e,t,n){return!n&&e.__zooming||new b(e,t)}function b(e,t){this.that=e,this.args=t,this.active=0,this.sourceEvent=null,this.extent=o.apply(e,t),this.taps=0}function x(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];if(r.apply(this,arguments)){var s=w(this,n).event(e),u=this.__zoom,d=Math.max(l[0],Math.min(l[1],u.k*Math.pow(2,i.apply(this,arguments)))),p=Fc(e);if(s.wheel)s.mouse[0][0]===p[0]&&s.mouse[0][1]===p[1]||(s.mouse[1]=u.invert(s.mouse[0]=p)),clearTimeout(s.wheel);else{if(u.k===d)return;s.mouse=[p,u.invert(p)],ri(this),s.start()}Bc(e),s.wheel=setTimeout((function(){s.wheel=null,s.end()}),150),s.zoom("mouse",a(_(g(u,d),s.mouse[0],s.mouse[1]),s.extent,c))}}function k(e){for(var t=arguments.length,o=new Array(t>1?t-1:0),i=1;i<t;i++)o[i-1]=arguments[i];if(!n&&r.apply(this,arguments)){var s=e.currentTarget,l=w(this,o,!0).event(e),u=Gl(e.view).on("mousemove.zoom",(function(e){if(Bc(e),!l.moved){var t=e.clientX-p,n=e.clientY-f;l.moved=t*t+n*n>h}l.event(e).zoom("mouse",a(_(l.that.__zoom,l.mouse[0]=Fc(e,s),l.mouse[1]),l.extent,c))}),!0).on("mouseup.zoom",(function(e){u.on("mousemove.zoom mouseup.zoom",null),function(e,t){var n=e.document.documentElement,r=Gl(e).on("dragstart.drag",null);t&&(r.on("click.drag",Tc,Ec),setTimeout((function(){r.on("click.drag",null)}),0)),"onselectstart"in n?r.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}(e.view,l.moved),Bc(e),l.event(e).end()}),!0),d=Fc(e,s),p=e.clientX,f=e.clientY;!function(e){var t=e.document.documentElement,n=Gl(e).on("dragstart.drag",Tc,Ec);"onselectstart"in t?n.on("selectstart.drag",Tc,Ec):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}(e.view),Nc(e),l.mouse=[d,this.__zoom.invert(d)],ri(this),l.start()}}function C(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];if(r.apply(this,arguments)){var s=this.__zoom,l=Fc(e.changedTouches?e.changedTouches[0]:e,this),d=s.invert(l),p=s.k*(e.shiftKey?.5:2),h=a(_(g(s,p),l,d),o.apply(this,n),c);Bc(e),u>0?Gl(this).transition().duration(u).call(y,h,l,e):Gl(this).call(m.transform,h,l,e)}}function D(n){for(var o=arguments.length,a=new Array(o>1?o-1:0),i=1;i<o;i++)a[i-1]=arguments[i];if(r.apply(this,arguments)){var s,l,c,u,d=n.touches,p=d.length,h=w(this,a,n.changedTouches.length===p).event(n);for(Nc(n),l=0;l<p;++l)u=[u=Fc(c=d[l],this),this.__zoom.invert(u),c.identifier],h.touch0?h.touch1||h.touch0[2]===u[2]||(h.touch1=u,h.taps=0):(h.touch0=u,s=!0,h.taps=1+!!e);e&&(e=clearTimeout(e)),s&&(h.taps<2&&(t=u[0],e=setTimeout((function(){e=null}),500)),ri(this),h.start())}}function S(e){if(this.__zooming){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var o,i,s,l,u=w(this,n).event(e),d=e.changedTouches,p=d.length;for(Bc(e),o=0;o<p;++o)s=Fc(i=d[o],this),u.touch0&&u.touch0[2]===i.identifier?u.touch0[0]=s:u.touch1&&u.touch1[2]===i.identifier&&(u.touch1[0]=s);if(i=u.that.__zoom,u.touch1){var h=u.touch0[0],f=u.touch0[1],m=u.touch1[0],v=u.touch1[1],y=(y=m[0]-h[0])*y+(y=m[1]-h[1])*y,b=(b=v[0]-f[0])*b+(b=v[1]-f[1])*b;i=g(i,Math.sqrt(y/b)),s=[(h[0]+m[0])/2,(h[1]+m[1])/2],l=[(f[0]+v[0])/2,(f[1]+v[1])/2]}else{if(!u.touch0)return;s=u.touch0[0],l=u.touch0[1]}u.zoom("touch",a(_(i,s,l),u.extent,c))}}function E(e){for(var r=arguments.length,o=new Array(r>1?r-1:0),a=1;a<r;a++)o[a-1]=arguments[a];if(this.__zooming){var i,s,l=w(this,o).event(e),c=e.changedTouches,u=c.length;for(Nc(e),n&&clearTimeout(n),n=setTimeout((function(){n=null}),500),i=0;i<u;++i)s=c[i],l.touch0&&l.touch0[2]===s.identifier?delete l.touch0:l.touch1&&l.touch1[2]===s.identifier&&delete l.touch1;if(l.touch1&&!l.touch0&&(l.touch0=l.touch1,delete l.touch1),l.touch0)l.touch0[1]=this.__zoom.invert(l.touch0[0]);else if(l.end(),2===l.taps&&(s=Fc(s,this),Math.hypot(t[0]-s[0],t[1]-s[1])<f)){var d=Gl(this).on("dblclick.zoom");d&&d.apply(this,arguments)}}}return m.transform=function(e,t,n,r){var o=e.selection?e.selection():e;o.property("__zoom",Rc),e!==o?y(e,t,n,r):o.interrupt().each((function(){w(this,arguments).event(r).start().zoom(null,"function"===typeof t?t.apply(this,arguments):t).end()}))},m.scaleBy=function(e,t,n,r){m.scaleTo(e,(function(){return this.__zoom.k*("function"===typeof t?t.apply(this,arguments):t)}),n,r)},m.scaleTo=function(e,t,n,r){m.transform(e,(function(){var e=o.apply(this,arguments),r=this.__zoom,i=null==n?v(e):"function"===typeof n?n.apply(this,arguments):n,s=r.invert(i),l="function"===typeof t?t.apply(this,arguments):t;return a(_(g(r,l),i,s),e,c)}),n,r)},m.translateBy=function(e,t,n,r){m.transform(e,(function(){return a(this.__zoom.translate("function"===typeof t?t.apply(this,arguments):t,"function"===typeof n?n.apply(this,arguments):n),o.apply(this,arguments),c)}),null,r)},m.translateTo=function(e,t,n,r,i){m.transform(e,(function(){var e=o.apply(this,arguments),i=this.__zoom,s=null==r?v(e):"function"===typeof r?r.apply(this,arguments):r;return a(Oc.translate(s[0],s[1]).scale(i.k).translate("function"===typeof t?-t.apply(this,arguments):-t,"function"===typeof n?-n.apply(this,arguments):-n),e,c)}),r,i)},b.prototype={event:function(e){return e&&(this.sourceEvent=e),this},start:function(){return 1===++this.active&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(e,t){return this.mouse&&"mouse"!==e&&(this.mouse[1]=t.invert(this.mouse[0])),this.touch0&&"touch"!==e&&(this.touch0[1]=t.invert(this.touch0[0])),this.touch1&&"touch"!==e&&(this.touch1[1]=t.invert(this.touch1[0])),this.that.__zoom=t,this.emit("zoom"),this},end:function(){return 0===--this.active&&(delete this.that.__zooming,this.emit("end")),this},emit:function(e){var t=Gl(this.that).datum();p.call(e,this.that,new Pc(e,{sourceEvent:this.sourceEvent,target:m,type:e,transform:this.that.__zoom,dispatch:p}),t)}},m.wheelDelta=function(e){return arguments.length?(i="function"===typeof e?e:Ic(+e),m):i},m.filter=function(e){return arguments.length?(r="function"===typeof e?e:Ic(!!e),m):r},m.touchable=function(e){return arguments.length?(s="function"===typeof e?e:Ic(!!e),m):s},m.extent=function(e){return arguments.length?(o="function"===typeof e?e:Ic([[+e[0][0],+e[0][1]],[+e[1][0],+e[1][1]]]),m):o},m.scaleExtent=function(e){return arguments.length?(l[0]=+e[0],l[1]=+e[1],m):[l[0],l[1]]},m.translateExtent=function(e){return arguments.length?(c[0][0]=+e[0][0],c[1][0]=+e[1][0],c[0][1]=+e[0][1],c[1][1]=+e[1][1],m):[[c[0][0],c[0][1]],[c[1][0],c[1][1]]]},m.constrain=function(e){return arguments.length?(a=e,m):a},m.duration=function(e){return arguments.length?(u=+e,m):u},m.interpolate=function(e){return arguments.length?(d=e,m):d},m.on=function(){var e=p.on.apply(p,arguments);return e===p?m:e},m.clickDistance=function(e){return arguments.length?(h=(e=+e)*e,m):Math.sqrt(h)},m.tapDistance=function(e){return arguments.length?(f=+e,m):f},m}zc.prototype;const Gc=["#4f6980","#f47942","#bfbb60","#b66353","#638b66","#d7ce9f","#a2ceaa","#fbb04e","#849db1","#b9aa97","#7e756d"];function Hc(e,t){const n=t.filter((t=>t.source===e||t.target===e));if(0===n.length)return"black";const r={};n.forEach((e=>{if(e.promptId){const t=e.promptId.match(/_(\d+)_/),n=t?t[1]:"0";r[n]=(r[n]||0)+1}}));const o=n.length,a={};Object.keys(r).forEach((e=>{a[e]=r[e]/o}));const i={};return Object.keys(a).forEach((e=>{const t=parseInt(e);i[e]=Gc[t%Gc.length]})),function(e,t){const n=Object.keys(e);if(0===n.length)return"black";if(1===n.length)return e[n[0]];let r=0,o=0,a=0;n.forEach((n=>{const i=e[n],s=t[n],l=Pi(i);if(l){const e=l.rgb();r+=e.r*s,o+=e.g*s,a+=e.b*s}}));return Ni(Math.round(r),Math.round(o),Math.round(a)).toString()}(i,a)}function Kc(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function Zc(e){var t,n,r,o=2;for("undefined"!=typeof Symbol&&(n=Symbol.asyncIterator,r=Symbol.iterator);o--;){if(n&&null!=(t=e[n]))return t.call(e);if(r&&null!=(t=e[r]))return new $c(t.call(e));n="@@asyncIterator",r="@@iterator"}throw new TypeError("Object is not async iterable")}function $c(e){function t(e){if(Object(e)!==e)return Promise.reject(new TypeError(e+" is not an object."));var t=e.done;return Promise.resolve(e.value).then((function(e){return{value:e,done:t}}))}return $c=function(e){this.s=e,this.n=e.next},$c.prototype={s:null,n:null,next:function(){return t(this.n.apply(this.s,arguments))},return:function(e){var n=this.s.return;return void 0===n?Promise.resolve({value:e,done:!0}):t(n.apply(this.s,arguments))},throw:function(e){var n=this.s.return;return void 0===n?Promise.reject(e):t(n.apply(this.s,arguments))}},new $c(e)}function Xc(e,t){this.v=e,this.k=t}function Jc(e){return new Xc(e,0)}function Qc(e){var t,n;function r(t,n){try{var a=e[t](n),i=a.value,s=i instanceof Xc;Promise.resolve(s?i.v:i).then((function(n){if(s){var l="return"===t?"return":"next";if(!i.k||n.done)return r(l,n);n=e[l](n).value}o(a.done?"return":"normal",n)}),(function(e){r("throw",e)}))}catch(e){o("throw",e)}}function o(e,o){switch(e){case"return":t.resolve({value:o,done:!0});break;case"throw":t.reject(o);break;default:t.resolve({value:o,done:!1})}(t=t.next)?r(t.key,t.arg):n=null}this._invoke=function(e,o){return new Promise((function(a,i){var s={key:e,arg:o,resolve:a,reject:i,next:null};n?n=n.next=s:(t=n=s,r(e,o))}))},"function"!=typeof e.return&&(this.return=void 0)}Qc.prototype["function"==typeof Symbol&&Symbol.asyncIterator||"@@asyncIterator"]=function(){return this},Qc.prototype.next=function(e){return this._invoke("next",e)},Qc.prototype.throw=function(e){return this._invoke("throw",e)},Qc.prototype.return=function(e){return this._invoke("return",e)};var Yc,eu="vercel.ai.error",tu=Symbol.for(eu),nu=class e extends Error{constructor(e){let{name:t,message:n,cause:r}=e;super(n),this[Yc]=!0,this.name=t,this.cause=r}static isInstance(t){return e.hasMarker(t,eu)}static hasMarker(e,t){const n=Symbol.for(t);return null!=e&&"object"===typeof e&&n in e&&"boolean"===typeof e[n]&&!0===e[n]}};Yc=tu;var ru,ou=nu,au="AI_APICallError",iu="vercel.ai.error.".concat(au),su=Symbol.for(iu),lu=class extends ou{constructor(e){let{message:t,url:n,requestBodyValues:r,statusCode:o,responseHeaders:a,responseBody:i,cause:s,isRetryable:l=null!=o&&(408===o||409===o||429===o||o>=500),data:c}=e;super({name:au,message:t,cause:s}),this[ru]=!0,this.url=n,this.requestBodyValues=r,this.statusCode=o,this.responseHeaders=a,this.responseBody=i,this.isRetryable=l,this.data=c}static isInstance(e){return ou.hasMarker(e,iu)}};ru=su;var cu,uu="AI_EmptyResponseBodyError",du="vercel.ai.error.".concat(uu),pu=Symbol.for(du),hu=class extends ou{constructor(){let{message:e="Empty response body"}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super({name:uu,message:e}),this[cu]=!0}static isInstance(e){return ou.hasMarker(e,du)}};function fu(e){return null==e?"unknown error":"string"===typeof e?e:e instanceof Error?e.message:JSON.stringify(e)}cu=pu;var mu,gu="AI_InvalidArgumentError",_u="vercel.ai.error.".concat(gu),vu=Symbol.for(_u),yu=class extends ou{constructor(e){let{message:t,cause:n,argument:r}=e;super({name:gu,message:t,cause:n}),this[mu]=!0,this.argument=r}static isInstance(e){return ou.hasMarker(e,_u)}};mu=vu;var wu,bu="AI_InvalidPromptError",xu="vercel.ai.error.".concat(bu),ku=Symbol.for(xu),Cu=class extends ou{constructor(e){let{prompt:t,message:n,cause:r}=e;super({name:bu,message:"Invalid prompt: ".concat(n),cause:r}),this[wu]=!0,this.prompt=t}static isInstance(e){return ou.hasMarker(e,xu)}};wu=ku;var Du,Su="AI_InvalidResponseDataError",Eu="vercel.ai.error.".concat(Su),Tu=Symbol.for(Eu),Au=class extends ou{constructor(e){let{data:t,message:n="Invalid response data: ".concat(JSON.stringify(t),".")}=e;super({name:Su,message:n}),this[Du]=!0,this.data=t}static isInstance(e){return ou.hasMarker(e,Eu)}};Du=Tu;var Mu,Fu="AI_JSONParseError",Iu="vercel.ai.error.".concat(Fu),Pu=Symbol.for(Iu),zu=class extends ou{constructor(e){let{text:t,cause:n}=e;super({name:Fu,message:"JSON parsing failed: Text: ".concat(t,".\nError message: ").concat(fu(n)),cause:n}),this[Mu]=!0,this.text=t}static isInstance(e){return ou.hasMarker(e,Iu)}};Mu=Pu;var Ou,Nu="AI_LoadAPIKeyError",Bu="vercel.ai.error.".concat(Nu),ju=Symbol.for(Bu),Lu=class extends ou{constructor(e){let{message:t}=e;super({name:Nu,message:t}),this[Ou]=!0}static isInstance(e){return ou.hasMarker(e,Bu)}};Ou=ju;var Ru="AI_LoadSettingError",Vu="vercel.ai.error.".concat(Ru),qu=Symbol.for(Vu);var Uu="AI_NoContentGeneratedError",Wu="vercel.ai.error.".concat(Uu),Gu=Symbol.for(Wu);var Hu,Ku="AI_NoSuchModelError",Zu="vercel.ai.error.".concat(Ku),$u=Symbol.for(Zu),Xu=class extends ou{constructor(e){let{errorName:t=Ku,modelId:n,modelType:r,message:o="No such ".concat(r,": ").concat(n)}=e;super({name:t,message:o}),this[Hu]=!0,this.modelId=n,this.modelType=r}static isInstance(e){return ou.hasMarker(e,Zu)}};Hu=$u;var Ju,Qu="AI_TooManyEmbeddingValuesForCallError",Yu="vercel.ai.error.".concat(Qu),ed=Symbol.for(Yu),td=class extends ou{constructor(e){super({name:Qu,message:"Too many values for a single embedding call. The ".concat(e.provider,' model "').concat(e.modelId,'" can only embed up to ').concat(e.maxEmbeddingsPerCall," values per call, but ").concat(e.values.length," values were provided.")}),this[Ju]=!0,this.provider=e.provider,this.modelId=e.modelId,this.maxEmbeddingsPerCall=e.maxEmbeddingsPerCall,this.values=e.values}static isInstance(e){return ou.hasMarker(e,Yu)}};Ju=ed;var nd,rd="AI_TypeValidationError",od="vercel.ai.error.".concat(rd),ad=Symbol.for(od);nd=ad;var id,sd=class e extends ou{constructor(e){let{value:t,cause:n}=e;super({name:rd,message:"Type validation failed: Value: ".concat(JSON.stringify(t),".\nError message: ").concat(fu(n)),cause:n}),this[nd]=!0,this.value=t}static isInstance(e){return ou.hasMarker(e,od)}static wrap(t){let{value:n,cause:r}=t;return e.isInstance(r)&&r.value===n?r:new e({value:n,cause:r})}},ld="AI_UnsupportedFunctionalityError",cd="vercel.ai.error.".concat(ld),ud=Symbol.for(cd),dd=class extends ou{constructor(e){let{functionality:t,message:n="'".concat(t,"' functionality not supported.")}=e;super({name:ld,message:n}),this[id]=!0,this.functionality=t}static isInstance(e){return ou.hasMarker(e,cd)}};id=ud;class pd extends Error{constructor(e,t){super(e),this.name="ParseError",this.type=t.type,this.field=t.field,this.value=t.value,this.line=t.line}}function hd(e){}function fd(e){if("function"==typeof e)throw new TypeError("`callbacks` must be an object, got a function instead. Did you mean `{onEvent: fn}`?");const{onEvent:t=hd,onError:n=hd,onRetry:r=hd,onComment:o}=e;let a,i="",s=!0,l="",c="";function u(e){if(""===e)return l.length>0&&t({id:a,event:c||void 0,data:l.endsWith("\n")?l.slice(0,-1):l}),a=void 0,l="",void(c="");if(e.startsWith(":"))return void(o&&o(e.slice(e.startsWith(": ")?2:1)));const n=e.indexOf(":");if(-1===n)d(e,"",e);else{const t=e.slice(0,n),r=" "===e[n+1]?2:1;d(t,e.slice(n+r),e)}}function d(e,t,o){switch(e){case"event":c=t;break;case"data":l="".concat(l).concat(t,"\n");break;case"id":a=t.includes("\0")?void 0:t;break;case"retry":/^\d+$/.test(t)?r(parseInt(t,10)):n(new pd('Invalid `retry` value: "'.concat(t,'"'),{type:"invalid-retry",value:t,line:o}));break;default:n(new pd('Unknown field "'.concat(e.length>20?"".concat(e.slice(0,20),"\u2026"):e,'"'),{type:"unknown-field",field:e,value:t,line:o}))}}return{feed:function(e){const t=s?e.replace(/^\xEF\xBB\xBF/,""):e,[n,r]=function(e){const t=[];let n="",r=0;for(;r<e.length;){const o=e.indexOf("\r",r),a=e.indexOf("\n",r);let i=-1;if(-1!==o&&-1!==a?i=Math.min(o,a):-1!==o?i=o===e.length-1?-1:o:-1!==a&&(i=a),-1===i){n=e.slice(r);break}{const n=e.slice(r,i);t.push(n),r=i+1,"\r"===e[r-1]&&"\n"===e[r]&&r++}}return[t,n]}("".concat(i).concat(t));for(const o of n)u(o);i=r,s=!1},reset:function(){i&&(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).consume&&u(i),s=!0,a=void 0,l="",c="",i=""}}}class md extends TransformStream{constructor(){let e,{onError:t,onRetry:n,onComment:r}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super({start(o){e=fd({onEvent:e=>{o.enqueue(e)},onError(e){"terminate"===t?o.error(e):"function"==typeof t&&t(e)},onRetry:n,onComment:r})},transform(t){e.feed(t)}})}}Symbol("ZodOutput"),Symbol("ZodInput");class gd{constructor(){this._map=new Map,this._idmap=new Map}add(e){const t=arguments.length<=1?void 0:arguments[1];if(this._map.set(e,t),t&&"object"===typeof t&&"id"in t){if(this._idmap.has(t.id))throw new Error("ID ".concat(t.id," already exists in the registry"));this._idmap.set(t.id,e)}return this}clear(){return this._map=new Map,this._idmap=new Map,this}remove(e){const t=this._map.get(e);return t&&"object"===typeof t&&"id"in t&&this._idmap.delete(t.id),this._map.delete(e),this}get(e){const t=e._zod.parent;if(t){var n;const r=so({},null!==(n=this.get(t))&&void 0!==n?n:{});return delete r.id,so(so({},r),this._map.get(e))}return this._map.get(e)}has(e){return this._map.has(e)}}function _d(){return new gd}const vd=_d();function yd(e){const t=Object.values(e).filter((e=>"number"===typeof e)),n=Object.entries(e).filter((e=>{let[n,r]=e;return-1===t.indexOf(+n)})).map((e=>{let[t,n]=e;return n}));return n}function wd(e,t){return"bigint"===typeof t?t.toString():t}function bd(e){return{get value(){{const t=e();return Object.defineProperty(this,"value",{value:t}),t}}}}function xd(e){return null===e||void 0===e}function kd(e){const t=e.startsWith("^")?1:0,n=e.endsWith("$")?e.length-1:e.length;return e.slice(t,n)}function Cd(e,t,n){Object.defineProperty(e,t,{get(){{const r=n();return e[t]=r,r}},set(n){Object.defineProperty(e,t,{value:n})},configurable:!0})}function Dd(e,t,n){Object.defineProperty(e,t,{value:n,writable:!0,enumerable:!0,configurable:!0})}function Sd(e){return JSON.stringify(e)}const Ed=Error.captureStackTrace?Error.captureStackTrace:function(){};function Td(e){return"object"===typeof e&&null!==e&&!Array.isArray(e)}const Ad=bd((()=>{var e;if("undefined"!==typeof navigator&&null!==(e=navigator)&&void 0!==e&&null!==(e=e.userAgent)&&void 0!==e&&e.includes("Cloudflare"))return!1;try{return new Function(""),!0}catch(t){return!1}}));function Md(e){if(!1===Td(e))return!1;const t=e.constructor;if(void 0===t)return!0;const n=t.prototype;return!1!==Td(n)&&!1!==Object.prototype.hasOwnProperty.call(n,"isPrototypeOf")}const Fd=new Set(["string","number","symbol"]);new Set(["string","number","bigint","boolean","symbol","undefined"]);function Id(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function Pd(e,t,n){const r=new e._zod.constr(null!==t&&void 0!==t?t:e._zod.def);return(!t||null!==n&&void 0!==n&&n.parent)&&(r._zod.parent=e),r}function zd(e){const t=e;if(!t)return{};if("string"===typeof t)return{error:()=>t};if(void 0!==(null===t||void 0===t?void 0:t.message)){if(void 0!==(null===t||void 0===t?void 0:t.error))throw new Error("Cannot specify both `message` and `error` params");t.error=t.message}return delete t.message,"string"===typeof t.error?so(so({},t),{},{error:()=>t.error}):t}const Od={safeint:[Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],int32:[-2147483648,2147483647],uint32:[0,4294967295],float32:[-34028234663852886e22,34028234663852886e22],float64:[-Number.MAX_VALUE,Number.MAX_VALUE]};function Nd(e){for(let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;n<e.issues.length;n++){var t;if(!0!==(null===(t=e.issues[n])||void 0===t?void 0:t.continue))return!0}return!1}function Bd(e,t){return t.map((t=>{var n,r;return null!==(n=(r=t).path)&&void 0!==n||(r.path=[]),t.path.unshift(e),t}))}function jd(e){return"string"===typeof e?e:null===e||void 0===e?void 0:e.message}function Ld(e,t,n){var r;const o=so(so({},e),{},{path:null!==(r=e.path)&&void 0!==r?r:[]});if(!e.message){var a,i,s,l,c,u,d,p,h;const r=null!==(a=null!==(i=null!==(s=null!==(l=jd(null===(c=e.inst)||void 0===c||null===(c=c._zod.def)||void 0===c||null===(u=c.error)||void 0===u?void 0:u.call(c,e)))&&void 0!==l?l:jd(null===t||void 0===t||null===(d=t.error)||void 0===d?void 0:d.call(t,e)))&&void 0!==s?s:jd(null===(p=n.customError)||void 0===p?void 0:p.call(n,e)))&&void 0!==i?i:jd(null===(h=n.localeError)||void 0===h?void 0:h.call(n,e)))&&void 0!==a?a:"Invalid input";o.message=r}return delete o.inst,delete o.continue,null!==t&&void 0!==t&&t.reportInput||delete o.input,o}function Rd(e){return Array.isArray(e)?"array":"string"===typeof e?"string":"unknown"}function Vd(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const[r,o,a]=t;return"string"===typeof r?{message:r,code:"custom",input:o,inst:a}:so({},r)}class qd{constructor(e){var t,n,r,o,a;this.counter=0,this.metadataRegistry=null!==(t=null===e||void 0===e?void 0:e.metadata)&&void 0!==t?t:vd,this.target=null!==(n=null===e||void 0===e?void 0:e.target)&&void 0!==n?n:"draft-2020-12",this.unrepresentable=null!==(r=null===e||void 0===e?void 0:e.unrepresentable)&&void 0!==r?r:"throw",this.override=null!==(o=null===e||void 0===e?void 0:e.override)&&void 0!==o?o:()=>{},this.io=null!==(a=null===e||void 0===e?void 0:e.io)&&void 0!==a?a:"output",this.seen=new Map}process(e){var t,n,r;let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{path:[],schemaPath:[]};var a;const i=e._zod.def,s={guid:"uuid",url:"uri",datetime:"date-time",json_string:"json-string",regex:""},l=this.seen.get(e);if(l){l.count++;return o.schemaPath.includes(e)&&(l.cycle=o.path),l.schema}const c={schema:{},count:1,cycle:void 0,path:o.path};this.seen.set(e,c);const u=null===(t=(n=e._zod).toJSONSchema)||void 0===t?void 0:t.call(n);if(u)c.schema=u;else{const t=so(so({},o),{},{schemaPath:[...o.schemaPath,e],path:o.path}),n=e._zod.parent;if(n)c.ref=n,this.process(n,t),this.seen.get(n).isParent=!0;else{const n=c.schema;switch(i.type){case"string":{const t=n;t.type="string";const{minimum:r,maximum:o,format:a,patterns:i,contentEncoding:l}=e._zod.bag;var d;if("number"===typeof r&&(t.minLength=r),"number"===typeof o&&(t.maxLength=o),a)t.format=null!==(d=s[a])&&void 0!==d?d:a,""===t.format&&delete t.format;if(l&&(t.contentEncoding=l),i&&i.size>0){const e=[...i];1===e.length?t.pattern=e[0].source:e.length>1&&(c.schema.allOf=[...e.map((e=>so(so({},"draft-7"===this.target?{type:"string"}:{}),{},{pattern:e.source})))])}break}case"number":{const t=n,{minimum:r,maximum:o,format:a,multipleOf:i,exclusiveMaximum:s,exclusiveMinimum:l}=e._zod.bag;"string"===typeof a&&a.includes("int")?t.type="integer":t.type="number","number"===typeof l&&(t.exclusiveMinimum=l),"number"===typeof r&&(t.minimum=r,"number"===typeof l&&(l>=r?delete t.minimum:delete t.exclusiveMinimum)),"number"===typeof s&&(t.exclusiveMaximum=s),"number"===typeof o&&(t.maximum=o,"number"===typeof s&&(s<=o?delete t.maximum:delete t.exclusiveMaximum)),"number"===typeof i&&(t.multipleOf=i);break}case"boolean":n.type="boolean";break;case"bigint":if("throw"===this.unrepresentable)throw new Error("BigInt cannot be represented in JSON Schema");break;case"symbol":if("throw"===this.unrepresentable)throw new Error("Symbols cannot be represented in JSON Schema");break;case"null":n.type="null";break;case"any":case"unknown":break;case"undefined":if("throw"===this.unrepresentable)throw new Error("Undefined cannot be represented in JSON Schema");break;case"void":if("throw"===this.unrepresentable)throw new Error("Void cannot be represented in JSON Schema");break;case"never":n.not={};break;case"date":if("throw"===this.unrepresentable)throw new Error("Date cannot be represented in JSON Schema");break;case"array":{const r=n,{minimum:o,maximum:a}=e._zod.bag;"number"===typeof o&&(r.minItems=o),"number"===typeof a&&(r.maxItems=a),r.type="array",r.items=this.process(i.element,so(so({},t),{},{path:[...t.path,"items"]}));break}case"object":{var p;const e=n;e.type="object",e.properties={};const r=i.shape;for(const n in r)e.properties[n]=this.process(r[n],so(so({},t),{},{path:[...t.path,"properties",n]}));const o=new Set(Object.keys(r)),a=new Set([...o].filter((e=>{const t=i.shape[e]._zod;return"input"===this.io?void 0===t.optin:void 0===t.optout})));a.size>0&&(e.required=Array.from(a)),"never"===(null===(p=i.catchall)||void 0===p?void 0:p._zod.def.type)?e.additionalProperties=!1:i.catchall?i.catchall&&(e.additionalProperties=this.process(i.catchall,so(so({},t),{},{path:[...t.path,"additionalProperties"]}))):"output"===this.io&&(e.additionalProperties=!1);break}case"union":n.anyOf=i.options.map(((e,n)=>this.process(e,so(so({},t),{},{path:[...t.path,"anyOf",n]}))));break;case"intersection":{const e=n,r=this.process(i.left,so(so({},t),{},{path:[...t.path,"allOf",0]})),o=this.process(i.right,so(so({},t),{},{path:[...t.path,"allOf",1]})),a=e=>"allOf"in e&&1===Object.keys(e).length,s=[...a(r)?r.allOf:[r],...a(o)?o.allOf:[o]];e.allOf=s;break}case"tuple":{const r=n;r.type="array";const o=i.items.map(((e,n)=>this.process(e,so(so({},t),{},{path:[...t.path,"prefixItems",n]}))));if("draft-2020-12"===this.target?r.prefixItems=o:r.items=o,i.rest){const e=this.process(i.rest,so(so({},t),{},{path:[...t.path,"items"]}));"draft-2020-12"===this.target?r.items=e:r.additionalItems=e}i.rest&&(r.items=this.process(i.rest,so(so({},t),{},{path:[...t.path,"items"]})));const{minimum:a,maximum:s}=e._zod.bag;"number"===typeof a&&(r.minItems=a),"number"===typeof s&&(r.maxItems=s);break}case"record":{const e=n;e.type="object",e.propertyNames=this.process(i.keyType,so(so({},t),{},{path:[...t.path,"propertyNames"]})),e.additionalProperties=this.process(i.valueType,so(so({},t),{},{path:[...t.path,"additionalProperties"]}));break}case"map":if("throw"===this.unrepresentable)throw new Error("Map cannot be represented in JSON Schema");break;case"set":if("throw"===this.unrepresentable)throw new Error("Set cannot be represented in JSON Schema");break;case"enum":{const e=n,t=yd(i.entries);t.every((e=>"number"===typeof e))&&(e.type="number"),t.every((e=>"string"===typeof e))&&(e.type="string"),e.enum=t;break}case"literal":{const e=n,t=[];for(const n of i.values)if(void 0===n){if("throw"===this.unrepresentable)throw new Error("Literal `undefined` cannot be represented in JSON Schema")}else if("bigint"===typeof n){if("throw"===this.unrepresentable)throw new Error("BigInt literals cannot be represented in JSON Schema");t.push(Number(n))}else t.push(n);if(0===t.length);else if(1===t.length){const n=t[0];e.type=null===n?"null":typeof n,e.const=n}else t.every((e=>"number"===typeof e))&&(e.type="number"),t.every((e=>"string"===typeof e))&&(e.type="string"),t.every((e=>"boolean"===typeof e))&&(e.type="string"),t.every((e=>null===e))&&(e.type="null"),e.enum=t;break}case"file":{const t=n,r={type:"string",format:"binary",contentEncoding:"binary"},{minimum:o,maximum:a,mime:i}=e._zod.bag;void 0!==o&&(r.minLength=o),void 0!==a&&(r.maxLength=a),i?1===i.length?(r.contentMediaType=i[0],Object.assign(t,r)):t.anyOf=i.map((e=>so(so({},r),{},{contentMediaType:e}))):Object.assign(t,r);break}case"transform":if("throw"===this.unrepresentable)throw new Error("Transforms cannot be represented in JSON Schema");break;case"nullable":{const e=this.process(i.innerType,t);n.anyOf=[e,{type:"null"}];break}case"nonoptional":case"promise":case"optional":this.process(i.innerType,t),c.ref=i.innerType;break;case"success":n.type="boolean";break;case"default":this.process(i.innerType,t),c.ref=i.innerType,n.default=JSON.parse(JSON.stringify(i.defaultValue));break;case"prefault":this.process(i.innerType,t),c.ref=i.innerType,"input"===this.io&&(n._prefault=JSON.parse(JSON.stringify(i.defaultValue)));break;case"catch":{let e;this.process(i.innerType,t),c.ref=i.innerType;try{e=i.catchValue(void 0)}catch(f){throw new Error("Dynamic catch values are not supported in JSON Schema")}n.default=e;break}case"nan":if("throw"===this.unrepresentable)throw new Error("NaN cannot be represented in JSON Schema");break;case"template_literal":{const t=n,r=e._zod.pattern;if(!r)throw new Error("Pattern not found in template literal");t.type="string",t.pattern=r.source;break}case"pipe":{const e="input"===this.io?"transform"===i.in._zod.def.type?i.out:i.in:i.out;this.process(e,t),c.ref=e;break}case"readonly":this.process(i.innerType,t),c.ref=i.innerType,n.readOnly=!0;break;case"lazy":{const n=e._zod.innerType;this.process(n,t),c.ref=n;break}case"custom":if("throw"===this.unrepresentable)throw new Error("Custom types cannot be represented in JSON Schema")}}}const h=this.metadataRegistry.get(e);h&&Object.assign(c.schema,h),"input"===this.io&&Ud(e)&&(delete c.schema.examples,delete c.schema.default),"input"===this.io&&c.schema._prefault&&(null!==(r=(a=c.schema).default)&&void 0!==r||(a.default=c.schema._prefault)),delete c.schema._prefault;return this.seen.get(e).schema}emit(e,t){var n,r,o,a,i,s;const l={cycles:null!==(n=null===t||void 0===t?void 0:t.cycles)&&void 0!==n?n:"ref",reused:null!==(r=null===t||void 0===t?void 0:t.reused)&&void 0!==r?r:"inline",external:null!==(o=null===t||void 0===t?void 0:t.external)&&void 0!==o?o:void 0},c=this.seen.get(e);if(!c)throw new Error("Unprocessed schema. This is a bug in Zod.");const u=e=>{var t;const n="draft-2020-12"===this.target?"$defs":"definitions";if(l.external){var r,o,a,i;const t=null===(r=l.external.registry.get(e[0]))||void 0===r?void 0:r.id,s=null!==(o=l.external.uri)&&void 0!==o?o:e=>e;if(t)return{ref:s(t)};const c=null!==(a=null!==(i=e[1].defId)&&void 0!==i?i:e[1].schema.id)&&void 0!==a?a:"schema".concat(this.counter++);return e[1].defId=c,{defId:c,ref:"".concat(s("__shared"),"#/").concat(n,"/").concat(c)}}if(e[1]===c)return{ref:"#"};const s="".concat("#","/").concat(n,"/"),u=null!==(t=e[1].schema.id)&&void 0!==t?t:"__schema".concat(this.counter++);return{defId:u,ref:s+u}},d=e=>{if(e[1].schema.$ref)return;const t=e[1],{ref:n,defId:r}=u(e);t.def=so({},t.schema),r&&(t.defId=r);const o=t.schema;for(const a in o)delete o[a];o.$ref=n};if("throw"===l.cycles)for(const w of this.seen.entries()){const e=w[1];var p;if(e.cycle)throw new Error("Cycle detected: "+"#/".concat(null===(p=e.cycle)||void 0===p?void 0:p.join("/"),"/<root>")+'\n\nSet the `cycles` parameter to `"ref"` to resolve cyclical schemas with defs.')}for(const w of this.seen.entries()){var h;const t=w[1];if(e===w[0]){d(w);continue}if(l.external){var f;const t=null===(f=l.external.registry.get(w[0]))||void 0===f?void 0:f.id;if(e!==w[0]&&t){d(w);continue}}(null===(h=this.metadataRegistry.get(w[0]))||void 0===h?void 0:h.id)?d(w):(t.cycle||t.count>1&&"ref"===l.reused)&&d(w)}const m=(e,t)=>{var n,r;const o=this.seen.get(e),a=null!==(n=o.def)&&void 0!==n?n:o.schema,i=so({},a);if(null===o.ref)return;const s=o.ref;if(o.ref=null,s){m(s,t);const e=this.seen.get(s).schema;var l;if(e.$ref&&"draft-7"===t.target)a.allOf=null!==(l=a.allOf)&&void 0!==l?l:[],a.allOf.push(e);else Object.assign(a,e),Object.assign(a,i)}o.isParent||this.override({zodSchema:e,jsonSchema:a,path:null!==(r=o.path)&&void 0!==r?r:[]})};for(const w of[...this.seen.entries()].reverse())m(w[0],{target:this.target});const g={};if("draft-2020-12"===this.target?g.$schema="https://json-schema.org/draft/2020-12/schema":"draft-7"===this.target?g.$schema="http://json-schema.org/draft-07/schema#":console.warn("Invalid target: ".concat(this.target)),null!==(a=l.external)&&void 0!==a&&a.uri){var _;const t=null===(_=l.external.registry.get(e))||void 0===_?void 0:_.id;if(!t)throw new Error("Schema is missing an `id` property");g.$id=l.external.uri(t)}Object.assign(g,c.def);const v=null!==(i=null===(s=l.external)||void 0===s?void 0:s.defs)&&void 0!==i?i:{};for(const w of this.seen.entries()){const e=w[1];e.def&&e.defId&&(v[e.defId]=e.def)}l.external||Object.keys(v).length>0&&("draft-2020-12"===this.target?g.$defs=v:g.definitions=v);try{return JSON.parse(JSON.stringify(g))}catch(y){throw new Error("Error converting schema to JSON.")}}}function Ud(e,t){const n=null!==t&&void 0!==t?t:{seen:new Set};if(n.seen.has(e))return!1;n.seen.add(e);const r=e._zod.def;switch(r.type){case"string":case"number":case"bigint":case"boolean":case"date":case"symbol":case"undefined":case"null":case"any":case"unknown":case"never":case"void":case"literal":case"enum":case"nan":case"file":case"template_literal":case"custom":case"success":case"catch":return!1;case"array":return Ud(r.element,n);case"object":for(const e in r.shape)if(Ud(r.shape[e],n))return!0;return!1;case"union":for(const e of r.options)if(Ud(e,n))return!0;return!1;case"intersection":return Ud(r.left,n)||Ud(r.right,n);case"tuple":for(const e of r.items)if(Ud(e,n))return!0;return!(!r.rest||!Ud(r.rest,n));case"record":case"map":return Ud(r.keyType,n)||Ud(r.valueType,n);case"set":return Ud(r.valueType,n);case"promise":case"optional":case"nonoptional":case"nullable":case"readonly":case"default":case"prefault":return Ud(r.innerType,n);case"lazy":return Ud(r.getter(),n);case"transform":return!0;case"pipe":return Ud(r.in,n)||Ud(r.out,n)}throw new Error("Unknown schema type: ".concat(r.type))}Object.freeze({status:"aborted"});function Wd(e,t,n){var r;function o(n,r){var o,a,i;Object.defineProperty(n,"_zod",{value:null!==(o=n._zod)&&void 0!==o?o:{},enumerable:!1}),null!==(a=(i=n._zod).traits)&&void 0!==a||(i.traits=new Set),n._zod.traits.add(e),t(n,r);for(const e in s.prototype)e in n||Object.defineProperty(n,e,{value:s.prototype[e].bind(n)});n._zod.constr=s,n._zod.def=r}const a=null!==(r=null===n||void 0===n?void 0:n.Parent)&&void 0!==r?r:Object;class i extends a{}function s(e){var t,r;const a=null!==n&&void 0!==n&&n.Parent?new i:this;o(a,e),null!==(t=(r=a._zod).deferred)&&void 0!==t||(r.deferred=[]);for(const n of a._zod.deferred)n();return a}return Object.defineProperty(i,"name",{value:e}),Object.defineProperty(s,"init",{value:o}),Object.defineProperty(s,Symbol.hasInstance,{value:t=>{var r;return!!(null!==n&&void 0!==n&&n.Parent&&t instanceof n.Parent)||(null===t||void 0===t||null===(r=t._zod)||void 0===r||null===(r=r.traits)||void 0===r?void 0:r.has(e))}}),Object.defineProperty(s,"name",{value:e}),s}Symbol("zod_brand");class Gd extends Error{constructor(){super("Encountered Promise during synchronous parse. Use .parseAsync() instead.")}}const Hd={};function Kd(e){return e&&Object.assign(Hd,e),Hd}const Zd=(e,t)=>{e.name="$ZodError",Object.defineProperty(e,"_zod",{value:e._zod,enumerable:!1}),Object.defineProperty(e,"issues",{value:t,enumerable:!1}),Object.defineProperty(e,"message",{get:()=>JSON.stringify(t,wd,2),enumerable:!0}),Object.defineProperty(e,"toString",{value:()=>e.message,enumerable:!1})},$d=Wd("$ZodError",Zd),Xd=Wd("$ZodError",Zd,{Parent:Error});const Jd=e=>(t,n,r,o)=>{const a=r?Object.assign(r,{async:!1}):{async:!1},i=t._zod.run({value:n,issues:[]},a);if(i instanceof Promise)throw new Gd;if(i.issues.length){var s;const t=new(null!==(s=null===o||void 0===o?void 0:o.Err)&&void 0!==s?s:e)(i.issues.map((e=>Ld(e,a,Kd()))));throw Ed(t,null===o||void 0===o?void 0:o.callee),t}return i.value},Qd=e=>async(t,n,r,o)=>{const a=r?Object.assign(r,{async:!0}):{async:!0};let i=t._zod.run({value:n,issues:[]},a);if(i instanceof Promise&&(i=await i),i.issues.length){var s;const t=new(null!==(s=null===o||void 0===o?void 0:o.Err)&&void 0!==s?s:e)(i.issues.map((e=>Ld(e,a,Kd()))));throw Ed(t,null===o||void 0===o?void 0:o.callee),t}return i.value},Yd=e=>(t,n,r)=>{const o=r?so(so({},r),{},{async:!1}):{async:!1},a=t._zod.run({value:n,issues:[]},o);if(a instanceof Promise)throw new Gd;return a.issues.length?{success:!1,error:new(null!==e&&void 0!==e?e:$d)(a.issues.map((e=>Ld(e,o,Kd()))))}:{success:!0,data:a.value}},ep=Yd(Xd),tp=e=>async(t,n,r)=>{const o=r?Object.assign(r,{async:!0}):{async:!0};let a=t._zod.run({value:n,issues:[]},o);return a instanceof Promise&&(a=await a),a.issues.length?{success:!1,error:new e(a.issues.map((e=>Ld(e,o,Kd()))))}:{success:!0,data:a.value}},np=tp(Xd),rp=(e,t)=>{$d.init(e,t),e.name="ZodError",Object.defineProperties(e,{format:{value:t=>function(e,t){const n=t||function(e){return e.message},r={_errors:[]},o=e=>{for(const t of e.issues)if("invalid_union"===t.code&&t.errors.length)t.errors.map((e=>o({issues:e})));else if("invalid_key"===t.code)o({issues:t.issues});else if("invalid_element"===t.code)o({issues:t.issues});else if(0===t.path.length)r._errors.push(n(t));else{let e=r,o=0;for(;o<t.path.length;){const r=t.path[o];o===t.path.length-1?(e[r]=e[r]||{_errors:[]},e[r]._errors.push(n(t))):e[r]=e[r]||{_errors:[]},e=e[r],o++}}};return o(e),r}(e,t)},flatten:{value:t=>function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e=>e.message;const n={},r=[];for(const o of e.issues)o.path.length>0?(n[o.path[0]]=n[o.path[0]]||[],n[o.path[0]].push(t(o))):r.push(t(o));return{formErrors:r,fieldErrors:n}}(e,t)},addIssue:{value:t=>e.issues.push(t)},addIssues:{value:t=>e.issues.push(...t)},isEmpty:{get:()=>0===e.issues.length}})},op=(Wd("ZodError",rp),Wd("ZodError",rp,{Parent:Error})),ap=Jd(op),ip=Qd(op),sp=Yd(op),lp=tp(op);var cp,up;!function(e){e.assertEqual=e=>{},e.assertIs=function(e){},e.assertNever=function(e){throw new Error},e.arrayToEnum=e=>{const t={};for(const n of e)t[n]=n;return t},e.getValidEnumValues=t=>{const n=e.objectKeys(t).filter((e=>"number"!==typeof t[t[e]])),r={};for(const e of n)r[e]=t[e];return e.objectValues(r)},e.objectValues=t=>e.objectKeys(t).map((function(e){return t[e]})),e.objectKeys="function"===typeof Object.keys?e=>Object.keys(e):e=>{const t=[];for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.push(n);return t},e.find=(e,t)=>{for(const n of e)if(t(n))return n},e.isInteger="function"===typeof Number.isInteger?e=>Number.isInteger(e):e=>"number"===typeof e&&Number.isFinite(e)&&Math.floor(e)===e,e.joinValues=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:" | ";return e.map((e=>"string"===typeof e?"'".concat(e,"'"):e)).join(t)},e.jsonStringifyReplacer=(e,t)=>"bigint"===typeof t?t.toString():t}(cp||(cp={})),function(e){e.mergeShapes=(e,t)=>so(so({},e),t)}(up||(up={}));const dp=cp.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),pp=e=>{switch(typeof e){case"undefined":return dp.undefined;case"string":return dp.string;case"number":return Number.isNaN(e)?dp.nan:dp.number;case"boolean":return dp.boolean;case"function":return dp.function;case"bigint":return dp.bigint;case"symbol":return dp.symbol;case"object":return Array.isArray(e)?dp.array:null===e?dp.null:e.then&&"function"===typeof e.then&&e.catch&&"function"===typeof e.catch?dp.promise:"undefined"!==typeof Map&&e instanceof Map?dp.map:"undefined"!==typeof Set&&e instanceof Set?dp.set:"undefined"!==typeof Date&&e instanceof Date?dp.date:dp.object;default:return dp.unknown}},hp=cp.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class fp extends Error{get errors(){return this.issues}constructor(e){var t;super(),t=this,this.issues=[],this.addIssue=e=>{this.issues=[...this.issues,e]},this.addIssues=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];t.issues=[...t.issues,...e]};const n=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,n):this.__proto__=n,this.name="ZodError",this.issues=e}format(e){const t=e||function(e){return e.message},n={_errors:[]},r=e=>{for(const o of e.issues)if("invalid_union"===o.code)o.unionErrors.map(r);else if("invalid_return_type"===o.code)r(o.returnTypeError);else if("invalid_arguments"===o.code)r(o.argumentsError);else if(0===o.path.length)n._errors.push(t(o));else{let e=n,r=0;for(;r<o.path.length;){const n=o.path[r];r===o.path.length-1?(e[n]=e[n]||{_errors:[]},e[n]._errors.push(t(o))):e[n]=e[n]||{_errors:[]},e=e[n],r++}}};return r(this),n}static assert(e){if(!(e instanceof fp))throw new Error("Not a ZodError: ".concat(e))}toString(){return this.message}get message(){return JSON.stringify(this.issues,cp.jsonStringifyReplacer,2)}get isEmpty(){return 0===this.issues.length}flatten(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e=>e.message;const t={},n=[];for(const r of this.issues)if(r.path.length>0){const n=r.path[0];t[n]=t[n]||[],t[n].push(e(r))}else n.push(e(r));return{formErrors:n,fieldErrors:t}}get formErrors(){return this.flatten()}}fp.create=e=>new fp(e);const mp=(e,t)=>{let n;switch(e.code){case hp.invalid_type:n=e.received===dp.undefined?"Required":"Expected ".concat(e.expected,", received ").concat(e.received);break;case hp.invalid_literal:n="Invalid literal value, expected ".concat(JSON.stringify(e.expected,cp.jsonStringifyReplacer));break;case hp.unrecognized_keys:n="Unrecognized key(s) in object: ".concat(cp.joinValues(e.keys,", "));break;case hp.invalid_union:n="Invalid input";break;case hp.invalid_union_discriminator:n="Invalid discriminator value. Expected ".concat(cp.joinValues(e.options));break;case hp.invalid_enum_value:n="Invalid enum value. Expected ".concat(cp.joinValues(e.options),", received '").concat(e.received,"'");break;case hp.invalid_arguments:n="Invalid function arguments";break;case hp.invalid_return_type:n="Invalid function return type";break;case hp.invalid_date:n="Invalid date";break;case hp.invalid_string:"object"===typeof e.validation?"includes"in e.validation?(n='Invalid input: must include "'.concat(e.validation.includes,'"'),"number"===typeof e.validation.position&&(n="".concat(n," at one or more positions greater than or equal to ").concat(e.validation.position))):"startsWith"in e.validation?n='Invalid input: must start with "'.concat(e.validation.startsWith,'"'):"endsWith"in e.validation?n='Invalid input: must end with "'.concat(e.validation.endsWith,'"'):cp.assertNever(e.validation):n="regex"!==e.validation?"Invalid ".concat(e.validation):"Invalid";break;case hp.too_small:n="array"===e.type?"Array must contain ".concat(e.exact?"exactly":e.inclusive?"at least":"more than"," ").concat(e.minimum," element(s)"):"string"===e.type?"String must contain ".concat(e.exact?"exactly":e.inclusive?"at least":"over"," ").concat(e.minimum," character(s)"):"number"===e.type||"bigint"===e.type?"Number must be ".concat(e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than ").concat(e.minimum):"date"===e.type?"Date must be ".concat(e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than ").concat(new Date(Number(e.minimum))):"Invalid input";break;case hp.too_big:n="array"===e.type?"Array must contain ".concat(e.exact?"exactly":e.inclusive?"at most":"less than"," ").concat(e.maximum," element(s)"):"string"===e.type?"String must contain ".concat(e.exact?"exactly":e.inclusive?"at most":"under"," ").concat(e.maximum," character(s)"):"number"===e.type?"Number must be ".concat(e.exact?"exactly":e.inclusive?"less than or equal to":"less than"," ").concat(e.maximum):"bigint"===e.type?"BigInt must be ".concat(e.exact?"exactly":e.inclusive?"less than or equal to":"less than"," ").concat(e.maximum):"date"===e.type?"Date must be ".concat(e.exact?"exactly":e.inclusive?"smaller than or equal to":"smaller than"," ").concat(new Date(Number(e.maximum))):"Invalid input";break;case hp.custom:n="Invalid input";break;case hp.invalid_intersection_types:n="Intersection results could not be merged";break;case hp.not_multiple_of:n="Number must be a multiple of ".concat(e.multipleOf);break;case hp.not_finite:n="Number must be finite";break;default:n=t.defaultError,cp.assertNever(e)}return{message:n}};let gp=mp;function _p(){return gp}var vp;!function(e){e.errToObj=e=>"string"===typeof e?{message:e}:e||{},e.toString=e=>"string"===typeof e?e:null===e||void 0===e?void 0:e.message}(vp||(vp={}));const yp=e=>{const{data:t,path:n,errorMaps:r,issueData:o}=e,a=[...n,...o.path||[]],i=so(so({},o),{},{path:a});if(void 0!==o.message)return so(so({},o),{},{path:a,message:o.message});let s="";const l=r.filter((e=>!!e)).slice().reverse();for(const c of l)s=c(i,{data:t,defaultError:s}).message;return so(so({},o),{},{path:a,message:s})};function wp(e,t){const n=_p(),r=yp({issueData:t,data:e.data,path:e.path,errorMaps:[e.common.contextualErrorMap,e.schemaErrorMap,n,n===mp?void 0:mp].filter((e=>!!e))});e.common.issues.push(r)}class bp{constructor(){this.value="valid"}dirty(){"valid"===this.value&&(this.value="dirty")}abort(){"aborted"!==this.value&&(this.value="aborted")}static mergeArray(e,t){const n=[];for(const r of t){if("aborted"===r.status)return xp;"dirty"===r.status&&e.dirty(),n.push(r.value)}return{status:e.value,value:n}}static async mergeObjectAsync(e,t){const n=[];for(const r of t){const e=await r.key,t=await r.value;n.push({key:e,value:t})}return bp.mergeObjectSync(e,n)}static mergeObjectSync(e,t){const n={};for(const r of t){const{key:t,value:o}=r;if("aborted"===t.status)return xp;if("aborted"===o.status)return xp;"dirty"===t.status&&e.dirty(),"dirty"===o.status&&e.dirty(),"__proto__"===t.value||"undefined"===typeof o.value&&!r.alwaysSet||(n[t.value]=o.value)}return{status:e.value,value:n}}}const xp=Object.freeze({status:"aborted"}),kp=e=>({status:"dirty",value:e}),Cp=e=>({status:"valid",value:e}),Dp=e=>"aborted"===e.status,Sp=e=>"dirty"===e.status,Ep=e=>"valid"===e.status,Tp=e=>"undefined"!==typeof Promise&&e instanceof Promise;class Ap{constructor(e,t,n,r){this._cachedPath=[],this.parent=e,this.data=t,this._path=n,this._key=r}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const Mp=(e,t)=>{if(Ep(t))return{success:!0,data:t.value};if(!e.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const t=new fp(e.common.issues);return this._error=t,this._error}}};function Fp(e){if(!e)return{};const{errorMap:t,invalid_type_error:n,required_error:r,description:o}=e;if(t&&(n||r))throw new Error('Can\'t use "invalid_type_error" or "required_error" in conjunction with custom error map.');if(t)return{errorMap:t,description:o};return{errorMap:(t,o)=>{var a;const{message:i}=e;return"invalid_enum_value"===t.code?{message:null!==i&&void 0!==i?i:o.defaultError}:"undefined"===typeof o.data?{message:null!==(s=null!==i&&void 0!==i?i:r)&&void 0!==s?s:o.defaultError}:"invalid_type"!==t.code?{message:o.defaultError}:{message:null!==(a=null!==i&&void 0!==i?i:n)&&void 0!==a?a:o.defaultError};var s},description:o}}class Ip{get description(){return this._def.description}_getType(e){return pp(e.data)}_getOrReturnCtx(e,t){return t||{common:e.parent.common,data:e.data,parsedType:pp(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new bp,ctx:{common:e.parent.common,data:e.data,parsedType:pp(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const t=this._parse(e);if(Tp(t))throw new Error("Synchronous parse encountered promise.");return t}_parseAsync(e){const t=this._parse(e);return Promise.resolve(t)}parse(e,t){const n=this.safeParse(e,t);if(n.success)return n.data;throw n.error}safeParse(e,t){var n;const r={common:{issues:[],async:null!==(n=null===t||void 0===t?void 0:t.async)&&void 0!==n&&n,contextualErrorMap:null===t||void 0===t?void 0:t.errorMap},path:(null===t||void 0===t?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:pp(e)},o=this._parseSync({data:e,path:r.path,parent:r});return Mp(r,o)}"~validate"(e){const t={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:pp(e)};if(!this["~standard"].async)try{const n=this._parseSync({data:e,path:[],parent:t});return Ep(n)?{value:n.value}:{issues:t.common.issues}}catch(r){var n;null!==r&&void 0!==r&&null!==(n=r.message)&&void 0!==n&&null!==(n=n.toLowerCase())&&void 0!==n&&n.includes("encountered")&&(this["~standard"].async=!0),t.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:t}).then((e=>Ep(e)?{value:e.value}:{issues:t.common.issues}))}async parseAsync(e,t){const n=await this.safeParseAsync(e,t);if(n.success)return n.data;throw n.error}async safeParseAsync(e,t){const n={common:{issues:[],contextualErrorMap:null===t||void 0===t?void 0:t.errorMap,async:!0},path:(null===t||void 0===t?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:pp(e)},r=this._parse({data:e,path:n.path,parent:n}),o=await(Tp(r)?r:Promise.resolve(r));return Mp(n,o)}refine(e,t){return this._refinement(((n,r)=>{const o=e(n),a=()=>r.addIssue(so({code:hp.custom},(e=>"string"===typeof t||"undefined"===typeof t?{message:t}:"function"===typeof t?t(e):t)(n)));return"undefined"!==typeof Promise&&o instanceof Promise?o.then((e=>!!e||(a(),!1))):!!o||(a(),!1)}))}refinement(e,t){return this._refinement(((n,r)=>!!e(n)||(r.addIssue("function"===typeof t?t(n,r):t),!1)))}_refinement(e){return new Ah({schema:this,typeName:jh.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:e=>this["~validate"](e)}}optional(){return Mh.create(this,this._def)}nullable(){return Fh.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return fh.create(this)}promise(){return Th.create(this,this._def)}or(e){return _h.create([this,e],this._def)}and(e){return yh.create(this,e,this._def)}transform(e){return new Ah(so(so({},Fp(this._def)),{},{schema:this,typeName:jh.ZodEffects,effect:{type:"transform",transform:e}}))}default(e){const t="function"===typeof e?e:()=>e;return new Ih(so(so({},Fp(this._def)),{},{innerType:this,defaultValue:t,typeName:jh.ZodDefault}))}brand(){return new Oh(so({typeName:jh.ZodBranded,type:this},Fp(this._def)))}catch(e){const t="function"===typeof e?e:()=>e;return new Ph(so(so({},Fp(this._def)),{},{innerType:this,catchValue:t,typeName:jh.ZodCatch}))}describe(e){return new(0,this.constructor)(so(so({},this._def),{},{description:e}))}pipe(e){return Nh.create(this,e)}readonly(){return Bh.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const Pp=/^c[^\s-]{8,}$/i,zp=/^[0-9a-z]+$/,Op=/^[0-9A-HJKMNP-TV-Z]{26}$/i,Np=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,Bp=/^[a-z0-9_-]{21}$/i,jp=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,Lp=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,Rp=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i;let Vp;const qp=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,Up=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,Wp=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,Gp=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,Hp=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,Kp=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,Zp="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",$p=new RegExp("^".concat(Zp,"$"));function Xp(e){let t="[0-5]\\d";e.precision?t="".concat(t,"\\.\\d{").concat(e.precision,"}"):null==e.precision&&(t="".concat(t,"(\\.\\d+)?"));const n=e.precision?"+":"?";return"([01]\\d|2[0-3]):[0-5]\\d(:".concat(t,")").concat(n)}function Jp(e){let t="".concat(Zp,"T").concat(Xp(e));const n=[];return n.push(e.local?"Z?":"Z"),e.offset&&n.push("([+-]\\d{2}:?\\d{2})"),t="".concat(t,"(").concat(n.join("|"),")"),new RegExp("^".concat(t,"$"))}function Qp(e,t){return!("v4"!==t&&t||!qp.test(e))||!("v6"!==t&&t||!Wp.test(e))}function Yp(e,t){if(!jp.test(e))return!1;try{const[n]=e.split(".");if(!n)return!1;const r=n.replace(/-/g,"+").replace(/_/g,"/").padEnd(n.length+(4-n.length%4)%4,"="),o=JSON.parse(atob(r));return"object"===typeof o&&null!==o&&((!("typ"in o)||"JWT"===(null===o||void 0===o?void 0:o.typ))&&(!!o.alg&&(!t||o.alg===t)))}catch(n){return!1}}function eh(e,t){return!("v4"!==t&&t||!Up.test(e))||!("v6"!==t&&t||!Gp.test(e))}class th extends Ip{_parse(e){this._def.coerce&&(e.data=String(e.data));if(this._getType(e)!==dp.string){const t=this._getOrReturnCtx(e);return wp(t,{code:hp.invalid_type,expected:dp.string,received:t.parsedType}),xp}const t=new bp;let n;for(const o of this._def.checks)if("min"===o.kind)e.data.length<o.value&&(n=this._getOrReturnCtx(e,n),wp(n,{code:hp.too_small,minimum:o.value,type:"string",inclusive:!0,exact:!1,message:o.message}),t.dirty());else if("max"===o.kind)e.data.length>o.value&&(n=this._getOrReturnCtx(e,n),wp(n,{code:hp.too_big,maximum:o.value,type:"string",inclusive:!0,exact:!1,message:o.message}),t.dirty());else if("length"===o.kind){const r=e.data.length>o.value,a=e.data.length<o.value;(r||a)&&(n=this._getOrReturnCtx(e,n),r?wp(n,{code:hp.too_big,maximum:o.value,type:"string",inclusive:!0,exact:!0,message:o.message}):a&&wp(n,{code:hp.too_small,minimum:o.value,type:"string",inclusive:!0,exact:!0,message:o.message}),t.dirty())}else if("email"===o.kind)Rp.test(e.data)||(n=this._getOrReturnCtx(e,n),wp(n,{validation:"email",code:hp.invalid_string,message:o.message}),t.dirty());else if("emoji"===o.kind)Vp||(Vp=new RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),Vp.test(e.data)||(n=this._getOrReturnCtx(e,n),wp(n,{validation:"emoji",code:hp.invalid_string,message:o.message}),t.dirty());else if("uuid"===o.kind)Np.test(e.data)||(n=this._getOrReturnCtx(e,n),wp(n,{validation:"uuid",code:hp.invalid_string,message:o.message}),t.dirty());else if("nanoid"===o.kind)Bp.test(e.data)||(n=this._getOrReturnCtx(e,n),wp(n,{validation:"nanoid",code:hp.invalid_string,message:o.message}),t.dirty());else if("cuid"===o.kind)Pp.test(e.data)||(n=this._getOrReturnCtx(e,n),wp(n,{validation:"cuid",code:hp.invalid_string,message:o.message}),t.dirty());else if("cuid2"===o.kind)zp.test(e.data)||(n=this._getOrReturnCtx(e,n),wp(n,{validation:"cuid2",code:hp.invalid_string,message:o.message}),t.dirty());else if("ulid"===o.kind)Op.test(e.data)||(n=this._getOrReturnCtx(e,n),wp(n,{validation:"ulid",code:hp.invalid_string,message:o.message}),t.dirty());else if("url"===o.kind)try{new URL(e.data)}catch(r){n=this._getOrReturnCtx(e,n),wp(n,{validation:"url",code:hp.invalid_string,message:o.message}),t.dirty()}else if("regex"===o.kind){o.regex.lastIndex=0;o.regex.test(e.data)||(n=this._getOrReturnCtx(e,n),wp(n,{validation:"regex",code:hp.invalid_string,message:o.message}),t.dirty())}else if("trim"===o.kind)e.data=e.data.trim();else if("includes"===o.kind)e.data.includes(o.value,o.position)||(n=this._getOrReturnCtx(e,n),wp(n,{code:hp.invalid_string,validation:{includes:o.value,position:o.position},message:o.message}),t.dirty());else if("toLowerCase"===o.kind)e.data=e.data.toLowerCase();else if("toUpperCase"===o.kind)e.data=e.data.toUpperCase();else if("startsWith"===o.kind)e.data.startsWith(o.value)||(n=this._getOrReturnCtx(e,n),wp(n,{code:hp.invalid_string,validation:{startsWith:o.value},message:o.message}),t.dirty());else if("endsWith"===o.kind)e.data.endsWith(o.value)||(n=this._getOrReturnCtx(e,n),wp(n,{code:hp.invalid_string,validation:{endsWith:o.value},message:o.message}),t.dirty());else if("datetime"===o.kind){Jp(o).test(e.data)||(n=this._getOrReturnCtx(e,n),wp(n,{code:hp.invalid_string,validation:"datetime",message:o.message}),t.dirty())}else if("date"===o.kind){$p.test(e.data)||(n=this._getOrReturnCtx(e,n),wp(n,{code:hp.invalid_string,validation:"date",message:o.message}),t.dirty())}else if("time"===o.kind){new RegExp("^".concat(Xp(o),"$")).test(e.data)||(n=this._getOrReturnCtx(e,n),wp(n,{code:hp.invalid_string,validation:"time",message:o.message}),t.dirty())}else"duration"===o.kind?Lp.test(e.data)||(n=this._getOrReturnCtx(e,n),wp(n,{validation:"duration",code:hp.invalid_string,message:o.message}),t.dirty()):"ip"===o.kind?Qp(e.data,o.version)||(n=this._getOrReturnCtx(e,n),wp(n,{validation:"ip",code:hp.invalid_string,message:o.message}),t.dirty()):"jwt"===o.kind?Yp(e.data,o.alg)||(n=this._getOrReturnCtx(e,n),wp(n,{validation:"jwt",code:hp.invalid_string,message:o.message}),t.dirty()):"cidr"===o.kind?eh(e.data,o.version)||(n=this._getOrReturnCtx(e,n),wp(n,{validation:"cidr",code:hp.invalid_string,message:o.message}),t.dirty()):"base64"===o.kind?Hp.test(e.data)||(n=this._getOrReturnCtx(e,n),wp(n,{validation:"base64",code:hp.invalid_string,message:o.message}),t.dirty()):"base64url"===o.kind?Kp.test(e.data)||(n=this._getOrReturnCtx(e,n),wp(n,{validation:"base64url",code:hp.invalid_string,message:o.message}),t.dirty()):cp.assertNever(o);return{status:t.value,value:e.data}}_regex(e,t,n){return this.refinement((t=>e.test(t)),so({validation:t,code:hp.invalid_string},vp.errToObj(n)))}_addCheck(e){return new th(so(so({},this._def),{},{checks:[...this._def.checks,e]}))}email(e){return this._addCheck(so({kind:"email"},vp.errToObj(e)))}url(e){return this._addCheck(so({kind:"url"},vp.errToObj(e)))}emoji(e){return this._addCheck(so({kind:"emoji"},vp.errToObj(e)))}uuid(e){return this._addCheck(so({kind:"uuid"},vp.errToObj(e)))}nanoid(e){return this._addCheck(so({kind:"nanoid"},vp.errToObj(e)))}cuid(e){return this._addCheck(so({kind:"cuid"},vp.errToObj(e)))}cuid2(e){return this._addCheck(so({kind:"cuid2"},vp.errToObj(e)))}ulid(e){return this._addCheck(so({kind:"ulid"},vp.errToObj(e)))}base64(e){return this._addCheck(so({kind:"base64"},vp.errToObj(e)))}base64url(e){return this._addCheck(so({kind:"base64url"},vp.errToObj(e)))}jwt(e){return this._addCheck(so({kind:"jwt"},vp.errToObj(e)))}ip(e){return this._addCheck(so({kind:"ip"},vp.errToObj(e)))}cidr(e){return this._addCheck(so({kind:"cidr"},vp.errToObj(e)))}datetime(e){var t,n;return"string"===typeof e?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck(so({kind:"datetime",precision:"undefined"===typeof(null===e||void 0===e?void 0:e.precision)?null:null===e||void 0===e?void 0:e.precision,offset:null!==(t=null===e||void 0===e?void 0:e.offset)&&void 0!==t&&t,local:null!==(n=null===e||void 0===e?void 0:e.local)&&void 0!==n&&n},vp.errToObj(null===e||void 0===e?void 0:e.message)))}date(e){return this._addCheck({kind:"date",message:e})}time(e){return"string"===typeof e?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck(so({kind:"time",precision:"undefined"===typeof(null===e||void 0===e?void 0:e.precision)?null:null===e||void 0===e?void 0:e.precision},vp.errToObj(null===e||void 0===e?void 0:e.message)))}duration(e){return this._addCheck(so({kind:"duration"},vp.errToObj(e)))}regex(e,t){return this._addCheck(so({kind:"regex",regex:e},vp.errToObj(t)))}includes(e,t){return this._addCheck(so({kind:"includes",value:e,position:null===t||void 0===t?void 0:t.position},vp.errToObj(null===t||void 0===t?void 0:t.message)))}startsWith(e,t){return this._addCheck(so({kind:"startsWith",value:e},vp.errToObj(t)))}endsWith(e,t){return this._addCheck(so({kind:"endsWith",value:e},vp.errToObj(t)))}min(e,t){return this._addCheck(so({kind:"min",value:e},vp.errToObj(t)))}max(e,t){return this._addCheck(so({kind:"max",value:e},vp.errToObj(t)))}length(e,t){return this._addCheck(so({kind:"length",value:e},vp.errToObj(t)))}nonempty(e){return this.min(1,vp.errToObj(e))}trim(){return new th(so(so({},this._def),{},{checks:[...this._def.checks,{kind:"trim"}]}))}toLowerCase(){return new th(so(so({},this._def),{},{checks:[...this._def.checks,{kind:"toLowerCase"}]}))}toUpperCase(){return new th(so(so({},this._def),{},{checks:[...this._def.checks,{kind:"toUpperCase"}]}))}get isDatetime(){return!!this._def.checks.find((e=>"datetime"===e.kind))}get isDate(){return!!this._def.checks.find((e=>"date"===e.kind))}get isTime(){return!!this._def.checks.find((e=>"time"===e.kind))}get isDuration(){return!!this._def.checks.find((e=>"duration"===e.kind))}get isEmail(){return!!this._def.checks.find((e=>"email"===e.kind))}get isURL(){return!!this._def.checks.find((e=>"url"===e.kind))}get isEmoji(){return!!this._def.checks.find((e=>"emoji"===e.kind))}get isUUID(){return!!this._def.checks.find((e=>"uuid"===e.kind))}get isNANOID(){return!!this._def.checks.find((e=>"nanoid"===e.kind))}get isCUID(){return!!this._def.checks.find((e=>"cuid"===e.kind))}get isCUID2(){return!!this._def.checks.find((e=>"cuid2"===e.kind))}get isULID(){return!!this._def.checks.find((e=>"ulid"===e.kind))}get isIP(){return!!this._def.checks.find((e=>"ip"===e.kind))}get isCIDR(){return!!this._def.checks.find((e=>"cidr"===e.kind))}get isBase64(){return!!this._def.checks.find((e=>"base64"===e.kind))}get isBase64url(){return!!this._def.checks.find((e=>"base64url"===e.kind))}get minLength(){let e=null;for(const t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxLength(){let e=null;for(const t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}}function nh(e,t){const n=(e.toString().split(".")[1]||"").length,r=(t.toString().split(".")[1]||"").length,o=n>r?n:r;return Number.parseInt(e.toFixed(o).replace(".",""))%Number.parseInt(t.toFixed(o).replace(".",""))/10**o}th.create=e=>{var t;return new th(so({checks:[],typeName:jh.ZodString,coerce:null!==(t=null===e||void 0===e?void 0:e.coerce)&&void 0!==t&&t},Fp(e)))};class rh extends Ip{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){this._def.coerce&&(e.data=Number(e.data));if(this._getType(e)!==dp.number){const t=this._getOrReturnCtx(e);return wp(t,{code:hp.invalid_type,expected:dp.number,received:t.parsedType}),xp}let t;const n=new bp;for(const r of this._def.checks)if("int"===r.kind)cp.isInteger(e.data)||(t=this._getOrReturnCtx(e,t),wp(t,{code:hp.invalid_type,expected:"integer",received:"float",message:r.message}),n.dirty());else if("min"===r.kind){(r.inclusive?e.data<r.value:e.data<=r.value)&&(t=this._getOrReturnCtx(e,t),wp(t,{code:hp.too_small,minimum:r.value,type:"number",inclusive:r.inclusive,exact:!1,message:r.message}),n.dirty())}else if("max"===r.kind){(r.inclusive?e.data>r.value:e.data>=r.value)&&(t=this._getOrReturnCtx(e,t),wp(t,{code:hp.too_big,maximum:r.value,type:"number",inclusive:r.inclusive,exact:!1,message:r.message}),n.dirty())}else"multipleOf"===r.kind?0!==nh(e.data,r.value)&&(t=this._getOrReturnCtx(e,t),wp(t,{code:hp.not_multiple_of,multipleOf:r.value,message:r.message}),n.dirty()):"finite"===r.kind?Number.isFinite(e.data)||(t=this._getOrReturnCtx(e,t),wp(t,{code:hp.not_finite,message:r.message}),n.dirty()):cp.assertNever(r);return{status:n.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,vp.toString(t))}gt(e,t){return this.setLimit("min",e,!1,vp.toString(t))}lte(e,t){return this.setLimit("max",e,!0,vp.toString(t))}lt(e,t){return this.setLimit("max",e,!1,vp.toString(t))}setLimit(e,t,n,r){return new rh(so(so({},this._def),{},{checks:[...this._def.checks,{kind:e,value:t,inclusive:n,message:vp.toString(r)}]}))}_addCheck(e){return new rh(so(so({},this._def),{},{checks:[...this._def.checks,e]}))}int(e){return this._addCheck({kind:"int",message:vp.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:vp.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:vp.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:vp.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:vp.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:vp.toString(t)})}finite(e){return this._addCheck({kind:"finite",message:vp.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:vp.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:vp.toString(e)})}get minValue(){let e=null;for(const t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}get isInt(){return!!this._def.checks.find((e=>"int"===e.kind||"multipleOf"===e.kind&&cp.isInteger(e.value)))}get isFinite(){let e=null,t=null;for(const n of this._def.checks){if("finite"===n.kind||"int"===n.kind||"multipleOf"===n.kind)return!0;"min"===n.kind?(null===t||n.value>t)&&(t=n.value):"max"===n.kind&&(null===e||n.value<e)&&(e=n.value)}return Number.isFinite(t)&&Number.isFinite(e)}}rh.create=e=>new rh(so({checks:[],typeName:jh.ZodNumber,coerce:(null===e||void 0===e?void 0:e.coerce)||!1},Fp(e)));class oh extends Ip{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce)try{e.data=BigInt(e.data)}catch(r){return this._getInvalidInput(e)}if(this._getType(e)!==dp.bigint)return this._getInvalidInput(e);let t;const n=new bp;for(const o of this._def.checks)if("min"===o.kind){(o.inclusive?e.data<o.value:e.data<=o.value)&&(t=this._getOrReturnCtx(e,t),wp(t,{code:hp.too_small,type:"bigint",minimum:o.value,inclusive:o.inclusive,message:o.message}),n.dirty())}else if("max"===o.kind){(o.inclusive?e.data>o.value:e.data>=o.value)&&(t=this._getOrReturnCtx(e,t),wp(t,{code:hp.too_big,type:"bigint",maximum:o.value,inclusive:o.inclusive,message:o.message}),n.dirty())}else"multipleOf"===o.kind?e.data%o.value!==BigInt(0)&&(t=this._getOrReturnCtx(e,t),wp(t,{code:hp.not_multiple_of,multipleOf:o.value,message:o.message}),n.dirty()):cp.assertNever(o);return{status:n.value,value:e.data}}_getInvalidInput(e){const t=this._getOrReturnCtx(e);return wp(t,{code:hp.invalid_type,expected:dp.bigint,received:t.parsedType}),xp}gte(e,t){return this.setLimit("min",e,!0,vp.toString(t))}gt(e,t){return this.setLimit("min",e,!1,vp.toString(t))}lte(e,t){return this.setLimit("max",e,!0,vp.toString(t))}lt(e,t){return this.setLimit("max",e,!1,vp.toString(t))}setLimit(e,t,n,r){return new oh(so(so({},this._def),{},{checks:[...this._def.checks,{kind:e,value:t,inclusive:n,message:vp.toString(r)}]}))}_addCheck(e){return new oh(so(so({},this._def),{},{checks:[...this._def.checks,e]}))}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:vp.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:vp.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:vp.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:vp.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:vp.toString(t)})}get minValue(){let e=null;for(const t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}}oh.create=e=>{var t;return new oh(so({checks:[],typeName:jh.ZodBigInt,coerce:null!==(t=null===e||void 0===e?void 0:e.coerce)&&void 0!==t&&t},Fp(e)))};class ah extends Ip{_parse(e){this._def.coerce&&(e.data=Boolean(e.data));if(this._getType(e)!==dp.boolean){const t=this._getOrReturnCtx(e);return wp(t,{code:hp.invalid_type,expected:dp.boolean,received:t.parsedType}),xp}return Cp(e.data)}}ah.create=e=>new ah(so({typeName:jh.ZodBoolean,coerce:(null===e||void 0===e?void 0:e.coerce)||!1},Fp(e)));class ih extends Ip{_parse(e){this._def.coerce&&(e.data=new Date(e.data));if(this._getType(e)!==dp.date){const t=this._getOrReturnCtx(e);return wp(t,{code:hp.invalid_type,expected:dp.date,received:t.parsedType}),xp}if(Number.isNaN(e.data.getTime())){return wp(this._getOrReturnCtx(e),{code:hp.invalid_date}),xp}const t=new bp;let n;for(const r of this._def.checks)"min"===r.kind?e.data.getTime()<r.value&&(n=this._getOrReturnCtx(e,n),wp(n,{code:hp.too_small,message:r.message,inclusive:!0,exact:!1,minimum:r.value,type:"date"}),t.dirty()):"max"===r.kind?e.data.getTime()>r.value&&(n=this._getOrReturnCtx(e,n),wp(n,{code:hp.too_big,message:r.message,inclusive:!0,exact:!1,maximum:r.value,type:"date"}),t.dirty()):cp.assertNever(r);return{status:t.value,value:new Date(e.data.getTime())}}_addCheck(e){return new ih(so(so({},this._def),{},{checks:[...this._def.checks,e]}))}min(e,t){return this._addCheck({kind:"min",value:e.getTime(),message:vp.toString(t)})}max(e,t){return this._addCheck({kind:"max",value:e.getTime(),message:vp.toString(t)})}get minDate(){let e=null;for(const t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return null!=e?new Date(e):null}get maxDate(){let e=null;for(const t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return null!=e?new Date(e):null}}ih.create=e=>new ih(so({checks:[],coerce:(null===e||void 0===e?void 0:e.coerce)||!1,typeName:jh.ZodDate},Fp(e)));class sh extends Ip{_parse(e){if(this._getType(e)!==dp.symbol){const t=this._getOrReturnCtx(e);return wp(t,{code:hp.invalid_type,expected:dp.symbol,received:t.parsedType}),xp}return Cp(e.data)}}sh.create=e=>new sh(so({typeName:jh.ZodSymbol},Fp(e)));class lh extends Ip{_parse(e){if(this._getType(e)!==dp.undefined){const t=this._getOrReturnCtx(e);return wp(t,{code:hp.invalid_type,expected:dp.undefined,received:t.parsedType}),xp}return Cp(e.data)}}lh.create=e=>new lh(so({typeName:jh.ZodUndefined},Fp(e)));class ch extends Ip{_parse(e){if(this._getType(e)!==dp.null){const t=this._getOrReturnCtx(e);return wp(t,{code:hp.invalid_type,expected:dp.null,received:t.parsedType}),xp}return Cp(e.data)}}ch.create=e=>new ch(so({typeName:jh.ZodNull},Fp(e)));class uh extends Ip{constructor(){super(...arguments),this._any=!0}_parse(e){return Cp(e.data)}}uh.create=e=>new uh(so({typeName:jh.ZodAny},Fp(e)));class dh extends Ip{constructor(){super(...arguments),this._unknown=!0}_parse(e){return Cp(e.data)}}dh.create=e=>new dh(so({typeName:jh.ZodUnknown},Fp(e)));class ph extends Ip{_parse(e){const t=this._getOrReturnCtx(e);return wp(t,{code:hp.invalid_type,expected:dp.never,received:t.parsedType}),xp}}ph.create=e=>new ph(so({typeName:jh.ZodNever},Fp(e)));class hh extends Ip{_parse(e){if(this._getType(e)!==dp.undefined){const t=this._getOrReturnCtx(e);return wp(t,{code:hp.invalid_type,expected:dp.void,received:t.parsedType}),xp}return Cp(e.data)}}hh.create=e=>new hh(so({typeName:jh.ZodVoid},Fp(e)));class fh extends Ip{_parse(e){const{ctx:t,status:n}=this._processInputParams(e),r=this._def;if(t.parsedType!==dp.array)return wp(t,{code:hp.invalid_type,expected:dp.array,received:t.parsedType}),xp;if(null!==r.exactLength){const e=t.data.length>r.exactLength.value,o=t.data.length<r.exactLength.value;(e||o)&&(wp(t,{code:e?hp.too_big:hp.too_small,minimum:o?r.exactLength.value:void 0,maximum:e?r.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:r.exactLength.message}),n.dirty())}if(null!==r.minLength&&t.data.length<r.minLength.value&&(wp(t,{code:hp.too_small,minimum:r.minLength.value,type:"array",inclusive:!0,exact:!1,message:r.minLength.message}),n.dirty()),null!==r.maxLength&&t.data.length>r.maxLength.value&&(wp(t,{code:hp.too_big,maximum:r.maxLength.value,type:"array",inclusive:!0,exact:!1,message:r.maxLength.message}),n.dirty()),t.common.async)return Promise.all([...t.data].map(((e,n)=>r.type._parseAsync(new Ap(t,e,t.path,n))))).then((e=>bp.mergeArray(n,e)));const o=[...t.data].map(((e,n)=>r.type._parseSync(new Ap(t,e,t.path,n))));return bp.mergeArray(n,o)}get element(){return this._def.type}min(e,t){return new fh(so(so({},this._def),{},{minLength:{value:e,message:vp.toString(t)}}))}max(e,t){return new fh(so(so({},this._def),{},{maxLength:{value:e,message:vp.toString(t)}}))}length(e,t){return new fh(so(so({},this._def),{},{exactLength:{value:e,message:vp.toString(t)}}))}nonempty(e){return this.min(1,e)}}function mh(e){if(e instanceof gh){const t={};for(const n in e.shape){const r=e.shape[n];t[n]=Mh.create(mh(r))}return new gh(so(so({},e._def),{},{shape:()=>t}))}return e instanceof fh?new fh(so(so({},e._def),{},{type:mh(e.element)})):e instanceof Mh?Mh.create(mh(e.unwrap())):e instanceof Fh?Fh.create(mh(e.unwrap())):e instanceof wh?wh.create(e.items.map((e=>mh(e)))):e}fh.create=(e,t)=>new fh(so({type:e,minLength:null,maxLength:null,exactLength:null,typeName:jh.ZodArray},Fp(t)));class gh extends Ip{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(null!==this._cached)return this._cached;const e=this._def.shape(),t=cp.objectKeys(e);return this._cached={shape:e,keys:t},this._cached}_parse(e){if(this._getType(e)!==dp.object){const t=this._getOrReturnCtx(e);return wp(t,{code:hp.invalid_type,expected:dp.object,received:t.parsedType}),xp}const{status:t,ctx:n}=this._processInputParams(e),{shape:r,keys:o}=this._getCached(),a=[];if(!(this._def.catchall instanceof ph&&"strip"===this._def.unknownKeys))for(const s in n.data)o.includes(s)||a.push(s);const i=[];for(const s of o){const e=r[s],t=n.data[s];i.push({key:{status:"valid",value:s},value:e._parse(new Ap(n,t,n.path,s)),alwaysSet:s in n.data})}if(this._def.catchall instanceof ph){const e=this._def.unknownKeys;if("passthrough"===e)for(const t of a)i.push({key:{status:"valid",value:t},value:{status:"valid",value:n.data[t]}});else if("strict"===e)a.length>0&&(wp(n,{code:hp.unrecognized_keys,keys:a}),t.dirty());else if("strip"!==e)throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const e=this._def.catchall;for(const t of a){const r=n.data[t];i.push({key:{status:"valid",value:t},value:e._parse(new Ap(n,r,n.path,t)),alwaysSet:t in n.data})}}return n.common.async?Promise.resolve().then((async()=>{const e=[];for(const t of i){const n=await t.key,r=await t.value;e.push({key:n,value:r,alwaysSet:t.alwaysSet})}return e})).then((e=>bp.mergeObjectSync(t,e))):bp.mergeObjectSync(t,i)}get shape(){return this._def.shape()}strict(e){return vp.errToObj,new gh(so(so({},this._def),{},{unknownKeys:"strict"},void 0!==e?{errorMap:(t,n)=>{var r,o,a,i;const s=null!==(r=null===(o=(a=this._def).errorMap)||void 0===o?void 0:o.call(a,t,n).message)&&void 0!==r?r:n.defaultError;return"unrecognized_keys"===t.code?{message:null!==(i=vp.errToObj(e).message)&&void 0!==i?i:s}:{message:s}}}:{}))}strip(){return new gh(so(so({},this._def),{},{unknownKeys:"strip"}))}passthrough(){return new gh(so(so({},this._def),{},{unknownKeys:"passthrough"}))}extend(e){return new gh(so(so({},this._def),{},{shape:()=>so(so({},this._def.shape()),e)}))}merge(e){return new gh({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>so(so({},this._def.shape()),e._def.shape()),typeName:jh.ZodObject})}setKey(e,t){return this.augment({[e]:t})}catchall(e){return new gh(so(so({},this._def),{},{catchall:e}))}pick(e){const t={};for(const n of cp.objectKeys(e))e[n]&&this.shape[n]&&(t[n]=this.shape[n]);return new gh(so(so({},this._def),{},{shape:()=>t}))}omit(e){const t={};for(const n of cp.objectKeys(this.shape))e[n]||(t[n]=this.shape[n]);return new gh(so(so({},this._def),{},{shape:()=>t}))}deepPartial(){return mh(this)}partial(e){const t={};for(const n of cp.objectKeys(this.shape)){const r=this.shape[n];e&&!e[n]?t[n]=r:t[n]=r.optional()}return new gh(so(so({},this._def),{},{shape:()=>t}))}required(e){const t={};for(const n of cp.objectKeys(this.shape))if(e&&!e[n])t[n]=this.shape[n];else{let e=this.shape[n];for(;e instanceof Mh;)e=e._def.innerType;t[n]=e}return new gh(so(so({},this._def),{},{shape:()=>t}))}keyof(){return Dh(cp.objectKeys(this.shape))}}gh.create=(e,t)=>new gh(so({shape:()=>e,unknownKeys:"strip",catchall:ph.create(),typeName:jh.ZodObject},Fp(t))),gh.strictCreate=(e,t)=>new gh(so({shape:()=>e,unknownKeys:"strict",catchall:ph.create(),typeName:jh.ZodObject},Fp(t))),gh.lazycreate=(e,t)=>new gh(so({shape:e,unknownKeys:"strip",catchall:ph.create(),typeName:jh.ZodObject},Fp(t)));class _h extends Ip{_parse(e){const{ctx:t}=this._processInputParams(e),n=this._def.options;if(t.common.async)return Promise.all(n.map((async e=>{const n=so(so({},t),{},{common:so(so({},t.common),{},{issues:[]}),parent:null});return{result:await e._parseAsync({data:t.data,path:t.path,parent:n}),ctx:n}}))).then((function(e){for(const t of e)if("valid"===t.result.status)return t.result;for(const r of e)if("dirty"===r.result.status)return t.common.issues.push(...r.ctx.common.issues),r.result;const n=e.map((e=>new fp(e.ctx.common.issues)));return wp(t,{code:hp.invalid_union,unionErrors:n}),xp}));{let e;const r=[];for(const a of n){const n=so(so({},t),{},{common:so(so({},t.common),{},{issues:[]}),parent:null}),o=a._parseSync({data:t.data,path:t.path,parent:n});if("valid"===o.status)return o;"dirty"!==o.status||e||(e={result:o,ctx:n}),n.common.issues.length&&r.push(n.common.issues)}if(e)return t.common.issues.push(...e.ctx.common.issues),e.result;const o=r.map((e=>new fp(e)));return wp(t,{code:hp.invalid_union,unionErrors:o}),xp}}get options(){return this._def.options}}_h.create=(e,t)=>new _h(so({options:e,typeName:jh.ZodUnion},Fp(t)));function vh(e,t){const n=pp(e),r=pp(t);if(e===t)return{valid:!0,data:e};if(n===dp.object&&r===dp.object){const n=cp.objectKeys(t),r=cp.objectKeys(e).filter((e=>-1!==n.indexOf(e))),o=so(so({},e),t);for(const a of r){const n=vh(e[a],t[a]);if(!n.valid)return{valid:!1};o[a]=n.data}return{valid:!0,data:o}}if(n===dp.array&&r===dp.array){if(e.length!==t.length)return{valid:!1};const n=[];for(let r=0;r<e.length;r++){const o=vh(e[r],t[r]);if(!o.valid)return{valid:!1};n.push(o.data)}return{valid:!0,data:n}}return n===dp.date&&r===dp.date&&+e===+t?{valid:!0,data:e}:{valid:!1}}class yh extends Ip{_parse(e){const{status:t,ctx:n}=this._processInputParams(e),r=(e,r)=>{if(Dp(e)||Dp(r))return xp;const o=vh(e.value,r.value);return o.valid?((Sp(e)||Sp(r))&&t.dirty(),{status:t.value,value:o.data}):(wp(n,{code:hp.invalid_intersection_types}),xp)};return n.common.async?Promise.all([this._def.left._parseAsync({data:n.data,path:n.path,parent:n}),this._def.right._parseAsync({data:n.data,path:n.path,parent:n})]).then((e=>{let[t,n]=e;return r(t,n)})):r(this._def.left._parseSync({data:n.data,path:n.path,parent:n}),this._def.right._parseSync({data:n.data,path:n.path,parent:n}))}}yh.create=(e,t,n)=>new yh(so({left:e,right:t,typeName:jh.ZodIntersection},Fp(n)));class wh extends Ip{_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==dp.array)return wp(n,{code:hp.invalid_type,expected:dp.array,received:n.parsedType}),xp;if(n.data.length<this._def.items.length)return wp(n,{code:hp.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),xp;!this._def.rest&&n.data.length>this._def.items.length&&(wp(n,{code:hp.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),t.dirty());const r=[...n.data].map(((e,t)=>{const r=this._def.items[t]||this._def.rest;return r?r._parse(new Ap(n,e,n.path,t)):null})).filter((e=>!!e));return n.common.async?Promise.all(r).then((e=>bp.mergeArray(t,e))):bp.mergeArray(t,r)}get items(){return this._def.items}rest(e){return new wh(so(so({},this._def),{},{rest:e}))}}wh.create=(e,t)=>{if(!Array.isArray(e))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new wh(so({items:e,typeName:jh.ZodTuple,rest:null},Fp(t)))};class bh extends Ip{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==dp.map)return wp(n,{code:hp.invalid_type,expected:dp.map,received:n.parsedType}),xp;const r=this._def.keyType,o=this._def.valueType,a=[...n.data.entries()].map(((e,t)=>{let[a,i]=e;return{key:r._parse(new Ap(n,a,n.path,[t,"key"])),value:o._parse(new Ap(n,i,n.path,[t,"value"]))}}));if(n.common.async){const e=new Map;return Promise.resolve().then((async()=>{for(const n of a){const r=await n.key,o=await n.value;if("aborted"===r.status||"aborted"===o.status)return xp;"dirty"!==r.status&&"dirty"!==o.status||t.dirty(),e.set(r.value,o.value)}return{status:t.value,value:e}}))}{const e=new Map;for(const n of a){const r=n.key,o=n.value;if("aborted"===r.status||"aborted"===o.status)return xp;"dirty"!==r.status&&"dirty"!==o.status||t.dirty(),e.set(r.value,o.value)}return{status:t.value,value:e}}}}bh.create=(e,t,n)=>new bh(so({valueType:t,keyType:e,typeName:jh.ZodMap},Fp(n)));class xh extends Ip{_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==dp.set)return wp(n,{code:hp.invalid_type,expected:dp.set,received:n.parsedType}),xp;const r=this._def;null!==r.minSize&&n.data.size<r.minSize.value&&(wp(n,{code:hp.too_small,minimum:r.minSize.value,type:"set",inclusive:!0,exact:!1,message:r.minSize.message}),t.dirty()),null!==r.maxSize&&n.data.size>r.maxSize.value&&(wp(n,{code:hp.too_big,maximum:r.maxSize.value,type:"set",inclusive:!0,exact:!1,message:r.maxSize.message}),t.dirty());const o=this._def.valueType;function a(e){const n=new Set;for(const r of e){if("aborted"===r.status)return xp;"dirty"===r.status&&t.dirty(),n.add(r.value)}return{status:t.value,value:n}}const i=[...n.data.values()].map(((e,t)=>o._parse(new Ap(n,e,n.path,t))));return n.common.async?Promise.all(i).then((e=>a(e))):a(i)}min(e,t){return new xh(so(so({},this._def),{},{minSize:{value:e,message:vp.toString(t)}}))}max(e,t){return new xh(so(so({},this._def),{},{maxSize:{value:e,message:vp.toString(t)}}))}size(e,t){return this.min(e,t).max(e,t)}nonempty(e){return this.min(1,e)}}xh.create=(e,t)=>new xh(so({valueType:e,minSize:null,maxSize:null,typeName:jh.ZodSet},Fp(t)));class kh extends Ip{get schema(){return this._def.getter()}_parse(e){const{ctx:t}=this._processInputParams(e);return this._def.getter()._parse({data:t.data,path:t.path,parent:t})}}kh.create=(e,t)=>new kh(so({getter:e,typeName:jh.ZodLazy},Fp(t)));class Ch extends Ip{_parse(e){if(e.data!==this._def.value){const t=this._getOrReturnCtx(e);return wp(t,{received:t.data,code:hp.invalid_literal,expected:this._def.value}),xp}return{status:"valid",value:e.data}}get value(){return this._def.value}}function Dh(e,t){return new Sh(so({values:e,typeName:jh.ZodEnum},Fp(t)))}Ch.create=(e,t)=>new Ch(so({value:e,typeName:jh.ZodLiteral},Fp(t)));class Sh extends Ip{_parse(e){if("string"!==typeof e.data){const t=this._getOrReturnCtx(e),n=this._def.values;return wp(t,{expected:cp.joinValues(n),received:t.parsedType,code:hp.invalid_type}),xp}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(e.data)){const t=this._getOrReturnCtx(e),n=this._def.values;return wp(t,{received:t.data,code:hp.invalid_enum_value,options:n}),xp}return Cp(e.data)}get options(){return this._def.values}get enum(){const e={};for(const t of this._def.values)e[t]=t;return e}get Values(){const e={};for(const t of this._def.values)e[t]=t;return e}get Enum(){const e={};for(const t of this._def.values)e[t]=t;return e}extract(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._def;return Sh.create(e,so(so({},this._def),t))}exclude(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._def;return Sh.create(this.options.filter((t=>!e.includes(t))),so(so({},this._def),t))}}Sh.create=Dh;class Eh extends Ip{_parse(e){const t=cp.getValidEnumValues(this._def.values),n=this._getOrReturnCtx(e);if(n.parsedType!==dp.string&&n.parsedType!==dp.number){const e=cp.objectValues(t);return wp(n,{expected:cp.joinValues(e),received:n.parsedType,code:hp.invalid_type}),xp}if(this._cache||(this._cache=new Set(cp.getValidEnumValues(this._def.values))),!this._cache.has(e.data)){const e=cp.objectValues(t);return wp(n,{received:n.data,code:hp.invalid_enum_value,options:e}),xp}return Cp(e.data)}get enum(){return this._def.values}}Eh.create=(e,t)=>new Eh(so({values:e,typeName:jh.ZodNativeEnum},Fp(t)));class Th extends Ip{unwrap(){return this._def.type}_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==dp.promise&&!1===t.common.async)return wp(t,{code:hp.invalid_type,expected:dp.promise,received:t.parsedType}),xp;const n=t.parsedType===dp.promise?t.data:Promise.resolve(t.data);return Cp(n.then((e=>this._def.type.parseAsync(e,{path:t.path,errorMap:t.common.contextualErrorMap}))))}}Th.create=(e,t)=>new Th(so({type:e,typeName:jh.ZodPromise},Fp(t)));class Ah extends Ip{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===jh.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:t,ctx:n}=this._processInputParams(e),r=this._def.effect||null,o={addIssue:e=>{wp(n,e),e.fatal?t.abort():t.dirty()},get path(){return n.path}};if(o.addIssue=o.addIssue.bind(o),"preprocess"===r.type){const e=r.transform(n.data,o);if(n.common.async)return Promise.resolve(e).then((async e=>{if("aborted"===t.value)return xp;const r=await this._def.schema._parseAsync({data:e,path:n.path,parent:n});return"aborted"===r.status?xp:"dirty"===r.status||"dirty"===t.value?kp(r.value):r}));{if("aborted"===t.value)return xp;const r=this._def.schema._parseSync({data:e,path:n.path,parent:n});return"aborted"===r.status?xp:"dirty"===r.status||"dirty"===t.value?kp(r.value):r}}if("refinement"===r.type){const e=e=>{const t=r.refinement(e,o);if(n.common.async)return Promise.resolve(t);if(t instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return e};if(!1===n.common.async){const r=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});return"aborted"===r.status?xp:("dirty"===r.status&&t.dirty(),e(r.value),{status:t.value,value:r.value})}return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then((n=>"aborted"===n.status?xp:("dirty"===n.status&&t.dirty(),e(n.value).then((()=>({status:t.value,value:n.value}))))))}if("transform"===r.type){if(!1===n.common.async){const e=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});if(!Ep(e))return xp;const a=r.transform(e.value,o);if(a instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:t.value,value:a}}return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then((e=>Ep(e)?Promise.resolve(r.transform(e.value,o)).then((e=>({status:t.value,value:e}))):xp))}cp.assertNever(r)}}Ah.create=(e,t,n)=>new Ah(so({schema:e,typeName:jh.ZodEffects,effect:t},Fp(n))),Ah.createWithPreprocess=(e,t,n)=>new Ah(so({schema:t,effect:{type:"preprocess",transform:e},typeName:jh.ZodEffects},Fp(n)));class Mh extends Ip{_parse(e){return this._getType(e)===dp.undefined?Cp(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}Mh.create=(e,t)=>new Mh(so({innerType:e,typeName:jh.ZodOptional},Fp(t)));class Fh extends Ip{_parse(e){return this._getType(e)===dp.null?Cp(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}Fh.create=(e,t)=>new Fh(so({innerType:e,typeName:jh.ZodNullable},Fp(t)));class Ih extends Ip{_parse(e){const{ctx:t}=this._processInputParams(e);let n=t.data;return t.parsedType===dp.undefined&&(n=this._def.defaultValue()),this._def.innerType._parse({data:n,path:t.path,parent:t})}removeDefault(){return this._def.innerType}}Ih.create=(e,t)=>new Ih(so({innerType:e,typeName:jh.ZodDefault,defaultValue:"function"===typeof t.default?t.default:()=>t.default},Fp(t)));class Ph extends Ip{_parse(e){const{ctx:t}=this._processInputParams(e),n=so(so({},t),{},{common:so(so({},t.common),{},{issues:[]})}),r=this._def.innerType._parse({data:n.data,path:n.path,parent:so({},n)});return Tp(r)?r.then((e=>({status:"valid",value:"valid"===e.status?e.value:this._def.catchValue({get error(){return new fp(n.common.issues)},input:n.data})}))):{status:"valid",value:"valid"===r.status?r.value:this._def.catchValue({get error(){return new fp(n.common.issues)},input:n.data})}}removeCatch(){return this._def.innerType}}Ph.create=(e,t)=>new Ph(so({innerType:e,typeName:jh.ZodCatch,catchValue:"function"===typeof t.catch?t.catch:()=>t.catch},Fp(t)));class zh extends Ip{_parse(e){if(this._getType(e)!==dp.nan){const t=this._getOrReturnCtx(e);return wp(t,{code:hp.invalid_type,expected:dp.nan,received:t.parsedType}),xp}return{status:"valid",value:e.data}}}zh.create=e=>new zh(so({typeName:jh.ZodNaN},Fp(e)));Symbol("zod_brand");class Oh extends Ip{_parse(e){const{ctx:t}=this._processInputParams(e),n=t.data;return this._def.type._parse({data:n,path:t.path,parent:t})}unwrap(){return this._def.type}}class Nh extends Ip{_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.common.async){return(async()=>{const e=await this._def.in._parseAsync({data:n.data,path:n.path,parent:n});return"aborted"===e.status?xp:"dirty"===e.status?(t.dirty(),kp(e.value)):this._def.out._parseAsync({data:e.value,path:n.path,parent:n})})()}{const e=this._def.in._parseSync({data:n.data,path:n.path,parent:n});return"aborted"===e.status?xp:"dirty"===e.status?(t.dirty(),{status:"dirty",value:e.value}):this._def.out._parseSync({data:e.value,path:n.path,parent:n})}}static create(e,t){return new Nh({in:e,out:t,typeName:jh.ZodPipeline})}}class Bh extends Ip{_parse(e){const t=this._def.innerType._parse(e),n=e=>(Ep(e)&&(e.value=Object.freeze(e.value)),e);return Tp(t)?t.then((e=>n(e))):n(t)}unwrap(){return this._def.innerType}}Bh.create=(e,t)=>new Bh(so({innerType:e,typeName:jh.ZodReadonly},Fp(t)));gh.lazycreate;var jh;!function(e){e.ZodString="ZodString",e.ZodNumber="ZodNumber",e.ZodNaN="ZodNaN",e.ZodBigInt="ZodBigInt",e.ZodBoolean="ZodBoolean",e.ZodDate="ZodDate",e.ZodSymbol="ZodSymbol",e.ZodUndefined="ZodUndefined",e.ZodNull="ZodNull",e.ZodAny="ZodAny",e.ZodUnknown="ZodUnknown",e.ZodNever="ZodNever",e.ZodVoid="ZodVoid",e.ZodArray="ZodArray",e.ZodObject="ZodObject",e.ZodUnion="ZodUnion",e.ZodDiscriminatedUnion="ZodDiscriminatedUnion",e.ZodIntersection="ZodIntersection",e.ZodTuple="ZodTuple",e.ZodRecord="ZodRecord",e.ZodMap="ZodMap",e.ZodSet="ZodSet",e.ZodFunction="ZodFunction",e.ZodLazy="ZodLazy",e.ZodLiteral="ZodLiteral",e.ZodEnum="ZodEnum",e.ZodEffects="ZodEffects",e.ZodNativeEnum="ZodNativeEnum",e.ZodOptional="ZodOptional",e.ZodNullable="ZodNullable",e.ZodDefault="ZodDefault",e.ZodCatch="ZodCatch",e.ZodPromise="ZodPromise",e.ZodBranded="ZodBranded",e.ZodPipeline="ZodPipeline",e.ZodReadonly="ZodReadonly"}(jh||(jh={}));th.create,rh.create,zh.create,oh.create,ah.create,ih.create,sh.create,lh.create,ch.create,uh.create,dh.create,ph.create,hh.create,fh.create,gh.create,gh.strictCreate,_h.create,yh.create,wh.create,bh.create,xh.create,kh.create,Ch.create,Sh.create,Eh.create,Th.create,Ah.create,Mh.create,Fh.create,Ah.createWithPreprocess,Nh.create;const Lh=["execute","outputSchema","toModelOutput","onInputStart","onInputDelta","onInputAvailable"],Rh=["execute","toModelOutput","onInputStart","onInputDelta","onInputAvailable"],Vh=["additionalProperties"],qh=["type"],Uh=["type"];function Wh(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.reduce(((e,t)=>so(so({},e),null!=t?t:{})),{})}function Gh(){return new DOMException("Delay was aborted","AbortError")}function Hh(e){return Object.fromEntries([...e.headers])}var Kh=function(){let{prefix:e,size:t=16,alphabet:n="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",separator:r="-"}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const o=()=>{const e=n.length,r=new Array(t);for(let o=0;o<t;o++)r[o]=n[Math.random()*e|0];return r.join("")};if(null==e)return o;if(n.includes(r))throw new yu({argument:"separator",message:'The separator "'.concat(r,'" must not be part of the alphabet "').concat(n,'".')});return()=>"".concat(e).concat(r).concat(o())},Zh=Kh();function $h(e){return null==e?"unknown error":"string"===typeof e?e:e instanceof Error?e.message:JSON.stringify(e)}function Xh(e){return(e instanceof Error||e instanceof DOMException)&&("AbortError"===e.name||"ResponseAborted"===e.name||"TimeoutError"===e.name)}var Jh=["fetch failed","failed to fetch"];function Qh(e){let{error:t,url:n,requestBodyValues:r}=e;if(Xh(t))return t;if(t instanceof TypeError&&Jh.includes(t.message.toLowerCase())){const e=t.cause;if(null!=e)return new lu({message:"Cannot connect to API: ".concat(e.message),cause:e,url:n,requestBodyValues:r,isRetryable:!0})}return t}function Yh(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:globalThis;var t,n,r;return e.window?"runtime/browser":(null==(t=e.navigator)?void 0:t.userAgent)?"runtime/".concat(e.navigator.userAgent.toLowerCase()):(null==(r=null==(n=e.process)?void 0:n.versions)?void 0:r.node)?"runtime/node.js/".concat(e.process.version.substring(0)):e.EdgeRuntime?"runtime/vercel-edge":"runtime/unknown"}function ef(e){const t=function(e){return Object.fromEntries(Object.entries(e).filter((e=>{let[t,n]=e;return null!=n})))}(null!=e?e:{}),n=new Headers(t),r=n.get("user-agent")||"";for(var o=arguments.length,a=new Array(o>1?o-1:0),i=1;i<o;i++)a[i-1]=arguments[i];return n.set("user-agent",[r,...a].filter(Boolean).join(" ")),Object.fromEntries(n)}var tf="3.0.12",nf=()=>globalThis.fetch,rf=async e=>{let{url:t,headers:n={},successfulResponseHandler:r,failedResponseHandler:o,abortSignal:a,fetch:i=nf()}=e;try{const e=await i(t,{method:"GET",headers:ef(n,"ai-sdk/provider-utils/".concat(tf),Yh()),signal:a}),l=Hh(e);if(!e.ok){let n;try{n=await o({response:e,url:t,requestBodyValues:{}})}catch(s){if(Xh(s)||lu.isInstance(s))throw s;throw new lu({message:"Failed to process error response",cause:s,statusCode:e.status,url:t,responseHeaders:l,requestBodyValues:{}})}throw n.value}try{return await r({response:e,url:t,requestBodyValues:{}})}catch(s){if(s instanceof Error&&(Xh(s)||lu.isInstance(s)))throw s;throw new lu({message:"Failed to process successful response",cause:s,statusCode:e.status,url:t,responseHeaders:l,requestBodyValues:{}})}}catch(s){throw Qh({error:s,url:t,requestBodyValues:{}})}};function of(e){let{mediaType:t,url:n,supportedUrls:r}=e;return n=n.toLowerCase(),t=t.toLowerCase(),Object.entries(r).map((e=>{let[t,n]=e;const r=t.toLowerCase();return"*"===r||"*/*"===r?{mediaTypePrefix:"",regexes:n}:{mediaTypePrefix:r.replace(/\*/,""),regexes:n}})).filter((e=>{let{mediaTypePrefix:n}=e;return t.startsWith(n)})).flatMap((e=>{let{regexes:t}=e;return t})).some((e=>e.test(n)))}function af(e){let{apiKey:t,environmentVariableName:n,apiKeyParameterName:r="apiKey",description:o}=e;if("string"===typeof t)return t;if(null!=t)throw new Lu({message:"".concat(o," API key must be a string.")});if("undefined"===typeof process)throw new Lu({message:"".concat(o," API key is missing. Pass it using the '").concat(r,"' parameter. Environment variables is not supported in this environment.")});if(t={NODE_ENV:"production",PUBLIC_URL:"/llm-consistency-vis",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}[n],null==t)throw new Lu({message:"".concat(o," API key is missing. Pass it using the '").concat(r,"' parameter or the ").concat(n," environment variable.")});if("string"!==typeof t)throw new Lu({message:"".concat(o," API key must be a string. The value of the ").concat(n," environment variable is not a string.")});return t}function sf(e){let{settingValue:t,environmentVariableName:n}=e;return"string"===typeof t||null==t&&"undefined"!==typeof process&&(t={NODE_ENV:"production",PUBLIC_URL:"/llm-consistency-vis",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}[n],null!=t&&"string"===typeof t)?t:void 0}var lf=/"__proto__"\s*:/,cf=/"constructor"\s*:/;function uf(e){const t=JSON.parse(e);return null===t||"object"!==typeof t||!1===lf.test(e)&&!1===cf.test(e)?t:function(e){let t=[e];for(;t.length;){const e=t;t=[];for(const n of e){if(Object.prototype.hasOwnProperty.call(n,"__proto__"))throw new SyntaxError("Object contains forbidden prototype property");if(Object.prototype.hasOwnProperty.call(n,"constructor")&&Object.prototype.hasOwnProperty.call(n.constructor,"prototype"))throw new SyntaxError("Object contains forbidden prototype property");for(const e in n){const r=n[e];r&&"object"===typeof r&&t.push(r)}}}return e}(t)}function df(e){const{stackTraceLimit:t}=Error;Error.stackTraceLimit=0;try{return uf(e)}finally{Error.stackTraceLimit=t}}var pf=Symbol.for("vercel.ai.validator");function hf(e){let t;return()=>(null==t&&(t=e()),t)}function ff(e){return function(e){return"object"===typeof e&&null!==e&&pf in e&&!0===e[pf]&&"validate"in e}(e)?e:"function"===typeof e?e():function(e){return t=async t=>{const n=await e["~standard"].validate(t);return null==n.issues?{success:!0,value:n.value}:{success:!1,error:new sd({value:t,cause:n.issues})}},{[pf]:!0,validate:t};var t}(e)}async function mf(e){let{value:t,schema:n}=e;const r=await gf({value:t,schema:n});if(!r.success)throw sd.wrap({value:t,cause:r.error});return r.value}async function gf(e){let{value:t,schema:n}=e;const r=ff(n);try{if(null==r.validate)return{success:!0,value:t,rawValue:t};const e=await r.validate(t);return e.success?{success:!0,value:e.value,rawValue:t}:{success:!1,error:sd.wrap({value:t,cause:e.error}),rawValue:t}}catch(o){return{success:!1,error:sd.wrap({value:t,cause:o}),rawValue:t}}}async function _f(e){let{text:t,schema:n}=e;try{const e=df(t);return null==n?{success:!0,value:e,rawValue:e}:await gf({value:e,schema:n})}catch(r){return{success:!1,error:zu.isInstance(r)?r:new zu({text:t,cause:r}),rawValue:void 0}}}function vf(e){try{return df(e),!0}catch(AC){return!1}}function yf(e){let{stream:t,schema:n}=e;return t.pipeThrough(new TextDecoderStream).pipeThrough(new md).pipeThrough(new TransformStream({async transform(e,t){let{data:r}=e;"[DONE]"!==r&&t.enqueue(await _f({text:r,schema:n}))}}))}async function wf(e){let{provider:t,providerOptions:n,schema:r}=e;if(null==(null==n?void 0:n[t]))return;const o=await gf({value:n[t],schema:r});if(!o.success)throw new yu({argument:"providerOptions",message:"invalid ".concat(t," provider options"),cause:o.error});return o.value}var bf=()=>globalThis.fetch,xf=async e=>{let{url:t,headers:n,body:r,failedResponseHandler:o,successfulResponseHandler:a,abortSignal:i,fetch:s}=e;return kf({url:t,headers:so({"Content-Type":"application/json"},n),body:{content:JSON.stringify(r),values:r},failedResponseHandler:o,successfulResponseHandler:a,abortSignal:i,fetch:s})},kf=async e=>{let{url:t,headers:n={},body:r,successfulResponseHandler:o,failedResponseHandler:a,abortSignal:i,fetch:s=bf()}=e;try{const e=await s(t,{method:"POST",headers:ef(n,"ai-sdk/provider-utils/".concat(tf),Yh()),body:r.content,signal:i}),c=Hh(e);if(!e.ok){let n;try{n=await a({response:e,url:t,requestBodyValues:r.values})}catch(l){if(Xh(l)||lu.isInstance(l))throw l;throw new lu({message:"Failed to process error response",cause:l,statusCode:e.status,url:t,responseHeaders:c,requestBodyValues:r.values})}throw n.value}try{return await o({response:e,url:t,requestBodyValues:r.values})}catch(l){if(l instanceof Error&&(Xh(l)||lu.isInstance(l)))throw l;throw new lu({message:"Failed to process successful response",cause:l,statusCode:e.status,url:t,responseHeaders:c,requestBodyValues:r.values})}}catch(l){throw Qh({error:l,url:t,requestBodyValues:r.values})}};function Cf(e){let{id:t,name:n,inputSchema:r}=e;return e=>{let{execute:o,outputSchema:a,toModelOutput:i,onInputStart:s,onInputDelta:l,onInputAvailable:c}=e,u=Kc(e,Lh);return{type:"provider-defined",id:t,name:n,args:u,inputSchema:r,outputSchema:a,execute:o,toModelOutput:i,onInputStart:s,onInputDelta:l,onInputAvailable:c}}}function Df(e){let{id:t,name:n,inputSchema:r,outputSchema:o}=e;return e=>{let{execute:a,toModelOutput:i,onInputStart:s,onInputDelta:l,onInputAvailable:c}=e,u=Kc(e,Rh);return{type:"provider-defined",id:t,name:n,args:u,inputSchema:r,outputSchema:o,execute:a,toModelOutput:i,onInputStart:s,onInputDelta:l,onInputAvailable:c}}}async function Sf(e){return"function"===typeof e&&(e=e()),Promise.resolve(e)}var Ef=e=>{let{errorSchema:t,errorToMessage:n,isRetryable:r}=e;return async e=>{let{response:o,url:a,requestBodyValues:i}=e;const s=await o.text(),l=Hh(o);if(""===s.trim())return{responseHeaders:l,value:new lu({message:o.statusText,url:a,requestBodyValues:i,statusCode:o.status,responseHeaders:l,responseBody:s,isRetryable:null==r?void 0:r(o)})};try{const e=await async function(e){let{text:t,schema:n}=e;try{const e=df(t);return null==n?e:mf({value:e,schema:n})}catch(r){if(zu.isInstance(r)||sd.isInstance(r))throw r;throw new zu({text:t,cause:r})}}({text:s,schema:t});return{responseHeaders:l,value:new lu({message:n(e),url:a,requestBodyValues:i,statusCode:o.status,responseHeaders:l,responseBody:s,data:e,isRetryable:null==r?void 0:r(o,e)})}}catch(c){return{responseHeaders:l,value:new lu({message:o.statusText,url:a,requestBodyValues:i,statusCode:o.status,responseHeaders:l,responseBody:s,isRetryable:null==r?void 0:r(o)})}}}},Tf=e=>async t=>{let{response:n}=t;const r=Hh(n);if(null==n.body)throw new hu({});return{responseHeaders:r,value:yf({stream:n.body,schema:e})}},Af=e=>async t=>{let{response:n,url:r,requestBodyValues:o}=t;const a=await n.text(),i=await _f({text:a,schema:e}),s=Hh(n);if(!i.success)throw new lu({message:"Invalid JSON response",cause:i.error,statusCode:n.status,responseHeaders:s,responseBody:a,url:r,requestBodyValues:o});return{responseHeaders:s,value:i.value,rawValue:i.rawValue}},Mf=(e,t)=>{let n=0;for(;n<e.length&&n<t.length&&e[n]===t[n];n++);return[(e.length-n).toString(),...t.slice(n)].join("/")},Ff=Symbol("Let zodToJsonSchema decide on which parser to use"),If={name:void 0,$refStrategy:"root",basePath:["#"],effectStrategy:"input",pipeStrategy:"all",dateStrategy:"format:date-time",mapStrategy:"entries",removeAdditionalStrategy:"passthrough",allowedAdditionalProperties:!0,rejectedAdditionalProperties:!1,definitionPath:"definitions",strictUnions:!1,definitions:{},errorMessages:!1,patternStrategy:"escape",applyRegexFlags:!1,emailStrategy:"format:email",base64Strategy:"contentEncoding:base64",nameStrategy:"ref"};function Pf(e,t){return im(e.type._def,t)}function zf(e,t,n){const r=null!=n?n:t.dateStrategy;if(Array.isArray(r))return{anyOf:r.map(((n,r)=>zf(e,t,n)))};switch(r){case"string":case"format:date-time":return{type:"string",format:"date-time"};case"format:date":return{type:"string",format:"date"};case"integer":return Of(e)}}var Of=e=>{const t={type:"integer",format:"unix-time"};for(const n of e.checks)switch(n.kind){case"min":t.minimum=n.value;break;case"max":t.maximum=n.value}return t};var Nf=void 0,Bf=/^[cC][^\s-]{8,}$/,jf=/^[0-9a-z]+$/,Lf=/^[0-9A-HJKMNP-TV-Z]{26}$/,Rf=/^(?!\.)(?!.*\.\.)([a-zA-Z0-9_'+\-\.]*)[a-zA-Z0-9_+-]@([a-zA-Z0-9][a-zA-Z0-9\-]*\.)+[a-zA-Z]{2,}$/,Vf=()=>(void 0===Nf&&(Nf=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),Nf),qf=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,Uf=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,Wf=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,Gf=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,Hf=/^[a-zA-Z0-9_-]{21}$/,Kf=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/;function Zf(e,t){const n={type:"string"};if(e.checks)for(const r of e.checks)switch(r.kind){case"min":n.minLength="number"===typeof n.minLength?Math.max(n.minLength,r.value):r.value;break;case"max":n.maxLength="number"===typeof n.maxLength?Math.min(n.maxLength,r.value):r.value;break;case"email":switch(t.emailStrategy){case"format:email":Jf(n,"email",r.message,t);break;case"format:idn-email":Jf(n,"idn-email",r.message,t);break;case"pattern:zod":Qf(n,Rf,r.message,t)}break;case"url":Jf(n,"uri",r.message,t);break;case"uuid":Jf(n,"uuid",r.message,t);break;case"regex":Qf(n,r.regex,r.message,t);break;case"cuid":Qf(n,Bf,r.message,t);break;case"cuid2":Qf(n,jf,r.message,t);break;case"startsWith":Qf(n,RegExp("^".concat($f(r.value,t))),r.message,t);break;case"endsWith":Qf(n,RegExp("".concat($f(r.value,t),"$")),r.message,t);break;case"datetime":Jf(n,"date-time",r.message,t);break;case"date":Jf(n,"date",r.message,t);break;case"time":Jf(n,"time",r.message,t);break;case"duration":Jf(n,"duration",r.message,t);break;case"length":n.minLength="number"===typeof n.minLength?Math.max(n.minLength,r.value):r.value,n.maxLength="number"===typeof n.maxLength?Math.min(n.maxLength,r.value):r.value;break;case"includes":Qf(n,RegExp($f(r.value,t)),r.message,t);break;case"ip":"v6"!==r.version&&Jf(n,"ipv4",r.message,t),"v4"!==r.version&&Jf(n,"ipv6",r.message,t);break;case"base64url":Qf(n,Gf,r.message,t);break;case"jwt":Qf(n,Kf,r.message,t);break;case"cidr":"v6"!==r.version&&Qf(n,qf,r.message,t),"v4"!==r.version&&Qf(n,Uf,r.message,t);break;case"emoji":Qf(n,Vf(),r.message,t);break;case"ulid":Qf(n,Lf,r.message,t);break;case"base64":switch(t.base64Strategy){case"format:binary":Jf(n,"binary",r.message,t);break;case"contentEncoding:base64":n.contentEncoding="base64";break;case"pattern:zod":Qf(n,Wf,r.message,t)}break;case"nanoid":Qf(n,Hf,r.message,t)}return n}function $f(e,t){return"escape"===t.patternStrategy?function(e){let t="";for(let n=0;n<e.length;n++)Xf.has(e[n])||(t+="\\"),t+=e[n];return t}(e):e}var Xf=new Set("ABCDEFGHIJKLMNOPQRSTUVXYZabcdefghijklmnopqrstuvxyz0123456789");function Jf(e,t,n,r){var o;e.format||(null==(o=e.anyOf)?void 0:o.some((e=>e.format)))?(e.anyOf||(e.anyOf=[]),e.format&&(e.anyOf.push({format:e.format}),delete e.format),e.anyOf.push(so({format:t},n&&r.errorMessages&&{errorMessage:{format:n}}))):e.format=t}function Qf(e,t,n,r){var o;e.pattern||(null==(o=e.allOf)?void 0:o.some((e=>e.pattern)))?(e.allOf||(e.allOf=[]),e.pattern&&(e.allOf.push({pattern:e.pattern}),delete e.pattern),e.allOf.push(so({pattern:Yf(t,r)},n&&r.errorMessages&&{errorMessage:{pattern:n}}))):e.pattern=Yf(t,r)}function Yf(e,t){var n;if(!t.applyRegexFlags||!e.flags)return e.source;const r=e.flags.includes("i"),o=e.flags.includes("m"),a=e.flags.includes("s"),i=r?e.source.toLowerCase():e.source;let s="",l=!1,c=!1,u=!1;for(let d=0;d<i.length;d++)if(l)s+=i[d],l=!1;else{if(r)if(c){if(i[d].match(/[a-z]/)){u?(s+=i[d],s+="".concat(i[d-2],"-").concat(i[d]).toUpperCase(),u=!1):"-"===i[d+1]&&(null==(n=i[d+2])?void 0:n.match(/[a-z]/))?(s+=i[d],u=!0):s+="".concat(i[d]).concat(i[d].toUpperCase());continue}}else if(i[d].match(/[a-z]/)){s+="[".concat(i[d]).concat(i[d].toUpperCase(),"]");continue}if(o){if("^"===i[d]){s+="(^|(?<=[\r\n]))";continue}if("$"===i[d]){s+="($|(?=[\r\n]))";continue}}a&&"."===i[d]?s+=c?"".concat(i[d],"\r\n"):"[".concat(i[d],"\r\n]"):(s+=i[d],"\\"===i[d]?l=!0:c&&"]"===i[d]?c=!1:c||"["!==i[d]||(c=!0))}try{new RegExp(s)}catch(AC){return console.warn("Could not convert regex pattern at ".concat(t.currentPath.join("/")," to a flag-independent form! Falling back to the flag-ignorant source")),e.source}return s}function em(e,t){var n,r,o,a,i,s;const l={type:"object",additionalProperties:null!=(n=im(e.valueType._def,so(so({},t),{},{currentPath:[...t.currentPath,"additionalProperties"]})))?n:t.allowedAdditionalProperties};if((null==(r=e.keyType)?void 0:r._def.typeName)===jh.ZodString&&(null==(o=e.keyType._def.checks)?void 0:o.length)){const n=Zf(e.keyType._def,t),{type:r}=n,o=Kc(n,qh);return so(so({},l),{},{propertyNames:o})}if((null==(a=e.keyType)?void 0:a._def.typeName)===jh.ZodEnum)return so(so({},l),{},{propertyNames:{enum:e.keyType._def.values}});if((null==(i=e.keyType)?void 0:i._def.typeName)===jh.ZodBranded&&e.keyType._def.type._def.typeName===jh.ZodString&&(null==(s=e.keyType._def.type._def.checks)?void 0:s.length)){const n=Pf(e.keyType._def,t),{type:r}=n,o=Kc(n,Uh);return so(so({},l),{},{propertyNames:o})}return l}var tm={ZodString:"string",ZodNumber:"number",ZodBigInt:"integer",ZodBoolean:"boolean",ZodNull:"null"};var nm=(e,t)=>{const n=(e.options instanceof Map?Array.from(e.options.values()):e.options).map(((e,n)=>im(e._def,so(so({},t),{},{currentPath:[...t.currentPath,"anyOf","".concat(n)]})))).filter((e=>!!e&&(!t.strictUnions||"object"===typeof e&&Object.keys(e).length>0)));return n.length?{anyOf:n}:void 0};function rm(e,t){const n={type:"object",properties:{}},r=[],o=e.shape();for(const i in o){let e=o[i];if(void 0===e||void 0===e._def)continue;const a=om(e),s=im(e._def,so(so({},t),{},{currentPath:[...t.currentPath,"properties",i],propertyPath:[...t.currentPath,"properties",i]}));void 0!==s&&(n.properties[i]=s,a||r.push(i))}r.length&&(n.required=r);const a=function(e,t){if("ZodNever"!==e.catchall._def.typeName)return im(e.catchall._def,so(so({},t),{},{currentPath:[...t.currentPath,"additionalProperties"]}));switch(e.unknownKeys){case"passthrough":return t.allowedAdditionalProperties;case"strict":return t.rejectedAdditionalProperties;case"strip":return"strict"===t.removeAdditionalStrategy?t.allowedAdditionalProperties:t.rejectedAdditionalProperties}}(e,t);return void 0!==a&&(n.additionalProperties=a),n}function om(e){try{return e.isOptional()}catch(AC){return!0}}var am=(e,t,n)=>{switch(t){case jh.ZodString:return Zf(e,n);case jh.ZodNumber:return function(e){const t={type:"number"};if(!e.checks)return t;for(const n of e.checks)switch(n.kind){case"int":t.type="integer";break;case"min":n.inclusive?t.minimum=n.value:t.exclusiveMinimum=n.value;break;case"max":n.inclusive?t.maximum=n.value:t.exclusiveMaximum=n.value;break;case"multipleOf":t.multipleOf=n.value}return t}(e);case jh.ZodObject:return rm(e,n);case jh.ZodBigInt:return function(e){const t={type:"integer",format:"int64"};if(!e.checks)return t;for(const n of e.checks)switch(n.kind){case"min":n.inclusive?t.minimum=n.value:t.exclusiveMinimum=n.value;break;case"max":n.inclusive?t.maximum=n.value:t.exclusiveMaximum=n.value;break;case"multipleOf":t.multipleOf=n.value}return t}(e);case jh.ZodBoolean:return{type:"boolean"};case jh.ZodDate:return zf(e,n);case jh.ZodUndefined:return{not:{}};case jh.ZodNull:return{type:"null"};case jh.ZodArray:return function(e,t){var n,r,o;const a={type:"array"};return(null==(n=e.type)?void 0:n._def)&&(null==(o=null==(r=e.type)?void 0:r._def)?void 0:o.typeName)!==jh.ZodAny&&(a.items=im(e.type._def,so(so({},t),{},{currentPath:[...t.currentPath,"items"]}))),e.minLength&&(a.minItems=e.minLength.value),e.maxLength&&(a.maxItems=e.maxLength.value),e.exactLength&&(a.minItems=e.exactLength.value,a.maxItems=e.exactLength.value),a}(e,n);case jh.ZodUnion:case jh.ZodDiscriminatedUnion:return function(e,t){const n=e.options instanceof Map?Array.from(e.options.values()):e.options;if(n.every((e=>e._def.typeName in tm&&(!e._def.checks||!e._def.checks.length)))){const e=n.reduce(((e,t)=>{const n=tm[t._def.typeName];return n&&!e.includes(n)?[...e,n]:e}),[]);return{type:e.length>1?e:e[0]}}if(n.every((e=>"ZodLiteral"===e._def.typeName&&!e.description))){const e=n.reduce(((e,t)=>{const n=typeof t._def.value;switch(n){case"string":case"number":case"boolean":return[...e,n];case"bigint":return[...e,"integer"];case"object":if(null===t._def.value)return[...e,"null"];default:return e}}),[]);if(e.length===n.length){const t=e.filter(((e,t,n)=>n.indexOf(e)===t));return{type:t.length>1?t:t[0],enum:n.reduce(((e,t)=>e.includes(t._def.value)?e:[...e,t._def.value]),[])}}}else if(n.every((e=>"ZodEnum"===e._def.typeName)))return{type:"string",enum:n.reduce(((e,t)=>[...e,...t._def.values.filter((t=>!e.includes(t)))]),[])};return nm(e,t)}(e,n);case jh.ZodIntersection:return function(e,t){const n=[im(e.left._def,so(so({},t),{},{currentPath:[...t.currentPath,"allOf","0"]})),im(e.right._def,so(so({},t),{},{currentPath:[...t.currentPath,"allOf","1"]}))].filter((e=>!!e)),r=[];return n.forEach((e=>{if((e=>(!("type"in e)||"string"!==e.type)&&"allOf"in e)(e))r.push(...e.allOf);else{let t=e;if("additionalProperties"in e&&!1===e.additionalProperties){const{additionalProperties:n}=e;t=Kc(e,Vh)}r.push(t)}})),r.length?{allOf:r}:void 0}(e,n);case jh.ZodTuple:return function(e,t){return e.rest?{type:"array",minItems:e.items.length,items:e.items.map(((e,n)=>im(e._def,so(so({},t),{},{currentPath:[...t.currentPath,"items","".concat(n)]})))).reduce(((e,t)=>void 0===t?e:[...e,t]),[]),additionalItems:im(e.rest._def,so(so({},t),{},{currentPath:[...t.currentPath,"additionalItems"]}))}:{type:"array",minItems:e.items.length,maxItems:e.items.length,items:e.items.map(((e,n)=>im(e._def,so(so({},t),{},{currentPath:[...t.currentPath,"items","".concat(n)]})))).reduce(((e,t)=>void 0===t?e:[...e,t]),[])}}(e,n);case jh.ZodRecord:return em(e,n);case jh.ZodLiteral:return function(e){const t=typeof e.value;return"bigint"!==t&&"number"!==t&&"boolean"!==t&&"string"!==t?{type:Array.isArray(e.value)?"array":"object"}:{type:"bigint"===t?"integer":t,const:e.value}}(e);case jh.ZodEnum:return function(e){return{type:"string",enum:Array.from(e.values)}}(e);case jh.ZodNativeEnum:return function(e){const t=e.values,n=Object.keys(e.values).filter((e=>"number"!==typeof t[t[e]])).map((e=>t[e])),r=Array.from(new Set(n.map((e=>typeof e))));return{type:1===r.length?"string"===r[0]?"string":"number":["string","number"],enum:n}}(e);case jh.ZodNullable:return function(e,t){if(["ZodString","ZodNumber","ZodBigInt","ZodBoolean","ZodNull"].includes(e.innerType._def.typeName)&&(!e.innerType._def.checks||!e.innerType._def.checks.length))return{type:[tm[e.innerType._def.typeName],"null"]};const n=im(e.innerType._def,so(so({},t),{},{currentPath:[...t.currentPath,"anyOf","0"]}));return n&&{anyOf:[n,{type:"null"}]}}(e,n);case jh.ZodOptional:return((e,t)=>{var n;if(t.currentPath.toString()===(null==(n=t.propertyPath)?void 0:n.toString()))return im(e.innerType._def,t);const r=im(e.innerType._def,so(so({},t),{},{currentPath:[...t.currentPath,"anyOf","1"]}));return r?{anyOf:[{not:{}},r]}:{}})(e,n);case jh.ZodMap:return function(e,t){return"record"===t.mapStrategy?em(e,t):{type:"array",maxItems:125,items:{type:"array",items:[im(e.keyType._def,so(so({},t),{},{currentPath:[...t.currentPath,"items","items","0"]}))||{},im(e.valueType._def,so(so({},t),{},{currentPath:[...t.currentPath,"items","items","1"]}))||{}],minItems:2,maxItems:2}}}(e,n);case jh.ZodSet:return function(e,t){const n={type:"array",uniqueItems:!0,items:im(e.valueType._def,so(so({},t),{},{currentPath:[...t.currentPath,"items"]}))};return e.minSize&&(n.minItems=e.minSize.value),e.maxSize&&(n.maxItems=e.maxSize.value),n}(e,n);case jh.ZodLazy:return()=>e.getter()._def;case jh.ZodPromise:return function(e,t){return im(e.type._def,t)}(e,n);case jh.ZodNaN:case jh.ZodNever:return{not:{}};case jh.ZodEffects:return function(e,t){return"input"===t.effectStrategy?im(e.schema._def,t):{}}(e,n);case jh.ZodAny:case jh.ZodUnknown:return{};case jh.ZodDefault:return function(e,t){return so(so({},im(e.innerType._def,t)),{},{default:e.defaultValue()})}(e,n);case jh.ZodBranded:return Pf(e,n);case jh.ZodReadonly:case jh.ZodCatch:return((e,t)=>im(e.innerType._def,t))(e,n);case jh.ZodPipeline:return((e,t)=>{if("input"===t.pipeStrategy)return im(e.in._def,t);if("output"===t.pipeStrategy)return im(e.out._def,t);const n=im(e.in._def,so(so({},t),{},{currentPath:[...t.currentPath,"allOf","0"]}));return{allOf:[n,im(e.out._def,so(so({},t),{},{currentPath:[...t.currentPath,"allOf",n?"1":"0"]}))].filter((e=>void 0!==e))}})(e,n);case jh.ZodFunction:case jh.ZodVoid:case jh.ZodSymbol:default:return}};function im(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];var r;const o=t.seen.get(e);if(t.override){const a=null==(r=t.override)?void 0:r.call(t,e,t,o,n);if(a!==Ff)return a}if(o&&!n){const e=sm(o,t);if(void 0!==e)return e}const a={def:e,path:t.currentPath,jsonSchema:void 0};t.seen.set(e,a);const i=am(e,e.typeName,t),s="function"===typeof i?im(i(),t):i;if(s&&lm(e,t,s),t.postProcess){const n=t.postProcess(s,e,t);return a.jsonSchema=s,n}return a.jsonSchema=s,s}var sm=(e,t)=>{switch(t.$refStrategy){case"root":return{$ref:e.path.join("/")};case"relative":return{$ref:Mf(t.currentPath,e.path)};case"none":case"seen":return e.path.length<t.currentPath.length&&e.path.every(((e,n)=>t.currentPath[n]===e))?(console.warn("Recursive reference detected at ".concat(t.currentPath.join("/"),"! Defaulting to any")),{}):"seen"===t.$refStrategy?{}:void 0}},lm=(e,t,n)=>(e.description&&(n.description=e.description),n),cm=e=>{const t=(e=>"string"===typeof e?so(so({},If),{},{name:e}):so(so({},If),e))(e),n=void 0!==t.name?[...t.basePath,t.definitionPath,t.name]:t.basePath;return so(so({},t),{},{currentPath:n,propertyPath:void 0,seen:new Map(Object.entries(t.definitions).map((e=>{let[n,r]=e;return[r._def,{def:r._def,path:[...t.basePath,t.definitionPath,n],jsonSchema:void 0}]})))})},um=(e,t)=>{var n;const r=cm(t);let o="object"===typeof t&&t.definitions?Object.entries(t.definitions).reduce(((e,t)=>{let[n,o]=t;var a;return so(so({},e),{},{[n]:null!=(a=im(o._def,so(so({},r),{},{currentPath:[...r.basePath,r.definitionPath,n]}),!0))?a:{}})}),{}):void 0;const a="string"===typeof t?t:"title"===(null==t?void 0:t.nameStrategy)||null==t?void 0:t.name,i=null!=(n=im(e._def,void 0===a?r:so(so({},r),{},{currentPath:[...r.basePath,r.definitionPath,a]}),!1))?n:{},s="object"===typeof t&&void 0!==t.name&&"title"===t.nameStrategy?t.name:void 0;void 0!==s&&(i.title=s);const l=void 0===a?o?so(so({},i),{},{[r.definitionPath]:o}):i:{$ref:[..."relative"===r.$refStrategy?[]:r.basePath,r.definitionPath,a].join("/"),[r.definitionPath]:so(so({},o),{},{[a]:i})};return l.$schema="http://json-schema.org/draft-07/schema#",l};function dm(e,t){var n;const r=null!=(n=null==t?void 0:t.useReferences)&&n;return mm((()=>function(e,t){if(e instanceof gd){const n=new qd(t),r={};for(const t of e._idmap.entries()){const[e,r]=t;n.process(r)}const o={},a={registry:e,uri:null===t||void 0===t?void 0:t.uri,defs:r};for(const i of e._idmap.entries()){const[e,r]=i;o[e]=n.emit(r,so(so({},t),{},{external:a}))}if(Object.keys(r).length>0){const e="draft-2020-12"===n.target?"$defs":"definitions";o.__shared={[e]:r}}return{schemas:o}}const n=new qd(t);return n.process(e),n.emit(e,t)}(e,{target:"draft-7",io:"output",reused:r?"ref":"inline"})),{validate:async t=>{const n=await lp(e,t);return n.success?{success:!0,value:n.data}:{success:!1,error:n.error}}})}function pm(e,t){return function(e){return"_zod"in e}(e)?dm(e,t):function(e,t){var n;const r=null!=(n=null==t?void 0:t.useReferences)&&n;return mm((()=>um(e,{$refStrategy:r?"root":"none"})),{validate:async t=>{const n=await e.safeParseAsync(t);return n.success?{success:!0,value:n.data}:{success:!1,error:n.error}}})}(e,t)}var hm=Symbol.for("vercel.ai.schema");function fm(e){let t;return()=>(null==t&&(t=e()),t)}function mm(e){let{validate:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return{[hm]:!0,_type:void 0,[pf]:!0,get jsonSchema(){return"function"===typeof e&&(e=e()),e},validate:t}}function gm(e){return null==e?mm({properties:{},additionalProperties:!1}):function(e){return"object"===typeof e&&null!==e&&hm in e&&!0===e[hm]&&"jsonSchema"in e&&"validate"in e}(e)?e:"function"===typeof e?e():pm(e)}var{btoa:_m,atob:vm}=globalThis;function ym(e){const t=e.replace(/-/g,"+").replace(/_/g,"/"),n=vm(t);return Uint8Array.from(n,(e=>e.codePointAt(0)))}function wm(e){let t="";for(let n=0;n<e.length;n++)t+=String.fromCodePoint(e[n]);return _m(t)}function bm(e){return e instanceof Uint8Array?wm(e):e}function xm(e){return null==e?void 0:e.replace(/\/$/,"")}function km(){var e;return e=function(e){let{execute:t,input:n,options:r}=e;return function*(){const e=t(n,r);if(null!=(c=e)&&"function"===typeof c[Symbol.asyncIterator]){let t;var o,a=!1,i=!1;try{for(var s,l=Zc(e);a=!(s=yield Jc(l.next())).done;a=!1){const e=s.value;t=e,yield{type:"preliminary",output:e}}}catch(u){i=!0,o=u}finally{try{a&&null!=l.return&&(yield Jc(l.return()))}finally{if(i)throw o}}yield{type:"final",output:t}}else yield{type:"final",output:yield Jc(e)};var c}()},km=function(){return new Qc(e.apply(this,arguments))},km.apply(this,arguments)}const Cm=/^[cC][^\s-]{8,}$/,Dm=/^[0-9a-z]+$/,Sm=/^[0-9A-HJKMNP-TV-Za-hjkmnp-tv-z]{26}$/,Em=/^[0-9a-vA-V]{20}$/,Tm=/^[A-Za-z0-9]{27}$/,Am=/^[a-zA-Z0-9_-]{21}$/,Mm=/^P(?:(\d+W)|(?!.*W)(?=\d|T\d)(\d+Y)?(\d+M)?(\d+D)?(T(?=\d)(\d+H)?(\d+M)?(\d+([.,]\d+)?S)?)?)$/,Fm=/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12})$/,Im=e=>e?new RegExp("^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-".concat(e,"[0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12})$")):/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-8][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}|00000000-0000-0000-0000-000000000000)$/,Pm=/^(?!\.)(?!.*\.\.)([A-Za-z0-9_'+\-\.]*)[A-Za-z0-9_+-]@([A-Za-z0-9][A-Za-z0-9\-]*\.)+[A-Za-z]{2,}$/;const zm=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,Om=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|::|([0-9a-fA-F]{1,4})?::([0-9a-fA-F]{1,4}:?){0,6})$/,Nm=/^((25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/([0-9]|[1-2][0-9]|3[0-2])$/,Bm=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|::|([0-9a-fA-F]{1,4})?::([0-9a-fA-F]{1,4}:?){0,6})\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,jm=/^$|^(?:[0-9a-zA-Z+/]{4})*(?:(?:[0-9a-zA-Z+/]{2}==)|(?:[0-9a-zA-Z+/]{3}=))?$/,Lm=/^[A-Za-z0-9_-]*$/,Rm=/^([a-zA-Z0-9-]+\.)*[a-zA-Z0-9-]+$/,Vm=/^\+(?:[0-9]){6,14}[0-9]$/,qm="(?:(?:\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-(?:(?:0[13578]|1[02])-(?:0[1-9]|[12]\\d|3[01])|(?:0[469]|11)-(?:0[1-9]|[12]\\d|30)|(?:02)-(?:0[1-9]|1\\d|2[0-8])))",Um=new RegExp("^".concat(qm,"$"));function Wm(e){const t="(?:[01]\\d|2[0-3]):[0-5]\\d";return"number"===typeof e.precision?-1===e.precision?"".concat(t):0===e.precision?"".concat(t,":[0-5]\\d"):"".concat(t,":[0-5]\\d\\.\\d{").concat(e.precision,"}"):"".concat(t,"(?::[0-5]\\d(?:\\.\\d+)?)?")}const Gm=/^\d+$/,Hm=/^-?\d+(?:\.\d+)?/i,Km=/true|false/i,Zm=/null/i,$m=/^[^A-Z]*$/,Xm=/^[^a-z]*$/,Jm=Wd("$ZodCheck",((e,t)=>{var n,r,o;null!==(n=e._zod)&&void 0!==n||(e._zod={}),e._zod.def=t,null!==(r=(o=e._zod).onattach)&&void 0!==r||(o.onattach=[])})),Qm={number:"number",bigint:"bigint",object:"date"},Ym=Wd("$ZodCheckLessThan",((e,t)=>{Jm.init(e,t);const n=Qm[typeof t.value];e._zod.onattach.push((e=>{var n;const r=e._zod.bag,o=null!==(n=t.inclusive?r.maximum:r.exclusiveMaximum)&&void 0!==n?n:Number.POSITIVE_INFINITY;t.value<o&&(t.inclusive?r.maximum=t.value:r.exclusiveMaximum=t.value)})),e._zod.check=r=>{(t.inclusive?r.value<=t.value:r.value<t.value)||r.issues.push({origin:n,code:"too_big",maximum:t.value,input:r.value,inclusive:t.inclusive,inst:e,continue:!t.abort})}})),eg=Wd("$ZodCheckGreaterThan",((e,t)=>{Jm.init(e,t);const n=Qm[typeof t.value];e._zod.onattach.push((e=>{var n;const r=e._zod.bag,o=null!==(n=t.inclusive?r.minimum:r.exclusiveMinimum)&&void 0!==n?n:Number.NEGATIVE_INFINITY;t.value>o&&(t.inclusive?r.minimum=t.value:r.exclusiveMinimum=t.value)})),e._zod.check=r=>{(t.inclusive?r.value>=t.value:r.value>t.value)||r.issues.push({origin:n,code:"too_small",minimum:t.value,input:r.value,inclusive:t.inclusive,inst:e,continue:!t.abort})}})),tg=Wd("$ZodCheckMultipleOf",((e,t)=>{Jm.init(e,t),e._zod.onattach.push((e=>{var n,r;null!==(n=(r=e._zod.bag).multipleOf)&&void 0!==n||(r.multipleOf=t.value)})),e._zod.check=n=>{if(typeof n.value!==typeof t.value)throw new Error("Cannot mix number and bigint in multiple_of check.");("bigint"===typeof n.value?n.value%t.value===BigInt(0):0===function(e,t){const n=(e.toString().split(".")[1]||"").length,r=(t.toString().split(".")[1]||"").length,o=n>r?n:r;return Number.parseInt(e.toFixed(o).replace(".",""))%Number.parseInt(t.toFixed(o).replace(".",""))/10**o}(n.value,t.value))||n.issues.push({origin:typeof n.value,code:"not_multiple_of",divisor:t.value,input:n.value,inst:e,continue:!t.abort})}})),ng=Wd("$ZodCheckNumberFormat",((e,t)=>{var n;Jm.init(e,t),t.format=t.format||"float64";const r=null===(n=t.format)||void 0===n?void 0:n.includes("int"),o=r?"int":"number",[a,i]=Od[t.format];e._zod.onattach.push((e=>{const n=e._zod.bag;n.format=t.format,n.minimum=a,n.maximum=i,r&&(n.pattern=Gm)})),e._zod.check=n=>{const s=n.value;if(r){if(!Number.isInteger(s))return void n.issues.push({expected:o,format:t.format,code:"invalid_type",input:s,inst:e});if(!Number.isSafeInteger(s))return void(s>0?n.issues.push({input:s,code:"too_big",maximum:Number.MAX_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:e,origin:o,continue:!t.abort}):n.issues.push({input:s,code:"too_small",minimum:Number.MIN_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:e,origin:o,continue:!t.abort}))}s<a&&n.issues.push({origin:"number",input:s,code:"too_small",minimum:a,inclusive:!0,inst:e,continue:!t.abort}),s>i&&n.issues.push({origin:"number",input:s,code:"too_big",maximum:i,inst:e})}})),rg=Wd("$ZodCheckMaxLength",((e,t)=>{var n,r;Jm.init(e,t),null!==(n=(r=e._zod.def).when)&&void 0!==n||(r.when=e=>{const t=e.value;return!xd(t)&&void 0!==t.length}),e._zod.onattach.push((e=>{var n;const r=null!==(n=e._zod.bag.maximum)&&void 0!==n?n:Number.POSITIVE_INFINITY;t.maximum<r&&(e._zod.bag.maximum=t.maximum)})),e._zod.check=n=>{const r=n.value;if(r.length<=t.maximum)return;const o=Rd(r);n.issues.push({origin:o,code:"too_big",maximum:t.maximum,inclusive:!0,input:r,inst:e,continue:!t.abort})}})),og=Wd("$ZodCheckMinLength",((e,t)=>{var n,r;Jm.init(e,t),null!==(n=(r=e._zod.def).when)&&void 0!==n||(r.when=e=>{const t=e.value;return!xd(t)&&void 0!==t.length}),e._zod.onattach.push((e=>{var n;const r=null!==(n=e._zod.bag.minimum)&&void 0!==n?n:Number.NEGATIVE_INFINITY;t.minimum>r&&(e._zod.bag.minimum=t.minimum)})),e._zod.check=n=>{const r=n.value;if(r.length>=t.minimum)return;const o=Rd(r);n.issues.push({origin:o,code:"too_small",minimum:t.minimum,inclusive:!0,input:r,inst:e,continue:!t.abort})}})),ag=Wd("$ZodCheckLengthEquals",((e,t)=>{var n,r;Jm.init(e,t),null!==(n=(r=e._zod.def).when)&&void 0!==n||(r.when=e=>{const t=e.value;return!xd(t)&&void 0!==t.length}),e._zod.onattach.push((e=>{const n=e._zod.bag;n.minimum=t.length,n.maximum=t.length,n.length=t.length})),e._zod.check=n=>{const r=n.value,o=r.length;if(o===t.length)return;const a=Rd(r),i=o>t.length;n.issues.push(so(so({origin:a},i?{code:"too_big",maximum:t.length}:{code:"too_small",minimum:t.length}),{},{inclusive:!0,exact:!0,input:n.value,inst:e,continue:!t.abort}))}})),ig=Wd("$ZodCheckStringFormat",((e,t)=>{var n,r,o,a;Jm.init(e,t),e._zod.onattach.push((e=>{const n=e._zod.bag;var r;(n.format=t.format,t.pattern)&&(null!==(r=n.patterns)&&void 0!==r||(n.patterns=new Set),n.patterns.add(t.pattern))})),t.pattern?null!==(n=(o=e._zod).check)&&void 0!==n||(o.check=n=>{t.pattern.lastIndex=0,t.pattern.test(n.value)||n.issues.push(so(so({origin:"string",code:"invalid_format",format:t.format,input:n.value},t.pattern?{pattern:t.pattern.toString()}:{}),{},{inst:e,continue:!t.abort}))}):null!==(r=(a=e._zod).check)&&void 0!==r||(a.check=()=>{})})),sg=Wd("$ZodCheckRegex",((e,t)=>{ig.init(e,t),e._zod.check=n=>{t.pattern.lastIndex=0,t.pattern.test(n.value)||n.issues.push({origin:"string",code:"invalid_format",format:"regex",input:n.value,pattern:t.pattern.toString(),inst:e,continue:!t.abort})}})),lg=Wd("$ZodCheckLowerCase",((e,t)=>{var n;null!==(n=t.pattern)&&void 0!==n||(t.pattern=$m),ig.init(e,t)})),cg=Wd("$ZodCheckUpperCase",((e,t)=>{var n;null!==(n=t.pattern)&&void 0!==n||(t.pattern=Xm),ig.init(e,t)})),ug=Wd("$ZodCheckIncludes",((e,t)=>{Jm.init(e,t);const n=Id(t.includes),r=new RegExp("number"===typeof t.position?"^.{".concat(t.position,"}").concat(n):n);t.pattern=r,e._zod.onattach.push((e=>{var t;const n=e._zod.bag;null!==(t=n.patterns)&&void 0!==t||(n.patterns=new Set),n.patterns.add(r)})),e._zod.check=n=>{n.value.includes(t.includes,t.position)||n.issues.push({origin:"string",code:"invalid_format",format:"includes",includes:t.includes,input:n.value,inst:e,continue:!t.abort})}})),dg=Wd("$ZodCheckStartsWith",((e,t)=>{var n;Jm.init(e,t);const r=new RegExp("^".concat(Id(t.prefix),".*"));null!==(n=t.pattern)&&void 0!==n||(t.pattern=r),e._zod.onattach.push((e=>{var t;const n=e._zod.bag;null!==(t=n.patterns)&&void 0!==t||(n.patterns=new Set),n.patterns.add(r)})),e._zod.check=n=>{n.value.startsWith(t.prefix)||n.issues.push({origin:"string",code:"invalid_format",format:"starts_with",prefix:t.prefix,input:n.value,inst:e,continue:!t.abort})}})),pg=Wd("$ZodCheckEndsWith",((e,t)=>{var n;Jm.init(e,t);const r=new RegExp(".*".concat(Id(t.suffix),"$"));null!==(n=t.pattern)&&void 0!==n||(t.pattern=r),e._zod.onattach.push((e=>{var t;const n=e._zod.bag;null!==(t=n.patterns)&&void 0!==t||(n.patterns=new Set),n.patterns.add(r)})),e._zod.check=n=>{n.value.endsWith(t.suffix)||n.issues.push({origin:"string",code:"invalid_format",format:"ends_with",suffix:t.suffix,input:n.value,inst:e,continue:!t.abort})}}));const hg=Wd("$ZodCheckOverwrite",((e,t)=>{Jm.init(e,t),e._zod.check=e=>{e.value=t.tx(e.value)}}));class fg{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.content=[],this.indent=0,this&&(this.args=e)}indented(e){this.indent+=1,e(this),this.indent-=1}write(e){if("function"===typeof e)return e(this,{execution:"sync"}),void e(this,{execution:"async"});const t=e.split("\n").filter((e=>e)),n=Math.min(...t.map((e=>e.length-e.trimStart().length))),r=t.map((e=>e.slice(n))).map((e=>" ".repeat(2*this.indent)+e));for(const o of r)this.content.push(o)}compile(){var e;const t=Function,n=null===this||void 0===this?void 0:this.args,r=[...(null!==(e=null===this||void 0===this?void 0:this.content)&&void 0!==e?e:[""]).map((e=>"  ".concat(e)))];return new t(...n,r.join("\n"))}}const mg={major:4,minor:0,patch:0},gg=Wd("$ZodType",((e,t)=>{var n,r;null!==e&&void 0!==e||(e={}),e._zod.def=t,e._zod.bag=e._zod.bag||{},e._zod.version=mg;const o=[...null!==(n=e._zod.def.checks)&&void 0!==n?n:[]];e._zod.traits.has("$ZodCheck")&&o.unshift(e);for(const s of o)for(const t of s._zod.onattach)t(e);if(0===o.length){var a,i;null!==(a=(r=e._zod).deferred)&&void 0!==a||(r.deferred=[]),null===(i=e._zod.deferred)||void 0===i||i.push((()=>{e._zod.run=e._zod.parse}))}else{const t=(e,t,n)=>{let r,o=Nd(e);for(const a of t){if(a._zod.def.when){if(!a._zod.def.when(e))continue}else if(o)continue;const t=e.issues.length,i=a._zod.check(e);if(i instanceof Promise&&!1===(null===n||void 0===n?void 0:n.async))throw new Gd;if(r||i instanceof Promise)r=(null!==r&&void 0!==r?r:Promise.resolve()).then((async()=>{await i;e.issues.length!==t&&(o||(o=Nd(e,t)))}));else{if(e.issues.length===t)continue;o||(o=Nd(e,t))}}return r?r.then((()=>e)):e};e._zod.run=(n,r)=>{const a=e._zod.parse(n,r);if(a instanceof Promise){if(!1===r.async)throw new Gd;return a.then((e=>t(e,o,r)))}return t(a,o,r)}}e["~standard"]={validate:t=>{try{var n;const r=ep(e,t);return r.success?{value:r.data}:{issues:null===(n=r.error)||void 0===n?void 0:n.issues}}catch(r){return np(e,t).then((e=>{var t;return e.success?{value:e.data}:{issues:null===(t=e.error)||void 0===t?void 0:t.issues}}))}},vendor:"zod",version:1}})),_g=Wd("$ZodString",((e,t)=>{var n,r,o;gg.init(e,t),e._zod.pattern=null!==(n=[...null!==(r=null===e||void 0===e||null===(o=e._zod.bag)||void 0===o?void 0:o.patterns)&&void 0!==r?r:[]].pop())&&void 0!==n?n:(e=>{var t,n;const r=e?"[\\s\\S]{".concat(null!==(t=null===e||void 0===e?void 0:e.minimum)&&void 0!==t?t:0,",").concat(null!==(n=null===e||void 0===e?void 0:e.maximum)&&void 0!==n?n:"","}"):"[\\s\\S]*";return new RegExp("^".concat(r,"$"))})(e._zod.bag),e._zod.parse=(n,r)=>{if(t.coerce)try{n.value=String(n.value)}catch(r){}return"string"===typeof n.value||n.issues.push({expected:"string",code:"invalid_type",input:n.value,inst:e}),n}})),vg=Wd("$ZodStringFormat",((e,t)=>{ig.init(e,t),_g.init(e,t)})),yg=Wd("$ZodGUID",((e,t)=>{var n;null!==(n=t.pattern)&&void 0!==n||(t.pattern=Fm),vg.init(e,t)})),wg=Wd("$ZodUUID",((e,t)=>{var n;if(t.version){var r;const e={v1:1,v2:2,v3:3,v4:4,v5:5,v6:6,v7:7,v8:8}[t.version];if(void 0===e)throw new Error('Invalid UUID version: "'.concat(t.version,'"'));null!==(r=t.pattern)&&void 0!==r||(t.pattern=Im(e))}else null!==(n=t.pattern)&&void 0!==n||(t.pattern=Im());vg.init(e,t)})),bg=Wd("$ZodEmail",((e,t)=>{var n;null!==(n=t.pattern)&&void 0!==n||(t.pattern=Pm),vg.init(e,t)})),xg=Wd("$ZodURL",((e,t)=>{vg.init(e,t),e._zod.check=n=>{try{const r=n.value,o=new URL(r),a=o.href;return t.hostname&&(t.hostname.lastIndex=0,t.hostname.test(o.hostname)||n.issues.push({code:"invalid_format",format:"url",note:"Invalid hostname",pattern:Rm.source,input:n.value,inst:e,continue:!t.abort})),t.protocol&&(t.protocol.lastIndex=0,t.protocol.test(o.protocol.endsWith(":")?o.protocol.slice(0,-1):o.protocol)||n.issues.push({code:"invalid_format",format:"url",note:"Invalid protocol",pattern:t.protocol.source,input:n.value,inst:e,continue:!t.abort})),void(!r.endsWith("/")&&a.endsWith("/")?n.value=a.slice(0,-1):n.value=a)}catch(r){n.issues.push({code:"invalid_format",format:"url",input:n.value,inst:e,continue:!t.abort})}}})),kg=Wd("$ZodEmoji",((e,t)=>{var n;null!==(n=t.pattern)&&void 0!==n||(t.pattern=new RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),vg.init(e,t)})),Cg=Wd("$ZodNanoID",((e,t)=>{var n;null!==(n=t.pattern)&&void 0!==n||(t.pattern=Am),vg.init(e,t)})),Dg=Wd("$ZodCUID",((e,t)=>{var n;null!==(n=t.pattern)&&void 0!==n||(t.pattern=Cm),vg.init(e,t)})),Sg=Wd("$ZodCUID2",((e,t)=>{var n;null!==(n=t.pattern)&&void 0!==n||(t.pattern=Dm),vg.init(e,t)})),Eg=Wd("$ZodULID",((e,t)=>{var n;null!==(n=t.pattern)&&void 0!==n||(t.pattern=Sm),vg.init(e,t)})),Tg=Wd("$ZodXID",((e,t)=>{var n;null!==(n=t.pattern)&&void 0!==n||(t.pattern=Em),vg.init(e,t)})),Ag=Wd("$ZodKSUID",((e,t)=>{var n;null!==(n=t.pattern)&&void 0!==n||(t.pattern=Tm),vg.init(e,t)})),Mg=Wd("$ZodISODateTime",((e,t)=>{var n;null!==(n=t.pattern)&&void 0!==n||(t.pattern=function(e){const t=Wm({precision:e.precision}),n=["Z"];e.local&&n.push(""),e.offset&&n.push("([+-]\\d{2}:\\d{2})");const r="".concat(t,"(?:").concat(n.join("|"),")");return new RegExp("^".concat(qm,"T(?:").concat(r,")$"))}(t)),vg.init(e,t)})),Fg=Wd("$ZodISODate",((e,t)=>{var n;null!==(n=t.pattern)&&void 0!==n||(t.pattern=Um),vg.init(e,t)})),Ig=Wd("$ZodISOTime",((e,t)=>{var n;null!==(n=t.pattern)&&void 0!==n||(t.pattern=new RegExp("^".concat(Wm(t),"$"))),vg.init(e,t)})),Pg=Wd("$ZodISODuration",((e,t)=>{var n;null!==(n=t.pattern)&&void 0!==n||(t.pattern=Mm),vg.init(e,t)})),zg=Wd("$ZodIPv4",((e,t)=>{var n;null!==(n=t.pattern)&&void 0!==n||(t.pattern=zm),vg.init(e,t),e._zod.onattach.push((e=>{e._zod.bag.format="ipv4"}))})),Og=Wd("$ZodIPv6",((e,t)=>{var n;null!==(n=t.pattern)&&void 0!==n||(t.pattern=Om),vg.init(e,t),e._zod.onattach.push((e=>{e._zod.bag.format="ipv6"})),e._zod.check=n=>{try{new URL("http://[".concat(n.value,"]"))}catch(r){n.issues.push({code:"invalid_format",format:"ipv6",input:n.value,inst:e,continue:!t.abort})}}})),Ng=Wd("$ZodCIDRv4",((e,t)=>{var n;null!==(n=t.pattern)&&void 0!==n||(t.pattern=Nm),vg.init(e,t)})),Bg=Wd("$ZodCIDRv6",((e,t)=>{var n;null!==(n=t.pattern)&&void 0!==n||(t.pattern=Bm),vg.init(e,t),e._zod.check=n=>{const[r,o]=n.value.split("/");try{if(!o)throw new Error;const e=Number(o);if("".concat(e)!==o)throw new Error;if(e<0||e>128)throw new Error;new URL("http://[".concat(r,"]"))}catch(a){n.issues.push({code:"invalid_format",format:"cidrv6",input:n.value,inst:e,continue:!t.abort})}}}));function jg(e){if(""===e)return!0;if(e.length%4!==0)return!1;try{return atob(e),!0}catch(t){return!1}}const Lg=Wd("$ZodBase64",((e,t)=>{var n;null!==(n=t.pattern)&&void 0!==n||(t.pattern=jm),vg.init(e,t),e._zod.onattach.push((e=>{e._zod.bag.contentEncoding="base64"})),e._zod.check=n=>{jg(n.value)||n.issues.push({code:"invalid_format",format:"base64",input:n.value,inst:e,continue:!t.abort})}}));const Rg=Wd("$ZodBase64URL",((e,t)=>{var n;null!==(n=t.pattern)&&void 0!==n||(t.pattern=Lm),vg.init(e,t),e._zod.onattach.push((e=>{e._zod.bag.contentEncoding="base64url"})),e._zod.check=n=>{(function(e){if(!Lm.test(e))return!1;const t=e.replace(/[-_]/g,(e=>"-"===e?"+":"/"));return jg(t.padEnd(4*Math.ceil(t.length/4),"="))})(n.value)||n.issues.push({code:"invalid_format",format:"base64url",input:n.value,inst:e,continue:!t.abort})}})),Vg=Wd("$ZodE164",((e,t)=>{var n;null!==(n=t.pattern)&&void 0!==n||(t.pattern=Vm),vg.init(e,t)}));const qg=Wd("$ZodJWT",((e,t)=>{vg.init(e,t),e._zod.check=n=>{(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;try{const n=e.split(".");if(3!==n.length)return!1;const[r]=n;if(!r)return!1;const o=JSON.parse(atob(r));return(!("typ"in o)||"JWT"===(null===o||void 0===o?void 0:o.typ))&&!!o.alg&&(!t||"alg"in o&&o.alg===t)}catch(n){return!1}})(n.value,t.alg)||n.issues.push({code:"invalid_format",format:"jwt",input:n.value,inst:e,continue:!t.abort})}})),Ug=Wd("$ZodNumber",((e,t)=>{var n;gg.init(e,t),e._zod.pattern=null!==(n=e._zod.bag.pattern)&&void 0!==n?n:Hm,e._zod.parse=(n,r)=>{if(t.coerce)try{n.value=Number(n.value)}catch(i){}const o=n.value;if("number"===typeof o&&!Number.isNaN(o)&&Number.isFinite(o))return n;const a="number"===typeof o?Number.isNaN(o)?"NaN":Number.isFinite(o)?void 0:"Infinity":void 0;return n.issues.push(so({expected:"number",code:"invalid_type",input:o,inst:e},a?{received:a}:{})),n}})),Wg=Wd("$ZodNumber",((e,t)=>{ng.init(e,t),Ug.init(e,t)})),Gg=Wd("$ZodBoolean",((e,t)=>{gg.init(e,t),e._zod.pattern=Km,e._zod.parse=(n,r)=>{if(t.coerce)try{n.value=Boolean(n.value)}catch(a){}const o=n.value;return"boolean"===typeof o||n.issues.push({expected:"boolean",code:"invalid_type",input:o,inst:e}),n}})),Hg=Wd("$ZodNull",((e,t)=>{gg.init(e,t),e._zod.pattern=Zm,e._zod.values=new Set([null]),e._zod.parse=(t,n)=>{const r=t.value;return null===r||t.issues.push({expected:"null",code:"invalid_type",input:r,inst:e}),t}})),Kg=Wd("$ZodAny",((e,t)=>{gg.init(e,t),e._zod.parse=e=>e})),Zg=Wd("$ZodUnknown",((e,t)=>{gg.init(e,t),e._zod.parse=e=>e})),$g=Wd("$ZodNever",((e,t)=>{gg.init(e,t),e._zod.parse=(t,n)=>(t.issues.push({expected:"never",code:"invalid_type",input:t.value,inst:e}),t)}));function Xg(e,t,n){e.issues.length&&t.issues.push(...Bd(n,e.issues)),t.value[n]=e.value}const Jg=Wd("$ZodArray",((e,t)=>{gg.init(e,t),e._zod.parse=(n,r)=>{const o=n.value;if(!Array.isArray(o))return n.issues.push({expected:"array",code:"invalid_type",input:o,inst:e}),n;n.value=Array(o.length);const a=[];for(let e=0;e<o.length;e++){const i=o[e],s=t.element._zod.run({value:i,issues:[]},r);s instanceof Promise?a.push(s.then((t=>Xg(t,n,e)))):Xg(s,n,e)}return a.length?Promise.all(a).then((()=>n)):n}}));function Qg(e,t,n){e.issues.length&&t.issues.push(...Bd(n,e.issues)),t.value[n]=e.value}function Yg(e,t,n,r){e.issues.length?void 0===r[n]?t.value[n]=n in r?void 0:e.value:t.issues.push(...Bd(n,e.issues)):void 0===e.value?n in r&&(t.value[n]=void 0):t.value[n]=e.value}const e_=Wd("$ZodObject",((e,t)=>{gg.init(e,t);const n=bd((()=>{const e=Object.keys(t.shape);for(const r of e)if(!(t.shape[r]instanceof gg))throw new Error('Invalid element at key "'.concat(r,'": expected a Zod schema'));const n=function(e){return Object.keys(e).filter((t=>"optional"===e[t]._zod.optin&&"optional"===e[t]._zod.optout))}(t.shape);return{shape:t.shape,keys:e,keySet:new Set(e),numKeys:e.length,optionalKeys:new Set(n)}}));Cd(e._zod,"propValues",(()=>{const e=t.shape,n={};for(const t in e){const o=e[t]._zod;if(o.values){var r;null!==(r=n[t])&&void 0!==r||(n[t]=new Set);for(const e of o.values)n[t].add(e)}}return n}));let r;const o=Td,a=!Hd.jitless,i=a&&Ad.value,s=t.catchall;let l;e._zod.parse=(c,u)=>{null!==l&&void 0!==l||(l=n.value);const d=c.value;if(!o(d))return c.issues.push({expected:"object",code:"invalid_type",input:d,inst:e}),c;const p=[];if(a&&i&&!1===(null===u||void 0===u?void 0:u.async)&&!0!==u.jitless)r||(r=(e=>{const t=new fg(["shape","payload","ctx"]),r=n.value,o=e=>{const t=Sd(e);return"shape[".concat(t,"]._zod.run({ value: input[").concat(t,"], issues: [] }, ctx)")};t.write("const input = payload.value;");const a=Object.create(null);let i=0;for(const n of r.keys)a[n]="key_".concat(i++);t.write("const newResult = {}");for(const n of r.keys)if(r.optionalKeys.has(n)){const e=a[n];t.write("const ".concat(e," = ").concat(o(n),";"));const r=Sd(n);t.write("\n        if (".concat(e,".issues.length) {\n          if (input[").concat(r,"] === undefined) {\n            if (").concat(r," in input) {\n              newResult[").concat(r,"] = undefined;\n            }\n          } else {\n            payload.issues = payload.issues.concat(\n              ").concat(e,".issues.map((iss) => ({\n                ...iss,\n                path: iss.path ? [").concat(r,", ...iss.path] : [").concat(r,"],\n              }))\n            );\n          }\n        } else if (").concat(e,".value === undefined) {\n          if (").concat(r," in input) newResult[").concat(r,"] = undefined;\n        } else {\n          newResult[").concat(r,"] = ").concat(e,".value;\n        }\n        "))}else{const e=a[n];t.write("const ".concat(e," = ").concat(o(n),";")),t.write("\n          if (".concat(e,".issues.length) payload.issues = payload.issues.concat(").concat(e,".issues.map(iss => ({\n            ...iss,\n            path: iss.path ? [").concat(Sd(n),", ...iss.path] : [").concat(Sd(n),"]\n          })));")),t.write("newResult[".concat(Sd(n),"] = ").concat(e,".value"))}t.write("payload.value = newResult;"),t.write("return payload;");const s=t.compile();return(t,n)=>s(e,t,n)})(t.shape)),c=r(c,u);else{c.value={};const e=l.shape;for(const t of l.keys){const n=e[t],r=n._zod.run({value:d[t],issues:[]},u),o="optional"===n._zod.optin&&"optional"===n._zod.optout;r instanceof Promise?p.push(r.then((e=>o?Yg(e,c,t,d):Qg(e,c,t)))):o?Yg(r,c,t,d):Qg(r,c,t)}}if(!s)return p.length?Promise.all(p).then((()=>c)):c;const h=[],f=l.keySet,m=s._zod,g=m.def.type;for(const e of Object.keys(d)){if(f.has(e))continue;if("never"===g){h.push(e);continue}const t=m.run({value:d[e],issues:[]},u);t instanceof Promise?p.push(t.then((t=>Qg(t,c,e)))):Qg(t,c,e)}return h.length&&c.issues.push({code:"unrecognized_keys",keys:h,input:d,inst:e}),p.length?Promise.all(p).then((()=>c)):c}}));function t_(e,t,n,r){for(const o of e)if(0===o.issues.length)return t.value=o.value,t;return t.issues.push({code:"invalid_union",input:t.value,inst:n,errors:e.map((e=>e.issues.map((e=>Ld(e,r,Kd())))))}),t}const n_=Wd("$ZodUnion",((e,t)=>{gg.init(e,t),Cd(e._zod,"optin",(()=>t.options.some((e=>"optional"===e._zod.optin))?"optional":void 0)),Cd(e._zod,"optout",(()=>t.options.some((e=>"optional"===e._zod.optout))?"optional":void 0)),Cd(e._zod,"values",(()=>{if(t.options.every((e=>e._zod.values)))return new Set(t.options.flatMap((e=>Array.from(e._zod.values))))})),Cd(e._zod,"pattern",(()=>{if(t.options.every((e=>e._zod.pattern))){const e=t.options.map((e=>e._zod.pattern));return new RegExp("^(".concat(e.map((e=>kd(e.source))).join("|"),")$"))}})),e._zod.parse=(n,r)=>{let o=!1;const a=[];for(const e of t.options){const t=e._zod.run({value:n.value,issues:[]},r);if(t instanceof Promise)a.push(t),o=!0;else{if(0===t.issues.length)return t;a.push(t)}}return o?Promise.all(a).then((t=>t_(t,n,e,r))):t_(a,n,e,r)}})),r_=Wd("$ZodDiscriminatedUnion",((e,t)=>{n_.init(e,t);const n=e._zod.parse;Cd(e._zod,"propValues",(()=>{const e={};for(const n of t.options){const r=n._zod.propValues;if(!r||0===Object.keys(r).length)throw new Error('Invalid discriminated union option at index "'.concat(t.options.indexOf(n),'"'));for(const[t,n]of Object.entries(r)){e[t]||(e[t]=new Set);for(const r of n)e[t].add(r)}}return e}));const r=bd((()=>{const e=t.options,n=new Map;for(const r of e){const e=r._zod.propValues[t.discriminator];if(!e||0===e.size)throw new Error('Invalid discriminated union option at index "'.concat(t.options.indexOf(r),'"'));for(const t of e){if(n.has(t))throw new Error('Duplicate discriminator value "'.concat(String(t),'"'));n.set(t,r)}}return n}));e._zod.parse=(o,a)=>{const i=o.value;if(!Td(i))return o.issues.push({code:"invalid_type",expected:"object",input:i,inst:e}),o;const s=r.value.get(null===i||void 0===i?void 0:i[t.discriminator]);return s?s._zod.run(o,a):t.unionFallback?n(o,a):(o.issues.push({code:"invalid_union",errors:[],note:"No matching discriminator",input:i,path:[t.discriminator],inst:e}),o)}})),o_=Wd("$ZodIntersection",((e,t)=>{gg.init(e,t),e._zod.parse=(e,n)=>{const r=e.value,o=t.left._zod.run({value:r,issues:[]},n),a=t.right._zod.run({value:r,issues:[]},n);return o instanceof Promise||a instanceof Promise?Promise.all([o,a]).then((t=>{let[n,r]=t;return i_(e,n,r)})):i_(e,o,a)}}));function a_(e,t){if(e===t)return{valid:!0,data:e};if(e instanceof Date&&t instanceof Date&&+e===+t)return{valid:!0,data:e};if(Md(e)&&Md(t)){const n=Object.keys(t),r=Object.keys(e).filter((e=>-1!==n.indexOf(e))),o=so(so({},e),t);for(const a of r){const n=a_(e[a],t[a]);if(!n.valid)return{valid:!1,mergeErrorPath:[a,...n.mergeErrorPath]};o[a]=n.data}return{valid:!0,data:o}}if(Array.isArray(e)&&Array.isArray(t)){if(e.length!==t.length)return{valid:!1,mergeErrorPath:[]};const n=[];for(let r=0;r<e.length;r++){const o=a_(e[r],t[r]);if(!o.valid)return{valid:!1,mergeErrorPath:[r,...o.mergeErrorPath]};n.push(o.data)}return{valid:!0,data:n}}return{valid:!1,mergeErrorPath:[]}}function i_(e,t,n){if(t.issues.length&&e.issues.push(...t.issues),n.issues.length&&e.issues.push(...n.issues),Nd(e))return e;const r=a_(t.value,n.value);if(!r.valid)throw new Error("Unmergable intersection. Error path: "+"".concat(JSON.stringify(r.mergeErrorPath)));return e.value=r.data,e}const s_=Wd("$ZodTuple",((e,t)=>{gg.init(e,t);const n=t.items,r=n.length-[...n].reverse().findIndex((e=>"optional"!==e._zod.optin));e._zod.parse=(o,a)=>{const i=o.value;if(!Array.isArray(i))return o.issues.push({input:i,inst:e,expected:"tuple",code:"invalid_type"}),o;o.value=[];const s=[];if(!t.rest){const t=i.length>n.length,a=i.length<r-1;if(t||a)return o.issues.push(so({input:i,inst:e,origin:"array"},t?{code:"too_big",maximum:n.length}:{code:"too_small",minimum:n.length})),o}let l=-1;for(const e of n){if(l++,l>=i.length&&l>=r)continue;const t=e._zod.run({value:i[l],issues:[]},a);t instanceof Promise?s.push(t.then((e=>l_(e,o,l)))):l_(t,o,l)}if(t.rest){const e=i.slice(n.length);for(const n of e){l++;const e=t.rest._zod.run({value:n,issues:[]},a);e instanceof Promise?s.push(e.then((e=>l_(e,o,l)))):l_(e,o,l)}}return s.length?Promise.all(s).then((()=>o)):o}}));function l_(e,t,n){e.issues.length&&t.issues.push(...Bd(n,e.issues)),t.value[n]=e.value}const c_=Wd("$ZodRecord",((e,t)=>{gg.init(e,t),e._zod.parse=(n,r)=>{const o=n.value;if(!Md(o))return n.issues.push({expected:"record",code:"invalid_type",input:o,inst:e}),n;const a=[];if(t.keyType._zod.values){const i=t.keyType._zod.values;n.value={};for(const e of i)if("string"===typeof e||"number"===typeof e||"symbol"===typeof e){const i=t.valueType._zod.run({value:o[e],issues:[]},r);i instanceof Promise?a.push(i.then((t=>{t.issues.length&&n.issues.push(...Bd(e,t.issues)),n.value[e]=t.value}))):(i.issues.length&&n.issues.push(...Bd(e,i.issues)),n.value[e]=i.value)}let s;for(const e in o)i.has(e)||(s=null!==s&&void 0!==s?s:[],s.push(e));s&&s.length>0&&n.issues.push({code:"unrecognized_keys",input:o,inst:e,keys:s})}else{n.value={};for(const i of Reflect.ownKeys(o)){if("__proto__"===i)continue;const s=t.keyType._zod.run({value:i,issues:[]},r);if(s instanceof Promise)throw new Error("Async schemas not supported in object keys currently");if(s.issues.length){n.issues.push({origin:"record",code:"invalid_key",issues:s.issues.map((e=>Ld(e,r,Kd()))),input:i,path:[i],inst:e}),n.value[s.value]=s.value;continue}const l=t.valueType._zod.run({value:o[i],issues:[]},r);l instanceof Promise?a.push(l.then((e=>{e.issues.length&&n.issues.push(...Bd(i,e.issues)),n.value[s.value]=e.value}))):(l.issues.length&&n.issues.push(...Bd(i,l.issues)),n.value[s.value]=l.value)}}return a.length?Promise.all(a).then((()=>n)):n}}));const u_=Wd("$ZodEnum",((e,t)=>{gg.init(e,t);const n=yd(t.entries);e._zod.values=new Set(n),e._zod.pattern=new RegExp("^(".concat(n.filter((e=>Fd.has(typeof e))).map((e=>"string"===typeof e?Id(e):e.toString())).join("|"),")$")),e._zod.parse=(t,r)=>{const o=t.value;return e._zod.values.has(o)||t.issues.push({code:"invalid_value",values:n,input:o,inst:e}),t}})),d_=Wd("$ZodLiteral",((e,t)=>{gg.init(e,t),e._zod.values=new Set(t.values),e._zod.pattern=new RegExp("^(".concat(t.values.map((e=>"string"===typeof e?Id(e):e?e.toString():String(e))).join("|"),")$")),e._zod.parse=(n,r)=>{const o=n.value;return e._zod.values.has(o)||n.issues.push({code:"invalid_value",values:t.values,input:o,inst:e}),n}})),p_=Wd("$ZodTransform",((e,t)=>{gg.init(e,t),e._zod.parse=(e,n)=>{const r=t.transform(e.value,e);if(n.async){return(r instanceof Promise?r:Promise.resolve(r)).then((t=>(e.value=t,e)))}if(r instanceof Promise)throw new Gd;return e.value=r,e}})),h_=Wd("$ZodOptional",((e,t)=>{gg.init(e,t),e._zod.optin="optional",e._zod.optout="optional",Cd(e._zod,"values",(()=>t.innerType._zod.values?new Set([...t.innerType._zod.values,void 0]):void 0)),Cd(e._zod,"pattern",(()=>{const e=t.innerType._zod.pattern;return e?new RegExp("^(".concat(kd(e.source),")?$")):void 0})),e._zod.parse=(e,n)=>"optional"===t.innerType._zod.optin?t.innerType._zod.run(e,n):void 0===e.value?e:t.innerType._zod.run(e,n)})),f_=Wd("$ZodNullable",((e,t)=>{gg.init(e,t),Cd(e._zod,"optin",(()=>t.innerType._zod.optin)),Cd(e._zod,"optout",(()=>t.innerType._zod.optout)),Cd(e._zod,"pattern",(()=>{const e=t.innerType._zod.pattern;return e?new RegExp("^(".concat(kd(e.source),"|null)$")):void 0})),Cd(e._zod,"values",(()=>t.innerType._zod.values?new Set([...t.innerType._zod.values,null]):void 0)),e._zod.parse=(e,n)=>null===e.value?e:t.innerType._zod.run(e,n)})),m_=Wd("$ZodDefault",((e,t)=>{gg.init(e,t),e._zod.optin="optional",Cd(e._zod,"values",(()=>t.innerType._zod.values)),e._zod.parse=(e,n)=>{if(void 0===e.value)return e.value=t.defaultValue,e;const r=t.innerType._zod.run(e,n);return r instanceof Promise?r.then((e=>g_(e,t))):g_(r,t)}}));function g_(e,t){return void 0===e.value&&(e.value=t.defaultValue),e}const __=Wd("$ZodPrefault",((e,t)=>{gg.init(e,t),e._zod.optin="optional",Cd(e._zod,"values",(()=>t.innerType._zod.values)),e._zod.parse=(e,n)=>(void 0===e.value&&(e.value=t.defaultValue),t.innerType._zod.run(e,n))})),v_=Wd("$ZodNonOptional",((e,t)=>{gg.init(e,t),Cd(e._zod,"values",(()=>{const e=t.innerType._zod.values;return e?new Set([...e].filter((e=>void 0!==e))):void 0})),e._zod.parse=(n,r)=>{const o=t.innerType._zod.run(n,r);return o instanceof Promise?o.then((t=>y_(t,e))):y_(o,e)}}));function y_(e,t){return e.issues.length||void 0!==e.value||e.issues.push({code:"invalid_type",expected:"nonoptional",input:e.value,inst:t}),e}const w_=Wd("$ZodCatch",((e,t)=>{gg.init(e,t),e._zod.optin="optional",Cd(e._zod,"optout",(()=>t.innerType._zod.optout)),Cd(e._zod,"values",(()=>t.innerType._zod.values)),e._zod.parse=(e,n)=>{const r=t.innerType._zod.run(e,n);return r instanceof Promise?r.then((r=>(e.value=r.value,r.issues.length&&(e.value=t.catchValue(so(so({},e),{},{error:{issues:r.issues.map((e=>Ld(e,n,Kd())))},input:e.value})),e.issues=[]),e))):(e.value=r.value,r.issues.length&&(e.value=t.catchValue(so(so({},e),{},{error:{issues:r.issues.map((e=>Ld(e,n,Kd())))},input:e.value})),e.issues=[]),e)}})),b_=Wd("$ZodPipe",((e,t)=>{gg.init(e,t),Cd(e._zod,"values",(()=>t.in._zod.values)),Cd(e._zod,"optin",(()=>t.in._zod.optin)),Cd(e._zod,"optout",(()=>t.out._zod.optout)),e._zod.parse=(e,n)=>{const r=t.in._zod.run(e,n);return r instanceof Promise?r.then((e=>x_(e,t,n))):x_(r,t,n)}}));function x_(e,t,n){return Nd(e)?e:t.out._zod.run({value:e.value,issues:e.issues},n)}const k_=Wd("$ZodReadonly",((e,t)=>{gg.init(e,t),Cd(e._zod,"propValues",(()=>t.innerType._zod.propValues)),Cd(e._zod,"values",(()=>t.innerType._zod.values)),Cd(e._zod,"optin",(()=>t.innerType._zod.optin)),Cd(e._zod,"optout",(()=>t.innerType._zod.optout)),e._zod.parse=(e,n)=>{const r=t.innerType._zod.run(e,n);return r instanceof Promise?r.then(C_):C_(r)}}));function C_(e){return e.value=Object.freeze(e.value),e}const D_=Wd("$ZodLazy",((e,t)=>{gg.init(e,t),Cd(e._zod,"innerType",(()=>t.getter())),Cd(e._zod,"pattern",(()=>e._zod.innerType._zod.pattern)),Cd(e._zod,"propValues",(()=>e._zod.innerType._zod.propValues)),Cd(e._zod,"optin",(()=>e._zod.innerType._zod.optin)),Cd(e._zod,"optout",(()=>e._zod.innerType._zod.optout)),e._zod.parse=(t,n)=>e._zod.innerType._zod.run(t,n)})),S_=Wd("$ZodCustom",((e,t)=>{Jm.init(e,t),gg.init(e,t),e._zod.parse=(e,t)=>e,e._zod.check=n=>{const r=n.value,o=t.fn(r);if(o instanceof Promise)return o.then((t=>E_(t,n,r,e)));E_(o,n,r,e)}}));function E_(e,t,n,r){if(!e){var o;const e={code:"custom",input:n,inst:r,path:[...null!==(o=r._zod.def.path)&&void 0!==o?o:[]],continue:!r._zod.def.abort};r._zod.def.params&&(e.params=r._zod.def.params),t.issues.push(Vd(e))}}function T_(e,t){return new e(so({type:"string",format:"guid",check:"string_format",abort:!1},zd(t)))}function A_(e,t){return new e(so({type:"string",format:"base64",check:"string_format",abort:!1},zd(t)))}function M_(e,t){return new Ym(so(so({check:"less_than"},zd(t)),{},{value:e,inclusive:!1}))}function F_(e,t){return new Ym(so(so({check:"less_than"},zd(t)),{},{value:e,inclusive:!0}))}function I_(e,t){return new eg(so(so({check:"greater_than"},zd(t)),{},{value:e,inclusive:!1}))}function P_(e,t){return new eg(so(so({check:"greater_than"},zd(t)),{},{value:e,inclusive:!0}))}function z_(e,t){return new tg(so(so({check:"multiple_of"},zd(t)),{},{value:e}))}function O_(e,t){return new rg(so(so({check:"max_length"},zd(t)),{},{maximum:e}))}function N_(e,t){return new og(so(so({check:"min_length"},zd(t)),{},{minimum:e}))}function B_(e,t){return new ag(so(so({check:"length_equals"},zd(t)),{},{length:e}))}function j_(e){return new hg({check:"overwrite",tx:e})}const L_=Wd("ZodISODateTime",((e,t)=>{Mg.init(e,t),J_.init(e,t)}));function R_(e){return function(e,t){return new e(so({type:"string",format:"datetime",check:"string_format",offset:!1,local:!1,precision:null},zd(t)))}(L_,e)}const V_=Wd("ZodISODate",((e,t)=>{Fg.init(e,t),J_.init(e,t)}));function q_(e){return function(e,t){return new e(so({type:"string",format:"date",check:"string_format"},zd(t)))}(V_,e)}const U_=Wd("ZodISOTime",((e,t)=>{Ig.init(e,t),J_.init(e,t)}));function W_(e){return function(e,t){return new e(so({type:"string",format:"time",check:"string_format",precision:null},zd(t)))}(U_,e)}const G_=Wd("ZodISODuration",((e,t)=>{Pg.init(e,t),J_.init(e,t)}));function H_(e){return function(e,t){return new e(so({type:"string",format:"duration",check:"string_format"},zd(t)))}(G_,e)}const K_=Wd("ZodType",((e,t)=>(gg.init(e,t),e.def=t,Object.defineProperty(e,"_def",{value:t}),e.check=function(){for(var n,r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return e.clone(so(so({},t),{},{checks:[...null!==(n=t.checks)&&void 0!==n?n:[],...o.map((e=>"function"===typeof e?{_zod:{check:e,def:{check:"custom"},onattach:[]}}:e))]}))},e.clone=(t,n)=>Pd(e,t,n),e.brand=()=>e,e.register=(t,n)=>(t.add(e,n),e),e.parse=(t,n)=>ap(e,t,n,{callee:e.parse}),e.safeParse=(t,n)=>sp(e,t,n),e.parseAsync=async(t,n)=>ip(e,t,n,{callee:e.parseAsync}),e.safeParseAsync=async(t,n)=>lp(e,t,n),e.spa=e.safeParseAsync,e.refine=(t,n)=>e.check(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function(e,t,n){return new e(so({type:"custom",check:"custom",fn:t},zd(n)))}(py,e,t)}(t,n)),e.superRefine=t=>e.check(function(e){const t=function(e){const t=new Jm({check:"custom"});return t._zod.check=e,t}((n=>(n.addIssue=e=>{if("string"===typeof e)n.issues.push(Vd(e,n.value,t._zod.def));else{var r,o,a,i;const s=e;s.fatal&&(s.continue=!1),null!==(r=s.code)&&void 0!==r||(s.code="custom"),null!==(o=s.input)&&void 0!==o||(s.input=n.value),null!==(a=s.inst)&&void 0!==a||(s.inst=t),null!==(i=s.continue)&&void 0!==i||(s.continue=!t._zod.def.abort),n.issues.push(Vd(s))}},e(n.value,n))));return t}(t)),e.overwrite=t=>e.check(j_(t)),e.optional=()=>ey(e),e.nullable=()=>ny(e),e.nullish=()=>ey(ny(e)),e.nonoptional=t=>function(e,t){return new ay(so({type:"nonoptional",innerType:e},zd(t)))}(e,t),e.array=()=>Pv(e),e.or=t=>Lv([e,t]),e.and=t=>new qv({type:"intersection",left:e,right:t}),e.transform=t=>ly(e,Qv(t)),e.default=t=>{return n=t,new ry({type:"default",innerType:e,get defaultValue(){return"function"===typeof n?n():n}});var n},e.prefault=t=>{return n=t,new oy({type:"prefault",innerType:e,get defaultValue(){return"function"===typeof n?n():n}});var n},e.catch=t=>{return new iy({type:"catch",innerType:e,catchValue:"function"===typeof(n=t)?n:()=>n});var n},e.pipe=t=>ly(e,t),e.readonly=()=>new cy({type:"readonly",innerType:e}),e.describe=t=>{const n=e.clone();return vd.add(n,{description:t}),n},Object.defineProperty(e,"description",{get(){var t;return null===(t=vd.get(e))||void 0===t?void 0:t.description},configurable:!0}),e.meta=function(){if(0===arguments.length)return vd.get(e);const t=e.clone();return vd.add(t,arguments.length<=0?void 0:arguments[0]),t},e.isOptional=()=>e.safeParse(void 0).success,e.isNullable=()=>e.safeParse(null).success,e))),Z_=Wd("_ZodString",((e,t)=>{var n,r,o;_g.init(e,t),K_.init(e,t);const a=e._zod.bag;e.format=null!==(n=a.format)&&void 0!==n?n:null,e.minLength=null!==(r=a.minimum)&&void 0!==r?r:null,e.maxLength=null!==(o=a.maximum)&&void 0!==o?o:null,e.regex=function(){return e.check(function(e,t){return new sg(so(so({check:"string_format",format:"regex"},zd(t)),{},{pattern:e}))}(...arguments))},e.includes=function(){return e.check(function(e,t){return new ug(so(so({check:"string_format",format:"includes"},zd(t)),{},{includes:e}))}(...arguments))},e.startsWith=function(){return e.check(function(e,t){return new dg(so(so({check:"string_format",format:"starts_with"},zd(t)),{},{prefix:e}))}(...arguments))},e.endsWith=function(){return e.check(function(e,t){return new pg(so(so({check:"string_format",format:"ends_with"},zd(t)),{},{suffix:e}))}(...arguments))},e.min=function(){return e.check(N_(...arguments))},e.max=function(){return e.check(O_(...arguments))},e.length=function(){return e.check(B_(...arguments))},e.nonempty=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e.check(N_(1,...n))},e.lowercase=t=>e.check(function(e){return new lg(so({check:"string_format",format:"lowercase"},zd(e)))}(t)),e.uppercase=t=>e.check(function(e){return new cg(so({check:"string_format",format:"uppercase"},zd(e)))}(t)),e.trim=()=>e.check(j_((e=>e.trim()))),e.normalize=function(){return e.check(function(e){return j_((t=>t.normalize(e)))}(...arguments))},e.toLowerCase=()=>e.check(j_((e=>e.toLowerCase()))),e.toUpperCase=()=>e.check(j_((e=>e.toUpperCase())))})),$_=Wd("ZodString",((e,t)=>{_g.init(e,t),Z_.init(e,t),e.email=t=>e.check(function(e,t){return new e(so({type:"string",format:"email",check:"string_format",abort:!1},zd(t)))}(Q_,t)),e.url=t=>e.check(function(e,t){return new e(so({type:"string",format:"url",check:"string_format",abort:!1},zd(t)))}(tv,t)),e.jwt=t=>e.check(function(e,t){return new e(so({type:"string",format:"jwt",check:"string_format",abort:!1},zd(t)))}(_v,t)),e.emoji=t=>e.check(function(e,t){return new e(so({type:"string",format:"emoji",check:"string_format",abort:!1},zd(t)))}(nv,t)),e.guid=t=>e.check(T_(Y_,t)),e.uuid=t=>e.check(function(e,t){return new e(so({type:"string",format:"uuid",check:"string_format",abort:!1},zd(t)))}(ev,t)),e.uuidv4=t=>e.check(function(e,t){return new e(so({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v4"},zd(t)))}(ev,t)),e.uuidv6=t=>e.check(function(e,t){return new e(so({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v6"},zd(t)))}(ev,t)),e.uuidv7=t=>e.check(function(e,t){return new e(so({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v7"},zd(t)))}(ev,t)),e.nanoid=t=>e.check(function(e,t){return new e(so({type:"string",format:"nanoid",check:"string_format",abort:!1},zd(t)))}(rv,t)),e.guid=t=>e.check(T_(Y_,t)),e.cuid=t=>e.check(function(e,t){return new e(so({type:"string",format:"cuid",check:"string_format",abort:!1},zd(t)))}(ov,t)),e.cuid2=t=>e.check(function(e,t){return new e(so({type:"string",format:"cuid2",check:"string_format",abort:!1},zd(t)))}(av,t)),e.ulid=t=>e.check(function(e,t){return new e(so({type:"string",format:"ulid",check:"string_format",abort:!1},zd(t)))}(iv,t)),e.base64=t=>e.check(A_(hv,t)),e.base64url=t=>e.check(function(e,t){return new e(so({type:"string",format:"base64url",check:"string_format",abort:!1},zd(t)))}(mv,t)),e.xid=t=>e.check(function(e,t){return new e(so({type:"string",format:"xid",check:"string_format",abort:!1},zd(t)))}(sv,t)),e.ksuid=t=>e.check(function(e,t){return new e(so({type:"string",format:"ksuid",check:"string_format",abort:!1},zd(t)))}(lv,t)),e.ipv4=t=>e.check(function(e,t){return new e(so({type:"string",format:"ipv4",check:"string_format",abort:!1},zd(t)))}(cv,t)),e.ipv6=t=>e.check(function(e,t){return new e(so({type:"string",format:"ipv6",check:"string_format",abort:!1},zd(t)))}(uv,t)),e.cidrv4=t=>e.check(function(e,t){return new e(so({type:"string",format:"cidrv4",check:"string_format",abort:!1},zd(t)))}(dv,t)),e.cidrv6=t=>e.check(function(e,t){return new e(so({type:"string",format:"cidrv6",check:"string_format",abort:!1},zd(t)))}(pv,t)),e.e164=t=>e.check(function(e,t){return new e(so({type:"string",format:"e164",check:"string_format",abort:!1},zd(t)))}(gv,t)),e.datetime=t=>e.check(R_(t)),e.date=t=>e.check(q_(t)),e.time=t=>e.check(W_(t)),e.duration=t=>e.check(H_(t))}));function X_(e){return function(e,t){return new e(so({type:"string"},zd(t)))}($_,e)}const J_=Wd("ZodStringFormat",((e,t)=>{vg.init(e,t),Z_.init(e,t)})),Q_=Wd("ZodEmail",((e,t)=>{bg.init(e,t),J_.init(e,t)}));const Y_=Wd("ZodGUID",((e,t)=>{yg.init(e,t),J_.init(e,t)}));const ev=Wd("ZodUUID",((e,t)=>{wg.init(e,t),J_.init(e,t)}));const tv=Wd("ZodURL",((e,t)=>{xg.init(e,t),J_.init(e,t)}));const nv=Wd("ZodEmoji",((e,t)=>{kg.init(e,t),J_.init(e,t)}));const rv=Wd("ZodNanoID",((e,t)=>{Cg.init(e,t),J_.init(e,t)}));const ov=Wd("ZodCUID",((e,t)=>{Dg.init(e,t),J_.init(e,t)}));const av=Wd("ZodCUID2",((e,t)=>{Sg.init(e,t),J_.init(e,t)}));const iv=Wd("ZodULID",((e,t)=>{Eg.init(e,t),J_.init(e,t)}));const sv=Wd("ZodXID",((e,t)=>{Tg.init(e,t),J_.init(e,t)}));const lv=Wd("ZodKSUID",((e,t)=>{Ag.init(e,t),J_.init(e,t)}));const cv=Wd("ZodIPv4",((e,t)=>{zg.init(e,t),J_.init(e,t)}));const uv=Wd("ZodIPv6",((e,t)=>{Og.init(e,t),J_.init(e,t)}));const dv=Wd("ZodCIDRv4",((e,t)=>{Ng.init(e,t),J_.init(e,t)}));const pv=Wd("ZodCIDRv6",((e,t)=>{Bg.init(e,t),J_.init(e,t)}));const hv=Wd("ZodBase64",((e,t)=>{Lg.init(e,t),J_.init(e,t)}));function fv(e){return A_(hv,e)}const mv=Wd("ZodBase64URL",((e,t)=>{Rg.init(e,t),J_.init(e,t)}));const gv=Wd("ZodE164",((e,t)=>{Vg.init(e,t),J_.init(e,t)}));const _v=Wd("ZodJWT",((e,t)=>{qg.init(e,t),J_.init(e,t)}));const vv=Wd("ZodNumber",((e,t)=>{var n,r,o,a,i,s,l,c,u;Ug.init(e,t),K_.init(e,t),e.gt=(t,n)=>e.check(I_(t,n)),e.gte=(t,n)=>e.check(P_(t,n)),e.min=(t,n)=>e.check(P_(t,n)),e.lt=(t,n)=>e.check(M_(t,n)),e.lte=(t,n)=>e.check(F_(t,n)),e.max=(t,n)=>e.check(F_(t,n)),e.int=t=>e.check(bv(t)),e.safe=t=>e.check(bv(t)),e.positive=t=>e.check(I_(0,t)),e.nonnegative=t=>e.check(P_(0,t)),e.negative=t=>e.check(M_(0,t)),e.nonpositive=t=>e.check(F_(0,t)),e.multipleOf=(t,n)=>e.check(z_(t,n)),e.step=(t,n)=>e.check(z_(t,n)),e.finite=()=>e;const d=e._zod.bag;e.minValue=null!==(n=Math.max(null!==(r=d.minimum)&&void 0!==r?r:Number.NEGATIVE_INFINITY,null!==(o=d.exclusiveMinimum)&&void 0!==o?o:Number.NEGATIVE_INFINITY))&&void 0!==n?n:null,e.maxValue=null!==(a=Math.min(null!==(i=d.maximum)&&void 0!==i?i:Number.POSITIVE_INFINITY,null!==(s=d.exclusiveMaximum)&&void 0!==s?s:Number.POSITIVE_INFINITY))&&void 0!==a?a:null,e.isInt=(null!==(l=d.format)&&void 0!==l?l:"").includes("int")||Number.isSafeInteger(null!==(c=d.multipleOf)&&void 0!==c?c:.5),e.isFinite=!0,e.format=null!==(u=d.format)&&void 0!==u?u:null}));function yv(e){return function(e,t){return new e(so({type:"number",checks:[]},zd(t)))}(vv,e)}const wv=Wd("ZodNumberFormat",((e,t)=>{Wg.init(e,t),vv.init(e,t)}));function bv(e){return function(e,t){return new e(so({type:"number",check:"number_format",abort:!1,format:"safeint"},zd(t)))}(wv,e)}const xv=Wd("ZodBoolean",((e,t)=>{Gg.init(e,t),K_.init(e,t)}));function kv(e){return function(e,t){return new e(so({type:"boolean"},zd(t)))}(xv,e)}const Cv=Wd("ZodNull",((e,t)=>{Hg.init(e,t),K_.init(e,t)}));function Dv(e){return function(e,t){return new e(so({type:"null"},zd(t)))}(Cv,e)}const Sv=Wd("ZodAny",((e,t)=>{Kg.init(e,t),K_.init(e,t)}));function Ev(){return function(e){return new e({type:"any"})}(Sv)}const Tv=Wd("ZodUnknown",((e,t)=>{Zg.init(e,t),K_.init(e,t)}));function Av(){return function(e){return new e({type:"unknown"})}(Tv)}const Mv=Wd("ZodNever",((e,t)=>{$g.init(e,t),K_.init(e,t)}));function Fv(e){return function(e,t){return new e(so({type:"never"},zd(t)))}(Mv,e)}const Iv=Wd("ZodArray",((e,t)=>{Jg.init(e,t),K_.init(e,t),e.element=t.element,e.min=(t,n)=>e.check(N_(t,n)),e.nonempty=t=>e.check(N_(1,t)),e.max=(t,n)=>e.check(O_(t,n)),e.length=(t,n)=>e.check(B_(t,n)),e.unwrap=()=>e.element}));function Pv(e,t){return function(e,t,n){return new e(so({type:"array",element:t},zd(n)))}(Iv,e,t)}const zv=Wd("ZodObject",((e,t)=>{e_.init(e,t),K_.init(e,t),Cd(e,"shape",(()=>t.shape)),e.keyof=()=>Zv(Object.keys(e._zod.def.shape)),e.catchall=t=>e.clone(so(so({},e._zod.def),{},{catchall:t})),e.passthrough=()=>e.clone(so(so({},e._zod.def),{},{catchall:Av()})),e.loose=()=>e.clone(so(so({},e._zod.def),{},{catchall:Av()})),e.strict=()=>e.clone(so(so({},e._zod.def),{},{catchall:Fv()})),e.strip=()=>e.clone(so(so({},e._zod.def),{},{catchall:void 0})),e.extend=t=>function(e,t){if(!Md(t))throw new Error("Invalid input to extend: expected a plain object");const n=so(so({},e._zod.def),{},{get shape(){const n=so(so({},e._zod.def.shape),t);return Dd(this,"shape",n),n},checks:[]});return Pd(e,n)}(e,t),e.merge=t=>function(e,t){return Pd(e,so(so({},e._zod.def),{},{get shape(){const n=so(so({},e._zod.def.shape),t._zod.def.shape);return Dd(this,"shape",n),n},catchall:t._zod.def.catchall,checks:[]}))}(e,t),e.pick=t=>function(e,t){const n={},r=e._zod.def;for(const o in t){if(!(o in r.shape))throw new Error('Unrecognized key: "'.concat(o,'"'));t[o]&&(n[o]=r.shape[o])}return Pd(e,so(so({},e._zod.def),{},{shape:n,checks:[]}))}(e,t),e.omit=t=>function(e,t){const n=so({},e._zod.def.shape),r=e._zod.def;for(const o in t){if(!(o in r.shape))throw new Error('Unrecognized key: "'.concat(o,'"'));t[o]&&delete n[o]}return Pd(e,so(so({},e._zod.def),{},{shape:n,checks:[]}))}(e,t),e.partial=function(){return function(e,t,n){const r=t._zod.def.shape,o=so({},r);if(n)for(const a in n){if(!(a in r))throw new Error('Unrecognized key: "'.concat(a,'"'));n[a]&&(o[a]=e?new e({type:"optional",innerType:r[a]}):r[a])}else for(const a in r)o[a]=e?new e({type:"optional",innerType:r[a]}):r[a];return Pd(t,so(so({},t._zod.def),{},{shape:o,checks:[]}))}(Yv,e,arguments.length<=0?void 0:arguments[0])},e.required=function(){return function(e,t,n){const r=t._zod.def.shape,o=so({},r);if(n)for(const a in n){if(!(a in o))throw new Error('Unrecognized key: "'.concat(a,'"'));n[a]&&(o[a]=new e({type:"nonoptional",innerType:r[a]}))}else for(const a in r)o[a]=new e({type:"nonoptional",innerType:r[a]});return Pd(t,so(so({},t._zod.def),{},{shape:o,checks:[]}))}(ay,e,arguments.length<=0?void 0:arguments[0])}}));function Ov(e,t){const n=so({type:"object",get shape(){return Dd(this,"shape",so({},e)),this.shape}},zd(t));return new zv(n)}function Nv(e,t){return new zv(so({type:"object",get shape(){return Dd(this,"shape",so({},e)),this.shape},catchall:Fv()},zd(t)))}function Bv(e,t){return new zv(so({type:"object",get shape(){return Dd(this,"shape",so({},e)),this.shape},catchall:Av()},zd(t)))}const jv=Wd("ZodUnion",((e,t)=>{n_.init(e,t),K_.init(e,t),e.options=t.options}));function Lv(e,t){return new jv(so({type:"union",options:e},zd(t)))}const Rv=Wd("ZodDiscriminatedUnion",((e,t)=>{jv.init(e,t),r_.init(e,t)}));function Vv(e,t,n){return new Rv(so({type:"union",options:t,discriminator:e},zd(n)))}const qv=Wd("ZodIntersection",((e,t)=>{o_.init(e,t),K_.init(e,t)}));const Uv=Wd("ZodTuple",((e,t)=>{s_.init(e,t),K_.init(e,t),e.rest=t=>e.clone(so(so({},e._zod.def),{},{rest:t}))}));function Wv(e,t,n){const r=t instanceof gg;return new Uv(so({type:"tuple",items:e,rest:r?t:null},zd(r?n:t)))}const Gv=Wd("ZodRecord",((e,t)=>{c_.init(e,t),K_.init(e,t),e.keyType=t.keyType,e.valueType=t.valueType}));function Hv(e,t,n){return new Gv(so({type:"record",keyType:e,valueType:t},zd(n)))}const Kv=Wd("ZodEnum",((e,t)=>{u_.init(e,t),K_.init(e,t),e.enum=t.entries,e.options=Object.values(t.entries);const n=new Set(Object.keys(t.entries));e.extract=(e,r)=>{const o={};for(const a of e){if(!n.has(a))throw new Error("Key ".concat(a," not found in enum"));o[a]=t.entries[a]}return new Kv(so(so(so({},t),{},{checks:[]},zd(r)),{},{entries:o}))},e.exclude=(e,r)=>{const o=so({},t.entries);for(const t of e){if(!n.has(t))throw new Error("Key ".concat(t," not found in enum"));delete o[t]}return new Kv(so(so(so({},t),{},{checks:[]},zd(r)),{},{entries:o}))}}));function Zv(e,t){const n=Array.isArray(e)?Object.fromEntries(e.map((e=>[e,e]))):e;return new Kv(so({type:"enum",entries:n},zd(t)))}const $v=Wd("ZodLiteral",((e,t)=>{d_.init(e,t),K_.init(e,t),e.values=new Set(t.values),Object.defineProperty(e,"value",{get(){if(t.values.length>1)throw new Error("This schema contains multiple valid literal values. Use `.values` instead.");return t.values[0]}})}));function Xv(e,t){return new $v(so({type:"literal",values:Array.isArray(e)?e:[e]},zd(t)))}const Jv=Wd("ZodTransform",((e,t)=>{p_.init(e,t),K_.init(e,t),e._zod.parse=(n,r)=>{n.addIssue=r=>{if("string"===typeof r)n.issues.push(Vd(r,n.value,t));else{var o,a,i,s;const t=r;t.fatal&&(t.continue=!1),null!==(o=t.code)&&void 0!==o||(t.code="custom"),null!==(a=t.input)&&void 0!==a||(t.input=n.value),null!==(i=t.inst)&&void 0!==i||(t.inst=e),null!==(s=t.continue)&&void 0!==s||(t.continue=!0),n.issues.push(Vd(t))}};const o=t.transform(n.value,n);return o instanceof Promise?o.then((e=>(n.value=e,n))):(n.value=o,n)}}));function Qv(e){return new Jv({type:"transform",transform:e})}const Yv=Wd("ZodOptional",((e,t)=>{h_.init(e,t),K_.init(e,t),e.unwrap=()=>e._zod.def.innerType}));function ey(e){return new Yv({type:"optional",innerType:e})}const ty=Wd("ZodNullable",((e,t)=>{f_.init(e,t),K_.init(e,t),e.unwrap=()=>e._zod.def.innerType}));function ny(e){return new ty({type:"nullable",innerType:e})}const ry=Wd("ZodDefault",((e,t)=>{m_.init(e,t),K_.init(e,t),e.unwrap=()=>e._zod.def.innerType,e.removeDefault=e.unwrap}));const oy=Wd("ZodPrefault",((e,t)=>{__.init(e,t),K_.init(e,t),e.unwrap=()=>e._zod.def.innerType}));const ay=Wd("ZodNonOptional",((e,t)=>{v_.init(e,t),K_.init(e,t),e.unwrap=()=>e._zod.def.innerType}));const iy=Wd("ZodCatch",((e,t)=>{w_.init(e,t),K_.init(e,t),e.unwrap=()=>e._zod.def.innerType,e.removeCatch=e.unwrap}));const sy=Wd("ZodPipe",((e,t)=>{b_.init(e,t),K_.init(e,t),e.in=t.in,e.out=t.out}));function ly(e,t){return new sy({type:"pipe",in:e,out:t})}const cy=Wd("ZodReadonly",((e,t)=>{k_.init(e,t),K_.init(e,t)}));const uy=Wd("ZodLazy",((e,t)=>{D_.init(e,t),K_.init(e,t),e.unwrap=()=>e._zod.def.getter()}));function dy(e){return new uy({type:"lazy",getter:e})}const py=Wd("ZodCustom",((e,t)=>{S_.init(e,t),K_.init(e,t)}));function hy(e,t){return function(e,t,n){var r;const o=zd(n);return null!==(r=o.abort)&&void 0!==r||(o.abort=!0),new e(so({type:"custom",check:"custom",fn:t},o))}(py,null!==e&&void 0!==e?e:()=>!0,t)}function fy(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{error:"Input not instance of ".concat(e.name)};const n=new py(so({type:"custom",check:"custom",fn:t=>t instanceof e,abort:!0},zd(t)));return n._zod.bag.Class=e,n}var my=n(327);const gy=["abortSignal"];var _y,vy,yy,wy,by,xy,ky,Cy,Dy,Sy,Ey,Ty,Ay,My,Fy=Symbol.for("vercel.ai.gateway.error"),Iy=class e extends(vy=Error,_y=Fy,vy){constructor(e){let{message:t,statusCode:n=500,cause:r}=e;super(t),this[_y]=!0,this.statusCode=n,this.cause=r}static isInstance(t){return e.hasMarker(t)}static hasMarker(e){return"object"===typeof e&&null!==e&&Fy in e&&!0===e[Fy]}},Py="GatewayAuthenticationError",zy="vercel.ai.gateway.error.".concat(Py),Oy=Symbol.for(zy),Ny=class e extends(wy=Iy,yy=Oy,wy){constructor(){let{message:e="Authentication failed",statusCode:t=401,cause:n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super({message:e,statusCode:t,cause:n}),this[yy]=!0,this.name=Py,this.type="authentication_error"}static isInstance(e){return Iy.hasMarker(e)&&Oy in e}static createContextualError(t){let n,{apiKeyProvided:r,oidcTokenProvided:o,message:a="Authentication failed",statusCode:i=401,cause:s}=t;return n=r?"AI Gateway authentication failed: Invalid API key provided.\n\nThe token is expected to be provided via the 'apiKey' option or 'AI_GATEWAY_API_KEY' environment variable.":o?"AI Gateway authentication failed: Invalid OIDC token provided.\n\nThe token is expected to be provided via the 'VERCEL_OIDC_TOKEN' environment variable. It expires every 12 hours.\n- make sure your Vercel project settings have OIDC enabled\n- if running locally with 'vercel dev', the token is automatically obtained and refreshed\n- if running locally with your own dev server, run 'vercel env pull' to fetch the token\n- in production/preview, the token is automatically obtained and refreshed\n\nAlternative: Provide an API key via 'apiKey' option or 'AI_GATEWAY_API_KEY' environment variable.":"AI Gateway authentication failed: No authentication provided.\n\nProvide either an API key or OIDC token.\n\nAPI key instructions:\n\nThe token is expected to be provided via the 'apiKey' option or 'AI_GATEWAY_API_KEY' environment variable.\n\nOIDC token instructions:\n\nThe token is expected to be provided via the 'VERCEL_OIDC_TOKEN' environment variable. It expires every 12 hours.\n- make sure your Vercel project settings have OIDC enabled\n- if running locally with 'vercel dev', the token is automatically obtained and refreshed\n- if running locally with your own dev server, run 'vercel env pull' to fetch the token\n- in production/preview, the token is automatically obtained and refreshed",new e({message:n,statusCode:i,cause:s})}},By="GatewayInvalidRequestError",jy="vercel.ai.gateway.error.".concat(By),Ly=Symbol.for(jy),Ry=class extends(xy=Iy,by=Ly,xy){constructor(){let{message:e="Invalid request",statusCode:t=400,cause:n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super({message:e,statusCode:t,cause:n}),this[by]=!0,this.name=By,this.type="invalid_request_error"}static isInstance(e){return Iy.hasMarker(e)&&Ly in e}},Vy="GatewayRateLimitError",qy="vercel.ai.gateway.error.".concat(Vy),Uy=Symbol.for(qy),Wy=class extends(Cy=Iy,ky=Uy,Cy){constructor(){let{message:e="Rate limit exceeded",statusCode:t=429,cause:n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super({message:e,statusCode:t,cause:n}),this[ky]=!0,this.name=Vy,this.type="rate_limit_exceeded"}static isInstance(e){return Iy.hasMarker(e)&&Uy in e}},Gy="GatewayModelNotFoundError",Hy="vercel.ai.gateway.error.".concat(Gy),Ky=Symbol.for(Hy),Zy=hf((()=>pm(Ov({modelId:X_()})))),$y=class extends(Sy=Iy,Dy=Ky,Sy){constructor(){let{message:e="Model not found",statusCode:t=404,modelId:n,cause:r}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super({message:e,statusCode:t,cause:r}),this[Dy]=!0,this.name=Gy,this.type="model_not_found",this.modelId=n}static isInstance(e){return Iy.hasMarker(e)&&Ky in e}},Xy="GatewayInternalServerError",Jy="vercel.ai.gateway.error.".concat(Xy),Qy=Symbol.for(Jy),Yy=class extends(Ty=Iy,Ey=Qy,Ty){constructor(){let{message:e="Internal server error",statusCode:t=500,cause:n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super({message:e,statusCode:t,cause:n}),this[Ey]=!0,this.name=Xy,this.type="internal_server_error"}static isInstance(e){return Iy.hasMarker(e)&&Qy in e}},ew="GatewayResponseError",tw="vercel.ai.gateway.error.".concat(ew),nw=Symbol.for(tw),rw=class extends(My=Iy,Ay=nw,My){constructor(){let{message:e="Invalid response from Gateway",statusCode:t=502,response:n,validationError:r,cause:o}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super({message:e,statusCode:t,cause:o}),this[Ay]=!0,this.name=ew,this.type="response_error",this.response=n,this.validationError=r}static isInstance(e){return Iy.hasMarker(e)&&nw in e}};async function ow(e){let{response:t,statusCode:n,defaultMessage:r="Gateway request failed",cause:o,authMethod:a}=e;const i=await gf({value:t,schema:aw});if(!i.success)return new rw({message:"Invalid error response format: ".concat(r),statusCode:n,response:t,validationError:i.error,cause:o});const s=i.value,l=s.error.type,c=s.error.message;switch(l){case"authentication_error":return Ny.createContextualError({apiKeyProvided:"api-key"===a,oidcTokenProvided:"oidc"===a,statusCode:n,cause:o});case"invalid_request_error":return new Ry({message:c,statusCode:n,cause:o});case"rate_limit_exceeded":return new Wy({message:c,statusCode:n,cause:o});case"model_not_found":{const e=await gf({value:s.error.param,schema:Zy});return new $y({message:c,statusCode:n,modelId:e.success?e.value.modelId:void 0,cause:o})}default:return new Yy({message:c,statusCode:n,cause:o})}}var aw=hf((()=>pm(Ov({error:Ov({message:X_(),type:X_().nullish(),param:Av().nullish(),code:Lv([X_(),yv()]).nullish()})}))));function iw(e,t){var n;return Iy.isInstance(e)?e:lu.isInstance(e)?ow({response:sw(e),statusCode:null!=(n=e.statusCode)?n:500,defaultMessage:"Gateway request failed",cause:e,authMethod:t}):ow({response:{},statusCode:500,defaultMessage:e instanceof Error?"Gateway request failed: ".concat(e.message):"Unknown Gateway error",cause:e,authMethod:t})}function sw(e){if(void 0!==e.data)return e.data;if(null!=e.responseBody)try{return JSON.parse(e.responseBody)}catch(AC){return e.responseBody}return{}}var lw="ai-gateway-auth-method";async function cw(e){const t=await gf({value:e[lw],schema:uw});return t.success?t.value:void 0}var uw=hf((()=>pm(Lv([Xv("api-key"),Xv("oidc")])))),dw=class{constructor(e){this.config=e}async getAvailableModels(){try{const{value:e}=await rf({url:"".concat(this.config.baseURL,"/config"),headers:await Sf(this.config.headers()),successfulResponseHandler:Af(pw),failedResponseHandler:Ef({errorSchema:Ev(),errorToMessage:e=>e}),fetch:this.config.fetch});return e}catch(e){throw await iw(e)}}async getCredits(){try{const e=new URL(this.config.baseURL),{value:t}=await rf({url:"".concat(e.origin,"/v1/credits"),headers:await Sf(this.config.headers()),successfulResponseHandler:Af(hw),failedResponseHandler:Ef({errorSchema:Ev(),errorToMessage:e=>e}),fetch:this.config.fetch});return t}catch(e){throw await iw(e)}}},pw=hf((()=>pm(Ov({models:Pv(Ov({id:X_(),name:X_(),description:X_().nullish(),pricing:Ov({input:X_(),output:X_(),input_cache_read:X_().nullish(),input_cache_write:X_().nullish()}).transform((e=>{let{input:t,output:n,input_cache_read:r,input_cache_write:o}=e;return so(so({input:t,output:n},r?{cachedInputTokens:r}:{}),o?{cacheCreationInputTokens:o}:{})})).nullish(),specification:Ov({specificationVersion:Xv("v2"),provider:X_(),modelId:X_()}),modelType:Zv(["language","embedding","image"]).nullish()}))})))),hw=hf((()=>pm(Ov({balance:X_(),total_used:X_()}).transform((e=>{let{balance:t,total_used:n}=e;return{balance:t,totalUsed:n}}))))),fw=class{constructor(e,t){this.modelId=e,this.config=t,this.specificationVersion="v2",this.supportedUrls={"*/*":[/.*/]}}get provider(){return this.config.provider}async getArgs(e){const{abortSignal:t}=e,n=Kc(e,gy);return{args:this.maybeEncodeFileParts(n),warnings:[]}}async doGenerate(e){const{args:t,warnings:n}=await this.getArgs(e),{abortSignal:r}=e,o=await Sf(this.config.headers());try{const{responseHeaders:a,value:i,rawValue:s}=await xf(so(so({url:this.getUrl(),headers:Wh(o,e.headers,this.getModelConfigHeaders(this.modelId,!1),await Sf(this.config.o11yHeaders)),body:t,successfulResponseHandler:Af(Ev()),failedResponseHandler:Ef({errorSchema:Ev(),errorToMessage:e=>e})},r&&{abortSignal:r}),{},{fetch:this.config.fetch}));return so(so({},i),{},{request:{body:t},response:{headers:a,body:s},warnings:n})}catch(a){throw await iw(a,await cw(o))}}async doStream(e){const{args:t,warnings:n}=await this.getArgs(e),{abortSignal:r}=e,o=await Sf(this.config.headers());try{const{value:a,responseHeaders:i}=await xf(so(so({url:this.getUrl(),headers:Wh(o,e.headers,this.getModelConfigHeaders(this.modelId,!0),await Sf(this.config.o11yHeaders)),body:t,successfulResponseHandler:Tf(Ev()),failedResponseHandler:Ef({errorSchema:Ev(),errorToMessage:e=>e})},r&&{abortSignal:r}),{},{fetch:this.config.fetch}));return{stream:a.pipeThrough(new TransformStream({start(e){n.length>0&&e.enqueue({type:"stream-start",warnings:n})},transform(t,n){if(t.success){const r=t.value;if("raw"===r.type&&!e.includeRawChunks)return;"response-metadata"===r.type&&r.timestamp&&"string"===typeof r.timestamp&&(r.timestamp=new Date(r.timestamp)),n.enqueue(r)}else n.error(t.error)}})),request:{body:t},response:{headers:i}}}catch(a){throw await iw(a,await cw(o))}}isFilePart(e){return e&&"object"===typeof e&&"type"in e&&"file"===e.type}maybeEncodeFileParts(e){for(const t of e.prompt)for(const e of t.content)if(this.isFilePart(e)){const t=e;if(t.data instanceof Uint8Array){const e=Uint8Array.from(t.data),n=Buffer.from(e).toString("base64");t.data=new URL("data:".concat(t.mediaType||"application/octet-stream",";base64,").concat(n))}}return e}getUrl(){return"".concat(this.config.baseURL,"/language-model")}getModelConfigHeaders(e,t){return{"ai-language-model-specification-version":"2","ai-language-model-id":e,"ai-language-model-streaming":String(t)}}},mw=class{constructor(e,t){this.modelId=e,this.config=t,this.specificationVersion="v2",this.maxEmbeddingsPerCall=2048,this.supportsParallelCalls=!0}get provider(){return this.config.provider}async doEmbed(e){let{values:t,headers:n,abortSignal:r,providerOptions:o}=e;var a;const i=await Sf(this.config.headers());try{const{responseHeaders:e,value:s,rawValue:l}=await xf(so(so({url:this.getUrl(),headers:Wh(i,null!=n?n:{},this.getModelConfigHeaders(),await Sf(this.config.o11yHeaders)),body:so({input:1===t.length?t[0]:t},o?{providerOptions:o}:{}),successfulResponseHandler:Af(gw),failedResponseHandler:Ef({errorSchema:Ev(),errorToMessage:e=>e})},r&&{abortSignal:r}),{},{fetch:this.config.fetch}));return{embeddings:s.embeddings,usage:null!=(a=s.usage)?a:void 0,providerMetadata:s.providerMetadata,response:{headers:e,body:l}}}catch(s){throw await iw(s,await cw(i))}}getUrl(){return"".concat(this.config.baseURL,"/embedding-model")}getModelConfigHeaders(){return{"ai-embedding-model-specification-version":"2","ai-model-id":this.modelId}}},gw=hf((()=>pm(Ov({embeddings:Pv(Pv(yv())),usage:Ov({tokens:yv()}).nullish(),providerMetadata:Hv(X_(),Hv(X_(),Av())).optional()}))));var _w=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};var t,n;let r=null,o=null;const a=null!=(t=e.metadataCacheRefreshMillis)?t:3e5;let i=0;const s=null!=(n=xm(e.baseURL))?n:"https://ai-gateway.vercel.sh/v1/ai",l=async()=>{const t=await async function(e){const t=sf({settingValue:e.apiKey,environmentVariableName:"AI_GATEWAY_API_KEY"});if(t)return{token:t,authMethod:"api-key"};try{return{token:await(0,my.getVercelOidcToken)(),authMethod:"oidc"}}catch(AC){return null}}(e);if(t)return ef(so({Authorization:"Bearer ".concat(t.token),"ai-gateway-protocol-version":"0.0.1",[lw]:t.authMethod},e.headers),"ai-sdk/gateway/".concat("1.0.40"));throw Ny.createContextualError({apiKeyProvided:!1,oidcTokenProvided:!1,statusCode:401})},c=()=>{const e=sf({settingValue:void 0,environmentVariableName:"VERCEL_DEPLOYMENT_ID"}),t=sf({settingValue:void 0,environmentVariableName:"VERCEL_ENV"}),n=sf({settingValue:void 0,environmentVariableName:"VERCEL_REGION"});return async()=>{const r=await async function(){var e;return null==(e=(0,my.getContext)().headers)?void 0:e["x-vercel-id"]}();return so(so(so(so({},e&&{"ai-o11y-deployment-id":e}),t&&{"ai-o11y-environment":t}),n&&{"ai-o11y-region":n}),r&&{"ai-o11y-request-id":r})}},u=t=>new fw(t,{provider:"gateway",baseURL:s,headers:l,fetch:e.fetch,o11yHeaders:c()}),d=function(e){if(new.target)throw new Error("The Gateway Provider model function cannot be called with the new keyword.");return u(e)};return d.getAvailableModels=async()=>{var t,n,c;const u=null!=(c=null==(n=null==(t=e._internal)?void 0:t.currentDate)?void 0:n.call(t).getTime())?c:Date.now();return(!r||u-i>a)&&(i=u,r=new dw({baseURL:s,headers:l,fetch:e.fetch}).getAvailableModels().then((e=>(o=e,e))).catch((async e=>{throw await iw(e,await cw(await l()))}))),o?Promise.resolve(o):r},d.getCredits=async()=>new dw({baseURL:s,headers:l,fetch:e.fetch}).getCredits().catch((async e=>{throw await iw(e,await cw(await l()))})),d.imageModel=e=>{throw new Xu({modelId:e,modelType:"imageModel"})},d.languageModel=u,d.textEmbeddingModel=t=>new mw(t,{provider:"gateway",baseURL:s,headers:l,fetch:e.fetch,o11yHeaders:c()}),d}();var vw="object"===typeof globalThis?globalThis:"object"===typeof self?self:"object"===typeof window?window:"object"===typeof n.g?n.g:{},yw="1.9.0",ww=/^(\d+)\.(\d+)\.(\d+)(-(.+))?$/;var bw=function(e){var t=new Set([e]),n=new Set,r=e.match(ww);if(!r)return function(){return!1};var o=+r[1],a=+r[2],i=+r[3];if(null!=r[4])return function(t){return t===e};function s(e){return n.add(e),!1}function l(e){return t.add(e),!0}return function(e){if(t.has(e))return!0;if(n.has(e))return!1;var r=e.match(ww);if(!r)return s(e);var c=+r[1],u=+r[2],d=+r[3];return null!=r[4]||o!==c?s(e):0===o?a===u&&i<=d?l(e):s(e):a<=u?l(e):s(e)}}(yw),xw=yw.split(".")[0],kw=Symbol.for("opentelemetry.js.api."+xw),Cw=vw;function Dw(e,t,n,r){var o;void 0===r&&(r=!1);var a=Cw[kw]=null!==(o=Cw[kw])&&void 0!==o?o:{version:yw};if(!r&&a[e]){var i=new Error("@opentelemetry/api: Attempted duplicate registration of API: "+e);return n.error(i.stack||i.message),!1}if(a.version!==yw){i=new Error("@opentelemetry/api: Registration of version v"+a.version+" for "+e+" does not match previously registered API v"+yw);return n.error(i.stack||i.message),!1}return a[e]=t,n.debug("@opentelemetry/api: Registered a global for "+e+" v"+yw+"."),!0}function Sw(e){var t,n,r=null===(t=Cw[kw])||void 0===t?void 0:t.version;if(r&&bw(r))return null===(n=Cw[kw])||void 0===n?void 0:n[e]}function Ew(e,t){t.debug("@opentelemetry/api: Unregistering a global for "+e+" v"+yw+".");var n=Cw[kw];n&&delete n[e]}var Tw,Aw=function e(t){var n=this;n._currentContext=t?new Map(t):new Map,n.getValue=function(e){return n._currentContext.get(e)},n.setValue=function(t,r){var o=new e(n._currentContext);return o._currentContext.set(t,r),o},n.deleteValue=function(t){var r=new e(n._currentContext);return r._currentContext.delete(t),r}},Mw=new Aw,Fw=function(e,t){var n="function"===typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,a=n.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(r=a.next()).done;)i.push(r.value)}catch(s){o={error:s}}finally{try{r&&!r.done&&(n=a.return)&&n.call(a)}finally{if(o)throw o.error}}return i},Iw=function(e,t,n){if(n||2===arguments.length)for(var r,o=0,a=t.length;o<a;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))},Pw=function(){function e(){}return e.prototype.active=function(){return Mw},e.prototype.with=function(e,t,n){for(var r=[],o=3;o<arguments.length;o++)r[o-3]=arguments[o];return t.call.apply(t,Iw([n],Fw(r),!1))},e.prototype.bind=function(e,t){return t},e.prototype.enable=function(){return this},e.prototype.disable=function(){return this},e}(),zw=function(e,t){var n="function"===typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,a=n.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(r=a.next()).done;)i.push(r.value)}catch(s){o={error:s}}finally{try{r&&!r.done&&(n=a.return)&&n.call(a)}finally{if(o)throw o.error}}return i},Ow=function(e,t,n){if(n||2===arguments.length)for(var r,o=0,a=t.length;o<a;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))},Nw=function(){function e(e){this._namespace=e.namespace||"DiagComponentLogger"}return e.prototype.debug=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Bw("debug",this._namespace,e)},e.prototype.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Bw("error",this._namespace,e)},e.prototype.info=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Bw("info",this._namespace,e)},e.prototype.warn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Bw("warn",this._namespace,e)},e.prototype.verbose=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Bw("verbose",this._namespace,e)},e}();function Bw(e,t,n){var r=Sw("diag");if(r)return n.unshift(t),r[e].apply(r,Ow([],zw(n),!1))}!function(e){e[e.NONE=0]="NONE",e[e.ERROR=30]="ERROR",e[e.WARN=50]="WARN",e[e.INFO=60]="INFO",e[e.DEBUG=70]="DEBUG",e[e.VERBOSE=80]="VERBOSE",e[e.ALL=9999]="ALL"}(Tw||(Tw={}));var jw,Lw=function(e,t){var n="function"===typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,a=n.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(r=a.next()).done;)i.push(r.value)}catch(s){o={error:s}}finally{try{r&&!r.done&&(n=a.return)&&n.call(a)}finally{if(o)throw o.error}}return i},Rw=function(e,t,n){if(n||2===arguments.length)for(var r,o=0,a=t.length;o<a;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))},Vw=function(){function e(){function e(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=Sw("diag");if(r)return r[e].apply(r,Rw([],Lw(t),!1))}}var t=this;t.setLogger=function(e,n){var r,o,a;if(void 0===n&&(n={logLevel:Tw.INFO}),e===t){var i=new Error("Cannot use diag as the logger for itself. Please use a DiagLogger implementation like ConsoleDiagLogger or a custom implementation");return t.error(null!==(r=i.stack)&&void 0!==r?r:i.message),!1}"number"===typeof n&&(n={logLevel:n});var s=Sw("diag"),l=function(e,t){function n(n,r){var o=t[n];return"function"===typeof o&&e>=r?o.bind(t):function(){}}return e<Tw.NONE?e=Tw.NONE:e>Tw.ALL&&(e=Tw.ALL),t=t||{},{error:n("error",Tw.ERROR),warn:n("warn",Tw.WARN),info:n("info",Tw.INFO),debug:n("debug",Tw.DEBUG),verbose:n("verbose",Tw.VERBOSE)}}(null!==(o=n.logLevel)&&void 0!==o?o:Tw.INFO,e);if(s&&!n.suppressOverrideMessage){var c=null!==(a=(new Error).stack)&&void 0!==a?a:"<failed to generate stacktrace>";s.warn("Current logger will be overwritten from "+c),l.warn("Current logger will overwrite one already registered from "+c)}return Dw("diag",l,t,!0)},t.disable=function(){Ew("diag",t)},t.createComponentLogger=function(e){return new Nw(e)},t.verbose=e("verbose"),t.debug=e("debug"),t.info=e("info"),t.warn=e("warn"),t.error=e("error")}return e.instance=function(){return this._instance||(this._instance=new e),this._instance},e}(),qw=function(e,t){var n="function"===typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,a=n.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(r=a.next()).done;)i.push(r.value)}catch(s){o={error:s}}finally{try{r&&!r.done&&(n=a.return)&&n.call(a)}finally{if(o)throw o.error}}return i},Uw=function(e,t,n){if(n||2===arguments.length)for(var r,o=0,a=t.length;o<a;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))},Ww="context",Gw=new Pw,Hw=function(){function e(){}return e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.setGlobalContextManager=function(e){return Dw(Ww,e,Vw.instance())},e.prototype.active=function(){return this._getContextManager().active()},e.prototype.with=function(e,t,n){for(var r,o=[],a=3;a<arguments.length;a++)o[a-3]=arguments[a];return(r=this._getContextManager()).with.apply(r,Uw([e,t,n],qw(o),!1))},e.prototype.bind=function(e,t){return this._getContextManager().bind(e,t)},e.prototype._getContextManager=function(){return Sw(Ww)||Gw},e.prototype.disable=function(){this._getContextManager().disable(),Ew(Ww,Vw.instance())},e}();!function(e){e[e.NONE=0]="NONE",e[e.SAMPLED=1]="SAMPLED"}(jw||(jw={}));var Kw,Zw="0000000000000000",$w="00000000000000000000000000000000",Xw={traceId:$w,spanId:Zw,traceFlags:jw.NONE},Jw=function(){function e(e){void 0===e&&(e=Xw),this._spanContext=e}return e.prototype.spanContext=function(){return this._spanContext},e.prototype.setAttribute=function(e,t){return this},e.prototype.setAttributes=function(e){return this},e.prototype.addEvent=function(e,t){return this},e.prototype.addLink=function(e){return this},e.prototype.addLinks=function(e){return this},e.prototype.setStatus=function(e){return this},e.prototype.updateName=function(e){return this},e.prototype.end=function(e){},e.prototype.isRecording=function(){return!1},e.prototype.recordException=function(e,t){},e}(),Qw=(Kw="OpenTelemetry Context Key SPAN",Symbol.for(Kw));function Yw(e){return e.getValue(Qw)||void 0}function eb(){return Yw(Hw.getInstance().active())}function tb(e,t){return e.setValue(Qw,t)}function nb(e){return e.deleteValue(Qw)}function rb(e,t){return tb(e,new Jw(t))}function ob(e){var t;return null===(t=Yw(e))||void 0===t?void 0:t.spanContext()}var ab=/^([0-9a-f]{32})$/i,ib=/^[0-9a-f]{16}$/i;function sb(e){return n=e.traceId,ab.test(n)&&n!==$w&&(t=e.spanId,ib.test(t)&&t!==Zw);var t,n}function lb(e){return new Jw(e)}var cb=Hw.getInstance(),ub=function(){function e(){}return e.prototype.startSpan=function(e,t,n){if(void 0===n&&(n=cb.active()),Boolean(null===t||void 0===t?void 0:t.root))return new Jw;var r,o=n&&ob(n);return"object"===typeof(r=o)&&"string"===typeof r.spanId&&"string"===typeof r.traceId&&"number"===typeof r.traceFlags&&sb(o)?new Jw(o):new Jw},e.prototype.startActiveSpan=function(e,t,n,r){var o,a,i;if(!(arguments.length<2)){2===arguments.length?i=t:3===arguments.length?(o=t,i=n):(o=t,a=n,i=r);var s=null!==a&&void 0!==a?a:cb.active(),l=this.startSpan(e,o,s),c=tb(s,l);return cb.with(c,i,void 0,l)}},e}();var db,pb=new ub,hb=function(){function e(e,t,n,r){this._provider=e,this.name=t,this.version=n,this.options=r}return e.prototype.startSpan=function(e,t,n){return this._getTracer().startSpan(e,t,n)},e.prototype.startActiveSpan=function(e,t,n,r){var o=this._getTracer();return Reflect.apply(o.startActiveSpan,o,arguments)},e.prototype._getTracer=function(){if(this._delegate)return this._delegate;var e=this._provider.getDelegateTracer(this.name,this.version,this.options);return e?(this._delegate=e,this._delegate):pb},e}(),fb=new(function(){function e(){}return e.prototype.getTracer=function(e,t,n){return new ub},e}()),mb=function(){function e(){}return e.prototype.getTracer=function(e,t,n){var r;return null!==(r=this.getDelegateTracer(e,t,n))&&void 0!==r?r:new hb(this,e,t,n)},e.prototype.getDelegate=function(){var e;return null!==(e=this._delegate)&&void 0!==e?e:fb},e.prototype.setDelegate=function(e){this._delegate=e},e.prototype.getDelegateTracer=function(e,t,n){var r;return null===(r=this._delegate)||void 0===r?void 0:r.getTracer(e,t,n)},e}(),gb="trace",_b=function(){function e(){this._proxyTracerProvider=new mb,this.wrapSpanContext=lb,this.isSpanContextValid=sb,this.deleteSpan=nb,this.getSpan=Yw,this.getActiveSpan=eb,this.getSpanContext=ob,this.setSpan=tb,this.setSpanContext=rb}return e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.setGlobalTracerProvider=function(e){var t=Dw(gb,this._proxyTracerProvider,Vw.instance());return t&&this._proxyTracerProvider.setDelegate(e),t},e.prototype.getTracerProvider=function(){return Sw(gb)||this._proxyTracerProvider},e.prototype.getTracer=function(e,t){return this.getTracerProvider().getTracer(e,t)},e.prototype.disable=function(){Ew(gb,Vw.instance()),this._proxyTracerProvider=new mb},e}(),vb=_b.getInstance();!function(e){e[e.UNSET=0]="UNSET",e[e.OK=1]="OK",e[e.ERROR=2]="ERROR"}(db||(db={}));const yb=["model","tools","toolChoice","system","prompt","messages","maxRetries","abortSignal","headers","stopWhen","experimental_output","experimental_telemetry","providerOptions","experimental_activeTools","activeTools","experimental_prepareStep","prepareStep","experimental_repairToolCall","experimental_download","experimental_context","_internal","onStepFinish"];var wb,bb=Object.defineProperty,xb="AI_NoOutputSpecifiedError",kb="vercel.ai.error.".concat(xb),Cb=Symbol.for(kb),Db=class extends ou{constructor(){let{message:e="No output specified."}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super({name:xb,message:e}),this[wb]=!0}static isInstance(e){return ou.hasMarker(e,kb)}};function Sb(e){const t="AI SDK Warning:";switch(e.type){case"unsupported-setting":{let n="".concat(t,' The "').concat(e.setting,'" setting is not supported by this model');return e.details&&(n+=" - ".concat(e.details)),n}case"unsupported-tool":{const n="name"in e.tool?e.tool.name:"unknown tool";let r="".concat(t,' The tool "').concat(n,'" is not supported by this model');return e.details&&(r+=" - ".concat(e.details)),r}case"other":return"".concat(t," ").concat(e.message);default:return"".concat(t," ").concat(JSON.stringify(e,null,2))}}wb=Cb;var Eb,Tb=!1,Ab=e=>{if(0===e.length)return;const t=globalThis.AI_SDK_LOG_WARNINGS;if(!1!==t)if("function"!==typeof t){Tb||(Tb=!0,console.info("AI SDK Warning System: To turn off warning logging, set the AI_SDK_LOG_WARNINGS global to false."));for(const t of e)console.warn(Sb(t))}else t(e)},Mb="AI_InvalidArgumentError",Fb="vercel.ai.error.".concat(Mb),Ib=Symbol.for(Fb),Pb=class extends ou{constructor(e){let{parameter:t,value:n,message:r}=e;super({name:Mb,message:"Invalid argument for parameter ".concat(t,": ").concat(r)}),this[Eb]=!0,this.parameter=t,this.value=n}static isInstance(e){return ou.hasMarker(e,Fb)}};Eb=Ib;var zb="AI_InvalidStreamPartError",Ob="vercel.ai.error.".concat(zb),Nb=Symbol.for(Ob);var Bb,jb="AI_InvalidToolInputError",Lb="vercel.ai.error.".concat(jb),Rb=Symbol.for(Lb),Vb=class extends ou{constructor(e){let{toolInput:t,toolName:n,cause:r,message:o="Invalid input for tool ".concat(n,": ").concat(fu(r))}=e;super({name:jb,message:o,cause:r}),this[Bb]=!0,this.toolInput=t,this.toolName=n}static isInstance(e){return ou.hasMarker(e,Lb)}};Bb=Rb;var qb="vercel.ai.error.".concat("AI_MCPClientError"),Ub=Symbol.for(qb);var Wb="AI_NoImageGeneratedError",Gb="vercel.ai.error.".concat(Wb),Hb=Symbol.for(Gb);var Kb,Zb="AI_NoObjectGeneratedError",$b="vercel.ai.error.".concat(Zb),Xb=Symbol.for($b),Jb=class extends ou{constructor(e){let{message:t="No object generated.",cause:n,text:r,response:o,usage:a,finishReason:i}=e;super({name:Zb,message:t,cause:n}),this[Kb]=!0,this.text=r,this.response=o,this.usage=a,this.finishReason=i}static isInstance(e){return ou.hasMarker(e,$b)}};Kb=Xb;var Qb="AI_NoOutputGeneratedError",Yb="vercel.ai.error.".concat(Qb),ex=Symbol.for(Yb);var tx,nx="AI_NoSuchToolError",rx="vercel.ai.error.".concat(nx),ox=Symbol.for(rx),ax=class extends ou{constructor(e){let{toolName:t,availableTools:n,message:r="Model tried to call unavailable tool '".concat(t,"'. ").concat(void 0===n?"No tools are available.":"Available tools: ".concat(n.join(", "),"."))}=e;super({name:nx,message:r}),this[tx]=!0,this.toolName=t,this.availableTools=n}static isInstance(e){return ou.hasMarker(e,rx)}};tx=ox;var ix,sx="AI_ToolCallRepairError",lx="vercel.ai.error.".concat(sx),cx=Symbol.for(lx),ux=class extends ou{constructor(e){let{cause:t,originalError:n,message:r="Error repairing tool call: ".concat(fu(t))}=e;super({name:sx,message:r,cause:t}),this[ix]=!0,this.originalError=n}static isInstance(e){return ou.hasMarker(e,lx)}};ix=cx;var dx=class extends ou{constructor(e){super({name:"AI_UnsupportedModelVersionError",message:"Unsupported model version ".concat(e.version,' for provider "').concat(e.provider,'" and model "').concat(e.modelId,'". AI SDK 5 only supports models that implement specification version "v2".')}),this.version=e.version,this.provider=e.provider,this.modelId=e.modelId}},px="AI_InvalidDataContentError",hx="vercel.ai.error.".concat(px),fx=Symbol.for(hx);var mx,gx="AI_InvalidMessageRoleError",_x="vercel.ai.error.".concat(gx),vx=Symbol.for(_x),yx=class extends ou{constructor(e){let{role:t,message:n="Invalid message role: '".concat(t,'\'. Must be one of: "system", "user", "assistant", "tool".')}=e;super({name:gx,message:n}),this[mx]=!0,this.role=t}static isInstance(e){return ou.hasMarker(e,_x)}};mx=vx;var wx="AI_MessageConversionError",bx="vercel.ai.error.".concat(wx),xx=Symbol.for(bx);var kx,Cx="AI_DownloadError",Dx="vercel.ai.error.".concat(Cx),Sx=Symbol.for(Dx),Ex=class extends ou{constructor(e){let{url:t,statusCode:n,statusText:r,cause:o,message:a=(null==o?"Failed to download ".concat(t,": ").concat(n," ").concat(r):"Failed to download ".concat(t,": ").concat(o))}=e;super({name:Cx,message:a,cause:o}),this[kx]=!0,this.url=t,this.statusCode=n,this.statusText=r}static isInstance(e){return ou.hasMarker(e,Dx)}};kx=Sx;var Tx,Ax="AI_RetryError",Mx="vercel.ai.error.".concat(Ax),Fx=Symbol.for(Mx),Ix=class extends ou{constructor(e){let{message:t,reason:n,errors:r}=e;super({name:Ax,message:t}),this[Tx]=!0,this.reason=n,this.errors=r,this.lastError=r[r.length-1]}static isInstance(e){return ou.hasMarker(e,Mx)}};function Px(e){if("string"!==typeof e){if("v2"!==e.specificationVersion)throw new dx({version:e.specificationVersion,provider:e.provider,modelId:e.modelId});return e}return zx().languageModel(e)}function zx(){var e;return null!=(e=globalThis.AI_SDK_DEFAULT_PROVIDER)?e:_w}Tx=Fx;var Ox=[{mediaType:"image/gif",bytesPrefix:[71,73,70]},{mediaType:"image/png",bytesPrefix:[137,80,78,71]},{mediaType:"image/jpeg",bytesPrefix:[255,216]},{mediaType:"image/webp",bytesPrefix:[82,73,70,70,null,null,null,null,87,69,66,80]},{mediaType:"image/bmp",bytesPrefix:[66,77]},{mediaType:"image/tiff",bytesPrefix:[73,73,42,0]},{mediaType:"image/tiff",bytesPrefix:[77,77,0,42]},{mediaType:"image/avif",bytesPrefix:[0,0,0,32,102,116,121,112,97,118,105,102]},{mediaType:"image/heic",bytesPrefix:[0,0,0,32,102,116,121,112,104,101,105,99]}];function Nx(e){return"string"===typeof e&&e.startsWith("SUQz")||"string"!==typeof e&&e.length>10&&73===e[0]&&68===e[1]&&51===e[2]?(e=>{const t="string"===typeof e?ym(e):e,n=(127&t[6])<<21|(127&t[7])<<14|(127&t[8])<<7|127&t[9];return t.slice(n+10)})(e):e}function Bx(e){let{data:t,signatures:n}=e;const r=Nx(t),o="string"===typeof r?ym(r.substring(0,Math.min(r.length,24))):r;for(const a of n)if(o.length>=a.bytesPrefix.length&&a.bytesPrefix.every(((e,t)=>null===e||o[t]===e)))return a.mediaType}var jx="5.0.71",Lx=async e=>{let{url:t}=e;var n;const r=t.toString();try{const e=await fetch(r,{headers:ef({},"ai-sdk/".concat(jx),Yh())});if(!e.ok)throw new Ex({url:r,statusCode:e.status,statusText:e.statusText});return{data:new Uint8Array(await e.arrayBuffer()),mediaType:null!=(n=e.headers.get("content-type"))?n:void 0}}catch(o){if(Ex.isInstance(o))throw o;throw new Ex({url:r,cause:o})}},Rx=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Lx;return t=>Promise.all(t.map((async t=>t.isUrlSupportedByModel?null:e(t))))};var Vx=Lv([X_(),fy(Uint8Array),fy(ArrayBuffer),hy((e=>{var t,n;return null!=(n=null==(t=globalThis.Buffer)?void 0:t.isBuffer(e))&&n}),{message:"Must be a Buffer"})]);function qx(e){if(e instanceof Uint8Array)return{data:e,mediaType:void 0};if(e instanceof ArrayBuffer)return{data:new Uint8Array(e),mediaType:void 0};if("string"===typeof e)try{e=new URL(e)}catch(t){}if(e instanceof URL&&"data:"===e.protocol){const{mediaType:n,base64Content:r}=function(e){try{const[t,n]=e.split(",");return{mediaType:t.split(";")[0].split(":")[1],base64Content:n}}catch(t){return{mediaType:void 0,base64Content:void 0}}}(e.toString());if(null==n||null==r)throw new ou({name:"InvalidDataContentError",message:"Invalid data URL format in content ".concat(e.toString())});return{data:r,mediaType:n}}return{data:e,mediaType:void 0}}async function Ux(e){let{prompt:t,supportedUrls:n,download:r=Rx()}=e;const o=await async function(e,t,n){const r=e.filter((e=>"user"===e.role)).map((e=>e.content)).filter((e=>Array.isArray(e))).flat().filter((e=>"image"===e.type||"file"===e.type)).map((e=>{var t;const n=null!=(t=e.mediaType)?t:"image"===e.type?"image/*":void 0;let r="image"===e.type?e.image:e.data;if("string"===typeof r)try{r=new URL(r)}catch(o){}return{mediaType:n,data:r}})).filter((e=>e.data instanceof URL)).map((e=>({url:e.data,isUrlSupportedByModel:null!=e.mediaType&&of({url:e.data.toString(),mediaType:e.mediaType,supportedUrls:n})}))),o=await t(r);return Object.fromEntries(o.map(((e,t)=>null==e?null:[r[t].url.toString(),{data:e.data,mediaType:e.mediaType}])).filter((e=>null!=e)))}(t.messages,r,n);return[...null!=t.system?[{role:"system",content:t.system}]:[],...t.messages.map((e=>function(e){let{message:t,downloadedAssets:n}=e;const r=t.role;switch(r){case"system":return{role:"system",content:t.content,providerOptions:t.providerOptions};case"user":return"string"===typeof t.content?{role:"user",content:[{type:"text",text:t.content}],providerOptions:t.providerOptions}:{role:"user",content:t.content.map((e=>function(e,t){var n;if("text"===e.type)return{type:"text",text:e.text,providerOptions:e.providerOptions};let r;const o=e.type;switch(o){case"image":r=e.image;break;case"file":r=e.data;break;default:throw new Error("Unsupported part type: ".concat(o))}const{data:a,mediaType:i}=qx(r);let s=null!=i?i:e.mediaType,l=a;if(l instanceof URL){const e=t[l.toString()];e&&(l=e.data,null!=s||(s=e.mediaType))}switch(o){case"image":return(l instanceof Uint8Array||"string"===typeof l)&&(s=null!=(n=Bx({data:l,signatures:Ox}))?n:s),{type:"file",mediaType:null!=s?s:"image/*",filename:void 0,data:l,providerOptions:e.providerOptions};case"file":if(null==s)throw new Error("Media type is missing for file part");return{type:"file",mediaType:s,filename:e.filename,data:l,providerOptions:e.providerOptions}}}(e,n))).filter((e=>"text"!==e.type||""!==e.text)),providerOptions:t.providerOptions};case"assistant":return"string"===typeof t.content?{role:"assistant",content:[{type:"text",text:t.content}],providerOptions:t.providerOptions}:{role:"assistant",content:t.content.filter((e=>"text"!==e.type||""!==e.text||null!=e.providerOptions)).map((e=>{const t=e.providerOptions;switch(e.type){case"file":{const{data:n,mediaType:r}=qx(e.data);return{type:"file",data:n,filename:e.filename,mediaType:null!=r?r:e.mediaType,providerOptions:t}}case"reasoning":return{type:"reasoning",text:e.text,providerOptions:t};case"text":return{type:"text",text:e.text,providerOptions:t};case"tool-call":return{type:"tool-call",toolCallId:e.toolCallId,toolName:e.toolName,input:e.input,providerExecuted:e.providerExecuted,providerOptions:t};case"tool-result":return{type:"tool-result",toolCallId:e.toolCallId,toolName:e.toolName,output:e.output,providerOptions:t}}})),providerOptions:t.providerOptions};case"tool":return{role:"tool",content:t.content.map((e=>({type:"tool-result",toolCallId:e.toolCallId,toolName:e.toolName,output:e.output,providerOptions:e.providerOptions}))),providerOptions:t.providerOptions};default:throw new yx({role:r})}}({message:e,downloadedAssets:o})))]}function Wx(e){let{maxOutputTokens:t,temperature:n,topP:r,topK:o,presencePenalty:a,frequencyPenalty:i,seed:s,stopSequences:l}=e;if(null!=t){if(!Number.isInteger(t))throw new Pb({parameter:"maxOutputTokens",value:t,message:"maxOutputTokens must be an integer"});if(t<1)throw new Pb({parameter:"maxOutputTokens",value:t,message:"maxOutputTokens must be >= 1"})}if(null!=n&&"number"!==typeof n)throw new Pb({parameter:"temperature",value:n,message:"temperature must be a number"});if(null!=r&&"number"!==typeof r)throw new Pb({parameter:"topP",value:r,message:"topP must be a number"});if(null!=o&&"number"!==typeof o)throw new Pb({parameter:"topK",value:o,message:"topK must be a number"});if(null!=a&&"number"!==typeof a)throw new Pb({parameter:"presencePenalty",value:a,message:"presencePenalty must be a number"});if(null!=i&&"number"!==typeof i)throw new Pb({parameter:"frequencyPenalty",value:i,message:"frequencyPenalty must be a number"});if(null!=s&&!Number.isInteger(s))throw new Pb({parameter:"seed",value:s,message:"seed must be an integer"});return{maxOutputTokens:t,temperature:n,topP:r,topK:o,presencePenalty:a,frequencyPenalty:i,stopSequences:l,seed:s}}function Gx(e){let{tools:t,toolChoice:n,activeTools:r}=e;if(!(null!=(o=t)&&Object.keys(o).length>0))return{tools:void 0,toolChoice:void 0};var o;return{tools:(null!=r?Object.entries(t).filter((e=>{let[t]=e;return r.includes(t)})):Object.entries(t)).map((e=>{let[t,n]=e;const r=n.type;switch(r){case void 0:case"dynamic":case"function":return{type:"function",name:t,description:n.description,inputSchema:gm(n.inputSchema).jsonSchema,providerOptions:n.providerOptions};case"provider-defined":return{type:"provider-defined",name:t,id:n.id,args:n.args};default:throw new Error("Unsupported tool type: ".concat(r))}})),toolChoice:null==n?{type:"auto"}:"string"===typeof n?{type:n}:{type:"tool",toolName:n.toolName}}}var Hx=dy((()=>Lv([Dv(),X_(),yv(),kv(),Hv(X_(),Hx),Pv(Hx)]))),Kx=Hv(X_(),Hv(X_(),Hx)),Zx=Ov({type:Xv("text"),text:X_(),providerOptions:Kx.optional()}),$x=Ov({type:Xv("image"),image:Lv([Vx,fy(URL)]),mediaType:X_().optional(),providerOptions:Kx.optional()}),Xx=Ov({type:Xv("file"),data:Lv([Vx,fy(URL)]),filename:X_().optional(),mediaType:X_(),providerOptions:Kx.optional()}),Jx=Ov({type:Xv("reasoning"),text:X_(),providerOptions:Kx.optional()}),Qx=Ov({type:Xv("tool-call"),toolCallId:X_(),toolName:X_(),input:Av(),providerOptions:Kx.optional(),providerExecuted:kv().optional()}),Yx=Vv("type",[Ov({type:Xv("text"),value:X_()}),Ov({type:Xv("json"),value:Hx}),Ov({type:Xv("error-text"),value:X_()}),Ov({type:Xv("error-json"),value:Hx}),Ov({type:Xv("content"),value:Pv(Lv([Ov({type:Xv("text"),text:X_()}),Ov({type:Xv("media"),data:X_(),mediaType:X_()})]))})]),ek=Ov({type:Xv("tool-result"),toolCallId:X_(),toolName:X_(),output:Yx,providerOptions:Kx.optional()}),tk=Ov({role:Xv("system"),content:X_(),providerOptions:Kx.optional()}),nk=Ov({role:Xv("user"),content:Lv([X_(),Pv(Lv([Zx,$x,Xx]))]),providerOptions:Kx.optional()}),rk=Ov({role:Xv("assistant"),content:Lv([X_(),Pv(Lv([Zx,Xx,Jx,Qx,ek]))]),providerOptions:Kx.optional()}),ok=Ov({role:Xv("tool"),content:Pv(ek),providerOptions:Kx.optional()}),ak=Lv([tk,nk,rk,ok]);async function ik(e){if(null==e.prompt&&null==e.messages)throw new Cu({prompt:e,message:"prompt or messages must be defined"});if(null!=e.prompt&&null!=e.messages)throw new Cu({prompt:e,message:"prompt and messages cannot be defined at the same time"});if(null!=e.system&&"string"!==typeof e.system)throw new Cu({prompt:e,message:"system must be a string"});let t;if(null!=e.prompt&&"string"===typeof e.prompt)t=[{role:"user",content:e.prompt}];else if(null!=e.prompt&&Array.isArray(e.prompt))t=e.prompt;else{if(null==e.messages)throw new Cu({prompt:e,message:"prompt or messages must be defined"});t=e.messages}if(0===t.length)throw new Cu({prompt:e,message:"messages must not be empty"});const n=await gf({value:t,schema:Pv(ak)});if(!n.success)throw new Cu({prompt:e,message:"The messages must be a ModelMessage[]. If you have passed a UIMessage[], you can use convertToModelMessages to convert them.",cause:n.error});return{messages:t,system:e.system}}function sk(e){return Ny.isInstance(e)||$y.isInstance(e)?new ou({name:"GatewayError",message:"Vercel AI Gateway access failed. If you want to use AI SDK providers directly, use the providers, e.g. @ai-sdk/openai, or register a different global default provider.",cause:e}):e}function lk(e){let{operationId:t,telemetry:n}=e;return{"operation.name":"".concat(t).concat(null!=(null==n?void 0:n.functionId)?" ".concat(n.functionId):""),"resource.name":null==n?void 0:n.functionId,"ai.operationId":t,"ai.telemetry.functionId":null==n?void 0:n.functionId}}function ck(e){let{model:t,settings:n,telemetry:r,headers:o}=e;var a;return so(so(so({"ai.model.provider":t.provider,"ai.model.id":t.modelId},Object.entries(n).reduce(((e,t)=>{let[n,r]=t;return e["ai.settings.".concat(n)]=r,e}),{})),Object.entries(null!=(a=null==r?void 0:r.metadata)?a:{}).reduce(((e,t)=>{let[n,r]=t;return e["ai.telemetry.metadata.".concat(n)]=r,e}),{})),Object.entries(null!=o?o:{}).reduce(((e,t)=>{let[n,r]=t;return void 0!==r&&(e["ai.request.headers.".concat(n)]=r),e}),{}))}var uk={startSpan:()=>dk,startActiveSpan:(e,t,n,r)=>"function"===typeof t?t(dk):"function"===typeof n?n(dk):"function"===typeof r?r(dk):void 0},dk={spanContext:()=>pk,setAttribute(){return this},setAttributes(){return this},addEvent(){return this},addLink(){return this},addLinks(){return this},setStatus(){return this},updateName(){return this},end(){return this},isRecording:()=>!1,recordException(){return this}},pk={traceId:"",spanId:"",traceFlags:0};function hk(){let{isEnabled:e=!1,tracer:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e?t||vb.getTracer("ai"):uk}function fk(e){let{name:t,tracer:n,attributes:r,fn:o,endWhenDone:a=!0}=e;return n.startActiveSpan(t,{attributes:r},(async e=>{try{const t=await o(e);return a&&e.end(),t}catch(t){try{mk(e,t)}finally{e.end()}throw t}}))}function mk(e,t){t instanceof Error?(e.recordException({name:t.name,message:t.message,stack:t.stack}),e.setStatus({code:db.ERROR,message:t.message})):e.setStatus({code:db.ERROR})}function gk(e){let{telemetry:t,attributes:n}=e;return!0!==(null==t?void 0:t.isEnabled)?{}:Object.entries(n).reduce(((e,n)=>{let[r,o]=n;if(null==o)return e;if("object"===typeof o&&"input"in o&&"function"===typeof o.input){if(!1===(null==t?void 0:t.recordInputs))return e;const n=o.input();return null==n?e:so(so({},e),{},{[r]:n})}if("object"===typeof o&&"output"in o&&"function"===typeof o.output){if(!1===(null==t?void 0:t.recordOutputs))return e;const n=o.output();return null==n?e:so(so({},e),{},{[r]:n})}return so(so({},e),{},{[r]:o})}),{})}function _k(e){return JSON.stringify(e.map((e=>so(so({},e),{},{content:"string"===typeof e.content?e.content:e.content.map((e=>{return"file"===e.type?so(so({},e),{},{data:e.data instanceof Uint8Array?(t=e.data,"string"===typeof t?t:t instanceof ArrayBuffer?wm(new Uint8Array(t)):wm(t)):e.data}):e;var t}))}))))}function vk(e,t){return{inputTokens:yk(e.inputTokens,t.inputTokens),outputTokens:yk(e.outputTokens,t.outputTokens),totalTokens:yk(e.totalTokens,t.totalTokens),reasoningTokens:yk(e.reasoningTokens,t.reasoningTokens),cachedInputTokens:yk(e.cachedInputTokens,t.cachedInputTokens)}}function yk(e,t){return null==e&&null==t?void 0:(null!=e?e:0)+(null!=t?t:0)}function wk(e){return void 0===e?[]:Array.isArray(e)?e:[e]}var bk=function(){let{maxRetries:e=2,initialDelayInMs:t=2e3,backoffFactor:n=2,abortSignal:r}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return async o=>xk(o,{maxRetries:e,delayInMs:t,backoffFactor:n,abortSignal:r})};async function xk(e,t){let{maxRetries:n,delayInMs:r,backoffFactor:o,abortSignal:a}=t,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];try{return await e()}catch(s){if(Xh(s))throw s;if(0===n)throw s;const t=$h(s),l=[...i,s],c=l.length;if(c>n)throw new Ix({message:"Failed after ".concat(c," attempts. Last error: ").concat(t),reason:"maxRetriesExceeded",errors:l});if(s instanceof Error&&lu.isInstance(s)&&!0===s.isRetryable&&c<=n)return await async function(e,t){if(null==e)return Promise.resolve();const n=null==t?void 0:t.abortSignal;return new Promise(((t,r)=>{if(null==n?void 0:n.aborted)return void r(Gh());const o=setTimeout((()=>{a(),t()}),e),a=()=>{clearTimeout(o),null==n||n.removeEventListener("abort",i)},i=()=>{a(),r(Gh())};null==n||n.addEventListener("abort",i)}))}(function(e){let{error:t,exponentialBackoffDelay:n}=e;const r=t.responseHeaders;if(!r)return n;let o;const a=r["retry-after-ms"];if(a){const e=parseFloat(a);Number.isNaN(e)||(o=e)}const i=r["retry-after"];if(i&&void 0===o){const e=parseFloat(i);o=Number.isNaN(e)?Date.parse(i)-Date.now():1e3*e}return null!=o&&!Number.isNaN(o)&&0<=o&&(o<6e4||o<n)?o:n}({error:s,exponentialBackoffDelay:r}),{abortSignal:a}),xk(e,{maxRetries:n,delayInMs:o*r,backoffFactor:o,abortSignal:a},l);if(1===c)throw s;throw new Ix({message:"Failed after ".concat(c," attempts with non-retryable error: '").concat(t,"'"),reason:"errorNotRetryable",errors:l})}}function kk(e){let{maxRetries:t,abortSignal:n}=e;if(null!=t){if(!Number.isInteger(t))throw new Pb({parameter:"maxRetries",value:t,message:"maxRetries must be an integer"});if(t<0)throw new Pb({parameter:"maxRetries",value:t,message:"maxRetries must be >= 0"})}const r=null!=t?t:2;return{maxRetries:r,retry:bk({maxRetries:r,abortSignal:n})}}function Ck(e){const t=e.filter((e=>"text"===e.type));if(0!==t.length)return t.map((e=>e.text)).join("")}var Dk=class{constructor(e){let{data:t,mediaType:n}=e;const r=t instanceof Uint8Array;this.base64Data=r?void 0:t,this.uint8ArrayData=r?t:void 0,this.mediaType=n}get base64(){return null==this.base64Data&&(this.base64Data=wm(this.uint8ArrayData)),this.base64Data}get uint8Array(){return null==this.uint8ArrayData&&(this.uint8ArrayData=ym(this.base64Data)),this.uint8ArrayData}};async function Sk(e){let{toolCall:t,tools:n,repairToolCall:r,system:o,messages:a}=e;try{if(null==n)throw new ax({toolName:t.toolName});try{return await Ek({toolCall:t,tools:n})}catch(i){if(null==r||!ax.isInstance(i)&&!Vb.isInstance(i))throw i;let e=null;try{e=await r({toolCall:t,tools:n,inputSchema:e=>{let{toolName:t}=e;const{inputSchema:r}=n[t];return gm(r).jsonSchema},system:o,messages:a,error:i})}catch(s){throw new ux({cause:s,originalError:i})}if(null==e)throw i;return await Ek({toolCall:e,tools:n})}}catch(i){const e=await _f({text:t.input}),n=e.success?e.value:t.input;return{type:"tool-call",toolCallId:t.toolCallId,toolName:t.toolName,input:n,dynamic:!0,invalid:!0,error:i}}}async function Ek(e){let{toolCall:t,tools:n}=e;const r=t.toolName,o=n[r];if(null==o)throw new ax({toolName:t.toolName,availableTools:Object.keys(n)});const a=gm(o.inputSchema),i=""===t.input.trim()?await gf({value:{},schema:a}):await _f({text:t.input,schema:a});if(!1===i.success)throw new Vb({toolName:r,toolInput:t.input,cause:i.error});return"dynamic"===o.type?{type:"tool-call",toolCallId:t.toolCallId,toolName:t.toolName,input:i.value,providerExecuted:t.providerExecuted,providerMetadata:t.providerMetadata,dynamic:!0}:{type:"tool-call",toolCallId:t.toolCallId,toolName:r,input:i.value,providerExecuted:t.providerExecuted,providerMetadata:t.providerMetadata}}var Tk=class{constructor(e){let{content:t,finishReason:n,usage:r,warnings:o,request:a,response:i,providerMetadata:s}=e;this.content=t,this.finishReason=n,this.usage=r,this.warnings=o,this.request=a,this.response=i,this.providerMetadata=s}get text(){return this.content.filter((e=>"text"===e.type)).map((e=>e.text)).join("")}get reasoning(){return this.content.filter((e=>"reasoning"===e.type))}get reasoningText(){return 0===this.reasoning.length?void 0:this.reasoning.map((e=>e.text)).join("")}get files(){return this.content.filter((e=>"file"===e.type)).map((e=>e.file))}get sources(){return this.content.filter((e=>"source"===e.type))}get toolCalls(){return this.content.filter((e=>"tool-call"===e.type))}get staticToolCalls(){return this.toolCalls.filter((e=>!0!==e.dynamic))}get dynamicToolCalls(){return this.toolCalls.filter((e=>!0===e.dynamic))}get toolResults(){return this.content.filter((e=>"tool-result"===e.type))}get staticToolResults(){return this.toolResults.filter((e=>!0!==e.dynamic))}get dynamicToolResults(){return this.toolResults.filter((e=>!0===e.dynamic))}};function Ak(e){return t=>{let{steps:n}=t;return n.length===e}}async function Mk(e){let{stopConditions:t,steps:n}=e;return(await Promise.all(t.map((e=>e({steps:n}))))).some((e=>e))}function Fk(e){let{output:t,tool:n,errorMode:r}=e;return"text"===r?{type:"error-text",value:fu(t)}:"json"===r?{type:"error-json",value:Ik(t)}:(null==n?void 0:n.toModelOutput)?n.toModelOutput(t):"string"===typeof t?{type:"text",value:t}:{type:"json",value:Ik(t)}}function Ik(e){return void 0===e?null:e}function Pk(e){let{content:t,tools:n}=e;const r=[],o=t.filter((e=>"source"!==e.type)).filter((e=>("tool-result"!==e.type||e.providerExecuted)&&("tool-error"!==e.type||e.providerExecuted))).filter((e=>"text"!==e.type||e.text.length>0)).map((e=>{switch(e.type){case"text":return{type:"text",text:e.text,providerOptions:e.providerMetadata};case"reasoning":return{type:"reasoning",text:e.text,providerOptions:e.providerMetadata};case"file":return{type:"file",data:e.file.base64,mediaType:e.file.mediaType,providerOptions:e.providerMetadata};case"tool-call":return{type:"tool-call",toolCallId:e.toolCallId,toolName:e.toolName,input:e.input,providerExecuted:e.providerExecuted,providerOptions:e.providerMetadata};case"tool-result":return{type:"tool-result",toolCallId:e.toolCallId,toolName:e.toolName,output:Fk({tool:null==n?void 0:n[e.toolName],output:e.output,errorMode:"none"}),providerExecuted:!0,providerOptions:e.providerMetadata};case"tool-error":return{type:"tool-result",toolCallId:e.toolCallId,toolName:e.toolName,output:Fk({tool:null==n?void 0:n[e.toolName],output:e.error,errorMode:"json"}),providerOptions:e.providerMetadata}}}));o.length>0&&r.push({role:"assistant",content:o});const a=t.filter((e=>"tool-result"===e.type||"tool-error"===e.type)).filter((e=>!e.providerExecuted)).map((e=>({type:"tool-result",toolCallId:e.toolCallId,toolName:e.toolName,output:Fk({tool:null==n?void 0:n[e.toolName],output:"tool-result"===e.type?e.output:e.error,errorMode:"tool-error"===e.type?"text":"none"})})));return a.length>0&&r.push({role:"tool",content:a}),r}var zk=Kh({prefix:"aitxt",size:24});async function Ok(e){let{model:t,tools:n,toolChoice:r,system:o,prompt:a,messages:i,maxRetries:s,abortSignal:l,headers:c,stopWhen:u=Ak(1),experimental_output:d,experimental_telemetry:p,providerOptions:h,experimental_activeTools:f,activeTools:m=f,experimental_prepareStep:g,prepareStep:_=g,experimental_repairToolCall:v,experimental_download:y,experimental_context:w,_internal:{generateId:b=zk,currentDate:x=()=>new Date}={},onStepFinish:k}=e,C=Kc(e,yb);const D=Px(t),S=wk(u),{maxRetries:E,retry:T}=kk({maxRetries:s,abortSignal:l}),A=Wx(C),M=ef(null!=c?c:{},"ai/".concat(jx)),F=ck({model:D,telemetry:p,headers:M,settings:so(so({},A),{},{maxRetries:E})}),I=await ik({system:o,prompt:a,messages:i}),P=hk(p);try{return await fk({name:"ai.generateText",attributes:gk({telemetry:p,attributes:so(so(so({},lk({operationId:"ai.generateText",telemetry:p})),F),{},{"ai.model.provider":D.provider,"ai.model.id":D.modelId,"ai.prompt":{input:()=>JSON.stringify({system:o,prompt:a,messages:i})}})}),tracer:P,fn:async e=>{var t,a,i,s,c,u,f;const g=Wx(C);let E,A=[],z=[];const O=[],N=[];do{const e=[...I.messages,...O],S=await(null==_?void 0:_({model:D,steps:N,stepNumber:N.length,messages:e})),B=Px(null!=(t=null==S?void 0:S.model)?t:D),j=await Ux({prompt:{system:null!=(a=null==S?void 0:S.system)?a:I.system,messages:null!=(i=null==S?void 0:S.messages)?i:e},supportedUrls:await B.supportedUrls,download:y}),{toolChoice:L,tools:R}=Gx({tools:n,toolChoice:null!=(s=null==S?void 0:S.toolChoice)?s:r,activeTools:null!=(c=null==S?void 0:S.activeTools)?c:m});E=await T((()=>{var e;return fk({name:"ai.generateText.doGenerate",attributes:gk({telemetry:p,attributes:so(so(so({},lk({operationId:"ai.generateText.doGenerate",telemetry:p})),F),{},{"ai.model.provider":B.provider,"ai.model.id":B.modelId,"ai.prompt.messages":{input:()=>_k(j)},"ai.prompt.tools":{input:()=>null==R?void 0:R.map((e=>JSON.stringify(e)))},"ai.prompt.toolChoice":{input:()=>null!=L?JSON.stringify(L):void 0},"gen_ai.system":B.provider,"gen_ai.request.model":B.modelId,"gen_ai.request.frequency_penalty":C.frequencyPenalty,"gen_ai.request.max_tokens":C.maxOutputTokens,"gen_ai.request.presence_penalty":C.presencePenalty,"gen_ai.request.stop_sequences":C.stopSequences,"gen_ai.request.temperature":null!=(e=C.temperature)?e:void 0,"gen_ai.request.top_k":C.topK,"gen_ai.request.top_p":C.topP})}),tracer:P,fn:async e=>{var t,n,r,o,a,i,s,c;const u=await B.doGenerate(so(so({},g),{},{tools:R,toolChoice:L,responseFormat:null==d?void 0:d.responseFormat,prompt:j,providerOptions:h,abortSignal:l,headers:M})),f={id:null!=(n=null==(t=u.response)?void 0:t.id)?n:b(),timestamp:null!=(o=null==(r=u.response)?void 0:r.timestamp)?o:x(),modelId:null!=(i=null==(a=u.response)?void 0:a.modelId)?i:B.modelId,headers:null==(s=u.response)?void 0:s.headers,body:null==(c=u.response)?void 0:c.body};return e.setAttributes(gk({telemetry:p,attributes:{"ai.response.finishReason":u.finishReason,"ai.response.text":{output:()=>Ck(u.content)},"ai.response.toolCalls":{output:()=>{const e=jk(u.content);return null==e?void 0:JSON.stringify(e)}},"ai.response.id":f.id,"ai.response.model":f.modelId,"ai.response.timestamp":f.timestamp.toISOString(),"ai.response.providerMetadata":JSON.stringify(u.providerMetadata),"ai.usage.promptTokens":u.usage.inputTokens,"ai.usage.completionTokens":u.usage.outputTokens,"gen_ai.response.finish_reasons":[u.finishReason],"gen_ai.response.id":f.id,"gen_ai.response.model":f.modelId,"gen_ai.usage.input_tokens":u.usage.inputTokens,"gen_ai.usage.output_tokens":u.usage.outputTokens}})),so(so({},u),{},{response:f})}})}));const V=await Promise.all(E.content.filter((e=>"tool-call"===e.type)).map((t=>Sk({toolCall:t,tools:n,repairToolCall:v,system:o,messages:e}))));for(const t of V){if(t.invalid)continue;const r=n[t.toolName];null!=(null==r?void 0:r.onInputAvailable)&&await r.onInputAvailable({input:t.input,toolCallId:t.toolCallId,messages:e,abortSignal:l,experimental_context:w})}const q=V.filter((e=>e.invalid&&e.dynamic));z=[];for(const t of q)z.push({type:"tool-error",toolCallId:t.toolCallId,toolName:t.toolName,input:t.input,error:$h(t.error),dynamic:!0});A=V.filter((e=>!e.providerExecuted)),null!=n&&z.push(...await Nk({toolCalls:A.filter((e=>!e.invalid)),tools:n,tracer:P,telemetry:p,messages:e,abortSignal:l,experimental_context:w}));const U=Lk({content:E.content,toolCalls:V,toolOutputs:z});O.push(...Pk({content:U,tools:n}));const W=new Tk({content:U,finishReason:E.finishReason,usage:E.usage,warnings:E.warnings,providerMetadata:E.providerMetadata,request:null!=(u=E.request)?u:{},response:so(so({},E.response),{},{messages:structuredClone(O)})});Ab(null!=(f=E.warnings)?f:[]),N.push(W),await(null==k?void 0:k(W))}while(A.length>0&&z.length===A.length&&!await Mk({stopConditions:S,steps:N}));e.setAttributes(gk({telemetry:p,attributes:{"ai.response.finishReason":E.finishReason,"ai.response.text":{output:()=>Ck(E.content)},"ai.response.toolCalls":{output:()=>{const e=jk(E.content);return null==e?void 0:JSON.stringify(e)}},"ai.response.providerMetadata":JSON.stringify(E.providerMetadata),"ai.usage.promptTokens":E.usage.inputTokens,"ai.usage.completionTokens":E.usage.outputTokens}}));const B=N[N.length-1];let j;return"stop"===B.finishReason&&(j=await(null==d?void 0:d.parseOutput({text:B.text},{response:B.response,usage:B.usage,finishReason:B.finishReason}))),new Bk({steps:N,resolvedOutput:j})}})}catch(z){throw sk(z)}}async function Nk(e){let{toolCalls:t,tools:n,tracer:r,telemetry:o,messages:a,abortSignal:i,experimental_context:s}=e;const l=await Promise.all(t.map((async e=>{let{toolCallId:t,toolName:l,input:c}=e;const u=n[l];if(null!=(null==u?void 0:u.execute))return fk({name:"ai.toolCall",attributes:gk({telemetry:o,attributes:so(so({},lk({operationId:"ai.toolCall",telemetry:o})),{},{"ai.toolCall.name":l,"ai.toolCall.id":t,"ai.toolCall.args":{output:()=>JSON.stringify(c)}})}),tracer:r,fn:async e=>{try{const g=function(e){return km.apply(this,arguments)}({execute:u.execute.bind(u),input:c,options:{toolCallId:t,messages:a,abortSignal:i,experimental_context:s}});let _;var n,r=!1,d=!1;try{for(var p,h=Zc(g);r=!(p=await h.next()).done;r=!1){const e=p.value;"final"===e.type&&(_=e.output)}}catch(f){d=!0,n=f}finally{try{r&&null!=h.return&&await h.return()}finally{if(d)throw n}}try{e.setAttributes(gk({telemetry:o,attributes:{"ai.toolCall.result":{output:()=>JSON.stringify(_)}}}))}catch(m){}return{type:"tool-result",toolCallId:t,toolName:l,input:c,output:_,dynamic:"dynamic"===u.type}}catch(g){return mk(e,g),{type:"tool-error",toolCallId:t,toolName:l,input:c,error:g,dynamic:"dynamic"===u.type}}}})})));return l.filter((e=>null!=e))}var Bk=class{constructor(e){this.steps=e.steps,this.resolvedOutput=e.resolvedOutput}get finalStep(){return this.steps[this.steps.length-1]}get content(){return this.finalStep.content}get text(){return this.finalStep.text}get files(){return this.finalStep.files}get reasoningText(){return this.finalStep.reasoningText}get reasoning(){return this.finalStep.reasoning}get toolCalls(){return this.finalStep.toolCalls}get staticToolCalls(){return this.finalStep.staticToolCalls}get dynamicToolCalls(){return this.finalStep.dynamicToolCalls}get toolResults(){return this.finalStep.toolResults}get staticToolResults(){return this.finalStep.staticToolResults}get dynamicToolResults(){return this.finalStep.dynamicToolResults}get sources(){return this.finalStep.sources}get finishReason(){return this.finalStep.finishReason}get warnings(){return this.finalStep.warnings}get providerMetadata(){return this.finalStep.providerMetadata}get response(){return this.finalStep.response}get request(){return this.finalStep.request}get usage(){return this.finalStep.usage}get totalUsage(){return this.steps.reduce(((e,t)=>vk(e,t.usage)),{inputTokens:void 0,outputTokens:void 0,totalTokens:void 0,reasoningTokens:void 0,cachedInputTokens:void 0})}get experimental_output(){if(null==this.resolvedOutput)throw new Db;return this.resolvedOutput}};function jk(e){const t=e.filter((e=>"tool-call"===e.type));if(0!==t.length)return t.map((e=>({toolCallId:e.toolCallId,toolName:e.toolName,input:e.input})))}function Lk(e){let{content:t,toolCalls:n,toolOutputs:r}=e;return[...t.map((e=>{switch(e.type){case"text":case"reasoning":case"source":return e;case"file":return{type:"file",file:new Dk(e)};case"tool-call":return n.find((t=>t.toolCallId===e.toolCallId));case"tool-result":{const t=n.find((t=>t.toolCallId===e.toolCallId));if(null==t)throw new Error("Tool call ".concat(e.toolCallId," not found."));return e.isError?{type:"tool-error",toolCallId:e.toolCallId,toolName:e.toolName,input:t.input,error:e.result,providerExecuted:!0,dynamic:t.dynamic}:{type:"tool-result",toolCallId:e.toolCallId,toolName:e.toolName,input:t.input,output:e.result,providerExecuted:!0,dynamic:t.dynamic}}}})),...r]}TransformStream;hf((()=>pm(Lv([Nv({type:Xv("text-start"),id:X_(),providerMetadata:Kx.optional()}),Nv({type:Xv("text-delta"),id:X_(),delta:X_(),providerMetadata:Kx.optional()}),Nv({type:Xv("text-end"),id:X_(),providerMetadata:Kx.optional()}),Nv({type:Xv("error"),errorText:X_()}),Nv({type:Xv("tool-input-start"),toolCallId:X_(),toolName:X_(),providerExecuted:kv().optional(),dynamic:kv().optional()}),Nv({type:Xv("tool-input-delta"),toolCallId:X_(),inputTextDelta:X_()}),Nv({type:Xv("tool-input-available"),toolCallId:X_(),toolName:X_(),input:Av(),providerExecuted:kv().optional(),providerMetadata:Kx.optional(),dynamic:kv().optional()}),Nv({type:Xv("tool-input-error"),toolCallId:X_(),toolName:X_(),input:Av(),providerExecuted:kv().optional(),providerMetadata:Kx.optional(),dynamic:kv().optional(),errorText:X_()}),Nv({type:Xv("tool-output-available"),toolCallId:X_(),output:Av(),providerExecuted:kv().optional(),dynamic:kv().optional(),preliminary:kv().optional()}),Nv({type:Xv("tool-output-error"),toolCallId:X_(),errorText:X_(),providerExecuted:kv().optional(),dynamic:kv().optional()}),Nv({type:Xv("reasoning-start"),id:X_(),providerMetadata:Kx.optional()}),Nv({type:Xv("reasoning-delta"),id:X_(),delta:X_(),providerMetadata:Kx.optional()}),Nv({type:Xv("reasoning-end"),id:X_(),providerMetadata:Kx.optional()}),Nv({type:Xv("source-url"),sourceId:X_(),url:X_(),title:X_().optional(),providerMetadata:Kx.optional()}),Nv({type:Xv("source-document"),sourceId:X_(),mediaType:X_(),title:X_(),filename:X_().optional(),providerMetadata:Kx.optional()}),Nv({type:Xv("file"),url:X_(),mediaType:X_(),providerMetadata:Kx.optional()}),Nv({type:hy((e=>"string"===typeof e&&e.startsWith("data-")),{message:'Type must start with "data-"'}),id:X_().optional(),data:Av(),transient:kv().optional()}),Nv({type:Xv("start-step")}),Nv({type:Xv("finish-step")}),Nv({type:Xv("start"),messageId:X_().optional(),messageMetadata:Av().optional()}),Nv({type:Xv("finish"),messageMetadata:Av().optional()}),Nv({type:Xv("abort")}),Nv({type:Xv("message-metadata"),messageMetadata:Av()})]))));function Rk(e){const t=["ROOT"];let n=-1,r=null;function o(e,o,a){switch(e){case'"':n=o,t.pop(),t.push(a),t.push("INSIDE_STRING");break;case"f":case"t":case"n":n=o,r=o,t.pop(),t.push(a),t.push("INSIDE_LITERAL");break;case"-":t.pop(),t.push(a),t.push("INSIDE_NUMBER");break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":n=o,t.pop(),t.push(a),t.push("INSIDE_NUMBER");break;case"{":n=o,t.pop(),t.push(a),t.push("INSIDE_OBJECT_START");break;case"[":n=o,t.pop(),t.push(a),t.push("INSIDE_ARRAY_START")}}function a(e,r){switch(e){case",":t.pop(),t.push("INSIDE_OBJECT_AFTER_COMMA");break;case"}":n=r,t.pop()}}function i(e,r){switch(e){case",":t.pop(),t.push("INSIDE_ARRAY_AFTER_COMMA");break;case"]":n=r,t.pop()}}for(let l=0;l<e.length;l++){const s=e[l];switch(t[t.length-1]){case"ROOT":o(s,l,"FINISH");break;case"INSIDE_OBJECT_START":switch(s){case'"':t.pop(),t.push("INSIDE_OBJECT_KEY");break;case"}":n=l,t.pop()}break;case"INSIDE_OBJECT_AFTER_COMMA":if('"'===s)t.pop(),t.push("INSIDE_OBJECT_KEY");break;case"INSIDE_OBJECT_KEY":if('"'===s)t.pop(),t.push("INSIDE_OBJECT_AFTER_KEY");break;case"INSIDE_OBJECT_AFTER_KEY":if(":"===s)t.pop(),t.push("INSIDE_OBJECT_BEFORE_VALUE");break;case"INSIDE_OBJECT_BEFORE_VALUE":o(s,l,"INSIDE_OBJECT_AFTER_VALUE");break;case"INSIDE_OBJECT_AFTER_VALUE":a(s,l);break;case"INSIDE_STRING":switch(s){case'"':t.pop(),n=l;break;case"\\":t.push("INSIDE_STRING_ESCAPE");break;default:n=l}break;case"INSIDE_ARRAY_START":if("]"===s)n=l,t.pop();else n=l,o(s,l,"INSIDE_ARRAY_AFTER_VALUE");break;case"INSIDE_ARRAY_AFTER_VALUE":switch(s){case",":t.pop(),t.push("INSIDE_ARRAY_AFTER_COMMA");break;case"]":n=l,t.pop();break;default:n=l}break;case"INSIDE_ARRAY_AFTER_COMMA":o(s,l,"INSIDE_ARRAY_AFTER_VALUE");break;case"INSIDE_STRING_ESCAPE":t.pop(),n=l;break;case"INSIDE_NUMBER":switch(s){case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":n=l;break;case"e":case"E":case"-":case".":break;case",":t.pop(),"INSIDE_ARRAY_AFTER_VALUE"===t[t.length-1]&&i(s,l),"INSIDE_OBJECT_AFTER_VALUE"===t[t.length-1]&&a(s,l);break;case"}":t.pop(),"INSIDE_OBJECT_AFTER_VALUE"===t[t.length-1]&&a(s,l);break;case"]":t.pop(),"INSIDE_ARRAY_AFTER_VALUE"===t[t.length-1]&&i(s,l);break;default:t.pop()}break;case"INSIDE_LITERAL":{const o=e.substring(r,l+1);"false".startsWith(o)||"true".startsWith(o)||"null".startsWith(o)?n=l:(t.pop(),"INSIDE_OBJECT_AFTER_VALUE"===t[t.length-1]?a(s,l):"INSIDE_ARRAY_AFTER_VALUE"===t[t.length-1]&&i(s,l));break}}}let s=e.slice(0,n+1);for(let l=t.length-1;l>=0;l--){switch(t[l]){case"INSIDE_STRING":s+='"';break;case"INSIDE_OBJECT_KEY":case"INSIDE_OBJECT_AFTER_KEY":case"INSIDE_OBJECT_AFTER_COMMA":case"INSIDE_OBJECT_START":case"INSIDE_OBJECT_BEFORE_VALUE":case"INSIDE_OBJECT_AFTER_VALUE":s+="}";break;case"INSIDE_ARRAY_START":case"INSIDE_ARRAY_AFTER_COMMA":case"INSIDE_ARRAY_AFTER_VALUE":s+="]";break;case"INSIDE_LITERAL":{const t=e.substring(r,e.length);"true".startsWith(t)?s+="true".slice(t.length):"false".startsWith(t)?s+="false".slice(t.length):"null".startsWith(t)&&(s+="null".slice(t.length))}}}return s}async function Vk(e){if(void 0===e)return{value:void 0,state:"undefined-input"};let t=await _f({text:e});return t.success?{value:t.value,state:"successful-parse"}:(t=await _f({text:Rk(e)}),t.success?{value:t.value,state:"repaired-parse"}:{value:void 0,state:"failed-parse"})}Kh({prefix:"aitxt",size:24});Kh({prefix:"aiobj",size:24});Kh({prefix:"aiobj",size:24});((e,t)=>{for(var n in t)bb(e,n,{get:t[n],enumerable:!0})})({},{object:()=>Uk,text:()=>qk});var qk=()=>({type:"text",responseFormat:{type:"text"},async parsePartial(e){let{text:t}=e;return{partial:t}},async parseOutput(e){let{text:t}=e;return t}}),Uk=e=>{let{schema:t}=e;const n=gm(t);return{type:"object",responseFormat:{type:"json",schema:n.jsonSchema},async parsePartial(e){let{text:t}=e;const n=await Vk(t);switch(n.state){case"failed-parse":case"undefined-input":return;case"repaired-parse":case"successful-parse":return{partial:n.value};default:{const e=n.state;throw new Error("Unsupported parse state: ".concat(e))}}},async parseOutput(e,t){let{text:r}=e;const o=await _f({text:r});if(!o.success)throw new Jb({message:"No object generated: could not parse the response.",cause:o.error,text:r,response:t.response,usage:t.usage,finishReason:t.finishReason});const a=await gf({value:o.value,schema:n});if(!a.success)throw new Jb({message:"No object generated: response did not match schema.",cause:a.error,text:r,response:t.response,usage:t.usage,finishReason:t.finishReason});return a.value}}};var Wk="AI_NoSuchProviderError",Gk="vercel.ai.error.".concat(Wk),Hk=Symbol.for(Gk);var Kk=Bv({name:X_(),version:X_()}),Zk=Bv({_meta:ey(Ov({}).loose())}),$k=Zk,Xk=Ov({method:X_(),params:ey(Zk)}),Jk=Bv({experimental:ey(Ov({}).loose()),logging:ey(Ov({}).loose()),prompts:ey(Bv({listChanged:ey(kv())})),resources:ey(Bv({subscribe:ey(kv()),listChanged:ey(kv())})),tools:ey(Bv({listChanged:ey(kv())}))}),Qk=($k.extend({protocolVersion:X_(),capabilities:Jk,serverInfo:Kk,instructions:ey(X_())}),$k.extend({nextCursor:ey(X_())})),Yk=Ov({name:X_(),description:ey(X_()),inputSchema:Ov({type:Xv("object"),properties:ey(Ov({}).loose())}).loose()}).loose(),eC=(Qk.extend({tools:Pv(Yk)}),Ov({type:Xv("text"),text:X_()}).loose()),tC=Ov({type:Xv("image"),data:fv(),mimeType:X_()}).loose(),nC=Ov({uri:X_(),mimeType:ey(X_())}).loose(),rC=nC.extend({text:X_()}),oC=nC.extend({blob:fv()}),aC=Ov({type:Xv("resource"),resource:Lv([rC,oC])}).loose(),iC=($k.extend({content:Pv(Lv([eC,tC,aC])),isError:kv().default(!1).optional()}).or($k.extend({toolResult:Av()})),"2.0"),sC=Ov({jsonrpc:Xv(iC),id:Lv([X_(),yv().int()])}).merge(Xk).strict(),lC=Ov({jsonrpc:Xv(iC),id:Lv([X_(),yv().int()]),result:$k}).strict(),cC=Ov({jsonrpc:Xv(iC),id:Lv([X_(),yv().int()]),error:Ov({code:yv().int(),message:X_(),data:ey(Av())})}).strict();Lv([sC,Ov({jsonrpc:Xv(iC)}).merge(Ov({method:X_(),params:ey(Zk)})).strict(),lC,cC]);hf((()=>pm(Pv(Ov({id:X_(),role:Zv(["system","user","assistant"]),metadata:Av().optional(),parts:Pv(Lv([Ov({type:Xv("text"),text:X_(),state:Zv(["streaming","done"]).optional(),providerMetadata:Kx.optional()}),Ov({type:Xv("reasoning"),text:X_(),state:Zv(["streaming","done"]).optional(),providerMetadata:Kx.optional()}),Ov({type:Xv("source-url"),sourceId:X_(),url:X_(),title:X_().optional(),providerMetadata:Kx.optional()}),Ov({type:Xv("source-document"),sourceId:X_(),mediaType:X_(),title:X_(),filename:X_().optional(),providerMetadata:Kx.optional()}),Ov({type:Xv("file"),mediaType:X_(),filename:X_().optional(),url:X_(),providerMetadata:Kx.optional()}),Ov({type:Xv("step-start")}),Ov({type:X_().startsWith("data-"),id:X_().optional(),data:Av()}),Ov({type:Xv("dynamic-tool"),toolName:X_(),toolCallId:X_(),state:Xv("input-streaming"),input:Av().optional(),output:Fv().optional(),errorText:Fv().optional()}),Ov({type:Xv("dynamic-tool"),toolName:X_(),toolCallId:X_(),state:Xv("input-available"),input:Av(),output:Fv().optional(),errorText:Fv().optional(),callProviderMetadata:Kx.optional()}),Ov({type:Xv("dynamic-tool"),toolName:X_(),toolCallId:X_(),state:Xv("output-available"),input:Av(),output:Av(),errorText:Fv().optional(),callProviderMetadata:Kx.optional(),preliminary:kv().optional()}),Ov({type:Xv("dynamic-tool"),toolName:X_(),toolCallId:X_(),state:Xv("output-error"),input:Av(),output:Fv().optional(),errorText:X_(),callProviderMetadata:Kx.optional()}),Ov({type:X_().startsWith("tool-"),toolCallId:X_(),state:Xv("input-streaming"),providerExecuted:kv().optional(),input:Av().optional(),output:Fv().optional(),errorText:Fv().optional(),approval:Fv().optional()}),Ov({type:X_().startsWith("tool-"),toolCallId:X_(),state:Xv("input-available"),providerExecuted:kv().optional(),input:Av(),output:Fv().optional(),errorText:Fv().optional(),callProviderMetadata:Kx.optional(),approval:Fv().optional()}),Ov({type:X_().startsWith("tool-"),toolCallId:X_(),state:Xv("approval-requested"),input:Av(),providerExecuted:kv().optional(),output:Fv().optional(),errorText:Fv().optional(),callProviderMetadata:Kx.optional(),approval:Ov({id:X_(),approved:Fv().optional(),reason:Fv().optional()})}),Ov({type:X_().startsWith("tool-"),toolCallId:X_(),state:Xv("approval-responded"),input:Av(),providerExecuted:kv().optional(),output:Fv().optional(),errorText:Fv().optional(),callProviderMetadata:Kx.optional(),approval:Ov({id:X_(),approved:kv(),reason:X_().optional()})}),Ov({type:X_().startsWith("tool-"),toolCallId:X_(),state:Xv("output-available"),providerExecuted:kv().optional(),input:Av(),output:Av(),errorText:Fv().optional(),callProviderMetadata:Kx.optional(),preliminary:kv().optional(),approval:Ov({id:X_(),approved:Xv(!0),reason:X_().optional()}).optional()}),Ov({type:X_().startsWith("tool-"),toolCallId:X_(),state:Xv("output-error"),providerExecuted:kv().optional(),input:Av(),output:Fv().optional(),errorText:X_(),callProviderMetadata:Kx.optional(),approval:Ov({id:X_(),approved:Xv(!0),reason:X_().optional()}).optional()}),Ov({type:X_().startsWith("tool-"),toolCallId:X_(),state:Xv("output-denied"),providerExecuted:kv().optional(),input:Av(),output:Fv().optional(),errorText:Fv().optional(),callProviderMetadata:Kx.optional(),approval:Ov({id:X_(),approved:Xv(!1),reason:X_().optional()})})]))})))));const uC=new Map,dC=[],pC=(e,t,n)=>{if(!t||"function"!==typeof t.init||"function"!==typeof t.createInferenceSessionHandler)throw new TypeError("not a valid backend");{const r=uC.get(e);if(void 0===r)uC.set(e,{backend:t,priority:n});else{if(r.priority>n)return;if(r.priority===n&&r.backend!==t)throw new Error('cannot register backend "'.concat(e,'" using priority ').concat(n))}if(n>=0){const t=dC.indexOf(e);-1!==t&&dC.splice(t,1);for(let r=0;r<dC.length;r++)if(uC.get(dC[r]).priority<=n)return void dC.splice(r,0,e);dC.push(e)}}},hC=async e=>{const t=uC.get(e);if(!t)return"backend not found.";if(t.initialized)return t.backend;if(t.aborted)return t.error;{const n=!!t.initPromise;try{return n||(t.initPromise=t.backend.init(e)),await t.initPromise,t.initialized=!0,t.backend}catch(AC){return n||(t.error="".concat(AC),t.aborted=!0),t.error}finally{delete t.initPromise}}};let fC="warning";const mC={wasm:{},webgl:{},webgpu:{},versions:{common:"1.21.0"},set logLevel(e){if(void 0!==e){if("string"!==typeof e||-1===["verbose","info","warning","error","fatal"].indexOf(e))throw new Error("Unsupported logging level: ".concat(e));fC=e}},get logLevel(){return fC}};Object.defineProperty(mC,"logLevel",{enumerable:!0});const gC=mC,_C=(e,t)=>{var n;if(void 0===e)throw new Error("Image buffer must be defined");if(void 0===t.height||void 0===t.width)throw new Error("Image height and width must be defined");if("NHWC"===t.tensorLayout)throw new Error("NHWC Tensor layout is not supported yet");const{height:r,width:o}=t,a=null!==(n=t.norm)&&void 0!==n?n:{mean:255,bias:0};let i,s;var l,c;"number"===typeof a.mean?i=[a.mean,a.mean,a.mean,a.mean]:i=[a.mean[0],a.mean[1],a.mean[2],null!==(l=a.mean[3])&&void 0!==l?l:255];"number"===typeof a.bias?s=[a.bias,a.bias,a.bias,a.bias]:s=[a.bias[0],a.bias[1],a.bias[2],null!==(c=a.bias[3])&&void 0!==c?c:0];const u=void 0!==t.format?t.format:"RGBA",d=void 0!==t.tensorFormat&&void 0!==t.tensorFormat?t.tensorFormat:"RGB",p=r*o,h="RGBA"===d?new Float32Array(4*p):new Float32Array(3*p);let f=4,m=0,g=1,_=2,v=3,y=0,w=p,b=2*p,x=-1;"RGB"===u&&(f=3,m=0,g=1,_=2,v=-1),"RGBA"===d?x=3*p:"RBG"===d?(y=0,b=p,w=2*p):"BGR"===d&&(b=0,w=p,y=2*p);for(let k=0;k<p;k++,m+=f,_+=f,g+=f,v+=f)h[y++]=(e[m]+s[0])/i[0],h[w++]=(e[g]+s[1])/i[1],h[b++]=(e[_]+s[2])/i[2],-1!==x&&-1!==v&&(h[x++]=(e[v]+s[3])/i[3]);return new bC("float32",h,"RGBA"===d?[1,4,r,o]:[1,3,r,o])},vC=new Map([["float32",Float32Array],["uint8",Uint8Array],["int8",Int8Array],["uint16",Uint16Array],["int16",Int16Array],["int32",Int32Array],["bool",Uint8Array],["float64",Float64Array],["uint32",Uint32Array],["int4",Uint8Array],["uint4",Uint8Array]]),yC=new Map([[Float32Array,"float32"],[Uint8Array,"uint8"],[Int8Array,"int8"],[Uint16Array,"uint16"],[Int16Array,"int16"],[Int32Array,"int32"],[Float64Array,"float64"],[Uint32Array,"uint32"]]);let wC=!1;class bC{constructor(e,t,n){let r,o;if((()=>{if(!wC){wC=!0;const e="undefined"!==typeof BigInt64Array&&BigInt64Array.from,t="undefined"!==typeof BigUint64Array&&BigUint64Array.from,n=globalThis.Float16Array,r="undefined"!==typeof n&&n.from;e&&(vC.set("int64",BigInt64Array),yC.set(BigInt64Array,"int64")),t&&(vC.set("uint64",BigUint64Array),yC.set(BigUint64Array,"uint64")),r?(vC.set("float16",n),yC.set(n,"float16")):vC.set("float16",Uint16Array)}})(),"object"===typeof e&&"location"in e)switch(this.dataLocation=e.location,r=e.type,o=e.dims,e.location){case"cpu-pinned":{const t=vC.get(r);if(!t)throw new TypeError('unsupported type "'.concat(r,'" to create tensor from pinned buffer'));if(!(e.data instanceof t))throw new TypeError("buffer should be of type ".concat(t.name));this.cpuData=e.data;break}case"texture":if("float32"!==r)throw new TypeError('unsupported type "'.concat(r,'" to create tensor from texture'));this.gpuTextureData=e.texture,this.downloader=e.download,this.disposer=e.dispose;break;case"gpu-buffer":if("float32"!==r&&"float16"!==r&&"int32"!==r&&"int64"!==r&&"uint32"!==r&&"uint8"!==r&&"bool"!==r&&"uint4"!==r&&"int4"!==r)throw new TypeError('unsupported type "'.concat(r,'" to create tensor from gpu buffer'));this.gpuBufferData=e.gpuBuffer,this.downloader=e.download,this.disposer=e.dispose;break;case"ml-tensor":if("float32"!==r&&"float16"!==r&&"int32"!==r&&"int64"!==r&&"uint32"!==r&&"uint64"!==r&&"int8"!==r&&"uint8"!==r&&"bool"!==r&&"uint4"!==r&&"int4"!==r)throw new TypeError('unsupported type "'.concat(r,'" to create tensor from MLTensor'));this.mlTensorData=e.mlTensor,this.downloader=e.download,this.disposer=e.dispose;break;default:throw new Error("Tensor constructor: unsupported location '".concat(this.dataLocation,"'"))}else{let a,i;if("string"===typeof e)if(r=e,i=n,"string"===e){if(!Array.isArray(t))throw new TypeError("A string tensor's data must be a string array.");a=t}else{const n=vC.get(e);if(void 0===n)throw new TypeError("Unsupported tensor type: ".concat(e,"."));if(Array.isArray(t)){if("float16"===e&&n===Uint16Array||"uint4"===e||"int4"===e)throw new TypeError("Creating a ".concat(e," tensor from number array is not supported. Please use ").concat(n.name," as data."));a="uint64"===e||"int64"===e?n.from(t,BigInt):n.from(t)}else if(t instanceof n)a=t;else if(t instanceof Uint8ClampedArray){if("uint8"!==e)throw new TypeError("A Uint8ClampedArray tensor's data must be type of uint8");a=Uint8Array.from(t)}else{if(!("float16"===e&&t instanceof Uint16Array&&n!==Uint16Array))throw new TypeError("A ".concat(r," tensor's data must be type of ").concat(n));a=new globalThis.Float16Array(t.buffer,t.byteOffset,t.length)}}else if(i=t,Array.isArray(e)){if(0===e.length)throw new TypeError("Tensor type cannot be inferred from an empty array.");const t=typeof e[0];if("string"===t)r="string",a=e;else{if("boolean"!==t)throw new TypeError("Invalid element type of data array: ".concat(t,"."));r="bool",a=Uint8Array.from(e)}}else if(e instanceof Uint8ClampedArray)r="uint8",a=Uint8Array.from(e);else{const t=yC.get(e.constructor);if(void 0===t)throw new TypeError("Unsupported type for tensor data: ".concat(e.constructor,"."));r=t,a=e}if(void 0===i)i=[a.length];else if(!Array.isArray(i))throw new TypeError("A tensor's dims must be a number array");o=i,this.cpuData=a,this.dataLocation="cpu"}const a=(e=>{let t=1;for(let n=0;n<e.length;n++){const r=e[n];if("number"!==typeof r||!Number.isSafeInteger(r))throw new TypeError("dims[".concat(n,"] must be an integer, got: ").concat(r));if(r<0)throw new RangeError("dims[".concat(n,"] must be a non-negative integer, got: ").concat(r));t*=r}return t})(o);if(this.cpuData&&a!==this.cpuData.length&&("uint4"!==r&&"int4"!==r||Math.ceil(a/2)!==this.cpuData.length))throw new Error("Tensor's size(".concat(a,") does not match data length(").concat(this.cpuData.length,")."));this.type=r,this.dims=o,this.size=a}static async fromImage(e,t){return(async(e,t)=>{const n="undefined"!==typeof HTMLImageElement&&e instanceof HTMLImageElement,r="undefined"!==typeof ImageData&&e instanceof ImageData,o="undefined"!==typeof ImageBitmap&&e instanceof ImageBitmap,a="string"===typeof e;let i,s=null!==t&&void 0!==t?t:{};const l=()=>{if("undefined"!==typeof document)return document.createElement("canvas");if("undefined"!==typeof OffscreenCanvas)return new OffscreenCanvas(1,1);throw new Error("Canvas is not supported")},c=e=>"undefined"!==typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||e instanceof OffscreenCanvas?e.getContext("2d"):null;if(n){const n=l();n.width=e.width,n.height=e.height;const r=c(n);if(null==r)throw new Error("Can not access image data");{let n=e.height,o=e.width;if(void 0!==t&&void 0!==t.resizedHeight&&void 0!==t.resizedWidth&&(n=t.resizedHeight,o=t.resizedWidth),void 0!==t){if(s=t,void 0!==t.tensorFormat)throw new Error("Image input config format must be RGBA for HTMLImageElement");s.tensorFormat="RGBA",s.height=n,s.width=o}else s.tensorFormat="RGBA",s.height=n,s.width=o;r.drawImage(e,0,0),i=r.getImageData(0,0,o,n).data}}else{if(!r){if(o){if(void 0===t)throw new Error("Please provide image config with format for Imagebitmap");const n=l();n.width=e.width,n.height=e.height;const r=c(n);if(null!=r){const t=e.height,n=e.width;return r.drawImage(e,0,0,n,t),i=r.getImageData(0,0,n,t).data,s.height=t,s.width=n,_C(i,s)}throw new Error("Can not access image data")}if(a)return new Promise(((t,n)=>{const r=l(),o=c(r);if(!e||!o)return n();const a=new Image;a.crossOrigin="Anonymous",a.src=e,a.onload=()=>{r.width=a.width,r.height=a.height,o.drawImage(a,0,0,r.width,r.height);const e=o.getImageData(0,0,r.width,r.height);s.height=r.height,s.width=r.width,t(_C(e.data,s))}}));throw new Error("Input data provided is not supported - aborted tensor creation")}{let n,r;if(void 0!==t&&void 0!==t.resizedWidth&&void 0!==t.resizedHeight?(n=t.resizedHeight,r=t.resizedWidth):(n=e.height,r=e.width),void 0!==t&&(s=t),s.format="RGBA",s.height=n,s.width=r,void 0!==t){const t=l();t.width=r,t.height=n;const o=c(t);if(null==o)throw new Error("Can not access image data");o.putImageData(e,0,0),i=o.getImageData(0,0,r,n).data}else i=e.data}}if(void 0!==i)return _C(i,s);throw new Error("Input data provided is not supported - aborted tensor creation")})(e,t)}static fromTexture(e,t){return((e,t)=>{const{width:n,height:r,download:o,dispose:a}=t;return new bC({location:"texture",type:"float32",texture:e,dims:[1,r,n,4],download:o,dispose:a})})(e,t)}static fromGpuBuffer(e,t){return((e,t)=>{const{dataType:n,dims:r,download:o,dispose:a}=t;return new bC({location:"gpu-buffer",type:null!==n&&void 0!==n?n:"float32",gpuBuffer:e,dims:r,download:o,dispose:a})})(e,t)}static fromMLTensor(e,t){return((e,t)=>{const{dataType:n,dims:r,download:o,dispose:a}=t;return new bC({location:"ml-tensor",type:null!==n&&void 0!==n?n:"float32",mlTensor:e,dims:r,download:o,dispose:a})})(e,t)}static fromPinnedBuffer(e,t,n){return((e,t,n)=>new bC({location:"cpu-pinned",type:e,data:t,dims:null!==n&&void 0!==n?n:[t.length]}))(e,t,n)}toDataURL(e){return((e,t)=>{const n="undefined"!==typeof document?document.createElement("canvas"):new OffscreenCanvas(1,1);n.width=e.dims[3],n.height=e.dims[2];const r=n.getContext("2d");if(null!=r){let o,a;void 0!==(null===t||void 0===t?void 0:t.tensorLayout)&&"NHWC"===t.tensorLayout?(o=e.dims[2],a=e.dims[3]):(o=e.dims[3],a=e.dims[2]);const i=void 0!==(null===t||void 0===t?void 0:t.format)?t.format:"RGB",s=null===t||void 0===t?void 0:t.norm;let l,c;void 0===s||void 0===s.mean?l=[255,255,255,255]:"number"===typeof s.mean?l=[s.mean,s.mean,s.mean,s.mean]:(l=[s.mean[0],s.mean[1],s.mean[2],0],void 0!==s.mean[3]&&(l[3]=s.mean[3])),void 0===s||void 0===s.bias?c=[0,0,0,0]:"number"===typeof s.bias?c=[s.bias,s.bias,s.bias,s.bias]:(c=[s.bias[0],s.bias[1],s.bias[2],0],void 0!==s.bias[3]&&(c[3]=s.bias[3]));const u=a*o;let d=0,p=u,h=2*u,f=-1;"RGBA"===i?(d=0,p=u,h=2*u,f=3*u):"RGB"===i?(d=0,p=u,h=2*u):"RBG"===i&&(d=0,h=u,p=2*u);for(let t=0;t<a;t++)for(let n=0;n<o;n++){const o=(e.data[d++]-c[0])*l[0],a=(e.data[p++]-c[1])*l[1],i=(e.data[h++]-c[2])*l[2],s=-1===f?255:(e.data[f++]-c[3])*l[3];r.fillStyle="rgba("+o+","+a+","+i+","+s+")",r.fillRect(n,t,1,1)}if("toDataURL"in n)return n.toDataURL();throw new Error("toDataURL is not supported")}throw new Error("Can not access image data")})(this,e)}toImageData(e){return((e,t)=>{const n="undefined"!==typeof document?document.createElement("canvas").getContext("2d"):new OffscreenCanvas(1,1).getContext("2d");let r;if(null==n)throw new Error("Can not access image data");{let o,a,i;void 0!==(null===t||void 0===t?void 0:t.tensorLayout)&&"NHWC"===t.tensorLayout?(o=e.dims[2],a=e.dims[1],i=e.dims[3]):(o=e.dims[3],a=e.dims[2],i=e.dims[1]);const s=void 0!==t&&void 0!==t.format?t.format:"RGB",l=null===t||void 0===t?void 0:t.norm;let c,u;void 0===l||void 0===l.mean?c=[255,255,255,255]:"number"===typeof l.mean?c=[l.mean,l.mean,l.mean,l.mean]:(c=[l.mean[0],l.mean[1],l.mean[2],255],void 0!==l.mean[3]&&(c[3]=l.mean[3])),void 0===l||void 0===l.bias?u=[0,0,0,0]:"number"===typeof l.bias?u=[l.bias,l.bias,l.bias,l.bias]:(u=[l.bias[0],l.bias[1],l.bias[2],0],void 0!==l.bias[3]&&(u[3]=l.bias[3]));const d=a*o;if(void 0!==t&&(void 0!==t.format&&4===i&&"RGBA"!==t.format||3===i&&"RGB"!==t.format&&"BGR"!==t.format))throw new Error("Tensor format doesn't match input tensor dims");const p=4;let h=0,f=1,m=2,g=3,_=0,v=d,y=2*d,w=-1;"RGBA"===s?(_=0,v=d,y=2*d,w=3*d):"RGB"===s?(_=0,v=d,y=2*d):"RBG"===s&&(_=0,y=d,v=2*d),r=n.createImageData(o,a);for(let t=0;t<a*o;h+=p,f+=p,m+=p,g+=p,t++)r.data[h]=(e.data[_++]-u[0])*c[0],r.data[f]=(e.data[v++]-u[1])*c[1],r.data[m]=(e.data[y++]-u[2])*c[2],r.data[g]=-1===w?255:(e.data[w++]-u[3])*c[3]}return r})(this,e)}get data(){if(this.ensureValid(),!this.cpuData)throw new Error("The data is not on CPU. Use `getData()` to download GPU data to CPU, or use `texture` or `gpuBuffer` property to access the GPU data directly.");return this.cpuData}get location(){return this.dataLocation}get texture(){if(this.ensureValid(),!this.gpuTextureData)throw new Error("The data is not stored as a WebGL texture.");return this.gpuTextureData}get gpuBuffer(){if(this.ensureValid(),!this.gpuBufferData)throw new Error("The data is not stored as a WebGPU buffer.");return this.gpuBufferData}get mlTensor(){if(this.ensureValid(),!this.mlTensorData)throw new Error("The data is not stored as a WebNN MLTensor.");return this.mlTensorData}async getData(e){switch(this.ensureValid(),this.dataLocation){case"cpu":case"cpu-pinned":return this.data;case"texture":case"gpu-buffer":case"ml-tensor":if(!this.downloader)throw new Error("The current tensor is not created with a specified data downloader.");if(this.isDownloading)throw new Error("The current tensor is being downloaded.");try{this.isDownloading=!0;const t=await this.downloader();return this.downloader=void 0,this.dataLocation="cpu",this.cpuData=t,e&&this.disposer&&(this.disposer(),this.disposer=void 0),t}finally{this.isDownloading=!1}default:throw new Error("cannot get data from location: ".concat(this.dataLocation))}}dispose(){if(this.isDownloading)throw new Error("The current tensor is being downloaded.");this.disposer&&(this.disposer(),this.disposer=void 0),this.cpuData=void 0,this.gpuTextureData=void 0,this.gpuBufferData=void 0,this.mlTensorData=void 0,this.downloader=void 0,this.isDownloading=void 0,this.dataLocation="none"}ensureValid(){if("none"===this.dataLocation)throw new Error("The tensor is disposed.")}reshape(e){if(this.ensureValid(),this.downloader||this.disposer)throw new Error("Cannot reshape a tensor that owns GPU resource.");return((e,t)=>{switch(e.location){case"cpu":return new bC(e.type,e.data,t);case"cpu-pinned":return new bC({location:"cpu-pinned",data:e.data,type:e.type,dims:t});case"texture":return new bC({location:"texture",texture:e.texture,type:e.type,dims:t});case"gpu-buffer":return new bC({location:"gpu-buffer",gpuBuffer:e.gpuBuffer,type:e.type,dims:t});case"ml-tensor":return new bC({location:"ml-tensor",mlTensor:e.mlTensor,type:e.type,dims:t});default:throw new Error("tensorReshape: tensor location ".concat(e.location," is not supported"))}})(this,e)}}const xC=bC,kC=(e,t)=>{("undefined"===typeof mC.trace?mC.wasm.trace:mC.trace)&&console.timeStamp("".concat(e,"::ORT::").concat(t))},CC=(e,t)=>{var n;const r=(null===(n=(new Error).stack)||void 0===n?void 0:n.split(/\r\n|\r|\n/g))||[];let o=!1;for(let a=0;a<r.length;a++){if(o&&!r[a].includes("TRACE_FUNC")){let n="FUNC_".concat(e,"::").concat(r[a].trim().split(" ")[1]);return t&&(n+="::".concat(t)),void kC("CPU",n)}r[a].includes("TRACE_FUNC")&&(o=!0)}},DC=e=>{("undefined"===typeof mC.trace?mC.wasm.trace:mC.trace)&&CC("BEGIN",e)},SC=e=>{("undefined"===typeof mC.trace?mC.wasm.trace:mC.trace)&&CC("END",e)};class EC{constructor(e){this.handler=e}async run(e,t,n){DC();const r={};let o={};if("object"!==typeof e||null===e||e instanceof xC||Array.isArray(e))throw new TypeError("'feeds' must be an object that use input names as keys and OnnxValue as corresponding values.");let a=!0;if("object"===typeof t){if(null===t)throw new TypeError("Unexpected argument[1]: cannot be null.");if(t instanceof xC)throw new TypeError("'fetches' cannot be a Tensor");if(Array.isArray(t)){if(0===t.length)throw new TypeError("'fetches' cannot be an empty array.");a=!1;for(const e of t){if("string"!==typeof e)throw new TypeError("'fetches' must be a string array or an object.");if(-1===this.outputNames.indexOf(e))throw new RangeError("'fetches' contains invalid output name: ".concat(e,"."));r[e]=null}if("object"===typeof n&&null!==n)o=n;else if("undefined"!==typeof n)throw new TypeError("'options' must be an object.")}else{let e=!1;const i=Object.getOwnPropertyNames(t);for(const n of this.outputNames)if(-1!==i.indexOf(n)){const o=t[n];(null===o||o instanceof xC)&&(e=!0,a=!1,r[n]=o)}if(e){if("object"===typeof n&&null!==n)o=n;else if("undefined"!==typeof n)throw new TypeError("'options' must be an object.")}else o=t}}else if("undefined"!==typeof t)throw new TypeError("Unexpected argument[1]: must be 'fetches' or 'options'.");for(const l of this.inputNames)if("undefined"===typeof e[l])throw new Error("input '".concat(l,"' is missing in 'feeds'."));if(a)for(const l of this.outputNames)r[l]=null;const i=await this.handler.run(e,r,o),s={};for(const l in i)if(Object.hasOwnProperty.call(i,l)){const e=i[l];s[l]=e instanceof xC?e:new xC(e.type,e.data,e.dims)}return SC(),s}async release(){return this.handler.dispose()}static async create(e,t,n,r){let o;DC();let a={};if("string"===typeof e){if(o=e,"object"===typeof t&&null!==t)a=t;else if("undefined"!==typeof t)throw new TypeError("'options' must be an object.")}else if(e instanceof Uint8Array){if(o=e,"object"===typeof t&&null!==t)a=t;else if("undefined"!==typeof t)throw new TypeError("'options' must be an object.")}else{if(!(e instanceof ArrayBuffer||"undefined"!==typeof SharedArrayBuffer&&e instanceof SharedArrayBuffer))throw new TypeError("Unexpected argument[0]: must be 'path' or 'buffer'.");{const i=e;let s=0,l=e.byteLength;if("object"===typeof t&&null!==t)a=t;else if("number"===typeof t){if(s=t,!Number.isSafeInteger(s))throw new RangeError("'byteOffset' must be an integer.");if(s<0||s>=i.byteLength)throw new RangeError("'byteOffset' is out of range [0, ".concat(i.byteLength,")."));if(l=e.byteLength-s,"number"===typeof n){if(l=n,!Number.isSafeInteger(l))throw new RangeError("'byteLength' must be an integer.");if(l<=0||s+l>i.byteLength)throw new RangeError("'byteLength' is out of range (0, ".concat(i.byteLength-s,"]."));if("object"===typeof r&&null!==r)a=r;else if("undefined"!==typeof r)throw new TypeError("'options' must be an object.")}else if("undefined"!==typeof n)throw new TypeError("'byteLength' must be a number.")}else if("undefined"!==typeof t)throw new TypeError("'options' must be an object.");o=new Uint8Array(i,s,l)}}const[i,s]=await(async e=>{const t=e.executionProviders||[],n=t.map((e=>"string"===typeof e?e:e.name)),r=0===n.length?dC:n;let o;const a=[],i=new Set;for(const l of r){const e=await hC(l);"string"===typeof e?a.push({name:l,err:e}):(o||(o=e),o===e&&i.add(l))}if(!o)throw new Error("no available backend found. ERR: ".concat(a.map((e=>"[".concat(e.name,"] ").concat(e.err))).join(", ")));for(const{name:l,err:c}of a)n.includes(l)&&console.warn('removing requested execution provider "'.concat(l,'" from session options because it is not available: ').concat(c));const s=t.filter((e=>i.has("string"===typeof e?e:e.name)));return[o,new Proxy(e,{get:(e,t)=>"executionProviders"===t?s:Reflect.get(e,t)})]})(a),l=await i.createInferenceSessionHandler(o,s);return SC(),new EC(l)}startProfiling(){this.handler.startProfiling()}endProfiling(){this.handler.endProfiling()}get inputNames(){return this.handler.inputNames}get outputNames(){return this.handler.outputNames}}const TC=EC;var AC,MC,FC,IC,PC,zC,OC,NC,BC,jC,LC,RC,VC,qC,UC,WC,GC,HC,KC,ZC,$C,XC,JC,QC,YC,eD,tD,nD,rD,oD,aD,iD,sD=Object.defineProperty,lD=Object.getOwnPropertyDescriptor,cD=Object.getOwnPropertyNames,uD=Object.prototype.hasOwnProperty,dD=(AC=function(e){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+e+'" is not supported')},typeof require<"u"?require:typeof Proxy<"u"?new Proxy(AC,{get:(e,t)=>(typeof require<"u"?require:e)[t]}):AC),pD=(e,t)=>()=>(e&&(t=e(e=0)),t),hD=(e,t)=>{for(var n in t)sD(e,n,{get:t[n],enumerable:!0})},fD=e=>((e,t,n,r)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let o of cD(t))!uD.call(e,o)&&o!==n&&sD(e,o,{get:()=>t[o],enumerable:!(r=lD(t,o))||r.enumerable});return e})(sD({},"__esModule",{value:!0}),e),mD=pD((()=>{MC=new Map,FC=[],IC=(e,t,n)=>{if(!t||"function"!=typeof t.init||"function"!=typeof t.createInferenceSessionHandler)throw new TypeError("not a valid backend");{let r=MC.get(e);if(void 0===r)MC.set(e,{backend:t,priority:n});else{if(r.priority>n)return;if(r.priority===n&&r.backend!==t)throw new Error('cannot register backend "'.concat(e,'" using priority ').concat(n))}if(n>=0){let t=FC.indexOf(e);-1!==t&&FC.splice(t,1);for(let r=0;r<FC.length;r++)if(MC.get(FC[r]).priority<=n)return void FC.splice(r,0,e);FC.push(e)}}},PC=async e=>{let t=MC.get(e);if(!t)return"backend not found.";if(t.initialized)return t.backend;if(t.aborted)return t.error;{let r=!!t.initPromise;try{return r||(t.initPromise=t.backend.init(e)),await t.initPromise,t.initialized=!0,t.backend}catch(n){return r||(t.error="".concat(n),t.aborted=!0),t.error}finally{delete t.initPromise}}},zC=async e=>{let t,n=e.executionProviders||[],r=n.map((e=>"string"==typeof e?e:e.name)),o=0===r.length?FC:r,a=[],i=new Set;for(let l of o){let e=await PC(l);"string"==typeof e?a.push({name:l,err:e}):(t||(t=e),t===e&&i.add(l))}if(!t)throw new Error("no available backend found. ERR: ".concat(a.map((e=>"[".concat(e.name,"] ").concat(e.err))).join(", ")));for(let{name:l,err:c}of a)r.includes(l)&&console.warn('removing requested execution provider "'.concat(l,'" from session options because it is not available: ').concat(c));let s=n.filter((e=>i.has("string"==typeof e?e:e.name)));return[t,new Proxy(e,{get:(e,t)=>"executionProviders"===t?s:Reflect.get(e,t)})]}})),gD=pD((()=>{mD()})),_D=pD((()=>{OC="1.22.0-dev.20250409-89f8206ba4"})),vD=pD((()=>{_D(),NC="warning",BC={wasm:{},webgl:{},webgpu:{},versions:{common:OC},set logLevel(e){if(void 0!==e){if("string"!=typeof e||-1===["verbose","info","warning","error","fatal"].indexOf(e))throw new Error("Unsupported logging level: ".concat(e));NC=e}},get logLevel(){return NC}},Object.defineProperty(BC,"logLevel",{enumerable:!0})})),yD=pD((()=>{vD(),jC=BC})),wD=pD((()=>{LC=(e,t)=>{let n=typeof document<"u"?document.createElement("canvas"):new OffscreenCanvas(1,1);n.width=e.dims[3],n.height=e.dims[2];let r=n.getContext("2d");if(null!=r){let o,a;void 0!==(null===t||void 0===t?void 0:t.tensorLayout)&&"NHWC"===t.tensorLayout?(o=e.dims[2],a=e.dims[3]):(o=e.dims[3],a=e.dims[2]);let i,s,l=void 0!==(null===t||void 0===t?void 0:t.format)?t.format:"RGB",c=null===t||void 0===t?void 0:t.norm;void 0===c||void 0===c.mean?i=[255,255,255,255]:"number"==typeof c.mean?i=[c.mean,c.mean,c.mean,c.mean]:(i=[c.mean[0],c.mean[1],c.mean[2],0],void 0!==c.mean[3]&&(i[3]=c.mean[3])),void 0===c||void 0===c.bias?s=[0,0,0,0]:"number"==typeof c.bias?s=[c.bias,c.bias,c.bias,c.bias]:(s=[c.bias[0],c.bias[1],c.bias[2],0],void 0!==c.bias[3]&&(s[3]=c.bias[3]));let u=a*o,d=0,p=u,h=2*u,f=-1;"RGBA"===l?(d=0,p=u,h=2*u,f=3*u):"RGB"===l?(d=0,p=u,h=2*u):"RBG"===l&&(d=0,h=u,p=2*u);for(let t=0;t<a;t++)for(let n=0;n<o;n++){let o=(e.data[d++]-s[0])*i[0],a=(e.data[p++]-s[1])*i[1],l=(e.data[h++]-s[2])*i[2],c=-1===f?255:(e.data[f++]-s[3])*i[3];r.fillStyle="rgba("+o+","+a+","+l+","+c+")",r.fillRect(n,t,1,1)}if("toDataURL"in n)return n.toDataURL();throw new Error("toDataURL is not supported")}throw new Error("Can not access image data")},RC=(e,t)=>{let n,r=typeof document<"u"?document.createElement("canvas").getContext("2d"):new OffscreenCanvas(1,1).getContext("2d");if(null==r)throw new Error("Can not access image data");{let o,a,i;void 0!==(null===t||void 0===t?void 0:t.tensorLayout)&&"NHWC"===t.tensorLayout?(o=e.dims[2],a=e.dims[1],i=e.dims[3]):(o=e.dims[3],a=e.dims[2],i=e.dims[1]);let s,l,c=void 0!==t&&void 0!==t.format?t.format:"RGB",u=null===t||void 0===t?void 0:t.norm;void 0===u||void 0===u.mean?s=[255,255,255,255]:"number"==typeof u.mean?s=[u.mean,u.mean,u.mean,u.mean]:(s=[u.mean[0],u.mean[1],u.mean[2],255],void 0!==u.mean[3]&&(s[3]=u.mean[3])),void 0===u||void 0===u.bias?l=[0,0,0,0]:"number"==typeof u.bias?l=[u.bias,u.bias,u.bias,u.bias]:(l=[u.bias[0],u.bias[1],u.bias[2],0],void 0!==u.bias[3]&&(l[3]=u.bias[3]));let d=a*o;if(void 0!==t&&(void 0!==t.format&&4===i&&"RGBA"!==t.format||3===i&&"RGB"!==t.format&&"BGR"!==t.format))throw new Error("Tensor format doesn't match input tensor dims");let p=4,h=0,f=1,m=2,g=3,_=0,v=d,y=2*d,w=-1;"RGBA"===c?(_=0,v=d,y=2*d,w=3*d):"RGB"===c?(_=0,v=d,y=2*d):"RBG"===c&&(_=0,y=d,v=2*d),n=r.createImageData(o,a);for(let t=0;t<a*o;h+=p,f+=p,m+=p,g+=p,t++)n.data[h]=(e.data[_++]-l[0])*s[0],n.data[f]=(e.data[v++]-l[1])*s[1],n.data[m]=(e.data[y++]-l[2])*s[2],n.data[g]=-1===w?255:(e.data[w++]-l[3])*s[3]}return n}})),bD=pD((()=>{CD(),VC=(e,t)=>{var n,r,o;if(void 0===e)throw new Error("Image buffer must be defined");if(void 0===t.height||void 0===t.width)throw new Error("Image height and width must be defined");if("NHWC"===t.tensorLayout)throw new Error("NHWC Tensor layout is not supported yet");let a,i,{height:s,width:l}=t,c=null!==(n=t.norm)&&void 0!==n?n:{mean:255,bias:0};a="number"==typeof c.mean?[c.mean,c.mean,c.mean,c.mean]:[c.mean[0],c.mean[1],c.mean[2],null!==(r=c.mean[3])&&void 0!==r?r:255],i="number"==typeof c.bias?[c.bias,c.bias,c.bias,c.bias]:[c.bias[0],c.bias[1],c.bias[2],null!==(o=c.bias[3])&&void 0!==o?o:0];let u=void 0!==t.format?t.format:"RGBA",d=void 0!==t.tensorFormat&&void 0!==t.tensorFormat?t.tensorFormat:"RGB",p=s*l,h="RGBA"===d?new Float32Array(4*p):new Float32Array(3*p),f=4,m=0,g=1,_=2,v=3,y=0,w=p,b=2*p,x=-1;"RGB"===u&&(f=3,m=0,g=1,_=2,v=-1),"RGBA"===d?x=3*p:"RBG"===d?(y=0,b=p,w=2*p):"BGR"===d&&(b=0,w=p,y=2*p);for(let k=0;k<p;k++,m+=f,_+=f,g+=f,v+=f)h[y++]=(e[m]+i[0])/a[0],h[w++]=(e[g]+i[1])/a[1],h[b++]=(e[_]+i[2])/a[2],-1!==x&&-1!==v&&(h[x++]=(e[v]+i[3])/a[3]);return new YC("float32",h,"RGBA"===d?[1,4,s,l]:[1,3,s,l])},qC=async(e,t)=>{let n,r=typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement,o=typeof ImageData<"u"&&e instanceof ImageData,a=typeof ImageBitmap<"u"&&e instanceof ImageBitmap,i="string"==typeof e,s=null!==t&&void 0!==t?t:{},l=()=>{if(typeof document<"u")return document.createElement("canvas");if(typeof OffscreenCanvas<"u")return new OffscreenCanvas(1,1);throw new Error("Canvas is not supported")},c=e=>typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||e instanceof OffscreenCanvas?e.getContext("2d"):null;if(r){let r=l();r.width=e.width,r.height=e.height;let o=c(r);if(null==o)throw new Error("Can not access image data");{let r=e.height,a=e.width;if(void 0!==t&&void 0!==t.resizedHeight&&void 0!==t.resizedWidth&&(r=t.resizedHeight,a=t.resizedWidth),void 0!==t){if(s=t,void 0!==t.tensorFormat)throw new Error("Image input config format must be RGBA for HTMLImageElement");s.tensorFormat="RGBA",s.height=r,s.width=a}else s.tensorFormat="RGBA",s.height=r,s.width=a;o.drawImage(e,0,0),n=o.getImageData(0,0,a,r).data}}else{if(!o){if(a){if(void 0===t)throw new Error("Please provide image config with format for Imagebitmap");let r=l();r.width=e.width,r.height=e.height;let o=c(r);if(null!=o){let t=e.height,r=e.width;return o.drawImage(e,0,0,r,t),n=o.getImageData(0,0,r,t).data,s.height=t,s.width=r,VC(n,s)}throw new Error("Can not access image data")}if(i)return new Promise(((t,n)=>{let r=l(),o=c(r);if(!e||!o)return n();let a=new Image;a.crossOrigin="Anonymous",a.src=e,a.onload=()=>{r.width=a.width,r.height=a.height,o.drawImage(a,0,0,r.width,r.height);let e=o.getImageData(0,0,r.width,r.height);s.height=r.height,s.width=r.width,t(VC(e.data,s))}}));throw new Error("Input data provided is not supported - aborted tensor creation")}{let r,o;if(void 0!==t&&void 0!==t.resizedWidth&&void 0!==t.resizedHeight?(r=t.resizedHeight,o=t.resizedWidth):(r=e.height,o=e.width),void 0!==t&&(s=t),s.format="RGBA",s.height=r,s.width=o,void 0!==t){let t=l();t.width=o,t.height=r;let a=c(t);if(null==a)throw new Error("Can not access image data");a.putImageData(e,0,0),n=a.getImageData(0,0,o,r).data}else n=e.data}}if(void 0!==n)return VC(n,s);throw new Error("Input data provided is not supported - aborted tensor creation")},UC=(e,t)=>{let{width:n,height:r,download:o,dispose:a}=t;return new YC({location:"texture",type:"float32",texture:e,dims:[1,r,n,4],download:o,dispose:a})},WC=(e,t)=>{let{dataType:n,dims:r,download:o,dispose:a}=t;return new YC({location:"gpu-buffer",type:null!==n&&void 0!==n?n:"float32",gpuBuffer:e,dims:r,download:o,dispose:a})},GC=(e,t)=>{let{dataType:n,dims:r,download:o,dispose:a}=t;return new YC({location:"ml-tensor",type:null!==n&&void 0!==n?n:"float32",mlTensor:e,dims:r,download:o,dispose:a})},HC=(e,t,n)=>new YC({location:"cpu-pinned",type:e,data:t,dims:null!==n&&void 0!==n?n:[t.length]})})),xD=pD((()=>{KC=new Map([["float32",Float32Array],["uint8",Uint8Array],["int8",Int8Array],["uint16",Uint16Array],["int16",Int16Array],["int32",Int32Array],["bool",Uint8Array],["float64",Float64Array],["uint32",Uint32Array],["int4",Uint8Array],["uint4",Uint8Array]]),ZC=new Map([[Float32Array,"float32"],[Uint8Array,"uint8"],[Int8Array,"int8"],[Uint16Array,"uint16"],[Int16Array,"int16"],[Int32Array,"int32"],[Float64Array,"float64"],[Uint32Array,"uint32"]]),$C=!1,XC=()=>{if(!$C){$C=!0;let e=typeof BigInt64Array<"u"&&BigInt64Array.from,t=typeof BigUint64Array<"u"&&BigUint64Array.from,n=globalThis.Float16Array,r=typeof n<"u"&&n.from;e&&(KC.set("int64",BigInt64Array),ZC.set(BigInt64Array,"int64")),t&&(KC.set("uint64",BigUint64Array),ZC.set(BigUint64Array,"uint64")),r?(KC.set("float16",n),ZC.set(n,"float16")):KC.set("float16",Uint16Array)}}})),kD=pD((()=>{CD(),JC=e=>{let t=1;for(let n=0;n<e.length;n++){let r=e[n];if("number"!=typeof r||!Number.isSafeInteger(r))throw new TypeError("dims[".concat(n,"] must be an integer, got: ").concat(r));if(r<0)throw new RangeError("dims[".concat(n,"] must be a non-negative integer, got: ").concat(r));t*=r}return t},QC=(e,t)=>{switch(e.location){case"cpu":return new YC(e.type,e.data,t);case"cpu-pinned":return new YC({location:"cpu-pinned",data:e.data,type:e.type,dims:t});case"texture":return new YC({location:"texture",texture:e.texture,type:e.type,dims:t});case"gpu-buffer":return new YC({location:"gpu-buffer",gpuBuffer:e.gpuBuffer,type:e.type,dims:t});case"ml-tensor":return new YC({location:"ml-tensor",mlTensor:e.mlTensor,type:e.type,dims:t});default:throw new Error("tensorReshape: tensor location ".concat(e.location," is not supported"))}}})),CD=pD((()=>{wD(),bD(),xD(),kD(),YC=class{constructor(e,t,n){let r,o;if(XC(),"object"==typeof e&&"location"in e)switch(this.dataLocation=e.location,r=e.type,o=e.dims,e.location){case"cpu-pinned":{let t=KC.get(r);if(!t)throw new TypeError('unsupported type "'.concat(r,'" to create tensor from pinned buffer'));if(!(e.data instanceof t))throw new TypeError("buffer should be of type ".concat(t.name));this.cpuData=e.data;break}case"texture":if("float32"!==r)throw new TypeError('unsupported type "'.concat(r,'" to create tensor from texture'));this.gpuTextureData=e.texture,this.downloader=e.download,this.disposer=e.dispose;break;case"gpu-buffer":if("float32"!==r&&"float16"!==r&&"int32"!==r&&"int64"!==r&&"uint32"!==r&&"uint8"!==r&&"bool"!==r&&"uint4"!==r&&"int4"!==r)throw new TypeError('unsupported type "'.concat(r,'" to create tensor from gpu buffer'));this.gpuBufferData=e.gpuBuffer,this.downloader=e.download,this.disposer=e.dispose;break;case"ml-tensor":if("float32"!==r&&"float16"!==r&&"int32"!==r&&"int64"!==r&&"uint32"!==r&&"uint64"!==r&&"int8"!==r&&"uint8"!==r&&"bool"!==r&&"uint4"!==r&&"int4"!==r)throw new TypeError('unsupported type "'.concat(r,'" to create tensor from MLTensor'));this.mlTensorData=e.mlTensor,this.downloader=e.download,this.disposer=e.dispose;break;default:throw new Error("Tensor constructor: unsupported location '".concat(this.dataLocation,"'"))}else{let a,i;if("string"==typeof e)if(r=e,i=n,"string"===e){if(!Array.isArray(t))throw new TypeError("A string tensor's data must be a string array.");a=t}else{let n=KC.get(e);if(void 0===n)throw new TypeError("Unsupported tensor type: ".concat(e,"."));if(Array.isArray(t)){if("float16"===e&&n===Uint16Array||"uint4"===e||"int4"===e)throw new TypeError("Creating a ".concat(e," tensor from number array is not supported. Please use ").concat(n.name," as data."));a="uint64"===e||"int64"===e?n.from(t,BigInt):n.from(t)}else if(t instanceof n)a=t;else if(t instanceof Uint8ClampedArray){if("uint8"!==e)throw new TypeError("A Uint8ClampedArray tensor's data must be type of uint8");a=Uint8Array.from(t)}else{if(!("float16"===e&&t instanceof Uint16Array&&n!==Uint16Array))throw new TypeError("A ".concat(r," tensor's data must be type of ").concat(n));a=new globalThis.Float16Array(t.buffer,t.byteOffset,t.length)}}else if(i=t,Array.isArray(e)){if(0===e.length)throw new TypeError("Tensor type cannot be inferred from an empty array.");let t=typeof e[0];if("string"===t)r="string",a=e;else{if("boolean"!==t)throw new TypeError("Invalid element type of data array: ".concat(t,"."));r="bool",a=Uint8Array.from(e)}}else if(e instanceof Uint8ClampedArray)r="uint8",a=Uint8Array.from(e);else{let t=ZC.get(e.constructor);if(void 0===t)throw new TypeError("Unsupported type for tensor data: ".concat(e.constructor,"."));r=t,a=e}if(void 0===i)i=[a.length];else if(!Array.isArray(i))throw new TypeError("A tensor's dims must be a number array");o=i,this.cpuData=a,this.dataLocation="cpu"}let a=JC(o);if(this.cpuData&&a!==this.cpuData.length&&("uint4"!==r&&"int4"!==r||Math.ceil(a/2)!==this.cpuData.length))throw new Error("Tensor's size(".concat(a,") does not match data length(").concat(this.cpuData.length,")."));this.type=r,this.dims=o,this.size=a}static async fromImage(e,t){return qC(e,t)}static fromTexture(e,t){return UC(e,t)}static fromGpuBuffer(e,t){return WC(e,t)}static fromMLTensor(e,t){return GC(e,t)}static fromPinnedBuffer(e,t,n){return HC(e,t,n)}toDataURL(e){return LC(this,e)}toImageData(e){return RC(this,e)}get data(){if(this.ensureValid(),!this.cpuData)throw new Error("The data is not on CPU. Use `getData()` to download GPU data to CPU, or use `texture` or `gpuBuffer` property to access the GPU data directly.");return this.cpuData}get location(){return this.dataLocation}get texture(){if(this.ensureValid(),!this.gpuTextureData)throw new Error("The data is not stored as a WebGL texture.");return this.gpuTextureData}get gpuBuffer(){if(this.ensureValid(),!this.gpuBufferData)throw new Error("The data is not stored as a WebGPU buffer.");return this.gpuBufferData}get mlTensor(){if(this.ensureValid(),!this.mlTensorData)throw new Error("The data is not stored as a WebNN MLTensor.");return this.mlTensorData}async getData(e){switch(this.ensureValid(),this.dataLocation){case"cpu":case"cpu-pinned":return this.data;case"texture":case"gpu-buffer":case"ml-tensor":if(!this.downloader)throw new Error("The current tensor is not created with a specified data downloader.");if(this.isDownloading)throw new Error("The current tensor is being downloaded.");try{this.isDownloading=!0;let t=await this.downloader();return this.downloader=void 0,this.dataLocation="cpu",this.cpuData=t,e&&this.disposer&&(this.disposer(),this.disposer=void 0),t}finally{this.isDownloading=!1}default:throw new Error("cannot get data from location: ".concat(this.dataLocation))}}dispose(){if(this.isDownloading)throw new Error("The current tensor is being downloaded.");this.disposer&&(this.disposer(),this.disposer=void 0),this.cpuData=void 0,this.gpuTextureData=void 0,this.gpuBufferData=void 0,this.mlTensorData=void 0,this.downloader=void 0,this.isDownloading=void 0,this.dataLocation="none"}ensureValid(){if("none"===this.dataLocation)throw new Error("The tensor is disposed.")}reshape(e){if(this.ensureValid(),this.downloader||this.disposer)throw new Error("Cannot reshape a tensor that owns GPU resource.");return QC(this,e)}}})),DD=pD((()=>{CD(),eD=YC})),SD=pD((()=>{vD(),tD=(e,t)=>{(typeof BC.trace>"u"?!BC.wasm.trace:!BC.trace)||console.timeStamp("".concat(e,"::ORT::").concat(t))},nD=(e,t)=>{var n;let r=(null===(n=(new Error).stack)||void 0===n?void 0:n.split(/\r\n|\r|\n/g))||[],o=!1;for(let a=0;a<r.length;a++){if(o&&!r[a].includes("TRACE_FUNC")){let n="FUNC_".concat(e,"::").concat(r[a].trim().split(" ")[1]);return t&&(n+="::".concat(t)),void tD("CPU",n)}r[a].includes("TRACE_FUNC")&&(o=!0)}},rD=e=>{(typeof BC.trace>"u"?!BC.wasm.trace:!BC.trace)||nD("BEGIN",e)},oD=e=>{(typeof BC.trace>"u"?!BC.wasm.trace:!BC.trace)||nD("END",e)}})),ED=pD((()=>{mD(),DD(),SD(),aD=class e{constructor(e){this.handler=e}async run(e,t,n){rD();let r={},o={};if("object"!=typeof e||null===e||e instanceof eD||Array.isArray(e))throw new TypeError("'feeds' must be an object that use input names as keys and OnnxValue as corresponding values.");let a=!0;if("object"==typeof t){if(null===t)throw new TypeError("Unexpected argument[1]: cannot be null.");if(t instanceof eD)throw new TypeError("'fetches' cannot be a Tensor");if(Array.isArray(t)){if(0===t.length)throw new TypeError("'fetches' cannot be an empty array.");a=!1;for(let e of t){if("string"!=typeof e)throw new TypeError("'fetches' must be a string array or an object.");if(-1===this.outputNames.indexOf(e))throw new RangeError("'fetches' contains invalid output name: ".concat(e,"."));r[e]=null}if("object"==typeof n&&null!==n)o=n;else if(typeof n<"u")throw new TypeError("'options' must be an object.")}else{let e=!1,i=Object.getOwnPropertyNames(t);for(let n of this.outputNames)if(-1!==i.indexOf(n)){let o=t[n];(null===o||o instanceof eD)&&(e=!0,a=!1,r[n]=o)}if(e){if("object"==typeof n&&null!==n)o=n;else if(typeof n<"u")throw new TypeError("'options' must be an object.")}else o=t}}else if(typeof t<"u")throw new TypeError("Unexpected argument[1]: must be 'fetches' or 'options'.");for(let l of this.inputNames)if(typeof e[l]>"u")throw new Error("input '".concat(l,"' is missing in 'feeds'."));if(a)for(let l of this.outputNames)r[l]=null;let i=await this.handler.run(e,r,o),s={};for(let l in i)if(Object.hasOwnProperty.call(i,l)){let e=i[l];s[l]=e instanceof eD?e:new eD(e.type,e.data,e.dims)}return oD(),s}async release(){return this.handler.dispose()}static async create(t,n,r,o){rD();let a,i={};if("string"==typeof t){if(a=t,"object"==typeof n&&null!==n)i=n;else if(typeof n<"u")throw new TypeError("'options' must be an object.")}else if(t instanceof Uint8Array){if(a=t,"object"==typeof n&&null!==n)i=n;else if(typeof n<"u")throw new TypeError("'options' must be an object.")}else{if(!(t instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&t instanceof SharedArrayBuffer))throw new TypeError("Unexpected argument[0]: must be 'path' or 'buffer'.");{let e=t,s=0,l=t.byteLength;if("object"==typeof n&&null!==n)i=n;else if("number"==typeof n){if(s=n,!Number.isSafeInteger(s))throw new RangeError("'byteOffset' must be an integer.");if(s<0||s>=e.byteLength)throw new RangeError("'byteOffset' is out of range [0, ".concat(e.byteLength,")."));if(l=t.byteLength-s,"number"==typeof r){if(l=r,!Number.isSafeInteger(l))throw new RangeError("'byteLength' must be an integer.");if(l<=0||s+l>e.byteLength)throw new RangeError("'byteLength' is out of range (0, ".concat(e.byteLength-s,"]."));if("object"==typeof o&&null!==o)i=o;else if(typeof o<"u")throw new TypeError("'options' must be an object.")}else if(typeof r<"u")throw new TypeError("'byteLength' must be a number.")}else if(typeof n<"u")throw new TypeError("'options' must be an object.");a=new Uint8Array(e,s,l)}}let[s,l]=await zC(i),c=await s.createInferenceSessionHandler(a,l);return oD(),new e(c)}startProfiling(){this.handler.startProfiling()}endProfiling(){this.handler.endProfiling()}get inputNames(){return this.handler.inputNames}get outputNames(){return this.handler.outputNames}get inputMetadata(){return this.handler.inputMetadata}get outputMetadata(){return this.handler.outputMetadata}}})),TD=pD((()=>{ED(),iD=aD})),AD=pD((()=>{})),MD=pD((()=>{})),FD=pD((()=>{})),ID=pD((()=>{})),PD={};hD(PD,{InferenceSession:()=>iD,TRACE:()=>tD,TRACE_FUNC_BEGIN:()=>rD,TRACE_FUNC_END:()=>oD,Tensor:()=>eD,env:()=>jC,registerBackend:()=>IC});var zD=pD((()=>{gD(),yD(),TD(),DD(),AD(),MD(),SD(),FD(),ID()})),OD=pD((()=>{})),ND={};hD(ND,{default:()=>LD});var BD,jD,LD,RD=pD((()=>{var e;zN(),Tz(),Ez(),BD="ort-wasm-proxy-worker",(jD=(null===(e=globalThis.self)||void 0===e?void 0:e.name)===BD)&&(self.onmessage=e=>{let{type:t,in:n}=e.data;try{switch(t){case"init-wasm":pS(n.wasm).then((()=>{eN(n).then((()=>{postMessage({type:t})}),(e=>{postMessage({type:t,err:e})}))}),(e=>{postMessage({type:t,err:e})}));break;case"init-ep":{let{epName:e,env:r}=n;tN(r,e).then((()=>{postMessage({type:t})}),(e=>{postMessage({type:t,err:e})}));break}case"copy-from":{let{buffer:e}=n,r=aN(e);postMessage({type:t,out:r});break}case"create":{let{model:e,options:r}=n;iN(e,r).then((e=>{postMessage({type:t,out:e})}),(e=>{postMessage({type:t,err:e})}));break}case"release":sN(n),postMessage({type:t});break;case"run":{let{sessionId:e,inputIndices:r,inputs:o,outputIndices:a,options:i}=n;cN(e,r,o,a,new Array(a.length).fill(null),i).then((e=>{e.some((e=>"cpu"!==e[3]))?postMessage({type:t,err:"Proxy does not support non-cpu tensor location."}):postMessage({type:t,out:e},dN([...o,...e]))}),(e=>{postMessage({type:t,err:e})}));break}case"end-profiling":uN(n),postMessage({type:t})}}catch(r){postMessage({type:t,err:r})}}),LD=jD?null:e=>new Worker(null!==e&&void 0!==e?e:ZD,{type:"module",name:BD})})),VD={};hD(VD,{default:()=>WD});var qD,UD,WD,GD,HD,KD,ZD,$D,XD,JD,QD,YD,eS,tS,nS,rS,oS,aS,iS,sS,lS,cS,uS,dS,pS,hS,fS,mS,gS,_S,vS,yS,wS,bS,xS,kS,CS,DS,SS,ES,TS,AS,MS,FS,IS,PS,zS,OS,NS,BS,jS,LS,RS,VS,qS,US,WS,GS,HS,KS,ZS,$S,XS,JS,QS,YS,eE,tE,nE,rE,oE,aE,iE,sE,lE,cE,uE,dE,pE,hE,fE,mE,gE,_E,vE,yE,wE,bE,xE,kE,CE,DE,SE,EE,TE,AE,ME,FE,IE,PE,zE,OE,NE,BE,jE,LE,RE,VE,qE,UE,WE,GE,HE,KE,ZE,$E,XE,JE,QE,YE,eT,tT,nT,rT,oT,aT,iT,sT,lT,cT,uT,dT,pT,hT,fT,mT,gT,_T,vT,yT,wT,bT,xT,kT,CT,DT,ST,ET,TT,AT,MT,FT,IT,PT,zT,OT,NT,BT,jT,LT,RT,VT,qT,UT,WT,GT,HT,KT,ZT,$T,XT,JT,QT,YT,eA,tA,nA,rA,oA,aA,iA,sA,lA,cA,uA,dA,pA,hA,fA,mA,gA,_A,vA,yA,wA,bA,xA,kA,CA,DA,SA,EA,TA,AA,MA,FA,IA,PA,zA,OA,NA,BA,jA,LA,RA,VA,qA,UA,WA,GA,HA,KA,ZA,$A,XA,JA,QA,YA,eM,tM,nM,rM,oM,aM,iM,sM,lM,cM,uM,dM,pM,hM,fM,mM,gM,_M,vM,yM,wM,bM,xM,kM,CM,DM,SM,EM,TM,AM,MM,FM,IM,PM,zM,OM,NM,BM,jM,LM,RM,VM,qM,UM,WM,GM,HM,KM,ZM,$M,XM,JM,QM,YM,eF,tF,nF,rF,oF,aF,iF,sF,lF,cF,uF,dF,pF,hF,fF,mF,gF,_F,vF,yF,wF,bF,xF,kF,CF,DF,SF,EF,TF,AF,MF,FF,IF,PF,zF,OF,NF,BF,jF,LF,RF,VF,qF,UF,WF,GF,HF,KF,ZF,$F,XF,JF,QF,YF,eI,tI,nI,rI,oI,aI,iI,sI,lI,cI,uI,dI,pI,hI,fI,mI,gI,_I,vI,yI,wI,bI,xI,kI,CI,DI,SI,EI,TI,AI,MI,FI,II,PI,zI,OI,NI,BI,jI,LI,RI,VI,qI,UI,WI,GI,HI,KI,ZI,$I,XI,JI,QI,YI,eP,tP,nP,rP,oP,aP,iP,sP,lP,cP,uP,dP,pP,hP,fP,mP,gP,_P,vP,yP,wP,bP,xP,kP,CP,DP,SP,EP,TP,AP,MP,FP,IP,PP,zP,OP,NP,BP,jP,LP,RP,VP,qP,UP,WP,GP,HP,KP,ZP,$P,XP,JP,QP,YP,ez,tz,nz,rz,oz,az,iz,sz,lz,cz,uz,dz,pz,hz,fz,mz,gz,_z,vz,yz,wz,bz,xz,kz,Cz,Dz,Sz=pD((()=>{var e;qD="file:///Users/emilyreif/Documents/github/llm-consistency-vis/node_modules/onnxruntime-web/dist/ort.bundle.min.mjs",UD=async function(){var e,t;var r,o,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=new Promise(((e,t)=>{r=e,o=t})),s="object"==typeof window,l=typeof WorkerGlobalScope<"u",c=l&&(null===(e=self.name)||void 0===e?void 0:e.startsWith("em-pthread"));a.mountExternalData=(e,t)=>{e.startsWith("./")&&(e=e.substring(2)),(a.Eb||(a.Eb=new Map)).set(e,t)},a.unmountExternalData=()=>{delete a.Eb};var u=null!==(t=globalThis.SharedArrayBuffer)&&void 0!==t?t:new WebAssembly.Memory({initial:0,maximum:0,pc:!0}).buffer.constructor;let d=e=>async function(){try{var t;if(a.Fb)throw Error("Session already started");let n=a.Fb={dc:arguments.length<=0?void 0:arguments[0],errors:[]},r=await e(...arguments);if(a.Fb!==n)throw Error("Session mismatch");null===(t=a.Jb)||void 0===t||t.flush();let o=n.errors;if(0<o.length){let e=await Promise.all(o);if(e=e.filter((e=>e)),0<e.length)throw Error(e.join("\n"))}return r}finally{a.Fb=null}};a.jsepInit=(e,t)=>{if("webgpu"===e){[a.Jb,a.Ub,a.Yb,a.Kb,a.Xb,a.jb,a.Zb,a.ac,a.Vb,a.Wb,a.$b]=t;let e=a.Jb;a.jsepRegisterBuffer=(t,n,r,o)=>e.registerBuffer(t,n,r,o),a.jsepGetBuffer=t=>e.getBuffer(t),a.jsepCreateDownloader=(t,n,r)=>e.createDownloader(t,n,r),a.jsepOnCreateSession=t=>{e.onCreateSession(t)},a.jsepOnReleaseSession=t=>{e.onReleaseSession(t)},a.jsepOnRunStart=t=>e.onRunStart(t),a.bc=(t,n)=>{e.upload(t,n)}}else if("webnn"===e){let e=t[0];[a.nc,a.Nb,a.webnnEnsureTensor,a.Ob,a.webnnDownloadTensor]=t.slice(1),a.webnnReleaseTensorId=a.Nb,a.webnnUploadTensor=a.Ob,a.webnnOnRunStart=t=>e.onRunStart(t),a.webnnOnRunEnd=e.onRunEnd.bind(e),a.webnnRegisterMLContext=(t,n)=>{e.registerMLContext(t,n)},a.webnnOnReleaseSession=t=>{e.onReleaseSession(t)},a.webnnCreateMLTensorDownloader=(t,n)=>e.createMLTensorDownloader(t,n),a.webnnRegisterMLTensor=(t,n,r,o)=>e.registerMLTensor(t,n,r,o),a.webnnCreateMLContext=t=>e.createMLContext(t),a.webnnRegisterMLConstant=(t,n,r,o,i,s)=>e.registerMLConstant(t,n,r,o,i,a.Eb,s),a.webnnRegisterGraphInput=e.registerGraphInput.bind(e),a.webnnIsGraphInput=e.isGraphInput.bind(e),a.webnnCreateTemporaryTensor=e.createTemporaryTensor.bind(e),a.webnnIsInt64Supported=e.isInt64Supported.bind(e)}};let p=()=>{let e=(e,t,n)=>function(){for(var r,o,a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];let l=qt,c=null===(r=t)||void 0===r?void 0:r();i=e(...i);let u=null===(o=t)||void 0===o?void 0:o();return c!==u&&(e=u,n(c),t=n=null),qt!=l?new Promise(((e,t)=>{Zt={resolve:e,reject:t}})):i};(()=>{for(let t of["_OrtAppendExecutionProvider","_OrtCreateSession","_OrtRun","_OrtRunWithBinding","_OrtBindInput"])a[t]=e(a[t],(()=>a[t]),(e=>a[t]=e))})(),void 0!==d&&(a._OrtRun=d(a._OrtRun),a._OrtRunWithBinding=d(a._OrtRunWithBinding)),p=void 0};a.asyncInit=()=>{var e;null===(e=p)||void 0===e||e()};var h,f,m=Object.assign({},a),g=(e,t)=>{throw t},_="";(s||l)&&(l?_=self.location.href:typeof document<"u"&&document.currentScript&&(_=document.currentScript.src),qD&&(_=qD),_=_.startsWith("blob:")?"":_.slice(0,_.replace(/[?#].*/,"").lastIndexOf("/")+1),l&&(f=e=>{var t=new XMLHttpRequest;return t.open("GET",e,!1),t.responseType="arraybuffer",t.send(null),new Uint8Array(t.response)}),h=async e=>{if(B(e))return new Promise(((t,n)=>{var r=new XMLHttpRequest;r.open("GET",e,!0),r.responseType="arraybuffer",r.onload=()=>{200==r.status||0==r.status&&r.response?t(r.response):n(r.status)},r.onerror=n,r.send(null)}));var t=await fetch(e,{credentials:"same-origin"});if(t.ok)return t.arrayBuffer();throw Error(t.status+" : "+t.url)});var v=console.log.bind(console),y=console.error.bind(console),w=v,b=y;Object.assign(a,m),m=null;var x,k,C,D,S,E,T,A,M,F,I,P,z,O=a.wasmBinary,N=!1,B=e=>e.startsWith("file://");function j(){return x.buffer!=D.buffer&&Z(),D}function L(){return x.buffer!=D.buffer&&Z(),S}function R(){return x.buffer!=D.buffer&&Z(),E}function V(){return x.buffer!=D.buffer&&Z(),T}function q(){return x.buffer!=D.buffer&&Z(),A}function U(){return x.buffer!=D.buffer&&Z(),M}function W(){return x.buffer!=D.buffer&&Z(),F}function G(){return x.buffer!=D.buffer&&Z(),z}if(c){let e=function(t){try{var n=t.data,r=n.Bb;if("load"===r){let t=[];self.onmessage=e=>t.push(e),self.startWorker=()=>{postMessage({Bb:"loaded"});for(let n of t)e(n);self.onmessage=e};for(let e of n.Rb)a[e]&&!a[e].proxy||(a[e]=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];postMessage({Bb:"callHandler",Qb:e,args:n})},"print"==e&&(w=a[e]),"printErr"==e&&(b=a[e]));x=n.kc,Z(),H(n.lc)}else if("run"===r){xe(n.Ab),gr(n.Ab,0,0,1,0,0),ye(),Tt(n.Ab),K||(pr(),K=!0);try{ke(n.fc,n.Hb)}catch(o){if("unwind"!=o)throw o}}else"setimmediate"!==n.target&&("checkMailbox"===r?K&&At():r&&(b("worker: received unknown command ".concat(r)),b(n)))}catch(o){throw _r(),o}};var H,K=!1;b=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];t=t.join(" "),console.error(t)},self.alert=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];postMessage({Bb:"alert",text:t.join(" "),ic:hr()})},self.onunhandledrejection=e=>{throw e.reason||e},self.onmessage=e}function Z(){var e=x.buffer;a.HEAP8=D=new Int8Array(e),a.HEAP16=E=new Int16Array(e),a.HEAPU8=S=new Uint8Array(e),a.HEAPU16=T=new Uint16Array(e),a.HEAP32=A=new Int32Array(e),a.HEAPU32=M=new Uint32Array(e),a.HEAPF32=F=new Float32Array(e),a.HEAPF64=z=new Float64Array(e),a.HEAP64=I=new BigInt64Array(e),a.HEAPU64=P=new BigUint64Array(e)}function $(){c?startWorker(a):cr.Ca()}c||(x=new WebAssembly.Memory({initial:256,maximum:65536,shared:!0}),Z());var X,J=0,Q=null;function Y(){if(0==--J&&Q){var e=Q;Q=null,e()}}function ee(e){throw b(e="Aborted("+e+")"),N=!0,e=new WebAssembly.RuntimeError(e+". Build with -sASSERTIONS for more info."),o(e),e}function te(){return{a:{L:oe,Aa:re,b:De,$:Ee,A:Fe,pa:Ie,X:Oe,Z:Ne,qa:Be,na:je,ga:Le,ma:Re,J:Ve,Y:qe,V:Ue,oa:We,W:Ge,va:Ze,E:tt,Q:rt,O:dt,D:ht,u:ft,r:mt,P:gt,z:Ct,R:Dt,ja:St,T:Mt,aa:It,M:Pt,F:zt,ia:Tt,sa:Ot,t:jt,Ba:Lt,w:Jt,o:Yt,l:nn,c:it,n:on,j:cn,v:un,p:dn,f:pn,s:hn,m:fn,e:mn,k:gn,i:_n,g:vn,d:yn,da:wn,ea:Cn,fa:Dn,ba:Sn,ca:En,N:Mn,xa:Fn,ua:zn,h:Bn,C:jn,G:Ln,ta:In,x:Rn,ra:Vn,U:qn,q:An,y:Un,K:Wn,S:Gn,za:$n,ya:Xn,ka:er,la:tr,_:he,B:nr,I:rr,ha:or,H:ir,a:x,wa:de}}}var ne={829644:(e,t,n,r,o)=>{if(void 0===a||!a.Eb)return 1;if((e=Me(Number(e>>>0))).startsWith("./")&&(e=e.substring(2)),!(e=a.Eb.get(e)))return 2;if(t=Number(t>>>0),n=Number(n>>>0),r=Number(r>>>0),t+n>e.byteLength)return 3;try{let i=e.subarray(t,t+n);switch(o){case 0:L().set(i,r>>>0);break;case 1:a.mc?a.mc(r,i):a.bc(r,i);break;default:return 4}return 0}catch(i){return 4}},830468:(e,t,n)=>{a.Ob(e,L().subarray(t>>>0,t+n>>>0))},830532:()=>a.nc(),830574:e=>{a.Nb(e)},830611:()=>{a.Vb()},830642:()=>{a.Wb()},830671:()=>{a.$b()},830696:e=>a.Ub(e),830729:e=>a.Yb(e),830761:(e,t,n)=>{a.Kb(Number(e),Number(t),Number(n),!0)},830824:(e,t,n)=>{a.Kb(Number(e),Number(t),Number(n))},830881:()=>typeof wasmOffsetConverter<"u",830938:e=>{a.jb("Abs",e,void 0)},830989:e=>{a.jb("Neg",e,void 0)},831040:e=>{a.jb("Floor",e,void 0)},831093:e=>{a.jb("Ceil",e,void 0)},831145:e=>{a.jb("Reciprocal",e,void 0)},831203:e=>{a.jb("Sqrt",e,void 0)},831255:e=>{a.jb("Exp",e,void 0)},831306:e=>{a.jb("Erf",e,void 0)},831357:e=>{a.jb("Sigmoid",e,void 0)},831412:(e,t,n)=>{a.jb("HardSigmoid",e,{alpha:t,beta:n})},831491:e=>{a.jb("Log",e,void 0)},831542:e=>{a.jb("Sin",e,void 0)},831593:e=>{a.jb("Cos",e,void 0)},831644:e=>{a.jb("Tan",e,void 0)},831695:e=>{a.jb("Asin",e,void 0)},831747:e=>{a.jb("Acos",e,void 0)},831799:e=>{a.jb("Atan",e,void 0)},831851:e=>{a.jb("Sinh",e,void 0)},831903:e=>{a.jb("Cosh",e,void 0)},831955:e=>{a.jb("Asinh",e,void 0)},832008:e=>{a.jb("Acosh",e,void 0)},832061:e=>{a.jb("Atanh",e,void 0)},832114:e=>{a.jb("Tanh",e,void 0)},832166:e=>{a.jb("Not",e,void 0)},832217:(e,t,n)=>{a.jb("Clip",e,{min:t,max:n})},832286:e=>{a.jb("Clip",e,void 0)},832338:(e,t)=>{a.jb("Elu",e,{alpha:t})},832396:e=>{a.jb("Gelu",e,void 0)},832448:e=>{a.jb("Relu",e,void 0)},832500:(e,t)=>{a.jb("LeakyRelu",e,{alpha:t})},832564:(e,t)=>{a.jb("ThresholdedRelu",e,{alpha:t})},832634:(e,t)=>{a.jb("Cast",e,{to:t})},832692:e=>{a.jb("Add",e,void 0)},832743:e=>{a.jb("Sub",e,void 0)},832794:e=>{a.jb("Mul",e,void 0)},832845:e=>{a.jb("Div",e,void 0)},832896:e=>{a.jb("Pow",e,void 0)},832947:e=>{a.jb("Equal",e,void 0)},833e3:e=>{a.jb("Greater",e,void 0)},833055:e=>{a.jb("GreaterOrEqual",e,void 0)},833117:e=>{a.jb("Less",e,void 0)},833169:e=>{a.jb("LessOrEqual",e,void 0)},833228:(e,t,n,r,o)=>{a.jb("ReduceMean",e,{keepDims:!!t,noopWithEmptyAxes:!!n,axes:r?Array.from(q().subarray(Number(r)>>>0,Number(o)>>>0)):[]})},833403:(e,t,n,r,o)=>{a.jb("ReduceMax",e,{keepDims:!!t,noopWithEmptyAxes:!!n,axes:r?Array.from(q().subarray(Number(r)>>>0,Number(o)>>>0)):[]})},833577:(e,t,n,r,o)=>{a.jb("ReduceMin",e,{keepDims:!!t,noopWithEmptyAxes:!!n,axes:r?Array.from(q().subarray(Number(r)>>>0,Number(o)>>>0)):[]})},833751:(e,t,n,r,o)=>{a.jb("ReduceProd",e,{keepDims:!!t,noopWithEmptyAxes:!!n,axes:r?Array.from(q().subarray(Number(r)>>>0,Number(o)>>>0)):[]})},833926:(e,t,n,r,o)=>{a.jb("ReduceSum",e,{keepDims:!!t,noopWithEmptyAxes:!!n,axes:r?Array.from(q().subarray(Number(r)>>>0,Number(o)>>>0)):[]})},834100:(e,t,n,r,o)=>{a.jb("ReduceL1",e,{keepDims:!!t,noopWithEmptyAxes:!!n,axes:r?Array.from(q().subarray(Number(r)>>>0,Number(o)>>>0)):[]})},834273:(e,t,n,r,o)=>{a.jb("ReduceL2",e,{keepDims:!!t,noopWithEmptyAxes:!!n,axes:r?Array.from(q().subarray(Number(r)>>>0,Number(o)>>>0)):[]})},834446:(e,t,n,r,o)=>{a.jb("ReduceLogSum",e,{keepDims:!!t,noopWithEmptyAxes:!!n,axes:r?Array.from(q().subarray(Number(r)>>>0,Number(o)>>>0)):[]})},834623:(e,t,n,r,o)=>{a.jb("ReduceSumSquare",e,{keepDims:!!t,noopWithEmptyAxes:!!n,axes:r?Array.from(q().subarray(Number(r)>>>0,Number(o)>>>0)):[]})},834803:(e,t,n,r,o)=>{a.jb("ReduceLogSumExp",e,{keepDims:!!t,noopWithEmptyAxes:!!n,axes:r?Array.from(q().subarray(Number(r)>>>0,Number(o)>>>0)):[]})},834983:e=>{a.jb("Where",e,void 0)},835036:(e,t,n)=>{a.jb("Transpose",e,{perm:t?Array.from(q().subarray(Number(t)>>>0,Number(n)>>>0)):[]})},835160:(e,t,n,r)=>{a.jb("DepthToSpace",e,{blocksize:t,mode:Me(n),format:r?"NHWC":"NCHW"})},835293:(e,t,n,r)=>{a.jb("DepthToSpace",e,{blocksize:t,mode:Me(n),format:r?"NHWC":"NCHW"})},835426:(e,t,n,r,o,i,s,l,c,u,d,p,h,f,m)=>{a.jb("ConvTranspose",e,{format:c?"NHWC":"NCHW",autoPad:t,dilations:[n],group:r,kernelShape:[o],pads:[i,s],strides:[l],wIsConst:()=>!!j()[u>>>0],outputPadding:d?Array.from(q().subarray(Number(d)>>>0,Number(p)>>>0)):[],outputShape:h?Array.from(q().subarray(Number(h)>>>0,Number(f)>>>0)):[],activation:Me(m)})},835859:(e,t,n,r,o,i,s,l,c,u,d,p,h,f)=>{a.jb("ConvTranspose",e,{format:l?"NHWC":"NCHW",autoPad:t,dilations:Array.from(q().subarray(Number(n)>>>0,2+(Number(n)>>>0)>>>0)),group:r,kernelShape:Array.from(q().subarray(Number(o)>>>0,2+(Number(o)>>>0)>>>0)),pads:Array.from(q().subarray(Number(i)>>>0,4+(Number(i)>>>0)>>>0)),strides:Array.from(q().subarray(Number(s)>>>0,2+(Number(s)>>>0)>>>0)),wIsConst:()=>!!j()[c>>>0],outputPadding:u?Array.from(q().subarray(Number(u)>>>0,Number(d)>>>0)):[],outputShape:p?Array.from(q().subarray(Number(p)>>>0,Number(h)>>>0)):[],activation:Me(f)})},836520:(e,t,n,r,o,i,s,l,c,u,d,p,h,f,m)=>{a.jb("ConvTranspose",e,{format:c?"NHWC":"NCHW",autoPad:t,dilations:[n],group:r,kernelShape:[o],pads:[i,s],strides:[l],wIsConst:()=>!!j()[u>>>0],outputPadding:d?Array.from(q().subarray(Number(d)>>>0,Number(p)>>>0)):[],outputShape:h?Array.from(q().subarray(Number(h)>>>0,Number(f)>>>0)):[],activation:Me(m)})},836953:(e,t,n,r,o,i,s,l,c,u,d,p,h,f)=>{a.jb("ConvTranspose",e,{format:l?"NHWC":"NCHW",autoPad:t,dilations:Array.from(q().subarray(Number(n)>>>0,2+(Number(n)>>>0)>>>0)),group:r,kernelShape:Array.from(q().subarray(Number(o)>>>0,2+(Number(o)>>>0)>>>0)),pads:Array.from(q().subarray(Number(i)>>>0,4+(Number(i)>>>0)>>>0)),strides:Array.from(q().subarray(Number(s)>>>0,2+(Number(s)>>>0)>>>0)),wIsConst:()=>!!j()[c>>>0],outputPadding:u?Array.from(q().subarray(Number(u)>>>0,Number(d)>>>0)):[],outputShape:p?Array.from(q().subarray(Number(p)>>>0,Number(h)>>>0)):[],activation:Me(f)})},837614:(e,t)=>{a.jb("GlobalAveragePool",e,{format:t?"NHWC":"NCHW"})},837705:(e,t,n,r,o,i,s,l,c,u,d,p,h,f)=>{a.jb("AveragePool",e,{format:f?"NHWC":"NCHW",auto_pad:t,ceil_mode:n,count_include_pad:r,storage_order:o,dilations:i?Array.from(q().subarray(Number(i)>>>0,Number(s)>>>0)):[],kernel_shape:l?Array.from(q().subarray(Number(l)>>>0,Number(c)>>>0)):[],pads:u?Array.from(q().subarray(Number(u)>>>0,Number(d)>>>0)):[],strides:p?Array.from(q().subarray(Number(p)>>>0,Number(h)>>>0)):[]})},838184:(e,t)=>{a.jb("GlobalAveragePool",e,{format:t?"NHWC":"NCHW"})},838275:(e,t,n,r,o,i,s,l,c,u,d,p,h,f)=>{a.jb("AveragePool",e,{format:f?"NHWC":"NCHW",auto_pad:t,ceil_mode:n,count_include_pad:r,storage_order:o,dilations:i?Array.from(q().subarray(Number(i)>>>0,Number(s)>>>0)):[],kernel_shape:l?Array.from(q().subarray(Number(l)>>>0,Number(c)>>>0)):[],pads:u?Array.from(q().subarray(Number(u)>>>0,Number(d)>>>0)):[],strides:p?Array.from(q().subarray(Number(p)>>>0,Number(h)>>>0)):[]})},838754:(e,t)=>{a.jb("GlobalMaxPool",e,{format:t?"NHWC":"NCHW"})},838841:(e,t,n,r,o,i,s,l,c,u,d,p,h,f)=>{a.jb("MaxPool",e,{format:f?"NHWC":"NCHW",auto_pad:t,ceil_mode:n,count_include_pad:r,storage_order:o,dilations:i?Array.from(q().subarray(Number(i)>>>0,Number(s)>>>0)):[],kernel_shape:l?Array.from(q().subarray(Number(l)>>>0,Number(c)>>>0)):[],pads:u?Array.from(q().subarray(Number(u)>>>0,Number(d)>>>0)):[],strides:p?Array.from(q().subarray(Number(p)>>>0,Number(h)>>>0)):[]})},839316:(e,t)=>{a.jb("GlobalMaxPool",e,{format:t?"NHWC":"NCHW"})},839403:(e,t,n,r,o,i,s,l,c,u,d,p,h,f)=>{a.jb("MaxPool",e,{format:f?"NHWC":"NCHW",auto_pad:t,ceil_mode:n,count_include_pad:r,storage_order:o,dilations:i?Array.from(q().subarray(Number(i)>>>0,Number(s)>>>0)):[],kernel_shape:l?Array.from(q().subarray(Number(l)>>>0,Number(c)>>>0)):[],pads:u?Array.from(q().subarray(Number(u)>>>0,Number(d)>>>0)):[],strides:p?Array.from(q().subarray(Number(p)>>>0,Number(h)>>>0)):[]})},839878:(e,t,n,r,o)=>{a.jb("Gemm",e,{alpha:t,beta:n,transA:r,transB:o})},839982:e=>{a.jb("MatMul",e,void 0)},840036:(e,t,n,r)=>{a.jb("ArgMax",e,{keepDims:!!t,selectLastIndex:!!n,axis:r})},840144:(e,t,n,r)=>{a.jb("ArgMin",e,{keepDims:!!t,selectLastIndex:!!n,axis:r})},840252:(e,t)=>{a.jb("Softmax",e,{axis:t})},840315:(e,t)=>{a.jb("Concat",e,{axis:t})},840375:(e,t,n,r,o)=>{a.jb("Split",e,{axis:t,numOutputs:n,splitSizes:r?Array.from(q().subarray(Number(r)>>>0,Number(o)>>>0)):[]})},840531:e=>{a.jb("Expand",e,void 0)},840585:(e,t)=>{a.jb("Gather",e,{axis:Number(t)})},840656:(e,t)=>{a.jb("GatherElements",e,{axis:Number(t)})},840735:(e,t)=>{a.jb("GatherND",e,{batch_dims:Number(t)})},840814:(e,t,n,r,o,i,s,l,c,u,d)=>{a.jb("Resize",e,{antialias:t,axes:n?Array.from(q().subarray(Number(n)>>>0,Number(r)>>>0)):[],coordinateTransformMode:Me(o),cubicCoeffA:i,excludeOutside:s,extrapolationValue:l,keepAspectRatioPolicy:Me(c),mode:Me(u),nearestMode:Me(d)})},841176:(e,t,n,r,o,i,s)=>{a.jb("Slice",e,{starts:t?Array.from(q().subarray(Number(t)>>>0,Number(n)>>>0)):[],ends:r?Array.from(q().subarray(Number(r)>>>0,Number(o)>>>0)):[],axes:i?Array.from(q().subarray(Number(i)>>>0,Number(s)>>>0)):[]})},841440:e=>{a.jb("Tile",e,void 0)},841492:(e,t,n)=>{a.jb("InstanceNormalization",e,{epsilon:t,format:n?"NHWC":"NCHW"})},841606:(e,t,n)=>{a.jb("InstanceNormalization",e,{epsilon:t,format:n?"NHWC":"NCHW"})},841720:e=>{a.jb("Range",e,void 0)},841773:(e,t)=>{a.jb("Einsum",e,{equation:Me(t)})},841854:(e,t,n,r,o)=>{a.jb("Pad",e,{mode:t,value:n,pads:r?Array.from(q().subarray(Number(r)>>>0,Number(o)>>>0)):[]})},841997:(e,t,n,r,o,i)=>{a.jb("BatchNormalization",e,{epsilon:t,momentum:n,spatial:!!o,trainingMode:!!r,format:i?"NHWC":"NCHW"})},842166:(e,t,n,r,o,i)=>{a.jb("BatchNormalization",e,{epsilon:t,momentum:n,spatial:!!o,trainingMode:!!r,format:i?"NHWC":"NCHW"})},842335:(e,t,n)=>{a.jb("CumSum",e,{exclusive:Number(t),reverse:Number(n)})},842432:(e,t,n)=>{a.jb("DequantizeLinear",e,{axis:t,blockSize:n})},842522:(e,t,n,r,o)=>{a.jb("GridSample",e,{align_corners:t,mode:Me(n),padding_mode:Me(r),format:o?"NHWC":"NCHW"})},842692:(e,t,n,r,o)=>{a.jb("GridSample",e,{align_corners:t,mode:Me(n),padding_mode:Me(r),format:o?"NHWC":"NCHW"})},842862:(e,t)=>{a.jb("ScatterND",e,{reduction:Me(t)})},842947:(e,t,n,r,o,i,s,l,c)=>{a.jb("Attention",e,{numHeads:t,isUnidirectional:n,maskFilterValue:r,scale:o,doRotary:i,qkvHiddenSizes:s?Array.from(q().subarray(Number(l)>>>0,Number(l)+s>>>0)):[],pastPresentShareBuffer:!!c})},843219:e=>{a.jb("BiasAdd",e,void 0)},843274:e=>{a.jb("BiasSplitGelu",e,void 0)},843335:e=>{a.jb("FastGelu",e,void 0)},843391:(e,t,n,r,o,i,s,l,c,u,d,p,h,f,m,g)=>{a.jb("Conv",e,{format:p?"NHWC":"NCHW",auto_pad:t,dilations:n?Array.from(q().subarray(Number(n)>>>0,Number(r)>>>0)):[],group:o,kernel_shape:i?Array.from(q().subarray(Number(i)>>>0,Number(s)>>>0)):[],pads:l?Array.from(q().subarray(Number(l)>>>0,Number(c)>>>0)):[],strides:u?Array.from(q().subarray(Number(u)>>>0,Number(d)>>>0)):[],w_is_const:()=>!!j()[Number(h)>>>0],activation:Me(f),activation_params:m?Array.from(W().subarray(Number(m)>>>0,Number(g)>>>0)):[]})},843975:e=>{a.jb("Gelu",e,void 0)},844027:(e,t,n,r,o,i,s,l,c)=>{a.jb("GroupQueryAttention",e,{numHeads:t,kvNumHeads:n,scale:r,softcap:o,doRotary:i,rotaryInterleaved:s,smoothSoftmax:l,localWindowSize:c})},844244:(e,t,n,r)=>{a.jb("LayerNormalization",e,{axis:t,epsilon:n,simplified:!!r})},844355:(e,t,n,r)=>{a.jb("LayerNormalization",e,{axis:t,epsilon:n,simplified:!!r})},844466:(e,t,n,r,o,i)=>{a.jb("MatMulNBits",e,{k:t,n:n,accuracyLevel:r,bits:o,blockSize:i})},844593:(e,t,n,r,o,i)=>{a.jb("MultiHeadAttention",e,{numHeads:t,isUnidirectional:n,maskFilterValue:r,scale:o,doRotary:i})},844752:(e,t)=>{a.jb("QuickGelu",e,{alpha:t})},844816:(e,t,n,r,o)=>{a.jb("RotaryEmbedding",e,{interleaved:!!t,numHeads:n,rotaryEmbeddingDim:r,scale:o})},844955:(e,t,n)=>{a.jb("SkipLayerNormalization",e,{epsilon:t,simplified:!!n})},845057:(e,t,n)=>{a.jb("SkipLayerNormalization",e,{epsilon:t,simplified:!!n})},845159:(e,t,n,r)=>{a.jb("GatherBlockQuantized",e,{gatherAxis:t,quantizeAxis:n,blockSize:r})},845280:e=>{a.Zb(e)},845314:(e,t)=>a.ac(Number(e),Number(t),a.Fb.dc,a.Fb.errors)};function re(e,t,n){return Xt((async()=>{await a.Xb(Number(e),Number(t),Number(n))}))}function oe(){return typeof wasmOffsetConverter<"u"}class ae{constructor(e){ao(this,"name","ExitStatus"),this.message="Program terminated with exit(".concat(e,")"),this.status=e}}var ie=e=>{e.terminate(),e.onmessage=()=>{}},se=[],le=e=>{0==fe.length&&(be(),we(fe[0]));var t=fe.pop();if(!t)return 6;me.push(t),_e[e.Ab]=t,t.Ab=e.Ab;var n={Bb:"run",fc:e.ec,Hb:e.Hb,Ab:e.Ab};return t.postMessage(n,e.Mb),0},ce=0,ue=function(e,t){for(var n=2*(arguments.length<=2?0:arguments.length-2),r=Sr(),o=Dr(8*n),a=o>>>3,i=0;i<(arguments.length<=2?0:arguments.length-2);i++){var s=i+2<2||arguments.length<=i+2?void 0:arguments[i+2];"bigint"==typeof s?(I[a+2*i]=1n,I[a+2*i+1]=s):(I[a+2*i]=0n,G()[a+2*i+1>>>0]=s)}return e=vr(e,0,n,o,t),Cr(r),e};function de(e){if(c)return ue(0,1,e);if(C=e,!(0<ce)){for(var t of me)ie(t);for(t of fe)ie(t);fe=[],me=[],_e={},N=!0}g(0,new ae(e))}function pe(e){if(c)return ue(1,0,e);he(e)}var he=e=>{if(C=e,c)throw pe(e),"unwind";de(e)},fe=[],me=[],ge=[],_e={},ve=e=>{var t=e.Ab;delete _e[t],fe.push(e),me.splice(me.indexOf(e),1),e.Ab=0,yr(t)};function ye(){ge.forEach((e=>e()))}var we=e=>new Promise((t=>{e.onmessage=n=>{var r=(n=n.data).Bb;if(n.Gb&&n.Gb!=hr()){var o=_e[n.Gb];o?o.postMessage(n,n.Mb):b('Internal error! Worker sent a message "'.concat(r,'" to target pthread ').concat(n.Gb,", but that thread no longer exists!"))}else"checkMailbox"===r?At():"spawnThread"===r?le(n):"cleanupThread"===r?ve(_e[n.hc]):"loaded"===r?(e.loaded=!0,t(e)):"alert"===r?alert("Thread ".concat(n.ic,": ").concat(n.text)):"setimmediate"===n.target?e.postMessage(n):"callHandler"===r?a[n.Qb](...n.args):r&&b("worker sent an unknown command ".concat(r))},e.onerror=e=>{throw b("worker sent an error! ".concat(e.filename,":").concat(e.lineno,": ").concat(e.message)),e};var n,r=[];for(n of[])a.propertyIsEnumerable(n)&&r.push(n);e.postMessage({Bb:"load",Rb:r,kc:x,lc:k})}));function be(){var e=new Worker(new URL(n(618),n.b),{type:"module",workerData:"em-pthread",name:"em-pthread"});fe.push(e)}var xe=e=>{Z();var t=U()[e+52>>>2>>>0];e=U()[e+56>>>2>>>0],kr(t,t-e),Cr(t)},ke=(e,t)=>{ce=0,e=Er(e,t),0<ce?C=e:wr(e)};class Ce{constructor(e){this.Ib=e-24}}function De(e,t,n){var r=new Ce(e>>>=0);throw t>>>=0,n>>>=0,U()[r.Ib+16>>>2>>>0]=0,U()[r.Ib+4>>>2>>>0]=t,U()[r.Ib+8>>>2>>>0]=n,e}function Se(e,t,n,r){return c?ue(2,1,e,t,n,r):Ee(e,t,n,r)}function Ee(e,t,n,r){if(e>>>=0,n>>>=0,r>>>=0,void 0===u)return 6;var o=[];return c&&0===o.length?Se(e,t>>>=0,n,r):(e={ec:n,Ab:e,Hb:r,Mb:o},c?(e.Bb="spawnThread",postMessage(e,o),0):le(e))}var Te=typeof TextDecoder<"u"?new TextDecoder:void 0,Ae=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:NaN;var r=(t>>>=0)+n;for(n=t;e[n]&&!(n>=r);)++n;if(16<n-t&&e.buffer&&Te)return Te.decode(e.buffer instanceof ArrayBuffer?e.subarray(t,n):e.slice(t,n));for(r="";t<n;){var o=e[t++];if(128&o){var a=63&e[t++];if(192==(224&o))r+=String.fromCharCode((31&o)<<6|a);else{var i=63&e[t++];65536>(o=224==(240&o)?(15&o)<<12|a<<6|i:(7&o)<<18|a<<12|i<<6|63&e[t++])?r+=String.fromCharCode(o):(o-=65536,r+=String.fromCharCode(55296|o>>10,56320|1023&o))}}else r+=String.fromCharCode(o)}return r},Me=(e,t)=>(e>>>=0)?Ae(L(),e,t):"";function Fe(e,t,n){return c?ue(3,1,e,t,n):0}function Ie(e,t){if(c)return ue(4,1,e,t)}var Pe=e=>{for(var t=0,n=0;n<e.length;++n){var r=e.charCodeAt(n);127>=r?t++:2047>=r?t+=2:55296<=r&&57343>=r?(t+=4,++n):t+=3}return t},ze=(e,t,n)=>{var r=L();if(t>>>=0,0<n){var o=t;n=t+n-1;for(var a=0;a<e.length;++a){var i=e.charCodeAt(a);if(55296<=i&&57343>=i&&(i=65536+((1023&i)<<10)|1023&e.charCodeAt(++a)),127>=i){if(t>=n)break;r[t++>>>0]=i}else{if(2047>=i){if(t+1>=n)break;r[t++>>>0]=192|i>>6}else{if(65535>=i){if(t+2>=n)break;r[t++>>>0]=224|i>>12}else{if(t+3>=n)break;r[t++>>>0]=240|i>>18,r[t++>>>0]=128|i>>12&63}r[t++>>>0]=128|i>>6&63}r[t++>>>0]=128|63&i}}r[t>>>0]=0,e=t-o}else e=0;return e};function Oe(e,t){if(c)return ue(5,1,e,t)}function Ne(e,t,n){if(c)return ue(6,1,e,t,n)}function Be(e,t,n){return c?ue(7,1,e,t,n):0}function je(e,t){if(c)return ue(8,1,e,t)}function Le(e,t,n){if(c)return ue(9,1,e,t,n)}function Re(e,t,n,r){if(c)return ue(10,1,e,t,n,r)}function Ve(e,t,n,r){if(c)return ue(11,1,e,t,n,r)}function qe(e,t,n,r){if(c)return ue(12,1,e,t,n,r)}function Ue(e){if(c)return ue(13,1,e)}function We(e,t){if(c)return ue(14,1,e,t)}function Ge(e,t,n){if(c)return ue(15,1,e,t,n)}var He,Ke,Ze=()=>ee(""),$e=e=>{for(var t="";L()[e>>>0];)t+=He[L()[e++>>>0]];return t},Xe={},Je={},Qe={};function Ye(e,t){return function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};var r=t.name;if(!e)throw new Ke('type "'.concat(r,'" must have a positive integer typeid pointer'));if(Je.hasOwnProperty(e)){if(n.Sb)return;throw new Ke("Cannot register type '".concat(r,"' twice"))}Je[e]=t,delete Qe[e],Xe.hasOwnProperty(e)&&(t=Xe[e],delete Xe[e],t.forEach((e=>e())))}(e,t,arguments.length>2&&void 0!==arguments[2]?arguments[2]:{})}var et=(e,t,n)=>{switch(t){case 1:return n?e=>j()[e>>>0]:e=>L()[e>>>0];case 2:return n?e=>R()[e>>>1>>>0]:e=>V()[e>>>1>>>0];case 4:return n?e=>q()[e>>>2>>>0]:e=>U()[e>>>2>>>0];case 8:return n?e=>I[e>>>3]:e=>P[e>>>3];default:throw new TypeError("invalid integer width (".concat(t,"): ").concat(e))}};function tt(e,t,n){n>>>=0,Ye(e>>>=0,{name:t=$e(t>>>0),fromWireType:e=>e,toWireType:function(e,t){if("bigint"!=typeof t&&"number"!=typeof t)throw t=null===t?"null":"object"==(e=typeof t)||"array"===e||"function"===e?t.toString():""+t,new TypeError('Cannot convert "'.concat(t,'" to ').concat(this.name));return"number"==typeof t&&(t=BigInt(t)),t},Cb:nt,readValueFromPointer:et(t,n,-1==t.indexOf("u")),Db:null})}var nt=8;function rt(e,t,n,r){Ye(e>>>=0,{name:t=$e(t>>>0),fromWireType:function(e){return!!e},toWireType:function(e,t){return t?n:r},Cb:nt,readValueFromPointer:function(e){return this.fromWireType(L()[e>>>0])},Db:null})}var ot=[],at=[];function it(e){9<(e>>>=0)&&0==--at[e+1]&&(at[e]=void 0,ot.push(e))}var st=e=>{if(!e)throw new Ke("Cannot use deleted val. handle = "+e);return at[e]},lt=e=>{switch(e){case void 0:return 2;case null:return 4;case!0:return 6;case!1:return 8;default:let t=ot.pop()||at.length;return at[t]=e,at[t+1]=1,t}};function ct(e){return this.fromWireType(U()[e>>>2>>>0])}var ut={name:"emscripten::val",fromWireType:e=>{var t=st(e);return it(e),t},toWireType:(e,t)=>lt(t),Cb:nt,readValueFromPointer:ct,Db:null};function dt(e){return Ye(e>>>0,ut)}var pt=(e,t)=>{switch(t){case 4:return function(e){return this.fromWireType(W()[e>>>2>>>0])};case 8:return function(e){return this.fromWireType(G()[e>>>3>>>0])};default:throw new TypeError("invalid float width (".concat(t,"): ").concat(e))}};function ht(e,t,n){n>>>=0,Ye(e>>>=0,{name:t=$e(t>>>0),fromWireType:e=>e,toWireType:(e,t)=>t,Cb:nt,readValueFromPointer:pt(t,n),Db:null})}function ft(e,t,n,r,o){if(e>>>=0,n>>>=0,t=$e(t>>>0),-1===o&&(o=4294967295),o=e=>e,0===r){var a=32-8*n;o=e=>e<<a>>>a}var i=t.includes("unsigned")?function(e,t){return t>>>0}:function(e,t){return t};Ye(e,{name:t,fromWireType:o,toWireType:i,Cb:nt,readValueFromPointer:et(t,n,0!==r),Db:null})}function mt(e,t,n){function r(e){var t=U()[e>>>2>>>0];return e=U()[e+4>>>2>>>0],new o(j().buffer,e,t)}var o=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array,BigInt64Array,BigUint64Array][t];Ye(e>>>=0,{name:n=$e(n>>>0),fromWireType:r,Cb:nt,readValueFromPointer:r},{Sb:!0})}function gt(e,t){Ye(e>>>=0,{name:t=$e(t>>>0),fromWireType:function(e){for(var t,n=U()[e>>>2>>>0],r=e+4,o=r,a=0;a<=n;++a){var i=r+a;a!=n&&0!=L()[i>>>0]||(o=Me(o,i-o),void 0===t?t=o:(t+="\0",t+=o),o=i+1)}return fr(e),t},toWireType:function(e,t){t instanceof ArrayBuffer&&(t=new Uint8Array(t));var n="string"==typeof t;if(!(n||t instanceof Uint8Array||t instanceof Uint8ClampedArray||t instanceof Int8Array))throw new Ke("Cannot pass non-string to std::string");var r=n?Pe(t):t.length,o=mr(4+r+1),a=o+4;if(U()[o>>>2>>>0]=r,n)ze(t,a,r+1);else if(n)for(n=0;n<r;++n){var i=t.charCodeAt(n);if(255<i)throw fr(o),new Ke("String has UTF-16 code units that do not fit in 8 bits");L()[a+n>>>0]=i}else for(n=0;n<r;++n)L()[a+n>>>0]=t[n];return null!==e&&e.push(fr,o),o},Cb:nt,readValueFromPointer:ct,Db(e){fr(e)}})}var _t=typeof TextDecoder<"u"?new TextDecoder("utf-16le"):void 0,vt=(e,t)=>{for(var n=e>>1,r=n+t/2;!(n>=r)&&V()[n>>>0];)++n;if(32<(n<<=1)-e&&_t)return _t.decode(L().slice(e,n));for(n="",r=0;!(r>=t/2);++r){var o=R()[e+2*r>>>1>>>0];if(0==o)break;n+=String.fromCharCode(o)}return n},yt=(e,t,n)=>{if(null!==n&&void 0!==n||(n=2147483647),2>n)return 0;var r=t;n=(n-=2)<2*e.length?n/2:e.length;for(var o=0;o<n;++o){var a=e.charCodeAt(o);R()[t>>>1>>>0]=a,t+=2}return R()[t>>>1>>>0]=0,t-r},wt=e=>2*e.length,bt=(e,t)=>{for(var n=0,r="";!(n>=t/4);){var o=q()[e+4*n>>>2>>>0];if(0==o)break;++n,65536<=o?(o-=65536,r+=String.fromCharCode(55296|o>>10,56320|1023&o)):r+=String.fromCharCode(o)}return r},xt=(e,t,n)=>{if(null!==n&&void 0!==n||(n=2147483647),4>n)return 0;var r=t>>>=0;n=r+n-4;for(var o=0;o<e.length;++o){var a=e.charCodeAt(o);if(55296<=a&&57343>=a&&(a=65536+((1023&a)<<10)|1023&e.charCodeAt(++o)),q()[t>>>2>>>0]=a,(t+=4)+4>n)break}return q()[t>>>2>>>0]=0,t-r},kt=e=>{for(var t=0,n=0;n<e.length;++n){var r=e.charCodeAt(n);55296<=r&&57343>=r&&++n,t+=4}return t};function Ct(e,t,n){if(e>>>=0,t>>>=0,n=$e(n>>>=0),2===t)var r=vt,o=yt,a=wt,i=e=>V()[e>>>1>>>0];else 4===t&&(r=bt,o=xt,a=kt,i=e=>U()[e>>>2>>>0]);Ye(e,{name:n,fromWireType:e=>{for(var n,o=U()[e>>>2>>>0],a=e+4,s=0;s<=o;++s){var l=e+4+s*t;s!=o&&0!=i(l)||(a=r(a,l-a),void 0===n?n=a:(n+="\0",n+=a),a=l+t)}return fr(e),n},toWireType:(e,r)=>{if("string"!=typeof r)throw new Ke("Cannot pass non-string to C++ string type ".concat(n));var i=a(r),s=mr(4+i+t);return U()[s>>>2>>>0]=i/t,o(r,s+4,i+t),null!==e&&e.push(fr,s),s},Cb:nt,readValueFromPointer:ct,Db(e){fr(e)}})}function Dt(e,t){Ye(e>>>=0,{Tb:!0,name:t=$e(t>>>0),Cb:0,fromWireType:()=>{},toWireType:()=>{}})}function St(e){gr(e>>>0,!l,1,!s,131072,!1),ye()}var Et=e=>{if(!N)try{if(e(),!(0<ce))try{c?wr(C):he(C)}catch(t){t instanceof ae||"unwind"==t||g(0,t)}}catch(t){t instanceof ae||"unwind"==t||g(0,t)}};function Tt(e){e>>>=0,"function"==typeof Atomics.jc&&(Atomics.jc(q(),e>>>2,e).value.then(At),e+=128,Atomics.store(q(),e>>>2,1))}var At=()=>{var e=hr();e&&(Tt(e),Et(xr))};function Mt(e,t){(e>>>=0)==t>>>0?setTimeout(At):c?postMessage({Gb:e,Bb:"checkMailbox"}):(e=_e[e])&&e.postMessage({Bb:"checkMailbox"})}var Ft=[];function It(e,t,n,r,o){for(t>>>=0,r/=2,Ft.length=r,n=o>>>0>>>3,o=0;o<r;o++)Ft[o]=I[n+2*o]?I[n+2*o+1]:G()[n+2*o+1>>>0];return(t?ne[t]:ur[e])(...Ft)}var Pt=()=>{ce=0};function zt(e){e>>>=0,c?postMessage({Bb:"cleanupThread",hc:e}):ve(_e[e])}function Ot(e){}var Nt=(e,t)=>{var n=Je[e];if(void 0===n)throw e=dr(e),n=$e(e),fr(e),new Ke("".concat(t," has unknown type ").concat(n));return n},Bt=(e,t,n)=>{var r=[];return e=e.toWireType(r,n),r.length&&(U()[t>>>2>>>0]=lt(r)),e};function jt(e,t,n){return t>>>=0,n>>>=0,e=st(e>>>0),t=Nt(t,"emval::as"),Bt(t,n,e)}function Lt(e,t){return t>>>=0,e=st(e>>>0),(t=Nt(t,"emval::as")).toWireType(null,e)}var Rt=e=>{try{e()}catch(t){ee(t)}},Vt=0,qt=null,Ut=0,Wt=[],Gt={},Ht={},Kt=0,Zt=null,$t=[];function Xt(e){return function(){if(!N){if(0===Vt){var t=!1,n=!1;(t=>{e().then(t)})((function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(!N&&(Ut=e,t=!0,n)){Vt=2,Rt((()=>Mr(qt))),typeof MainLoop<"u"&&MainLoop.Pb&&MainLoop.resume(),e=!1;try{var r=function(){var e=q()[qt+8>>>2>>>0];return e=cr[Ht[e]],--ce,e()}()}catch(i){r=i,e=!0}var o=!1;if(!qt){var a=Zt;a&&(Zt=null,(e?a.reject:a.resolve)(r),o=!0)}if(e&&!o)throw r}})),n=!0,t||(Vt=1,qt=function(){var e=mr(65548),t=e+12;U()[e>>>2>>>0]=t,U()[e+4>>>2>>>0]=t+65536,t=Wt[0];var n=Gt[t];return void 0===n&&(n=Kt++,Gt[t]=n,Ht[n]=t),t=n,q()[e+8>>>2>>>0]=t,e}(),typeof MainLoop<"u"&&MainLoop.Pb&&MainLoop.pause(),Rt((()=>Tr(qt))))}else 2===Vt?(Vt=0,Rt(Fr),fr(qt),qt=null,$t.forEach(Et)):ee("invalid state: ".concat(Vt));return Ut}}()}function Jt(e){return e>>>=0,Xt((async()=>{var t=await st(e);return lt(t)}))}var Qt=[];function Yt(e,t,n,r){return n>>>=0,r>>>=0,(e=Qt[e>>>0])(null,t=st(t>>>0),n,r)}var en={},tn=e=>{var t=en[e];return void 0===t?$e(e):t};function nn(e,t,n,r,o){return n>>>=0,r>>>=0,o>>>=0,(e=Qt[e>>>0])(t=st(t>>>0),t[n=tn(n)],r,o)}var rn=()=>"object"==typeof globalThis?globalThis:Function("return this")();function on(e){return 0==(e>>>=0)?lt(rn()):(e=tn(e),lt(rn()[e]))}var an=e=>{var t=Qt.length;return Qt.push(e),t},sn=(e,t)=>{for(var n=Array(e),r=0;r<e;++r)n[r]=Nt(U()[t+4*r>>>2>>>0],"parameter "+r);return n},ln=(e,t)=>Object.defineProperty(t,"name",{value:e});function cn(e,t,n){var r=(t=sn(e,t>>>0)).shift();e--;var o="return function (obj, func, destructorsRef, args) {\n",a=0,i=[];0===n&&i.push("obj");for(var s=["retType"],l=[r],c=0;c<e;++c)i.push("arg"+c),s.push("argType"+c),l.push(t[c]),o+="  var arg".concat(c," = argType").concat(c,".readValueFromPointer(args").concat(a?"+"+a:"",");\n"),a+=t[c].Cb;return o+="  var rv = ".concat(1===n?"new func":"func.call","(").concat(i.join(", "),");\n"),r.Tb||(s.push("emval_returnValue"),l.push(Bt),o+="  return emval_returnValue(retType, destructorsRef, rv);\n"),s.push(o+"};\n"),e=function(e){var t=Function;if(!(t instanceof Function))throw new TypeError("new_ called with constructor type ".concat(typeof t," which is not a function"));var n=ln(t.name||"unknownFunctionName",(function(){}));return n.prototype=t.prototype,n=new n,(e=t.apply(n,e))instanceof Object?e:n}(s)(...l),n="methodCaller<(".concat(t.map((e=>e.name)).join(", "),") => ").concat(r.name,">"),an(ln(n,e))}function un(e){return e=tn(e>>>0),lt(a[e])}function dn(e,t){return t>>>=0,e=st(e>>>0),t=st(t),lt(e[t])}function pn(e){9<(e>>>=0)&&(at[e+1]+=1)}function hn(){return lt([])}function fn(e){e=st(e>>>0);for(var t=Array(e.length),n=0;n<e.length;n++)t[n]=e[n];return lt(t)}function mn(e){return lt(tn(e>>>0))}function gn(){return lt({})}function _n(e){for(var t=st(e>>>=0);t.length;){var n=t.pop();t.pop()(n)}it(e)}function vn(e,t,n){t>>>=0,n>>>=0,e=st(e>>>0),t=st(t),n=st(n),e[t]=n}function yn(e,t){return t>>>=0,e=(e=Nt(e>>>0,"_emval_take_value")).readValueFromPointer(t),lt(e)}function wn(e,t){e=-9007199254740992>e||9007199254740992<e?NaN:Number(e),t>>>=0,e=new Date(1e3*e),q()[t>>>2>>>0]=e.getUTCSeconds(),q()[t+4>>>2>>>0]=e.getUTCMinutes(),q()[t+8>>>2>>>0]=e.getUTCHours(),q()[t+12>>>2>>>0]=e.getUTCDate(),q()[t+16>>>2>>>0]=e.getUTCMonth(),q()[t+20>>>2>>>0]=e.getUTCFullYear()-1900,q()[t+24>>>2>>>0]=e.getUTCDay(),e=(e.getTime()-Date.UTC(e.getUTCFullYear(),0,1,0,0,0,0))/864e5|0,q()[t+28>>>2>>>0]=e}var bn=e=>e%4==0&&(e%100!=0||e%400==0),xn=[0,31,60,91,121,152,182,213,244,274,305,335],kn=[0,31,59,90,120,151,181,212,243,273,304,334];function Cn(e,t){e=-9007199254740992>e||9007199254740992<e?NaN:Number(e),t>>>=0,e=new Date(1e3*e),q()[t>>>2>>>0]=e.getSeconds(),q()[t+4>>>2>>>0]=e.getMinutes(),q()[t+8>>>2>>>0]=e.getHours(),q()[t+12>>>2>>>0]=e.getDate(),q()[t+16>>>2>>>0]=e.getMonth(),q()[t+20>>>2>>>0]=e.getFullYear()-1900,q()[t+24>>>2>>>0]=e.getDay();var n=(bn(e.getFullYear())?xn:kn)[e.getMonth()]+e.getDate()-1|0;q()[t+28>>>2>>>0]=n,q()[t+36>>>2>>>0]=-60*e.getTimezoneOffset(),n=new Date(e.getFullYear(),6,1).getTimezoneOffset();var r=new Date(e.getFullYear(),0,1).getTimezoneOffset();e=0|(n!=r&&e.getTimezoneOffset()==Math.min(r,n)),q()[t+32>>>2>>>0]=e}function Dn(e){e>>>=0;var t=new Date(q()[e+20>>>2>>>0]+1900,q()[e+16>>>2>>>0],q()[e+12>>>2>>>0],q()[e+8>>>2>>>0],q()[e+4>>>2>>>0],q()[e>>>2>>>0],0),n=q()[e+32>>>2>>>0],r=t.getTimezoneOffset(),o=new Date(t.getFullYear(),6,1).getTimezoneOffset(),a=new Date(t.getFullYear(),0,1).getTimezoneOffset(),i=Math.min(a,o);return 0>n?q()[e+32>>>2>>>0]=+(o!=a&&i==r):0<n!=(i==r)&&(o=Math.max(a,o),t.setTime(t.getTime()+6e4*((0<n?i:o)-r))),q()[e+24>>>2>>>0]=t.getDay(),n=(bn(t.getFullYear())?xn:kn)[t.getMonth()]+t.getDate()-1|0,q()[e+28>>>2>>>0]=n,q()[e>>>2>>>0]=t.getSeconds(),q()[e+4>>>2>>>0]=t.getMinutes(),q()[e+8>>>2>>>0]=t.getHours(),q()[e+12>>>2>>>0]=t.getDate(),q()[e+16>>>2>>>0]=t.getMonth(),q()[e+20>>>2>>>0]=t.getYear(),e=t.getTime(),BigInt(isNaN(e)?-1:e/1e3)}function Sn(e,t,n,r,o,a,i){return c?ue(16,1,e,t,n,r,o,a,i):-52}function En(e,t,n,r,o,a){if(c)return ue(17,1,e,t,n,r,o,a)}var Tn={},An=()=>performance.timeOrigin+performance.now();function Mn(e,t){if(c)return ue(18,1,e,t);if(Tn[e]&&(clearTimeout(Tn[e].id),delete Tn[e]),!t)return 0;var n=setTimeout((()=>{delete Tn[e],Et((()=>br(e,performance.timeOrigin+performance.now())))}),t);return Tn[e]={id:n,qc:t},0}function Fn(e,t,n,r){e>>>=0,t>>>=0,n>>>=0,r>>>=0;var o=(new Date).getFullYear(),a=new Date(o,0,1).getTimezoneOffset();o=new Date(o,6,1).getTimezoneOffset();var i=Math.max(a,o);U()[e>>>2>>>0]=60*i,q()[t>>>2>>>0]=+(a!=o),e=(t=e=>{var t=Math.abs(e);return"UTC".concat(0<=e?"-":"+").concat(String(Math.floor(t/60)).padStart(2,"0")).concat(String(t%60).padStart(2,"0"))})(a),t=t(o),o<a?(ze(e,n,17),ze(t,r,17)):(ze(e,r,17),ze(t,n,17))}var In=()=>Date.now(),Pn=1;function zn(e,t,n){if(!(0<=e&&3>=e))return 28;if(0===e)e=Date.now();else{if(!Pn)return 52;e=performance.timeOrigin+performance.now()}return I[n>>>0>>>3]=BigInt(Math.round(1e6*e)),0}var On=[],Nn=(e,t)=>{On.length=0;for(var n;n=L()[e++>>>0];){var r=105!=n;t+=(r&=112!=n)&&t%8?4:0,On.push(112==n?U()[t>>>2>>>0]:106==n?I[t>>>3]:105==n?q()[t>>>2>>>0]:G()[t>>>3>>>0]),t+=r?8:4}return On};function Bn(e,t,n){return e>>>=0,t=Nn(t>>>0,n>>>0),ne[e](...t)}function jn(e,t,n){return e>>>=0,t=Nn(t>>>0,n>>>0),ne[e](...t)}var Ln=()=>{};function Rn(e,t){return b(Me(e>>>0,t>>>0))}var Vn=()=>{throw ce+=1,"unwind"};function qn(){return 4294901760}var Un=()=>navigator.hardwareConcurrency;function Wn(){return ee("Cannot use emscripten_pc_get_function without -sUSE_OFFSET_CONVERTER"),0}function Gn(e){e>>>=0;var t=L().length;if(e<=t||4294901760<e)return!1;for(var n=1;4>=n;n*=2){var r=t*(1+.2/n);r=Math.min(r,e+100663296);e:{r=(Math.min(4294901760,65536*Math.ceil(Math.max(e,r)/65536))-x.buffer.byteLength+65535)/65536|0;try{x.grow(r),Z();var o=1;break e}catch(a){}o=void 0}if(o)return!0}return!1}var Hn=()=>(ee("Cannot use convertFrameToPC (needed by __builtin_return_address) without -sUSE_OFFSET_CONVERTER"),0),Kn={},Zn=e=>{e.forEach((e=>{var t=Hn();t&&(Kn[t]=e)}))};function $n(){var e=Error().stack.toString().split("\n");return"Error"==e[0]&&e.shift(),Zn(e),Kn.Lb=Hn(),Kn.cc=e,Kn.Lb}function Xn(e,t,n){if(e>>>=0,t>>>=0,Kn.Lb==e)var r=Kn.cc;else"Error"==(r=Error().stack.toString().split("\n"))[0]&&r.shift(),Zn(r);for(var o=3;r[o]&&Hn()!=e;)++o;for(e=0;e<n&&r[e+o];++e)q()[t+4*e>>>2>>>0]=Hn();return e}var Jn,Qn={},Yn=()=>{if(!Jn){var e,t={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:("object"==typeof navigator&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:"./this.program"};for(e in Qn)void 0===Qn[e]?delete t[e]:t[e]=Qn[e];var n=[];for(e in t)n.push("".concat(e,"=").concat(t[e]));Jn=n}return Jn};function er(e,t){if(c)return ue(19,1,e,t);e>>>=0,t>>>=0;var n=0;return Yn().forEach(((r,o)=>{var a=t+n;for(o=U()[e+4*o>>>2>>>0]=a,a=0;a<r.length;++a)j()[o++>>>0]=r.charCodeAt(a);j()[o>>>0]=0,n+=r.length+1})),0}function tr(e,t){if(c)return ue(20,1,e,t);e>>>=0,t>>>=0;var n=Yn();U()[e>>>2>>>0]=n.length;var r=0;return n.forEach((e=>r+=e.length+1)),U()[t>>>2>>>0]=r,0}function nr(e){return c?ue(21,1,e):52}function rr(e,t,n,r){return c?ue(22,1,e,t,n,r):52}function or(e,t,n,r){return c?ue(23,1,e,t,n,r):70}var ar=[null,[],[]];function ir(e,t,n,r){if(c)return ue(24,1,e,t,n,r);t>>>=0,n>>>=0,r>>>=0;for(var o=0,a=0;a<n;a++){var i=U()[t>>>2>>>0],s=U()[t+4>>>2>>>0];t+=8;for(var l=0;l<s;l++){var u=L()[i+l>>>0],d=ar[e];0===u||10===u?((1===e?w:b)(Ae(d)),d.length=0):d.push(u)}o+=s}return U()[r>>>2>>>0]=o,0}c||function(){for(var e=a.numThreads-1;e--;)be();se.unshift((()=>{var e;J++,e=()=>Y(),c?e():Promise.all(fe.map(we)).then(e)}))}();for(var sr=Array(256),lr=0;256>lr;++lr)sr[lr]=String.fromCharCode(lr);He=sr,Ke=a.BindingError=class extends Error{constructor(e){super(e),this.name="BindingError"}},a.InternalError=class extends Error{constructor(e){super(e),this.name="InternalError"}},at.push(0,1,void 0,1,null,1,!0,1,!1,1),a.count_emval_handles=()=>at.length/2-5-ot.length;var cr,ur=[de,pe,Se,Fe,Ie,Oe,Ne,Be,je,Le,Re,Ve,qe,Ue,We,Ge,Sn,En,Mn,er,tr,nr,rr,or,ir];!async function(){function e(e,t){return cr=e.exports,cr=function(){var e=cr,t={};for(let[n,r]of Object.entries(e))t[n]="function"==typeof r?function(){Wt.push(n);try{return r(...arguments)}finally{N||(Wt.pop(),qt&&1===Vt&&0===Wt.length&&(Vt=0,ce+=1,Rt(Ar),typeof Fibers<"u"&&Fibers.rc()))}}:r;return t}(),cr=function(){var e=cr,t=e=>t=>e(t)>>>0,n=e=>()=>e()>>>0;return(e=Object.assign({},e)).Da=t(e.Da),e.fb=n(e.fb),e.hb=t(e.hb),e.tb=t(e.tb),e.ub=n(e.ub),e.__cxa_get_exception_ptr=t(e.__cxa_get_exception_ptr),e}(),ge.push(cr.ib),k=t,Y(),cr}J++;var t=te();if(a.instantiateWasm)return new Promise((n=>{a.instantiateWasm(t,((t,r)=>{e(t,r),n(t.exports)}))}));if(c)return new Promise((t=>{H=n=>{var r=new WebAssembly.Instance(n,te());t(e(r,n))}}));null!==X&&void 0!==X||(X=a.locateFile?a.locateFile?a.locateFile("ort-wasm-simd-threaded.jsep.wasm",_):_+"ort-wasm-simd-threaded.jsep.wasm":new URL(n(98),n.b).href);try{var r=await async function(e){var t=X;if(!O&&"function"==typeof WebAssembly.instantiateStreaming&&!B(t))try{var n=fetch(t,{credentials:"same-origin"});return await WebAssembly.instantiateStreaming(n,e)}catch(r){b("wasm streaming compile failed: ".concat(r)),b("falling back to ArrayBuffer instantiation")}return async function(e,t){try{var n=await async function(e){if(!O)try{var t=await h(e);return new Uint8Array(t)}catch(n){}if(e==X&&O)e=new Uint8Array(O);else{if(!f)throw"both async and sync fetching of the wasm failed";e=f(e)}return e}(e);return await WebAssembly.instantiate(n,t)}catch(r){b("failed to asynchronously prepare wasm: ".concat(r)),ee(r)}}(t,e)}(t);return e(r.instance,r.module)}catch(i){return o(i),Promise.reject(i)}}();var dr=e=>(dr=cr.Da)(e),pr=()=>(pr=cr.Ea)();a._OrtInit=(e,t)=>(a._OrtInit=cr.Fa)(e,t),a._OrtGetLastError=(e,t)=>(a._OrtGetLastError=cr.Ga)(e,t),a._OrtCreateSessionOptions=(e,t,n,r,o,i,s,l,c,u)=>(a._OrtCreateSessionOptions=cr.Ha)(e,t,n,r,o,i,s,l,c,u),a._OrtAppendExecutionProvider=(e,t,n,r,o)=>(a._OrtAppendExecutionProvider=cr.Ia)(e,t,n,r,o),a._OrtAddFreeDimensionOverride=(e,t,n)=>(a._OrtAddFreeDimensionOverride=cr.Ja)(e,t,n),a._OrtAddSessionConfigEntry=(e,t,n)=>(a._OrtAddSessionConfigEntry=cr.Ka)(e,t,n),a._OrtReleaseSessionOptions=e=>(a._OrtReleaseSessionOptions=cr.La)(e),a._OrtCreateSession=(e,t,n)=>(a._OrtCreateSession=cr.Ma)(e,t,n),a._OrtReleaseSession=e=>(a._OrtReleaseSession=cr.Na)(e),a._OrtGetInputOutputCount=(e,t,n)=>(a._OrtGetInputOutputCount=cr.Oa)(e,t,n),a._OrtGetInputOutputMetadata=(e,t,n,r)=>(a._OrtGetInputOutputMetadata=cr.Pa)(e,t,n,r),a._OrtFree=e=>(a._OrtFree=cr.Qa)(e),a._OrtCreateTensor=(e,t,n,r,o,i)=>(a._OrtCreateTensor=cr.Ra)(e,t,n,r,o,i),a._OrtGetTensorData=(e,t,n,r,o)=>(a._OrtGetTensorData=cr.Sa)(e,t,n,r,o),a._OrtReleaseTensor=e=>(a._OrtReleaseTensor=cr.Ta)(e),a._OrtCreateRunOptions=(e,t,n,r)=>(a._OrtCreateRunOptions=cr.Ua)(e,t,n,r),a._OrtAddRunConfigEntry=(e,t,n)=>(a._OrtAddRunConfigEntry=cr.Va)(e,t,n),a._OrtReleaseRunOptions=e=>(a._OrtReleaseRunOptions=cr.Wa)(e),a._OrtCreateBinding=e=>(a._OrtCreateBinding=cr.Xa)(e),a._OrtBindInput=(e,t,n)=>(a._OrtBindInput=cr.Ya)(e,t,n),a._OrtBindOutput=(e,t,n,r)=>(a._OrtBindOutput=cr.Za)(e,t,n,r),a._OrtClearBoundOutputs=e=>(a._OrtClearBoundOutputs=cr._a)(e),a._OrtReleaseBinding=e=>(a._OrtReleaseBinding=cr.$a)(e),a._OrtRunWithBinding=(e,t,n,r,o)=>(a._OrtRunWithBinding=cr.ab)(e,t,n,r,o),a._OrtRun=(e,t,n,r,o,i,s,l)=>(a._OrtRun=cr.bb)(e,t,n,r,o,i,s,l),a._OrtEndProfiling=e=>(a._OrtEndProfiling=cr.cb)(e),a._JsepOutput=(e,t,n)=>(a._JsepOutput=cr.db)(e,t,n),a._JsepGetNodeName=e=>(a._JsepGetNodeName=cr.eb)(e);var hr=()=>(hr=cr.fb)(),fr=a._free=e=>(fr=a._free=cr.gb)(e),mr=a._malloc=e=>(mr=a._malloc=cr.hb)(e),gr=(e,t,n,r,o,a)=>(gr=cr.kb)(e,t,n,r,o,a),_r=()=>(_r=cr.lb)(),vr=(e,t,n,r,o)=>(vr=cr.mb)(e,t,n,r,o),yr=e=>(yr=cr.nb)(e),wr=e=>(wr=cr.ob)(e),br=(e,t)=>(br=cr.pb)(e,t),xr=()=>(xr=cr.qb)(),kr=(e,t)=>(kr=cr.rb)(e,t),Cr=e=>(Cr=cr.sb)(e),Dr=e=>(Dr=cr.tb)(e),Sr=()=>(Sr=cr.ub)(),Er=a.dynCall_ii=(e,t)=>(Er=a.dynCall_ii=cr.vb)(e,t),Tr=e=>(Tr=cr.wb)(e),Ar=()=>(Ar=cr.xb)(),Mr=e=>(Mr=cr.yb)(e),Fr=()=>(Fr=cr.zb)();return a.stackSave=()=>Sr(),a.stackRestore=e=>Cr(e),a.stackAlloc=e=>Dr(e),a.setValue=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"i8";switch(n.endsWith("*")&&(n="*"),n){case"i1":case"i8":j()[e>>>0]=t;break;case"i16":R()[e>>>1>>>0]=t;break;case"i32":q()[e>>>2>>>0]=t;break;case"i64":I[e>>>3]=BigInt(t);break;case"float":W()[e>>>2>>>0]=t;break;case"double":G()[e>>>3>>>0]=t;break;case"*":U()[e>>>2>>>0]=t;break;default:ee("invalid type for setValue: ".concat(n))}},a.getValue=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"i8";switch(t.endsWith("*")&&(t="*"),t){case"i1":case"i8":return j()[e>>>0];case"i16":return R()[e>>>1>>>0];case"i32":return q()[e>>>2>>>0];case"i64":return I[e>>>3];case"float":return W()[e>>>2>>>0];case"double":return G()[e>>>3>>>0];case"*":return U()[e>>>2>>>0];default:ee("invalid type for getValue: ".concat(t))}},a.UTF8ToString=Me,a.stringToUTF8=ze,a.lengthBytesUTF8=Pe,function e(){if(0<J)Q=e;else if(c)r(a),$();else{for(;0<se.length;)se.shift()(a);0<J?Q=e:(a.calledRun=!0,N||($(),r(a)))}}(),a.PTR_SIZE=4,i},WD=UD,(null===(e=globalThis.self)||void 0===e||null===(e=e.name)||void 0===e?void 0:e.startsWith("em-pthread"))&&UD()})),Ez=pD((()=>{OD(),GD=typeof location>"u"?void 0:location.origin,HD=!0,KD=()=>{if(HD){let e=URL;return new URL(new e(n(618),n.b).href,GD).href}return"file:///Users/emilyreif/Documents/github/llm-consistency-vis/node_modules/onnxruntime-web/dist/ort.bundle.min.mjs"},ZD=KD(),$D=()=>{if(ZD&&!ZD.startsWith("blob:"))return ZD.substring(0,ZD.lastIndexOf("/")+1)},XD=(e,t)=>{try{let n=null!==t&&void 0!==t?t:ZD;return(n?new URL(e,n):new URL(e)).origin===GD}catch(n){return!1}},JD=(e,t)=>{let n=null!==t&&void 0!==t?t:ZD;try{return(n?new URL(e,n):new URL(e)).href}catch(r){return}},QD=(e,t)=>"".concat(null!==t&&void 0!==t?t:"./").concat(e),YD=async e=>{let t=await(await fetch(e,{credentials:"same-origin"})).blob();return URL.createObjectURL(t)},eS=async e=>(await import(e)).default,tS=(RD(),fD(ND)).default,nS=async()=>{if(!ZD)throw new Error("Failed to load proxy worker: cannot determine the script source URL.");if(XD(ZD))return[void 0,tS()];let e=await YD(ZD);return[e,tS(e)]},rS=(Sz(),fD(VD)).default,oS=async(e,t,n)=>{if(!e&&!t&&rS&&ZD&&XD(ZD))return[void 0,rS];{let r="ort-wasm-simd-threaded.jsep.mjs",o=null!==e&&void 0!==e?e:JD(r,t),a=n&&o&&!XD(o,t),i=a?await YD(o):null!==o&&void 0!==o?o:QD(r,t);return[a?i:void 0,await eS(i)]}}})),Tz=pD((()=>{Ez(),iS=!1,sS=!1,lS=!1,cS=()=>{if(typeof SharedArrayBuffer>"u")return!1;try{return typeof MessageChannel<"u"&&(new MessageChannel).port1.postMessage(new SharedArrayBuffer(1)),WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,5,4,1,3,1,1,10,11,1,9,0,65,0,254,16,2,0,26,11]))}catch(e){return!1}},uS=()=>{try{return WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,30,1,28,0,65,0,253,15,253,12,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,253,186,1,26,11]))}catch(e){return!1}},dS=()=>{try{return WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,5,1,96,0,1,123,3,2,1,0,10,19,1,17,0,65,1,253,15,65,2,253,15,65,3,253,15,253,147,2,11]))}catch(e){return!1}},pS=async e=>{var t,n;if(iS)return Promise.resolve();if(sS)throw new Error("multiple calls to 'initializeWebAssembly()' detected.");if(lS)throw new Error("previous call to 'initializeWebAssembly()' failed.");sS=!0;let r=e.initTimeout,o=e.numThreads;if(!1!==e.simd)if("relaxed"===e.simd){if(!dS())throw new Error("Relaxed WebAssembly SIMD is not supported in the current environment.")}else if(!uS())throw new Error("WebAssembly SIMD is not supported in the current environment.");let a=cS();o>1&&!a&&(typeof self<"u"&&!self.crossOriginIsolated&&console.warn("env.wasm.numThreads is set to "+o+", but this will not work unless you enable crossOriginIsolated mode. See https://web.dev/cross-origin-isolation-guide/ for more info."),console.warn("WebAssembly multi-threading is not supported in the current environment. Falling back to single-threading."),e.numThreads=o=1);let i=e.wasmPaths,s="string"==typeof i?i:void 0,l=null===i||void 0===i?void 0:i.mjs,c=null!==(t=null===l||void 0===l?void 0:l.href)&&void 0!==t?t:l,u=null===i||void 0===i?void 0:i.wasm,d=null!==(n=null===u||void 0===u?void 0:u.href)&&void 0!==n?n:u,p=e.wasmBinary,[h,f]=await oS(c,s,o>1),m=!1,g=[];if(r>0&&g.push(new Promise((e=>{setTimeout((()=>{m=!0,e()}),r)}))),g.push(new Promise(((e,t)=>{let n={numThreads:o};if(p)n.wasmBinary=p;else if(d||s)n.locateFile=e=>null!==d&&void 0!==d?d:s+e;else if(c&&0!==c.indexOf("blob:"))n.locateFile=e=>new URL(e,c).href;else if(h){let e=$D();e&&(n.locateFile=t=>e+t)}f(n).then((t=>{sS=!1,iS=!0,aS=t,e(),h&&URL.revokeObjectURL(h)}),(e=>{sS=!1,lS=!0,t(e)}))}))),await Promise.race(g),m)throw new Error("WebAssembly backend initializing failed due to timeout: ".concat(r,"ms"))},hS=()=>{if(iS&&aS)return aS;throw new Error("WebAssembly is not initialized yet.")}})),Az=pD((()=>{Tz(),fS=(e,t)=>{let n=hS(),r=n.lengthBytesUTF8(e)+1,o=n._malloc(r);return n.stringToUTF8(e,o,r),t.push(o),o},mS=(e,t,n,r)=>{if("object"==typeof e&&null!==e){if(n.has(e))throw new Error("Circular reference in options");n.add(e)}Object.entries(e).forEach((e=>{let[o,a]=e,i=t?t+o:o;if("object"==typeof a)mS(a,i+".",n,r);else if("string"==typeof a||"number"==typeof a)r(i,a.toString());else{if("boolean"!=typeof a)throw new Error("Can't handle extra config type: ".concat(typeof a));r(i,a?"1":"0")}}))},gS=e=>{let t=hS(),n=t.stackSave();try{let n=t.PTR_SIZE,r=t.stackAlloc(2*n);t._OrtGetLastError(r,r+n);let o=Number(t.getValue(r,4===n?"i32":"i64")),a=t.getValue(r+n,"*"),i=a?t.UTF8ToString(a):"";throw new Error("".concat(e," ERROR_CODE: ").concat(o,", ERROR_MESSAGE: ").concat(i))}finally{t.stackRestore(n)}}})),Mz=pD((()=>{Tz(),Az(),_S=e=>{let t=hS(),n=0,r=[],o=e||{};try{if(void 0===(null===e||void 0===e?void 0:e.logSeverityLevel))o.logSeverityLevel=2;else if("number"!=typeof e.logSeverityLevel||!Number.isInteger(e.logSeverityLevel)||e.logSeverityLevel<0||e.logSeverityLevel>4)throw new Error("log serverity level is not valid: ".concat(e.logSeverityLevel));if(void 0===(null===e||void 0===e?void 0:e.logVerbosityLevel))o.logVerbosityLevel=0;else if("number"!=typeof e.logVerbosityLevel||!Number.isInteger(e.logVerbosityLevel))throw new Error("log verbosity level is not valid: ".concat(e.logVerbosityLevel));void 0===(null===e||void 0===e?void 0:e.terminate)&&(o.terminate=!1);let a=0;return void 0!==(null===e||void 0===e?void 0:e.tag)&&(a=fS(e.tag,r)),n=t._OrtCreateRunOptions(o.logSeverityLevel,o.logVerbosityLevel,!!o.terminate,a),0===n&&gS("Can't create run options."),void 0!==(null===e||void 0===e?void 0:e.extra)&&mS(e.extra,"",new WeakSet,((e,o)=>{let a=fS(e,r),i=fS(o,r);0!==t._OrtAddRunConfigEntry(n,a,i)&&gS("Can't set a run config entry: ".concat(e," - ").concat(o,"."))})),[n,r]}catch(a){throw 0!==n&&t._OrtReleaseRunOptions(n),r.forEach((e=>t._free(e))),a}}})),Fz=pD((()=>{Tz(),Az(),vS=e=>{switch(e){case"disabled":return 0;case"basic":return 1;case"extended":return 2;case"all":return 99;default:throw new Error("unsupported graph optimization level: ".concat(e))}},yS=e=>{switch(e){case"sequential":return 0;case"parallel":return 1;default:throw new Error("unsupported execution mode: ".concat(e))}},wS=e=>{e.extra||(e.extra={}),e.extra.session||(e.extra.session={});let t=e.extra.session;t.use_ort_model_bytes_directly||(t.use_ort_model_bytes_directly="1"),e.executionProviders&&e.executionProviders.some((e=>"webgpu"===("string"==typeof e?e:e.name)))&&(e.enableMemPattern=!1)},bS=(e,t,n,r)=>{let o=fS(t,r),a=fS(n,r);0!==hS()._OrtAddSessionConfigEntry(e,o,a)&&gS("Can't set a session config entry: ".concat(t," - ").concat(n,"."))},xS=async(e,t,n)=>{for(let r of t){let t="string"==typeof r?r:r.name,o=[];switch(t){case"webnn":if(t="WEBNN","string"!=typeof r){let t=null===r||void 0===r?void 0:r.deviceType;t&&bS(e,"deviceType",t,n)}break;case"webgpu":if(t="JS","string"!=typeof r){let t=r;if(null!==t&&void 0!==t&&t.preferredLayout){if("NCHW"!==t.preferredLayout&&"NHWC"!==t.preferredLayout)throw new Error("preferredLayout must be either 'NCHW' or 'NHWC': ".concat(t.preferredLayout));bS(e,"preferredLayout",t.preferredLayout,n)}}break;case"wasm":case"cpu":continue;default:throw new Error("not supported execution provider: ".concat(t))}let a=fS(t,n),i=o.length,s=0,l=0;if(i>0){s=hS()._malloc(i*hS().PTR_SIZE),n.push(s),l=hS()._malloc(i*hS().PTR_SIZE),n.push(l);for(let e=0;e<i;e++)hS().setValue(s+e*hS().PTR_SIZE,o[e][0],"*"),hS().setValue(l+e*hS().PTR_SIZE,o[e][1],"*")}0!==await hS()._OrtAppendExecutionProvider(e,a,s,l,i)&&gS("Can't append execution provider: ".concat(t,"."))}},kS=async e=>{let t=hS(),n=0,r=[],o=e||{};wS(o);try{var a,i,s,l;let e=vS(null!==(a=o.graphOptimizationLevel)&&void 0!==a?a:"all"),c=yS(null!==(i=o.executionMode)&&void 0!==i?i:"sequential"),u="string"==typeof o.logId?fS(o.logId,r):0,d=null!==(s=o.logSeverityLevel)&&void 0!==s?s:2;if(!Number.isInteger(d)||d<0||d>4)throw new Error("log serverity level is not valid: ".concat(d));let p=null!==(l=o.logVerbosityLevel)&&void 0!==l?l:0;if(!Number.isInteger(p)||p<0||p>4)throw new Error("log verbosity level is not valid: ".concat(p));let h="string"==typeof o.optimizedModelFilePath?fS(o.optimizedModelFilePath,r):0;if(n=t._OrtCreateSessionOptions(e,!!o.enableCpuMemArena,!!o.enableMemPattern,c,!!o.enableProfiling,0,u,d,p,h),0===n&&gS("Can't create session options."),o.executionProviders&&await xS(n,o.executionProviders,r),void 0!==o.enableGraphCapture){if("boolean"!=typeof o.enableGraphCapture)throw new Error("enableGraphCapture must be a boolean value: ".concat(o.enableGraphCapture));bS(n,"enableGraphCapture",o.enableGraphCapture.toString(),r)}if(o.freeDimensionOverrides)for(let[a,i]of Object.entries(o.freeDimensionOverrides)){if("string"!=typeof a)throw new Error("free dimension override name must be a string: ".concat(a));if("number"!=typeof i||!Number.isInteger(i)||i<0)throw new Error("free dimension override value must be a non-negative integer: ".concat(i));let e=fS(a,r);0!==t._OrtAddFreeDimensionOverride(n,e,i)&&gS("Can't set a free dimension override: ".concat(a," - ").concat(i,"."))}return void 0!==o.extra&&mS(o.extra,"",new WeakSet,((e,t)=>{bS(n,e,t,r)})),[n,r]}catch(c){throw 0!==n&&0!==t._OrtReleaseSessionOptions(n)&&gS("Can't release session options."),r.forEach((e=>t._free(e))),c}}})),Iz=pD((()=>{CS=e=>{switch(e){case"int8":return 3;case"uint8":return 2;case"bool":return 9;case"int16":return 5;case"uint16":return 4;case"int32":return 6;case"uint32":return 12;case"float16":return 10;case"float32":return 1;case"float64":return 11;case"string":return 8;case"int64":return 7;case"uint64":return 13;case"int4":return 22;case"uint4":return 21;default:throw new Error("unsupported data type: ".concat(e))}},DS=e=>{switch(e){case 3:return"int8";case 2:return"uint8";case 9:return"bool";case 5:return"int16";case 4:return"uint16";case 6:return"int32";case 12:return"uint32";case 10:return"float16";case 1:return"float32";case 11:return"float64";case 8:return"string";case 7:return"int64";case 13:return"uint64";case 22:return"int4";case 21:return"uint4";default:throw new Error("unsupported data type: ".concat(e))}},SS=(e,t)=>{let n=[-1,4,1,1,2,2,4,8,-1,1,2,8,4,8,-1,-1,-1,-1,-1,-1,-1,.5,.5][e],r="number"==typeof t?t:t.reduce(((e,t)=>e*t),1);return n>0?Math.ceil(r*n):void 0},ES=e=>{switch(e){case"float16":return typeof Float16Array<"u"&&Float16Array.from?Float16Array:Uint16Array;case"float32":return Float32Array;case"uint8":case"bool":return Uint8Array;case"int8":return Int8Array;case"uint16":return Uint16Array;case"int16":return Int16Array;case"int32":return Int32Array;case"float64":return Float64Array;case"uint32":return Uint32Array;case"int64":return BigInt64Array;case"uint64":return BigUint64Array;default:throw new Error("unsupported type: ".concat(e))}},TS=e=>{switch(e){case"verbose":return 0;case"info":return 1;case"warning":return 2;case"error":return 3;case"fatal":return 4;default:throw new Error("unsupported logging level: ".concat(e))}},AS=e=>"float32"===e||"float16"===e||"int32"===e||"int64"===e||"uint32"===e||"uint8"===e||"bool"===e||"uint4"===e||"int4"===e,MS=e=>"float32"===e||"float16"===e||"int32"===e||"int64"===e||"uint32"===e||"uint64"===e||"int8"===e||"uint8"===e||"bool"===e||"uint4"===e||"int4"===e,FS=e=>{switch(e){case"none":return 0;case"cpu":return 1;case"cpu-pinned":return 2;case"texture":return 3;case"gpu-buffer":return 4;case"ml-tensor":return 5;default:throw new Error("unsupported data location: ".concat(e))}}})),Pz=pD((()=>{OD(),IS=async e=>{if("string"==typeof e){let n=await fetch(e);if(!n.ok)throw new Error("failed to load external data file: ".concat(e));let r=n.headers.get("Content-Length"),o=r?parseInt(r,10):0;if(o<1073741824)return new Uint8Array(await n.arrayBuffer());{if(!n.body)throw new Error("failed to load external data file: ".concat(e,", no response body."));let r,a=n.body.getReader();try{r=new ArrayBuffer(o)}catch(t){if(!(t instanceof RangeError))throw t;{let e=Math.ceil(o/65536);r=new WebAssembly.Memory({initial:e,maximum:e}).buffer}}let i=0;for(;;){let{done:e,value:t}=await a.read();if(e)break;let n=t.byteLength;new Uint8Array(r,i,n).set(t),i+=n}return new Uint8Array(r,0,o)}}return e instanceof Blob?new Uint8Array(await e.arrayBuffer()):e instanceof Uint8Array?e:new Uint8Array(e)}})),zz=pD((()=>{Iz(),PS=["V","I","W","E","F"],zS=(e,t)=>{console.log("[".concat(PS[e],",").concat((new Date).toISOString(),"]").concat(t))},BS=(e,t)=>{OS=e,NS=t},jS=(e,t)=>{let n=TS(e);n>=TS(OS)&&zS(n,"function"==typeof t?t():t)},LS=function(){NS&&jS(...arguments)}})),Oz=pD((()=>{RS=class{static calcMatMulShape(e,t){return e[1]!==t[0]?void 0:[e[0],t[1]]}},VS=class{static calcShape(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=e.length,o=t.length;if(0===r)return t;if(0===o)return e;let a=Math.max(e.length,t.length),i=new Array(a);if(n){if(r<2||o<2)return;let n=RS.calcMatMulShape([e[r-2],e[r-1]],[t[o-2],t[o-1]]);if(void 0===n)return;[i[a-2],i[a-1]]=n}for(let s=n?3:1;s<=a;s++){let n=r-s<0?1:e[r-s],l=o-s<0?1:t[o-s];if(n!==l&&n>1&&l>1)return;let c=Math.max(n,l);if(n&&l)i[a-s]=Math.max(n,l);else{if(c>1)return;i[a-s]=0}}return i}static isValidBroadcast(e,t){let n=e.length,r=t.length;if(n>r)return!1;for(let o=1;o<=n;o++)if(1!==e[n-o]&&e[n-o]!==t[r-o])return!1;return!0}},qS=class e{static size(t){return e.getSizeFromDimensionRange(t,0,t.length)}static convertShape(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4,n=e.length;if(0===n)return[];let r=new Array(n),o=n-1;for(;o>=0;){if(e[o]%t===0){r[o]=e[o]/t;break}if(t%e[o]!==0)throw new Error("cannot convert shape");r[o]=1,t/=e[o],o--}for(o--;o>=0;o--)r[o]=e[o];return r}static sizeFromDimension(t,n){if(n<0||n>t.length)throw new Error("invalid dimension of ".concat(n," for sizeFromDimension as Tensor has ").concat(t.length," dimensions."));return e.getSizeFromDimensionRange(t,n,t.length)}static sizeToDimension(t,n){if(n<0||n>t.length)throw new Error("invalid dimension of ".concat(n," for sizeToDimension as Tensor has ").concat(t.length," dimensions."));return e.getSizeFromDimensionRange(t,0,n)}static getSizeFromDimensionRange(e,t,n){let r=1;for(let o=t;o<n;o++){if(e[o]<0)throw new Error("cannot get valid size from specified dimension range. Most likely the range contains negative values in them.");r*=Number(e[o])}return r}static computeStrides(e){let t=e.length;if(0===t)return[];if(1===t)return[1];let n=new Array(t);n[t-1]=1,n[t-2]=e[t-1];for(let r=t-3;r>=0;--r)n[r]=n[r+1]*e[r+1];return n}static normalizeAxis(e,t){if(e<-t&&e>=t)throw new Error("unsupported axis for this operation.");return e<0?e+t:e}static normalizeAxes(e,t){return e.map((n=>this.normalizeAxis(n,null!==t&&void 0!==t?t:e.length)))}static sortBasedOnPerm(e,t){return t?t.map((t=>e[t])):e.slice().reverse()}static padShape(e,t){let n=e.length;return e.map(((e,r)=>e+t[r]+t[r+n]))}static areEqual(e,t){return e.length===t.length&&e.every(((e,n)=>e===t[n]))}},US=class e{static adjustPoolAttributes(e,t,n,r,o,a){if(!e&&n.length!==t.length-2)throw new Error("length of specified kernel shapes should be 2 less than length of input dimensions");if(e)for(let i=0;i<t.length-2;i++)i>=n.length?n.push(t[i+2]):n[i]=t[i+2];for(let i=0;i<n.length;i++)if(i<r.length){if(r[i]<0)throw new Error("strides should be greater than or equal to 1")}else r.push(1);for(let i=0;i<n.length;i++)if(i<o.length){if(o[i]<0)throw new Error("dilations should be greater than or equal to 1")}else o.push(1);for(let i=0;i<2*n.length;i++)if(i<a.length){if(a[i]<0)throw new Error("pad should be greater than or equal to 1")}else a.push(0);for(let i=0;i<n.length;i++){if(n[i]<=0)throw new Error("kernel shapes need to be greater than 0");if(a[i]>=n[i]||a[i+n.length]>=n[i])throw new Error("pads should be smaller than kernel")}}static adjustPadsBasedOnAutoPad(t,n,r,o,a,i,s){if(s){if(a.length!==2*(t.length-2))throw new Error("length of pads should be twice the length of data dimensions");if(n.length!==t.length-2)throw new Error("length of strides should be the length of data dimensions");if(o.length!==t.length-2)throw new Error("length of kernel shapes should be the length of data dimensions");for(let l=0;l<t.length-2;l++)e.adjustPadAndReturnShape(t[l+(i?1:2)],n[l],r[l],o[l],a,l,l+t.length-2,s)}}static computePoolOutputShape(t,n,r,o,a,i,s){if(n.length<=0)throw new Error("input shape must be of size greater than 0");let l=[n[0],n[1]];return e.computeShapeHelper(t,n,l,r,o,a,i,s),l}static computeConvOutputShape(t,n,r,o,a,i,s){if(t.length<=0||n.length<=0)throw new Error("invalid input tensor dims or invalid filter tensor dims");let l=[t[0],n[0]];return e.computeShapeHelper(!1,t,l,r,o,a,i,s),l}static computeShapeHelper(t,n,r,o,a,i,s,l){if(t)for(let e=0;e<n.length-2;e++)r.push(1);else for(let c=0;c<n.length-2;c++)r.push(e.adjustPadAndReturnShape(n[c+2],o[c],a[c],i[c],s,c,c+n.length-2,l))}static adjustPadAndReturnShape(e,t,n,r,o,a,i,s){let l=n*(r-1)+1;if(!s||"NOTSET"===s)return Math.floor((e+o[a]+o[i]-l)/t+1);switch(s){case"VALID":return o[a]=0,o[i]=0,Math.floor((e-l)/t+1);case"SAME_LOWER":case"SAME_UPPER":if(1!==n)throw new Error("Dilation not supported for SAME_UPPER or SAME_LOWER");{let n=((e+t-1)/t-1)*t+r-e;return o[a]=Math.floor("SAME_LOWER"===s?(n+1)/2:n/2),o[i]=n-o[a],Math.floor((e+n-r)/t+1)}default:throw new Error("Unsupported AutoPad type")}}},WS=class{static getShapeOfGemmResult(e,t,n,r,o){if(2!==e.length||2!==n.length)throw new Error("shape need to be of size 2");let a,i,s;t?(a=e[1],i=e[0]):(a=e[0],i=e[1]);let l=-1;if(r?(s=n[0],l=1):(s=n[1],l=0),n[l]!==i)throw new Error("dimension mismatch");if(a<=0||s<=0||i<=0)throw new Error("invalid shape specified");if(o&&!VS.isValidBroadcast(o,[a,s]))throw new Error("gemm: invalid bias shape for broadcast");return[a,s,i]}},GS=-34028234663852886e22,HS=34028234663852886e22})),Nz=pD((()=>{Iz(),KS=(e,t)=>new(ES(t))(e)})),Bz=pD((()=>{zz(),ZS=function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(e.byteLength%8!==0)throw new Error("Invalid Uint8Array length - must be a multiple of 8 (BigInt).");let n=e.byteLength/8,r=new BigInt64Array(e.buffer,e.byteOffset,n),o=new Int32Array(n);for(let a=0;a<n;a++){let e=r[a];if(e>2147483647n||e<-2147483648n)throw new Error("Overflow occurred when converting BigInt to Int32 at index ".concat(a,": ").concat(e));o[a]=Number(e)}return t?new Uint8Array(o.buffer):o},$S=function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(e.byteLength%4!==0)throw new Error("Invalid Uint8Array length - must be a multiple of 4 (Int32).");let n=e.byteLength/4,r=new Int32Array(e.buffer,e.byteOffset,n),o=BigInt64Array.from(r,BigInt);return t?new Uint8Array(o.buffer):o},XS=1,JS=()=>XS++,QS=new Map([["float32",32],["float16",16],["int32",32],["uint32",32],["int64",64],["uint64",64],["int8",8],["uint8",8],["int4",4],["uint4",4]]),YS=(e,t)=>{let n=QS.get(e);if(!n)throw new Error("Unsupported data type.");return t.length>0?Math.ceil(t.reduce(((e,t)=>e*t))*n/8):0},eE=class{constructor(e){this.shouldConvertInt64toInt32=!1,this.isInt64ToInt32Converted=!1;let{sessionId:t,context:n,tensor:r,dataType:o,shape:a,shouldConvertInt64toInt32:i=!1}=e;this.sessionId=t,this.mlContext=n,this.mlTensor=r,this.dataType=o,this.tensorShape=a,this.shouldConvertInt64toInt32=i}get tensor(){return this.mlTensor}get type(){return this.dataType}get shape(){return this.tensorShape}get byteLength(){return YS(this.dataType,this.tensorShape)}destroy(){LS("verbose",(()=>"[WebNN] TensorWrapper.destroy")),this.mlTensor.destroy()}write(e){this.mlContext.writeTensor(this.mlTensor,e)}async read(e,t){if(e){let e=await this.mlContext.readTensor(this.mlTensor),n=$S(new Uint8Array(e));return t?void(t instanceof ArrayBuffer?new Uint8Array(t):new Uint8Array(t.buffer,t.byteOffset,t.byteLength)).set(n):n.buffer}return t?this.mlContext.readTensor(this.mlTensor,t):this.mlContext.readTensor(this.mlTensor)}canReuseTensor(e,t,n){return this.mlContext===e&&this.dataType===t&&this.tensorShape.length===n.length&&this.tensorShape.every(((e,t)=>e===n[t]))}setIsInt64ToInt32Converted(e){this.isInt64ToInt32Converted=e}},tE=class{constructor(e,t){this.tensorManager=e,this.wrapper=t}get tensorWrapper(){return this.wrapper}releaseTensor(){this.tensorWrapper&&(this.tensorManager.releaseTensor(this.tensorWrapper),this.wrapper=void 0)}async ensureTensor(e,t,n,r){let o=t,a=this.tensorManager.getMLContext(e),i="int64"===o&&!a.opSupportLimits().input.dataTypes.includes("int64");if(i&&(o="int32",LS("verbose",(()=>"[WebNN] TensorIdTracker.ensureTensor: convert dataType from int64 to int32"))),this.wrapper){if(this.wrapper.canReuseTensor(a,o,n))return this.wrapper.tensor;if(r){if(this.wrapper.byteLength!==YS(o,n))throw new Error("Unable to copy data to tensor with different size.");this.activeUpload=new Uint8Array(await this.wrapper.read())}this.tensorManager.releaseTensor(this.wrapper)}let s=typeof MLTensorUsage>"u"?void 0:MLTensorUsage.READ|MLTensorUsage.WRITE;return this.wrapper=await this.tensorManager.getCachedTensor(e,o,n,s,!0,!0,i),r&&this.activeUpload&&(this.wrapper.write(this.activeUpload),this.activeUpload=void 0),this.wrapper.tensor}upload(e){let t=e;if(this.wrapper){if(this.wrapper.shouldConvertInt64toInt32&&(t=ZS(e,!0),this.wrapper.setIsInt64ToInt32Converted(!0)),t.byteLength===this.wrapper.byteLength)return void this.wrapper.write(t);LS("verbose",(()=>"Data size does not match tensor size. Releasing tensor.")),this.releaseTensor()}this.activeUpload?this.activeUpload.set(t):this.activeUpload=new Uint8Array(t)}async download(e){var t,n;if(this.activeUpload){var r;let t=null!==(r=this.wrapper)&&void 0!==r&&r.isInt64ToInt32Converted?$S(this.activeUpload):this.activeUpload;return e?void(e instanceof ArrayBuffer?new Uint8Array(e).set(t):new Uint8Array(e.buffer,e.byteOffset,e.byteLength).set(t)):t.buffer}if(!this.wrapper)throw new Error("Tensor has not been created.");return e?this.wrapper.read(null===(t=this.wrapper)||void 0===t?void 0:t.shouldConvertInt64toInt32,e):this.wrapper.read(null===(n=this.wrapper)||void 0===n?void 0:n.shouldConvertInt64toInt32)}},nE=class{constructor(e){this.backend=e,this.tensorTrackersById=new Map,this.freeTensors=[],this.externalTensors=new Set}getMLContext(e){let t=this.backend.getMLContext(e);if(!t)throw new Error("MLContext not found for session.");return t}reserveTensorId(){let e=JS();return this.tensorTrackersById.set(e,new tE(this)),e}releaseTensorId(e){let t=this.tensorTrackersById.get(e);t&&(this.tensorTrackersById.delete(e),t.tensorWrapper&&this.releaseTensor(t.tensorWrapper))}async ensureTensor(e,t,n,r,o){LS("verbose",(()=>"[WebNN] TensorManager.ensureTensor {tensorId: ".concat(t,", dataType: ").concat(n,", shape: ").concat(r,", copyOld: ").concat(o,"}")));let a=this.tensorTrackersById.get(t);if(!a)throw new Error("Tensor not found.");return a.ensureTensor(e,n,r,o)}upload(e,t){let n=this.tensorTrackersById.get(e);if(!n)throw new Error("Tensor not found.");n.upload(t)}async download(e,t){LS("verbose",(()=>"[WebNN] TensorManager.download {tensorId: ".concat(e,", dstBuffer: ").concat(null===t||void 0===t?void 0:t.byteLength,"}")));let n=this.tensorTrackersById.get(e);if(!n)throw new Error("Tensor not found.");return n.download(t)}releaseTensorsForSession(e){for(let t of this.freeTensors)t.sessionId===e&&t.destroy();this.freeTensors=this.freeTensors.filter((t=>t.sessionId!==e))}registerTensor(e,t,n,r){let o=this.getMLContext(e),a=JS(),i=new eE({sessionId:e,context:o,tensor:t,dataType:n,shape:r});return this.tensorTrackersById.set(a,new tE(this,i)),this.externalTensors.add(i),a}async getCachedTensor(e,t,n,r,o,a){let i=arguments.length>6&&void 0!==arguments[6]&&arguments[6],s=this.getMLContext(e);for(let[c,u]of this.freeTensors.entries())if(u.canReuseTensor(s,t,n)){LS("verbose",(()=>"[WebNN] Reusing tensor {dataType: ".concat(t,", shape: ").concat(n,"}")));let r=this.freeTensors.splice(c,1)[0];return r.sessionId=e,r}LS("verbose",(()=>"[WebNN] MLContext.createTensor {dataType: ".concat(t,", shape: ").concat(n,"}")));let l=await s.createTensor({dataType:t,shape:n,dimensions:n,usage:r,writable:o,readable:a});return new eE({sessionId:e,context:s,tensor:l,dataType:t,shape:n,shouldConvertInt64toInt32:i})}releaseTensor(e){this.externalTensors.has(e)&&this.externalTensors.delete(e),this.freeTensors.push(e)}},rE=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new nE(...t)}})),jz=pD((()=>{Iz(),Tz(),Nz(),Bz(),zz(),oE=new Map([[1,"float32"],[10,"float16"],[6,"int32"],[12,"uint32"],[7,"int64"],[13,"uint64"],[22,"int4"],[21,"uint4"],[3,"int8"],[2,"uint8"],[9,"uint8"]]),aE=(e,t)=>{if(e===t)return!0;if(void 0===e||void 0===t)return!1;let n=Object.keys(e).sort(),r=Object.keys(t).sort();return n.length===r.length&&n.every(((n,o)=>n===r[o]&&e[n]===t[n]))},iE=class{constructor(e){this.tensorManager=rE(this),this.mlContextBySessionId=new Map,this.sessionIdsByMLContext=new Map,this.mlContextCache=[],this.sessionGraphInputs=new Map,this.temporaryGraphInputs=[],this.temporarySessionTensorIds=new Map,BS(e.logLevel,!!e.debug)}get currentSessionId(){if(void 0===this.activeSessionId)throw new Error("No active session");return this.activeSessionId}onRunStart(e){LS("verbose",(()=>"[WebNN] onRunStart {sessionId: ".concat(e,"}"))),this.activeSessionId=e}onRunEnd(e){LS("verbose",(()=>"[WebNN] onRunEnd {sessionId: ".concat(e,"}")));let t=this.temporarySessionTensorIds.get(e);if(t){for(let e of t)LS("verbose",(()=>"[WebNN] releasing temporary tensor {tensorId: ".concat(e,"}"))),this.tensorManager.releaseTensorId(e);this.temporarySessionTensorIds.delete(e),this.activeSessionId=void 0}}async createMLContext(e){if(e instanceof GPUDevice){let t=this.mlContextCache.findIndex((t=>t.gpuDevice===e));if(-1!==t)return this.mlContextCache[t].mlContext;{let t=await navigator.ml.createContext(e);return this.mlContextCache.push({gpuDevice:e,mlContext:t}),t}}if(void 0===e){let e=this.mlContextCache.findIndex((e=>void 0===e.options&&void 0===e.gpuDevice));if(-1!==e)return this.mlContextCache[e].mlContext;{let e=await navigator.ml.createContext();return this.mlContextCache.push({mlContext:e}),e}}let t=this.mlContextCache.findIndex((t=>aE(t.options,e)));if(-1!==t)return this.mlContextCache[t].mlContext;{let t=await navigator.ml.createContext(e);return this.mlContextCache.push({options:e,mlContext:t}),t}}registerMLContext(e,t){this.mlContextBySessionId.set(e,t);let n=this.sessionIdsByMLContext.get(t);n||(n=new Set,this.sessionIdsByMLContext.set(t,n)),n.add(e),this.temporaryGraphInputs.length>0&&(this.sessionGraphInputs.set(e,this.temporaryGraphInputs),this.temporaryGraphInputs=[])}onReleaseSession(e){this.sessionGraphInputs.delete(e);let t=this.mlContextBySessionId.get(e);if(!t)return;this.tensorManager.releaseTensorsForSession(e),this.mlContextBySessionId.delete(e);let n=this.sessionIdsByMLContext.get(t);if(n.delete(e),0===n.size){this.sessionIdsByMLContext.delete(t);let e=this.mlContextCache.findIndex((e=>e.mlContext===t));-1!==e&&this.mlContextCache.splice(e,1)}}getMLContext(e){return this.mlContextBySessionId.get(e)}reserveTensorId(){return this.tensorManager.reserveTensorId()}releaseTensorId(e){LS("verbose",(()=>"[WebNN] releaseTensorId {tensorId: ".concat(e,"}"))),this.tensorManager.releaseTensorId(e)}async ensureTensor(e,t,n,r,o){let a=oE.get(n);if(!a)throw new Error("Unsupported ONNX data type: ".concat(n));return this.tensorManager.ensureTensor(null!==e&&void 0!==e?e:this.currentSessionId,t,a,r,o)}async createTemporaryTensor(e,t,n){LS("verbose",(()=>"[WebNN] createTemporaryTensor {onnxDataType: ".concat(t,", shape: ").concat(n,"}")));let r=oE.get(t);if(!r)throw new Error("Unsupported ONNX data type: ".concat(t));let o=this.tensorManager.reserveTensorId();await this.tensorManager.ensureTensor(e,o,r,n,!1);let a=this.temporarySessionTensorIds.get(e);return a?a.push(o):this.temporarySessionTensorIds.set(e,[o]),o}uploadTensor(e,t){if(!hS().shouldTransferToMLTensor)throw new Error("Trying to upload to a MLTensor while shouldTransferToMLTensor is false");LS("verbose",(()=>"[WebNN] uploadTensor {tensorId: ".concat(e,", data: ").concat(t.byteLength,"}"))),this.tensorManager.upload(e,t)}async downloadTensor(e,t){return this.tensorManager.download(e,t)}createMLTensorDownloader(e,t){return async()=>{let n=await this.tensorManager.download(e);return KS(n,t)}}registerMLTensor(e,t,n,r){let o=oE.get(n);if(!o)throw new Error("Unsupported ONNX data type: ".concat(n));let a=this.tensorManager.registerTensor(e,t,o,r);return LS("verbose",(()=>"[WebNN] registerMLTensor {tensor: ".concat(t,", dataType: ").concat(o,", dimensions: ").concat(r,"} -> {tensorId: ").concat(a,"}"))),a}registerMLConstant(e,t,n,r,o,a){let i=arguments.length>6&&void 0!==arguments[6]&&arguments[6];if(!a)throw new Error("External mounted files are not available.");let s=e;e.startsWith("./")&&(s=e.substring(2));let l=a.get(s);if(!l)throw new Error("File with name ".concat(s," not found in preloaded files."));if(t+n>l.byteLength)throw new Error("Out of bounds: data offset and length exceed the external file data size.");let c,u=l.slice(t,t+n).buffer;switch(o.dataType){case"float32":c=new Float32Array(u);break;case"float16":c=typeof Float16Array<"u"&&Float16Array.from?new Float16Array(u):new Uint16Array(u);break;case"int32":c=new Int32Array(u);break;case"uint32":c=new Uint32Array(u);break;case"int64":i?(c=ZS(new Uint8Array(u),!1),o.dataType="int32"):c=new BigInt64Array(u);break;case"uint64":c=new BigUint64Array(u);break;case"int8":c=new Int8Array(u);break;case"int4":case"uint4":case"uint8":c=new Uint8Array(u);break;default:throw new Error("Unsupported data type: ".concat(o.dataType," in creating WebNN Constant from external data."))}return LS("verbose",(()=>"[WebNN] registerMLConstant {dataType: ".concat(o.dataType,", shape: ").concat(o.shape,"}} ").concat(i?"(Note: it was int64 data type and registered to int32 as workaround)":""))),r.constant(o,c)}registerGraphInput(e){this.temporaryGraphInputs.push(e)}isGraphInput(e,t){let n=this.sessionGraphInputs.get(e);return!!n&&n.includes(t)}isInt64Supported(e){var t;return!(null===(t=this.mlContextBySessionId.get(e))||void 0===t||!t.opSupportLimits().input.dataTypes.includes("int64"))}flush(){}}})),Lz=pD((()=>{})),Rz=pD((()=>{zz(),Lz(),sE=new Map([[64,250],[128,200],[256,200],[512,200],[2048,230],[4096,200],[8192,50],[16384,50],[32768,50],[65536,50],[131072,50],[262144,50],[524288,50],[1048576,50],[2097152,30],[4194304,20],[8388608,10],[12582912,10],[16777216,10],[26214400,15],[33554432,22],[44236800,2],[58982400,6],[67108864,6],[134217728,6],[167772160,6]]),lE=[],cE=e=>16*Math.ceil(Number(e)/16),uE=e=>{for(let t=0;t<lE.length;t++){let n=lE[t];if(e<=n)return n}return 16*Math.ceil(e/16)},dE=1,pE=()=>dE++,hE=async(e,t,n,r)=>{let o=cE(n),a=e.device.createBuffer({size:o,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ});try{let i=e.getCommandEncoder();e.endComputePass(),i.copyBufferToBuffer(t,0,a,0,o),e.flush(),await a.mapAsync(GPUMapMode.READ);let s=a.getMappedRange();if(r){let e=r();return e.set(new Uint8Array(s,0,n)),e}return new Uint8Array(s.slice(0,n))}finally{a.destroy()}},fE=class{constructor(e){this.backend=e,this.storageCache=new Map,this.freeBuffers=new Map,this.freeUniformBuffers=new Map,this.buffersPending=[],this.capturedPendingBuffers=new Map;for(let[t]of sE)lE.push(t),this.freeBuffers.set(t,[]),this.freeUniformBuffers.set(t,[]);this.sessionCount=0}upload(e,t){let n=t.buffer,r=t.byteOffset,o=t.byteLength,a=cE(o),i=this.storageCache.get(e);if(!i)throw new Error("gpu data for uploading does not exist");if(Number(i.originalSize)!==o)throw new Error("inconsistent data size. gpu data size=".concat(i.originalSize,", data size=").concat(o));let s=this.backend.device.createBuffer({mappedAtCreation:!0,size:a,usage:GPUBufferUsage.MAP_WRITE|GPUBufferUsage.COPY_SRC}),l=s.getMappedRange();new Uint8Array(l).set(new Uint8Array(n,r,o)),s.unmap();let c=this.backend.device.createCommandEncoder();c.copyBufferToBuffer(s,0,i.gpuData.buffer,0,a),this.backend.device.queue.submit([c.finish()]),s.destroy(),LS("verbose",(()=>"[WebGPU] GpuDataManager.upload(id=".concat(e,")")))}memcpy(e,t){let n=this.storageCache.get(e);if(!n)throw new Error("source gpu data for memcpy does not exist");let r=this.storageCache.get(t);if(!r)throw new Error("destination gpu data for memcpy does not exist");if(n.originalSize!==r.originalSize)throw new Error("inconsistent source and destination gpu data size");let o=cE(n.originalSize),a=this.backend.getCommandEncoder();this.backend.endComputePass(),a.copyBufferToBuffer(n.gpuData.buffer,0,r.gpuData.buffer,0,o)}registerExternalBuffer(e,t,n){let r;if(n){if(r=n[0],e===n[1])return LS("verbose",(()=>"[WebGPU] GpuDataManager.registerExternalBuffer(size=".concat(t,") => id=").concat(r,", buffer is the same, skip."))),r;if(this.backend.capturedCommandList.has(this.backend.currentSessionId))throw new Error("Registering a different external buffer under graph capture mode is not supported yet.\n             Please use the previous external buffer!")}else r=pE();return this.storageCache.set(r,{gpuData:{id:r,type:0,buffer:e},originalSize:t}),LS("verbose",(()=>"[WebGPU] GpuDataManager.registerExternalBuffer(size=".concat(t,") => id=").concat(r,", registered."))),r}unregisterExternalBuffer(e){void 0!==e&&(this.storageCache.delete(e),LS("verbose",(()=>"[WebGPU] GpuDataManager.unregisterExternalBuffer() => id=".concat(e))))}create(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST,r=uE(e),o=(n&GPUBufferUsage.STORAGE)===GPUBufferUsage.STORAGE,a=(n&GPUBufferUsage.UNIFORM)===GPUBufferUsage.UNIFORM;if(o||a){let e=(o?this.freeBuffers:this.freeUniformBuffers).get(r);t=e&&e.length>0?e.pop():this.backend.device.createBuffer({size:r,usage:n})}else t=this.backend.device.createBuffer({size:r,usage:n});let i={id:pE(),type:0,buffer:t};return this.storageCache.set(i.id,{gpuData:i,originalSize:Number(e)}),LS("verbose",(()=>"[WebGPU] GpuDataManager.create(size=".concat(e,") => id=").concat(i.id))),i}get(e){var t;return null===(t=this.storageCache.get(e))||void 0===t?void 0:t.gpuData}release(e){let t="bigint"==typeof e?Number(e):e,n=this.storageCache.get(t);if(!n){if(0===this.storageCache.size)return 0;throw new Error("releasing data does not exist")}return LS("verbose",(()=>"[WebGPU] GpuDataManager.release(id=".concat(t,"), gpuDataId=").concat(n.gpuData.id))),this.storageCache.delete(t),this.buffersPending.push(n.gpuData.buffer),n.originalSize}async download(e,t){let n=this.storageCache.get(Number(e));if(!n)throw new Error("data does not exist");await hE(this.backend,n.gpuData.buffer,n.originalSize,t)}refreshPendingBuffers(){if(0!==this.buffersPending.length)if("default"===this.backend.sessionStatus){for(let e of this.buffersPending){let t=sE.get(e.size);if((e.usage&GPUBufferUsage.STORAGE)===GPUBufferUsage.STORAGE){let n=this.freeBuffers.get(e.size)||[];void 0===t||n.length>=t?e.destroy():n.push(e)}else if((e.usage&GPUBufferUsage.UNIFORM)===GPUBufferUsage.UNIFORM){let n=this.freeUniformBuffers.get(e.size)||[];void 0===t||n.length>=t?e.destroy():n.push(e)}else e.destroy()}this.buffersPending=[]}else{let e=this.capturedPendingBuffers.get(this.backend.currentSessionId);e||(e=[],this.capturedPendingBuffers.set(this.backend.currentSessionId,e));for(let t of this.buffersPending)e.push(t);this.buffersPending=[]}}dispose(){this.freeBuffers.forEach((e=>{e.forEach((e=>{e.destroy()}))})),this.freeUniformBuffers.forEach((e=>{e.forEach((e=>{e.destroy()}))})),this.storageCache.forEach((e=>{e.gpuData.buffer.destroy()})),this.capturedPendingBuffers.forEach((e=>{e.forEach((e=>{e.destroy()}))})),this.storageCache=new Map,this.freeBuffers=new Map,this.freeUniformBuffers=new Map,this.capturedPendingBuffers=new Map}onCreateSession(){this.sessionCount+=1}onReleaseSession(e){let t=this.capturedPendingBuffers.get(e);t&&(t.forEach((e=>{e.destroy()})),this.capturedPendingBuffers.delete(e)),this.sessionCount-=1,0===this.sessionCount&&(LS("warning",(()=>"[WebGPU] Clearing webgpu buffer cache")),this.storageCache.forEach((e=>{e.gpuData.buffer.destroy()})),this.storageCache=new Map)}},mE=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new fE(...t)}})),Vz=pD((()=>{gE=class{constructor(e){Object.assign(this,e)}get cacheKey(){return this.key||(this.key=Object.getOwnPropertyNames(this).sort().map((e=>"".concat(this[e]))).join(";")),this.key}},_E=e=>new gE(e)})),qz=pD((()=>{Iz(),Oz(),vE=64,yE=(e,t)=>{if(3===t)throw new Error("vec3 has same alignment as vec4, use vec4 instead");switch(Number(e)){case 10:return t>1?"vec".concat(t,"<f16>"):"f16";case 1:return t>1?"vec".concat(t,"<f32>"):"f32";case 6:return t>1?"vec".concat(t,"<i32>"):"i32";case 12:return t>1?"vec".concat(t,"<u32>"):"u32";case 7:if(t>1)throw new Error("currently not supported vecX of uint64 yet");return["vec2<u32>","i32"];case 13:if(t>1)throw new Error("currently not supported vecX of uint64 yet");return["vec2<u32>","u32"];case 9:if(4!==t)throw new Error("bool must be vec4");return["u32","vec4<bool>"];case 22:return"i32";case 21:return"u32";default:throw new Error("Unknown data type: ".concat(e))}},wE=function(e){let t=yE(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:1);return"string"==typeof t?t:t[0]},bE=function(e){let t=yE(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:1);return"string"==typeof t?t:t[1]},xE=function(){let e=[];for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return n.forEach((t=>{0!==t.length&&e.push({type:12,data:t},{type:12,data:qS.computeStrides(t)})})),e},kE=e=>e%4===0?4:e%2===0?2:1,CE=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"f32",t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"0";return t&&1!==t?"vec".concat(t,"<").concat(e,">(").concat(n,")"):"".concat(e,"(").concat(n,")")},DE=(e,t,n)=>"f32"===e?n:1===t?"f32(".concat(n,")"):"vec".concat(t,"<f32>(").concat(n,")"),SE=(e,t)=>4===t?"(".concat(e,".x + ").concat(e,".y + ").concat(e,".z + ").concat(e,".w)"):2===t?"(".concat(e,".x + ").concat(e,".y)"):3===t?"(".concat(e,".x + ").concat(e,".y + ").concat(e,".z)"):e,EE=(e,t,n,r)=>e.startsWith("uniforms.")&&n>4?"string"==typeof t?"f16"===r?"".concat(e,"[(").concat(t,") / 8][(").concat(t,") % 8 / 4][(").concat(t,") % 8 % 4]"):"".concat(e,"[(").concat(t,") / 4][(").concat(t,") % 4]"):"f16"===r?"".concat(e,"[").concat(Math.floor(t/8),"][").concat(Math.floor(t%8/4),"][").concat(t%8%4,"]"):"".concat(e,"[").concat(Math.floor(t/4),"][").concat(t%4,"]"):n>1?"".concat(e,"[").concat(t,"]"):e,TE=(e,t,n,r,o)=>{let a="number"==typeof n,i=a?n:n.length,s=[...new Array(i).keys()],l=i<2?"u32":i<=4?"vec".concat(i,"<u32>"):"array<u32, ".concat(i,">"),c=yE(t,o),u="string"==typeof c?c:c[1],d="string"==typeof c?c:c[0],p={indices:l,value:u,storage:d,tensor:t},h=e=>"string"==typeof e?e:"".concat(e,"u"),f={offsetToIndices:!1,indicesToOffset:!1,broadcastedIndicesToOffset:!1,set:!1,setByIndices:!1,get:!1,getByIndices:!1},m=a?"uniforms.":"",g="".concat(m).concat(e,"_shape"),_="".concat(m).concat(e,"_strides"),v="";for(let F=0;F<i-1;F++)v+="\n    let dim".concat(F," = current / ").concat(EE(_,F,i),";\n    let rest").concat(F," = current % ").concat(EE(_,F,i),";\n    indices[").concat(F,"] = dim").concat(F,";\n    current = rest").concat(F,";\n    ");v+="indices[".concat(i-1,"] = current;");let y=i<2?"":"\n  fn o2i_".concat(e,"(offset: u32) -> ").concat(p.indices," {\n    var indices: ").concat(p.indices,";\n    var current = offset;\n    ").concat(v,"\n    return indices;\n  }"),w=[];if(i>=2)for(let F=i-1;F>=0;F--)w.push("".concat(EE(_,F,i)," * (indices[").concat(F,"])"));let b=i<2?"":"\n  fn i2o_".concat(e,"(indices: ").concat(p.indices,") -> u32 {\n    return ").concat(w.join("+"),";\n  }"),x=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return 0===i?"0u":"".concat(p.indices,"(").concat(t.map(h).join(","),")")},k=(e,t)=>"".concat(i<2?e:EE(e,t,i)),C={},D=(t,n)=>(()=>{if(p.storage===p.value)return"".concat(e,"[").concat(t,"]=").concat(n,";");if("vec2<u32>"===p.storage&&"i32"===p.value)return"".concat(e,"[").concat(t,"]=vec2<u32>(u32(").concat(n,"), select(0u, 0xFFFFFFFFu, ").concat(n," < 0));");if("vec2<u32>"===p.storage&&"u32"===p.value)return"".concat(e,"[").concat(t,"]=vec2<u32>(u32(").concat(n,"), 0u);");if("u32"===p.storage&&"vec4<bool>"===p.value)return"".concat(e,"[").concat(t,"]=dot(vec4<u32>(0x1, 0x100, 0x10000, 0x1000000), vec4<u32>(").concat(n,"));");throw new Error("not supported combination of storage type ".concat(p.storage," and value type ").concat(p.value," yet"))})(),S=t=>(()=>{if(p.storage===p.value)return"".concat(e,"[").concat(t,"]");if("vec2<u32>"===p.storage&&"i32"===p.value)return"i32(".concat(e,"[").concat(t,"].x)");if("vec2<u32>"===p.storage&&"u32"===p.value)return"u32(".concat(e,"[").concat(t,"].x)");if("u32"===p.storage&&"vec4<bool>"===p.value)return"vec4<bool>(bool(".concat(e,"[").concat(t,"] & 0xFFu), bool(").concat(e,"[").concat(t,"] & 0xFF00u), bool(").concat(e,"[").concat(t,"] & 0xFF0000u), bool(").concat(e,"[").concat(t,"] & 0xFF000000u))");throw new Error("not supported combination of storage type ".concat(p.storage," and value type ").concat(p.value," yet"))})(),E=i<2?"":"\n  fn get_".concat(e,"ByIndices(indices: ").concat(p.indices,") -> ").concat(u," {\n    return ").concat(S("i2o_".concat(e,"(indices)")),";\n  }"),T=i<2?"":(()=>{let t=s.map((e=>"d".concat(e,": u32"))).join(", "),n=s.map((e=>"d".concat(e))).join(", ");return"\n  fn get_".concat(e,"(").concat(t,") -> ").concat(u," {\n    return get_").concat(e,"ByIndices(").concat(x(n),");\n  }")})(),A=i<2?"":"\n  fn set_".concat(e,"ByIndices(indices: ").concat(p.indices,", value: ").concat(u,") {\n    ").concat(D("i2o_".concat(e,"(indices)"),"value"),"\n  }"),M=i<2?"":(()=>{let t=s.map((e=>"d".concat(e,": u32"))).join(", "),n=s.map((e=>"d".concat(e))).join(", ");return"\n  fn set_".concat(e,"(").concat(t,", value: ").concat(u,") {\n    set_").concat(e,"ByIndices(").concat(x(n),", value);\n  }")})();return{impl:()=>{let e=[],t=!1;return f.offsetToIndices&&(e.push(y),t=!0),f.indicesToOffset&&(e.push(b),t=!0),f.broadcastedIndicesToOffset&&(Object.values(C).forEach((t=>e.push(t))),t=!0),f.set&&(e.push(M),t=!0),f.setByIndices&&(e.push(A),t=!0),f.get&&(e.push(T),t=!0),f.getByIndices&&(e.push(E),t=!0),!a&&t&&e.unshift("const ".concat(g," = ").concat(p.indices,"(").concat(n.join(","),");"),"const ".concat(_," = ").concat(p.indices,"(").concat(qS.computeStrides(n).join(","),");")),e.join("\n")},type:p,offsetToIndices:t=>(f.offsetToIndices=!0,i<2?t:"o2i_".concat(e,"(").concat(t,")")),indicesToOffset:t=>(f.indicesToOffset=!0,i<2?t:"i2o_".concat(e,"(").concat(t,")")),broadcastedIndicesToOffset:(t,n)=>{f.broadcastedIndicesToOffset=!0;let r="".concat(n.name,"broadcastedIndicesTo").concat(e,"Offset");if(r in C)return"".concat(r,"(").concat(t,")");let o=[];for(let e=i-1;e>=0;e--){let t=n.indicesGet("outputIndices",e+n.rank-i);o.push("".concat(k(_,e)," * (").concat(t," % ").concat(k(g,e),")"))}return C[r]="fn ".concat(r,"(outputIndices: ").concat(n.type.indices,") -> u32 {\n             return ").concat(o.length>0?o.join("+"):"0u",";\n           }"),"".concat(r,"(").concat(t,")")},indices:x,indicesGet:k,indicesSet:(e,t,n)=>i<2?"".concat(e,"=").concat(n,";"):"".concat(EE(e,t,i),"=").concat(n,";"),set:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];if(n.length!==i+1)throw new Error("indices length must be ".concat(i));let o=n[i];if("string"!=typeof o)throw new Error("value must be string");let a=n.slice(0,i).map(h).join(",");return 0===i?D("0u",o):1===i?D(a[0],o):(f.set=!0,f.setByIndices=!0,f.indicesToOffset=!0,"set_".concat(e,"(").concat(a,", ").concat(o,")"))},setByOffset:D,setByIndices:(t,n)=>i<2?D(t,n):(f.setByIndices=!0,f.indicesToOffset=!0,"set_".concat(e,"ByIndices(").concat(t,", ").concat(n,");")),get:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];if(n.length!==i)throw new Error("indices length must be ".concat(i));let o=n.map(h).join(",");return 0===i?S("0u"):1===i?S(o[0]):(f.get=!0,f.getByIndices=!0,f.indicesToOffset=!0,"get_".concat(e,"(").concat(o,")"))},getByOffset:S,getByIndices:t=>i<2?S(t):(f.getByIndices=!0,f.indicesToOffset=!0,"get_".concat(e,"ByIndices(").concat(t,")")),usage:r,name:e,strides:_,shape:g,rank:i}},AE=function(e,t,n){return TE(e,t,n,"input",arguments.length>3&&void 0!==arguments[3]?arguments[3]:1)},ME=function(e,t,n){return TE(e,t,n,"output",arguments.length>3&&void 0!==arguments[3]?arguments[3]:1)},FE=(e,t,n)=>TE(e,t,n,"atomicOutput",1),IE=function(e,t,n){return TE(e,t,n,"internal",arguments.length>3&&void 0!==arguments[3]?arguments[3]:1)},PE=class{constructor(e,t){this.normalizedDispatchGroup=e,this.limits=t,this.internalVariables=[],this.variables=[],this.uniforms=[],this.variableIndex=0}guardAgainstOutOfBoundsWorkgroupSizes(e){return"if (global_idx >= ".concat("number"==typeof e?"".concat(e,"u"):e,") { return; }")}mainStart(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:vE,t="number"==typeof e?e:e[0],n="number"==typeof e?1:e[1],r="number"==typeof e?1:e[2];if(t>this.limits.maxComputeWorkgroupSizeX||n>this.limits.maxComputeWorkgroupSizeY||r>this.limits.maxComputeWorkgroupSizeZ)throw new Error("workgroup size [".concat(t,", ").concat(n,", ").concat(r,"] exceeds the maximum workgroup size [").concat(this.limits.maxComputeWorkgroupSizeX,", ").concat(this.limits.maxComputeWorkgroupSizeY,", ").concat(this.limits.maxComputeWorkgroupSizeZ,"]."));if(t*n*r>this.limits.maxComputeInvocationsPerWorkgroup)throw new Error("workgroup size [".concat(t,", ").concat(n,", ").concat(r,"] exceeds the maximum workgroup invocations ").concat(this.limits.maxComputeInvocationsPerWorkgroup,"."));let o=1===this.normalizedDispatchGroup[1]&&1===this.normalizedDispatchGroup[2],a=o?"@builtin(global_invocation_id) global_id : vec3<u32>,\n    @builtin(workgroup_id) workgroup_id : vec3<u32>,\n    @builtin(local_invocation_index) local_idx : u32,\n    @builtin(local_invocation_id) local_id : vec3<u32>":"@builtin(global_invocation_id) global_id : vec3<u32>,\n                                             @builtin(local_invocation_id) local_id : vec3<u32>,\n    @builtin(local_invocation_index) local_idx : u32,\n    @builtin(workgroup_id) workgroup_id : vec3<u32>,\n    @builtin(num_workgroups) num_workgroups : vec3<u32>",i=o?"let global_idx = global_id.x;\n         let workgroup_index = workgroup_id.x;":"let workgroup_index = workgroup_id.z * num_workgroups[0] * num_workgroups[1] +\n             workgroup_id.y * num_workgroups[0] + workgroup_id.x;\n         let global_idx = workgroup_index * ".concat(t*n*r,"u + local_idx;");return"@compute @workgroup_size(".concat(t,", ").concat(n,", ").concat(r,")\n  fn main(").concat(a,") {\n    ").concat(i,"\n  ")}appendVariableUniforms(e){0!==e.rank&&(e.shape.startsWith("uniforms.")&&this.uniforms.push({name:e.shape.replace("uniforms.",""),type:"u32",length:e.rank}),e.strides.startsWith("uniforms.")&&this.uniforms.push({name:e.strides.replace("uniforms.",""),type:"u32",length:e.rank}))}declareVariable(e,t){if("internal"===e.usage)throw new Error("cannot use internal variable with declareVariable(). use registerInternalVariables() instead.");this.variables.push(e),this.appendVariableUniforms(e);let n="input"===e.usage?"read":"read_write",r="atomicOutput"===e.usage?"atomic<i32>":e.type.storage;return"@group(0) @binding(".concat(t,") var<storage, ").concat(n,"> ").concat(e.name,": array<").concat(r,">;")}declareVariables(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.map((e=>this.declareVariable(e,this.variableIndex++))).join("\n")}registerInternalVariable(e){if("internal"!==e.usage)throw new Error("cannot use input or output variable with registerInternalVariable(). use declareVariables() instead.");this.internalVariables.push(e),this.appendVariableUniforms(e)}registerInternalVariables(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.forEach((e=>this.registerInternalVariable(e))),this}registerUniform(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return this.uniforms.push({name:e,type:t,length:n}),this}registerUniforms(e){return this.uniforms=this.uniforms.concat(e),this}uniformDeclaration(){if(0===this.uniforms.length)return"";let e=[];for(let{name:t,type:n,length:r}of this.uniforms)if(r&&r>4)"f16"===n?e.push("@align(16) ".concat(t,":array<mat2x4<").concat(n,">, ").concat(Math.ceil(r/8),">")):e.push("".concat(t,":array<vec4<").concat(n,">, ").concat(Math.ceil(r/4),">"));else{let o=null==r||1===r?n:"vec".concat(r,"<").concat(n,">");e.push("".concat(t,":").concat(o))}return"\n      struct Uniforms { ".concat(e.join(", ")," };\n      @group(0) @binding(").concat(this.variableIndex,") var<uniform> uniforms: Uniforms;")}get additionalImplementations(){return this.uniformDeclaration()+this.variables.map((e=>e.impl())).join("\n")+this.internalVariables.map((e=>e.impl())).join("\n")}get variablesInfo(){if(0===this.uniforms.length)return;let e=e=>[12,10,1,6][["u32","f16","f32","i32"].indexOf(e)];return this.uniforms.map((t=>{var n;return[e(t.type),null!==(n=t.length)&&void 0!==n?n:1]}))}},zE=(e,t)=>new PE(e,t)})),Uz=pD((()=>{Iz(),Oz(),Vz(),qz(),OE=(e,t)=>{if(!e||1!==e.length)throw new Error("Transpose requires 1 input.");if(0!==t.length&&t.length!==e[0].dims.length)throw new Error("perm size ".concat(t.length," does not match input rank ").concat(e[0].dims.length))},NE=(e,t)=>0!==t.length?t:[...new Array(e).keys()].reverse(),BE=(e,t)=>qS.sortBasedOnPerm(e,NE(e.length,t)),jE=(e,t,n,r)=>{let o="fn perm(i: ".concat(r.type.indices,") -> ").concat(n.type.indices," {\n    var a: ").concat(n.type.indices,";");for(let a=0;a<t;++a)o+="a[".concat(e[a],"]=i[").concat(a,"];");return o+"return a;}"},LE=(e,t)=>{let n=[],r=[];for(let o=0;o<e.length;++o)1!==e[o]&&n.push(e[o]),1!==e[t[o]]&&r.push(t[o]);return{newShape:n,newPerm:r}},RE=(e,t)=>{let n=0;for(let r=0;r<e.length;++r)if(1!==t[e[r]]){if(e[r]<n)return!1;n=e[r]}return!0},VE=(e,t)=>{let n,r=e.dataType,o=e.dims.length,a=NE(o,t),i=BE(e.dims,a),s=e.dims,l=i;if(o<2||RE(a,e.dims))return n=e=>{let t=AE("input",r,s,4),n=ME("output",r,l,4);return"\n  ".concat(e.registerUniform("output_size","u32").declareVariables(t,n),"\n  ").concat(e.mainStart(),"\n    ").concat(e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size"),"\n    output[global_idx] = input[global_idx];\n  }")},{name:"TransposeCopy",shaderCache:{inputDependencies:["type"]},getRunData:()=>{let t=qS.size(i);return{outputs:[{dims:i,dataType:e.dataType}],dispatchGroup:{x:Math.ceil(t/64/4)},programUniforms:[{type:12,data:Math.ceil(t/4)}]}},getShaderSource:n};let{newShape:c,newPerm:u}=LE(e.dims,a),d=qS.areEqual(u,[2,3,1]),p=qS.areEqual(u,[3,1,2]);if(2===c.length||d||p){s=d?[c[0],c[1]*c[2]]:p?[c[0]*c[1],c[2]]:c,l=[s[1],s[0]];let t=16;return n=e=>{let n=AE("a",r,s.length),o=ME("output",r,l.length);return"\n  ".concat(e.registerUniform("output_size","u32").declareVariables(n,o),"\n  var<workgroup> tile : array<array<").concat(o.type.value,", ").concat(t+1,">, ").concat(t,">;\n  ").concat(e.mainStart([t,t,1]),"\n    let stride = (uniforms.output_shape[1] - 1) / ").concat(t," + 1;\n    let workgroup_id_x = workgroup_index % stride;\n    let workgroup_id_y = workgroup_index / stride;\n    let input_col = workgroup_id_y * ").concat(t,"u + local_id.x;\n    let input_row = workgroup_id_x * ").concat(t,"u + local_id.y;\n    if (input_row < uniforms.a_shape[0] && input_col < uniforms.a_shape[1]) {\n      tile[local_id.y][local_id.x] = ").concat(n.getByIndices("".concat(n.type.indices,"(input_row, input_col)")),";\n    }\n    workgroupBarrier();\n\n    let output_col = workgroup_id_x * ").concat(t,"u + local_id.x;\n    let output_row = workgroup_id_y * ").concat(t,"u + local_id.y;\n    if (output_row < uniforms.output_shape[0] && output_col < uniforms.output_shape[1]) {\n      ").concat(o.setByIndices("".concat(o.type.indices,"(output_row, output_col)"),"tile[local_id.x][local_id.y]"),"\n    }\n  }")},{name:"TransposeShared",shaderCache:{inputDependencies:["type"]},getRunData:()=>{let n=qS.size(i);return{outputs:[{dims:i,dataType:e.dataType}],dispatchGroup:{x:Math.ceil(l[1]/t),y:Math.ceil(l[0]/t)},programUniforms:[{type:12,data:n},...xE(s,l)]}},getShaderSource:n}}return n=e=>{let t=AE("a",r,s.length),n=ME("output",r,l.length);return"\n  ".concat(e.registerUniform("output_size","u32").declareVariables(t,n),"\n\n  ").concat(jE(a,o,t,n),"\n\n  ").concat(e.mainStart(),"\n    ").concat(e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size"),"\n\n    let indices = ").concat(n.offsetToIndices("global_idx"),";\n    let aIndices = perm(indices);\n\n    ").concat(n.setByOffset("global_idx",t.getByIndices("aIndices")),"\n  }")},{name:"Transpose",shaderCache:{hint:"".concat(t),inputDependencies:["rank"]},getRunData:()=>{let t=qS.size(i);return{outputs:[{dims:i,dataType:e.dataType}],dispatchGroup:{x:Math.ceil(t/64)},programUniforms:[{type:12,data:t},...xE(s,l)]}},getShaderSource:n}},qE=(e,t)=>{OE(e.inputs,t.perm),e.compute(VE(e.inputs[0],t.perm))},UE=e=>_E({perm:e.perm})})),Wz=pD((()=>{Iz(),Oz(),qz(),Gz(),Uz(),WE={max:"select(bestValue, candidate, candidate > bestValue)",min:"select(bestValue, candidate, candidate < bestValue)",mean:"bestValue + candidate",sum:"bestValue + candidate",prod:"bestValue * candidate",sumSquare:"bestValue + candidate * candidate",logSumExp:"bestValue + exp(candidate)",l1:"bestValue + abs(candidate)",l2:"bestValue + candidate * candidate",logSum:"bestValue + candidate"},GE={max:"select(bestValue, candidate, candidate > bestValue)",min:"select(bestValue, candidate, candidate < bestValue)",mean:"bestValue + candidate",sum:"bestValue + candidate",prod:"bestValue * candidate",sumSquare:"bestValue + candidate",logSumExp:"bestValue + candidate",l1:"bestValue + candidate",l2:"bestValue + candidate",logSum:"bestValue + candidate"},HE={max:"_A[offset]",min:"_A[offset]",mean:"0",sum:"0",prod:"1",sumSquare:"0",logSumExp:"0",l1:"0",l2:"0",logSum:"0"},KE={max:"bestValue",min:"bestValue",sum:"bestValue",prod:"bestValue",sumSquare:"bestValue",logSumExp:"log(bestValue)",l1:"bestValue",l2:"sqrt(bestValue)",logSum:"log(bestValue)"},ZE=(e,t)=>{let n=[];for(let r=t-e;r<t;++r)n.push(r);return n},$E=(e,t)=>{let n=[],r=e.length;for(let o=0;o<r;o++)-1===t.indexOf(o)&&n.push(e[o]);return[n,t.map((t=>e[t]))]},XE=(e,t)=>{let n=e.length+t.length,r=[],o=0;for(let a=0;a<n;a++)-1===t.indexOf(a)?r.push(e[o++]):r.push(1);return r},JE=(e,t)=>{for(let n=0;n<e.length;++n)if(e[e.length-n-1]!==t-1-n)return!1;return!0},QE=(e,t)=>{let n=[];if(!JE(e,t)){for(let r=0;r<t;++r)-1===e.indexOf(r)&&n.push(r);e.forEach((e=>n.push(e)))}return n},YE=(e,t,n,r,o,a,i)=>{let s=n[0].dims,l=qS.size(a),c=qS.size(i),u=AE("_A",n[0].dataType,s),d=ME("output",o,a),p=64;1===l&&(p=256);let h="\n          var<workgroup> aBestValues : array<f32, ".concat(p,">;\n       ");return{name:e,shaderCache:{hint:"".concat(t,";").concat(p),inputDependencies:["type"]},getShaderSource:e=>"\n        ".concat(e.registerUniform("reduceSize","u32").declareVariables(u,d),"\n        ").concat(h,"\n        fn DIV_CEIL(a : u32, b : u32) -> u32 {\n          return ((a - 1u) / b + 1u);\n         }\n         ").concat(e.mainStart(p),"\n\n          let outputIndex = global_idx / ").concat(p,";\n          let offset = outputIndex * uniforms.reduceSize;\n\n          var bestValue = f32(").concat(HE[r],");\n          let Length = uniforms.reduceSize;\n          for (var k = local_idx; k < Length; k = k + ").concat(p,") {\n           let candidate = f32(").concat(u.getByOffset("offset + k"),");\n           bestValue = ").concat(WE[r],";\n          }\n          aBestValues[local_idx] = bestValue;\n          workgroupBarrier();\n\n         var reduceSize = min(Length, ").concat(p,"u);\n         for (var currentSize = reduceSize / 2u; reduceSize > 1u;\n             currentSize = reduceSize / 2u) {\n           let interval = DIV_CEIL(reduceSize, 2u);\n           if (local_idx < currentSize) {\n            let candidate = aBestValues[local_idx + interval];\n            bestValue = ").concat(GE[r],";\n            aBestValues[local_idx] = bestValue;\n           }\n           reduceSize = interval;\n           workgroupBarrier();\n         }\n\n         if (local_idx == 0u) {\n          ").concat(d.setByOffset("outputIndex","".concat("mean"===r?"".concat(d.type.storage,"(bestValue / f32(uniforms.reduceSize))"):"".concat(d.type.storage,"(").concat(KE[r],")"))),";\n         }\n        }"),getRunData:()=>({outputs:[{dims:a,dataType:o}],dispatchGroup:{x:l},programUniforms:[{type:12,data:c}]})}},eT=(e,t,n,r)=>{let o=1===e.inputs.length?n:fT(e.inputs,n),a=o.axes;0===a.length&&!o.noopWithEmptyAxes&&(a=e.inputs[0].dims.map(((e,t)=>t)));let i=qS.normalizeAxes(a,e.inputs[0].dims.length),s=i,l=e.inputs[0],c=QE(s,e.inputs[0].dims.length);c.length>0&&(l=e.compute(VE(e.inputs[0],c),{inputs:[0],outputs:[-1]})[0],s=ZE(s.length,l.dims.length));let[u,d]=$E(l.dims,s),p=u;o.keepDims&&(p=XE(u,i)),e.compute(YE(t,o.cacheKey,[l],r,e.inputs[0].dataType,p,d),{inputs:[l]})},tT=(e,t)=>{eT(e,"ReduceMeanShared",t,"mean")},nT=(e,t)=>{eT(e,"ReduceL1Shared",t,"l1")},rT=(e,t)=>{eT(e,"ReduceL2Shared",t,"l2")},oT=(e,t)=>{eT(e,"ReduceLogSumExpShared",t,"logSumExp")},aT=(e,t)=>{eT(e,"ReduceMaxShared",t,"max")},iT=(e,t)=>{eT(e,"ReduceMinShared",t,"min")},sT=(e,t)=>{eT(e,"ReduceProdShared",t,"prod")},lT=(e,t)=>{eT(e,"ReduceSumShared",t,"sum")},cT=(e,t)=>{eT(e,"ReduceSumSquareShared",t,"sumSquare")},uT=(e,t)=>{eT(e,"ReduceLogSumShared",t,"logSum")}})),Gz=pD((()=>{Iz(),Oz(),Vz(),qz(),Wz(),dT=e=>{if(!e||0===e.length||e.length>2)throw new Error("Reduce op requires 1 or 2 inputs.");if(2===e.length&&1!==e[1].dims.length)throw new Error("Invalid axes input dims.")},pT=e=>["","","var value = ".concat(e.getByIndices("input_indices"),";"),""],hT=function(e,t,n,r,o,a){let i=arguments.length>6&&void 0!==arguments[6]&&arguments[6],s=arguments.length>7&&void 0!==arguments[7]&&arguments[7],l=[],c=n[0].dims,u=c.length,d=qS.normalizeAxes(o,u),p=!s&&0===d.length;c.forEach(((e,t)=>{p||d.indexOf(t)>=0?i&&l.push(1):l.push(e)}));let h=l.length,f=qS.size(l);return{name:e,shaderCache:t,getShaderSource:e=>{let t=[],o=AE("_A",n[0].dataType,u),s=ME("output",a,h),l=r(o,s,d),f=l[2];for(let n=0,r=0;n<u;n++)p||d.indexOf(n)>=0?(i&&r++,f="for(var j".concat(n,": u32 = 0; j").concat(n," < ").concat(c[n],"; j").concat(n,"++) {\n                  ").concat(l[2].includes("last_index")?"let last_index = j".concat(n,";"):"","\n                  ").concat(o.indicesSet("input_indices",n,"j".concat(n)),"\n                  ").concat(f,"\n                }")):(t.push("".concat(o.indicesSet("input_indices",n,s.indicesGet("output_indices",r)),";")),r++);return"\n\n        ".concat(e.registerUniform("output_size","u32").declareVariables(o,s),"\n\n        ").concat(e.mainStart(),"\n          ").concat(e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size"),"\n          var input_indices: ").concat(o.type.indices,";\n          let output_indices = ").concat(s.offsetToIndices("global_idx"),";\n\n          ").concat(t.join("\n"),"\n          ").concat(l[0],"       // init ops for reduce max/min\n          ").concat(l[1],"\n          ").concat(f,"\n          ").concat(l[3],"\n          ").concat(4===l.length?s.setByOffset("global_idx","value"):l.slice(4).join("\n"),"\n        }")},getRunData:()=>({outputs:[{dims:l,dataType:a}],dispatchGroup:{x:Math.ceil(f/64)},programUniforms:[{type:12,data:f},...xE(c,l)]})}},fT=(e,t)=>{let n=[];return e[1].dims[0]>0&&e[1].getBigInt64Array().forEach((e=>n.push(Number(e)))),_E({axes:n,keepDims:t.keepDims,noopWithEmptyAxes:t.noopWithEmptyAxes})},mT=(e,t,n,r)=>{let o=e.inputs,a=1===o.length?n:fT(o,n);e.compute(hT(t,{hint:a.cacheKey,inputDependencies:["rank"]},[o[0]],a.noopWithEmptyAxes&&0===a.axes.length?pT:r,a.axes,o[0].dataType,a.keepDims,a.noopWithEmptyAxes),{inputs:[0]})},gT=(e,t)=>{dT(e.inputs),mT(e,"ReduceLogSum",t,((e,t)=>["var value = ".concat(t.type.storage,"(0);"),"","value += ".concat(e.getByIndices("input_indices"),";"),"value = log(value);"]))},_T=(e,t)=>{dT(e.inputs),mT(e,"ReduceL1",t,((e,t)=>["var value = ".concat(t.type.storage,"(0);"),"","value += abs(".concat(e.getByIndices("input_indices"),");"),""]))},vT=(e,t)=>{dT(e.inputs),mT(e,"ReduceL2",t,((e,t)=>["var t = ".concat(t.type.value,"(0); var value = ").concat(t.type.value,"(0);"),"","t = ".concat(e.getByIndices("input_indices"),"; value += (t * t);"),"value = sqrt(value);"]))},yT=(e,t)=>{dT(e.inputs),mT(e,"ReduceLogSumExp",t,((e,t)=>["var value = ".concat(t.type.storage,"(0);"),"","value += exp(".concat(e.getByIndices("input_indices"),");"),"value = log(value);"]))},wT=(e,t)=>{dT(e.inputs),mT(e,"ReduceMax",t,((e,t,n)=>{let r=[];for(let o=0;o<e.rank;o++)(n.indexOf(o)>=0||0===n.length)&&r.push(e.indicesSet("input_indices",o,0));return["".concat(r.join("\n")),"var value = ".concat(e.getByIndices("input_indices"),";"),"value = max(value, ".concat(e.getByIndices("input_indices"),");"),""]}))},bT=(e,t)=>{dT(e.inputs),mT(e,"ReduceMean",t,((t,n,r)=>{let o=1;for(let a=0;a<t.rank;a++)(r.indexOf(a)>=0||0===r.length)&&(o*=e.inputs[0].dims[a]);return["var sum = f32(0);","","sum += f32(".concat(t.getByIndices("input_indices"),");"),"let value = ".concat(n.type.value,"(sum / ").concat(o,");")]}))},xT=(e,t)=>{dT(e.inputs),mT(e,"ReduceMin",t,((e,t,n)=>{let r=[];for(let o=0;o<e.rank;o++)(n.indexOf(o)>=0||0===n.length)&&r.push("input_indices[".concat(o,"] = 0;"));return["".concat(r.join("\n")),"var value = ".concat(e.getByIndices("input_indices"),";"),"value = min(value, ".concat(e.getByIndices("input_indices"),");"),""]}))},kT=(e,t)=>{dT(e.inputs),mT(e,"ReduceProd",t,((e,t)=>["var value = ".concat(t.type.storage,"(1);"),"","value *= ".concat(e.getByIndices("input_indices"),";"),""]))},CT=(e,t)=>{dT(e.inputs),mT(e,"ReduceSum",t,((e,t)=>["var value = ".concat(t.type.storage,"(0);"),"","value += ".concat(e.getByIndices("input_indices"),";"),""]))},DT=(e,t)=>{dT(e.inputs),mT(e,"ReduceSumSquare",t,((e,t)=>["var t = ".concat(t.type.value,"(0); var value = ").concat(t.type.value,"(0);"),"","t = ".concat(e.getByIndices("input_indices"),"; value += t * t;"),""]))},ST=(e,t,n)=>{if(0===t.length)return n;let r=1,o=1;for(let a=0;a<t.length;a++)-1===t.indexOf(a)?r*=e[a]:o*=e[a];return o<32&&r>1024},ET=(e,t)=>{ST(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?bT(e,t):tT(e,t)},TT=(e,t)=>{ST(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?_T(e,t):nT(e,t)},AT=(e,t)=>{ST(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?vT(e,t):rT(e,t)},MT=(e,t)=>{ST(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?yT(e,t):oT(e,t)},FT=(e,t)=>{ST(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?wT(e,t):aT(e,t)},IT=(e,t)=>{ST(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?xT(e,t):iT(e,t)},PT=(e,t)=>{ST(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?kT(e,t):sT(e,t)},zT=(e,t)=>{ST(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?CT(e,t):lT(e,t)},OT=(e,t)=>{ST(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?DT(e,t):cT(e,t)},NT=(e,t)=>{ST(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?gT(e,t):uT(e,t)}})),Hz=pD((()=>{Iz(),Vz(),Gz(),BT=e=>{if(!e||0===e.length||e.length>2)throw new Error("ArgMinMaxOp op requires 1 or 2 inputs.");if(1!==e[0].dataType)throw new Error("Invalid input type.")},jT=(e,t)=>{BT(e.inputs);e.compute(hT("ArgMin",{hint:t.cacheKey,inputDependencies:["rank"]},[e.inputs[0]],((e,n,r)=>{let o=[];for(let t=0;t<e.rank;t++)(r.indexOf(t)>=0||0===r.length)&&o.push("input_indices[".concat(t,"] = 0;"));return["".concat(o.join("\n")),"var value = ".concat(e.getByIndices("input_indices"),";\nvar best_index : i32 = 0;"),"if (".concat(e.getByIndices("input_indices")," ").concat(t.selectLastIndex>0?"<=":"<"," value) {\n         value = ").concat(e.getByIndices("input_indices"),";\n         best_index = i32(last_index);\n       }"),"",n.setByOffset("global_idx","best_index")]}),[t.axis],7,t.keepDims),{inputs:[0]})},LT=(e,t)=>{BT(e.inputs);e.compute(hT("argMax",{hint:t.cacheKey,inputDependencies:["rank"]},[e.inputs[0]],((e,n,r)=>{let o=[];for(let t=0;t<e.rank;t++)(r.indexOf(t)>=0||0===r.length)&&o.push("input_indices[".concat(t,"] = 0;"));return["".concat(o.join("\n")),"var value = ".concat(e.getByIndices("input_indices"),";\nvar best_index : i32 = 0;"),"if (".concat(e.getByIndices("input_indices")," ").concat(t.selectLastIndex>0?">=":">"," value) {\n         value = ").concat(e.getByIndices("input_indices"),";\n         best_index = i32(last_index);\n       }"),"",n.setByOffset("global_idx","best_index")]}),[t.axis],7,t.keepDims),{inputs:[0]})},RT=e=>_E(e)})),Kz=pD((()=>{Iz(),Oz(),Lz(),qz(),VT=(e,t)=>{let n=e[0],r=e[1],o=e[2],a=e[3],i=e[4],s=e[5];if(i&&s)throw new Error("Attention cannot have both past and attention_bias");if(3!==n.dims.length)throw new Error('Input "input" must have 3 dimensions');let l=n.dims[0],c=n.dims[1],u=n.dims[2];if(1!==o.dims.length)throw new Error('Input "bias" is expected to have 1 dimensions');if(2!==r.dims.length)throw new Error('Input "weights" is expected to have 2 dimensions');if(r.dims[0]!==u)throw new Error("Input 1 dimension 0 should have same length as dimension 2 of input 0");if(o.dims[0]!==r.dims[1])throw new Error('Input "bias" dimension 0 should have same length as dimension 1 of input "weights"');let d=o.dims[0]/3,p=d,h=p;if(t.qkvHiddenSizes.length>0){if(3!==t.qkvHiddenSizes.length)throw new Error("qkv_hidden_sizes attribute should have 3 elements");for(let e of t.qkvHiddenSizes)if(e%t.numHeads!==0)throw new Error("qkv_hidden_sizes should be divisible by num_heads");d=t.qkvHiddenSizes[0],p=t.qkvHiddenSizes[1],h=t.qkvHiddenSizes[2]}let f=c;if(d!==p)throw new Error("qkv_hidden_sizes first element should be same as the second");if(o.dims[0]!==d+p+h)throw new Error('Input "bias" dimension 0 should have same length as sum of Q/K/V hidden sizes');let m=0;if(i){if(p!==h)throw new Error('Input "past" expect k_hidden_size == v_hidden_size');if(5!==i.dims.length)throw new Error('Input "past" must have 5 dimensions');if(2!==i.dims[0])throw new Error('Input "past" first dimension must be 2');if(i.dims[1]!==l)throw new Error('Input "past" second dimension must be batch_size');if(i.dims[2]!==t.numHeads)throw new Error('Input "past" third dimension must be num_heads');if(i.dims[4]!==p/t.numHeads)throw new Error('Input "past" fifth dimension must be k_hidden_size / num_heads');t.pastPresentShareBuffer||(m=i.dims[3])}let g=f+m;if(a)throw new Error("Mask not supported");if(i)throw new Error("past is not supported");if(s){if(4!==s.dims.length)throw new Error('Input "attention_bias" must have 4 dimensions');if(s.dims[0]!==l||s.dims[1]!==t.numHeads||s.dims[2]!==c||s.dims[3]!==g)throw new Error('Expect "attention_bias" shape (batch_size, num_heads, sequence_length, total_sequence_length)')}return{batchSize:l,sequenceLength:c,pastSequenceLength:m,kvSequenceLength:f,totalSequenceLength:g,maxSequenceLength:-1,inputHiddenSize:u,hiddenSize:d,vHiddenSize:h,headSize:Math.floor(d/t.numHeads),vHeadSize:Math.floor(h/t.numHeads),numHeads:t.numHeads,isUnidirectional:!1,pastPresentShareBuffer:!1,maskFilterValue:t.maskFilterValue,maskType:0,scale:t.scale,broadcastResPosBias:!1,passPastInKv:!1,qkvFormat:1}},qT=(e,t,n)=>t&&e?"\n      let total_sequence_length_input = u32(".concat(t.getByOffset("0"),");\n      let present_sequence_length = max(total_sequence_length_input, uniforms.past_sequence_length);\n      let is_subsequent_prompt: bool = sequence_length > 1 && sequence_length != total_sequence_length_input;\n      let is_first_prompt: bool = is_subsequent_prompt == false && sequence_length == total_sequence_length_input;\n      total_sequence_length = u32(").concat(null===e||void 0===e?void 0:e.getByOffset("batchIdx"),") + 1;\n      var past_sequence_length: u32 = 0;\n      if (is_first_prompt == false) {\n        past_sequence_length = total_sequence_length - sequence_length;\n      }\n       "):"\n    ".concat(n?"let past_sequence_length = uniforms.past_sequence_length":"",";\n    let present_sequence_length = total_sequence_length;\n    "),UT=(e,t,n,r,o,a,i,s)=>{let l=kE(i?1:a),c=64,u=a/l;u<c&&(c=32);let d=Math.ceil(a/l/c),p=[{type:12,data:t},{type:12,data:n},{type:12,data:r},{type:12,data:o},{type:12,data:u},{type:12,data:d}],h=wE(e.dataType,l),f=bE(1,l),m=["type"];i&&m.push("type"),s&&m.push("type");return{name:"AttentionProbsSoftmax",shaderCache:{hint:"".concat(c,";").concat(h,";").concat(l),inputDependencies:m},getShaderSource:t=>{let n=ME("x",e.dataType,e.dims,l),r=[n],o=i?AE("seq_lens",i.dataType,i.dims):void 0;o&&r.push(o);let a=s?AE("total_sequence_length_input",s.dataType,s.dims):void 0;a&&r.push(a);let u=bE(e.dataType);return"\n  var<workgroup> thread_max: array<f32, ".concat(c,">;\n  var<workgroup> thread_sum: array<f32, ").concat(c,">;\n  ").concat(t.registerUniforms([{name:"batch_size",type:"u32"},{name:"num_heads",type:"u32"},{name:"past_sequence_length",type:"u32"},{name:"sequence_length",type:"u32"},{name:"total_sequence_length",type:"u32"},{name:"elements_per_thread",type:"u32"}]).declareVariables(...r),"\n  ").concat(t.mainStart([c,1,1]),"\n    let batchIdx = workgroup_id.z / uniforms.num_heads;\n    let headIdx = workgroup_id.z % uniforms.num_heads;\n    let sequence_length = uniforms.sequence_length;\n    var total_sequence_length = uniforms.total_sequence_length;\n    ").concat(qT(o,a,!1),"\n    let local_offset = local_idx * uniforms.elements_per_thread;\n    let offset = (global_idx / ").concat(c,") * uniforms.total_sequence_length + local_offset;\n    let seq_causal_length = ").concat(i?"u32(past_sequence_length + workgroup_id.y + 1)":"total_sequence_length",";\n    var thread_max_vector = ").concat(f,"(-3.402823e+38f);\n    for (var i: u32 = 0; i < uniforms.elements_per_thread && i + local_offset < seq_causal_length; i++) {\n      thread_max_vector = max(").concat(f,"(x[offset + i]), thread_max_vector);\n    }\n    thread_max[local_idx] = ").concat((()=>{switch(l){case 1:return"thread_max_vector";case 2:return"max(thread_max_vector.x, thread_max_vector.y)";case 4:return"max(max(thread_max_vector.x, thread_max_vector.y), max(thread_max_vector.z, thread_max_vector.w))";default:throw new Error("Unsupported components: ".concat(l))}})(),";\n    workgroupBarrier();\n\n    var max_value =  f32(-3.402823e+38f);\n    for (var i = 0u; i < ").concat(c,"; i++) {\n      max_value = max(thread_max[i], max_value);\n    }\n\n    var sum_vector = ").concat(f,"(0);\n    for (var i: u32 = 0; i < uniforms.elements_per_thread && i + local_offset < seq_causal_length; i++) {\n      sum_vector += exp(").concat(f,"(x[offset + i]) - max_value);\n    }\n    thread_sum[local_idx] = ").concat((()=>{switch(l){case 1:return"sum_vector";case 2:return"sum_vector.x + sum_vector.y";case 4:return"sum_vector.x + sum_vector.y + sum_vector.z + sum_vector.w";default:throw new Error("Unsupported components: ".concat(l))}})(),";\n    workgroupBarrier();\n\n    var sum: f32 = 0;\n    for (var i = 0u; i < ").concat(c,"; i++) {\n      sum += thread_sum[i];\n    }\n\n    if (sum == 0) {\n      for (var i: u32 = 0; i < uniforms.elements_per_thread && i + local_offset < seq_causal_length; i++) {\n        x[offset + i] = ").concat(n.type.value,"(").concat(u,"(1.0) / ").concat(u,"(seq_causal_length));\n      }\n    } else {\n      for (var i: u32 = 0; i < uniforms.elements_per_thread && i + local_offset < seq_causal_length; i++) {\n        var f32input = ").concat(f,"(x[offset + i]);\n        x[offset + i] = ").concat(n.type.value,"(exp(f32input - max_value) / sum);\n      }\n    }\n      ").concat(i?"\n        for (var total_seq_id: u32 = seq_causal_length; total_seq_id + local_offset < uniforms.total_sequence_length; total_seq_id++) {\n          x[offset + total_seq_id] = ".concat(n.type.value,"(").concat(u,"(0));\n        }"):"",";\n  }")},getRunData:()=>({outputs:[],dispatchGroup:{x:1,y:o,z:t*n},programUniforms:p})}},WT=(e,t,n,r,o,a,i,s,l)=>{let c=i+a.kvSequenceLength,u=[a.batchSize,a.numHeads,a.sequenceLength,c],d=e>1&&r,p=a.kvNumHeads?a.kvNumHeads:a.numHeads,h=d?[a.batchSize,p,c,a.headSize]:void 0,f=a.nReps?a.nReps:1,m=0===a.scale?1/Math.sqrt(a.headSize):a.scale,g=kE(a.headSize),_=a.headSize/g,v=12,y={x:Math.ceil(c/v),y:Math.ceil(a.sequenceLength/v),z:a.batchSize*a.numHeads},w=[{type:12,data:a.sequenceLength},{type:12,data:_},{type:12,data:c},{type:12,data:a.numHeads},{type:12,data:a.headSize},{type:1,data:m},{type:12,data:i},{type:12,data:a.kvSequenceLength},{type:12,data:f}],b=d&&r&&qS.size(r.dims)>0,x=["type","type"];b&&x.push("type"),o&&x.push("type"),s&&x.push("type"),l&&x.push("type");let k=[{dims:u,dataType:t.dataType,gpuDataType:0}];d&&k.push({dims:h,dataType:t.dataType,gpuDataType:0});return{name:"AttentionProbs",shaderCache:{hint:"".concat(g,";").concat(void 0!==o,";").concat(void 0!==r,";").concat(e),inputDependencies:x},getRunData:()=>({outputs:k,dispatchGroup:y,programUniforms:w}),getShaderSource:e=>{let a=AE("q",t.dataType,t.dims,g),i=[a,AE("key",n.dataType,n.dims,g)];if(b){let e=AE("past_key",r.dataType,r.dims,g);i.push(e)}o&&i.push(AE("attention_bias",o.dataType,o.dims));let c=s?AE("seq_lens",s.dataType,s.dims):void 0;c&&i.push(c);let p=l?AE("total_sequence_length_input",l.dataType,l.dims):void 0;p&&i.push(p);let m=ME("output",t.dataType,u),_=[m];d&&_.push(ME("present_key",t.dataType,h,g));let y=bE(1,g);return"\n  const TILE_SIZE = ".concat(v,"u;\n\n  var<workgroup> tileQ: array<").concat(a.type.storage,", ").concat(144,">;\n  var<workgroup> tileK: array<").concat(a.type.storage,", ").concat(144,">;\n  ").concat(e.registerUniforms([{name:"M",type:"u32"},{name:"K",type:"u32"},{name:"N",type:"u32"},{name:"num_heads",type:"u32"},{name:"head_size",type:"u32"},{name:"alpha",type:"f32"},{name:"past_sequence_length",type:"u32"},{name:"kv_sequence_length",type:"u32"},{name:"n_reps",type:"u32"}]).declareVariables(...i,..._),"\n  ").concat(e.mainStart([v,v,1]),"\n    // x holds the N and y holds the M\n    let headIdx = workgroup_id.z % uniforms.num_heads;\n    let kvHeadIdx = ").concat(1===f?"headIdx":"headIdx / uniforms.n_reps",";\n    let kv_num_heads = ").concat(1===f?"uniforms.num_heads":"uniforms.num_heads / uniforms.n_reps",";\n    let batchIdx = workgroup_id.z / uniforms.num_heads;\n    let m = workgroup_id.y * TILE_SIZE;\n    let n = workgroup_id.x * TILE_SIZE;\n    let sequence_length = uniforms.M;\n    var total_sequence_length = uniforms.N;\n    ").concat(qT(c,p,!0),"\n    let absKvHeadIdx = batchIdx * kv_num_heads + kvHeadIdx;\n    let qOffset = workgroup_id.z * uniforms.M * uniforms.K + m * uniforms.K;\n    ").concat(b&&d?"let pastKeyOffset = absKvHeadIdx * uniforms.past_sequence_length * uniforms.K;":"",";\n    let kOffset = absKvHeadIdx * uniforms.kv_sequence_length * uniforms.K;\n    ").concat(d?"let presentKeyOffset = absKvHeadIdx * uniforms.N * uniforms.K;":"","\n    var value = ").concat(y,"(0);\n    for (var w: u32 = 0u; w < uniforms.K; w += TILE_SIZE) {\n      if (global_id.y < uniforms.M && w + local_id.x < uniforms.K) {\n        tileQ[TILE_SIZE * local_id.y + local_id.x] = q[qOffset + local_id.y * uniforms.K + w + local_id.x];\n      }\n      if (n + local_id.y < uniforms.N && w + local_id.x < uniforms.K) {\n        var idx = TILE_SIZE * local_id.y + local_id.x;\n      ").concat(b&&d?"\n              if (n + local_id.y < past_sequence_length) {\n                tileK[idx] = past_key[pastKeyOffset + (n + local_id.y) * uniforms.K + w + local_id.x];\n              } else if (n + local_id.y - past_sequence_length < uniforms.kv_sequence_length) {\n                tileK[idx] = key[kOffset + (n + local_id.y - past_sequence_length) * uniforms.K + w + local_id.x];\n              }":"\n          if (n + local_id.y < uniforms.kv_sequence_length) {\n            tileK[idx] = key[kOffset + (n + local_id.y) * uniforms.K + w + local_id.x];\n          }","\n      ").concat(d?"if (n + local_id.y < present_sequence_length) {\n        present_key[presentKeyOffset + (n + local_id.y) * uniforms.K + w + local_id.x] = tileK[idx];\n      }":"","\n      }\n      workgroupBarrier();\n\n      for (var k: u32 = 0u; k < TILE_SIZE && w+k < uniforms.K; k++) {\n          value += ").concat(y,"(tileQ[TILE_SIZE * local_id.y + k] * tileK[TILE_SIZE * local_id.x + k]);\n      }\n\n      workgroupBarrier();\n    }\n\n    if (global_id.y < uniforms.M && global_id.x < total_sequence_length) {\n      let headOffset = workgroup_id.z * uniforms.M * uniforms.N;\n      let outputIdx = headOffset + global_id.y * uniforms.N + global_id.x;\n      var sum: f32 = ").concat((()=>{switch(g){case 1:return"value";case 2:return"value.x + value.y";case 4:return"value.x + value.y + value.z + value.w";default:throw new Error("Unsupported components: ".concat(g))}})(),";\n        output[outputIdx] = ").concat(m.type.value," (sum * uniforms.alpha) + ").concat(o?"attention_bias[outputIdx]":"0.0",";\n    }\n  }")}}},GT=function(e,t,n,r,o,a){let i=arguments.length>6&&void 0!==arguments[6]?arguments[6]:void 0,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:void 0,l=a+o.kvSequenceLength,c=o.nReps?o.nReps:1,u=o.vHiddenSize*c,d=e>1&&r,p=o.kvNumHeads?o.kvNumHeads:o.numHeads,h=d?[o.batchSize,p,l,o.headSize]:void 0,f=[o.batchSize,o.sequenceLength,u],m=12,g={x:Math.ceil(o.vHeadSize/m),y:Math.ceil(o.sequenceLength/m),z:o.batchSize*o.numHeads},_=[{type:12,data:o.sequenceLength},{type:12,data:l},{type:12,data:o.vHeadSize},{type:12,data:o.numHeads},{type:12,data:o.headSize},{type:12,data:u},{type:12,data:a},{type:12,data:o.kvSequenceLength},{type:12,data:c}],v=d&&r&&qS.size(r.dims)>0,y=["type","type"];v&&y.push("type"),i&&y.push("type"),s&&y.push("type");let w=[{dims:f,dataType:t.dataType,gpuDataType:0}];d&&w.push({dims:h,dataType:t.dataType,gpuDataType:0});return{name:"AttentionScore",shaderCache:{hint:"".concat(void 0!==r,";").concat(e),inputDependencies:y},getRunData:()=>({outputs:w,dispatchGroup:g,programUniforms:_}),getShaderSource:e=>{let o=AE("probs",t.dataType,t.dims),a=[o,AE("v",n.dataType,n.dims)];v&&a.push(AE("past_value",r.dataType,r.dims));let l=i?AE("seq_lens",i.dataType,i.dims):void 0;i&&a.push(l);let u=s?AE("total_sequence_length_input",s.dataType,s.dims):void 0;s&&a.push(u);let p=[ME("output",t.dataType,f)];d&&p.push(ME("present_value",t.dataType,h));return"\n  const TILE_SIZE = ".concat(m,"u;\n  var<workgroup> tileQ: array<").concat(o.type.value,", ").concat(144,">;\n  var<workgroup> tileV: array<").concat(o.type.value,", ").concat(144,">;\n  ").concat(e.registerUniforms([{name:"M",type:"u32"},{name:"K",type:"u32"},{name:"N",type:"u32"},{name:"num_heads",type:"u32"},{name:"head_size",type:"u32"},{name:"v_hidden_size",type:"u32"},{name:"past_sequence_length",type:"u32"},{name:"kv_sequence_length",type:"u32"},{name:"n_reps",type:"u32"}]).declareVariables(...a,...p),"\n  ").concat(e.mainStart([m,m,1]),"\n   let headIdx = workgroup_id.z % uniforms.num_heads;\n   let batchIdx = workgroup_id.z / uniforms.num_heads;\n   let kvHeadIdx = ").concat(1===c?"headIdx":"headIdx / uniforms.n_reps",";\n   let kv_num_heads = ").concat(1===c?"uniforms.num_heads":"uniforms.num_heads / uniforms.n_reps",";\n   let m = global_id.y;\n   let n = global_id.x;\n   let sequence_length = uniforms.M;\n   var total_sequence_length = uniforms.K;\n   ").concat(qT(l,u,!0),"\n   let offsetA = workgroup_id.z * uniforms.M * uniforms.K + m * uniforms.K;\n   let absKvHeadIdx = batchIdx * kv_num_heads + kvHeadIdx; // kvHeadIdx is relative to the batch\n   ").concat(v&&d?"let pastValueOffset = absKvHeadIdx * uniforms.N * uniforms.past_sequence_length + n;":"",";\n   let vOffset = absKvHeadIdx * uniforms.N * uniforms.kv_sequence_length + n;\n   ").concat(d?"let presentValueOffset = absKvHeadIdx * uniforms.N * uniforms.K + n;":"","\n   var value = ").concat(o.type.storage,"(0);\n   for (var w: u32 = 0u; w < uniforms.K; w += TILE_SIZE) {\n      if (m < uniforms.M && w + local_id.x < uniforms.K) {\n        tileQ[TILE_SIZE * local_id.y + local_id.x] = probs[offsetA + w + local_id.x];\n      }\n      if (n < uniforms.N && w + local_id.y < uniforms.K) {\n        var idx = TILE_SIZE * local_id.y + local_id.x;\n        ").concat(v&&d?"\n        if (w + local_id.y < past_sequence_length) {\n          tileV[idx] = past_value[pastValueOffset + (w + local_id.y) * uniforms.N];\n        } else if (w + local_id.y - past_sequence_length < uniforms.kv_sequence_length) {\n          tileV[idx] = v[vOffset + (w + local_id.y - past_sequence_length) * uniforms.N];\n        }\n      ":"\n            if (w + local_id.y < uniforms.kv_sequence_length) {\n              tileV[idx] = v[vOffset + (w + local_id.y) * uniforms.N];\n            }","\n        ").concat(d?"\n            if (w + local_id.y < present_sequence_length) {\n          present_value[presentValueOffset + (w + local_id.y) * uniforms.N] = tileV[idx];\n        }":"","\n      }\n     workgroupBarrier();\n     for (var k: u32 = 0u; k < TILE_SIZE && w+k < total_sequence_length; k++) {\n       value += tileQ[TILE_SIZE * local_id.y + k] * tileV[TILE_SIZE * k + local_id.x];\n     }\n     workgroupBarrier();\n   }\n\n   // we need to transpose output from BNSH_v to BSND_v\n   if (m < uniforms.M && n < uniforms.N) {\n     let outputIdx = batchIdx * uniforms.M * uniforms.v_hidden_size + m * uniforms.v_hidden_size\n       + headIdx * uniforms.N + n;\n     output[outputIdx] = value;\n   }\n  }")}}},HT=function(e,t,n,r,o,a,i,s,l,c){let u=arguments.length>10&&void 0!==arguments[10]?arguments[10]:void 0,d=arguments.length>11&&void 0!==arguments[11]?arguments[11]:void 0,p=Math.min(e.outputCount,1+(i?1:0)+(s?1:0)),h=p>1?c.pastSequenceLength:0,f=h+c.kvSequenceLength,m=l&&qS.size(l.dims)>0?l:void 0,g=[t,n];p>1&&i&&qS.size(i.dims)>0&&g.push(i),m&&g.push(m),u&&g.push(u),d&&g.push(d);let _=e.compute(WT(p,t,n,i,m,c,h,u,d),{inputs:g,outputs:p>1?[-1,1]:[-1]})[0];e.compute(UT(_,c.batchSize,c.numHeads,h,c.sequenceLength,f,u,d),{inputs:u&&d?[_,u,d]:[_],outputs:[]});let v=[_,r];p>1&&s&&qS.size(s.dims)>0&&v.push(s),u&&v.push(u),d&&v.push(d),e.compute(GT(p,_,r,s,c,h,u,d),{inputs:v,outputs:p>1?[0,2]:[0]})},KT=(e,t)=>{let n=[t.batchSize,t.numHeads,t.sequenceLength,t.headSize],r=t.sequenceLength,o=t.inputHiddenSize,a=t.headSize,i=12,s={x:Math.ceil(t.headSize/i),y:Math.ceil(t.sequenceLength/i),z:t.batchSize*t.numHeads},l=[e.inputs[0],e.inputs[1],e.inputs[2]],c=[{type:12,data:r},{type:12,data:o},{type:12,data:a},{type:12,data:t.numHeads},{type:12,data:t.headSize},{type:12,data:t.hiddenSize},{type:12,data:t.hiddenSize+t.hiddenSize+t.vHiddenSize}];return e.compute({name:"AttentionPrepare",shaderCache:{inputDependencies:["type","type","type"]},getRunData:()=>({outputs:[{dims:n,dataType:e.inputs[0].dataType,gpuDataType:0},{dims:n,dataType:e.inputs[0].dataType,gpuDataType:0},{dims:n,dataType:e.inputs[0].dataType,gpuDataType:0}],dispatchGroup:s,programUniforms:c}),getShaderSource:e=>{let t=ME("output_q",l[0].dataType,n),r=ME("output_k",l[0].dataType,n),o=ME("output_v",l[0].dataType,n),a=AE("input",l[0].dataType,l[0].dims),s=AE("weight",l[1].dataType,l[1].dims),c=AE("bias",l[2].dataType,l[2].dims),u=a.type.storage;return"\n  const TILE_SIZE = ".concat(i,"u;\n  var<workgroup> tileInput: array<").concat(u,", ").concat(144,">;\n  var<workgroup> tileWeightQ: array<").concat(u,", ").concat(144,">;\n  var<workgroup> tileWeightK: array<").concat(u,", ").concat(144,">;\n  var<workgroup> tileWeightV: array<").concat(u,", ").concat(144,">;\n  ").concat(e.registerUniforms([{name:"M",type:"u32"},{name:"K",type:"u32"},{name:"N",type:"u32"},{name:"num_heads",type:"u32"},{name:"head_size",type:"u32"},{name:"hidden_size",type:"u32"},{name:"ldb",type:"u32"}]).declareVariables(a,s,c,t,r,o),"\n  ").concat(e.mainStart([i,i,1]),"\n    let batchIndex = workgroup_id.z / uniforms.num_heads;\n    let headNumber = workgroup_id.z % uniforms.num_heads;\n    let m = global_id.y;\n    let n = global_id.x;\n\n    let inputOffset = batchIndex * (uniforms.M * uniforms.K) + m * uniforms.K;\n    let biasOffsetQ = headNumber * uniforms.head_size;\n    let biasOffsetK = uniforms.hidden_size + biasOffsetQ;\n    let biasOffsetV = uniforms.hidden_size + biasOffsetK;\n\n    var valueQ = ").concat(u,"(0);\n    var valueK = ").concat(u,"(0);\n    var valueV = ").concat(u,"(0);\n    for (var w: u32 = 0u; w < uniforms.K; w += TILE_SIZE) {\n      if (m < uniforms.M && w + local_id.x < uniforms.K) {\n        tileInput[TILE_SIZE * local_id.y + local_id.x] = input[inputOffset + w + local_id.x];\n      }\n      if (n < uniforms.N && w + local_id.y < uniforms.K) {\n        let offset = n + (w + local_id.y) * uniforms.ldb;\n        tileWeightQ[TILE_SIZE * local_id.y + local_id.x] = weight[biasOffsetQ + offset];\n        tileWeightK[TILE_SIZE * local_id.y + local_id.x] = weight[biasOffsetK + offset];\n        tileWeightV[TILE_SIZE * local_id.y + local_id.x] = weight[biasOffsetV + offset];\n      }\n      workgroupBarrier();\n      for (var k: u32 = 0u; k<TILE_SIZE && w+k < uniforms.K; k++) {\n        let inputTileOffset = TILE_SIZE * local_id.y + k;\n        let weightTileOffset = TILE_SIZE * k + local_id.x;\n        valueQ += tileInput[inputTileOffset] * tileWeightQ[weightTileOffset];\n        valueK += tileInput[inputTileOffset] * tileWeightK[weightTileOffset];\n        valueV += tileInput[inputTileOffset] * tileWeightV[weightTileOffset];\n      }\n\n      workgroupBarrier();\n    }\n\n    let headOffset = (m * uniforms.N + n) % uniforms.head_size;\n    valueQ += bias[headOffset + biasOffsetQ];\n    valueK += bias[headOffset + biasOffsetK];\n    valueV += bias[headOffset + biasOffsetV];\n\n    let offset = workgroup_id.z * uniforms.M * uniforms.N;\n    if (m < uniforms.M && n < uniforms.N) {\n      let outputIdx = offset + m * uniforms.N + n;\n      output_q[outputIdx] = valueQ;\n      output_k[outputIdx] = valueK;\n      output_v[outputIdx] = valueV;\n    }\n  }")}},{inputs:l,outputs:[-1,-1,-1]})},ZT=(e,t)=>{let n=VT(e.inputs,t),[r,o,a]=KT(e,n);return HT(e,r,o,a,e.inputs[4],void 0,void 0,void 0,e.inputs[5],n)}})),Zz=pD((()=>{zD(),Iz(),Oz(),Vz(),qz(),$T=(e,t)=>{if(!e||5!==e.length)throw new Error("BatchNormalization requires 5 inputs");let n=(e,t,n)=>{let r=t.length;if(r!==e.length)throw new Error("".concat(n,": num dimensions != ").concat(r));t.forEach(((t,r)=>{if(t!==e[r])throw new Error("".concat(n,": dim[").concat(r,"] do not match"))}))};if(e[0].dims.length>1){let r="NHWC"===t.format?t.spatial?e[0].dims.slice(-1):e[0].dims.slice(-1).concat(e[0].dims.slice(1,e[0].dims.length-1)):e[0].dims.slice(1,t.spatial?2:void 0);n(e[1].dims,r,"Invalid input scale"),n(e[2].dims,r,"Invalid input B"),n(e[3].dims,r,"Invalid input mean"),n(e[4].dims,r,"Invalid input var")}else n(e[1].dims,[1],"Invalid input scale"),n(e[2].dims,[1],"Invalid input B"),n(e[3].dims,[1],"Invalid input mean"),n(e[4].dims,[1],"Invalid input var")},XT=(e,t)=>{let{epsilon:n,spatial:r,format:o}=t,a=e[0].dims,i=r?kE(a[a.length-1]):1,s="NHWC"===o&&a.length>1?i:1,l=qS.size(a)/i,c=r,u=c?a.length:a,d=AE("x",e[0].dataType,e[0].dims,i),p=AE("scale",e[1].dataType,e[1].dims,s),h=AE("bias",e[2].dataType,e[2].dims,s),f=AE("inputMean",e[3].dataType,e[3].dims,s),m=AE("inputVar",e[4].dataType,e[4].dims,s),g=ME("y",e[0].dataType,u,i);return{name:"BatchNormalization",shaderCache:{hint:"".concat(t.epsilon,"_").concat(t.format,"_").concat(r,"_").concat(i),inputDependencies:c?["rank","type","type","type","type"]:void 0},getShaderSource:e=>"\n  const epsilon = ".concat(n,";\n  ").concat(e.registerUniform("outputSize","u32").declareVariables(d,p,h,f,m,g),"\n  ").concat(e.mainStart(),"\n  ").concat(e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize"),"\n    var outputIndices = ").concat(g.offsetToIndices("global_idx * ".concat(i)),";\n    ").concat((()=>{let e="";if(r)e="let cOffset = ".concat(1===a.length?"0u":"NHWC"===o?"outputIndices[".concat(a.length-1,"] / ").concat(i):"outputIndices[1]",";");else if("NCHW"===o)e="\n            ".concat(g.indicesSet("outputIndices","0","0"),"\n            let cOffset = ").concat(g.indicesToOffset("outputIndices"),";");else{e="var cIndices = ".concat(p.type.indices,"(0);\n                       cIndices[0] = outputIndices[").concat(a.length-1,"];");for(let t=1;t<p.rank;t++)e+="cIndices[".concat(t,"] = outputIndices[").concat(t,"];");e+="let cOffset = ".concat(p.indicesToOffset("cIndices"),";")}return e})(),"\n    let scale = ").concat(p.getByOffset("cOffset"),";\n    let bias = ").concat(h.getByOffset("cOffset"),";\n    let inputMean = ").concat(f.getByOffset("cOffset"),";\n    let inputVar = ").concat(m.getByOffset("cOffset"),";\n    let x = ").concat(d.getByOffset("global_idx"),";\n    let value = (x - inputMean) * inverseSqrt(inputVar + epsilon) * scale + bias;\n    ").concat(g.setByOffset("global_idx","value"),"\n  }"),getRunData:()=>({outputs:[{dims:e[0].dims,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(l/64)},programUniforms:c?[{type:12,data:l},...xE(a)]:[{type:12,data:l}]})}},JT=e=>_E(e),QT=(e,t)=>{let{inputs:n,outputCount:r}=e,o=JT(so(so({},t),{},{outputCount:r}));if(jC.webgpu.validateInputContent&&$T(n,o),t.trainingMode)throw new Error("BatchNormalization trainingMode is not supported yet.");e.compute(XT(n,o))}})),$z=pD((()=>{Oz(),qz(),YT=e=>{if(3!==e[0].dims.length)throw new Error("input should have 3 dimensions");if(![320,640,1280].includes(e[0].dims[2]))throw new Error("number of channels should be 320, 640 or 1280");if(1!==e[1].dims.length)throw new Error("bias is expected to have 1 dimensions");if(e[0].dims[2]!==e[1].dims[0])throw new Error("last dimension of input and bias are not the same")},eA=e=>{let t=e[0].dims,n=e[0].dims[2],r=qS.size(t)/4,o=e[0].dataType,a=AE("input",o,t,4),i=AE("bias",o,[n],4),s=AE("residual",o,t,4),l=ME("output",o,t,4);return{name:"BiasAdd",getRunData:()=>({outputs:[{dims:t,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(r/64)}}),getShaderSource:e=>"\n  const channels = ".concat(n,"u / 4;\n  ").concat(e.declareVariables(a,i,s,l),"\n\n  ").concat(e.mainStart(),"\n    ").concat(e.guardAgainstOutOfBoundsWorkgroupSizes(r),"\n    let value = ").concat(a.getByOffset("global_idx"),"\n      + ").concat(i.getByOffset("global_idx % channels")," + ").concat(s.getByOffset("global_idx"),";\n    ").concat(l.setByOffset("global_idx","value"),"\n  }")}},tA=e=>{YT(e.inputs),e.compute(eA(e.inputs))}})),Xz=pD((()=>{Iz(),Oz(),Vz(),qz(),nA=(e,t,n,r,o,a,i)=>{let s=Math.ceil(t/4),l="";l="string"==typeof o?"".concat(o,"(a)"):o("a");let c=AE("inputData",n,[s],4),u=ME("outputData",r,[s],4),d=[{name:"vec_size",type:"u32"}];return i&&d.push(...i),"\n      ".concat(e.registerUniforms(d).declareVariables(c,u),"\n\n  ").concat(null!==a&&void 0!==a?a:"","\n\n  ").concat(e.mainStart(),"\n    ").concat(e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.vec_size"),"\n\n    let a = ").concat(c.getByOffset("global_idx"),";\n    ").concat(u.setByOffset("global_idx",l),"\n  }")},rA=function(e,t,n,r,o){let a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:e.dataType,i=arguments.length>6?arguments[6]:void 0,s=arguments.length>7?arguments[7]:void 0,l=[{type:12,data:Math.ceil(qS.size(e.dims)/4)}];return i&&l.push(...i),{name:t,shaderCache:{hint:o,inputDependencies:["type"]},getShaderSource:t=>nA(t,qS.size(e.dims),e.dataType,a,n,r,s),getRunData:t=>({outputs:[{dims:e.dims,dataType:a}],dispatchGroup:{x:Math.ceil(qS.size(t[0].dims)/64/4)},programUniforms:l})}},oA=e=>{e.compute(rA(e.inputs[0],"Abs","abs"))},aA=e=>{e.compute(rA(e.inputs[0],"Acos","acos"))},iA=e=>{e.compute(rA(e.inputs[0],"Acosh","acosh"))},sA=e=>{e.compute(rA(e.inputs[0],"Asin","asin"))},lA=e=>{e.compute(rA(e.inputs[0],"Asinh","asinh"))},cA=e=>{e.compute(rA(e.inputs[0],"Atan","atan"))},uA=e=>{e.compute(rA(e.inputs[0],"Atanh","atanh"))},dA=e=>_E(e),pA=(e,t)=>{let n;switch(t.to){case 10:n="vec4<f16>";break;case 1:n="vec4<f32>";break;case 12:n="vec4<u32>";break;case 6:n="vec4<i32>";break;case 9:n="vec4<bool>";break;default:throw new RangeError("not supported type (specified in attribute 'to' from 'Cast' operator): ".concat(t.to))}e.compute(rA(e.inputs[0],"Cast",n,void 0,t.cacheKey,t.to))},hA=e=>{let t,n,r=e.length>=2&&0!==e[1].data,o=e.length>=3&&0!==e[2].data;switch(e[0].dataType){case 1:t=r?e[1].getFloat32Array()[0]:-34028234663852886e22,n=o?e[2].getFloat32Array()[0]:34028234663852886e22;break;case 10:t=r?e[1].getUint16Array()[0]:64511,n=o?e[2].getUint16Array()[0]:31743;break;default:throw new Error("Unsupport data type")}return _E({min:t,max:n})},fA=(e,t)=>{let n=t||hA(e.inputs),r=bE(e.inputs[0].dataType);e.compute(rA(e.inputs[0],"Clip",(e=>"clamp(".concat(e,", vec4<").concat(r,">(uniforms.min), vec4<").concat(r,">(uniforms.max))")),void 0,n.cacheKey,void 0,[{type:e.inputs[0].dataType,data:n.min},{type:e.inputs[0].dataType,data:n.max}],[{name:"min",type:r},{name:"max",type:r}]),{inputs:[0]})},mA=e=>{e.compute(rA(e.inputs[0],"Ceil","ceil"))},gA=e=>{e.compute(rA(e.inputs[0],"Cos","cos"))},_A=e=>{e.compute(rA(e.inputs[0],"Cosh","cosh"))},vA=e=>_E(e),yA=(e,t)=>{let n=bE(e.inputs[0].dataType);e.compute(rA(e.inputs[0],"Elu",(e=>"elu_vf32(".concat(e,")")),"\n  const elu_alpha_ = ".concat(n,"(").concat(t.alpha,");\n\n  fn elu_f32(a: ").concat(n,") -> ").concat(n," {\n  return select((exp(a) - 1.0) * elu_alpha_, a, a >= 0.0);\n  }\n\n  fn elu_vf32(v: vec4<").concat(n,">) -> vec4<").concat(n,"> {\n  return vec4(elu_f32(v.x), elu_f32(v.y), elu_f32(v.z), elu_f32(v.w));\n  }"),t.cacheKey))},wA=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"f32";return"\nconst r0: ".concat(e," = 0.3275911;\nconst r1: ").concat(e," = 0.254829592;\nconst r2: ").concat(e," = -0.284496736;\nconst r3: ").concat(e," = 1.421413741;\nconst r4: ").concat(e," = -1.453152027;\nconst r5: ").concat(e," = 1.061405429;\n\nfn erf_vf32(v: vec4<").concat(e,">) -> vec4<").concat(e,"> {\n  let absv = abs(v);\n  let x = 1.0 / (1.0 + r0 * absv);\n  return sign(v) * (1.0 - ((((r5 * x + r4) * x + r3) * x + r2) * x + r1) * x * exp(-absv * absv));\n}")},bA=e=>{let t=bE(e.inputs[0].dataType);e.compute(rA(e.inputs[0],"Erf",(e=>"erf_vf32(".concat(e,")")),wA(t)))},xA=e=>{e.compute(rA(e.inputs[0],"Exp","exp"))},kA=e=>{e.compute(rA(e.inputs[0],"Floor","floor"))},CA=e=>{let t=bE(e.inputs[0].dataType);e.compute(rA(e.inputs[0],"Gelu",(e=>"0.5 * ".concat(e," * (1.0 + erf_vf32(").concat(e," * 0.7071067811865475))")),wA(t)))},DA=(e,t)=>{let n=bE(e.inputs[0].dataType);e.compute(rA(e.inputs[0],"LeakyRelu",(e=>"select(leaky_relu_alpha_ * ".concat(e,", ").concat(e,", ").concat(e," >= vec4<").concat(n,">(0.0))")),"const leaky_relu_alpha_ = ".concat(n,"(").concat(t.alpha,");"),t.cacheKey))},SA=e=>{e.compute(rA(e.inputs[0],"Not",(e=>"!".concat(e))))},EA=e=>{e.compute(rA(e.inputs[0],"Neg",(e=>"-".concat(e))))},TA=e=>{e.compute(rA(e.inputs[0],"Reciprocal",(e=>"1.0/".concat(e))))},AA=e=>{let t=bE(e.inputs[0].dataType);e.compute(rA(e.inputs[0],"Relu",(e=>"select(vec4<".concat(t,">(0.0), ").concat(e,", ").concat(e," > vec4<").concat(t,">(0.0))"))))},MA=e=>{e.compute(rA(e.inputs[0],"Sigmoid",(e=>"(1.0 / (1.0 + exp(-".concat(e,")))"))))},FA=e=>_E(e),IA=(e,t)=>{let n=bE(e.inputs[0].dataType);e.compute(rA(e.inputs[0],"HardSigmoid",(e=>"max(vec4<".concat(n,">(0.0), min(vec4<").concat(n,">(1.0), ").concat(t.alpha," * ").concat(e," + vec4<").concat(n,">(").concat(t.beta,")))")),void 0,t.cacheKey))},PA=e=>{e.compute(rA(e.inputs[0],"Sin","sin"))},zA=e=>{e.compute(rA(e.inputs[0],"Sinh","sinh"))},OA=e=>{e.compute(rA(e.inputs[0],"Sqrt","sqrt"))},NA=e=>{e.compute(rA(e.inputs[0],"Tan","tan"))},BA=e=>"sign(".concat(e,") * (1 - exp(-2 * abs(").concat(e,"))) / (1 + exp(-2 * abs(").concat(e,")))"),jA=e=>{e.compute(rA(e.inputs[0],"Tanh",BA))},LA=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"f32";return"\nconst fast_gelu_a: ".concat(e," = 0.5;\nconst fast_gelu_b: ").concat(e," = 0.7978845608028654;\nconst fast_gelu_c: ").concat(e," = 0.035677408136300125;\n\nfn tanh_v(v: vec4<").concat(e,">) -> vec4<").concat(e,"> {\n  return ").concat(BA("v"),";\n}\n")},RA=e=>"(fast_gelu_a + fast_gelu_a * tanh_v(".concat(e," * (fast_gelu_c * ").concat(e," * ").concat(e," + fast_gelu_b))) * ").concat(e),VA=e=>{let t=bE(e.inputs[0].dataType);e.compute(rA(e.inputs[0],"FastGelu",RA,LA(t),void 0,e.inputs[0].dataType))},qA=(e,t)=>{let n=bE(e.inputs[0].dataType);return e.compute(rA(e.inputs[0],"ThresholdedRelu",(e=>"select(vec4<".concat(n,">(0.0), ").concat(e,", ").concat(e," > thresholded_relu_alpha_)")),"const thresholded_relu_alpha_ = vec4<".concat(n,">(").concat(t.alpha,");"),t.cacheKey)),0},UA=e=>{e.compute(rA(e.inputs[0],"Log","log"))},WA=(e,t)=>"\nconst alpha = vec4<".concat(e,">(").concat(t,");\nconst one = ").concat(e,"(1.0);\nconst zero = ").concat(e,"(0.0);\n\nfn quick_gelu_impl(x: vec4<").concat(e,">) -> vec4<").concat(e,"> {\n  let v = x *alpha;\n  var x1 : vec4<").concat(e,">;\n  for (var i = 0; i < 4; i = i + 1) {\n    if (v[i] >= zero) {\n      x1[i] = one / (one + exp(-v[i]));\n    } else {\n      x1[i] = one - one / (one + exp(v[i]));\n    }\n  }\n  return x * x1;\n}\n"),GA=e=>"quick_gelu_impl(".concat(e,")"),HA=(e,t)=>{let n=bE(e.inputs[0].dataType);e.compute(rA(e.inputs[0],"QuickGelu",GA,WA(n,t.alpha),t.cacheKey,e.inputs[0].dataType))}})),Jz=pD((()=>{Oz(),qz(),Xz(),KA=e=>{if(3!==e[0].dims.length)throw new Error("input should have 3 dimensions");if(![2560,5120,10240].includes(e[0].dims[2]))throw new Error("hidden state should be 2560, 5120 or 10240");if(1!==e[1].dims.length)throw new Error("bias is expected to have 1 dimensions");if(e[0].dims[2]!==e[1].dims[0])throw new Error("last dimension of input and bias are not the same")},ZA=e=>{let t=e[0].dims.slice();t[2]=t[2]/2;let n=AE("input",e[0].dataType,e[0].dims,4),r=AE("bias",e[0].dataType,[e[0].dims[2]],4),o=ME("output",e[0].dataType,t,4),a=qS.size(t)/4,i=wE(e[0].dataType);return{name:"BiasSplitGelu",getRunData:()=>({outputs:[{dims:t,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(a/64)}}),getShaderSource:t=>"\n  const M_SQRT2 = sqrt(2.0);\n  const halfChannels = ".concat(e[0].dims[2]/4/2,"u;\n\n  ").concat(t.declareVariables(n,r,o),"\n\n  ").concat(wA(i),"\n\n  ").concat(t.mainStart(),"\n    ").concat(t.guardAgainstOutOfBoundsWorkgroupSizes(a),"\n    let biasIdx = global_idx % halfChannels;\n    let batchIndex = global_idx / halfChannels;\n    let inputOffset = biasIdx + batchIndex * halfChannels * 2;\n    let valueLeft = input[inputOffset] + bias[biasIdx];\n    let valueRight = input[inputOffset + halfChannels] + bias[biasIdx + halfChannels];\n    let geluRight = valueRight * 0.5 * (erf_vf32(valueRight / M_SQRT2) + 1);\n\n    ").concat(o.setByOffset("global_idx","valueLeft * geluRight"),"\n  }")}},$A=e=>{KA(e.inputs),e.compute(ZA(e.inputs))}})),Qz=pD((()=>{Iz(),Oz(),qz(),XA=(e,t,n,r,o,a,i,s,l,c,u,d)=>{let p,h;"string"==typeof s?p=h=(e,t)=>"".concat(s,"((").concat(e,"),(").concat(t,"))"):"function"==typeof s?p=h=s:(p=s.scalar,h=s.vector);let f,m=ME("outputData",u,r.length,4),g=AE("aData",l,t.length,4),_=AE("bData",c,n.length,4);if(o)if(a){let e=1===qS.size(t),r=1===qS.size(n),o=t.length>0&&t[t.length-1]%4===0,a=n.length>0&&n[n.length-1]%4===0;f=e||r?m.setByOffset("global_idx",h(e?"".concat(g.type.value,"(").concat(g.getByOffset("0"),".x)"):g.getByOffset("global_idx"),r?"".concat(_.type.value,"(").concat(_.getByOffset("0"),".x)"):_.getByOffset("global_idx"))):"\n            let outputIndices = ".concat(m.offsetToIndices("global_idx * 4u"),";\n            let offsetA = ").concat(g.broadcastedIndicesToOffset("outputIndices",m),";\n            let offsetB = ").concat(_.broadcastedIndicesToOffset("outputIndices",m),";\n            ").concat(m.setByOffset("global_idx",h(i||o?g.getByOffset("offsetA / 4u"):"".concat(g.type.value,"(").concat(g.getByOffset("offsetA / 4u"),"[offsetA % 4u])"),i||a?_.getByOffset("offsetB / 4u"):"".concat(_.type.value,"(").concat(_.getByOffset("offsetB / 4u"),"[offsetB % 4u])"))),"\n          ")}else f=m.setByOffset("global_idx",h(g.getByOffset("global_idx"),_.getByOffset("global_idx")));else{if(!a)throw new Error("no necessary to use scalar implementation for element-wise binary op implementation.");let e=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",r="aData[indexA".concat(t,"][componentA").concat(t,"]"),o="bData[indexB".concat(t,"][componentB").concat(t,"]");return"\n            let outputIndices".concat(t," = ").concat(m.offsetToIndices("global_idx * 4u + ".concat(t,"u")),";\n            let offsetA").concat(t," = ").concat(g.broadcastedIndicesToOffset("outputIndices".concat(t),m),";\n            let offsetB").concat(t," = ").concat(_.broadcastedIndicesToOffset("outputIndices".concat(t),m),";\n            let indexA").concat(t," = offsetA").concat(t," / 4u;\n            let indexB").concat(t," = offsetB").concat(t," / 4u;\n            let componentA").concat(t," = offsetA").concat(t," % 4u;\n            let componentB").concat(t," = offsetB").concat(t," % 4u;\n            ").concat(e,"[").concat(t,"] = ").concat(n,"(").concat(p(r,o),");\n          ")};f=9===u?"\n            var data = vec4<u32>(0);\n            ".concat(e("data",0,"u32"),"\n            ").concat(e("data",1,"u32"),"\n            ").concat(e("data",2,"u32"),"\n            ").concat(e("data",3,"u32"),"\n            outputData[global_idx] = dot(vec4<u32>(0x1, 0x100, 0x10000, 0x1000000), vec4<u32>(data));"):"\n            ".concat(e("outputData[global_idx]",0),"\n            ").concat(e("outputData[global_idx]",1),"\n            ").concat(e("outputData[global_idx]",2),"\n            ").concat(e("outputData[global_idx]",3),"\n          ")}return"\n        ".concat(e.registerUniform("vec_size","u32").declareVariables(g,_,m),"\n\n        ").concat(null!==d&&void 0!==d?d:"","\n\n        ").concat(e.mainStart(),"\n        ").concat(e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.vec_size"),"\n        ").concat(f,"\n      }")},JA=function(e,t,n,r,o,a){let i=arguments.length>6&&void 0!==arguments[6]?arguments[6]:n.dataType,s=n.dims.map((e=>{var t;return null!==(t=Number(e))&&void 0!==t?t:1})),l=r.dims.map((e=>{var t;return null!==(t=Number(e))&&void 0!==t?t:1})),c=!qS.areEqual(s,l),u=s,d=qS.size(s),p=!1,h=!1,f=[c];if(c){let e=VS.calcShape(s,l,!1);if(!e)throw new Error("Can't perform binary op on the given tensors");u=e.slice(),d=qS.size(u);let t=1===qS.size(s),n=1===qS.size(l),r=s.length>0&&s[s.length-1]%4===0,o=l.length>0&&l[l.length-1]%4===0;f.push(t),f.push(n),f.push(r),f.push(o);let a=1;for(let i=1;i<u.length;i++){let e=s[s.length-i];if(e!==l[l.length-i])break;a*=e}a%4===0?(h=!0,p=!0):(t||n||r||o)&&(p=!0)}else p=!0;return f.push(p),{name:e,shaderCache:{hint:t+f.map((e=>e.toString())).join("_"),inputDependencies:["rank","rank"]},getShaderSource:e=>XA(e,s,l,u,p,c,h,o,n.dataType,r.dataType,i,a),getRunData:()=>({outputs:[{dims:u,dataType:i}],dispatchGroup:{x:Math.ceil(d/64/4)},programUniforms:[{type:12,data:Math.ceil(qS.size(u)/4)},...xE(s,l,u)]})}},QA=(e,t,n,r,o,a)=>{e.compute(JA(t,null!==o&&void 0!==o?o:"",e.inputs[0],e.inputs[1],n,r,a))},YA=e=>{QA(e,"Add",((e,t)=>"".concat(e,"+").concat(t)))},eM=e=>{QA(e,"Div",((e,t)=>"".concat(e,"/").concat(t)))},tM=e=>{QA(e,"Equal",{scalar:(e,t)=>"u32(".concat(e,"==").concat(t,")"),vector:(e,t)=>"vec4<u32>(".concat(e,"==").concat(t,")")},void 0,void 0,9)},nM=e=>{QA(e,"Mul",((e,t)=>"".concat(e,"*").concat(t)))},rM=e=>{let t=AE("input",e.inputs[0].dataType,e.inputs[0].dims).type.value;QA(e,"Pow",{scalar:(e,t)=>"pow_custom(".concat(e,",").concat(t,")"),vector:(e,t)=>"pow_vector_custom(".concat(e,",").concat(t,")")},"\n    fn pow_custom(a : ".concat(t,", b : ").concat(t,") -> ").concat(t," {\n      if (b == ").concat(t,"(0.0)) {\n        return ").concat(t,"(1.0);\n      } else if (a < ").concat(t,"(0.0) && f32(b) != floor(f32(b))) {\n        return ").concat(t,"(pow(f32(a), f32(b))); // NaN\n      }\n      return select(sign(a), ").concat(t,"(1.0), round(f32(abs(b) % ").concat(t,"(2.0))) != 1.0) * ").concat(t,"(").concat("i32"===t?"round":"","(pow(f32(abs(a)), f32(b))));\n    }\n    fn pow_vector_custom(a : vec4<").concat(t,">, b : vec4<").concat(t,">) -> vec4<").concat(t,"> {\n      // TODO: implement vectorized pow\n      return vec4<").concat(t,">(pow_custom(a.x, b.x), pow_custom(a.y, b.y), pow_custom(a.z, b.z), pow_custom(a.w, b.w));\n    }\n      "))},oM=e=>{QA(e,"Sub",((e,t)=>"".concat(e,"-").concat(t)))},aM=e=>{QA(e,"Greater",{scalar:(e,t)=>"u32(".concat(e,">").concat(t,")"),vector:(e,t)=>"vec4<u32>(".concat(e,">").concat(t,")")},void 0,void 0,9)},iM=e=>{QA(e,"Less",{scalar:(e,t)=>"u32(".concat(e,"<").concat(t,")"),vector:(e,t)=>"vec4<u32>(".concat(e,"<").concat(t,")")},void 0,void 0,9)},sM=e=>{QA(e,"GreaterOrEqual",{scalar:(e,t)=>"u32(".concat(e,">=").concat(t,")"),vector:(e,t)=>"vec4<u32>(".concat(e,">=").concat(t,")")},void 0,void 0,9)},lM=e=>{QA(e,"LessOrEqual",{scalar:(e,t)=>"u32(".concat(e,"<=").concat(t,")"),vector:(e,t)=>"vec4<u32>(".concat(e,"<=").concat(t,")")},void 0,void 0,9)}})),Yz=pD((()=>{Iz(),Oz(),Vz(),qz(),cM=(e,t)=>{if(!e||e.length<1)throw new Error("too few inputs");let n=e[0],r=n.dataType,o=n.dims.length;e.forEach(((e,a)=>{if(0!==a){if(e.dataType!==r)throw new Error("input tensors should be one type");if(e.dims.length!==o)throw new Error("input tensors should have the same shape");e.dims.forEach(((e,r)=>{if(r!==t&&e!==n.dims[r])throw new Error("non concat dimensions must match")}))}}))},uM=(e,t)=>"\n  fn calculateInputIndex(index: u32) -> u32 {\n    let sizeInConcatAxis = array<u32, ".concat(e,"u>(").concat(t,");\n    for (var i: u32 = 0u; i < ").concat(e,"; i += 1u ) {\n      if (index < sizeInConcatAxis[i]) {\n        return i;\n      }\n    }\n    return ").concat(e,"u;\n  }"),dM=(e,t)=>{let n=e.length,r=[];for(let o=0;o<n;++o){let a=t.setByOffset("global_idx",e[o].getByIndices("indices"));1===n?r.push(a):0===o?r.push("if (inputIndex == ".concat(o,"u) { ").concat(a," }")):o===n-1?r.push("else { ".concat(a," }")):r.push("else if (inputIndex == ".concat(o,") { ").concat(a," }"))}return r.join("\n")},pM=(e,t,n,r)=>{let o=qS.size(n),a=new Array(e.length),i=new Array(e.length),s=0,l=[],c=[],u=[{type:12,data:o}];for(let f=0;f<e.length;++f)s+=e[f].dims[t],a[f]=s,c.push(e[f].dims.length),i[f]=AE("input".concat(f),r,c[f]),l.push("rank"),u.push({type:12,data:a[f]});for(let f=0;f<e.length;++f)u.push(...xE(e[f].dims));u.push(...xE(n));let d=ME("output",r,n.length),p=d.indicesGet("indices",t),h=Array.from(Array(a.length).keys()).map((e=>"uniforms.sizeInConcatAxis".concat(e))).join(",");return{name:"Concat",shaderCache:{hint:"".concat(t),inputDependencies:l},getRunData:()=>({outputs:[{dims:n,dataType:r}],dispatchGroup:{x:Math.ceil(o/64)},programUniforms:u}),getShaderSource:t=>"\n\n  ".concat((()=>{t.registerUniform("outputSize","u32");for(let n=0;n<e.length;n++)t.registerUniform("sizeInConcatAxis".concat(n),"u32");return t.declareVariables(...i,d)})(),"\n\n  ").concat(uM(a.length,h),"\n\n  ").concat(t.mainStart(),"\n    ").concat(t.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize"),"\n\n    var indices = ").concat(d.offsetToIndices("global_idx"),";\n\n    let inputIndex = calculateInputIndex(").concat(p,");\n    if (inputIndex != 0u) {\n      let sizeInConcatAxis = array<u32, ").concat(a.length,"u>(").concat(h,");\n      ").concat(p," -= sizeInConcatAxis[inputIndex - 1u];\n    }\n\n    ").concat(dM(i,d),"\n  }")}},hM=(e,t)=>{let n=e.inputs,r=n[0].dims,o=qS.normalizeAxis(t.axis,r.length);cM(n,o);let a=r.slice();a[o]=n.reduce(((e,t)=>e+(t.dims.length>o?t.dims[o]:0)),0);let i=n.filter((e=>qS.size(e.dims)>0));e.compute(pM(i,o,a,n[0].dataType),{inputs:i})},fM=e=>_E({axis:e.axis})})),eO=pD((()=>{Iz(),Oz(),mM=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"f32";switch(e.activation){case"Relu":return"value = max(value, ".concat(t,"(0.0));");case"Sigmoid":return"value = (".concat(t,"(1.0) / (").concat(t,"(1.0) + exp(-value)));");case"Clip":return"value = clamp(value, ".concat(t,"(").concat(n,"(uniforms.clip_min)), ").concat(t,"(").concat(n,"(uniforms.clip_max)));");case"HardSigmoid":return"value = max(".concat(t,"(0.0), min(").concat(t,"(1.0), ").concat(n,"(uniforms.alpha) * value + ").concat(n,"(uniforms.beta)));");case"LeakyRelu":return"value = select(".concat(n,"(uniforms.alpha) * value, value, value >= ").concat(t,"(0.0));");case"Tanh":return"let e2x = exp(-2.0 * abs(value));\n              value = sign(value) * (1.0 - e2x) / (1.0 + e2x);\n        ";case"":return"";default:throw new Error("Unsupported activation ".concat(e.activation))}},gM=(e,t)=>{"Clip"===e.activation?t.push({type:1,data:e.clipMax},{type:1,data:e.clipMin}):"HardSigmoid"===e.activation?t.push({type:1,data:e.alpha},{type:1,data:e.beta}):"LeakyRelu"===e.activation&&t.push({type:1,data:e.alpha})},_M=(e,t)=>{"Clip"===e.activation?t.push({name:"clip_max",type:"f32"},{name:"clip_min",type:"f32"}):"HardSigmoid"===e.activation?t.push({name:"alpha",type:"f32"},{name:"beta",type:"f32"}):"LeakyRelu"===e.activation&&t.push({name:"alpha",type:"f32"})},vM=e=>{let t=(null===e||void 0===e?void 0:e.activation)||"";if("HardSigmoid"===t){let[n,r]=(null===e||void 0===e?void 0:e.activation_params)||[.2,.5];return{activation:t,alpha:n,beta:r}}if("Clip"===t){let[n,r]=(null===e||void 0===e?void 0:e.activation_params)||[GS,HS];return{activation:t,clipMax:r,clipMin:n}}if("LeakyRelu"===t){let[n]=(null===e||void 0===e?void 0:e.activation_params)||[.01];return{activation:t,alpha:n}}return{activation:t}}})),tO=pD((()=>{yM=(e,t)=>{switch(e){case 1:return t;case 2:return"vec2<".concat(t,">");case 3:return"vec3<".concat(t,">");case 4:return"vec4<".concat(t,">");default:throw new Error("".concat(e,"-component is not supported."))}},wM=e=>"\n      ".concat(e?"value = value + getBiasByOutputCoords(coords);":"","\n      ")})),nO=pD((()=>{bM=e=>"\nfn getIndexFromCoords4D(coords : vec4<i32>, shape : vec4<i32>) -> i32 {\n  return dot(coords, vec4<i32>(\n      shape.y * shape.z * shape.w, shape.z * shape.w, shape.w, 1));\n}\nfn getOutputIndexFromCoords(coords : vec4<i32>) -> i32 {\n  return dot(coords, vec4<i32>(\n    i32(".concat(e,".x), i32(").concat(e,".y), i32(").concat(e,".z), 1));\n}\n")})),rO=pD((()=>{Iz(),Oz(),qz(),eO(),xM=(e,t,n,r,o)=>{let a=r-n;return"\n      ".concat(Array.from({length:n}).map(((n,i)=>"\n      if (".concat(EE(t.shape,i,t.rank)," != 1) {\n        ").concat(t.indicesSet(e,i,EE(o,i+a,r)),"\n      } else {\n        ").concat(t.indicesSet(e,i,0),"\n      }"))).join(""),"\n")},kM=function(e,t,n,r){let o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a=arguments.length>5?arguments[5]:void 0,i=e[0].dims,s=e[1].dims,l=i[i.length-2],c=s[s.length-1],u=i[i.length-1],d=kE(c),p=kE(u),h=kE(l),f=qS.size(n)/d/h,m=e.length>2,g=r?r.slice(0,-2):n.slice(0,-2),_=[qS.size(g),l,c],v=[{type:12,data:f},{type:12,data:l},{type:12,data:c},{type:12,data:u}];gM(t,v),v.push(...xE(g,i,s)),m&&v.push(...xE(e[2].dims)),v.push(...xE(_));return{name:"MatMulNaive",shaderCache:{hint:"".concat(t.activation,";").concat(d,";").concat(p,";").concat(h,";").concat(o),inputDependencies:m?["rank","rank","rank"]:["rank","rank"]},getRunData:()=>({outputs:[{dims:a?a(n):n,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(f/64)},programUniforms:v}),getShaderSource:r=>{let a=IE("batch_dims",e[0].dataType,g.length),l=AE("a",e[0].dataType,i.length,p),c=AE("b",e[1].dataType,s.length,d),u=ME("output",e[0].dataType,_.length,d),f=wE(u.type.tensor),v=mM(t,u.type.value,f),y=[l,c],w="";if(m){let t=o?d:1;y.push(AE("bias",e[2].dataType,e[2].dims.length,t)),w="".concat(o?"value += bias[col / ".concat(t,"];"):"value += ".concat(u.type.value,"(bias[row + i]);"))}let b=[{name:"output_size",type:"u32"},{name:"M",type:"u32"},{name:"N",type:"u32"},{name:"K",type:"u32"}];_M(t,b);return"\n  ".concat(r.registerUniforms(b).registerInternalVariables(a).declareVariables(...y,u),"\n  ").concat(r.mainStart(),"\n    ").concat(r.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size"),"\n    let col = (global_idx % (uniforms.N / ").concat(d,")) * ").concat(d,";\n    var index1 = global_idx / (uniforms.N / ").concat(d,");\n    let stride1 = uniforms.M / ").concat(h,";\n    let row = (index1 % stride1) * ").concat(h,";\n    let batch = index1 / stride1;\n\n    ").concat(2===n.length?"":"let batch_indices = ".concat(a.offsetToIndices("batch"),";"),"\n\n    var a_indices: ").concat(l.type.indices,";\n    ").concat(xM("a_indices",l,l.rank-2,a.rank,"batch_indices"),"\n    ").concat(l.indicesSet("a_indices",l.rank-2,0),"\n    ").concat(l.indicesSet("a_indices",l.rank-1,0),"\n    let a_offset = ").concat(l.indicesToOffset("a_indices"),";\n\n    var b_indices: ").concat(c.type.indices,";\n    ").concat(xM("b_indices",c,c.rank-2,a.rank,"batch_indices"),"\n    ").concat(c.indicesSet("b_indices",c.rank-2,0),"\n    ").concat(c.indicesSet("b_indices",c.rank-1,0),"\n    let b_offset = ").concat(c.indicesToOffset("b_indices"),";\n    var values: array<").concat(u.type.value,", ").concat(h,">;\n    for (var k: u32 = 0u; k < uniforms.K; k = k + ").concat(p,") {\n      ").concat((()=>{let e="var a_data: ".concat(l.type.value,";");for(let t=0;t<p;t++)e+="\n              let b_data".concat(t," = b[(b_offset + (k + ").concat(t,") * uniforms.N + col) / ").concat(d,"];");for(let t=0;t<h;t++){e+="a_data = a[(a_offset + (row + ".concat(t,") * uniforms.K + k) / ").concat(p,"];");for(let n=0;n<p;n++)e+="\n            values[".concat(t,"] = fma(").concat(c.type.value,"(a_data").concat(1===p?"":"[".concat(n,"]"),"), b_data").concat(n,", values[").concat(t,"]);\n")}return e})(),"\n    }\n    for (var i = 0u; i < ").concat(h,"u; i++) {\n      var value = values[i];\n      ").concat(w,"\n      ").concat(v,"\n      let cur_indices = ").concat(u.type.indices,"(batch, row + i, col);\n      let offset = ").concat(u.indicesToOffset("cur_indices"),";\n      ").concat(u.setByOffset("offset / ".concat(d),"value"),";\n    }\n  }\n  ")}}}})),oO=pD((()=>{Iz(),Oz(),qz(),eO(),rO(),tO(),CM=(e,t)=>e?"\n        mm_Asub[inputRow][inputCol] = mm_readA(batch,\n          kStart + inputRow,\n          globalRowStart / innerElementSize + inputCol".concat(t?", batchIndices":"",");\n        "):"\n        mm_Asub[inputRow][inputCol] = mm_readA(batch,\n          globalRow + innerRow,\n          kStart / innerElementSize + inputCol".concat(t?", batchIndices":"",");\n        "),DM=(e,t)=>e?"\n        let ACached0 = mm_Asub[k * innerElementSize][localRow];\n        let ACached1 = mm_Asub[k * innerElementSize + 1][localRow];\n        let ACached2 = mm_Asub[k * innerElementSize + 2][localRow];\n        ".concat(3===t?"":"let ACached3 = mm_Asub[k * innerElementSize + 3][localRow];","\n        for (var i = 0; i < rowPerThread; i = i + 1) {\n          acc[i] = BCached0 * ACached0[i] + acc[i];\n          acc[i] = BCached1 * ACached1[i] + acc[i];\n          acc[i] = BCached2 * ACached2[i] + acc[i];\n          ").concat(3===t?"":"acc[i] = BCached3 * ACached3[i] + acc[i];","\n        }"):"\n        for (var i = 0; i < rowPerThread; i = i + 1) {\n          let ACached = mm_Asub[tileRow + i][k];\n          acc[i] = BCached0 * ACached.x + acc[i];\n          acc[i] = BCached1 * ACached.y + acc[i];\n          acc[i] = BCached2 * ACached.z + acc[i];\n          ".concat(3===t?"":"acc[i] = BCached3 * ACached.w + acc[i];","\n        }"),SM=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"f32",r=arguments.length>3?arguments[3]:void 0,o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:32,i=arguments.length>6&&void 0!==arguments[6]&&arguments[6],s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:32,l=t[1]*e[1],c=t[0]*e[0],u=o?l:a,d=o?a:l,p=u/t[0],h=a/t[1];if((!o||4!==p||4!==e[1])&&(o||3!==p&&4!==p)||u%t[0]!==0||a%t[1]!==0||4!==e[0])throw new Error("If transposeA ".concat(o," is true, innerElementSize ").concat(p," and workPerThread[1] ").concat(e[1]," must be 4.\n      Otherwise, innerElementSize ").concat(p," must be 3 or 4.\n  tileAWidth ").concat(u," must be divisible by workgroupSize[0]").concat(t[0],". tileInner ").concat(a," must be divisible by workgroupSize[1] ").concat(t[1],". colPerThread ").concat(e[0]," must be 4."));return"\nvar<workgroup> mm_Asub: array<array<vec".concat(p,"<").concat(n,">, ").concat(u/p,">, ").concat(d,">;\nvar<workgroup> mm_Bsub: array<array<vec4<").concat(n,">, ").concat(c/e[0],">, ").concat(a,">;\n\nconst rowPerThread = ").concat(e[1],";\nconst colPerThread = ").concat(e[0],";\nconst innerElementSize = ").concat(p,";\nconst tileInner = ").concat(a,";\n\n@compute @workgroup_size(").concat(t[0],", ").concat(t[1],", ").concat(t[2],")\nfn main(@builtin(local_invocation_id) localId : vec3<u32>,\n        @builtin(global_invocation_id) globalId : vec3<u32>,\n        @builtin(workgroup_id) workgroupId : vec3<u32>) {\n  let localRow = i32(localId.y);\n  let tileRow = localRow * rowPerThread;\n  let tileCol = i32(localId.x);\n\n  let globalRow =i32(globalId.y) * rowPerThread;\n  let globalCol = i32(globalId.x);\n  let batch = ").concat(i?"0":"i32(globalId.z)",";\n  ").concat(r?"let batchIndices = ".concat(r.offsetToIndices("u32(batch)"),";"):"","\n  let globalRowStart = i32(workgroupId.y) * ").concat(l,";\n\n  let num_tiles = ").concat(i?"".concat(Math.ceil(s/a)):"(uniforms.dim_inner - 1) / tileInner + 1",";\n  var kStart = ").concat(i?"i32(globalId.z) * ".concat(s):"0",";\n\n  var acc: array<vec4<").concat(n,">, rowPerThread>;\n\n  // Loop over shared dimension.\n  let tileRowB = localRow * ").concat(h,";\n  for (var t = 0; t < num_tiles; t = t + 1) {\n      // Load one tile of A into local memory.\n      for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {\n          let inputRow = tileRow + innerRow;\n          let inputCol = tileCol;\n          ").concat(CM(o,r),"\n      }\n\n      // Load one tile of B into local memory.\n      for (var innerRow = 0; innerRow < ").concat(h,"; innerRow = innerRow + 1) {\n          let inputRow = tileRowB + innerRow;\n          let inputCol = tileCol;\n          mm_Bsub[inputRow][inputCol] = mm_readB(batch, kStart + inputRow, globalCol").concat(r?", batchIndices":"",");\n      }\n      kStart = kStart + tileInner;\n      workgroupBarrier();\n\n      // Compute acc values for a single thread.\n      for (var k = 0; k < tileInner / innerElementSize; k = k + 1) {\n          let BCached0 = mm_Bsub[k * innerElementSize][tileCol];\n          let BCached1 = mm_Bsub[k * innerElementSize + 1][tileCol];\n          let BCached2 = mm_Bsub[k * innerElementSize + 2][tileCol];\n          ").concat(3===p?"":"let BCached3 = mm_Bsub[k * innerElementSize + 3][tileCol];","\n\n          ").concat(DM(o,p),"\n      }\n\n      workgroupBarrier();\n  }\n\n  for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {\n      mm_write(batch, globalRow + innerRow, globalCol, acc[innerRow]);\n  }\n}")},EM=(e,t)=>e?"\n            mm_Asub[inputRow][inputCol] = mm_readA(batch,\n              kStart + inputRow,\n              globalRowStart + inputCol".concat(t?", batchIndices":"",");\n            "):"\n            mm_Asub[inputRow][inputCol] = mm_readA(batch,\n              globalRowStart + inputRow,\n              kStart + inputCol".concat(t?", batchIndices":"",");\n            "),TM=e=>e?"let ACached = mm_Asub[k][tileRow + innerRow];":"let ACached = mm_Asub[tileRow + innerRow][k];",AM=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"f32",r=arguments.length>3?arguments[3]:void 0,o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:32,i=arguments.length>6&&void 0!==arguments[6]&&arguments[6],s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:32,l=arguments.length>8&&void 0!==arguments[8]&&arguments[8],c=e[1]*t[1],u=e[0]*t[0],d=o?c:a,p=o?a:c;if(p%t[1]!==0||d%t[0]!==0||a%t[1]!==0)throw new Error("tileAHight ".concat(p," must be divisible by workgroupSize[1]").concat(t[1],", tileAWidth ").concat(d," must be divisible by workgroupSize[0]").concat(t[0],", tileInner ").concat(a," must be divisible by workgroupSize[1]").concat(t[1]));let h=p/t[1],f=d/t[0],m=a/t[1],g=l?"\n    let localRow = i32(localId.y);\n    let localCol = i32(localId.x);\n    let globalRowStart = i32(workgroupId.y) * ".concat(c,";\n    let globalColStart = i32(workgroupId.x) * ").concat(u,";\n\n    // Loop over shared dimension.\n    for (var t = 0; t < num_tiles; t = t + 1) {\n      // Load one tile of A into local memory.\n      for (var inputRow = localRow; inputRow < ").concat(p,"; inputRow = inputRow + ").concat(t[1],") {\n        for (var inputCol = localCol; inputCol < ").concat(d,"; inputCol = inputCol + ").concat(t[0],") {\n          ").concat(EM(o,r),"\n        }\n      }\n      // Load one tile of B into local memory.\n      for (var inputRow = localRow; inputRow < ").concat(a,"; inputRow = inputRow + ").concat(t[1],") {\n            for (var inputCol = localCol; inputCol < ").concat(u,"; inputCol = inputCol + ").concat(t[0],") {\n          mm_Bsub[inputRow][inputCol] = mm_readB(batch,\n            kStart + inputRow,\n            globalColStart + inputCol").concat(r?", batchIndices":"",");\n        }\n      }\n      kStart = kStart + tileInner;\n      workgroupBarrier();\n\n      // Compute acc values for a single thread.\n      var BCached : array<").concat(n,", colPerThread>;\n      for (var k = 0; k < tileInner; k = k + 1) {\n        for (var inner = 0; inner < colPerThread; inner = inner + 1) {\n          BCached[inner] = mm_Bsub[k][localCol + inner * ").concat(t[0],"];\n        }\n        for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {\n          let ACached = ").concat(o?"mm_Asub[k][localRow + innerRow * ".concat(t[1],"];"):"mm_Asub[localRow + innerRow * ".concat(t[1],"][k];"),"\n          for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {\n            acc[innerRow][innerCol] = acc[innerRow][innerCol] +\n                ACached * BCached[innerCol];\n          }\n        }\n      }\n      workgroupBarrier();\n    }\n    for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {\n      let gRow = globalRowStart + localRow + innerRow * ").concat(t[1],";\n      for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {\n        let gCol = globalColStart + localCol + innerCol * ").concat(t[0],";\n        mm_write(batch, gRow, gCol, acc[innerRow][innerCol]);\n      }\n    }\n    "):"\nlet tileRow = i32(localId.y) * rowPerThread;\nlet tileCol = i32(localId.x) * colPerThread;\n\nlet globalRow = i32(globalId.y) * rowPerThread;\nlet globalCol = i32(globalId.x) * colPerThread;\nlet globalRowStart = i32(workgroupId.y) * ".concat(c,";\n\nlet tileRowA = i32(localId.y) * ").concat(h,";\nlet tileColA = i32(localId.x) * ").concat(f,";\nlet tileRowB = i32(localId.y) * ").concat(m,";\n// Loop over shared dimension.\nfor (var t = 0; t < num_tiles; t = t + 1) {\n  // Load one tile of A into local memory.\n  for (var innerRow = 0; innerRow < ").concat(h,"; innerRow = innerRow + 1) {\n    for (var innerCol = 0; innerCol < ").concat(f,"; innerCol = innerCol + 1) {\n      let inputRow = tileRowA + innerRow;\n      let inputCol = tileColA + innerCol;\n      ").concat(EM(o,r),"\n    }\n  }\n\n  // Load one tile of B into local memory.\n  for (var innerRow = 0; innerRow < ").concat(m,"; innerRow = innerRow + 1) {\n    for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {\n      let inputRow = tileRowB + innerRow;\n      let inputCol = tileCol + innerCol;\n      mm_Bsub[inputRow][inputCol] = mm_readB(batch,\n        kStart + inputRow,\n        globalCol + innerCol").concat(r?", batchIndices":"",");\n    }\n  }\n  kStart = kStart + tileInner;\n  workgroupBarrier();\n\n  // Compute acc values for a single thread.\n  var BCached : array<").concat(n,", colPerThread>;\n  for (var k = 0; k < tileInner; k = k + 1) {\n    for (var inner = 0; inner < colPerThread; inner = inner + 1) {\n      BCached[inner] = mm_Bsub[k][tileCol + inner];\n    }\n\n    for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {\n      ").concat(TM(o),"\n      for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {\n        acc[innerRow][innerCol] = acc[innerRow][innerCol] + ACached * BCached[innerCol];\n      }\n    }\n  }\n\n  workgroupBarrier();\n}\n\nfor (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {\n  for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {\n    mm_write(batch, globalRow + innerRow, globalCol + innerCol,\n        acc[innerRow][innerCol]);\n  }\n}\n");return"\n  var<workgroup> mm_Asub : array<array<".concat(n,", ").concat(d,">, ").concat(p,">;\n  var<workgroup> mm_Bsub : array<array<").concat(n,", ").concat(u,">, ").concat(a,">;\n  const rowPerThread = ").concat(e[1],";\n  const colPerThread = ").concat(e[0],";\n  const tileInner = ").concat(a,";\n\n@compute @workgroup_size(").concat(t[0],", ").concat(t[1],", ").concat(t[2],")\nfn main(@builtin(local_invocation_id) localId : vec3<u32>,\n        @builtin(global_invocation_id) globalId : vec3<u32>,\n        @builtin(workgroup_id) workgroupId : vec3<u32>) {\n    let batch = ").concat(i?"0":"i32(globalId.z)",";\n    ").concat(r?"let batchIndices = ".concat(r.offsetToIndices("u32(batch)"),";"):"","\n    let num_tiles = ").concat(i?"".concat(Math.ceil(s/a)):"(uniforms.dim_inner - 1) / tileInner + 1",";\n    var kStart = ").concat(i?"i32(globalId.z) * ".concat(s):"0",";\n\n    var acc : array<array<").concat(n,", colPerThread>, rowPerThread>;\n    ").concat(g,"\n  }\n")},MM=function(e,t,n,r){let o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],[a,i,s,l]=r,c=wE(r[0].type.tensor);return"\n    fn mm_readA(batch: i32, row: i32, colIn: i32, batchIndices: ".concat(a.type.indices,") -> ").concat(yM(e,c)," {\n      var value = ").concat(yM(e,c),"(0.0);\n      let col = colIn * ").concat(e,";\n      if(row < uniforms.dim_a_outer && col < uniforms.dim_inner)\n      {\n        var aIndices: ").concat(i.type.indices,";\n        ").concat(xM("aIndices",i,i.rank-2,a.rank,"batchIndices"),"\n        ").concat(i.indicesSet("aIndices",i.rank-2,"u32(row)"),"\n        ").concat(i.indicesSet("aIndices",i.rank-1,"u32(colIn)"),"\n        value = ").concat(i.getByIndices("aIndices"),";\n      }\n      return value;\n    }\n\n    fn mm_readB(batch: i32, row: i32, colIn: i32, batchIndices: ").concat(a.type.indices,") -> ").concat(yM(e,c)," {\n      var value = ").concat(yM(e,c),"(0.0);\n      let col = colIn * ").concat(e,";\n      if(row < uniforms.dim_inner && col < uniforms.dim_b_outer)\n      {\n        var bIndices: ").concat(s.type.indices,";\n        ").concat(xM("bIndices",s,s.rank-2,a.rank,"batchIndices"),"\n        ").concat(s.indicesSet("bIndices",s.rank-2,"u32(row)"),"\n        ").concat(s.indicesSet("bIndices",s.rank-1,"u32(colIn)"),"\n        value = ").concat(s.getByIndices("bIndices"),";\n      }\n      return value;\n    }\n\n    fn mm_write(batch: i32, row: i32, colIn: i32, valueIn: ").concat(yM(e,c),") {\n      let col = colIn * ").concat(e,";\n      if (row < uniforms.dim_a_outer && col < uniforms.dim_b_outer) {\n        var value = valueIn;\n        let coords = vec3<i32>(batch, row, colIn);\n        ").concat(t?"value = value + ".concat(o?"bias[colIn]":"".concat(yM(e,c),"(bias[row])"),";"):"","\n        ").concat(n,"\n        ").concat(l.setByIndices("vec3<u32>(coords)","value"),"\n      }\n    }\n    ")},FM=function(e,t,n,r){let o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a=arguments.length>5?arguments[5]:void 0,i=e[0].dims,s=e[1].dims,l=i.slice(0,-2),c=s.slice(0,-2),u=r?r.slice(0,-2):n.slice(0,-2),d=qS.size(u),p=i[i.length-2],h=i[i.length-1],f=s[s.length-1],m=h%4===0&&f%4===0,g=p<=8?[4,1,1]:[4,4,1],_=[8,8,1],v=[Math.ceil(f/_[0]/g[0]),Math.ceil(p/_[1]/g[1]),Math.ceil(d/_[2]/g[2])],y=m?4:1,w=[...l,p,h/y],b=w.length,x=[...c,h,f/y],k=x.length,C=[d,p,f/y],D=[{type:6,data:p},{type:6,data:f},{type:6,data:h}];gM(t,D),D.push(...xE(u,w,x));let S=["rank","rank"],E=e.length>2;E&&(D.push(...xE(e[2].dims)),S.push("rank")),D.push(...xE(C));return{name:"MatMul",shaderCache:{hint:"".concat(g,";").concat(t.activation,";").concat(m,";").concat(o),inputDependencies:S},getRunData:()=>({outputs:[{dims:a?a(n):n,dataType:e[0].dataType}],dispatchGroup:{x:v[0],y:v[1],z:v[2]},programUniforms:D}),getShaderSource:n=>{let r=u.length,a=IE("batchDims",e[0].dataType,r,1),i=wE(e[0].dataType),s=AE("a",e[0].dataType,b,y),l=AE("b",e[1].dataType,k,y),c=ME("result",e[0].dataType,C.length,y),d=[s,l];if(E){let t=o?y:1;d.push(AE("bias",e[2].dataType,e[2].dims.length,t))}let p=[{name:"dim_a_outer",type:"i32"},{name:"dim_b_outer",type:"i32"},{name:"dim_inner",type:"i32"}];_M(t,p);let h=wE(c.type.tensor),f=mM(t,c.type.value,h),v=MM(y,E,f,[a,s,l,c],o);return"\n  ".concat(n.registerUniforms(p).registerInternalVariables(a).declareVariables(...d,c),"\n  ").concat(v,"\n  ").concat(m?SM(g,_,i,a):AM(g,_,i,a),"\n                   ")}}}})),aO=pD((()=>{Iz(),zz(),qz(),eO(),tO(),nO(),oO(),IM=function(e,t,n,r){let o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a=arguments.length>5?arguments[5]:void 0,i=arguments.length>6&&void 0!==arguments[6]?arguments[6]:4,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:4,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:4,c=arguments.length>9&&void 0!==arguments[9]?arguments[9]:"f32",u=e=>{switch(e){case 1:return"return w[row * i32(uniforms.w_shape[3]) + colIn];";case 4:return"return w[row * i32(uniforms.w_shape[3]) / 4 + colIn];";default:throw new Error("innerElementSize ".concat(e," is not supported."))}},d=e?"\n    let coord = vec4<i32>(batch, xRow, xCol, xCh);\n    ":"\n    let coord = vec4<i32>(batch, xCh, xRow, xCol);\n    ",p=e?"\n    let coords = vec4<i32>(\n      batch,\n      row / outWidth,\n      row % outWidth,\n      col);\n    ":"\n    let coords = vec4<i32>(\n      batch,\n      row,\n      col / outWidth,\n      col % outWidth);\n    ",h=e?"i32(uniforms.x_shape[1])":"i32(uniforms.x_shape[2])",f=e?"i32(uniforms.x_shape[2])":"i32(uniforms.x_shape[3])",m=e?"row":"col",g=e?"col":"row",_="\n    let inChannels = i32(uniforms.w_shape[2]);\n    let outWidth = ".concat(e?"i32(uniforms.result_shape[2])":"i32(uniforms.result_shape[3])",";\n    let outRow = ").concat(m," / outWidth;\n    let outCol = ").concat(m," % outWidth;\n\n    let WRow = ").concat(g," / (i32(uniforms.w_shape[1]) * inChannels);\n    let WCol = ").concat(g," / inChannels % i32(uniforms.w_shape[1]);\n    let xRow = outRow * uniforms.stride[0] + uniforms.dilation[0] * WRow - uniforms.pad[0];\n    let xCol = outCol * uniforms.stride[1] + uniforms.dilation[1] * WCol - uniforms.pad[1];\n    let xCh = ").concat(g," % inChannels;\n    var resData = ").concat(yM(i,c),"(0.0);\n    // The bounds checking is always needed since we use it to pad zero for\n    // the 'same' padding type.\n    if (xRow >= 0 && xRow < ").concat(h," && xCol >= 0 && xCol < ").concat(f,") {\n      ").concat(d,"\n      let xIndex = getIndexFromCoords4D(coord, vec4<i32>(uniforms.x_shape));\n      ").concat((e=>{switch(e){case 1:return"resData = x[xIndex];";case 3:return"resData = vec3<".concat(c,">(x[xIndex], x[xIndex + 1], x[xIndex + 2]);");case 4:return"resData = x[xIndex / 4];";default:throw new Error("innerElementSize ".concat(e," is not supported."))}})(i),"\n    }\n    return resData;"),v=e?t&&r?"\n    let col = colIn * ".concat(i,";\n    ").concat(_):"\n    let col = colIn * ".concat(i,";\n    if (row < uniforms.dim_a_outer && col < uniforms.dim_inner) {\n      ").concat(_,"\n    }\n    return ").concat(yM(i,c),"(0.0);"):r&&n?"\n    let col = colIn * ".concat(i,";\n    ").concat(_):"\n    let col = colIn * ".concat(i,";\n    if (row < uniforms.dim_inner && col < uniforms.dim_b_outer) {\n      ").concat(_,"\n    }\n    return ").concat(yM(i,c),"(0.0);"),y=e?r&&n?u(s):"\n    let col = colIn * ".concat(s,";\n    if (row < uniforms.dim_inner && col < uniforms.dim_b_outer) {\n      ").concat(u(s),"\n    }\n    return ").concat(yM(s,c),"(0.0);"):"\n    let col = colIn * ".concat(s,";\n    if (row < uniforms.dim_inner && col < uniforms.dim_a_outer) {\n      ").concat(u(s),"\n    }\n    return ").concat(yM(s,c),"(0.0);"),w=yM(l,c),b=yM(e?i:s,c),x=yM(e?s:i,c),k=mM(a,w,c);return"\n    fn mm_readA(batch: i32, row : i32, colIn : i32) -> ".concat(b," {\n      ").concat(e?v:y,"\n    }\n\n    fn mm_readB(batch: i32, row : i32, colIn : i32) -> ").concat(x," {\n      ").concat(e?y:v,"\n    }\n\n    fn mm_write(batch: i32, row : i32, colIn : i32, valueIn : ").concat(w,") {\n      let col = colIn * ").concat(l,";\n      if (row < uniforms.dim_a_outer && col < uniforms.dim_b_outer)\n      {\n      var value = valueIn;\n      let outWidth = ").concat(e?"i32(uniforms.result_shape[2])":"i32(uniforms.result_shape[3])",";\n      ").concat(p,"\n      ").concat(wM(o),"\n      ").concat(k,"\n      setOutputAtCoords(coords[0], coords[1], coords[2], coords[3], value);\n      }\n    }")},PM=(e,t,n,r,o,a,i,s,l)=>{let c="NHWC"===t.format,u=c?e[0].dims[3]:e[0].dims[1],d=n[0],p=c?n[2]:n[3],h=c?n[1]:n[2],f=c?n[3]:n[1],m=c&&(u%4===0||u%3===0)&&f%4===0,g=c?f:p*h,_=c?p*h:f,v=[8,8,1],y=r<=8?[4,1,1]:[4,4,1],w=[Math.ceil(g/v[0]/y[0]),Math.ceil(_/v[1]/y[1]),Math.ceil(d/v[2]/y[2])];LS("verbose",(()=>"[conv2d_mm_webgpu] dispatch = ".concat(w)));let b=m?c&&u%4!==0?3:4:1,x=v[1]*y[1],k=v[0]*y[0],C=Math.max(v[0]*b,v[1]),D=r%x===0,S=o%k===0,E=a%C===0,T=m?[b,4,4]:[1,1,1],A=[{type:6,data:r},{type:6,data:o},{type:6,data:a},{type:6,data:[t.pads[0],t.pads[1]]},{type:6,data:t.strides},{type:6,data:t.dilations}];gM(t,A),A.push(...xE(e[0].dims,e[1].dims));let M=["rank","rank"];i&&(A.push(...xE(e[2].dims)),M.push("rank")),A.push(...xE(n));return{name:"Conv2DMatMul",shaderCache:{hint:"".concat(t.cacheKey,";").concat(b,";").concat(m,";").concat(D,";").concat(S,";").concat(E,";").concat(x,";").concat(k,";").concat(C),inputDependencies:M},getRunData:()=>({outputs:[{dims:l?l(n):n,dataType:e[0].dataType}],dispatchGroup:{x:w[0],y:w[1],z:w[2]},programUniforms:A}),getShaderSource:r=>{let o=[{name:"dim_a_outer",type:"i32"},{name:"dim_b_outer",type:"i32"},{name:"dim_inner",type:"i32"},{name:"pad",type:"i32",length:2},{name:"stride",type:"i32",length:2},{name:"dilation",type:"i32",length:2}];_M(t,o);let a=m?4:1,l=wE(e[0].dataType),u="\n      fn setOutputAtIndex(flatIndex : i32, value : ".concat(m?"vec4<".concat(l,">"):l,") {\n        result[flatIndex] = ").concat(m?"vec4<".concat(l,">"):l,"(value);\n      }\n      fn setOutputAtCoords(d0 : i32, d1 : i32, d2 : i32, d3 : i32, value : ").concat(m?"vec4<".concat(l,">"):l,") {\n        let flatIndex = getOutputIndexFromCoords(vec4<i32>(d0, d1, d2, d3));\n        setOutputAtIndex(flatIndex ").concat(m?"/ 4":"",", value);\n      }"),d=[AE("x",e[0].dataType,e[0].dims.length,3===b?1:b),AE("w",e[1].dataType,e[1].dims.length,a)],p=ME("result",e[0].dataType,n.length,a);if(i){let t=AE("bias",e[2].dataType,e[2].dims.length,a);d.push(t),u+="\n        fn getBiasByOutputCoords(coords : vec4<i32>) -> ".concat(m?"vec4<".concat(l,">"):l," {\n          return bias[coords.").concat(c?"w":"y").concat(m?"/ 4":"","];\n        }")}return"\n        ".concat(bM("uniforms.result_strides"),"\n        //struct Uniforms { xShape : vec4<i32>, wShape : vec4<i32>, outShape : vec4<i32>,\n        //  outShapeStrides: vec3<i32>, filterDims : vec2<i32>, pad : vec2<i32>, stride : vec2<i32>,\n        //  dilation : vec2<i32>, dimAOuter : i32, dimBOuter : i32, dimInner : i32 };\n        ").concat(r.registerUniforms(o).declareVariables(...d,p),"\n        ").concat(u,"\n        ").concat(IM(c,D,S,E,i,t,T[0],T[1],T[2],l),"\n        ").concat(m?SM(y,v,l,void 0,!c,C):AM(y,v,l,void 0,!c,C,!1,void 0,s))}}}})),iO=pD((()=>{Iz(),zz(),Oz(),qz(),eO(),tO(),zM=e=>{let t=1;for(let n=0;n<e.length;n++)t*=e[n];return t},OM=e=>"number"==typeof e?[e,e,e]:e,NM=(e,t)=>t<=1?e:e+(e-1)*(t-1),BM=function(e,t,n){let r=NM(t,arguments.length>3&&void 0!==arguments[3]?arguments[3]:1);return Math.floor((e[0]*(n-1)-n+r)/2)},jM=(e,t,n,r,o)=>{null==o&&(o=BM(e,t[0],r[0]));let a=[0,0,0,n];for(let i=0;i<3;i++)e[i]+2*o>=t[i]&&(a[i]=Math.trunc((e[i]-t[i]+2*o)/r[i]+1));return a},LM=(e,t,n,r,o,a,i,s,l,c)=>{let u,d,p,h;if("VALID"===e&&(e=0),"number"==typeof e){u={top:e,bottom:e,left:e,right:e,front:e,back:e};let f=jM([t,n,r,1],[s,l,c],1,[o,a,i],e);d=f[0],p=f[1],h=f[2]}else if(Array.isArray(e)){if(!e.every(((e,t,n)=>e===n[0])))throw Error("Unsupported padding parameter: ".concat(e));u={top:e[0],bottom:e[1],left:e[2],right:e[3],front:e[4],back:e[5]};let f=jM([t,n,r,1],[s,l,c],1,[o,a,i],e[0]);d=f[0],p=f[1],h=f[2]}else{if("SAME_UPPER"!==e)throw Error("Unknown padding parameter: ".concat(e));{d=Math.ceil(t/o),p=Math.ceil(n/a),h=Math.ceil(r/i);let e=(d-1)*o+s-t,f=(p-1)*a+l-n,m=(h-1)*i+c-r,g=Math.floor(e/2),_=e-g,v=Math.floor(f/2),y=f-v,w=Math.floor(m/2);u={top:v,bottom:y,left:w,right:m-w,front:g,back:_}}}return{padInfo:u,outDepth:d,outHeight:p,outWidth:h}},RM=function(e,t,n,r,o){let a,i,s,l,c,u=arguments.length>5&&void 0!==arguments[5]&&arguments[5],d=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"channelsLast";if("channelsLast"===d)[a,i,s,l,c]=e;else{if("channelsFirst"!==d)throw new Error("Unknown dataFormat ".concat(d));[a,c,i,s,l]=e}let[p,,h,f,m]=t,[g,_,v]=OM(n),[y,w,b]=OM(r),x=NM(h,y),k=NM(f,w),C=NM(m,b),{padInfo:D,outDepth:S,outHeight:E,outWidth:T}=LM(o,i,s,l,g,_,v,x,k,C),A=u?p*c:p,M=[0,0,0,0,0];return"channelsFirst"===d?M=[a,A,S,E,T]:"channelsLast"===d&&(M=[a,S,E,T,A]),{batchSize:a,dataFormat:d,inDepth:i,inHeight:s,inWidth:l,inChannels:c,outDepth:S,outHeight:E,outWidth:T,outChannels:A,padInfo:D,strideDepth:g,strideHeight:_,strideWidth:v,filterDepth:h,filterHeight:f,filterWidth:m,effectiveFilterDepth:x,effectiveFilterHeight:k,effectiveFilterWidth:C,dilationDepth:y,dilationHeight:w,dilationWidth:b,inShape:e,outShape:M,filterShape:t}},VM=(e,t,n,r,o,a)=>{let i="channelsLast"===a,s=(i?e[0].dims[3]:e[0].dims[1],{x:n.map(((e,t)=>t))}),l=[Math.ceil(zM(s.x.map((e=>n[e])))/64),1,1];LS("verbose",(()=>"[conv3d_naive_webgpu] dispatch = ".concat(l)));let c=[{type:12,data:qS.size(n)},{type:12,data:r},{type:12,data:o},{type:12,data:t.strides},{type:12,data:t.dilations}];gM(t,c),c.push(...xE(e[0].dims,e[1].dims));let u=["rank","rank"],d=3===e.length;d&&(c.push(...xE(e[2].dims)),u.push("rank")),c.push(...xE(n));return{name:"Conv3DNaive",shaderCache:{hint:"".concat(t.cacheKey,";").concat(i,";").concat(1,";").concat(d),inputDependencies:u},getRunData:()=>({outputs:[{dims:n,dataType:e[0].dataType}],dispatchGroup:{x:l[0],y:l[1],z:l[2]},programUniforms:c}),getShaderSource:a=>{let s=[{name:"output_size",type:"u32"},{name:"filter_dims",type:"u32",length:r.length},{name:"pads",type:"u32",length:o.length},{name:"strides",type:"u32",length:t.strides.length},{name:"dilations",type:"u32",length:t.dilations.length}];_M(t,s);let l=wE(e[0].dataType),c=AE("x",e[0].dataType,e[0].dims.length,1),u=AE("W",e[1].dataType,e[1].dims.length,1),p=[c,u],h=ME("result",e[0].dataType,n.length,1),f="";if(d){let t=AE("bias",e[2].dataType,e[2].dims.length,1);p.push(t),f+="\n        fn getBiasByOutputCoords(coords : array<u32, 5>) -> ".concat(l," {\n          return bias[").concat(EE("coords",i?4:1,5)).concat("","];\n        }")}let m=yM(1,l),g=mM(t,m,l);return"\n            ".concat(f,"\n            fn getX(d0 : u32, d1 : u32, d2 : u32, d3 : u32, d4 : u32) -> f32 {\n              let aIndices = array<u32, 5>(d0, d1, d2, d3, d4);\n              return ").concat(c.getByIndices("aIndices"),";\n            }\n            fn getW(d0 : u32, d1 : u32, d2 : u32, d3 : u32, d4 : u32) -> f32 {\n              let aIndices = array<u32, 5>(d0, d1, d2, d3, d4);\n              return ").concat(u.getByIndices("aIndices"),";\n            }\n          ").concat(a.registerUniforms(s).declareVariables(...p,h),"\n          ").concat(a.mainStart(),"\n          ").concat(a.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size"),"\n              let coords = ").concat(h.offsetToIndices("global_idx"),";\n              let batch = ").concat(EE("coords",0,c.rank),";\n              let d2 = ").concat(EE("coords",i?c.rank-1:1,c.rank),";\n              let xFRCCorner = vec3<u32>(").concat(EE("coords",i?1:2,c.rank),",\n              ").concat(EE("coords",i?2:3,c.rank),",\n              ").concat(EE("coords",i?3:4,c.rank),") * uniforms.strides - uniforms.pads;\n              let xFCorner = xFRCCorner.x;\n              let xRCorner = xFRCCorner.y;\n              let xCCorner = xFRCCorner.z;\n              let xShapeY = ").concat(EE("uniforms.x_shape",i?1:2,c.rank),";\n              let xShapeZ = ").concat(EE("uniforms.x_shape",i?2:3,c.rank),";\n              let xShapeW = ").concat(EE("uniforms.x_shape",i?3:4,c.rank),";\n              let xShapeU = ").concat(EE("uniforms.x_shape",i?4:1,c.rank),";\n              let inputDepthNearestVec4 = (xShapeU / 4) * 4;\n              let inputDepthVec4Remainder = xShapeU % 4;\n\n              var value = 0.0;\n              for (var wF = 0u; wF < uniforms.filter_dims[0]; wF++) {\n                let xF = xFCorner + wF * uniforms.dilations[0];\n                if (xF < 0 || xF >= xShapeY) {\n                  continue;\n                }\n\n                for (var wR = 0u; wR < uniforms.filter_dims[1]; wR++) {\n                  let xR = xRCorner + wR * uniforms.dilations[1];\n                  if (xR < 0 || xR >= xShapeZ) {\n                    continue;\n                  }\n\n                  for (var wC = 0u; wC < uniforms.filter_dims[2]; wC++) {\n                    let xC = xCCorner + wC * uniforms.dilations[2];\n                    if (xC < 0 || xC >= xShapeW) {\n                      continue;\n                    }\n\n                    for (var d1 = 0u; d1 < inputDepthNearestVec4; d1 += 4) {\n                      ").concat(i?"let xValues = vec4<f32>(\n                               getX(batch, xF, xR, xC, d1),\n                               getX(batch, xF, xR, xC, d1 + 1),\n                               getX(batch, xF, xR, xC, d1 + 2),\n                               getX(batch, xF, xR, xC, d1 + 3));\n                            ":"let xValues = vec4<f32>(\n                               getX(batch, d1, xF, xR, xC),\n                               getX(batch, d1 + 1, xF, xR, xC),\n                               getX(batch, d1 + 2, xF, xR, xC),\n                               getX(batch, d1 + 3, xF, xR, xC));\n                            ","\n                            let wValues = vec4<f32>(\n                              getW(d2, d1, wF, wR, wC),\n                              getW(d2, d1 + 1, wF, wR, wC),\n                              getW(d2, d1 + 2, wF, wR, wC),\n                              getW(d2, d1 + 3, wF, wR, wC));\n                      value += dot(xValues, wValues);\n                    }\n                    if (inputDepthVec4Remainder == 1) {\n                        ").concat(i?"value += getX(batch, xF, xR, xC, inputDepthNearestVec4)\n                          * getW(d2, inputDepthNearestVec4, wF, wR, wC);":"value += getX(batch, inputDepthNearestVec4, xF, xR, xC)\n                          * getW(d2, inputDepthNearestVec4, wF, wR, wC);","\n                    } else if (inputDepthVec4Remainder == 2) {\n                      ").concat(i?"let xValues = vec2<f32>(\n                        getX(batch, xF, xR, xC, inputDepthNearestVec4),\n                        getX(batch, xF, xR, xC, inputDepthNearestVec4 + 1));\n                      ":"let xValues = vec2<f32>(\n                        getX(batch, inputDepthNearestVec4, xF, xR, xC),\n                        getX(batch, inputDepthNearestVec4 + 1, xF, xR, xC));\n                    ","\n                    let wValues = vec2<f32>(\n                      getW(d2, inputDepthNearestVec4, wF, wR, wC),\n                      getW(d2, inputDepthNearestVec4 + 1, wF, wR, wC));\n                      value += dot(xValues, wValues);\n                    } else if (inputDepthVec4Remainder == 3) {\n                      ").concat(i?"let xValues = vec3<f32>(\n                        getX(batch, xF, xR, xC, inputDepthNearestVec4),\n                        getX(batch, xF, xR, xC, inputDepthNearestVec4 + 1),\n                        getX(batch, xF, xR, xC, inputDepthNearestVec4 + 2));\n                      ":"let xValues = vec3<f32>(\n                        getX(batch, inputDepthNearestVec4, xF, xR, xC),\n                        getX(batch, inputDepthNearestVec4 + 1, xF, xR, xC),\n                        getX(batch, inputDepthNearestVec4 + 2, xF, xR, xC));\n                    ","\n                    let wValues = vec3<f32>(\n                      getW(d2, inputDepthNearestVec4, wF, wR, wC),\n                      getW(d2, inputDepthNearestVec4 + 1, wF, wR, wC),\n                      getW(d2, inputDepthNearestVec4 + 2, wF, wR, wC));\n                      value += dot(xValues, wValues);\n                    }\n                  }\n                }\n              }\n              ").concat(d?"value = value + getBiasByOutputCoords(coords)":"",";\n              ").concat(g,"\n              result[global_idx] = f32(value);\n          }")}}}})),sO=pD((()=>{Iz(),Oz(),qz(),eO(),qM=(e,t,n,r)=>{let o=e.length>2,a=o?"value += b[output_channel];":"",i=e[0].dims,s=e[1].dims,l="NHWC"===t.format,c=l?n[3]:n[1],u=c/t.group,d=l&&u>=4?kE(c):1,p=qS.size(n)/d,h=[{type:12,data:p},{type:12,data:t.dilations},{type:12,data:[t.strides[0],t.strides[1]]},{type:12,data:[t.pads[0],t.pads[1]]},{type:12,data:u}];gM(t,h),h.push(...xE(i,[s[0],s[1],s[2],s[3]/d]));let f=o?["rank","rank","rank"]:["rank","rank"];h.push(...xE([n[0],n[1],n[2],n[3]/d]));return{name:"GroupedConv",shaderCache:{hint:"".concat(t.cacheKey,"_").concat(d),inputDependencies:f},getRunData:()=>({outputs:[{dims:r?r(n):n,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(p/64)},programUniforms:h}),getShaderSource:r=>{let c=ME("output",e[0].dataType,n.length,d),u=wE(c.type.tensor),p=mM(t,c.type.value,u),h=AE("x",e[0].dataType,i.length),f=AE("w",e[1].dataType,s.length,d),m=[h,f];o&&m.push(AE("b",e[2].dataType,e[2].dims,d));let g=[{name:"output_size",type:"u32"},{name:"dilations",type:"u32",length:t.dilations.length},{name:"strides",type:"u32",length:2},{name:"pads",type:"u32",length:2},{name:"output_channels_per_group",type:"u32"}];_M(t,g);let _=l?"\n      for (var wHeight: u32 = 0u; wHeight < uniforms.w_shape[0]; wHeight++) {\n        let xHeight = xRCCorner.x + wHeight * uniforms.dilations[0];\n\n        if (xHeight < 0u || xHeight >= uniforms.x_shape[1]) {\n          continue;\n        }\n\n        for (var wWidth: u32 = 0u; wWidth < uniforms.w_shape[1]; wWidth++) {\n          let xWidth = xRCCorner.y + wWidth * uniforms.dilations[1];\n          if (xWidth < 0u || xWidth >= uniforms.x_shape[2]) {\n            continue;\n          }\n\n          for (var wInChannel: u32 = 0u; wInChannel < uniforms.w_shape[2]; wInChannel++) {\n            let input_channel = in_channel_offset + wInChannel;\n            let xVal = ".concat(h.get("batch","xHeight","xWidth","input_channel"),";\n            let wVal = ").concat(f.get("wHeight","wWidth","wInChannel","output_channel"),";\n            value += xVal * wVal;\n          }\n        }\n      }\n      "):"\n      for (var wInChannel: u32 = 0u; wInChannel < uniforms.w_shape[1]; wInChannel++) {\n        let input_channel = in_channel_offset + wInChannel;\n        for (var wHeight: u32 = 0u; wHeight < uniforms.w_shape[2]; wHeight++) {\n          let xHeight = xRCCorner.x + wHeight * uniforms.dilations[0];\n\n          if (xHeight < 0u || xHeight >= uniforms.x_shape[2]) {\n            continue;\n          }\n\n          for (var wWidth: u32 = 0u; wWidth < uniforms.w_shape[3]; wWidth++) {\n            let xWidth = xRCCorner.y + wWidth * uniforms.dilations[1];\n            if (xWidth < 0u || xWidth >= uniforms.x_shape[3]) {\n              continue;\n            }\n\n            let xVal = ".concat(h.get("batch","input_channel","xHeight","xWidth"),";\n            let wVal = ").concat(f.get("output_channel","wInChannel","wHeight","wWidth"),";\n            value += xVal * wVal;\n          }\n        }\n      }\n      ");return"\n  ".concat(r.registerUniforms(g).declareVariables(...m,c),"\n\n  ").concat(r.mainStart(),"\n    ").concat(r.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size"),"\n\n    let outputIndices = ").concat(c.offsetToIndices("global_idx"),";\n    let batch: u32 = outputIndices[0];\n    let output_channel: u32 = outputIndices[").concat(l?3:1,"];\n    let xRCCorner: vec2<u32> = vec2<u32>(outputIndices[").concat(l?1:2,"], outputIndices[").concat(l?2:3,"]) * uniforms.strides - uniforms.pads;\n    let group_id: u32 = output_channel * ").concat(d," / uniforms.output_channels_per_group;\n    var in_channel_offset = group_id * uniforms.w_shape[").concat(l?2:1,"];\n\n    var value: ").concat(c.type.value," = ").concat(c.type.value,"(0);\n    ").concat(_,"\n    ").concat(a,"\n    ").concat(p,"\n    ").concat(c.setByOffset("global_idx","value"),"\n  }")}}},UM=(e,t,n,r)=>{let o=e.length>2,a=kE(n[3]),i=kE(n[2]),s=qS.size(n)/a/i,l=[e[0].dims[0],e[0].dims[1],e[0].dims[2],e[0].dims[3]/a],c=[e[1].dims[0],e[1].dims[1],e[1].dims[2],e[1].dims[3]/a],u=[n[0],n[1],n[2],n[3]/a],d=[{type:12,data:s},{type:6,data:[t.strides[0],t.strides[1]]},{type:6,data:[t.pads[0],t.pads[1]]}];gM(t,d),d.push(...xE(l,c,u));let p=(i-1)*t.strides[1]+c[1];return{name:"GroupedConv-Vectorize",shaderCache:{hint:"".concat(t.cacheKey,";").concat(a,";").concat(i,";").concat(p,";").concat(c[0],";").concat(c[1]),inputDependencies:o?["rank","rank","type"]:["rank","rank"]},getRunData:()=>({outputs:[{dims:r?r(n):n,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(s/64)},programUniforms:d}),getShaderSource:n=>{let r=ME("output",e[0].dataType,u.length,a),s=wE(r.type.tensor),d=mM(t,r.type.value,s),h=AE("x",e[0].dataType,l.length,a),f=AE("w",e[1].dataType,c.length,a),m=[h,f];o&&m.push(AE("b",e[2].dataType,e[2].dims,a));let g=o?"value += b[output_channel];":"",_=[{name:"output_size",type:"u32"},{name:"strides",type:"i32",length:2},{name:"pads",type:"i32",length:2}];return _M(t,_),"\n  ".concat(n.registerUniforms(_).declareVariables(...m,r),"\n  ").concat(n.mainStart(),"\n    ").concat(n.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size"),"\n    let width0 = uniforms.output_shape[3];\n    let output_channel = global_idx % width0;\n    var index1 = global_idx / width0;\n    let width1 = uniforms.output_shape[2] / ").concat(i,"u;\n    let col = (index1 % width1) * ").concat(i,"u;\n    index1 = index1 / width1;\n    let row = index1 % uniforms.output_shape[1];\n    let batch = index1 / uniforms.output_shape[1];\n\n    let x_corner = vec2<i32>(i32(row), i32(col)) * uniforms.strides - uniforms.pads;\n\n    var x_vals: array<").concat(h.type.value,", ").concat(p,">;\n    var values: array<").concat(r.type.value,", ").concat(i,">;\n    let input_channel = output_channel;\n    // Use constant instead of uniform can give better performance for w's height/width.\n    for (var w_height: u32 = 0u; w_height < ").concat(c[0],"; w_height++) {\n      let x_height = x_corner.x + i32(w_height);\n      if (x_height >= 0 && u32(x_height) < uniforms.x_shape[1]) {\n        for (var i = 0; i < ").concat(p,"; i++) {\n          let x_width = x_corner.y + i;\n          if (x_width >= 0 && u32(x_width) < uniforms.x_shape[2]) {\n            x_vals[i] = ").concat(h.get("batch","u32(x_height)","u32(x_width)","input_channel"),";\n          } else {\n            x_vals[i] = ").concat(h.type.value,"(0);\n          }\n        }\n        for (var w_width: u32 = 0u; w_width < ").concat(c[1],"; w_width++) {\n          let w_val = ").concat(f.get("w_height","w_width","0","output_channel"),";\n          for (var i = 0u; i < ").concat(i,"u; i++) {\n            values[i] = fma(x_vals[i * u32(uniforms.strides[1]) + w_width], w_val, values[i]);\n          }\n        }\n      }\n    }\n\n    for (var i = 0u; i < ").concat(i,"u; i++) {\n      var value = values[i];\n      ").concat(g,"\n      ").concat(d,"\n      ").concat(r.set("batch","row","col + i","output_channel","value"),";\n    }\n  }")}}}})),lO=pD((()=>{Oz(),aO(),iO(),oO(),sO(),eO(),rO(),Uz(),WM=(e,t,n,r,o,a)=>{let i=e[0],s=e.slice(a?1:2,a?3:4),l=s.length,c=t[0],u=t.slice(2).map(((e,t)=>e+(e-1)*(n[t]-1))),d=s.map(((e,t)=>e+r[t]+r[t+l])).map(((e,t)=>Math.floor((e-u[t]+o[t])/o[t])));return d.splice(0,0,i),d.splice(a?3:1,0,c),d},GM=[2,3,1,0],HM=(e,t)=>{if(!e||2!==e.length&&3!==e.length)throw new Error("Conv requires 2 or 3 inputs");if(e[0].dims.length>5)throw new Error("greater than 5D is not supported");if(e[0].dims.length!==e[1].dims.length)throw new Error("filter does not have same dimension as input");if(e[0].dims["NHWC"===t.format?e[0].dims.length-1:1]!==e[1].dims[1]*t.group)throw new Error("FILTER_IN_CHANNEL should be equal to DATA_CHANNEL");if(3===e.length&&(1!==e[2].dims.length||e[1].dims[0]!==e[2].dims[0]))throw new Error("invalid bias");let n=e[0].dims.length-2;if(t.dilations.length!==n)throw new Error("dilations should be ".concat(n,"D"));if(t.strides.length!==n)throw new Error("strides should be ".concat(n,"D"));if(t.pads.length!==2*n)throw new Error("pads should be ".concat(2*n,"D"));if(0!==t.kernelShape.length&&t.kernelShape.length!==e[1].dims.length-2)throw new Error("invalid kernel shape")},KM=(e,t)=>{let n=e.kernelShape.slice();n.length<t[1].dims.length-2&&n.push(...Array(t[1].dims.length-2-n.length).fill(0));for(let a=2;a<t[1].dims.length;++a)0===n[a-2]&&(n[a-2]=t[1].dims[a]);let r=e.pads.slice();US.adjustPadsBasedOnAutoPad(t[0].dims,e.strides,e.dilations,n,r,"NHWC"===e.format,e.autoPad);let o=Object.assign({},e);return Object.assign(o,{kernelShape:n,pads:r}),o},ZM=e=>{let t=vM(e),n=e.format;return so(so({autoPad:["NOTSET","VALID","SAME_UPPER","SAME_LOWER"][e.auto_pad],format:n,dilations:e.dilations,group:e.group,kernelShape:e.kernel_shape,pads:e.pads,strides:e.strides,wIsConst:e.w_is_const()},t),{},{cacheKey:"".concat(e.format,";").concat(t.activation,";")})},$M=(e,t,n,r)=>{var o;let a="NHWC"===n.format,i=WM(t[0].dims,t[1].dims,n.dilations,n.pads,n.strides,a);if(1!==n.group){let o=[t[0]];if(a){var s;let r=null!==(s=e.kernelCustomData.wT)&&void 0!==s?s:e.compute(VE(t[1],GM),{inputs:[1],outputs:[n.wIsConst?-2:-1]})[0];n.wIsConst&&!e.kernelCustomData.wT&&(e.kernelCustomData.wT=r),o.push(r)}else o.push(t[1]);return 3===t.length&&o.push(t[2]),void(!e.adapterInfo.isArchitecture("ampere")&&a&&t[1].dims[0]===n.group&&1===t[1].dims[1]&&1===n.dilations[0]&&1===n.dilations[1]?e.compute(UM(o,n,i,r),{inputs:o}):e.compute(qM(o,n,i,r),{inputs:o}))}let l=3===t.length,c=t[0].dims[a?1:2],u=t[0].dims[a?2:3],d=t[0].dims[a?3:1],p=t[1].dims[2],h=t[1].dims[3],f=i[a?1:2],m=i[a?2:3],g=i[a?3:1],_=a&&p===c&&h===u&&0===n.pads[0]&&0===n.pads[1];if(_||1===p&&1===h&&1===n.dilations[0]&&1===n.dilations[1]&&1===n.strides[0]&&1===n.strides[1]&&0===n.pads[0]&&0===n.pads[1]){let o,s,p,h=i[0],y=[];if(a){var v;let r=null!==(v=e.kernelCustomData.wT)&&void 0!==v?v:e.compute(VE(t[1],GM),{inputs:[1],outputs:[n.wIsConst?-2:-1]})[0];if(n.wIsConst&&!e.kernelCustomData.wT&&(e.kernelCustomData.wT=r),_){let e=c*u*d;o=t[0].reshape([1,h,e]),s=r.reshape([1,e,g]),p=[1,h,g]}else o=t[0].reshape([h,c*u,d]),s=r.reshape([1,d,g]),p=[h,f*m,g];y.push(o),y.push(s)}else o=t[0].reshape([h,d,c*u]),s=t[1].reshape([1,g,d]),p=[h,g,f*m],y.push(s),y.push(o);l&&y.push(t[2]);let w=p[2],b=y[0].dims[y[0].dims.length-1];return void(w<8&&b<8?e.compute(kM(y,n,i,p,a,r),{inputs:y}):e.compute(FM(y,n,i,p,a,r),{inputs:y}))}let y=null!==(o=e.kernelCustomData.wT)&&void 0!==o?o:e.compute(VE(t[1],GM),{inputs:[1],outputs:[n.wIsConst?-2:-1]})[0];n.wIsConst&&!e.kernelCustomData.wT&&(e.kernelCustomData.wT=y);let w=[t[0],y];l&&w.push(t[2]);let b=a?f*m:g,x=a?g:f*m,k=p*h*d;e.compute(PM(w,n,i,b,x,k,l,!0,r),{inputs:w})},XM=(e,t)=>{let n="NHWC"===t.format,r=[e.inputs[0].reshape(n?[e.inputs[0].dims[0],1,e.inputs[0].dims[1],e.inputs[0].dims[2]]:[e.inputs[0].dims[0],e.inputs[0].dims[1],1,e.inputs[0].dims[2]]),e.inputs[1].reshape([e.inputs[1].dims[0],e.inputs[1].dims[1],1,e.inputs[1].dims[2]])];3===e.inputs.length&&r.push(e.inputs[2]);let o=[0,t.pads[0],0,t.pads[1]],a=[1].concat(t.strides),i=[1].concat(t.dilations),s=[1].concat(t.kernelShape),l=KM(so(so({},t),{},{pads:o,strides:a,dilations:i,kernelShape:s}),r);$M(e,r,l,(e=>n?[e[0],e[2],e[3]]:[e[0],e[1],e[3]]))},JM=(e,t,n)=>{let r="NHWC"===n.format?"channelsLast":"channelsFirst",o=KM(n,t),a="NOTSET"===n.autoPad?n.pads:n.autoPad,i=RM(t[0].dims,t[1].dims,n.strides,n.dilations,a,!1,r);e.compute(VM(t,o,i.outShape,[i.filterDepth,i.filterHeight,i.filterWidth],[i.padInfo.front,i.padInfo.top,i.padInfo.left],r))},QM=(e,t)=>{if(HM(e.inputs,t),3===e.inputs[0].dims.length)XM(e,t);else if(5===e.inputs[0].dims.length)JM(e,e.inputs,t);else{let n=KM(t,e.inputs);$M(e,e.inputs,n)}}})),cO=pD((()=>{Iz(),zz(),Oz(),qz(),YM=(e,t,n)=>{let r=e.length>2,o=t.outputShape,a="NHWC"===t.format,i=t.group,s=e[1].dims,l=s[2]/i,c=s[3],u=a?kE(l):1,d=a&&1===c&&l>=4,p=d?4*Math.floor(l/4):Math.floor(l/u)*u,h=l-p,f=a?kE(c):1,m=a?1===c?u:f:1,g=qS.size(o)/f,_=[Math.ceil(g/64),1,1];LS("verbose",(()=>"[conv2d_backprop_webgpu] dispatch = ".concat(_)));let v=["rank","rank"],y=[t.strides[0],t.strides[1]],w=[t.kernelShape[a?1:2],t.kernelShape[a?2:3]],b=[t.dilations[0],t.dilations[1]],x=[w[0]+(t.dilations[0]<=1?0:(t.kernelShape[a?1:2]-1)*(t.dilations[0]-1)),w[1]+(t.dilations[1]<=1?0:(t.kernelShape[a?2:3]-1)*(t.dilations[1]-1))],k=[x[0]-1-Math.floor((t.pads[0]+t.pads[2])/2),x[1]-1-Math.floor((t.pads[1]+t.pads[3])/2)],C=[{type:12,data:g},{type:12,data:y},{type:12,data:w},{type:12,data:b},{type:12,data:x},{type:6,data:k},{type:12,data:p},{type:12,data:l},{type:12,data:c},...xE(e[0].dims,e[1].dims)];r&&(C.push(...xE(e[2].dims)),v.push("rank")),C.push(...xE(o));return{name:"ConvTranspose2D",shaderCache:{hint:"".concat(t.cacheKey,";").concat(u).concat(m).concat(f).concat(d).concat(h),inputDependencies:v},getRunData:()=>({dispatchGroup:{x:_[0],y:_[1],z:_[2]},outputs:[{dims:n?n(o):o,dataType:e[0].dataType}],programUniforms:C}),getShaderSource:t=>{let n=[{name:"output_size",type:"u32"},{name:"strides",type:"u32",length:y.length},{name:"filter_dims",type:"u32",length:w.length},{name:"dilations",type:"u32",length:w.length},{name:"effective_filter_dims",type:"u32",length:x.length},{name:"pads",type:"i32",length:k.length},{name:"input_channels_per_group_int",type:"u32"},{name:"input_channels_per_group",type:"u32"},{name:"output_channels_per_group",type:"u32"}],i=wE(e[0].dataType),s=a?1:2,l=a?2:3,c=a?3:1,p=AE("W",e[1].dataType,e[1].dims.length,m),g=AE("Dy",e[0].dataType,e[0].dims.length,u),_=[g,p];r&&_.push(AE("bias",e[2].dataType,[o[c]].length,f));let v=ME("result",e[0].dataType,o.length,f),b="\n            let outputIndices = ".concat(v.offsetToIndices("global_idx * ".concat(f)),";\n            let batch = ").concat(v.indicesGet("outputIndices",0),";\n            let d1 = ").concat(v.indicesGet("outputIndices",c),";\n            let r = ").concat(v.indicesGet("outputIndices",s),";\n            let c = ").concat(v.indicesGet("outputIndices",l),";\n            let dyCorner = vec2<i32>(i32(r), i32(c)) - uniforms.pads;\n            let dyRCorner = dyCorner.x;\n            let dyCCorner = dyCorner.y;\n            let groupId = d1 / uniforms.output_channels_per_group;\n            let wOutChannel = d1 - groupId * uniforms.output_channels_per_group;\n            // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).\n            // ? = to be determined. : = across all values in that axis.\n            var dotProd = ").concat(v.type.value,"(0.0);\n            var wR: u32 = 0;\n            if (uniforms.dilations.x == 1) {\n              // Minimum wR >= 0 that satisfies (dyRCorner + wR) % (uniforms.strides.x) == 0\n              wR = u32(((dyRCorner + i32(uniforms.strides.x) - 1) / i32(uniforms.strides.x)) * i32(uniforms.strides.x) - dyRCorner);\n            }\n            for (; wR < uniforms.effective_filter_dims.x; wR = wR + 1) {\n              if (wR % uniforms.dilations.x != 0) {\n                continue;\n              }\n              let dyR = (").concat(i,"(dyRCorner) + ").concat(i,"(wR)) / ").concat(i,"(uniforms.strides[0]);\n              let wRPerm = uniforms.filter_dims.x - 1 - wR / uniforms.dilations.x;\n              if (dyR < 0.0 || dyR >= ").concat(i,"(uniforms.Dy_shape[").concat(s,"]) || fract(dyR) > 0.0 ||\n                  wRPerm < 0) {\n                continue;\n              }\n              let idyR: u32 = u32(dyR);\n              var wC: u32 = 0;\n              if (uniforms.dilations.y == 1) {\n                // Minimum wC >= 0 that satisfies (dyCCorner + wC) % (uniforms.strides.y) == 0\n                wC = u32(((dyCCorner + i32(uniforms.strides.y) - 1) / i32(uniforms.strides.y)) * i32(uniforms.strides.y) - dyCCorner);\n              }\n              for (; wC < uniforms.effective_filter_dims.y; wC = wC + 1) {\n                if (wC % uniforms.dilations.y != 0) {\n                  continue;\n                }\n                let dyC = (").concat(i,"(dyCCorner) + ").concat(i,"(wC)) / ").concat(i,"(uniforms.strides.y);\n                let wCPerm = uniforms.filter_dims.y - 1 - wC / uniforms.dilations.y;\n                if (dyC < 0.0 || dyC >= ").concat(i,"(uniforms.Dy_shape[").concat(l,"]) ||\n                    fract(dyC) > 0.0 || wCPerm < 0) {\n                  continue;\n                }\n                let idyC: u32 = u32(dyC);\n                var inputChannel = groupId * uniforms.input_channels_per_group;\n                ").concat(d?"\n                var x_offset = ".concat(g.indicesToOffset("".concat(g.type.indices,"(batch, idyR, idyC, inputChannel)"))," / ").concat(u,";\n                var w_offset = ").concat(p.indicesToOffset("".concat(p.type.indices,"(wRPerm, wCPerm, inputChannel, wOutChannel)"))," / ").concat(m,";\n                  "):"","\n                for (var d2: u32 = 0; d2 < uniforms.input_channels_per_group_int; d2 = d2 + ").concat(d?4:u,") {\n                  ").concat((()=>{let e="";if(d)4===u?e+="\n        let xValue = ".concat(g.getByOffset("x_offset"),";\n        let wValue = ").concat(p.getByOffset("w_offset"),";\n        dotProd = dotProd + dot(xValue, wValue);\n        x_offset += 1u;\n        w_offset += 1u;"):2===u?e+="\n          dotProd = dotProd + dot(vec4<".concat(i,">(").concat(g.getByOffset("x_offset"),", ").concat(g.getByOffset("x_offset + 1u"),"), vec4<").concat(i,">(").concat(p.getByOffset("w_offset"),", ").concat(p.getByOffset("w_offset + 1u"),"));\n          x_offset += 2u;\n          w_offset += 2u;"):1===u&&(e+="\n          dotProd = dotProd + dot(vec4<".concat(i,">(").concat(g.getByOffset("x_offset"),", ").concat(g.getByOffset("x_offset + 1u"),", ").concat(g.getByOffset("x_offset + 2u"),", ").concat(g.getByOffset("x_offset + 3u"),"), vec4<").concat(i,">(").concat(p.getByOffset("w_offset"),", ").concat(p.getByOffset("w_offset + 1u"),", ").concat(p.getByOffset("w_offset + 2u"),", ").concat(p.getByOffset("w_offset + 3u"),"));\n          x_offset += 4u;\n          w_offset += 4u;"));else if(e+="\n                  let xValue = ".concat(a?g.getByOffset("".concat(g.indicesToOffset("".concat(g.type.indices,"(batch, idyR, idyC, inputChannel)"))," / ").concat(u)):g.get("batch","inputChannel","idyR","idyC"),";\n        "),1===u)e+="\n          let w_offset = ".concat(p.indicesToOffset("".concat(p.type.indices,"(u32(wRPerm), u32(wCPerm), inputChannel, wOutChannel)")),";\n          let wValue = ").concat(p.getByOffset("w_offset / ".concat(m)),";\n          dotProd = dotProd + xValue * wValue;");else for(let t=0;t<u;t++)e+="\n            let wValue".concat(t," = ").concat(p.getByOffset("".concat(p.indicesToOffset("".concat(p.type.indices,"(u32(wRPerm), u32(wCPerm), inputChannel + ").concat(t,", wOutChannel)"))," / ").concat(m)),";\n            dotProd = dotProd + xValue[").concat(t,"] * wValue").concat(t,";");return e})(),"\n                  inputChannel = inputChannel + ").concat(d?4:u,";\n                }\n                ").concat((()=>{if(0===h)return"";if(!d)throw new Error("packInputAs4 ".concat(d," is not true."));let e="";if(1===u){e+="dotProd = dotProd";for(let t=0;t<h;t++)e+="\n            + ".concat(g.getByOffset("x_offset + ".concat(t))," * ").concat(p.getByOffset("w_offset + ".concat(t)));e+=";"}else if(2===u){if(2!==h)throw new Error("Invalid inputChannelsRemainder ".concat(h,"."));e+="\n          let xValue = ".concat(g.getByOffset("x_offset"),";\n          let wValue = ").concat(p.getByOffset("w_offset"),";\n          dotProd = dotProd + dot(xValue, wValue);")}return e})(),"\n                wC = wC + uniforms.strides.y - 1;\n              }\n              wR = wR + uniforms.strides[0] - 1;\n            }\n            let value = dotProd").concat(r?" + bias[d1 / ".concat(f,"]"):"",";\n            ").concat(v.setByOffset("global_idx","value"),";\n          ");return"\n    ".concat(t.registerUniforms(n).declareVariables(..._,v),"\n      ").concat(t.mainStart(),"\n      ").concat(t.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size"),";\n    ").concat(b,"}")}}}})),uO=pD((()=>{cO(),eO(),Uz(),eF=(e,t,n,r,o,a)=>(e-1)*t+n+(r-1)*o+1-a,tF=(e,t,n,r,o)=>{let a=Math.floor(e/2);"SAME_UPPER"===t?(n[r]=a,n[o]=e-a):"SAME_LOWER"===t&&(n[r]=e-a,n[o]=a)},nF=(e,t,n,r,o,a,i,s,l,c)=>{let u=e.length-2,d=0===c.length;l.length<u&&l.push(...Array(u-l.length).fill(0));let p=e[0],h=t[s?3:1]*o;for(let f=0,m=e.length-u-(s?1:0);f<u;++f,++m){let o=e[m],s=d?o*i[f]:c[f],p=eF(o,i[f],a[f],t[m],n[f],s);tF(p,r,a,f,f+u),d&&c.push(i[f]*(o-1)+l[f]+(t[m]-1)*n[f]+1-a[f]-a[f+u])}c.splice(0,0,p),c.splice(s?3:1,0,h)},rF=(e,t)=>{let n=e.kernelShape.slice();if(0===e.kernelShape.length||0===e.kernelShape.reduce(((e,t)=>e*t),1)){n.length=0;for(let e=2;e<t[1].dims.length;++e)n.push(t[1].dims[e])}let r="NHWC"===e.format;n.splice(0,0,t[1].dims[0]),n.splice(r?3:1,0,t[1].dims[1]);let o=e.pads.slice(),a=e.outputShape.slice(),i=e.outputPadding.slice(),s=t[0].dims,l=e.dilations.slice();if(0===l.reduce(((e,t)=>e+t),0)){let e=t[0].dims.length-2;l=new Array(e).fill(1)}let c=e.strides.slice();if(0===c.reduce(((e,t)=>e+t),0)){let e=t[0].dims.length-2;c=new Array(e).fill(1)}nF(s,n,l,e.autoPad,e.group,o,c,r,i,a);let u=Object.assign({},e);return Object.assign(u,{kernelShape:n,pads:o,outputPadding:i,outputShape:a,dilations:l,strides:c}),u},oF=e=>{let t=vM(e),n=e.format,r=["NOTSET","VALID","SAME_UPPER","SAME_LOWER"][typeof e.autoPad>"u"?0:e.autoPad],o=e.dilations,a=e.group,i=e.kernelShape,s=e.pads,l=e.strides,c=e.wIsConst();return so(so({autoPad:r,format:n,dilations:o,group:a,kernelShape:i,outputPadding:e.outputPadding,outputShape:e.outputShape,pads:s,strides:l,wIsConst:c},t),{},{cacheKey:"".concat(e.format,";").concat(t.activation,";")})},aF=(e,t)=>{if(!e||2!==e.length&&3!==e.length)throw new Error("Conv requires 2 or 3 inputs");if(4!==e[0].dims.length&&3!==e[0].dims.length)throw new Error("currently only support 2-dimensional conv");if(e[0].dims.length!==e[1].dims.length)throw new Error("filter does not have same dimension as input");if(e[0].dims["NHWC"===t.format?e[0].dims.length-1:1]!==e[1].dims[0])throw new Error("FILTER_IN_CHANNEL should be equal to DATA_CHANNEL");let n=e[1].dims[1]*t.group;if(3===e.length&&(1!==e[2].dims.length||e[2].dims[0]!==n))throw new Error("invalid bias");let r=e[0].dims.length-2;if(t.dilations.reduce(((e,t)=>e+t),0)>0&&t.dilations.length!==r)throw new Error("dilations should be ".concat(r,"D"));if(t.strides.reduce(((e,t)=>e+t),0)>0&&t.strides.length!==r)throw new Error("strides should be ".concat(r,"D"));if(t.pads.reduce(((e,t)=>e+t),0)>0&&t.pads.length!==2*r)throw new Error("pads should be ".concat(2*r,"D"));if(t.outputPadding.length!==r&&0!==t.outputPadding.length)throw new Error("output_padding should be ".concat(r,"D"));if(t.kernelShape.reduce(((e,t)=>e+t),0)>0&&0!==t.kernelShape.length&&t.kernelShape.length!==e[1].dims.length-2)throw new Error("invalid kernel shape");if(0!==t.outputShape.length&&t.outputShape.length!==e[0].dims.length-2)throw new Error("invalid output shape")},iF=(e,t,n,r)=>{var o;let a=null!==(o=e.kernelCustomData.wT)&&void 0!==o?o:e.compute(VE(t[1],[2,3,0,1]),{inputs:[1],outputs:[n.wIsConst?-2:-1]})[0];n.wIsConst&&!e.kernelCustomData.wT&&(e.kernelCustomData.wT=a);let i=[t[0],a];3===t.length&&i.push(t[2]),e.compute(YM(i,n,r),{inputs:i})},sF=(e,t)=>{let n="NHWC"===t.format,r=[e.inputs[0].reshape(n?[e.inputs[0].dims[0],1,e.inputs[0].dims[1],e.inputs[0].dims[2]]:[e.inputs[0].dims[0],e.inputs[0].dims[1],1,e.inputs[0].dims[2]]),e.inputs[1].reshape([e.inputs[1].dims[0],e.inputs[1].dims[1],1,e.inputs[1].dims[2]])];3===e.inputs.length&&r.push(e.inputs[2]);let o=t.kernelShape;(0===o.length||0===o[0])&&(o=[e.inputs[1].dims[2]]);let a=t.dilations;(0===a.length||0===a[0])&&(a=[1]);let i=t.strides;(0===i.length||0===i[0])&&(i=[1]);let s=t.pads;0===s.length&&(s=[0,0]),s=[0,s[0],0,s[1]],i=[1].concat(i),a=[1].concat(a),o=[1].concat(o);let l=t.outputPadding;l=[0].concat(l);let c=rF(so(so({},t),{},{pads:s,strides:i,dilations:a,kernelShape:o,outputPadding:l}),r);iF(e,r,c,(e=>n?[e[0],e[2],e[3]]:[e[0],e[1],e[3]]))},lF=(e,t)=>{if(aF(e.inputs,t),3===e.inputs[0].dims.length)sF(e,t);else{let n=rF(t,e.inputs);iF(e,e.inputs,n)}}})),dO=pD((()=>{Iz(),Oz(),Vz(),qz(),cF=(e,t,n,r)=>{let o=qS.size(t),a=t.length,i=AE("input",e,a),s=ME("output",e,a),l=6===n.dataType?n.getInt32Array()[0]:Number(n.getBigInt64Array()[0]),c=qS.normalizeAxis(l,a);return{name:"CumSum",shaderCache:{hint:r.cacheKey,inputDependencies:["rank"]},getRunData:()=>({outputs:[{dims:t,dataType:e}],dispatchGroup:{x:Math.ceil(o/64)},programUniforms:[{type:12,data:o},{type:12,data:c},...xE(t,t)]}),getShaderSource:e=>{let t=" i32(".concat(i.indicesGet("inputIndices","uniforms.axis"),") "),n=EE("uniforms.input_shape","uniforms.axis",a),o=r.reverse?t+(r.exclusive?" + 1":""):"0",l=r.reverse?n:t+(r.exclusive?"":" + 1");return"\n                ".concat(e.registerUniform("outputSize","u32").registerUniform("axis","u32").declareVariables(i,s),"\n                ").concat(e.mainStart(),"\n                  ").concat(e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize"),"\n                  var inputIndices = ").concat(s.offsetToIndices("global_idx"),";\n                  var sum = ").concat(s.type.value,"(0);\n                  let first : i32 = ").concat(o,";\n                  let last : i32 = ").concat(l,";\n                  for (var i : i32 = first; i < last; i++) {\n                    ").concat(i.indicesSet("inputIndices","uniforms.axis","u32(i)"),";\n                    sum = sum + ").concat(i.getByIndices("inputIndices"),";\n                  }\n                  ").concat(s.setByOffset("global_idx","sum"),";\n                }")}}},uF=(e,t)=>{let n=e.inputs[0].dims,r=e.inputs[0].dataType,o=e.inputs[1];e.compute(cF(r,n,o,t),{inputs:[0]})},dF=e=>{let t=1===e.exclusive,n=1===e.reverse;return _E({exclusive:t,reverse:n})}})),pO=pD((()=>{Iz(),Oz(),Vz(),qz(),pF=e=>{if(!e||1!==e.length)throw new Error("DepthToSpace requires 1 input.");if(4!==e[0].dims.length)throw new Error("DepthToSpace requires 4D input.")},hF=(e,t,n,r)=>{let o=[];o.push("fn perm(i: ".concat(r.type.indices,") -> ").concat(n.type.indices," {\n    var a: ").concat(n.type.indices,";"));for(let a=0;a<t;++a)o.push(n.indicesSet("a",e[a],"i[".concat(a,"]")));return o.push("return a;}"),o.join("\n")},fF=(e,t)=>{let n,r,o,a,i,s,l="NHWC"===t.format,c=t.blocksize,u="DCR"===t.mode;l?([n,r,o,a]=e.dims,i=u?[n,r,o,c,c,a/c**2]:[n,r,o,a/c**2,c,c],s=u?[0,1,3,2,4,5]:[0,1,4,2,5,3]):([n,r,o,a]=[e.dims[0],e.dims[2],e.dims[3],e.dims[1]],i=u?[n,c,c,a/c**2,r,o]:[n,a/c**2,c,c,r,o],s=u?[0,3,4,1,5,2]:[0,1,4,2,5,3]);let d=e.reshape(i),p=d.dims.length,h=e.dataType,f=AE("a",h,p),m=ME("output",h,p);return{name:"DepthToSpace",shaderCache:{hint:"".concat(e.dims,";").concat(t.blocksize,";").concat(t.mode),inputDependencies:["rank"]},getRunData:e=>{let t=l?[n,r*c,o*c,a/c**2]:[n,a/c**2,r*c,o*c],i=qS.size(t),u=d.dims,p=qS.sortBasedOnPerm(u,s);return{outputs:[{dims:t,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(i/64)},programUniforms:[{type:12,data:i},...xE(u,p)]}},getShaderSource:e=>"\n  ".concat(e.registerUniform("output_size","u32").declareVariables(f,m),"\n\n  ").concat(hF(s,p,f,m),"\n\n  ").concat(e.mainStart(),"\n    ").concat(e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size"),"\n\n    let indices = ").concat(m.offsetToIndices("global_idx"),";\n    let aIndices = perm(indices);\n\n    ").concat(m.setByOffset("global_idx",f.getByIndices("aIndices")),"\n  }")}},mF=(e,t)=>{pF(e.inputs),e.compute(fF(e.inputs[0],t))},gF=e=>_E({blocksize:e.blocksize,mode:e.mode,format:e.format})})),hO=pD((()=>{Iz(),Oz(),Vz(),qz(),yF="^"+(vF="("+(_F="[a-zA-Z]|\\.\\.\\.")+")+")+"$",wF="^"+("("+vF+",)*"+vF)+"$",bF=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1;this.symbolToIndices=new Map,this.inputIndex=e}addSymbol(e,t){let n=this.symbolToIndices.get(e);void 0===n?n=[t]:n.push(t),this.symbolToIndices.set(e,n)}},xF=class{constructor(e,t){var n;this.equation=t,this.hasEllipsis=!1,this.symbolToInfo=new Map,this.lhs=new Array,this.outputDims=[];let[r,o]=t.includes("->")?t.split("->",2):[t,""];if(!r.match(RegExp(wF)))throw new Error("Invalid LHS term");if(r.split(",").forEach(((t,n)=>{let r=e[n].dims.slice();if(!t.match(RegExp(yF)))throw new Error("Invalid LHS term");let o=this.processTerm(t,!0,r,n);this.lhs.push(o)})),""===o)o+=[...this.symbolToInfo.entries()].filter((e=>{let[t,n]=e;return 1===n.count||"..."===t})).map((e=>{let[t]=e;return t})).join("");else if(!o.match(RegExp(vF)))throw new Error("Invalid RHS");null!==(n=o.match(RegExp(_F,"g")))&&void 0!==n&&n.forEach((e=>{if("..."===e)this.outputDims=this.outputDims.concat(this.ellipsisDims);else{let t=this.symbolToInfo.get(e);if(void 0===t)throw new Error("Invalid RHS symbol");this.outputDims.push(t.dimValue)}})),this.rhs=this.processTerm(o,!1,this.outputDims)}addSymbol(e,t,n){let r=this.symbolToInfo.get(e);if(void 0!==r){if(r.dimValue!==t&&1!==r.count)throw new Error("Dimension mismatch");r.count++,r.inputIndices.push(n)}else r={count:1,dimValue:t,inputIndices:[n]};this.symbolToInfo.set(e,r)}processTerm(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1,o=n.length,a=!1,i=[],s=0;if(!e.match(RegExp(yF))&&!t&&""!==e)throw new Error("Invalid LHS term");let l=e.match(RegExp(_F,"g")),c=new bF(r);return null!==l&&void 0!==l&&l.forEach(((e,u)=>{if("..."===e){if(a)throw new Error("Only one ellipsis is allowed per input term");a=!0;let e=o-l.length+1;if(e<0)throw new Error("Ellipsis out of bounds");if(i=n.slice(s,s+e),this.hasEllipsis){if(this.ellipsisDims.length!==i.length||this.ellipsisDims.toString()!==i.toString())throw new Error("Ellipsis dimensions mismatch")}else{if(!t)throw new Error("Ellipsis must be specified in the LHS");this.hasEllipsis=!0,this.ellipsisDims=i}for(let t=0;t<i.length;t++){let e=String.fromCharCode(48+t);c.addSymbol(e,u+t),this.addSymbol(e,n[s++],r)}}else c.addSymbol(e,u+(this.hasEllipsis?this.ellipsisDims.length-1:0)),this.addSymbol(e,n[s++],r)})),c}},kF=e=>e+"_max",CF=(e,t,n,r)=>{let o=e.map((e=>e.length)).map(((e,n)=>AE("input".concat(n),t,e))),a=qS.size(r),i=ME("output",t,r.length),s=[...n.symbolToInfo.keys()].filter((e=>!n.rhs.symbolToIndices.has(e)));return{name:"Einsum",shaderCache:{hint:n.equation,inputDependencies:e.map((()=>"rank"))},getRunData:()=>{let o=s.filter((e=>n.symbolToInfo.has(e))).map((e=>{var t;return{type:12,data:(null===(t=n.symbolToInfo.get(e))||void 0===t?void 0:t.dimValue)||0}}));o.push({type:12,data:a});let i=e.map(((e,t)=>[...xE(e)])).reduce(((e,t)=>e.concat(t)),o);return i.push(...xE(r)),{outputs:[{dims:r,dataType:t}],dispatchGroup:{x:Math.ceil(a/64)},programUniforms:i}},getShaderSource:e=>{let t=[],r=[],a=[],l=[],c=[],u=n.symbolToInfo.size===n.rhs.symbolToIndices.size;n.symbolToInfo.forEach(((e,s)=>{if(n.rhs.symbolToIndices.has(s)){var u;let r=null===(u=n.rhs.symbolToIndices.get(s))||void 0===u?void 0:u[0];void 0!==r&&n.lhs.forEach(((n,a)=>{if(e.inputIndices.includes(a)){let e=n.symbolToIndices.get(s);if(void 0===e)throw new Error("Invalid symbol error");e.forEach((e=>{t.push("".concat(o[a].indicesSet("input".concat(a,"Indices"),e,i.indicesGet("outputIndices",r))))}))}}))}else n.lhs.forEach(((t,n)=>{if(e.inputIndices.includes(n)){let e=t.symbolToIndices.get(s);if(void 0===e)throw new Error("Invalid symbol error");e.forEach((e=>{r.push("".concat(o[n].indicesSet("input".concat(n,"Indices"),e,"".concat(s))))})),c.push("prod *= ".concat(o[n].getByIndices("input".concat(n,"Indices")),";"))}})),a.push("for(var ".concat(s,": u32 = 0; ").concat(s," < uniforms.").concat(kF(s),"; ").concat(s,"++) {")),l.push("}")}));let d=u?[...t,"let sum = ".concat(o.map(((e,t)=>e.getByIndices("input".concat(t,"Indices")))).join(" * "),";")]:[...t,"var sum = 0.0;",...a,...r,"var prod = 1.0;",...c,"sum += prod;",...l];return"\n            ".concat(e.registerUniforms(s.map((e=>({name:"".concat(kF(e)),type:"u32"})))).registerUniform("outputSize","u32").declareVariables(...o,i),"\n\n            ").concat(e.mainStart(),"\n            ").concat(e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize"),"\n            var outputIndices = ").concat(i.offsetToIndices("global_idx"),";\n            ").concat(o.map(((e,t)=>"var input".concat(t,"Indices: ").concat(o[t].type.indices,";"))).join("\n"),"\n            ").concat(d.join("\n"),";\n            ").concat(i.setByOffset("global_idx","sum"),";\n          }")}}},DF=(e,t)=>{let n=new xF(e.inputs,t.equation),r=n.outputDims,o=e.inputs.map(((e,t)=>e.dims));e.compute(CF(o,e.inputs[0].dataType,n,r))},SF=e=>{let t=e.equation.replace(/\s+/g,"");return _E({equation:t})}})),fO=pD((()=>{Iz(),Oz(),qz(),EF=e=>{if(!e||2!==e.length)throw new Error("Expand requires 2 input.");let t=e[0].dims,n=Array.from(e[1].getBigInt64Array(),Number),r=n.length<t.length?0:n.length-t.length,o=t.length<n.length?0:t.length-n.length;for(;r<n.length&&o<t.length;++r,++o)if(n[r]!==t[o]&&1!==n[r]&&1!==t[o])throw new Error("Expand requires shape to be broadcastable to input")},TF=(e,t)=>{let n=e.length-t.length,r=[];for(let o=0;o<n;++o)r.push(e[o]);for(let o=0;o<t.length;++o)r.push(1===t[o]?e[o+n]:t[o]);return r},AF=(e,t)=>e.length>t.length?TF(e,t):TF(t,e),MF=e=>{let t=e[0].dims,n=Array.from(e[1].getBigInt64Array(),Number),r=AF(t,n),o=e[0].dataType,a=9===o||1===qS.size(t),i=9===o||t.length>0&&t[t.length-1]%4===0?4:1,s=a||r.length>0&&r[r.length-1]%4===0?4:1,l=Math.ceil(qS.size(r)/s),c=[{type:12,data:l},...xE(t,r)];return{name:"Expand",shaderCache:{hint:"".concat(r.length,";").concat(i).concat(s),inputDependencies:["rank"]},getShaderSource:e=>{let n,a=AE("input",o,t.length,i),l=ME("output",o,r.length,s);if(9===o){let e=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return"\n          let outputIndices".concat(t," = ").concat(l.offsetToIndices("outputOffset + ".concat(t,"u")),";\n          let offset").concat(t," = ").concat(a.broadcastedIndicesToOffset("outputIndices".concat(t),l),";\n          let index").concat(t," = offset").concat(t," / 4u;\n          let component").concat(t," = offset").concat(t," % 4u;\n          ").concat(e,"[").concat(t,"] = ").concat(n,"(").concat(a.getByOffset("index".concat(t)),"[component").concat(t,"]);\n        ")};n="\n        let outputOffset = global_idx * ".concat(s,";\n        var data = vec4<u32>(0);\n        ").concat(e("data",0,"u32"),"\n        ").concat(e("data",1,"u32"),"\n        ").concat(e("data",2,"u32"),"\n        ").concat(e("data",3,"u32"),"\n        ").concat(l.setByOffset("global_idx","data"),"\n      }")}else n="\n        let outputIndices = ".concat(l.offsetToIndices("global_idx * ".concat(s)),";\n        let inputOffset = ").concat(a.broadcastedIndicesToOffset("outputIndices",l),";\n        let data = ").concat(l.type.value,"(").concat(a.getByOffset("inputOffset / ".concat(i)),");\n        ").concat(l.setByOffset("global_idx","data"),"\n      }");return"\n    ".concat(e.registerUniform("vec_size","u32").declareVariables(a,l),"\n    ").concat(e.mainStart(),"\n    ").concat(e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.vec_size"),"\n    ").concat(n)},getRunData:()=>({outputs:[{dims:r,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(l/64)},programUniforms:c})}},FF=e=>{EF(e.inputs),e.compute(MF(e.inputs),{inputs:[0]})}})),mO=pD((()=>{Iz(),Oz(),qz(),Xz(),IF=e=>{let t=e[0].dataType,n=qS.size(e[0].dims),r=qS.size(e[1].dims),o=r%4===0;return{name:"FastGeluWithBias",shaderCache:{hint:"".concat(o),inputDependencies:["type","type"]},getShaderSource:e=>{let n=AE("x",t,[1],4),r=AE("bias",t,[1],4),a=ME("y",t,[1],4),i=e=>"\n      let bias".concat(e,"_offset: u32 = (global_idx * 4 + ").concat(e,") % uniforms.bias_size;\n      let bias").concat(e," = ").concat(r.getByOffset("bias".concat(e,"_offset / 4")),"[bias").concat(e,"_offset % 4];"),s=o?"\n      let bias = ".concat(r.getByOffset("global_idx % (uniforms.bias_size / 4)"),";"):"".concat(i(0)).concat(i(1)).concat(i(2)).concat(i(3),"\n      let bias = ").concat(n.type.value,"(bias0, bias1, bias2, bias3);");return"".concat(e.registerUniforms([{name:"output_vec_size",type:"u32"},{name:"bias_size",type:"u32"}]).declareVariables(n,r,a),"\n\n    ").concat(LA(bE(t)),"\n\n    ").concat(e.mainStart(vE),"\n      ").concat(e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_vec_size"),"\n\n      let x = ").concat(n.getByOffset("global_idx"),";\n      ").concat(s,"\n      let x_in = x + bias;\n      ").concat(a.setByOffset("global_idx",RA("x_in")),"\n    }")},getRunData:e=>({outputs:[{dims:e[0].dims,dataType:e[0].dataType}],programUniforms:[{type:12,data:Math.ceil(n/4)},{type:12,data:r}],dispatchGroup:{x:Math.ceil(n/vE/4)}})}},PF=e=>{e.inputs.length<2||0===qS.size(e.inputs[1].dims)?VA(e):e.compute(IF(e.inputs))}})),gO=pD((()=>{Iz(),Oz(),Vz(),qz(),zF=e=>{if(!e||2!==e.length)throw new Error("Gather requires 2 inputs.")},OF=(e,t)=>{let n=e[0].dims,r=e[1].dims,o=n.length,a=qS.normalizeAxis(t.axis,o),i=n.slice(0);i.splice(a,1,...r);let s=n[a],l=9===e[0].dataType?4:1,c=Math.ceil(qS.size(i)/l),u=[{type:12,data:c},{type:6,data:s},{type:12,data:a},...xE(e[0].dims,e[1].dims,i)];return{name:"Gather",shaderCache:{hint:t.cacheKey,inputDependencies:["rank","rank"]},getRunData:()=>({outputs:[{dims:i,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(c/64)},programUniforms:u}),getShaderSource:t=>{let n,s=AE("data",e[0].dataType,e[0].dims.length,l),c=AE("inputIndices",e[1].dataType,e[1].dims.length),u=ME("output",e[0].dataType,i.length,l),d=e=>{let t=r.length,n="var indicesIndices".concat(e,"  = ").concat(c.type.indices,"(0);");for(let r=0;r<t;r++)n+="".concat(t>1?"indicesIndices".concat(e,"[").concat(r,"]"):"indicesIndices".concat(e)," = ").concat(i.length>1?"outputIndices".concat(e,"[uniforms.axis + ").concat(r,"]"):"outputIndices".concat(e),";");n+="\n          var idx".concat(e," = ").concat(c.getByIndices("indicesIndices".concat(e)),";\n          if (idx").concat(e," < 0) {\n            idx").concat(e," = idx").concat(e," + uniforms.axisDimLimit;\n          }\n          var dataIndices").concat(e," : ").concat(s.type.indices,";\n        ");for(let r=0,s=0;r<o;r++)r===a?(n+="".concat(o>1?"dataIndices".concat(e,"[").concat(r,"]"):"dataIndices".concat(e)," = u32(idx").concat(e,");"),s+=t):(n+="".concat(o>1?"dataIndices".concat(e,"[").concat(r,"]"):"dataIndices".concat(e)," = ").concat(i.length>1?"outputIndices".concat(e,"[").concat(s,"]"):"outputIndices".concat(e),";"),s++);return n};if(9===e[0].dataType){let e=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return"\n          let outputIndices".concat(t," = ").concat(u.offsetToIndices("outputOffset + ".concat(t,"u")),";\n          ").concat(d(t),";\n          let offset").concat(t," = ").concat(s.indicesToOffset("dataIndices".concat(t)),";\n          let index").concat(t," = offset").concat(t," / 4u;\n          let component").concat(t," = offset").concat(t," % 4u;\n          ").concat(e,"[").concat(t,"] = ").concat(n,"(").concat(s.getByOffset("index".concat(t)),"[component").concat(t,"]);\n        ")};n="\n        let outputOffset = global_idx * ".concat(l,";\n        var value = vec4<u32>(0);\n        ").concat(e("value",0,"u32"),"\n        ").concat(e("value",1,"u32"),"\n        ").concat(e("value",2,"u32"),"\n        ").concat(e("value",3,"u32"),"\n        ").concat(u.setByOffset("global_idx","value"),"\n      ")}else n="\n      let outputIndices = ".concat(u.offsetToIndices("global_idx"),";\n      ").concat(d(""),";\n      let value = ").concat(s.getByIndices("dataIndices"),";\n      ").concat(u.setByOffset("global_idx","value"),";\n      ");return"\n      ".concat(t.registerUniform("outputSize","u32").registerUniform("axisDimLimit","i32").registerUniform("axis","u32").declareVariables(s,c,u),"\n      ").concat(t.mainStart(),"\n        ").concat(t.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize"),"\n        ").concat(n,"\n      }")}}},NF=e=>_E({axis:e.axis}),BF=(e,t)=>{let n=e.inputs;zF(n),e.compute(OF(e.inputs,t))}})),_O=pD((()=>{Iz(),Oz(),qz(),jF=(e,t,n,r,o,a,i,s,l)=>{let c=[{type:12,data:a},{type:12,data:r},{type:12,data:o},{type:12,data:n},{type:12,data:i},{type:12,data:s},{type:12,data:l}],u=[a];c.push(...xE(t.dims,u));return e.compute({name:"computeSliceOffsets",shaderCache:{hint:"".concat(o.length,"_").concat(n.length),inputDependencies:["rank"]},getRunData:()=>({outputs:[{dims:u,dataType:e.inputs[1].dataType}],dispatchGroup:{x:Math.ceil(a/64)},programUniforms:c}),getShaderSource:e=>{let r=[AE("indices_data",t.dataType,t.dims.length),ME("input_slice_offsets_data",12,1,1)],a=[{name:"output_size",type:"u32"},{name:"batch_dims",type:"u32"},{name:"input_dims",type:"u32",length:o.length},{name:"sizes_from_slice_dims_data",type:"u32",length:n.length},{name:"num_slices_per_batch",type:"u32"},{name:"input_batch_stride",type:"u32"},{name:"num_slice_dims",type:"u32"}];return"\n  ".concat(e.registerUniforms(a).declareVariables(...r),"\n  ").concat(e.mainStart(),"\n    ").concat(e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size"),"\n    let batch_idx = global_idx / uniforms.num_slices_per_batch;\n    let base_offset = batch_idx * uniforms.input_batch_stride;\n\n    let slice_indices_base_offset = global_idx * uniforms.num_slice_dims;\n    var relative_slice_offset = 0;\n    for (var dim_idx = 0u; dim_idx < uniforms.num_slice_dims; dim_idx ++) {\n      var index = i32(indices_data[dim_idx + slice_indices_base_offset].x);\n      let input_dim_idx = uniforms.batch_dims + dim_idx;\n      if (index < 0) {\n        ").concat(1===o.length?"index += i32(uniforms.input_dims);":"index += i32(uniforms.input_dims[input_dim_idx]);","\n      }\n      ").concat(1===n.length?"relative_slice_offset += index * i32(uniforms.sizes_from_slice_dims_data);":"relative_slice_offset += index * i32(uniforms.sizes_from_slice_dims_data[dim_idx]);","\n    }\n\n    input_slice_offsets_data[global_idx] =  base_offset + u32(relative_slice_offset);\n  }")}},{inputs:[t],outputs:[-1]})[0]},LF=(e,t)=>{let n=e.inputs,r=n[0].dims,o=n[0].dataType,a=n[1].dims,i=a[a.length-1],s=qS.sizeToDimension(a,a.length-1),l=qS.sizeFromDimension(r,t.batchDims+i),c=qS.sizeToDimension(r,t.batchDims),u=qS.sizeFromDimension(r,t.batchDims),d=s/c,p=new Array(i),h=l;for(let y=0;y<i;++y)p[i-1-y]=h,h*=r[t.batchDims+i-1-y];let f=jF(e,n[1],p,t.batchDims,r,s,d,u,i),m=t.batchDims+i;if(m>r.length)throw new Error("last dimension of indices must not be larger than rank of input tensor");let g=a.slice(0,-1).concat(r.slice(m)),_=qS.size(g),v=[{type:12,data:_},{type:12,data:l},...xE(n[0].dims,f.dims,g)];e.compute({name:"GatherND",shaderCache:{hint:t.cacheKey,inputDependencies:["rank","rank"]},getRunData:()=>({outputs:[{dims:g,dataType:o}],dispatchGroup:{x:Math.ceil(_/64)},programUniforms:v}),getShaderSource:e=>{let t=AE("data",n[0].dataType,n[0].dims.length),r=AE("slice_offsets",12,f.dims.length),o=ME("output",n[0].dataType,g.length);return"\n          ".concat(e.registerUniform("output_size","u32").registerUniform("slice_size","u32").declareVariables(t,r,o),"\n            ").concat(e.mainStart(),"\n            ").concat(e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size"),"\n          let slice_offset = slice_offsets[global_idx / uniforms.slice_size];\n          output[global_idx] = data[u32(slice_offset) + global_idx % uniforms.slice_size];\n        }")}},{inputs:[n[0],f]})},RF=e=>({batchDims:e.batch_dims,cacheKey:""})})),vO=pD((()=>{Iz(),Oz(),Vz(),qz(),VF=(e,t)=>{if(e.length<3||e.length>4)throw new Error("GatherBlockQuantized requires 3 or 4 inputs.");let n=qS.normalizeAxis(t.quantizeAxis,e[0].dims.length),r=t.blockSize,o=e[0],a=e[2],i=4===e.length?e[3]:void 0;if(a.dims.length!==o.dims.length||!o.dims.map(((e,t)=>t===n?Math.ceil(e/r)===a.dims[t]:e===a.dims[t])).reduce(((e,t)=>e&&t),!0))throw new Error("Scales must have the same rank as the input tensor and the dims should match except on gatherAxis.");if(i){if(i.dataType!==o.dataType)throw new Error("Zero point must have the same data type as the input tensor.");if(i.dims.length!==a.dims.length||!i.dims.map(((e,t)=>e===a.dims[t])).reduce(((e,t)=>e&&t),!0))throw new Error("Zero point must have the same rank as the input tensor and the dims should match except on quantizeAxis.")}},qF=(e,t)=>{let n=e[0].dims,r=e[1].dims,o=n.length,a=qS.normalizeAxis(t.gatherAxis,o),i=qS.normalizeAxis(t.quantizeAxis,o),s=n.slice(0);s.splice(a,1,...r);let l=qS.size(s),c=e[2].dataType,u=22===e[0].dataType,d=[{type:12,data:l},{type:12,data:i},{type:12,data:a},{type:12,data:t.blockSize},...xE(...e.map(((e,t)=>e.dims)),s)];return{name:"GatherBlockQuantized",shaderCache:{hint:"".concat(t.cacheKey,";").concat(e.filter(((e,t)=>1!==t)).map((e=>e.dims.join("_"))).join(";")),inputDependencies:Array.from({length:e.length},((e,t)=>"rank"))},getRunData:()=>({outputs:[{dims:s,dataType:c}],dispatchGroup:{x:Math.ceil(l/64)},programUniforms:d}),getShaderSource:t=>{let o=AE("data",e[0].dataType,e[0].dims.length),i=AE("inputIndices",e[1].dataType,e[1].dims.length),l=AE("scales",e[2].dataType,e[2].dims.length),d=e.length>3?AE("zeroPoint",e[3].dataType,e[3].dims.length):void 0,p=ME("output",c,s.length),h=[o,i,l];d&&h.push(d);return"\n        ".concat(t.registerUniforms([{name:"output_size",type:"u32"},{name:"quantize_axis",type:"u32"},{name:"gather_axis",type:"u32"},{name:"block_size",type:"u32"}]).declareVariables(...h,p),"\n        ").concat(t.mainStart(),"\n        let output_indices = ").concat(p.offsetToIndices("global_idx"),";\n        var indices_indices = ").concat(i.type.indices,"(0);\n        ").concat(r.length>1?"\n          for (var i: u32 = 0; i < ".concat(r.length,"; i++) {\n            let index = ").concat(p.indicesGet("output_indices","uniforms.gather_axis + i"),";\n            ").concat(i.indicesSet("indices_indices","i","index"),";\n          }"):"indices_indices = ".concat(p.indicesGet("output_indices","uniforms.gather_axis"),";"),";\n        var data_indices = ").concat(o.type.indices,"(0);\n        for (var i: u32 = 0; i < uniforms.gather_axis; i++) {\n          let index = ").concat(p.indicesGet("output_indices","i"),";\n          ").concat(o.indicesSet("data_indices","i","index"),";\n        }\n        var index_from_indices = ").concat(i.getByIndices("indices_indices"),";\n        if (index_from_indices < 0) {\n          index_from_indices += ").concat(n[a],";\n        }\n        ").concat(o.indicesSet("data_indices","uniforms.gather_axis","u32(index_from_indices)"),";\n        for (var i = uniforms.gather_axis + 1; i < ").concat(s.length,"; i++) {\n          let index = ").concat(p.indicesGet("output_indices","i + ".concat(r.length," - 1")),";\n          ").concat(o.indicesSet("data_indices","i","index"),";\n        }\n        let data_offset = ").concat(o.indicesToOffset("data_indices"),";\n        let data_index = data_offset % 8;\n        // Convert 4-bit packed data to 8-bit packed data.\n        let packed_4bit_quantized_data = ").concat(o.getByOffset("data_offset / 8"),";\n        let packed_8bit_quantized_data = (packed_4bit_quantized_data >> (4 * (data_index % 2))) & 0x0f0f0f0f;\n        let quantized_data_vec = ").concat(u?"unpack4xI8":"unpack4xU8","(u32(packed_8bit_quantized_data));\n        let quantized_data = quantized_data_vec[data_index / 2];\n        var scale_indices = data_indices;\n        let quantize_axis_index = ").concat(l.indicesGet("data_indices","uniforms.quantize_axis")," / uniforms.block_size;\n        ").concat(l.indicesSet("scale_indices","uniforms.quantize_axis","quantize_axis_index"),";\n        var scale = ").concat(l.getByIndices("scale_indices"),";\n        ").concat(d?"\n              let zero_point_indices = scale_indices;\n              let zero_point_offset = ".concat(d.indicesToOffset("zero_point_indices"),";\n              let zero_point_index = zero_point_offset % 8;\n              let packed_4bit_zero_points = ").concat(d.getByOffset("zero_point_offset / 8"),";\n              let packed_8bit_zero_points = (packed_4bit_zero_points >> (4 * (zero_point_index % 2))) & 0x0f0f0f0f;\n              let zero_point_vec = ").concat(u?"unpack4xI8":"unpack4xU8","(u32(packed_8bit_zero_points));\n              let zero_point = zero_point_vec[zero_point_index / 2];"):"var zero_point = 0",";\n        let dequantized_data = ").concat(bE(c),"(quantized_data - zero_point) * scale;\n        ").concat(p.setByOffset("global_idx","dequantized_data"),";\n    }")}}},UF=(e,t)=>{let n=e.inputs;VF(n,t),e.compute(qF(e.inputs,t))},WF=e=>_E({blockSize:e.blockSize,gatherAxis:e.gatherAxis,quantizeAxis:e.quantizeAxis})})),yO=pD((()=>{Iz(),Oz(),Vz(),qz(),GF=e=>{if(!e||2!==e.length)throw new Error("GatherElements requires 2 inputs.");if(e[0].dims.length<1)throw new Error("GatherElements requires that the data input be rank >= 1.");if(e[0].dims.length!==e[1].dims.length)throw new Error("GatherElements requires that the data input and\n                     indices input tensors be of same rank.")},HF=(e,t)=>{let n=e[0].dims,r=e[0].dataType,o=n.length,a=e[1].dims,i=e[1].dataType,s=qS.normalizeAxis(t.axis,o),l=n[s],c=a.slice(0),u=qS.size(c),d=AE("input",r,o),p=AE("indicesInput",i,a.length),h=ME("output",r,c.length),f=[{type:12,data:u},{type:6,data:l},{type:12,data:s}];return f.push(...xE(n,a,c)),{name:"GatherElements",shaderCache:{inputDependencies:["rank","rank"]},getRunData:()=>({outputs:[{dims:c,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(u/64)},programUniforms:f}),getShaderSource:e=>"\n      ".concat(e.registerUniform("outputSize","u32").registerUniform("axisDimLimit","i32").registerUniform("axis","u32").declareVariables(d,p,h),"\n      ").concat(e.mainStart(),"\n      ").concat(e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize"),"\n\n      let outputIndices = ").concat(h.offsetToIndices("global_idx"),";\n\n      var idx = ").concat(p.getByOffset("global_idx"),";\n      if (idx < 0) {\n        idx = idx + uniforms.axisDimLimit;\n      }\n      var inputIndices = ").concat(d.type.indices,"(outputIndices);\n      ").concat(d.indicesSet("inputIndices","uniforms.axis","u32(idx)"),";\n      let value = ").concat(d.getByIndices("inputIndices"),";\n\n      ").concat(h.setByOffset("global_idx","value"),";\n  }")}},KF=e=>_E({axis:e.axis}),ZF=(e,t)=>{let n=e.inputs;GF(n),e.compute(HF(e.inputs,t))}})),wO=pD((()=>{Iz(),Oz(),qz(),$F=e=>{if(!e)throw new Error("Input is missing");if(e.length<2||e.length>3)throw new Error("Invaid input number.");if(3===e.length&&e[2].dims.length>2)throw new Error("Invalid input shape of C");if(e[0].dataType!==e[1].dataType||3===e.length&&e[0].dataType!==e[2].dataType)throw new Error("Input types are mismatched")},XF=(e,t)=>{let n=e[0].dims.slice(),r=e[1].dims.slice(),[o,a,i]=WS.getShapeOfGemmResult(n,t.transA,r,t.transB,3===e.length?e[2].dims:void 0),s=[o,a];if(!s)throw new Error("Can't use gemm on the given tensors");let l=16,c=Math.ceil(a/l),u=Math.ceil(o/l),d=(qS.size(s),[{type:12,data:c},{type:12,data:o},{type:12,data:a},{type:12,data:i},{type:1,data:t.alpha},{type:1,data:t.beta}]),p=["type","type"];3===e.length&&(d.push(...xE(e[2].dims)),p.push("rank")),d.push(...xE(s));return{name:"GemmShared",shaderCache:{hint:"".concat(t.cacheKey),inputDependencies:p},getRunData:()=>({outputs:[{dims:s,dataType:e[0].dataType}],dispatchGroup:{x:c*u},programUniforms:d}),getShaderSource:n=>{let r=AE("a",e[0].dataType,e[0].dims),o=AE("b",e[1].dataType,e[1].dims),a=null,i=[r,o];3===e.length&&(a=AE("c",e[2].dataType,e[2].dims.length),i.push(a));let c=ME("output",e[0].dataType,s.length);i.push(c);let u="",d="";t.transA&&t.transB?(d="\n      var col = tile_row_start + local_id.x;\n      var row = k_start + local_id.y;\n      if (col < uniforms.M && row < uniforms.K) {\n        tile_a[local_id.y][local_id.x] = a[row * uniforms.M + col];\n      } else {\n        tile_a[local_id.y][local_id.x] = ".concat(r.type.value,"(0);\n      }\n\n      col = k_start + local_id.x;\n      row = tile_col_start + local_id.y;\n      if (col < uniforms.K && row < uniforms.N) {\n        tile_b[local_id.y][local_id.x] = b[row * uniforms.K + col];\n      } else {\n        tile_b[local_id.y][local_id.x] = ").concat(o.type.value,"(0);\n      }\n      "),u="value += tile_a[k][local_id.y] * tile_b[local_id.x][k];"):t.transA&&!t.transB?(d="\n      var col = tile_row_start + local_id.x;\n      var row = k_start + local_id.y;\n      if (col < uniforms.M && row < uniforms.K) {\n        tile_a[local_id.y][local_id.x] = a[row * uniforms.M + col];\n      } else {\n        tile_a[local_id.y][local_id.x] = ".concat(r.type.value,"(0);\n      }\n\n      col = tile_col_start + local_id.x;\n      row = k_start + local_id.y;\n      if (col < uniforms.N && row < uniforms.K) {\n        tile_b[local_id.y][local_id.x] = b[row * uniforms.N + col];\n      } else {\n        tile_b[local_id.y][local_id.x] = ").concat(o.type.value,"(0);\n      }\n      "),u="value += tile_a[k][local_id.y] * tile_b[k][local_id.x];"):!t.transA&&t.transB?(d="\n      var col = k_start + local_id.x;\n      var row = tile_row_start + local_id.y;\n      if (col < uniforms.K && row < uniforms.M) {\n        tile_a[local_id.y][local_id.x] = a[row * uniforms.K + col];\n      } else {\n        tile_a[local_id.y][local_id.x] = ".concat(r.type.value,"(0);\n      }\n\n      col = k_start + local_id.x;\n      row = tile_col_start + local_id.y;\n      if (col < uniforms.K && row < uniforms.N) {\n        tile_b[local_id.y][local_id.x] = b[row * uniforms.K + col];\n      } else {\n        tile_b[local_id.y][local_id.x] = ").concat(o.type.value,"(0);\n      }\n      "),u="value += tile_a[local_id.y][k] * tile_b[local_id.x][k];"):!t.transA&&!t.transB&&(d="\n      var col = k_start + local_id.x;\n      var row = tile_row_start + local_id.y;\n      if (col < uniforms.K && row < uniforms.M) {\n        tile_a[local_id.y][local_id.x] = a[row * uniforms.K + col];\n      } else {\n        tile_a[local_id.y][local_id.x] = ".concat(r.type.value,"(0);\n      }\n\n      col = tile_col_start + local_id.x;\n      row = k_start + local_id.y;\n      if (col < uniforms.N && row < uniforms.K) {\n        tile_b[local_id.y][local_id.x] = b[row * uniforms.N + col];\n      } else {\n        tile_b[local_id.y][local_id.x] = ").concat(o.type.value,"(0);\n      }\n      "),u="value += tile_a[local_id.y][k] * tile_b[k][local_id.x];");let p=1===t.alpha?"":"value *= uniforms.alpha;";return"\n  ".concat(n.registerUniforms([{name:"num_tile_n",type:"u32"},{name:"M",type:"u32"},{name:"N",type:"u32"},{name:"K",type:"u32"},{name:"alpha",type:"f32"},{name:"beta",type:"f32"}]).declareVariables(...i),"\n  var<workgroup> tile_a: array<array<").concat(r.type.storage,", ").concat(l,">, ").concat(l,">;\n  var<workgroup> tile_b: array<array<").concat(o.type.storage,", ").concat(l,">, ").concat(l,">;\n  ").concat(n.mainStart([l,l,1]),"\n    let tile_col_start = (workgroup_index % uniforms.num_tile_n) * ").concat(l,";\n    let tile_row_start = (workgroup_index / uniforms.num_tile_n) * ").concat(l,";\n    let num_tiles = (uniforms.K - 1) / ").concat(l," + 1;\n    var k_start = 0u;\n    var value = ").concat(c.type.value,"(0);\n    for (var t: u32 = 0u; t < num_tiles; t++) {\n      ").concat(d,"\n      k_start = k_start + ").concat(l,";\n      workgroupBarrier();\n\n      for (var k: u32 = 0u; k < ").concat(l,"; k++) {\n        ").concat(u,"\n      }\n      workgroupBarrier();\n    }\n\n    ").concat(p,"\n    let m = tile_row_start + local_id.y;\n    let n = tile_col_start + local_id.x;\n    ").concat(null!=a?"let cOffset = ".concat(a.broadcastedIndicesToOffset("vec2(m, n)",c),"; value += ").concat(c.type.value,"(uniforms.beta) * ").concat(a.getByOffset("cOffset"),";"):"","\n    if (m < uniforms.M && n < uniforms.N) {\n      output[m * uniforms.N + n] = value;\n    }\n  }")}}},JF=e=>({transA:e.transA,transB:e.transB,alpha:e.alpha,beta:e.beta,cacheKey:"".concat(e.transA,";").concat(e.transB,";").concat(1===e.alpha)}),QF=(e,t)=>{$F(e.inputs),e.compute(XF(e.inputs,t))}})),bO=pD((()=>{Iz(),Oz(),Vz(),qz(),[YF,eI,tI,nI]=[0,1,2,3],rI=e=>{if(4!==e[0].dims.length)throw new Error("only 4-D tensor is supported.");if(e[0].dims.length!==e[1].dims.length)throw new Error("input dimensions must be equal to grid dimensions");if(e[0].dims.length-2!==e[1].dims[e[1].dims.length-1])throw new Error("last dimension of grid must be equal to ".concat(e[0].dims.length-2));if(e[0].dims[0]!==e[1].dims[0])throw new Error("grid batch size must match input batch size")},oI=e=>"\n  fn gs_bicubic_interpolate(p: mat4x4<".concat(e,">, x: f32, y: f32) -> ").concat(e," {\n    var v: vec4<f32>;\n    var coeffs = gs_get_cubic_coeffs(x);\n    for (var i = 0; i < 4; i++) {\n      v[i] = coeffs[0] * p[i][0] + coeffs[1] * p[i][1] + coeffs[2] * p[i][2] + coeffs[3] * p[i][3];\n    }\n    coeffs = gs_get_cubic_coeffs(y);\n    let pixel = ").concat(e,"(coeffs[0] * v[0] + coeffs[1] * v[1] + coeffs[2] * v[2] + coeffs[3] * v[3]);\n    return pixel;\n  }\n"),aI=e=>"\n  fn gs_denormalize(n: f32, length: i32) -> f32 {\n    ".concat(0===e.alignCorners?"\n    // alignCorners: false => [-1, 1] to [-0.5, length - 0.5]\n    return ((n + 1.0) * f32(length) - 1.0) / 2.0;\n    ":"\n    // alignCorners: true => [-1, 1] to [0, length - 1]\n    return (n + 1.0) / 2.0 * (f32(length - 1));\n    ","\n  }\n"),iI=e=>"\n  ".concat("reflection"===e.paddingMode?"\n      fn gs_reflect(x: i32, x_min: f32, x_max: f32) -> u32 {\n        var dx = 0.0;\n        var fx = f32(x);\n        let range = x_max - x_min;\n        if (fx < x_min) {\n          dx = x_min - fx;\n          let n = u32(dx / range);\n          let r = dx - f32(n) * range;\n          if (n % 2 == 0) {\n            fx = x_min + r;\n          } else {\n            fx = x_max - r;\n          }\n        } else if (fx > x_max) {\n          dx = fx - x_max;\n          let n = u32(dx / range);\n          let r = dx - f32(n) * range;\n          if (n % 2 == 0) {\n            fx = x_max - r;\n          } else {\n            fx = x_min + r;\n          }\n        }\n        return u32(fx);\n      }":"","\n"),sI=(e,t,n)=>"\n  fn pixel_at_grid(r: i32, c: i32, H: i32, W: i32, batch: u32, channel: u32, border: vec4<f32>) -> ".concat(t," {\n     var pixel = ").concat(t,"(0);\n     var indices = vec4<u32>(0);\n     indices[").concat(YF,"] = batch;\n     indices[").concat(eI,"] = channel;")+(()=>{switch(n.paddingMode){case"zeros":return"\n          if (r >= 0 && r < H && c >=0 && c < W) {\n            indices[".concat(tI,"] = u32(r);\n            indices[").concat(nI,"] = u32(c);\n          } else {\n            return ").concat(t,"(0);\n          }\n        ");case"border":return"\n          indices[".concat(tI,"] = u32(clamp(r, 0, H - 1));\n          indices[").concat(nI,"] = u32(clamp(c, 0, W - 1));\n        ");case"reflection":return"\n          indices[".concat(tI,"] = gs_reflect(r, border[1], border[3]);\n          indices[").concat(nI,"] = gs_reflect(c, border[0], border[2]);\n        ");default:throw new Error("padding mode ".concat(n.paddingMode," is not supported"))}})()+"\n    return ".concat(e.getByIndices("indices"),";\n  }\n"),lI=(e,t,n)=>(()=>{switch(n.mode){case"nearest":return"\n          let result = pixel_at_grid(i32(round(y)), i32(round(x)), H_in, W_in, indices[".concat(YF,"], indices[").concat(eI,"], border);\n        ");case"bilinear":return"\n          let x1 = i32(floor(x));\n          let y1 = i32(floor(y));\n          let x2 = x1 + 1;\n          let y2 = y1 + 1;\n\n          let p11 = pixel_at_grid(y1, x1, H_in, W_in, indices[".concat(YF,"], indices[").concat(eI,"], border);\n          let p12 = pixel_at_grid(y1, x2, H_in, W_in, indices[").concat(YF,"], indices[").concat(eI,"], border);\n          let p21 = pixel_at_grid(y2, x1, H_in, W_in, indices[").concat(YF,"], indices[").concat(eI,"], border);\n          let p22 = pixel_at_grid(y2, x2, H_in, W_in, indices[").concat(YF,"], indices[").concat(eI,"], border);\n\n          let dx2 = ").concat(t,"(f32(x2) - x);\n          let dx1 = ").concat(t,"(x - f32(x1));\n          let dy2 = ").concat(t,"(f32(y2) - y);\n          let dy1 = ").concat(t,"(y - f32(y1));\n          let result = dy2 * (dx2 * p11 + dx1 * p12) + dy1 * (dx2 * p21 + dx1 * p22);\n        ");case"bicubic":return"\n          let x0 = i32(floor(x)) - 1;\n          let y0 = i32(floor(y)) - 1;\n          var p: mat4x4<".concat(t,">;\n          for (var h = 0; h < 4; h++) {\n            for (var w = 0; w < 4; w++) {\n              p[h][w] = pixel_at_grid(h + y0, w + x0, H_in, W_in, indices[").concat(YF,"], indices[").concat(eI,"], border);\n            }\n          }\n\n          let dx = x - f32(x0 + 1);\n          let dy = y - f32(y0 + 1);\n          let result = gs_bicubic_interpolate(p, dx, dy);\n        ");default:throw new Error("mode ".concat(n.mode," is not supported"))}})()+"".concat(e.setByOffset("global_idx","result")),cI=(e,t)=>{let n=AE("x",e[0].dataType,e[0].dims.length),r=[e[1].dims[0],e[1].dims[1],e[1].dims[2]],o=AE("grid",e[1].dataType,r.length,2),a=[e[0].dims[0],e[0].dims[1],e[1].dims[1],e[1].dims[2]];"NHWC"===t.format&&(a=[e[0].dims[0],e[1].dims[1],e[1].dims[2],e[0].dims[3]],[YF,eI,tI,nI]=[0,3,1,2]);let i=ME("output",e[0].dataType,a.length),s=n.type.value,l=[{type:12,data:qS.size(a)},...xE(e[0].dims,r,a)];return{name:"GridSample",shaderCache:{hint:"".concat(t.cacheKey),inputDependencies:["type","type"]},getRunData:e=>{let t=qS.size(a);return{outputs:[{dims:a,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(t/64)},programUniforms:l}},getShaderSource:e=>"\n  ".concat(e.registerUniform("output_size","u32").declareVariables(n,o,i),"\n  ").concat("\n  fn gs_get_cubic_coeffs(x: f32) -> vec4<f32> {\n    let cubic_alpha = -0.75f;\n    let x_abs = abs(x);\n    var coeffs: vec4<f32>;\n    coeffs[0] = (((cubic_alpha * (x_abs + 1) - 5 * cubic_alpha) * (x_abs + 1) + 8 * cubic_alpha) * (x_abs + 1) - 4 * cubic_alpha);\n    coeffs[1] = (((cubic_alpha + 2) * x_abs - (cubic_alpha + 3)) * x_abs * x_abs + 1);\n    coeffs[2] = (((cubic_alpha + 2) * (1 - x_abs) - (cubic_alpha + 3)) * (1 - x_abs) * (1 - x_abs) + 1);\n    coeffs[3] = (((cubic_alpha * (2 - x_abs) - 5 * cubic_alpha) * (2 - x_abs) + 8 * cubic_alpha) * (2 - x_abs) - 4 * cubic_alpha);\n    return coeffs;\n  }\n","\n  ").concat(oI(s),"\n  ").concat(aI(t),"\n  ").concat(iI(t),"\n  ").concat(sI(n,s,t),"\n\n  ").concat(e.mainStart(),"\n    ").concat(e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size"),"\n      let H_in = i32(uniforms.x_shape[").concat(tI,"]);\n      let W_in = i32(uniforms.x_shape[").concat(nI,"]);\n\n      ").concat(0===t.alignCorners?"\n      let x_min = -0.5;\n      let x_max = f32(W_in) - 0.5;\n      let y_min = -0.5;\n      let y_max = f32(H_in) - 0.5;\n      ":"\n      let x_min = 0.0;\n      let x_max = f32(W_in) - 1.0;\n      let y_min = 0.0;\n      let y_max = f32(H_in) - 1.0;\n      ",";\n      let border = vec4<f32>(x_min, y_min, x_max, y_max);\n\n      let indices = ").concat(i.offsetToIndices("global_idx"),";\n      var grid_indices = vec3<u32>(indices[").concat(YF,"], indices[").concat(tI,"], indices[").concat(nI,"]);\n      let nxy = ").concat(o.getByIndices("grid_indices"),";\n      var x = gs_denormalize(f32(nxy[0]), W_in);\n      var y = gs_denormalize(f32(nxy[1]), H_in);\n\n      ").concat(lI(i,s,t),"\n  }")}},uI=(e,t)=>{rI(e.inputs),e.compute(cI(e.inputs,t))},dI=e=>_E({alignCorners:e.align_corners,mode:e.mode,paddingMode:e.padding_mode,format:e.format})})),xO=pD((()=>{Iz(),Oz(),Vz(),Lz(),Kz(),qz(),Uz(),pI=(e,t)=>e.length>t&&e[t].dims.length>0?e[t]:void 0,hI=(e,t)=>{let n=e[0],r=pI(e,1),o=pI(e,2),a=pI(e,3),i=pI(e,4),s=pI(e,5),l=pI(e,6),c=pI(e,7);if(3!==n.dims.length&&5!==n.dims.length)throw new Error("Input query is expected to have 3 or 5 dimensions");let u,d=n.dims[0],p=n.dims[1],h=3===n.dims.length?n.dims[2]:t.numHeads*n.dims[4],f=p,m=0,g=0,_=Math.floor(h/t.numHeads);if(l&&c&&qS.size(l.dims)&&qS.size(c.dims)){if(4!==l.dims.length)throw new Error('Input "past_key" is expected to have 4 dimensions');if(l.dims[0]!==d||l.dims[1]!==t.numHeads||l.dims[3]!==_)throw new Error('Input "past_key" shape (batch_size, num_heads, past_sequence_length, head_size)');if(c.dims[0]!==d||c.dims[1]!==t.numHeads||c.dims[3]!==_)throw new Error('Input "past_value" shape (batch_size, num_heads, past_sequence_length, head_size)');if(l.dims[2]!==c.dims[2])throw new Error('Input "past_key" and "past_value" shall have same dim 2 (past_sequence_length)');if(4!==c.dims.length)throw new Error('Input "past_value" is expected to have 4 dimensions');m=l.dims[2],g=l.dims[2]}else if(l&&qS.size(l.dims)||c&&qS.size(c.dims))throw new Error('Input "past_key" and "past_value" shall be both present or both absent');if(r&&qS.size(r.dims)>0){if(3!==n.dims.length)throw new Error('Input "query" is expected to have 3 dimensions when key is given');if(r.dims.length<3||r.dims.length>5)throw new Error('Input "key" is expected to have 3, 4, or 5 dimensions');if(n.dims[0]!==r.dims[0])throw new Error('Input "query" and "key" shall have same dim 0 (batch size)');if(3===r.dims.length){if(r.dims[2]!==n.dims[2])throw new Error('Input "query" and "key" shall have same dim 2 (hidden_size)');u=2,f=r.dims[1]}else if(5===r.dims.length){if(r.dims[2]!==t.numHeads||2!==r.dims[3]||r.dims[4]!==_)throw new Error('Expect "key" shape (batch_size, kv_sequence_length, num_heads, 2, head_size) for packed kv');if(o)throw new Error('Expect "value" be none when "key" has packed kv format.');u=5,f=r.dims[1]}else{if(r.dims[1]!==t.numHeads||r.dims[3]!==_)throw new Error('Expect "key" shape (batch_size, num_heads, kv_sequence_length, head_size) for past_key');u=0,f=r.dims[2]}}else{if(5!==n.dims.length)throw new Error('Input "query" is expected to have 5 dimensions when key is empty');if(n.dims[2]!==t.numHeads||3!==n.dims[3])throw new Error('Expect "query" shape (batch_size, kv_sequence_length, num_heads, 3, head_size) for packed kv');u=3}if(a&&qS.size(a.dims)>0){if(1!==a.dims.length)throw new Error('Input "bias" is expected to have 1 dimension');if(r&&5===r.dims.length&&2===r.dims[3])throw new Error("bias is not allowed for packed kv.")}let v=m+f,y=0;if(i&&qS.size(i.dims)>0){y=8;let e=i.dims;throw 1===e.length?e[0]===d?y=1:e[0]===3*d+2&&(y=3):2===e.length&&e[0]===d&&e[1]===v&&(y=5),8===y?new Error('Input "key_padding_mask" shape shall be (batch_size) or (batch_size, total_sequence_length)'):new Error("Mask not supported")}let w=!1,b=h;if(o&&qS.size(o.dims)>0){if(3!==o.dims.length&&4!==o.dims.length)throw new Error('Input "value" is expected to have 3 or 4 dimensions');if(n.dims[0]!==o.dims[0])throw new Error('Input "query" and "value" shall have same dim 0 (batch_size)');if(3===o.dims.length){if(f!==o.dims[1])throw new Error('Input "key" and "value" shall have the same dim 1 (kv_sequence_length)');b=o.dims[2]}else{if(f!==o.dims[2])throw new Error('Input "key" and "value" shall have the same dim 2 (kv_sequence_length)');b=o.dims[1]*o.dims[3],w=!0}}if(i&&qS.size(i.dims)>0)throw new Error("Key padding mask is not supported");if(s&&qS.size(s.dims)>0){if(4!==s.dims.length)throw new Error('Input "attention_bias" is expected to have 4 dimensions');if(s.dims[0]!==d||s.dims[1]!==t.numHeads||s.dims[2]!==p||s.dims[3]!==v)throw new Error('Expect "attention_bias" shape (batch_size, num_heads, sequence_length, total_sequence_length)')}return{batchSize:d,sequenceLength:p,pastSequenceLength:m,kvSequenceLength:f,totalSequenceLength:v,maxSequenceLength:g,inputHiddenSize:0,hiddenSize:h,vHiddenSize:b,headSize:_,vHeadSize:Math.floor(b/t.numHeads),numHeads:t.numHeads,isUnidirectional:!1,pastPresentShareBuffer:!1,maskFilterValue:t.maskFilterValue,maskType:y,scale:t.scale,broadcastResPosBias:!1,passPastInKv:w,qkvFormat:u}},fI=e=>_E(so({},e)),mI=_E({perm:[0,2,1,3]}),gI=(e,t,n,r,o,a,i)=>{let s=[r,o,a],l=qS.size(s),c=[{type:12,data:l},{type:12,data:i},{type:12,data:a}];return e.compute({name:"MultiHeadAttentionAddBias",shaderCache:{inputDependencies:["type","type"]},getRunData:()=>({outputs:[{dims:s,dataType:t.dataType,gpuDataType:0}],dispatchGroup:{x:Math.ceil(l/64)},programUniforms:c}),getShaderSource:e=>{let r=ME("qkv_with_bias",t.dataType,s),o=AE("qkv",t.dataType,s),a=AE("bias",n.dataType,s);return"\n  ".concat(e.registerUniforms([{name:"output_size",type:"u32"},{name:"bias_offset",type:"u32"},{name:"hidden_size",type:"u32"}]).declareVariables(o,a,r),"\n  ").concat(e.mainStart(),"\n    ").concat(e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size"),"\n    let bias_offset_idx = (global_idx % uniforms.hidden_size) + uniforms.bias_offset;\n\n    qkv_with_bias[global_idx] = qkv[global_idx] + bias[bias_offset_idx];\n  }")}},{inputs:[t,n],outputs:[-1]})[0]},_I=(e,t,n,r,o,a,i,s)=>{let l=a;if(i&&qS.size(i.dims)>0){if(1===r)throw new Error("AddBiasReshape is not implemented. Please export your model with packed QKV or KV");return l=gI(e,a,i,t,r,n*o,s),l=l.reshape([t,r,n,o]),1===n||1===r?l:e.compute(VE(l,mI.perm),{inputs:[l],outputs:[-1]})[0]}return 3===a.dims.length&&(l=a.reshape([t,r,n,o])),1===n||1===r?l:e.compute(VE(l,mI.perm),{inputs:[l],outputs:[-1]})[0]},vI=(e,t)=>{let n=hI(e.inputs,t),r=e.inputs[0],o=pI(e.inputs,1),a=pI(e.inputs,2),i=pI(e.inputs,3),s=pI(e.inputs,4),l=pI(e.inputs,5),c=pI(e.inputs,6),u=pI(e.inputs,7);if(5===r.dims.length)throw new Error("Packed QKV is not implemented");if(5===(null===o||void 0===o?void 0:o.dims.length))throw new Error("Packed KV is not implemented");let d=o&&a&&4===o.dims.length&&4===a.dims.length,p=_I(e,n.batchSize,n.numHeads,n.sequenceLength,n.headSize,r,i,0);if(d)return HT(e,p,o,a,s,void 0,c,u,l,n);if(!o||!a)throw new Error("key and value must be provided");let h=_I(e,n.batchSize,n.numHeads,n.kvSequenceLength,n.headSize,o,i,n.hiddenSize),f=_I(e,n.batchSize,n.numHeads,n.kvSequenceLength,n.vHeadSize,a,i,2*n.hiddenSize);HT(e,p,h,f,s,void 0,c,u,l,n)}})),kO=pD((()=>{Iz(),Oz(),Vz(),qz(),yI=e=>{if(!e||e.length<1)throw new Error("too few inputs")},wI=(e,t)=>{let n=[],r=t.numOutputs;return e[1].dims[0]>0&&(e[1].getBigInt64Array().forEach((e=>n.push(Number(e)))),r=n.length),_E({numOutputs:r,axis:t.axis,splitSizes:n})},bI=e=>"\nfn calculateOutputIndex(index: u32) -> u32 {\n    for (var i: u32 = 0u; i < ".concat(e,"u; i += 1u ) {\n    if (index < ").concat(EE("uniforms.size_in_split_axis","i",e),") {\n        return i;\n    }\n    }\n    return ").concat(e,"u;\n}"),xI=e=>{let t=e.length,n=[];for(let r=0;r<t;++r){let o=e[r].setByIndices("indices","input[global_idx]");1===t?n.push(o):0===r?n.push("if (output_number == ".concat(r,"u) { ").concat(o," }")):r===t-1?n.push("else { ".concat(o," }")):n.push("else if (output_number == ".concat(r,") { ").concat(o," }"))}return"\n      fn writeBufferData(output_number: u32, indices: ".concat(e[0].type.indices,", global_idx: u32) {\n        ").concat(n.join("\n"),"\n      }")},kI=(e,t)=>{let n=e[0].dims,r=qS.size(n),o=e[0].dataType,a=qS.normalizeAxis(t.axis,n.length),i=new Array(t.numOutputs),s=AE("input",o,n.length),l=new Array(t.numOutputs),c=[],u=[],d=0,p=[{type:12,data:r}];for(let h=0;h<t.numOutputs;h++){d+=t.splitSizes[h],l[h]=d;let r=n.slice();r[a]=t.splitSizes[h],u.push(r),i[h]=ME("output".concat(h),o,r.length),c.push({dims:u[h],dataType:e[0].dataType})}p.push({type:12,data:l},...xE(n,...u));return{name:"Split",shaderCache:{hint:t.cacheKey,inputDependencies:["rank"]},getShaderSource:e=>"\n  ".concat(e.registerUniform("input_size","u32").registerUniform("size_in_split_axis","u32",l.length).declareVariables(s,...i),"\n  ").concat(bI(l.length),"\n  ").concat(xI(i),"\n\n  ").concat(e.mainStart(),"\n    ").concat(e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.input_size"),"\n\n    var indices = ").concat(s.offsetToIndices("global_idx"),";\n    var index = ").concat(s.indicesGet("indices",a),";\n    let output_number = calculateOutputIndex(index);\n    if (output_number != 0) {\n      index -= ").concat(EE("uniforms.size_in_split_axis","output_number - 1u",l.length),";\n      ").concat(s.indicesSet("indices",a,"index"),";\n    }\n    writeBufferData(output_number, indices, global_idx);\n  }"),getRunData:()=>({outputs:c,dispatchGroup:{x:Math.ceil(r/64)},programUniforms:p})}},CI=(e,t)=>{yI(e.inputs);let n=1===e.inputs.length?t:wI(e.inputs,t);e.compute(kI(e.inputs,n),{inputs:[0]})},DI=e=>{let t=e.axis,n=e.splitSizes,r=e.numOutputs<0?n.length:e.numOutputs;if(r!==n.length)throw new Error("numOutputs and splitSizes lengh must be equal");return _E({axis:t,numOutputs:r,splitSizes:n})}})),CO=pD((()=>{Iz(),Oz(),Vz(),qz(),SI=(e,t)=>{let[n,r,o,a]=e,{numHeads:i,rotaryEmbeddingDim:s}=t;if(3!==n.dims.length&&4!==n.dims.length)throw new Error("Input 'x' is expected to have 3 or 4 dimensions, got ".concat(n.dims.length));if(!qS.areEqual(r.dims,[])&&!qS.areEqual(r.dims,[1])&&2!==r.dims.length)throw new Error("Input 'position_ids' is expected to have 0, 1, or 2 dimensions, got ".concat(r.dims.length));if(2!==o.dims.length)throw new Error("Input 'cos_cache' is expected to have 2 dimensions, got ".concat(o.dims.length));if(2!==a.dims.length)throw new Error("Input 'sin_cache' is expected to have 2 dimensions, got ".concat(a.dims.length));if(!qS.areEqual(o.dims,a.dims))throw new Error("Inputs 'cos_cache' and 'sin_cache' are expected to have the same shape");if(s>0&&0===i)throw new Error("num_heads must be provided if rotary_embedding_dim is specified");let l=n.dims[0],c=n.dims[n.dims.length-2],u=o.dims[0],d=qS.sizeFromDimension(n.dims,1)/c,p=0===s?2*o.dims[1]:d/i;if(s>p)throw new Error("rotary_embedding_dim must be less than or equal to head_size");if(2===r.dims.length){if(l!==r.dims[0])throw new Error("Input 'position_ids' dimension 0 should be of size batch_size, got ".concat(r.dims[0]));if(c!==r.dims[1])throw new Error("Input 'position_ids' dimension 1 should be of size sequence_length, got ".concat(r.dims[1]))}if(p/2!==o.dims[1]&&s/2!==o.dims[1])throw new Error("Input 'cos_cache' dimension 1 should be same as head_size / 2 or rotary_embedding_dim / 2, got ".concat(o.dims[1]));if(c>u)throw new Error("Updating cos_cache and sin_cache in RotaryEmbedding is not currently supported")},EI=(e,t)=>{let{interleaved:n,numHeads:r,rotaryEmbeddingDim:o,scale:a}=t,i=e[0].dims[0],s=qS.sizeFromDimension(e[0].dims,1),l=e[0].dims[e[0].dims.length-2],c=s/l,u=e[2].dims[1],d=0===o?2*u:c/r,p=new Array(i,l,c/d,d-u),h=qS.computeStrides(p),f=[{type:1,data:a},{type:12,data:p},{type:12,data:h},...3===e[0].dims.length?new Array({type:12,data:[s,c,d,1]}):[],...4===e[0].dims.length?new Array({type:12,data:[s,d,l*d,1]}):[],...xE(e[0].dims,e[1].dims,e[2].dims,e[3].dims,e[0].dims)];return{name:"RotaryEmbedding",shaderCache:{hint:_E({interleaved:n}).cacheKey,inputDependencies:["rank","rank","rank","rank"]},getShaderSource:t=>{let r=AE("input",e[0].dataType,e[0].dims.length),o=AE("position_ids",e[1].dataType,e[1].dims.length),a=AE("cos_cache",e[2].dataType,e[2].dims.length),i=AE("sin_cache",e[3].dataType,e[3].dims.length),s=ME("output",e[0].dataType,e[0].dims.length);return t.registerUniforms([{name:"scale",type:"f32"},{name:"global_shape",type:"u32",length:p.length},{name:"global_strides",type:"u32",length:h.length},{name:"input_output_strides",type:"u32",length:h.length}]),"\n        ".concat(t.declareVariables(r,o,a,i,s),"\n\n        ").concat(t.mainStart(vE),"\n          let half_rotary_emb_dim = uniforms.").concat(a.name,"_shape[1];\n          let bsnh = global_idx / uniforms.global_strides % uniforms.global_shape;\n          let size = uniforms.global_shape[0] * uniforms.global_strides[0];\n          ").concat(t.guardAgainstOutOfBoundsWorkgroupSizes("size"),"\n\n          if (bsnh[3] < half_rotary_emb_dim) {\n            let position_ids_idx =\n                ").concat(o.broadcastedIndicesToOffset("bsnh.xy",ME("",o.type.tensor,2)),";\n            let position_id =\n                u32(").concat(o.getByOffset("position_ids_idx"),") + select(0, bsnh[1], position_ids_idx == 0);\n            let i = dot(bsnh, uniforms.input_output_strides) + select(0, bsnh[3], ").concat(n,");\n            let j = i + select(half_rotary_emb_dim, 1, ").concat(n,");\n            let re = ").concat(r.getByOffset("i")," * ").concat(a.get("position_id","bsnh[3]")," -\n                ").concat(r.getByOffset("j")," * ").concat(i.get("position_id","bsnh[3]"),";\n            ").concat(s.setByOffset("i","re"),"\n            let im = ").concat(r.getByOffset("i")," * ").concat(i.get("position_id","bsnh[3]")," +\n                ").concat(r.getByOffset("j")," * ").concat(a.get("position_id","bsnh[3]"),";\n            ").concat(s.setByOffset("j","im"),"\n          } else {\n            let k = dot(bsnh, uniforms.input_output_strides) + half_rotary_emb_dim;\n            ").concat(s.setByOffset("k",r.getByOffset("k")),"\n          }\n        }")},getRunData:()=>({outputs:[{dims:e[0].dims,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(qS.size(p)/vE)},programUniforms:f})}},TI=(e,t)=>{SI(e.inputs,t),e.compute(EI(e.inputs,t))}})),DO=pD((()=>{Vz(),Iz(),Kz(),xO(),kO(),Uz(),CO(),qz(),AI=(e,t)=>{if(t.doRotary&&e.length<=7)throw new Error("cos_cache and sin_cache inputs are required if do_rotary is specified");let n=e[0],r=e[1],o=e[2],a=e[3],i=e[4];if(0!==t.doRotary&&e.length<=7)throw new Error("cos_cast and sin_cache are expected if do_rotary attribute is non-zero");if(-1!==t.localWindowSize)throw new Error("Local attention is not supported");if(0!==t.softcap)throw new Error("Softcap is not supported");if(0!==t.rotaryInterleaved)throw new Error("Rotary interleaved is not supported");if(t.smoothSoftmax)throw new Error("Smooth softmax is not supported");if(3!==n.dims.length&&5!==n.dims.length)throw new Error("Input query is expected to have 3 or 5 dimensions");let s=n.dims[0],l=n.dims[1],c=3===n.dims.length?n.dims[2]:t.numHeads*n.dims[4],u=l,d=0,p=!r||0===r.dims.length,h=Math.floor(p?c/(t.numHeads+2*t.kvNumHeads):c/t.numHeads);p&&(c=h*t.numHeads);let f=a&&0!==a.dims.length,m=i&&0!==i.dims.length;if(f&&4===a.dims.length&&a.dims[0]===s&&a.dims[1]!==t.kvNumHeads&&a.dims[2]===t.kvNumHeads&&a.dims[3]===h)throw new Error("BSNH pastKey/pastValue is not supported");if(f&&m){if(4!==a.dims.length)throw new Error('Input "past_key" is expected to have 4 dimensions');if(4!==i.dims.length)throw new Error('Input "past_value" is expected to have 4 dimensions');d=a.dims[2]}else if(f||m)throw new Error('Input "past_key" and "past_value" shall be both present or both absent');let g=1;if(r&&r.dims.length>0){if(3!==n.dims.length)throw new Error('Input "query" is expected to have 3 dimensions when key is given');if(r.dims.length<3||r.dims.length>5)throw new Error('Input "key" is expected to have 3, 4, or 5 dimensions');if(n.dims[0]!==r.dims[0])throw new Error('Input "query" and "key" shall have same dim 0 (batch size)');if(3===r.dims.length){if(n.dims[2]%r.dims[2]!==0)throw new Error('Dimension 2 of "query" should be a multiple of "key"');u=r.dims[1]}else if(5===r.dims.length){if(r.dims[2]!==t.numHeads||2!==r.dims[3]||r.dims[4]!==h)throw new Error('Expect "key" shape (batch_size, kv_sequence_length, num_heads, 2, head_size) for packed kv');if(o)throw new Error('Expect "value" be none when "key" has packed kv format.');u=r.dims[1]}else{if(r.dims[1]!==t.numHeads||r.dims[3]!==h)throw new Error('Expect "key" shape (batch_size, num_heads, kv_sequence_length, head_size) for past_key');u=r.dims[2]}}else{if(3!==n.dims.length&&5!==n.dims.length)throw new Error('Input "query" is expected to have 3 or 5 dimensions when key is empty');if(5===n.dims.length&&(n.dims[2]!==t.numHeads||3!==n.dims[3]))throw new Error('Expect "query" shape (batch_size, kv_sequence_length, num_heads, 3, head_size) for packed kv');g=3}let _=!1,v=t.kvNumHeads?h*t.kvNumHeads:c;if(o&&o.dims.length>0){if(3!==o.dims.length&&4!==o.dims.length)throw new Error('Input "value" is expected to have 3 or 4 dimensions');if(n.dims[0]!==o.dims[0])throw new Error('Input "query" and "value" shall have same dim 0 (batch_size)');if(3===o.dims.length){if(u!==o.dims[1])throw new Error('Input "key" and "value" shall have the same dim 1 (kv_sequence_length)');v=o.dims[2]}else{if(u!==o.dims[2])throw new Error('Input "past_key" and "past_value" shall have the same dim 2 (kv_sequence_length)');v=o.dims[1]*o.dims[3],_=!0}}let y=e.length>4?e[5]:void 0;if(y&&1!==y.dims.length&&y.dims[0]!==s)throw new Error('Input "seqlens" is expected to have 1 dimension and the same dim 0 as batch_size');return{batchSize:s,sequenceLength:l,pastSequenceLength:d,kvSequenceLength:u,totalSequenceLength:-1,maxSequenceLength:-1,inputHiddenSize:0,hiddenSize:c,vHiddenSize:v,headSize:h,vHeadSize:Math.floor(v/t.kvNumHeads),numHeads:t.numHeads,kvNumHeads:t.kvNumHeads,nReps:t.numHeads/t.kvNumHeads,pastPresentShareBuffer:!1,maskType:0,scale:t.scale,broadcastResPosBias:!1,passPastInKv:_,qkvFormat:g}},MI=_E({perm:[0,2,1,3]}),FI=(e,t,n)=>{let r=t,o=n.kvNumHeads;return 3===t.dims.length&&0!==n.kvSequenceLength&&(r=t.reshape([n.batchSize,n.kvSequenceLength,o,n.headSize]),r=e.compute(VE(r,MI.perm),{inputs:[r],outputs:[-1]})[0]),r},II=(e,t,n,r)=>{let o=[e*t],a=e*t,i=[{type:12,data:a},{type:12,data:t},{type:12,data:e}];return{name:"GeneratePositionIds",shaderCache:{hint:"".concat(e,";").concat(t),inputDependencies:["type","type"]},getRunData:()=>({outputs:[{dims:o,dataType:7}],dispatchGroup:{x:Math.ceil(a/64)},programUniforms:i}),getShaderSource:e=>{let t=AE("seq_lens",n.dataType,n.dims),a=AE("total_seq_lens",r.dataType,r.dims),i=ME("pos_ids",7,o);return"\n  ".concat(e.registerUniforms([{name:"output_size",type:"u32"},{name:"sequence_length",type:"u32"},{name:"batch_size",type:"u32"}]).declareVariables(t,a,i),"\n  ").concat(e.mainStart(),"\n    ").concat(e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size"),"\n    let total_sequence_length = u32(").concat(a.getByOffset("0"),");\n    let is_subsequent_prompt = uniforms.sequence_length > 1 && uniforms.sequence_length != total_sequence_length;\n    let is_first_prompt = !is_subsequent_prompt && uniforms.sequence_length == total_sequence_length;\n    let batch_idx = global_idx / uniforms.sequence_length;\n    let sequence_idx = i32(global_idx % uniforms.sequence_length);\n    var pos_id: i32 = 0;\n    let seqlen = ").concat(t.getByOffset("batch_idx"),";\n    let total_seqlen = seqlen + 1;\n    if (is_first_prompt) {\n      if (sequence_idx < total_seqlen) {\n        pos_id = sequence_idx;\n      } else {\n        pos_id = 1;\n      }\n      ").concat(i.setByOffset("global_idx","pos_id"),"\n    } else if (is_subsequent_prompt) {\n      let past_seqlen = total_seqlen - i32(uniforms.sequence_length);\n      if (past_seqlen + sequence_idx < total_seqlen) {\n        pos_id = past_seqlen + sequence_idx;\n      } else {\n        pos_id = 1;\n      }\n      ").concat(i.setByOffset("global_idx","pos_id"),"\n    } else if (global_idx < uniforms.batch_size) {\n      ").concat(i.setByOffset("global_idx","seqlen"),"\n    };\n  }\n  ")}}},PI=(e,t)=>{var n;let r=AI(e.inputs,t);if(5===e.inputs[0].dims.length)throw new Error("Packed QKV is not implemented");if(5===(null===(n=e.inputs[1])||void 0===n?void 0:n.dims.length))throw new Error("Packed KV is not implemented");let o,a,i=e.inputs[0],s=e.inputs[1]&&e.inputs[1].dims.length>0?e.inputs[1]:void 0,l=e.inputs[2]&&e.inputs[2].dims.length>0?e.inputs[2]:void 0,c=e.inputs[3]&&0!==e.inputs[3].dims.length?e.inputs[3]:void 0,u=e.inputs[4]&&0!==e.inputs[4].dims.length?e.inputs[4]:void 0,d=e.inputs.length>4?e.inputs[5]:void 0,p=e.inputs.length>5?e.inputs[6]:void 0,h=r.kvNumHeads?r.kvNumHeads:r.numHeads,f=_E({axis:2,numOutputs:3,splitSizes:[r.numHeads*r.headSize,h*r.headSize,h*r.headSize]}),[m,g,_]=s||l?[i,s,l]:e.compute(kI([i],f),{inputs:[i],outputs:[-1,-1,-1]});if(t.doRotary){let n=e.compute(II(r.batchSize,r.sequenceLength,d,p),{inputs:[d,p],outputs:[-1]})[0],i=e.inputs[7],s=e.inputs[8],l=_E({interleaved:0!==t.rotaryInterleaved,numHeads:r.numHeads,rotaryEmbeddingDim:0,scale:t.scale}),c=[m,n,i,s],u=[-1];o=e.compute(EI(c,l),{inputs:c,outputs:u})[0],c.splice(0,1,g);let h=_E({interleaved:0!==t.rotaryInterleaved,numHeads:r.kvNumHeads,rotaryEmbeddingDim:0,scale:t.scale});a=e.compute(EI(c,h),{inputs:c,outputs:u})[0]}let v=_I(e,r.batchSize,r.numHeads,r.sequenceLength,r.headSize,t.doRotary?o:m,void 0,0),y=FI(e,t.doRotary?a:g,r),w=FI(e,_,r);HT(e,v,y,w,void 0,void 0,c,u,void 0,r,d,p)}})),SO=pD((()=>{Iz(),Oz(),Uz(),qz(),zI=(e,t,n,r,o,a,i,s)=>{let l=kE(a),c=1===l?"f32":"vec".concat(l,"f"),u=1===l?"vec2f":"mat2x".concat(l,"f"),d=o*i,p=64;1===d&&(p=256);let h=[o,i,a/l],f=[o,i,2],m=[];m.push(...xE(h,f));return e.compute({name:"InstanceNormComputeChannelScaleShift",shaderCache:{hint:"".concat(l,";").concat(s,";").concat(p),inputDependencies:["rank","type","type"]},getRunData:()=>({outputs:[{dims:f,dataType:1}],dispatchGroup:{x:d},programUniforms:m}),getShaderSource:e=>{let o=AE("x",t.dataType,3,l),a=[o,AE("scale",n.dataType,n.dims),AE("bias",r.dataType,r.dims),ME("output",1,3,2)];return"\n  var<workgroup> workgroup_shared : array<".concat(u,", ").concat(p,">;\n  const workgroup_size = ").concat(p,"u;\n  ").concat(e.declareVariables(...a),"\n  ").concat(e.mainStart(p),"\n    let batch = workgroup_index / uniforms.x_shape[1];\n    let channel = workgroup_index % uniforms.x_shape[1];\n    let hight = uniforms.x_shape[2];\n    // initialize workgroup memory\n    var sum = ").concat(c,"(0);\n    var squared_sum = ").concat(c,"(0);\n    for (var h = local_idx; h < hight; h += workgroup_size) {\n      let value = ").concat(c,"(").concat(o.get("batch","channel","h"),");\n      sum += value;\n      squared_sum += value * value;\n    }\n    workgroup_shared[local_idx] = ").concat(u,"(sum, squared_sum);\n    workgroupBarrier();\n\n    for (var currSize = workgroup_size >> 1;  currSize > 0; currSize = currSize >> 1) {\n      if (local_idx < currSize) {\n        workgroup_shared[local_idx] = workgroup_shared[local_idx] + workgroup_shared[local_idx + currSize];\n      }\n      workgroupBarrier();\n    }\n    if (local_idx == 0) {\n      let sum_final = ").concat(SE("workgroup_shared[0][0]",l)," / f32(hight * ").concat(l,");\n      let squared_sum_final = ").concat(SE("workgroup_shared[0][1]",l)," / f32(hight * ").concat(l,");\n\n      let inv_std_dev = inverseSqrt(squared_sum_final - sum_final * sum_final + f32(").concat(s,"));\n      let channel_scale = inv_std_dev * f32(scale[channel]);\n      let channel_shift = f32(bias[channel]) - sum_final * channel_scale;\n      output[workgroup_index] = vec2f(channel_scale, channel_shift);\n    }\n  }")}},{inputs:[t,n,r],outputs:[-1]})[0]},OI=(e,t,n)=>{let r=t[0].dims,o=r,a=r[0],i=r[1],s=qS.sizeFromDimension(r,2),l=kE(s),c=qS.size(o)/l,u=zI(e,t[0],t[1],t[2],a,s,i,n.epsilon),d=[a,i,s/l],p=[a,i];e.compute({name:"InstanceNormalization",shaderCache:{hint:"".concat(l),inputDependencies:["type","none"]},getRunData:()=>({outputs:[{dims:o,dataType:t[0].dataType}],dispatchGroup:{x:Math.ceil(c/64)},programUniforms:[{type:12,data:c},...xE(d,p,d)]}),getShaderSource:e=>{let n=AE("x",t[0].dataType,d.length,l),r=AE("scale_shift",1,p.length,2),o=ME("output",t[0].dataType,d.length,l),a=[n,r,o];return"\n  ".concat(e.registerUniform("output_size","u32").declareVariables(...a),"\n  ").concat(e.mainStart(),"\n  ").concat(e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size"),"\n      let outputIndices = ").concat(o.offsetToIndices("global_idx"),";\n      let batch = outputIndices[0];\n      let channel = outputIndices[1];\n      let scale_shift = ").concat(r.getByIndices("vec2<u32>(batch, channel)"),";\n      let value = ").concat(n.getByOffset("global_idx")," * ").concat(o.type.value,"(scale_shift.x) + ").concat(o.type.value,"(scale_shift.y);\n      ").concat(o.setByOffset("global_idx","value"),";\n  }")}},{inputs:[t[0],u]})},NI=(e,t,n)=>{let r=t[0].dims,o=r,a=r[0],i=r[r.length-1],s=qS.sizeFromDimension(r,1)/i,l=kE(i),c=qS.size(o)/l,u=[{type:12,data:s},{type:12,data:Math.floor(i/l)}],d=!1,p=[0,r.length-1];for(let m=0;m<r.length-2;m++)d=d||1!==r[m+1],p.push(m+1);d=d&&1!==r[r.length-1];let h=d?e.compute(VE(e.inputs[0],p),{inputs:[e.inputs[0]],outputs:[-1]})[0]:e.inputs[0].reshape(Array.from({length:r.length},((e,t)=>r[p[t]]))),f=zI(e,h,t[1],t[2],a,s,i,n.epsilon);e.compute({name:"InstanceNormalizationNHWC",shaderCache:{hint:"".concat(l),inputDependencies:["type","type"]},getRunData:()=>({outputs:[{dims:o,dataType:t[0].dataType}],dispatchGroup:{x:Math.ceil(c/64)},programUniforms:u}),getShaderSource:e=>{let n=wE(t[0].dataType),r=1===l?"vec2f":"mat".concat(l,"x2f"),a=e=>{let t=0===e?"x":"y",r=1===l?"f32":"vec".concat(l,"f");switch(l){case 1:return"".concat(n,"(").concat(r,"(scale.").concat(t,"))");case 2:return"vec2<".concat(n,">(").concat(r,"(scale[0].").concat(t,", scale[1].").concat(t,"))");case 4:return"vec4<".concat(n,">(").concat(r,"(scale[0].").concat(t,", scale[1].").concat(t,", scale[2].").concat(t,", scale[3].").concat(t,"))");default:throw new Error("Not supported compoents ".concat(l))}},i=AE("input",t[0].dataType,t[0].dims,l),s=ME("output",t[0].dataType,o,l);return"\n  @group(0) @binding(0) var<storage, read> input : array<".concat(i.type.storage,">;\n  @group(0) @binding(1) var<storage, read> scale_input : array<").concat(r,">;\n  @group(0) @binding(2) var<storage, read_write> output : array<").concat(s.type.storage,">;\n  struct Uniforms {H: u32, C : u32};\n  @group(0) @binding(3) var<uniform> uniforms: Uniforms;\n\n  ").concat(e.mainStart(),"\n    let current_image_number = global_idx / (uniforms.C * uniforms.H);\n    let current_channel_number = global_idx % uniforms.C;\n\n    let scale_offset = current_image_number * uniforms.C + current_channel_number;\n    let scale = scale_input[scale_offset];\n    output[global_idx] = fma(input[global_idx], ").concat(a(0),", ").concat(a(1),");\n  }")}},{inputs:[t[0],f]})},BI=(e,t)=>{"NHWC"===t.format?NI(e,e.inputs,t):OI(e,e.inputs,t)}})),EO=pD((()=>{Iz(),Oz(),qz(),jI=e=>{if(!e||e.length<2)throw new Error("layerNorm requires at least 2 inputs.")},LI=(e,t,n)=>{let r=t.simplified,o=e[0].dims,a=e[1],i=!r&&e[2],s=o,l=qS.normalizeAxis(t.axis,o.length),c=qS.sizeToDimension(o,l),u=qS.sizeFromDimension(o,l),d=qS.size(a.dims),p=i?qS.size(i.dims):0;if(d!==u||i&&p!==u)throw new Error("Size of X.shape()[axis:] == ".concat(u,".\n       Size of scale and bias (if provided) must match this.\n       Got scale size of ").concat(d," and bias size of ").concat(p));let h=[];for(let w=0;w<o.length;++w)w<l?h.push(o[w]):h.push(1);let f=kE(u),m=["type","type"],g=[{type:12,data:c},{type:1,data:u},{type:12,data:Math.floor(u/f)},{type:1,data:t.epsilon}];i&&m.push("type");let _=n>1,v=n>2,y=[{dims:s,dataType:e[0].dataType}];return _&&y.push({dims:h,dataType:1}),v&&y.push({dims:h,dataType:1}),{name:"LayerNormalization",shaderCache:{hint:"".concat(f,";").concat(n,";").concat(r),inputDependencies:m},getRunData:()=>({outputs:y,dispatchGroup:{x:Math.ceil(c/64)},programUniforms:g}),getShaderSource:t=>{let n=wE(e[0].dataType),o=[AE("x",e[0].dataType,e[0].dims,f),AE("scale",a.dataType,a.dims,f)];i&&o.push(AE("bias",i.dataType,i.dims,f)),o.push(ME("output",e[0].dataType,s,f)),_&&o.push(ME("mean_data_output",1,h)),v&&o.push(ME("inv_std_output",1,h));return"\n  ".concat(t.registerUniforms([{name:"norm_count",type:"u32"},{name:"norm_size",type:"f32"},{name:"norm_size_vectorized",type:"u32"},{name:"epsilon",type:"f32"}]).declareVariables(...o),"\n  ").concat(t.mainStart(),"\n    ").concat(t.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.norm_count"),"\n    let offset = global_idx * uniforms.norm_size_vectorized;\n    var mean_vector = ").concat(CE("f32",f),";\n    var mean_square_vector = ").concat(CE("f32",f),";\n\n    for (var h: u32 = 0u; h < uniforms.norm_size_vectorized; h++) {\n      let value = ").concat(DE(n,f,"x[h + offset]"),";\n      mean_vector += value;\n      mean_square_vector += value * value;\n    }\n    let mean = ").concat(SE("mean_vector",f)," / uniforms.norm_size;\n    let inv_std_dev = inverseSqrt(").concat(SE("mean_square_vector",f)," / uniforms.norm_size ").concat(r?"":"- mean * mean"," + uniforms.epsilon);\n\n    for (var j: u32 = 0; j < uniforms.norm_size_vectorized; j++) {\n      let f32input = ").concat(DE(n,f,"x[j + offset]"),";\n      let f32scale = ").concat(DE(n,f,"scale[j]"),";\n      output[j + offset] = ").concat(o[0].type.value,"((f32input ").concat(r?"":"- mean",") * inv_std_dev * f32scale\n        ").concat(i?"+ ".concat(DE(n,f,"bias[j]")):"","\n      );\n    }\n\n    ").concat(_?"mean_data_output[global_idx] = mean":"",";\n    ").concat(v?"inv_std_output[global_idx] = inv_std_dev":"",";\n  }")}}},RI=(e,t)=>{jI(e.inputs),e.compute(LI(e.inputs,t,e.outputCount))}})),TO=pD((()=>{Oz(),rO(),oO(),VI=e=>{if(!e||2!==e.length)throw new Error("MatMul requires 2 inputs.");if(e[0].dims[e[0].dims.length-1]!==e[1].dims[e[1].dims.length-2])throw new Error("shared dimension does not match.")},qI=e=>{VI(e.inputs);let t=VS.calcShape(e.inputs[0].dims,e.inputs[1].dims,!0);if(!t)throw new Error("Can't use matmul on the given tensors");let n=t[t.length-1],r=e.inputs[0].dims[e.inputs[0].dims.length-1];if(n<8&&r<8)e.compute(kM(e.inputs,{activation:""},t));else{let o=t[t.length-2],a=qS.size(e.inputs[0].dims.slice(0,-2)),i=qS.size(e.inputs[1].dims.slice(0,-2));if(1!==a&&1===o&&1===i){let o=[1,a,n],i=[e.inputs[0].reshape([1,a,r]),e.inputs[1].reshape([1,r,n])];e.compute(FM(i,{activation:""},t,o),{inputs:i})}else e.compute(FM(e.inputs,{activation:""},t))}}})),AO=pD((()=>{Iz(),Oz(),Vz(),qz(),UI=(e,t)=>{if(e.length<3||e.length>4)throw new Error("MatMulNBits requires 3 or 4 inputs");let n=e[0],r=n.dims.length;if(n.dims[r-1]!==t.k)throw new Error("The last dim of input shape does not match the k value");let o=Math.floor((t.k+t.blockSize-1)/t.blockSize),a=t.blockSize/8*t.bits,i=e[1];if(!qS.areEqual(i.dims,[t.n,o,a]))throw new Error("The second inputs must be 3D tensor with shape N X nBlocksPerCol X blobSize");let s=e[2].dims;if(qS.size(s)!==t.n*o)throw new Error("scales input size error.");if(4===e.length){let n=e[3].dims,r=t.bits>4?t.n*o:t.n*Math.floor((o+1)/2);if(qS.size(n)!==r)throw new Error("zeroPoints input size error.")}},WI=(e,t)=>{let n=e[0].dims,r=n.length,o=n[r-2],a=t.k,i=t.n,s=n.slice(0,r-2),l=qS.size(s),c=e[1].dims[2]/4,u=e[0].dataType,d=kE(t.k),p=kE(c),h=kE(i),f=s.concat([o,i]),m=o>1&&i/h%2===0?2:1,g=qS.size(f)/h/m,_=64,v=[],y=[l,o,a/d],w=qS.convertShape(e[1].dims).slice();w.splice(-1,1,c/p),v.push(...xE(y)),v.push(...xE(w)),v.push(...xE(e[2].dims)),4===e.length&&v.push(...xE(qS.convertShape(e[3].dims)));let b=[l,o,i/h];v.push(...xE(b));return{name:"MatMulNBits",shaderCache:{hint:"".concat(t.blockSize,";").concat(t.bits,";").concat(d,";").concat(p,";").concat(h,";").concat(m,";").concat(_),inputDependencies:Array(e.length).fill("rank")},getRunData:()=>({outputs:[{dims:f,dataType:u}],dispatchGroup:{x:g},programUniforms:v}),getShaderSource:n=>{let r=y.length,o=AE("a",e[0].dataType,r,d),a=AE("b",12,w.length,p),i=AE("scales",e[2].dataType,e[2].dims.length),s=[o,a,i],l=4===e.length?AE("zero_points",12,e[3].dims.length):void 0;l&&s.push(l);let u=b.length,f=ME("output",e[0].dataType,u,h),g=wE(e[0].dataType),v=(()=>{switch(d){case 1:return"array<".concat(g,", 8>");case 2:return"mat4x2<".concat(g,">");case 4:return"mat2x4<".concat(g,">");default:throw new Error("".concat(d,"-component is not supported."))}})();return"\n        var<workgroup> workgroup_shared: array<".concat(f.type.value,", ").concat(m*_,">;\n        ").concat(n.declareVariables(...s,f),"\n        ").concat(n.mainStart([_,1,1]),"\n          let output_indices = ").concat(f.offsetToIndices("(global_idx / ".concat(_,") * ").concat(m)),";\n          let col = output_indices[2];\n          let row = output_indices[1];\n          let batch = output_indices[0];\n          let nBlocksPerCol = uniforms.b_shape[1];\n\n          for (var block = local_id.x; block < nBlocksPerCol; block += ").concat(_,") {\n            //process one block\n            var word_offset: u32 = block * ").concat(t.blockSize/d,";\n            ").concat((()=>{let e="\n            var col_index = col * ".concat(h,";\n            ").concat(l?"\n            let zero_point_bytes_per_col = (nBlocksPerCol + 1) / 2;\n            var zero_point_byte_count: u32;\n            var zero_point_word_index: u32;\n            var zero_point_byte_offset: u32;\n            let zero_point_nibble_offset: u32 = block & 0x1u;\n            var zero_point_bits_offset: u32;\n            var zero_point_word: u32;":"\n            // The default zero point is 8 for unsigned 4-bit quantization.\n            let zero_point = ".concat(g,"(8);"),"\n            ");for(let t=0;t<h*m;t++)e+="\n            let scale".concat(t," = ").concat(i.getByOffset("col_index * nBlocksPerCol + block"),";\n            ").concat(l?"\n            zero_point_byte_count = col_index * zero_point_bytes_per_col + (block >> 0x1u);\n            zero_point_word_index = zero_point_byte_count >> 0x2u;\n            zero_point_byte_offset = zero_point_byte_count & 0x3u;\n            zero_point_bits_offset = (zero_point_byte_offset << 3) + (zero_point_nibble_offset << 2);\n            zero_point_word = ".concat(l.getByOffset("zero_point_word_index")," >> zero_point_bits_offset;\n            let zero_point").concat(t," = ").concat(g,"((zero_point_word) & 0xFu);"):"","\n            col_index += 1;");return e})(),"\n            for (var word: u32 = 0; word < ").concat(c,"; word += ").concat(p,") {\n              ").concat((()=>{let e="col_index = col * ".concat(h,";");for(let t=0;t<h*m;t++)e+="\n            let b".concat(t,"_data = ").concat(a.getByIndices("".concat(a.type.indices,"(col_index, block, word)")),";\n            col_index += 1;");return e+="\n            var b_value: u32;\n            let b_mask: u32 = 0x0F0F0F0Fu;\n            var b_value_lower: vec4<u32>;\n            var b_value_upper: vec4<u32>;\n            var b_quantized_values: ".concat(v,";\n            var b_dequantized_values: ").concat(v,";"),e})(),"\n              for (var i: u32 = 0; i < ").concat(p,"; i++) {\n                ").concat((()=>{let e="\n          // reuse a data\n            var input_offset = ".concat(o.indicesToOffset("".concat(o.type.indices,"(batch, row, word_offset)")),";\n            var a_data: ").concat(v,";\n            for (var j: u32 = 0; j < ").concat(8/d,"; j++) {\n              a_data[j] = ").concat(o.getByOffset("input_offset"),";\n              input_offset++;\n            }\n          ");for(let t=0;t<h*m;t++)e+="\n            b_value = ".concat("b".concat(t,1===p?"_data":"_data[i]"),";\n            b_value_lower = unpack4xU8(b_value & b_mask);\n            b_value_upper = unpack4xU8((b_value >> 4) & b_mask);\n            b_quantized_values = ").concat(v,"(").concat(Array.from({length:4},((e,t)=>"".concat(g,"(b_value_lower[").concat(t,"]), ").concat(g,"(b_value_upper[").concat(t,"])"))).join(", "),");\n            b_dequantized_values = ").concat(1===d?"".concat(v,"(").concat(Array.from({length:8},((e,n)=>"(b_quantized_values[".concat(n,"] - ").concat(l?"zero_point".concat(t):"zero_point",") * scale").concat(t))).join(", "),");"):"(b_quantized_values - ".concat(v,"(").concat(Array(8).fill("".concat(l?"zero_point".concat(t):"zero_point")).join(","),")) * scale").concat(t,";"),";\n            workgroup_shared[local_id.x * ").concat(m," + ").concat(Math.floor(t/h),"]").concat(h>1?"[".concat(t%h,"]"):""," += ").concat(Array.from({length:8/d},((e,t)=>"".concat(1===d?"a_data[".concat(t,"] * b_dequantized_values[").concat(t,"]"):"dot(a_data[".concat(t,"], b_dequantized_values[").concat(t,"])")))).join(" + "),";\n          ");return e})(),"\n                word_offset += ").concat(8/d,";\n              }\n            }\n          }\n          workgroupBarrier();\n\n          if (local_id.x < ").concat(m,") {\n            var output_value: ").concat(f.type.value," = ").concat(f.type.value,"(0);\n            var workgroup_shared_offset: u32 = local_id.x;\n            for (var b: u32 = 0u; b < ").concat(_,"u; b++) {\n              output_value += workgroup_shared[workgroup_shared_offset];\n              workgroup_shared_offset += ").concat(m,";\n            }\n            ").concat(f.setByIndices("".concat(f.type.indices,"(batch, row, col + local_id.x)"),"output_value"),";\n          }\n        }")}}},GI=(e,t)=>{let n=e[0].dims,r=n.length,o=n[r-2],a=t.k,i=t.n,s=n.slice(0,r-2),l=qS.size(s),c=e[1].dims[2]/4,u=e[0].dataType,d=kE(t.k),p=kE(c),h=s.concat([o,i]),f=i%8===0?8:i%4===0?4:1,m=128/f,g=m*p*8,_=g/d,v=g/t.blockSize,y=qS.size(h)/f,w=[],b=[l,o,a/d],x=qS.convertShape(e[1].dims).slice();x.splice(-1,1,c/p),w.push(...xE(b)),w.push(...xE(x)),w.push(...xE(e[2].dims)),4===e.length&&w.push(...xE(qS.convertShape(e[3].dims)));let k=[l,o,i];w.push(...xE(k));return{name:"BlockwiseMatMulNBits32",shaderCache:{hint:"".concat(t.blockSize,";").concat(d,";").concat(p,";").concat(m,";").concat(f),inputDependencies:Array(e.length).fill("rank")},getRunData:()=>({outputs:[{dims:h,dataType:u}],dispatchGroup:{x:y},programUniforms:w}),getShaderSource:n=>{let r=b.length,o=AE("a",e[0].dataType,r,d),a=AE("b",12,x.length,p),i=AE("scales",e[2].dataType,e[2].dims.length),s=[o,a,i],l=4===e.length?AE("zero_points",12,e[3].dims.length):void 0;l&&s.push(l);let c=k.length,u=ME("output",e[0].dataType,c),h=wE(e[0].dataType);return"\n        var<workgroup> sub_a: array<".concat(o.type.value,", ").concat(_,">;\n        var<workgroup> inter_results: array<array<").concat(u.type.value,", ").concat(m,">, ").concat(f,">;\n        ").concat(n.declareVariables(...s,u),"\n        ").concat(n.mainStart([m,f,1]),"\n          let output_indices = ").concat(u.offsetToIndices("workgroup_index * ".concat(f)),";\n          let col = output_indices[2];\n          let row = output_indices[1];\n          let batch = output_indices[0];\n          let n_blocks_per_col = uniforms.b_shape[1];\n          let num_tiles =  (n_blocks_per_col - 1) / ").concat(v," + 1;\n\n          // Loop over shared dimension.\n          for (var tile: u32 = 0; tile < num_tiles; tile += 1) {\n            let a_col_start = tile * ").concat(_,";\n            // load one tile A data into shared memory.\n            for (var a_offset = local_idx; a_offset < ").concat(_,"; a_offset += ").concat(128,")\n            {\n              let a_col = a_col_start + a_offset;\n              if (a_col < uniforms.a_shape[2])\n              {\n                sub_a[a_offset] = ").concat(o.getByIndices("".concat(o.type.indices,"(batch, row, a_col)")),";\n              } else {\n                sub_a[a_offset] = ").concat(o.type.value,"(0);\n              }\n            }\n            workgroupBarrier();\n\n            // each thread process one block\n            let b_row = col + local_id.y;\n            let block = tile * ").concat(v," + local_id.x;\n            ").concat(l?"\n            let zero_point_bytes_per_col = (n_blocks_per_col + 1) / 2;\n            let zero_point_byte_count = b_row * zero_point_bytes_per_col + (block >> 0x1u);\n            let zero_point_word_index = zero_point_byte_count >> 0x2u;\n            let zero_point_byte_offset = zero_point_byte_count & 0x3u;\n            let zero_point_nibble_offset: u32 = block & 0x1u;\n            let zero_point_bits_offset = (zero_point_byte_offset << 3) + (zero_point_nibble_offset << 2);\n            let zero_point_word = ".concat(l.getByOffset("zero_point_word_index")," >> zero_point_bits_offset;\n            let zero_point = ").concat(h,"((zero_point_word) & 0xFu);"):"\n            // The default zero point is 8 for unsigned 4-bit quantization.\n            let zero_point = ".concat(h,"(8);"),"\n            let scale = ").concat(i.getByOffset("b_row * n_blocks_per_col + block"),";\n            let b_data = ").concat(a.getByIndices("".concat(a.type.indices,"(b_row, block, 0)")),";\n            var word_offset = local_id.x * ").concat(t.blockSize/d,";\n            for (var i: u32 = 0; i < ").concat(p,"; i++) {\n              ").concat((()=>{switch(d){case 1:return"\n          let a_data0 = vec4<".concat(h,">(sub_a[word_offset], sub_a[word_offset + 1], sub_a[word_offset + 2], sub_a[word_offset + 3]);\n          let a_data1 = vec4<").concat(h,">(sub_a[word_offset + 4], sub_a[word_offset + 5], sub_a[word_offset + 6], sub_a[word_offset + 7]);");case 2:return"\n          let a_data0 = vec4<".concat(h,">(sub_a[word_offset], sub_a[word_offset + 1]);\n          let a_data1 = vec4<").concat(h,">(sub_a[word_offset + 2], sub_a[word_offset + 3]);");case 4:return"\n          let a_data0 = sub_a[word_offset];\n          let a_data1 = sub_a[word_offset + 1];";default:throw new Error("".concat(d,"-component is not supported."))}})(),"\n              let b_value = ").concat(1===p?"b_data":"b_data[i]",";\n              let b_value_lower = unpack4xU8(b_value & 0x0F0F0F0Fu);\n              let b_value_upper = unpack4xU8((b_value >> 4) & 0x0F0F0F0Fu);\n              let b_quantized_values = mat2x4<").concat(h,">(").concat(Array.from({length:4},((e,t)=>"".concat(h,"(b_value_lower[").concat(t,"]), ").concat(h,"(b_value_upper[").concat(t,"])"))).join(", "),");\n              let b_dequantized_values = (b_quantized_values - mat2x4<").concat(h,">(").concat(Array(8).fill("zero_point").join(","),")) * scale;\n              inter_results[local_id.y][local_id.x] += ").concat(Array.from({length:2},((e,t)=>"".concat("dot(a_data".concat(t,", b_dequantized_values[").concat(t,"])")))).join(" + "),";\n              word_offset += ").concat(8/d,";\n            }\n            workgroupBarrier();\n          }\n\n          if (local_idx < ").concat(f,") {\n            var output_value: ").concat(u.type.value," = ").concat(u.type.value,"(0);\n            for (var b = 0u; b < ").concat(m,"; b++) {\n              output_value += inter_results[local_idx][b];\n            }\n            if (col + local_idx < uniforms.output_shape[2])\n            {\n              ").concat(u.setByIndices("".concat(u.type.indices,"(batch, row, col + local_idx)"),"output_value"),"\n            }\n          }\n        }")}}},HI=(e,t)=>{UI(e.inputs,t),32===t.blockSize&&e.adapterInfo.isVendor("intel")&&e.adapterInfo.isArchitecture("gen-12lp")?e.compute(GI(e.inputs,t)):e.compute(WI(e.inputs,t))},KI=e=>_E(e)})),MO=pD((()=>{Iz(),Oz(),qz(),ZI=e=>{if(!e||e.length<1)throw new Error("Too few inputs");if(1!==e[0].dataType&&10!==e[0].dataType)throw new Error("Input type must be float or float16.");if(e.length>=2){let t=2*e[0].dims.length===e[1].dims[0];if(4===e.length&&(t=2*e[3].dims[0]===e[1].dims[0]),!t)throw new Error("The pads should be a 1D tensor of shape [2 * input_rank] or [2 * num_axes].")}},$I=(e,t,n)=>{let r="";for(let o=t-1;o>=0;--o)r+="\n            k = i32(".concat(e.indicesGet("indices",o),") - ").concat(EE("uniforms.pads",o,n),";\n            if (k < 0) {\n              break;\n            }\n            if (k >= i32(").concat(EE("uniforms.x_shape",o,t),")) {\n              break;\n            }\n            offset += k * i32(").concat(EE("uniforms.x_strides",o,t),");\n        ");return"\n          value = ".concat(e.type.value,"(uniforms.constant_value);\n          for (var i = 0; i < 1; i++) {\n            var offset = 0;\n            var k = 0;\n            ").concat(r,"\n            value = x[offset];\n          }\n      ")},XI=(e,t,n)=>{let r="";for(let o=t-1;o>=0;--o)r+="\n                k = i32(".concat(e.indicesGet("indices",o),") - ").concat(EE("uniforms.pads",o,n),";\n                if (k < 0) {\n                  k = -k;\n                }\n                {\n                  let _2n_1 = 2 * (i32(").concat(EE("uniforms.x_shape",o,t),") - 1);\n                  k = k % _2n_1;\n                  if(k >= i32(").concat(EE("uniforms.x_shape",o,t),")) {\n                    k = _2n_1 - k;\n                  }\n                }\n                offset += k * i32(").concat(EE("uniforms.x_strides",o,t),");\n            ");return"\n              var offset = 0;\n              var k = 0;\n              ".concat(r,"\n              value = x[offset];\n          ")},JI=(e,t,n)=>{let r="";for(let o=t-1;o>=0;--o)r+="\n                k = i32(".concat(e.indicesGet("indices",o),") - ").concat(EE("uniforms.pads",o,n),";\n                if (k < 0) {\n                  k = 0;\n                }\n                if (k >= i32(").concat(EE("uniforms.x_shape",o,t),")) {\n                  k = i32(").concat(EE("uniforms.x_shape",o,t),") - 1;\n                }\n                offset += k * i32(").concat(EE("uniforms.x_strides",o,t),");\n            ");return"\n              var offset = 0;\n              var k = 0;\n              ".concat(r,"\n              value = x[offset];\n          ")},QI=(e,t,n)=>{let r="";for(let o=t-1;o>=0;--o)r+="\n                k = i32(".concat(e.indicesGet("indices",o),") - ").concat(EE("uniforms.pads",o,n),";\n                if (k < 0)  {\n                  k += i32(").concat(EE("uniforms.x_shape",o,t),"]);\n                }\n                if (k >= i32(").concat(EE("uniforms.x_shape",o,t),")) {\n                  k -= i32(").concat(EE("uniforms.x_shape",o,t),");\n                }\n                offset += k * i32(").concat(EE("uniforms.x_strides",o,t),");\n            ");return"\n              var offset = 0;\n              var k = 0;\n              ".concat(r,"\n              value = x[offset];\n          ")},YI=(e,t,n)=>{switch(n.mode){case 0:return $I(e,t,n.pads.length);case 1:return XI(e,t,n.pads.length);case 2:return JI(e,t,n.pads.length);case 3:return QI(e,t,n.pads.length);default:throw new Error("Invalid mode")}},eP=(e,t)=>{let n=qS.padShape(e[0].dims.slice(),t.pads),r=e[0].dims,o=[{type:12,data:qS.size(n)},{type:6,data:t.pads}],a=e.length>=3&&e[2].data;0===t.mode&&o.push({type:a?e[2].dataType:1,data:t.value}),o.push(...xE(e[0].dims,n));return{name:"Pad",shaderCache:{hint:"".concat(t.mode).concat(a),inputDependencies:["rank"]},getRunData:()=>({outputs:[{dims:n,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(qS.size(n)/64)},programUniforms:o}),getShaderSource:o=>{let i=ME("output",e[0].dataType,n.length),s=AE("x",e[0].dataType,r.length),l=s.type.value,c=YI(i,r.length,t),u=[{name:"output_size",type:"u32"},{name:"pads",type:"i32",length:t.pads.length}];return 0===t.mode&&u.push({name:"constant_value",type:a?l:"f32"}),"\n            ".concat(o.registerUniforms(u).declareVariables(s,i),"\n            ").concat(o.mainStart(),"\n            ").concat(o.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size"),"\n\n            let indices = ").concat(i.offsetToIndices("global_idx"),";\n\n            var value = ").concat(l,"(0);\n            ").concat(c,"\n            output[global_idx] = value;\n        }")}}},tP=(e,t)=>{if(e.length>1){let n=e[1].getBigInt64Array(),r=e.length>=3&&e[2].data?10===e[2].dataType?e[2].getUint16Array()[0]:e[2].getFloat32Array()[0]:0,o=e[0].dims.length,a=new Int32Array(2*o).fill(0);if(e.length>=4){let t=e[3].getBigInt64Array();for(let e=0;e<t.length;e++)a[Number(t[e])]=Number(n[e]),a[Number(t[e])+o]=Number(n[e+t.length])}else n.forEach(((e,t)=>a[Number(t)]=Number(e)));let i=[];return a.forEach((e=>i.push(e))),{mode:t.mode,value:r,pads:i}}return t},nP=(e,t)=>{ZI(e.inputs);let n=tP(e.inputs,t);e.compute(eP(e.inputs,n),{inputs:[0]})}})),FO=pD((()=>{zD(),Iz(),Oz(),qz(),rP=e=>{if(jC.webgpu.validateInputContent&&(!e||1!==e.length))throw new Error("Pool ops requires 1 input.")},oP=(e,t,n)=>{let r="NHWC"===t.format,o=e.dims.slice();r&&o.splice(1,0,o.pop());let a=Object.hasOwnProperty.call(t,"dilations"),i=t.kernelShape.slice(),s=t.strides.slice(),l=a?t.dilations.slice():[],c=t.pads.slice();US.adjustPoolAttributes(n,o,i,s,l,c);let u=US.computePoolOutputShape(n,o,s,l,i,c,t.autoPad),d=Object.assign({},t);a?Object.assign(d,{kernelShape:i,strides:s,pads:c,dilations:l,cacheKey:t.cacheKey}):Object.assign(d,{kernelShape:i,strides:s,pads:c,cacheKey:t.cacheKey});let p=u.slice();return p.push(p.splice(1,1)[0]),[d,r?p:u]},aP=(e,t)=>{let n="NHWC"===t.format,r=[{type:12,data:qS.size(e)},{type:12,data:qS.size(t.kernelShape)}],o=[{name:"outputSize",type:"u32"},{name:"kernelSize",type:"u32"}];if(t.kernelShape.length<=2){let e=t.kernelShape[t.kernelShape.length-1],n=t.strides[t.strides.length-1],a=t.pads[t.pads.length/2-1],i=t.pads[t.pads.length-1],s=!!(a+i);r.push({type:12,data:e},{type:12,data:n},{type:12,data:a},{type:12,data:i}),o.push({name:"kw",type:"u32"},{name:"sw",type:"u32"},{name:"pwStart",type:"u32"},{name:"pwEnd",type:"u32"});let l=!1;if(2===t.kernelShape.length){let e=t.kernelShape[t.kernelShape.length-2],n=t.strides[t.strides.length-2],a=t.pads[t.pads.length/2-2],i=t.pads[t.pads.length-2];l=!!(a+i),r.push({type:12,data:e},{type:12,data:n},{type:12,data:a},{type:12,data:i}),o.push({name:"kh",type:"u32"},{name:"sh",type:"u32"},{name:"phStart",type:"u32"},{name:"phEnd",type:"u32"})}return[r,o,!0,s,l]}{if(n)throw new Error("Pooling with kernelShape.length > 2 is not supported for NHWC format.");let e=qS.computeStrides(t.kernelShape);r.push({type:12,data:e},{type:12,data:t.pads},{type:12,data:t.strides}),o.push({name:"kernelStrides",type:"u32",length:e.length},{name:"pads",type:"u32",length:t.pads.length},{name:"strides",type:"u32",length:t.strides.length});let a=t.pads.reduce(((e,t)=>e+t));return[r,o,!!a,!1,!1]}},iP=(e,t,n,r,o,a,i,s,l,c,u,d)=>{let p="NHWC"===o.format,h=t.type.value,f=ME("output",t.type.tensor,r);if(o.kernelShape.length<=2){let r="",c="",m="",g=n-(p?2:1);if(r=u?"\n                for (var i: u32 = 0u; i < uniforms.kw; i++) {\n                  xIndices[".concat(g,"] = indices[").concat(g,"] * uniforms.sw - uniforms.pwStart + i;\n                  if (xIndices[").concat(g,"] < 0 || xIndices[").concat(g,"]\n                      >= uniforms.x_shape[").concat(g,"]) {\n                    pad++;\n                    continue;\n                  }\n                  let x_val = x[").concat(t.indicesToOffset("xIndices"),"];\n                  ").concat(a,"\n                }"):"\n                for (var i: u32 = 0u; i < uniforms.kw; i++) {\n                  xIndices[".concat(g,"] = indices[").concat(g,"] * uniforms.sw - uniforms.pwStart + i;\n                  let x_val = x[").concat(t.indicesToOffset("xIndices"),"];\n                  ").concat(a,"\n                }"),2===o.kernelShape.length){let e=n-(p?3:2);c=d?"\n                for (var j: u32 = 0u; j < uniforms.kh; j++) {\n                  xIndices[".concat(e,"] = indices[").concat(e,"] * uniforms.sh - uniforms.phStart + j;\n                  if (xIndices[").concat(e,"] < 0 || xIndices[").concat(e,"] >= uniforms.x_shape[").concat(e,"]) {\n                    pad += i32(uniforms.kw);\n                    continue;\n                  }\n              "):"\n                for (var j: u32 = 0u; j < uniforms.kh; j++) {\n                  xIndices[".concat(e,"] = indices[").concat(e,"] * uniforms.sh - uniforms.phStart + j;\n                "),m="\n              }\n            "}return"\n            ".concat(e.registerUniforms(l).declareVariables(t,f),"\n\n            ").concat(e.mainStart(),"\n              ").concat(e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize"),"\n\n              let indices = ").concat(f.offsetToIndices("global_idx"),";\n              var xIndices = ").concat(f.offsetToIndices("global_idx"),";\n\n              var value = ").concat(h,"(").concat(s,");\n              var pad = 0;\n              ").concat(c,"\n              ").concat(r,"\n              ").concat(m,"\n              ").concat(i,"\n\n              output[global_idx] = value;\n            }")}{if(p)throw new Error("Pooling with kernelShape.length > 2 is not supported for NHWC format.");let r=o.kernelShape.length,u=o.pads.length,d="";return d=c?"\n                if (xIndices[j] >= uniforms.x_shape[j]) {\n                  pad++;\n                  isPad = true;\n                  break;\n                }\n              }\n              if (!isPad) {\n                let x_val = x[".concat(t.indicesToOffset("xIndices"),"];\n                ").concat(a,"\n              }"):"\n              }\n              let x_val = x[".concat(t.indicesToOffset("xIndices"),"];\n              ").concat(a,"\n            "),"\n            ".concat(e.registerUniforms(l).declareVariables(t,f),"\n\n            ").concat(e.mainStart(),"\n              ").concat(e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize"),"\n              let indices = ").concat(f.offsetToIndices("global_idx"),";\n              var xIndices = ").concat(f.offsetToIndices("global_idx"),";\n\n              var offsets: array<u32, ").concat(r,">;\n\n              var value = ").concat(h,"(").concat(s,");\n              var pad = 0;\n              var isPad = false;\n\n              for (var i: u32 = 0u; i < uniforms.kernelSize; i++) {\n                var offset = i;\n                for (var j = 0u; j < ").concat(r-1,"u; j++) {\n                  offsets[j] = offset / ").concat(EE("uniforms.kernelStrides","j",r),";\n                  offset -= offsets[j] * ").concat(EE("uniforms.kernelStrides","j",r),";\n                }\n                offsets[").concat(r-1,"] = offset;\n\n                isPad = false;\n                for (var j = ").concat(n-r,"u; j < ").concat(n,"u; j++) {\n                  xIndices[j] = indices[j] * ").concat(EE("uniforms.strides","j - ".concat(n-r,"u"),r),"\n                    + offsets[j - ").concat(n-r,"u] - ").concat(EE("uniforms.pads","j - 2u",u),";\n                  ").concat(d,"\n              }\n              ").concat(i,"\n\n              output[global_idx] = value;\n            }")}},sP=e=>"".concat(e.format,";").concat(e.ceilMode,";").concat(e.autoPad,";").concat(e.kernelShape.length),lP=e=>"".concat(sP(e),";").concat(e.countIncludePad),cP=e=>"".concat(sP(e),";").concat(e.storageOrder,";").concat(e.dilations),uP=e=>({format:e.format,autoPad:["NOTSET","VALID","SAME_UPPER","SAME_LOWER"][e.auto_pad],ceilMode:e.ceil_mode,kernelShape:e.kernel_shape,strides:e.strides,pads:e.pads}),dP=(e,t,n,r)=>{let[o,a]=oP(t,r,n),i=AE("x",t.dataType,t.dims.length),s=i.type.value,l="";o.countIncludePad?l+="value /= ".concat(s,"(uniforms.kernelSize);"):l+="value /= ".concat(s,"(i32(uniforms.kernelSize) - pad);");let[c,u,d,p,h]=aP(a,o);c.push(...xE(t.dims,a));return{name:e,shaderCache:{hint:"".concat(r.cacheKey,";").concat(d,";").concat(p,";").concat(h),inputDependencies:["rank"]},getRunData:()=>({outputs:[{dims:a,dataType:t.dataType}],dispatchGroup:{x:Math.ceil(qS.size(a)/64)},programUniforms:c}),getShaderSource:e=>iP(e,i,t.dims.length,a.length,o,"value += x_val;",l,0,u,d,p,h)}},pP=e=>{let t=0!==e.count_include_pad,n=uP(e);if(0!==n.ceilMode)throw new Error("using ceil() in shape computation is not yet supported for AveragePool");let r=so(so({countIncludePad:t},n),{},{cacheKey:""});return so(so({},r),{},{cacheKey:lP(r)})},hP=(e,t)=>{rP(e.inputs),e.compute(dP("AveragePool",e.inputs[0],!1,t))},fP={autoPad:"",ceilMode:0,countIncludePad:!1,kernelShape:[],strides:[],pads:[],storageOrder:0,dilations:[]},mP=e=>{let t=e.format;return so(so({format:t},fP),{},{cacheKey:t})},gP=(e,t)=>{rP(e.inputs),e.compute(dP("GlobalAveragePool",e.inputs[0],!0,t))},_P=(e,t,n,r)=>{let[o,a]=oP(t,r,n),i=AE("x",t.dataType,t.dims.length),[s,l,c,u,d]=aP(a,o);return s.push(...xE(t.dims,a)),{name:e,shaderCache:{hint:"".concat(r.cacheKey,";").concat(c,";").concat(u,";").concat(d),inputDependencies:["rank"]},getRunData:()=>({outputs:[{dims:a,dataType:t.dataType}],dispatchGroup:{x:Math.ceil(qS.size(a)/64)},programUniforms:s}),getShaderSource:e=>iP(e,i,t.dims.length,a.length,o,"\n      value = max(x_val, value);\n    ","",10===t.dataType?-65504:-1e5,l,c,u,d)}},vP=(e,t)=>{rP(e.inputs),e.compute(_P("MaxPool",e.inputs[0],!1,t))},yP=e=>{let t=e.storage_order,n=e.dilations,r=uP(e);if(0!==t)throw new Error("column major storage order is not yet supported for MaxPool");if(0!==r.ceilMode)throw new Error("using ceil() in shape computation is not yet supported for MaxPool");let o=so(so({storageOrder:t,dilations:n},r),{},{cacheKey:""});return so(so({},o),{},{cacheKey:cP(o)})},wP=e=>{let t=e.format;return so(so({format:t},fP),{},{cacheKey:t})},bP=(e,t)=>{rP(e.inputs),e.compute(_P("GlobalMaxPool",e.inputs[0],!0,t))}})),IO=pD((()=>{Iz(),Oz(),Vz(),qz(),xP=(e,t)=>{if(e.length<2||e.length>3)throw new Error("DequantizeLinear requires 2 or 3 inputs.");if(3===e.length&&e[1].dims===e[2].dims)throw new Error("x-scale and x-zero-point must have the same shape.");if(3===e.length&&e[0].dataType!==e[2].dataType)throw new Error("x and x-zero-point must have the same data type.");if(6===e[0].dataType&&e.length>2)throw new Error("In the case of dequantizing int32 there is no zero point.");if(0!==e[1].dims.length&&1!==e[1].dims.length&&e[1].dims.length!==e[0].dims.length)throw new Error("scale input must be a scalar, a 1D tensor, or have the same rank as the input tensor.");if(e.length>2){if(e[0].dataType!==e[2].dataType)throw new Error("x and x-zero-point must have the same data type.");if(e[1].dims.length!==e[2].dims.length)throw new Error("scale and zero-point inputs must have the same rank.");if(!e[1].dims.map(((t,n)=>t===e[2].dims[n])).reduce(((e,t)=>e&&t),!0))throw new Error("scale and zero-point inputs must have the same shape.")}if(t.blockSize>0){if(0===e[1].dims.length||1===e[1].dims.length&&1===e[1].dims[0])throw new Error("blockSize must be set only for block quantization.");if(!e[1].dims.map(((n,r)=>r===t.axis||n===e[0].dims[r])).reduce(((e,t)=>e&&t),!0))throw new Error("For block qunatization, scale input shape to match the input shape except for the axis");if(e[1].dims.length!==e[0].dims.length)throw new Error("For block qunatization the scale input rank must be the same as the x rank.");let n=e[0].dims[t.axis],r=e[1].dims[t.axis];if(t.blockSize<Math.ceil(n/r)||t.blockSize>Math.ceil(n/(r-1)-1))throw new Error("blockSize must be with in the range [ceil(dI / Si), ceil(dI / (Si - 1) - 1)].")}},kP=(e,t)=>{let n=qS.normalizeAxis(t.axis,e[0].dims.length),r=e[0].dataType,o=3===r,a=e[0].dims,i=e[1].dataType,s=qS.size(a),l=3===r||2===r,c=l?[Math.ceil(qS.size(e[0].dims)/4)]:e[0].dims,u=e[1].dims,d=e.length>2?e[2]:void 0,p=d?l?[Math.ceil(qS.size(d.dims)/4)]:d.dims:void 0,h=0===u.length||1===u.length&&1===u[0],f=!1===h&&1===u.length,m=kE(s),g=h&&(!l||4===m),_=g?m:1,v=g&&!l?m:1,y=AE("input",l?12:r,c.length,v),w=AE("scale",i,u.length),b=d?AE("zero_point",l?12:r,p.length):void 0,x=ME("output",i,a.length,_),k=[y,w];b&&k.push(b);let C=[c,u];d&&C.push(p);let D=[{type:12,data:s/_},{type:12,data:n},{type:12,data:t.blockSize},...xE(...C,a)];return{name:"DequantizeLinear",shaderCache:{hint:t.cacheKey,inputDependencies:b?["rank","rank","rank"]:["rank","rank"]},getShaderSource:e=>"\n      ".concat(e.registerUniforms([{name:"output_size",type:"u32"},{name:"axis",type:"u32"},{name:"block_size",type:"u32"}]).declareVariables(...k,x),"\n      ").concat(e.mainStart(),"\n          ").concat(e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size"),"\n          let output_indices = ").concat(x.offsetToIndices("global_idx"),";\n\n          // Set input x\n          ").concat(l?"\n            let input = ".concat(y.getByOffset("global_idx / 4"),";\n            let x_vec = ").concat(o?"unpack4xI8(input)":"unpack4xU8(input)",";\n            let x_value = ").concat(1===_?"x_vec[global_idx % 4]":"x_vec",";"):"let x_value = ".concat(y.getByOffset("global_idx"),";"),";\n\n          // Set scale input\n          ").concat(h?"let scale_value= ".concat(w.getByOffset("0")):f?"\n            let scale_index = ".concat(x.indicesGet("output_indices","uniforms.axis"),";\n            let scale_value= ").concat(w.getByOffset("scale_index"),";"):"\n            var scale_indices: ".concat(w.type.indices," = output_indices;\n            let index = ").concat(w.indicesGet("scale_indices","uniforms.axis")," / uniforms.block_size;\n            ").concat(w.indicesSet("scale_indices","uniforms.axis","index"),";\n            let scale_value= ").concat(w.getByIndices("scale_indices"),";"),";\n\n          // Set zero-point input\n          ").concat(b?h?l?"\n                let zero_point_input = ".concat(b.getByOffset("0"),";\n                let zero_point_vec =  ").concat(o?"unpack4xI8(zero_point_input)":"unpack4xU8(zero_point_input)",";\n                let zero_point_value= zero_point_vec[0]"):"let zero_point_value = ".concat(b.getByOffset("0")):f?l?"\n                let zero_point_index = ".concat(x.indicesGet("output_indices","uniforms.axis"),";\n                let zero_point_input = ").concat(b.getByOffset("zero_point_index / 4"),";\n                let zero_point_vec =  ").concat(o?"unpack4xI8(zero_point_input)":"unpack4xU8(zero_point_input)",";\n                let zero_point_value = zero_point_vec[zero_point_index % 4]"):"\n                let zero_point_index = ".concat(x.indicesGet("output_indices","uniforms.axis"),";\n                let zero_point_value = ").concat(b.getByOffset("zero_point_index"),";"):l?"\n                let zero_point_offset = ".concat(w.indicesToOffset("scale_indices"),";\n                let zero_point_input = ").concat(b.getByOffset("zero_point_offset / 4"),";\n                let zero_point_vec = ").concat(o?"unpack4xI8(zero_point_input)":"unpack4xU8(zero_point_input)",";\n                let zero_point_value = zero_point_vec[zero_point_offset % 4];"):"let zero_point_value = ".concat(b.getByIndices("scale_indices"),";"):"let zero_point_value = ".concat(l?o?"i32":"u32":y.type.value,"(0);"),";\n      // Compute and write output\n      ").concat(x.setByOffset("global_idx","".concat(x.type.value,"(x_value - zero_point_value) * scale_value")),";\n      }"),getRunData:()=>({outputs:[{dims:a,dataType:i}],dispatchGroup:{x:Math.ceil(s/_/64),y:1,z:1},programUniforms:D})}},CP=(e,t)=>{xP(e.inputs,t),e.compute(kP(e.inputs,t))},DP=e=>_E({axis:e.axis,blockSize:e.blockSize})})),PO=pD((()=>{zD(),Iz(),qz(),SP=(e,t,n)=>{if(e===t||e<t&&n<0||e>t&&n>0)throw new Error("Range these inputs' contents are invalid.")},EP=(e,t,n,r)=>{let o=Math.abs(Math.ceil((t-e)/n)),a=[o],i=o,s=[{type:12,data:i},{type:r,data:e},{type:r,data:n},...xE(a)];return{name:"Range",shaderCache:{hint:"".concat(r)},getShaderSource:e=>{let t=ME("output",r,a.length),n=t.type.value,o=[{name:"outputSize",type:"u32"},{name:"start",type:n},{name:"delta",type:n}];return"\n        ".concat(e.registerUniforms(o).declareVariables(t),"\n        ").concat(e.mainStart(),"\n        ").concat(e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize"),"\n        output[global_idx] = uniforms.start + ").concat(n,"(global_idx) * uniforms.delta;\n      }")},getRunData:()=>({outputs:[{dims:a,dataType:r}],dispatchGroup:{x:Math.ceil(i/64)},programUniforms:s})}},TP=e=>{let t=0,n=0,r=0;6===e.inputs[0].dataType?(t=e.inputs[0].getInt32Array()[0],n=e.inputs[1].getInt32Array()[0],r=e.inputs[2].getInt32Array()[0]):1===e.inputs[0].dataType&&(t=e.inputs[0].getFloat32Array()[0],n=e.inputs[1].getFloat32Array()[0],r=e.inputs[2].getFloat32Array()[0]),jC.webgpu.validateInputContent&&SP(t,n,r),e.compute(EP(t,n,r,e.inputs[0].dataType),{inputs:[]})}})),zO=pD((()=>{Iz(),Oz(),Vz(),qz(),AP=(e,t,n,r)=>{if("none"!==e&&"i32"!==r&&"u32"!==r&&"f32"!==r)throw new Error("Input ".concat(r," is not supported with reduction ").concat(e,"."));let o="{\n                var oldValue = 0;\n                loop {\n                  let newValueF32 =",a=";\n                  let newValue = bitcast<i32>(newValueF32);\n                  let res = atomicCompareExchangeWeak(&".concat(t,", oldValue, newValue);\n                  if res.exchanged {\n                    break;\n                  }\n                  oldValue = res.old_value;\n                }\n              }");switch(e){case"none":return"".concat(t,"=").concat(n,";");case"add":return"i32"===r||"u32"===r?"atomicAdd(&".concat(t,", bitcast<").concat(r,">(").concat(n,"));"):"\n              ".concat(o,"bitcast<").concat(r,">(oldValue) + (").concat(n,")").concat(a);case"max":return"i32"===r||"u32"===r?"atomicMax(&".concat(t,", bitcast<").concat(r,">(").concat(n,"));"):"\n                ".concat(o,"max(bitcast<f32>(oldValue), (").concat(n,"))").concat(a);case"min":return"i32"===r||"u32"===r?"atomicMin(&".concat(t,", bitcast<").concat(r,">(").concat(n,"));"):"".concat(o,"min(bitcast<").concat(r,">(oldValue), (").concat(n,"))").concat(a);case"mul":return"".concat(o,"(bitcast<").concat(r,">(oldValue) * (").concat(n,"))").concat(a);default:throw new Error("Reduction ".concat(e," is not supported."))}},MP=(e,t)=>"".concat(1===e?"\n    let element_count_dim = uniforms.output_strides;\n    let dim_value = uniforms.output_shape;":"\n    let element_count_dim = uniforms.output_strides[".concat(t?"i - indices_start":"i","];\n    let dim_value = uniforms.output_shape[").concat(t?"i - indices_start":"i"," + uniforms.last_index_dimension];"),"\n    \n    if (index >= 0) {\n      if (index >= i32(dim_value)) {\n        index = i32(dim_value - 1);\n      }\n    } else {\n      if (index < -i32(dim_value)) {\n        index = 0;\n      } else {\n        index += i32(dim_value);\n      }\n    }\n    data_offset += u32((u32(index) * element_count_dim));"),FP=(e,t,n)=>"for (var i = 0u; i < uniforms.num_updates_elements; i++) {\n        let value = updates[uniforms.num_updates_elements * ".concat(n?"global_idx":"idx"," + i];\n        ").concat(AP(e.reduction,"output[data_offset + i]","value",t),"\n      }"),IP=(e,t)=>{let n=e[0].dims,r=e[1].dims,o=n,a=Math.ceil(qS.size(r)/1),i=r[r.length-1],s=qS.sizeFromDimension(n,i),l=qS.sizeFromDimension(r,0)/i,c=[{type:12,data:a},{type:12,data:i},{type:12,data:s},...xE(e[1].dims,e[2].dims,o)];return{name:"ScatterND",shaderCache:{hint:"".concat(t.cacheKey,"_").concat(t.reduction),inputDependencies:["rank","rank"]},getRunData:()=>({outputs:[{dims:o,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(a/64)},programUniforms:c}),getShaderSource:r=>{let a=AE("indices",e[1].dataType,e[1].dims.length),i=AE("updates",e[2].dataType,e[2].dims.length,1),s="none"!==t.reduction&&""!==t.reduction?FE("output",e[0].dataType,o.length):ME("output",e[0].dataType,o.length,1);return"\n      ".concat(r.registerUniform("output_size","u32").registerUniform("last_index_dimension","u32").registerUniform("num_updates_elements","u32").declareVariables(a,i,s),"\n      ").concat(r.mainStart(),"\n        ").concat(r.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size"),"\n  var hasDuplicates = false;\n  if (").concat("none"===t.reduction,") {\n    for (var i = 0; i < ").concat(l,"; i = i + 1) {\n      for (var j = i + 1; j < ").concat(l,"; j = j + 1) {\n        var index_i = i32(indices[i].x);\n        var index_j = i32(indices[j].x);\n        if (index_i == index_j) {\n          hasDuplicates = true;\n          break;\n        }\n      }\n      if (hasDuplicates) {\n        break;\n      }\n    }\n  }\n\n  if (").concat("none"===t.reduction," && hasDuplicates) {\n    if (global_idx != 0u) {\n      return;\n    }\n    // Process each index-update pair individually when duplicates exist\n    for (var idx = 0u; idx < ").concat(l,"u; idx++) {\n      var data_offset = 0u;\n      for (var i = 0u; i < uniforms.last_index_dimension; i++) {\n        var index = i32(indices[idx * uniforms.last_index_dimension + i].x);\n        ").concat(MP(n.length,!1),"\n      }\n      ").concat(FP(t,s.type.value,!1),"\n    }\n    return;\n  }\n\n  var data_offset = 0u;\n  var indices_start = uniforms.last_index_dimension * global_idx;\n  var indices_end = indices_start + uniforms.last_index_dimension;\n  for (var i = indices_start; i < indices_end; i++) {\n    var index = i32(indices[i].x);\n    ").concat(MP(n.length,!0),"\n  }\n  ").concat(FP(t,s.type.value,!0),"\n  }")}}},PP=e=>_E({reduction:e.reduction}),zP=(e,t)=>{e.compute(IP(e.inputs,t),{inputs:[e.inputs[1],e.inputs[2]],outputs:[]})}})),OO=pD((()=>{Iz(),Oz(),Vz(),qz(),OP=(e,t)=>{if(e.every((e=>e>0||(()=>{throw new Error("Resize requires scales input values to be positive")}))),e.length>0)if("linear"===t.mode){if(!(2===e.length||3===e.length||4===e.length&&1===e[0]&&1===e[1]||4===e.length&&1===e[0]&&1===e[3]||5===e.length&&1===e[0]&&1===e[1]))throw new Error("For linear mode, Resize requires scales to be 2D, 3D, 4D with either two outermost or one innermost and\n            one outermost scale values equal to 1, or 5D with two outermost scale values equal to 1")}else if("cubic"===t.mode&&!(2===e.length||4===e.length&&1===e[0]&&1===e[1]||4===e.length&&1===e[0]&&1===e[3]))throw new Error("Resize requires scales input size to be 2 or 4 for cubic mode")},NP=(e,t,n)=>{t.every((e=>e>=0&&e<n||(()=>{throw new Error("Resize requires axes input values to be positive and less than rank")})));let r=new Array(n).fill(1);return t.forEach(((t,n)=>r[t]=e[n])),r},BP=(e,t,n,r,o,a)=>{let[i,s,l]=n>10?[1,2,3]:[-1,e.length>1?1:-1,-1],c=e[0].dims.length;if(i>0&&e.length>i&&e[i].dims.length>0)e[i].getFloat32Array().forEach((e=>a.push(e)));else if("tf_crop_and_resize"===t.coordinateTransformMode)throw new Error("Resize requires RoI input to be specified when coordinateTransformMode is tfCropAndResize");if(s>0&&e.length>s&&1===e[s].dims.length&&e[s].dims[0]>0){if(e[s].getFloat32Array().forEach((e=>r.push(e))),0!==r.length&&r.length!==c&&n>=18&&r.length!==t.axes.length)throw new Error("Resize requires scales input size to be same as input rank or axes size for opset 18 and up");OP(r,t),t.axes.length>0&&NP(r,t.axes,c).forEach(((e,t)=>r[t]=e))}if(l>0&&e.length>l&&1===e[l].dims.length&&e[l].dims[0]>0&&(e[l].getBigInt64Array().forEach((e=>o.push(Number(e)))),0!==o.length&&o.length!==c&&n>=18&&o.length!==t.axes.length))throw new Error("Resize requires sizes input size to be same as input rank or axes size for opset 18 and up");if(t.axes.length>0){if(0!==r.length&&r.length!==t.axes.length)throw new Error('Resize requires "scales" input size to be of axes rank when axes attributes is specified');if(0!==o.length&&o.length!==t.axes.length)throw new Error('Resize requires "sizes" input size to be of rank axes rank when axes attributes is specified')}if(typeof r<"u"&&typeof o<"u"&&r.length>0&&o.length>c)throw new Error("Resize requires only of scales or sizes to be specified")},jP=(e,t,n,r)=>"\n  // The whole part and the fractional part are calculated separately due to inaccuracy of floating\n  // point division. As an example, f32(21) / f32(7) may evaluate to 2.99... instead of 3, causing an\n  // offset-by-one error later in floor().\n  let big = (".concat(e,") * (").concat(t,");\n  let whole = ").concat(r,"(big / (").concat(n,"));\n  let fract = ").concat(r,"(big % (").concat(n,")) / ").concat(r,"(").concat(n,");\n  return whole + fract;\n"),LP=(e,t)=>"fn getOriginalCoordinateFromResizedCoordinate(xResized: u32, xScale: f32, lengthResized: u32,\n     lengthOriginal: u32, roiStart: f32, roiEnd: f32) -> ".concat(t," { ")+(()=>{switch(e){case"asymmetric":return"\n          if (xScale < 1.0 || floor(xScale) != xScale) {\n            return ".concat(t,"(xResized) / ").concat(t,"(xScale);\n          } else {\n            ").concat(jP("xResized","lengthOriginal","lengthResized",t),"\n          }\n        ");case"pytorch_half_pixel":return"if (lengthResized > 1) {\n                    return (".concat(t,"(xResized) + 0.5) / ").concat(t,"(xScale) - 0.5;\n                  } else {\n                    return 0.0;\n                  }");case"tf_half_pixel_for_nn":return"return (".concat(t,"(xResized) + 0.5) / ").concat(t,"(xScale);");case"align_corners":return"if (lengthResized == 1) {\n                    return 0.0;\n                  } else {\n                    ".concat(jP("xResized","lengthOriginal - 1","lengthResized - 1",t),"\n                  }");case"tf_crop_and_resize":return"if (lengthResized > 1) {\n                    return ".concat(t,"(roiStart) * ").concat(t,"(lengthOriginal - 1) +\n                        (").concat(t,"(xResized) * ").concat(t,"(roiEnd - roiStart) * ").concat(t,"(lengthOriginal - 1)) /\n                        ").concat(t,"(lengthResized - 1);\n                  } else {\n                    return 0.5 * ").concat(t,"(roiStart + roiEnd) * ").concat(t,"(lengthOriginal - 1);\n                  }");case"half_pixel_symmetric":return"const outputWidth = ".concat(t,"xScale * ").concat(t,"(lengthResized);\n                  const adjustment = ").concat(t,"(lengthResized) / outputWidth;\n                  const center = ").concat(t,"(lengthOriginal) / 2;\n                  const offset = center * (1 - adjustment);\n                  return offset + ((").concat(t,"(xResized) + 0.5) / ").concat(t,"(xScale)) - 0.5;");case"half_pixel":return"return ((".concat(t,"(xResized) + 0.5) / ").concat(t,"(xScale)) - 0.5;");default:throw new Error("Coordinate transform mode ".concat(e," is not supported"))}})()+"}",RP=(e,t,n)=>"fn getNearestPixelFromOriginal(xOriginal: ".concat(n,", isDownSample: bool) -> ").concat(n," {")+(()=>{switch(e){case"round_prefer_ceil":return"if (fract(xOriginal) == 0.5) {             return ceil(xOriginal);           } else {             return round(xOriginal);           }";case"floor":return"return floor(xOriginal);";case"ceil":return"return ceil(xOriginal);";case"round_prefer_floor":return"if (fract(xOriginal) == 0.5) {                     return floor(xOriginal);                   } else {                     return round(xOriginal);                   }";default:if(t<11)return"if (isDownSample)                     {                       return ceil(xOriginal);                     } else {                       return xOriginal;                     }";throw new Error("Nearest mode ".concat(e," is not supported"))}})()+"}",VP=(e,t,n)=>{let r=new Array(n).fill(0).concat(new Array(n).fill(1)),o=0===e.length?r:e.slice();return t.length>0?(t.forEach(((e,a)=>{r[e]=o[a],r[a+n]=o[t.length+a]})),r):o},qP=(e,t,n,r)=>{let o=[];if(n.length>0)if(r.length>0){if(e.forEach((e=>o.push(e))),Math.max(...r)>e.length)throw new Error("axes is out of bound");r.forEach(((e,t)=>o[e]=n[t]))}else n.forEach((e=>o.push(e)));else{if(0===t.length)throw new Error("Resize requires either scales or sizes.");o=e.map(((e,n)=>Math.round(e*t[n])))}return o},UP=(e,t,n)=>{let r=(()=>{switch(n.keepAspectRatioPolicy){case"not_larger":return n.axes.length>0?Math.min(...n.axes.map((e=>t[e])),Number.MAX_VALUE):Math.min(...t,Number.MAX_VALUE);case"not_smaller":return n.axes.length>0?Math.max(...n.axes.map((e=>t[e])),Number.MIN_VALUE):Math.max(...t,Number.MIN_VALUE);default:throw new Error("Keep aspect ratio policy ".concat(n.keepAspectRatioPolicy," is not supported"))}})();t.fill(1,0,t.length);let o=e.slice();return n.axes.length>0?(n.axes.forEach((e=>t[e]=r)),n.axes.forEach((n=>o[n]=Math.round(e[n]*t[n])))):(t.fill(r,0,t.length),o.forEach(((e,n)=>o[n]=Math.round(e*t[n])))),o},WP=(e,t,n,r,o)=>"\n    fn calculateOriginalIndicesFromOutputIndices(output_indices: ".concat(e.type.indices,") -> array<").concat(e.type.value,", ").concat(n.length,"> {\n      var original_indices: array<").concat(e.type.value,", ").concat(n.length,">;\n      for (var i:u32 = 0; i < ").concat(n.length,"; i++) {\n        var output_index = ").concat(e.indicesGet("output_indices","i"),";\n        var scale = ").concat(EE("uniforms.scales","i",r),";\n        var roi_low = ").concat(EE("uniforms.roi","i",o),";\n        var roi_hi = ").concat(EE("uniforms.roi","i + ".concat(t.length),o),";\n        if (scale == 1.0) {\n          original_indices[i] = ").concat(e.type.value,"(output_index);\n        } else {\n          var input_shape_i = ").concat(EE("uniforms.input_shape","i",t.length),";\n          var output_shape_i = ").concat(EE("uniforms.output_shape","i",n.length),";\n          original_indices[i] = getOriginalCoordinateFromResizedCoordinate(output_index, scale, output_shape_i,\n                                                                           input_shape_i, roi_low, roi_hi);\n        }\n      }\n      return original_indices;\n    }"),GP=(e,t,n,r,o,a,i)=>"\n    fn calculateInputIndicesFromOutputIndices(output_indices: ".concat(t.type.indices,") -> ").concat(e.type.indices," {\n      var input_indices: ").concat(e.type.indices,";\n      for (var i:u32 = 0; i < ").concat(r.length,"; i++) {\n        var output_index = ").concat(t.indicesGet("output_indices","i"),";\n        var input_index: u32;\n        var scale = ").concat(EE("uniforms.scales","i",o),";\n        if (scale == 1.0) {\n          input_index = output_index;\n        } else {\n          var roi_low = ").concat(EE("uniforms.roi","i",a),";\n          var roi_hi = ").concat(EE("uniforms.roi","i + ".concat(n.length),a),";\n          var input_shape_i = ").concat(EE("uniforms.input_shape","i",n.length),";\n          var output_shape_i = ").concat(EE("uniforms.output_shape","i",r.length),";\n          var original_idx = getOriginalCoordinateFromResizedCoordinate(output_index, scale, output_shape_i,\n                                                                        input_shape_i, roi_low, roi_hi);\n          if (!").concat(i," || (original_idx >= 0 && original_idx < ").concat(t.type.value,"(input_shape_i))) {\n            if (original_idx < 0) {\n              input_index = 0;\n            } else if (original_idx > ").concat(t.type.value,"(input_shape_i - 1)) {\n              input_index = input_shape_i - 1;\n            } else {\n              input_index = u32(getNearestPixelFromOriginal(original_idx, scale < 1));\n            }\n          } else {\n            input_index = u32(original_idx);\n          }\n        }\n        ").concat(e.indicesSet("input_indices","i","input_index"),"\n      }\n      return input_indices;\n    }"),HP=(e,t)=>"\n    fn checkInputIndices(input_indices: ".concat(e.type.indices,") -> bool {\n      for (var i:u32 = 0; i < ").concat(t.length,"; i++) {\n        var input_index = ").concat(e.indicesGet("input_indices","i"),";\n        if (input_index < 0 || input_index >= ").concat(EE("uniforms.input_shape","i",t.length),") {\n          return false;\n        }\n      }\n      return true;\n    }"),KP=(e,t,n,r)=>e.rank>r?"\n    ".concat(e.indicesSet("input_indices",t,"channel"),";\n    ").concat(e.indicesSet("input_indices",n,"batch"),";\n"):"",ZP=(e,t,n,r,o)=>{let[a,i,s,l]=2===n.length?[-1,0,1,-1]:[0,2,3,1],c=e.type.value;return"\n    fn getInputValue(batch: u32, channel: u32, row: u32, col: u32) -> ".concat(c," {\n      var input_indices: ").concat(e.type.indices,";\n      ").concat(e.indicesSet("input_indices",i,"max(0, min(row, ".concat(n[i]," - 1))")),";\n      ").concat(e.indicesSet("input_indices",s,"max(0, min(col, ".concat(n[s]," - 1))")),";\n      ").concat(KP(e,l,a,2),"\n      return ").concat(e.getByIndices("input_indices"),";\n    }\n\n    fn bilinearInterpolation(output_indices: ").concat(t.type.indices,") -> ").concat(c," {\n      var originalIndices = calculateOriginalIndicesFromOutputIndices(output_indices);\n      var row:").concat(c," = originalIndices[").concat(i,"];\n      var col:").concat(c," = originalIndices[").concat(s,"];\n      ").concat(r?"if (row < 0 || row > (".concat(n[i]," - 1) || col < 0 || col > (").concat(n[s]," - 1)) {\n        return ").concat(o,";\n      }"):"",";\n      row = max(0, min(row, ").concat(n[i]," - 1));\n      col = max(0, min(col, ").concat(n[s]," - 1));\n      var row1: u32 = u32(row);\n      var col1: u32 = u32(col);\n      var row2: u32 = u32(row + 1);\n      var col2: u32 = u32(col + 1);\n      var channel: u32 = ").concat(n.length>2?"u32(originalIndices[".concat(l,"])"):"0",";\n      var batch: u32 =  ").concat(n.length>2?"u32(originalIndices[".concat(a,"])"):"0",";\n      var x11: ").concat(c," = getInputValue(batch, channel, row1, col1);\n      var x12: ").concat(c," = getInputValue(batch, channel, row1, col2);\n      var x21: ").concat(c," = getInputValue(batch, channel, row2, col1);\n      var x22: ").concat(c," = getInputValue(batch, channel, row2, col2);\n      var dx1: ").concat(c," = abs(row - ").concat(c,"(row1));\n      var dx2: ").concat(c," = abs(").concat(c,"(row2) - row);\n      var dy1: ").concat(c," = abs(col - ").concat(c,"(col1));\n      var dy2: ").concat(c," = abs(").concat(c,"(col2) - col);\n      if (row1 == row2) {\n        dx1 = 0.5;\n        dx2 = 0.5;\n      }\n      if (col1 == col2) {\n        dy1 = 0.5;\n        dy2 = 0.5;\n      }\n      return (x11 * dx2 * dy2 + x12 * dx2 * dy1 + x21 * dx1 * dy2 + x22 * dx1 * dy1);\n    }")},$P=(e,t,n,r,o,a,i,s,l,c)=>{let u=2===n.length,[d,p]=u?[0,1]:[2,3],h=e.type.value,f=i=>{let u=i===d?"row":"col";return"\n      fn ".concat(u,"CubicInterpolation(input_indices: ").concat(e.type.indices,", output_indices: ").concat(t.type.indices,") -> ").concat(h," {\n        var output_index = ").concat(t.indicesGet("output_indices",i),";\n        var originalIdx: ").concat(h," = getOriginalCoordinateFromResizedCoordinate(output_index, ").concat(o[i],",\n        ").concat(r[i],", ").concat(n[i],", ").concat(a[i],", ").concat(a[i]," + ").concat(n.length,");\n        var fractOriginalIdx: ").concat(h," = originalIdx - floor(originalIdx);\n        var coefs = getCubicInterpolationCoefs(fractOriginalIdx);\n\n        if (").concat(s," && (originalIdx < 0 || originalIdx > (").concat(n[i]," - 1))) {\n          return ").concat(l,";\n        }\n        var data: array<").concat(h,", 4> = array<").concat(h,", 4>(0.0, 0.0, 0.0, 0.0);\n        for (var i: i32 = -1; i < 3; i++) {\n          var ").concat(u,": ").concat(h," = originalIdx + ").concat(h,"(i);\n          if (").concat(u," < 0 || ").concat(u," >= ").concat(n[i],") {\n            ").concat(c?"coefs[i + 1] = 0.0;\n                        continue;":s?"return ".concat(l,";"):"".concat(u," = max(0, min(").concat(u,", ").concat(n[i]," - 1));"),";\n          }\n        var input_indices_copy: ").concat(e.type.indices," = input_indices;\n          ").concat(e.indicesSet("input_indices_copy",i,"u32(".concat(u,")")),";\n          data[i + 1] = ").concat(i===d?e.getByIndices("input_indices_copy"):"rowCubicInterpolation(input_indices_copy, output_indices)",";\n        }\n        return cubicInterpolation1D(data, coefs);\n      }")};return"\n    ".concat(f(d),";\n    ").concat(f(p),";\n  fn getCubicInterpolationCoefs(s: ").concat(h,") -> array<").concat(h,", 4> {\n    var absS = abs(s);\n    var coeffs: array<").concat(h,", 4> = array<").concat(h,", 4>(0.0, 0.0, 0.0, 0.0);\n    var oneMinusAbsS: ").concat(h," = 1.0 - absS;\n    var twoMinusAbsS: ").concat(h," = 2.0 - absS;\n    var onePlusAbsS: ").concat(h," = 1.0 + absS;\n    coeffs[0] = ((").concat(i," * onePlusAbsS - 5 * ").concat(i,") * onePlusAbsS + 8 * ").concat(i,") * onePlusAbsS - 4 * ").concat(i,";\n    coeffs[1] = ((").concat(i," + 2) * absS - (").concat(i," + 3)) * absS * absS + 1;\n    coeffs[2] = ((").concat(i," + 2) * oneMinusAbsS - (").concat(i," + 3)) * oneMinusAbsS * oneMinusAbsS + 1;\n    coeffs[3] = ((").concat(i," * twoMinusAbsS - 5 * ").concat(i,") * twoMinusAbsS + 8 * ").concat(i,") * twoMinusAbsS - 4 * ").concat(i,";\n    return coeffs;\n  }\n\n  fn cubicInterpolation1D(x: array<").concat(h,", 4>, coefs: array<").concat(h,", 4>) -> ").concat(h," {\n    var coefsSum: ").concat(h," = coefs[0] + coefs[1] + coefs[2] + coefs[3];\n    return (x[0] * coefs[0] + x[1] * coefs[1]+ x[2] * coefs[2]+ x[3] * coefs[3]) / coefsSum;\n  }\n\n  fn bicubicInterpolation(output_indices: ").concat(t.type.indices,") -> ").concat(h," {\n    var input_indices: ").concat(e.type.indices," = output_indices;\n    return colCubicInterpolation(input_indices, output_indices);\n  }\n    ")},XP=(e,t,n,r,o)=>{let[a,i,s,l,c]=3===n.length?[-1,0,1,2,-1]:[0,2,3,4,1],u=e.type.value;return"\n    fn getInputValue(batch: u32, channel: u32, depth:u32, height: u32, width: u32) -> ".concat(u," {\n      var input_indices: ").concat(e.type.indices,";\n      ").concat(e.indicesSet("input_indices",i,"max(0, min(depth, ".concat(n[i]," - 1))")),";\n      ").concat(e.indicesSet("input_indices",s,"max(0, min(height, ".concat(n[s]," - 1))")),";\n      ").concat(e.indicesSet("input_indices",l,"max(0, min(width, ".concat(n[l]," - 1))")),";\n      ").concat(KP(e,c,a,3),"\n      return ").concat(e.getByIndices("input_indices"),";\n    }\n\n    fn trilinearInterpolation(output_indices: ").concat(t.type.indices,") -> ").concat(u," {\n      var originalIndices = calculateOriginalIndicesFromOutputIndices(output_indices);\n      var depth:").concat(u," = originalIndices[").concat(i,"];\n      var height:").concat(u," = originalIndices[").concat(s,"];\n      var width:").concat(u," = originalIndices[").concat(l,"];\n      ").concat(r?"if (depth < 0 || depth > (".concat(n[i]," - 1) || height < 0 || height > (").concat(n[s]," - 1) || width < 0 || (width > ").concat(n[l]," - 1)) {\n      return ").concat(o,";\n        }"):"",";\n\n    depth = max(0, min(depth, ").concat(n[i]," - 1));\n      height = max(0, min(height, ").concat(n[s]," - 1));\n      width = max(0, min(width, ").concat(n[l]," - 1));\n      var depth1: u32 = u32(depth);\n      var height1: u32 = u32(height);\n      var width1: u32 = u32(width);\n      var depth2: u32 = u32(depth + 1);\n      var height2: u32 = u32(height + 1);\n      var width2: u32 = u32(width + 1);\n      var channel: u32 = ").concat(n.length>3?"u32(originalIndices[".concat(c,"])"):"0",";\n      var batch: u32 =  ").concat(n.length>3?"u32(originalIndices[".concat(a,"])"):"0",";\n\n      var x111: ").concat(u," = getInputValue(batch, channel, depth1, height1, width1);\n      var x112: ").concat(u," = getInputValue(batch, channel, depth1, height1, width2);\n      var x121: ").concat(u," = getInputValue(batch, channel, depth1, height2, width1);\n      var x122: ").concat(u," = getInputValue(batch, channel, depth1, height2, width2);\n      var x211: ").concat(u," = getInputValue(batch, channel, depth2, height1, width1);\n      var x212: ").concat(u," = getInputValue(batch, channel, depth2, height1, width2);\n      var x221: ").concat(u," = getInputValue(batch, channel, depth2, height2, width1);\n      var x222: ").concat(u," = getInputValue(batch, channel, depth2, height2, width2);\n      var dx1: ").concat(u," = abs(depth - ").concat(u,"(depth1));\n      var dx2: ").concat(u," = abs(").concat(u,"(depth2) - depth);\n      var dy1: ").concat(u," = abs(height - ").concat(u,"(height1));\n      var dy2: ").concat(u," = abs(").concat(u,"(height2) - height);\n      var dz1: ").concat(u," = abs(width - ").concat(u,"(width1));\n      var dz2: ").concat(u," = abs(").concat(u,"(width2) - width);\n      if (depth1 == depth2) {\n        dx1 = 0.5;\n        dx2 = 0.5;\n      }\n      if (height1 == height2) {\n        dy1 = 0.5;\n        dy2 = 0.5;\n      }\n      if (width1 == width2) {\n        dz1 = 0.5;\n        dz2 = 0.5;\n      }\n      return (x111 * dx2 * dy2 * dz2 + x112 * dx2 * dy2 * dz1 + x121 * dx2 * dy1 *dz2 + x122 * dx2 * dy1 * dz1 +\n              x211 * dx1 * dy2 * dz2 + x212 * dx1 * dy2 * dz1 + x221 * dx1 * dy1 *dz2 + x222 * dx1 * dy1 * dz1);\n    }")},JP=(e,t,n,r,o,a)=>{let i=e.dims,s=VP(a,t.axes,i.length),l=qP(i,r,o,t.axes),c=r.slice();0===r.length&&(c=i.map(((e,t)=>0===e?1:l[t]/e)),"stretch"!==t.keepAspectRatioPolicy&&(l=UP(i,c,t)));let u=ME("output",e.dataType,l.length),d=AE("input",e.dataType,i.length),p=qS.size(l),h=i.length===l.length&&i.every(((e,t)=>e===l[t])),f="tf_crop_and_resize"===t.coordinateTransformMode,m=t.extrapolationValue,g=d.type.value;return{name:"Resize",shaderCache:{hint:"".concat(t.cacheKey,"|").concat(n,"|").concat(c.length>0?"cubic"===t.mode?c:c.length:"","|").concat(o.length>0?o:"","|").concat(s.length>0?s:"","|").concat(h,"|").concat("nearest"===t.mode?i.length:i),inputDependencies:["rank"]},getShaderSource:e=>"\n      ".concat(h?"":"\n      ".concat(LP(t.coordinateTransformMode,g),";\n      ").concat((()=>{switch(t.mode){case"nearest":return"\n              ".concat(HP(d,i),";\n              ").concat(RP(t.nearestMode,n,g),";\n              ").concat(GP(d,u,i,l,c.length,s.length,f),";\n              ");case"linear":return"\n              ".concat(WP(u,i,l,c.length,s.length),";\n              ").concat((()=>{if(2===i.length||4===i.length)return"".concat(ZP(d,u,i,f,m));if(3===i.length||5===i.length)return"".concat(XP(d,u,i,f,m));throw Error("Linear mode only supports input dims 2, 3, 4 and 5 are supported in linear mode.")})(),";\n            ");case"cubic":return"\n            ".concat((()=>{if(2===i.length||4===i.length)return"".concat($P(d,u,i,l,c,s,t.cubicCoeffA,f,t.extrapolationValue,t.excludeOutside));throw Error("Cubic mode only supports input dims 2 and 4 are supported in linear mode.")})(),";\n            ");default:throw Error("Invalid resize mode")}})(),";\n      "),"\n      ").concat(e.registerUniform("output_size","u32").registerUniform("scales","f32",c.length).registerUniform("roi","f32",s.length).declareVariables(d,u),"\n      ").concat(e.mainStart(),"\n        ").concat(e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size"),"\n        ").concat(h?"output[global_idx] = input[global_idx];":"\n        let output_indices = ".concat(u.offsetToIndices("global_idx"),";\n        var input_indices: ").concat(d.type.indices,";\n        ").concat((()=>{switch(t.mode){case"nearest":return"input_indices = calculateInputIndicesFromOutputIndices(output_indices);\n                if (checkInputIndices(input_indices)) {\n                  output[global_idx] = ".concat(d.getByIndices("input_indices"),";\n                } else {\n                  output[global_idx] = ").concat(t.extrapolationValue,";\n                }");case"linear":return"output[global_idx] = ".concat(2===i.length||4===i.length?"bilinearInterpolation":"trilinearInterpolation","(output_indices);");case"cubic":return"output[global_idx] = bicubicInterpolation(output_indices);";default:throw Error("Unsupported resize mode: ".concat(t.mode))}})(),";\n"),"\n      }"),getRunData:()=>({outputs:[{dims:l,dataType:e.dataType}],dispatchGroup:{x:Math.ceil(p/64)},programUniforms:[{type:12,data:p},{type:1,data:c},{type:1,data:s},...xE(i,l)]})}},QP=e=>{let t=e.customDataBuffer;return new Uint32Array(t,t.byteOffset,1)[0]},YP=(e,t)=>{let n=[],r=[],o=[],a=QP(e);if(0!==t.antialias)throw Error("Only default value (0) for Antialias attribute is supported");BP(e.inputs,t,a,n,r,o),e.compute(JP(e.inputs[0],t,a,n,r,o),{inputs:[0]})},ez=e=>{let t=e.antialias,n=e.axes,r=e.coordinateTransformMode,o=e.cubicCoeffA,a=0!==e.excludeOutside,i=e.extrapolationValue,s=e.keepAspectRatioPolicy,l=e.mode,c=""===e.nearestMode?"simple":e.nearestMode;return _E({antialias:t,axes:n,coordinateTransformMode:r,cubicCoeffA:o,excludeOutside:a,extrapolationValue:i,keepAspectRatioPolicy:s,mode:l,nearestMode:c})}})),NO=pD((()=>{Iz(),Oz(),qz(),tz=e=>{if(!e||e.length<3)throw new Error("layerNorm requires at least 3 inputs.");let t=e[0],n=e[1],r=e[2];if(t.dataType!==n.dataType||t.dataType!==r.dataType)throw new Error("All inputs must have the same data type");if(3!==t.dims.length&&2!==t.dims.length)throw new Error("Input must be 2D or 3D");if(3!==n.dims.length&&2!==n.dims.length)throw new Error("Skip must be 2D or 3D");let o=t.dims[t.dims.length-1],a=t.dims[t.dims.length-2];if(n.dims[n.dims.length-1]!==o)throw new Error("Skip must have the same hidden size as input");if(n.dims[n.dims.length-2]!==a)throw new Error("Skip must have the same sequence length as input");if(1!==r.dims.length)throw new Error("Gamma must be 1D");if(r.dims[r.dims.length-1]!==o)throw new Error("Gamma must have the same hidden size as input");if(e.length>3){let t=e[3];if(1!==t.dims.length)throw new Error("Beta must be 1D");if(t.dims[t.dims.length-1]!==o)throw new Error("Beta must have the same hidden size as input")}if(e.length>4){let t=e[4];if(1!==t.dims.length)throw new Error("Bias must be 1D");if(t.dims[t.dims.length-1]!==o)throw new Error("Bias must have the same hidden size as input")}},nz=(e,t,n,r)=>{let o=t.simplified,a=e[0].dims,i=qS.size(a),s=a,l=i,c=a.slice(-1)[0],u=r?a.slice(0,-1).concat(1):[],d=!o&&e.length>3,p=e.length>4,h=r&&n>1,f=r&&n>2,m=n>3,g=64,_=kE(c),v=[{type:12,data:l},{type:12,data:_},{type:12,data:c},{type:1,data:t.epsilon}],y=[{dims:s,dataType:e[0].dataType}];return n>1&&y.push({dims:u,dataType:1}),n>2&&y.push({dims:u,dataType:1}),n>3&&y.push({dims:a,dataType:e[0].dataType}),{name:"SkipLayerNormalization",shaderCache:{hint:"".concat(_,";").concat(h,";").concat(f,";").concat(m),inputDependencies:e.map(((e,t)=>"type"))},getShaderSource:t=>{let n=[AE("x",e[0].dataType,e[0].dims,_),AE("skip",e[1].dataType,e[1].dims,_),AE("gamma",e[2].dataType,e[2].dims,_)];d&&n.push(AE("beta",e[3].dataType,e[3].dims,_)),p&&n.push(AE("bias",e[4].dataType,e[4].dims,_)),n.push(ME("output",e[0].dataType,s,_)),h&&n.push(ME("mean_output",1,u)),f&&n.push(ME("inv_std_output",1,u)),m&&n.push(ME("input_skip_bias_sum",e[0].dataType,s,_));let r=wE(e[0].dataType),a=wE(1,_);return"\n\n      ".concat(t.registerUniforms([{name:"output_size",type:"u32"},{name:"components",type:"u32"},{name:"hidden_size",type:"u32"},{name:"epsilon",type:"f32"}]).declareVariables(...n),"\n      var<workgroup> sum_shared : array<").concat(a,", ").concat(g,">;\n      var<workgroup> sum_squared_shared : array<").concat(a,", ").concat(g,">;\n\n      ").concat(t.mainStart([g,1,1]),"\n        let ix = local_id.x;\n        let iy = global_id.x / ").concat(g,";\n\n        let hidden_size_vectorized: u32 = uniforms.hidden_size / uniforms.components;\n        var stride = hidden_size_vectorized / ").concat(g,";\n        let offset = ix * stride + iy * hidden_size_vectorized;\n        let offset1d = stride * ix;\n        if (ix == ").concat(63,") {\n          stride = hidden_size_vectorized - stride * ix;\n        }\n        for (var i: u32 = 0; i < stride; i++) {\n          let skip_value = skip[offset + i];\n          let bias_value = ").concat(p?"bias[offset1d + i]":r+"(0.0)",";\n          let input_value = x[offset + i];\n          let value = input_value + skip_value + bias_value;\n          ").concat(m?"input_skip_bias_sum[offset + i] = value;":"","\n          output[offset + i] = value;\n          let f32_value = ").concat(DE(r,_,"value"),";\n          sum_shared[ix] += f32_value;\n          sum_squared_shared[ix] += f32_value * f32_value;\n        }\n        workgroupBarrier();\n\n        var reduce_size : u32 = ").concat(g,";\n        for (var curr_size = reduce_size >> 1;  curr_size > 0; curr_size = reduce_size >> 1) {\n          reduce_size = curr_size + (reduce_size & 1);\n          if (ix < curr_size) {\n            sum_shared[ix] += sum_shared[ix + reduce_size];\n            sum_squared_shared[ix] += sum_squared_shared[ix + reduce_size];\n          }\n          workgroupBarrier();\n        }\n\n        let sum = sum_shared[0];\n        let square_sum = sum_squared_shared[0];\n        let mean = ").concat(SE("sum",_)," / f32(uniforms.hidden_size);\n        let inv_std_dev = inverseSqrt(").concat(SE("square_sum",_)," / f32(uniforms.hidden_size) ").concat(o?"":"- mean * mean"," + uniforms.epsilon);\n        ").concat(h?"mean_output[global_idx] = mean;":"","\n        ").concat(f?"inv_std_output[global_idx] = inv_std_dev;":"","\n\n        for (var i: u32 = 0; i < stride; i++) {\n          output[offset + i] = (output[offset + i] ").concat(o?"":"- ".concat(r,"(mean)"),") *\n            ").concat(r,"(inv_std_dev) * gamma[offset1d + i]\n            ").concat(d?"+ beta[offset1d + i]":"",";\n        }\n      }")},getRunData:()=>({outputs:y,dispatchGroup:{x:Math.ceil(l/c)},programUniforms:v})}},rz=(e,t)=>{tz(e.inputs);let n=[0];e.outputCount>1&&n.push(-3),e.outputCount>2&&n.push(-3),e.outputCount>3&&n.push(3),e.compute(nz(e.inputs,t,e.outputCount,!1),{outputs:n})}})),BO=pD((()=>{Iz(),Oz(),Vz(),qz(),oz=(e,t)=>{if(!e||e.length<1)throw new Error("too few inputs");if(0!==t.axes.length){if(t.axes.length!==t.starts.length||t.axes.length!==t.ends.length)throw new Error("axes, starts and ends must have the same length")}else if(t.starts.length!==t.ends.length)throw new Error("starts and ends must have the same length");e.slice(1).forEach(((t,n)=>{if(6!==e[n+1].dataType&&7!==e[n+1].dataType)throw new Error("Input ".concat(n," must be an array of int32 or int64"))}))},az=(e,t)=>{let n=[];if(e.length>t)if(7===e[t].dataType)e[t].getBigInt64Array().forEach((e=>n.push(Number(e))));else{if(6!==e[t].dataType)throw new Error("Input ".concat(t," must be an array of int32 or int64"));e[t].getInt32Array().forEach((e=>n.push(Number(e))))}return n},iz=(e,t)=>{if(e.length>1){let t=az(e,1),n=az(e,2),r=az(e,3);return 0===r.length&&(r=[...Array(e[0].dims.length).keys()]),_E({starts:t,ends:n,axes:r})}return t},sz=(e,t,n,r,o)=>{let a=e;return e<0&&(a+=n[r[t]]),o[t]<0?Math.max(0,Math.min(a,n[r[t]]-1)):Math.max(0,Math.min(a,n[r[t]]))},lz=(e,t,n)=>"fn calculateInputIndices(output_indices: ".concat(t.type.indices,") -> ").concat(e.type.indices," {\n          var input_indices: ").concat(e.type.indices,";\n          var carry = 0u;\n          for (var i = ").concat(n.length,"; i >= 0; i--) {\n            let input_shape_i = ").concat(EE("uniforms.input_shape","i",n.length),";\n            let steps_i = ").concat(EE("uniforms.steps","i",n.length),";\n            let signs_i = ").concat(EE("uniforms.signs","i",n.length),";\n            let starts_i = ").concat(EE("uniforms.starts","i",n.length),";\n            var output_index = ").concat(t.indicesGet("output_indices","i"),";\n            var input_index = output_index * steps_i + starts_i + carry;\n            carry = input_index / input_shape_i;\n            input_index = input_index % input_shape_i;\n            if (signs_i < 0) {\n              input_index = input_shape_i - input_index - 1u + starts_i;\n            }\n            ").concat(e.indicesSet("input_indices","i","input_index"),";\n          }\n          return input_indices;\n      }"),cz=(e,t)=>{let n=e[0].dims,r=qS.size(n),o=t.axes.length>0?qS.normalizeAxes(t.axes,n.length):[...Array(n.length).keys()],a=az(e,4);a.forEach((e=>0!==e||(()=>{throw new Error("step cannot be 0")}))),0===a.length&&(a=Array(o.length).fill(1));let i=t.starts.map(((e,t)=>sz(e,t,n,o,a))),s=t.ends.map(((e,t)=>sz(e,t,n,o,a)));if(o.length!==i.length||o.length!==s.length)throw new Error("start, ends and axes should have the same number of elements");if(o.length!==n.length)for(let g=0;g<n.length;++g)o.includes(g)||(i.splice(g,0,0),s.splice(g,0,n[g]),a.splice(g,0,1));let l=a.map((e=>Math.sign(e)));a.forEach(((e,t,n)=>{if(e<0){let r=(s[t]-i[t])/e,o=i[t],l=o+r*a[t];i[t]=l,s[t]=o,n[t]=-e}}));let c=n.slice(0);o.forEach(((e,t)=>{c[e]=Math.ceil((s[e]-i[e])/a[e])}));let u={dims:c,dataType:e[0].dataType},d=ME("output",e[0].dataType,c.length),p=AE("input",e[0].dataType,e[0].dims.length),h=qS.size(c),f=[{name:"outputSize",type:"u32"},{name:"starts",type:"u32",length:i.length},{name:"signs",type:"i32",length:l.length},{name:"steps",type:"u32",length:a.length}],m=[{type:12,data:h},{type:12,data:i},{type:6,data:l},{type:12,data:a},...xE(e[0].dims,c)];return{name:"Slice",shaderCache:{hint:"".concat(l.length,"_").concat(i.length,"_").concat(a.length),inputDependencies:["rank"]},getShaderSource:e=>"\n      ".concat(e.registerUniforms(f).declareVariables(p,d),"\n        ").concat(lz(p,d,n),"\n        ").concat(e.mainStart(),"\n          ").concat(e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize"),"\n          let output_indices = ").concat(d.offsetToIndices("global_idx"),";\n          let input_indices = calculateInputIndices(output_indices);\n          ").concat(d.setByOffset("global_idx",p.getByIndices("input_indices")),"\n      }"),getRunData:()=>({outputs:[u],dispatchGroup:{x:Math.ceil(r/64)},programUniforms:m})}},uz=(e,t)=>{oz(e.inputs,t);let n=iz(e.inputs,t);e.compute(cz(e.inputs,n),{inputs:[0]})},dz=e=>{let t=e.starts,n=e.ends,r=e.axes;return _E({starts:t,ends:n,axes:r})}})),jO=pD((()=>{Iz(),Oz(),Vz(),Uz(),qz(),pz=e=>{if(!e||1!==e.length)throw new Error("Softmax op requires 1 input.")},hz=(e,t)=>{let n,r=e.inputs[0],o=r.dims,a=qS.size(o),i=o.length,s=qS.normalizeAxis(t.axis,i),l=s<o.length-1,c=[];l?(c=Array.from({length:i},((e,t)=>t)),c[s]=i-1,c[i-1]=s,n=e.compute(VE(r,c),{inputs:[r],outputs:[-1]})[0]):n=r;let u=n.dims,d=u[i-1],p=a/d,h=kE(d),f=d/h,m=64;1===p&&(m=256);let g=AE("x",n.dataType,n.dims,h),_=ME("result",n.dataType,n.dims,h),v=g.type.value,y="f32"===wE(n.dataType)?"var threadMax = ".concat(v,"(-3.402823e+38f);"):"var threadMax = ".concat(v,"(-65504.0h);"),w=e.compute({name:"Softmax",shaderCache:{hint:"".concat(h,";").concat(m),inputDependencies:["type"]},getRunData:()=>({outputs:[{dims:u,dataType:n.dataType}],dispatchGroup:{x:p},programUniforms:[{type:6,data:f}]}),getShaderSource:e=>"\n      var<workgroup> rowMaxShared : ".concat(v,";\n      var<workgroup> rowSumShared : ").concat(v,";\n      var<workgroup> threadShared : array<").concat(v,", ").concat(m,">;\n\n      fn getValue(row: i32, col: i32, row_stride: i32) -> ").concat(v," {\n        let index = row * row_stride + col;\n        return x[index];\n      }\n\n      fn setValue(row: i32, col: i32, row_stride: i32, value: ").concat(v,") {\n        let index = row * row_stride + col;\n        result[index] = value;\n      }\n      ").concat(e.registerUniform("packedCols","i32").declareVariables(g,_),"\n      ").concat(e.mainStart(m),"\n        let gindex = i32(global_idx);\n        let lindex = i32(local_idx);\n        const wg = ").concat(m,";\n        let row = gindex / wg;\n        let cols = uniforms.packedCols;\n        let row_stride : i32 = uniforms.packedCols;\n\n        // find the rows max\n        ").concat(y,"\n        for (var col = lindex; col < cols; col += wg) {\n          let value = getValue(row, col, row_stride);\n          threadMax = max(threadMax, value);\n        }\n        if (lindex < cols) {\n          threadShared[lindex] = threadMax;\n        }\n        workgroupBarrier();\n\n        var reduceSize = min(cols, wg);\n        for (var currSize = reduceSize >> 1;  currSize > 0; currSize = reduceSize >> 1) {\n          reduceSize = currSize + (reduceSize & 1);\n          if (lindex < currSize) {\n            threadShared[lindex] = max(threadShared[lindex], threadShared[lindex + reduceSize]);\n          }\n          workgroupBarrier();\n        }\n        if (lindex == 0) {\n          rowMaxShared = ").concat(v,"(").concat(((e,t)=>4===t?"max(max(".concat(e,".x, ").concat(e,".y), max(").concat(e,".z, ").concat(e,".w))"):2===t?"max(".concat(e,".x, ").concat(e,".y)"):3===t?"max(max(".concat(e,".x, ").concat(e,".y), ").concat(e,".z)"):e)("threadShared[0]",h),");\n        }\n        workgroupBarrier();\n\n        // find the rows sum\n        var threadSum = ").concat(v,"(0.0);\n        for (var col = lindex; col < cols; col += wg) {\n          let subExp = exp(getValue(row, col, row_stride) - rowMaxShared);\n          threadSum += subExp;\n        }\n        threadShared[lindex] = threadSum;\n        workgroupBarrier();\n\n        for (var currSize = wg >> 1;  currSize > 0; currSize = currSize >> 1) {\n          if (lindex < currSize) {\n            threadShared[lindex] = threadShared[lindex] + threadShared[lindex + currSize];\n          }\n          workgroupBarrier();\n        }\n        if (lindex == 0) {\n          rowSumShared = ").concat(v,"(").concat(SE("threadShared[0]",h),");\n        }\n        workgroupBarrier();\n\n        // calculate final value for each element in the row\n        for (var col = lindex; col < cols; col += wg) {\n          let value = exp(getValue(row, col, row_stride) - rowMaxShared) / rowSumShared;\n          setValue(row, col, row_stride, value);\n        }\n      }")},{inputs:[n],outputs:[l?-1:0]})[0];l&&e.compute(VE(w,c),{inputs:[w]})},fz=(e,t)=>{pz(e.inputs),hz(e,t)},mz=e=>_E({axis:e.axis})})),LO=pD((()=>{Iz(),Oz(),qz(),gz=e=>Array.from(e.getBigInt64Array(),Number),_z=e=>{if(!e||2!==e.length)throw new Error("Tile requires 2 inputs.");if(1!==e[0].dataType&&10!==e[0].dataType&&6!==e[0].dataType&&12!==e[0].dataType)throw new Error("Tile only support float, float16, int32, and uint32 data types");if(7!==e[1].dataType)throw new Error("Tile `repeats` input should be of int64 data type");if(1!==e[1].dims.length)throw new Error("Tile `repeats` input should be 1-D");if(gz(e[1]).length!==e[0].dims.length)throw new Error("Tile `repeats` input should have same number of elements as rank of input data tensor")},vz=(e,t)=>{let n=[];for(let r=0;r<e.length;++r)n.push(e[r]*t[r]);return n},yz=(e,t)=>{let n=e[0].dims,r=null!==t&&void 0!==t?t:gz(e[1]),o=vz(n,r),a=qS.size(o),i=e[0].dataType,s=AE("input",i,n.length),l=ME("output",i,o.length);return{name:"Tile",shaderCache:{hint:"".concat(r),inputDependencies:["rank"]},getRunData:()=>({outputs:[{dims:o,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(a/64)},programUniforms:[{type:12,data:a},...xE(e[0].dims,o)]}),getShaderSource:e=>"\n      const inputShape = ".concat(s.indices(...n),";\n      ").concat(e.registerUniform("output_size","u32").declareVariables(s,l),"\n      ").concat(e.mainStart(),"\n      ").concat(e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size"),"\n      let output_indices = ").concat(l.offsetToIndices("global_idx"),";\n      var input_indices: ").concat(s.type.indices,";\n      for (var i = 0; i < ").concat(n.length,"; i++) {\n        let input_dim_i = ").concat(s.indicesGet("uniforms.input_shape","i"),";\n        let input_dim_value = ").concat(l.indicesGet("output_indices","i"),"  % input_dim_i;\n\n        ").concat(s.indicesSet("input_indices","i","input_dim_value"),"\n      }\n      ").concat(l.setByOffset("global_idx",s.getByIndices("input_indices")),"\n    }")}},wz=e=>{_z(e.inputs),e.compute(yz(e.inputs),{inputs:[0]})}})),RO=pD((()=>{Iz(),Oz(),qz(),bz=(e,t,n,r,o)=>{let a,i=ME("output_data",o,n.length,4),s=AE("a_data",t[1].dataType,t[1].dims.length,4),l=AE("b_data",t[2].dataType,t[2].dims.length,4),c=AE("c_data",t[0].dataType,t[0].dims.length,4),u=(e,t,n)=>"select(".concat(t,", ").concat(e,", ").concat(n,")");if(r){let e=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",r="a_data[index_a".concat(t,"][component_a").concat(t,"]"),o="b_data[index_b".concat(t,"][component_b").concat(t,"]"),a="bool(c_data[index_c".concat(t,"] & (0xffu << (component_c").concat(t," * 8)))");return"\n            let output_indices".concat(t," = ").concat(i.offsetToIndices("global_idx * 4u + ".concat(t,"u")),";\n            let offset_a").concat(t," = ").concat(s.broadcastedIndicesToOffset("output_indices".concat(t),i),";\n            let offset_b").concat(t," = ").concat(l.broadcastedIndicesToOffset("output_indices".concat(t),i),";\n            let offset_c").concat(t," = ").concat(c.broadcastedIndicesToOffset("output_indices".concat(t),i),";\n            let index_a").concat(t," = offset_a").concat(t," / 4u;\n            let index_b").concat(t," = offset_b").concat(t," / 4u;\n            let index_c").concat(t," = offset_c").concat(t," / 4u;\n            let component_a").concat(t," = offset_a").concat(t," % 4u;\n            let component_b").concat(t," = offset_b").concat(t," % 4u;\n            let component_c").concat(t," = offset_c").concat(t," % 4u;\n            ").concat(e,"[").concat(t,"] = ").concat(n,"(").concat(u(r,o,a),");\n          ")};a=9===o?"\n            var data = vec4<u32>(0);\n            ".concat(e("data",0,"u32"),"\n            ").concat(e("data",1,"u32"),"\n            ").concat(e("data",2,"u32"),"\n            ").concat(e("data",3,"u32"),"\n            output_data[global_idx] = dot(vec4<u32>(0x1, 0x100, 0x10000, 0x1000000), vec4<u32>(data));"):"\n            ".concat(e("output_data[global_idx]",0),"\n            ").concat(e("output_data[global_idx]",1),"\n            ").concat(e("output_data[global_idx]",2),"\n            ").concat(e("output_data[global_idx]",3),"\n          ")}else a=i.setByOffset("global_idx",u(s.getByOffset("global_idx"),l.getByOffset("global_idx"),c.getByOffset("global_idx")));return"\n        ".concat(e.registerUniform("vec_size","u32").declareVariables(c,s,l,i),"\n        ").concat(e.mainStart(),"\n        ").concat(e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.vec_size"),"\n        ").concat(a,"\n      }")},xz=e=>{let t=e[1].dims,n=e[2].dims,r=e[0].dims,o=e[1].dataType,a=!(qS.areEqual(t,n)&&qS.areEqual(n,r)),i=t,s=qS.size(t);if(a){let e=VS.calcShape(VS.calcShape(t,n,!1),r,!1);if(!e)throw new Error("Can't perform where op on the given tensors");i=e,s=qS.size(i)}let l=Math.ceil(s/4);return{name:"Where",shaderCache:{inputDependencies:["rank","rank","rank"]},getShaderSource:t=>bz(t,e,i,a,o),getRunData:()=>({outputs:[{dims:i,dataType:o}],dispatchGroup:{x:Math.ceil(s/64/4)},programUniforms:[{type:12,data:l},...xE(r,t,n,i)]})}},kz=e=>{e.compute(xz(e.inputs))}})),VO=pD((()=>{Hz(),Kz(),Zz(),$z(),Jz(),Qz(),Yz(),lO(),uO(),dO(),pO(),hO(),fO(),mO(),gO(),_O(),vO(),yO(),wO(),bO(),DO(),SO(),EO(),TO(),AO(),xO(),MO(),FO(),IO(),PO(),zO(),Gz(),OO(),CO(),NO(),BO(),jO(),kO(),LO(),Uz(),Xz(),RO(),Cz=new Map([["Abs",[oA]],["Acos",[aA]],["Acosh",[iA]],["Add",[YA]],["ArgMax",[LT,RT]],["ArgMin",[jT,RT]],["Asin",[sA]],["Asinh",[lA]],["Atan",[cA]],["Atanh",[uA]],["Attention",[ZT]],["AveragePool",[hP,pP]],["BatchNormalization",[QT]],["BiasAdd",[tA]],["BiasSplitGelu",[$A]],["Cast",[pA,dA]],["Ceil",[mA]],["Clip",[fA]],["Concat",[hM,fM]],["Conv",[QM,ZM]],["ConvTranspose",[lF,oF]],["Cos",[gA]],["Cosh",[_A]],["CumSum",[uF,dF]],["DepthToSpace",[mF,gF]],["DequantizeLinear",[CP,DP]],["Div",[eM]],["Einsum",[DF,SF]],["Elu",[yA,vA]],["Equal",[tM]],["Erf",[bA]],["Exp",[xA]],["Expand",[FF]],["FastGelu",[PF]],["Floor",[kA]],["FusedConv",[QM,ZM]],["Gather",[BF,NF]],["GatherElements",[ZF,KF]],["GatherBlockQuantized",[UF,WF]],["GatherND",[LF,RF]],["Gelu",[CA]],["Gemm",[QF,JF]],["GlobalAveragePool",[gP,mP]],["GlobalMaxPool",[bP,wP]],["Greater",[aM]],["GreaterOrEqual",[sM]],["GridSample",[uI,dI]],["GroupQueryAttention",[PI]],["HardSigmoid",[IA,FA]],["InstanceNormalization",[BI]],["LayerNormalization",[RI]],["LeakyRelu",[DA,vA]],["Less",[iM]],["LessOrEqual",[lM]],["Log",[UA]],["MatMul",[qI]],["MatMulNBits",[HI,KI]],["MaxPool",[vP,yP]],["Mul",[nM]],["MultiHeadAttention",[vI,fI]],["Neg",[EA]],["Not",[SA]],["Pad",[nP]],["Pow",[rM]],["QuickGelu",[HA,vA]],["Range",[TP]],["Reciprocal",[TA]],["ReduceMin",[IT]],["ReduceMean",[ET]],["ReduceMax",[FT]],["ReduceSum",[zT]],["ReduceProd",[PT]],["ReduceL1",[TT]],["ReduceL2",[AT]],["ReduceLogSum",[NT]],["ReduceLogSumExp",[MT]],["ReduceSumSquare",[OT]],["Relu",[AA]],["Resize",[YP,ez]],["RotaryEmbedding",[TI]],["ScatterND",[zP,PP]],["Sigmoid",[MA]],["Sin",[PA]],["Sinh",[zA]],["Slice",[uz,dz]],["SkipLayerNormalization",[rz]],["Split",[CI,DI]],["Sqrt",[OA]],["Softmax",[fz,mz]],["Sub",[oM]],["Tan",[NA]],["Tanh",[jA]],["ThresholdedRelu",[qA,vA]],["Tile",[wz]],["Transpose",[qE,UE]],["Where",[kz]]])})),qO=pD((()=>{zD(),zz(),qz(),Dz=class{constructor(e){this.backend=e,this.repo=new Map,this.attributesBound=!1}getArtifact(e){return this.repo.get(e)}setArtifact(e,t){this.repo.set(e,t)}run(e,t,n,r,o){rD(e.programInfo.name);let a=this.backend.device,i=this.backend.getComputePassEncoder();this.backend.writeTimestamp(2*this.backend.pendingDispatchNumber);let s=[];for(let c of t)s.push({binding:s.length,resource:{buffer:c.buffer}});for(let c of n)s.push({binding:s.length,resource:{buffer:c.buffer}});o&&s.push({binding:s.length,resource:o});let l=a.createBindGroup({layout:e.computePipeline.getBindGroupLayout(0),entries:s,label:e.programInfo.name});if("capturing"===this.backend.sessionStatus){let t={kernelId:this.backend.currentKernelId,computePipeline:e.computePipeline,bindGroup:l,dispatchGroup:r};this.backend.capturedCommandList.get(this.backend.currentSessionId).push(t)}i.setPipeline(e.computePipeline),i.setBindGroup(0,l),i.dispatchWorkgroups(...r),this.backend.writeTimestamp(2*this.backend.pendingDispatchNumber+1),this.backend.pendingDispatchNumber++,(this.backend.pendingDispatchNumber>=this.backend.maxDispatchNumber||"at-passes"===this.backend.queryType)&&this.backend.endComputePass(),this.backend.pendingDispatchNumber>=this.backend.maxDispatchNumber&&this.backend.flush(),oD(e.programInfo.name)}dispose(){}build(e,t){rD(e.name);let n=this.backend.device,r=[];[{feature:"shader-f16",extension:"f16"},{feature:"subgroups",extension:"subgroups"}].forEach((e=>{n.features.has(e.feature)&&r.push("enable ".concat(e.extension,";"))}));let o=zE(t,this.backend.device.limits),a=e.getShaderSource(o),i="".concat(r.join("\n"),"\n").concat(o.additionalImplementations,"\n").concat(a),s=n.createShaderModule({code:i,label:e.name});LS("verbose",(()=>"[WebGPU] ".concat(e.name," shader code: ").concat(i)));let l=n.createComputePipeline({compute:{module:s,entryPoint:"main"},layout:"auto",label:e.name});return oD(e.name),{programInfo:e,computePipeline:l,uniformVariablesInfo:o.variablesInfo}}normalizeDispatchGroupSize(e){let t="number"==typeof e?e:e.x,n="number"==typeof e?1:e.y||1,r="number"==typeof e?1:e.z||1,o=this.backend.device.limits.maxComputeWorkgroupsPerDimension;if(t<=o&&n<=o&&r<=o)return[t,n,r];let a=t*n*r,i=Math.ceil(Math.sqrt(a));if(i>o){if(i=Math.ceil(Math.cbrt(a)),i>o)throw new Error("Total dispatch size exceeds WebGPU maximum.");return[i,i,i]}return[i,i,1]}}})),UO={};hD(UO,{WebGpuBackend:()=>KO});var WO,GO,HO,KO,ZO=pD((()=>{zD(),Iz(),zz(),Nz(),Rz(),VO(),qO(),WO=(e,t)=>{if(t.length!==e.length)throw new Error("inputDependencies length ".concat(t.length," is not equal to inputTensors length ").concat(e.length,"."));let n=[];for(let r=0;r<e.length;++r){let o=e[r].dataType;switch(t[r]){case"none":n.push("");break;case"type":n.push("".concat(o));break;case"rank":{let t=e[r].dims.length;n.push("".concat(o,";").concat(t));break}case"dims":{let t=e[r].dims.join(",");n.push("".concat(o,";").concat(t));break}default:throw new Error("unsupported input dependency: ".concat(t[r]))}}return n.join("|")},GO=(e,t,n)=>{var r,o,a;let i=e.name;return null!==(r=e.shaderCache)&&void 0!==r&&r.hint&&(i+="["+e.shaderCache.hint+"]"),i+=":"+n+":".concat(WO(t,null!==(o=null===(a=e.shaderCache)||void 0===a?void 0:a.inputDependencies)&&void 0!==o?o:new Array(t.length).fill("dims"))),i},HO=class{constructor(e){e&&(this.architecture=e.architecture,this.vendor=e.vendor)}isArchitecture(e){return this.architecture===e}isVendor(e){return this.vendor===e}},KO=class{constructor(){this.currentSessionId=null,this.currentKernelId=null,this.commandEncoder=null,this.computePassEncoder=null,this.maxDispatchNumber=16,this.pendingDispatchNumber=0,this.pendingKernels=[],this.pendingQueries=new Map,this.sessionStatus="default",this.capturedCommandList=new Map,this.capturedPendingKernels=new Map,this.sessionExternalDataMapping=new Map}get currentKernelCustomData(){if(null===this.currentKernelId)throw new Error("currentKernelCustomData(): currentKernelId is null. (should not happen)");let e=this.kernelCustomData.get(this.currentKernelId);return e||(e={},this.kernelCustomData.set(this.currentKernelId,e)),e}async initialize(e,t){this.env=e;let n=[],r={requiredLimits:{maxComputeWorkgroupStorageSize:t.limits.maxComputeWorkgroupStorageSize,maxComputeWorkgroupsPerDimension:t.limits.maxComputeWorkgroupsPerDimension,maxStorageBufferBindingSize:t.limits.maxStorageBufferBindingSize,maxBufferSize:t.limits.maxBufferSize,maxComputeInvocationsPerWorkgroup:t.limits.maxComputeInvocationsPerWorkgroup,maxComputeWorkgroupSizeX:t.limits.maxComputeWorkgroupSizeX,maxComputeWorkgroupSizeY:t.limits.maxComputeWorkgroupSizeY,maxComputeWorkgroupSizeZ:t.limits.maxComputeWorkgroupSizeZ},requiredFeatures:n},o=e=>t.features.has(e)&&n.push(e)&&!0;o("chromium-experimental-timestamp-query-inside-passes")||o("timestamp-query"),o("shader-f16"),o("subgroups"),this.device=await t.requestDevice(r),this.adapterInfo=new HO(t.info||await t.requestAdapterInfo()),this.gpuDataManager=mE(this),this.programManager=new Dz(this),this.kernels=new Map,this.kernelPersistentData=new Map,this.kernelCustomData=new Map,BS(e.logLevel,!!e.debug),this.device.onuncapturederror=e=>{e.error instanceof GPUValidationError&&console.error("An uncaught WebGPU validation error was raised: ".concat(e.error.message))},Object.defineProperty(this.env.webgpu,"device",{value:this.device,writable:!1,enumerable:!0,configurable:!1}),Object.defineProperty(this.env.webgpu,"adapter",{value:t,writable:!1,enumerable:!0,configurable:!1}),this.setQueryType()}dispose(){typeof this.querySet<"u"&&this.querySet.destroy(),this.gpuDataManager.dispose()}getCommandEncoder(){return this.commandEncoder||(this.commandEncoder=this.device.createCommandEncoder()),this.commandEncoder}getComputePassEncoder(){if(!this.computePassEncoder){let e=this.getCommandEncoder(),t={};"at-passes"===this.queryType&&(t.timestampWrites={querySet:this.querySet,beginningOfPassWriteIndex:2*this.pendingDispatchNumber,endOfPassWriteIndex:2*this.pendingDispatchNumber+1}),this.computePassEncoder=e.beginComputePass(t)}return this.computePassEncoder}endComputePass(){this.computePassEncoder&&(this.computePassEncoder.end(),this.computePassEncoder=null)}flush(){if(!this.commandEncoder)return;let e;rD(),this.endComputePass(),"none"!==this.queryType&&(this.commandEncoder.resolveQuerySet(this.querySet,0,2*this.pendingDispatchNumber,this.queryResolveBuffer,0),e=this.device.createBuffer({size:2*this.pendingDispatchNumber*8,usage:GPUBufferUsage.MAP_READ|GPUBufferUsage.COPY_DST}),this.pendingQueries.set(e,this.pendingKernels),this.pendingKernels=[],this.commandEncoder.copyBufferToBuffer(this.queryResolveBuffer,0,e,0,2*this.pendingDispatchNumber*8)),this.device.queue.submit([this.commandEncoder.finish()]),this.gpuDataManager.refreshPendingBuffers(),this.commandEncoder=null,this.pendingDispatchNumber=0,"none"!==this.queryType&&e.mapAsync(GPUMapMode.READ).then((()=>{let t=new BigUint64Array(e.getMappedRange()),n=this.pendingQueries.get(e);for(let e=0;e<t.length/2;e++){var r;let o=n[e],a=o.kernelId,i=this.kernels.get(a),s=i.kernelType,l=i.kernelName,c=o.programName,u=o.inputTensorViews,d=o.outputTensorViews,p=t[2*e],h=t[2*e+1];typeof this.queryTimeBase>"u"&&(this.queryTimeBase=p);let f=Number(p-this.queryTimeBase),m=Number(h-this.queryTimeBase);if(!Number.isSafeInteger(f)||!Number.isSafeInteger(m))throw new RangeError("incorrect timestamp range");if(null!==(r=this.env.webgpu.profiling)&&void 0!==r&&r.ondata)this.env.webgpu.profiling.ondata({version:1,inputsMetadata:u.map((e=>({dims:e.dims,dataType:DS(e.dataType)}))),outputsMetadata:d.map((e=>({dims:e.dims,dataType:DS(e.dataType)}))),kernelId:a,kernelType:s,kernelName:l,programName:c,startTime:f,endTime:m});else{let e="";u.forEach(((t,n)=>{e+="input[".concat(n,"]: [").concat(t.dims,"] | ").concat(DS(t.dataType),", ")}));let t="";d.forEach(((e,n)=>{t+="output[".concat(n,"]: [").concat(e.dims,"] | ").concat(DS(e.dataType),", ")})),console.log('[profiling] kernel "'.concat(a,"|").concat(s,"|").concat(l,"|").concat(c,'" ').concat(e).concat(t,"execution time: ").concat(m-f," ns"))}tD("GPU","".concat(c,"::").concat(p,"::").concat(h))}e.unmap(),this.pendingQueries.delete(e)})),oD()}run(e,t,n,r,o,a){rD(e.name);let i=[];for(let v=0;v<t.length;++v){let e=t[v].data;if(0===e)continue;let n=this.gpuDataManager.get(e);if(!n)throw new Error("no GPU data for input: ".concat(e));i.push(n)}let{outputs:s,dispatchGroup:l,programUniforms:c}=e.getRunData(t),u=0===n.length?s.map(((e,t)=>t)):n;if(u.length!==s.length)throw new Error("Output size ".concat(u.length," must be equal to ").concat(s.length,"."));let d,p=[],h=[];for(let v=0;v<s.length;++v){if(!Number.isInteger(u[v])||u[v]<-3||u[v]>=a)throw new Error("Invalid output index: ".concat(u[v]));if(-3===u[v])continue;let e=-1===u[v],t=-2===u[v],n=e||t?o(s[v].dataType,s[v].dims):r(u[v],s[v].dataType,s[v].dims);if(p.push(n),0===n.data)continue;let i=this.gpuDataManager.get(n.data);if(!i)throw new Error("no GPU data for output: ".concat(n.data));if(e&&this.temporaryData.push(i),t){let e=this.kernelPersistentData.get(this.currentKernelId);e||(e=[],this.kernelPersistentData.set(this.currentKernelId,e)),e.push(i)}h.push(i)}if(i.length!==t.length||h.length!==p.length){if(0===h.length)return oD(e.name),p;throw new Error("Program ".concat(e.name," has zero-sized tensor(s) in inputs or outputs. This is not supported now."))}if(c){let e=0,t=[];c.forEach((n=>{let r="number"==typeof n.data?[n.data]:n.data;if(0===r.length)return;let o,a,i=10===n.type?2:4;10===n.type?(a=r.length>4?16:r.length>2?8:r.length*i,o=r.length>4?16:i*r.length):(a=r.length<=2?r.length*i:16,o=16),e=Math.ceil(e/a)*a,t.push(e);let s=10===n.type?8:4;e+=r.length>4?Math.ceil(r.length/s)*o:r.length*i}));let n=16;e=Math.ceil(e/n)*n;let r=new ArrayBuffer(e);c.forEach(((e,n)=>{let o=t[n],a="number"==typeof e.data?[e.data]:e.data;if(6===e.type)new Int32Array(r,o,a.length).set(a);else if(12===e.type)new Uint32Array(r,o,a.length).set(a);else if(10===e.type)new Uint16Array(r,o,a.length).set(a);else{if(1!==e.type)throw new Error("Unsupported uniform type: ".concat(DS(e.type)));new Float32Array(r,o,a.length).set(a)}}));let o=this.gpuDataManager.create(e,GPUBufferUsage.COPY_DST|GPUBufferUsage.UNIFORM);this.device.queue.writeBuffer(o.buffer,0,r,0,e),this.gpuDataManager.release(o.id),d={offset:0,size:e,buffer:o.buffer}}let f=this.programManager.normalizeDispatchGroupSize(l),m=1===f[1]&&1===f[2],g=GO(e,t,m),_=this.programManager.getArtifact(g);if(_||(_=this.programManager.build(e,f),this.programManager.setArtifact(g,_),LS("info",(()=>"[artifact] key: ".concat(g,", programName: ").concat(e.name)))),c&&_.uniformVariablesInfo){if(c.length!==_.uniformVariablesInfo.length)throw new Error("Uniform variables count mismatch: expect ".concat(_.uniformVariablesInfo.length,", got ").concat(c.length,' in program "').concat(_.programInfo.name,'".'));for(let e=0;e<c.length;e++){let t=c[e],n=t.type,r="number"==typeof t.data?1:t.data.length,[o,a]=_.uniformVariablesInfo[e];if(n!==o||r!==a)throw new Error("Uniform variable ".concat(e," mismatch: expect type ").concat(o," with size ").concat(a,", got type ").concat(n," with size ").concat(r,' in program "').concat(_.programInfo.name,'".'))}}if(LS("info",(()=>'[ProgramManager] run "'.concat(e.name,'" (key=').concat(g,") with ").concat(f[0],"x").concat(f[1],"x").concat(f[2]))),"none"!==this.queryType||"capturing"===this.sessionStatus){let e={kernelId:this.currentKernelId,programName:_.programInfo.name,inputTensorViews:t,outputTensorViews:p};this.pendingKernels.push(e),"capturing"===this.sessionStatus&&this.capturedPendingKernels.get(this.currentSessionId).push(e)}return this.programManager.run(_,i,h,f,d),oD(e.name),p}upload(e,t){this.gpuDataManager.upload(e,t)}memcpy(e,t){this.gpuDataManager.memcpy(e,t)}async download(e,t){await this.gpuDataManager.download(e,t)}alloc(e){return this.gpuDataManager.create(e).id}free(e){return this.gpuDataManager.release(e)}createKernel(e,t,n,r){let o=Cz.get(e);if(!o)throw new Error("kernel not implemented: ".concat(e));let a={kernelType:e,kernelName:r,kernelEntry:o[0],attributes:[o[1],n]};this.kernels.set(t,a)}releaseKernel(e){let t=this.kernelPersistentData.get(e);if(t){for(let e of t)this.gpuDataManager.release(e.id);this.kernelPersistentData.delete(e)}this.kernelCustomData.delete(e),this.kernels.delete(e)}computeKernel(e,t,n){let r=this.kernels.get(e);if(!r)throw new Error("kernel not created: ".concat(e));let o=r.kernelType,a=r.kernelName,i=r.kernelEntry,s=r.attributes;if(null!==this.currentKernelId)throw new Error('kernel "['.concat(o,"] ").concat(a,'" is not allowed to be called recursively'));this.currentKernelId=e,s[0]&&(s[1]=s[0](s[1]),s[0]=void 0),LS("info",(()=>'[WebGPU] Start to run kernel "['.concat(o,"] ").concat(a,'"...')));let l=this.env.debug;this.temporaryData=[];try{return l&&this.device.pushErrorScope("validation"),i(t,s[1]),0}catch(c){return n.push(Promise.resolve('[WebGPU] Kernel "['.concat(o,"] ").concat(a,'" failed. ').concat(c))),1}finally{l&&n.push(this.device.popErrorScope().then((e=>e?'GPU validation error for kernel "['.concat(o,"] ").concat(a,'": ').concat(e.message):null)));for(let e of this.temporaryData)this.gpuDataManager.release(e.id);this.temporaryData=[],this.currentKernelId=null}}registerBuffer(e,t,n,r){let o=this.sessionExternalDataMapping.get(e);o||(o=new Map,this.sessionExternalDataMapping.set(e,o));let a=o.get(t),i=this.gpuDataManager.registerExternalBuffer(n,r,a);return o.set(t,[i,n]),i}unregisterBuffers(e){let t=this.sessionExternalDataMapping.get(e);t&&(t.forEach((e=>this.gpuDataManager.unregisterExternalBuffer(e[0]))),this.sessionExternalDataMapping.delete(e))}getBuffer(e){let t=this.gpuDataManager.get(e);if(!t)throw new Error("no GPU data for buffer: ".concat(e));return t.buffer}createDownloader(e,t,n){return async()=>{let r=await hE(this,e,t);return KS(r.buffer,n)}}writeTimestamp(e){"inside-passes"===this.queryType&&this.computePassEncoder.writeTimestamp(this.querySet,e)}setQueryType(){var e;this.queryType="none",("default"===(null===(e=this.env.webgpu.profiling)||void 0===e?void 0:e.mode)||(typeof this.env.trace>"u"?this.env.wasm.trace:this.env.trace))&&(this.device.features.has("chromium-experimental-timestamp-query-inside-passes")?this.queryType="inside-passes":this.device.features.has("timestamp-query")&&(this.queryType="at-passes"),"none"!==this.queryType&&typeof this.querySet>"u"&&(this.querySet=this.device.createQuerySet({type:"timestamp",count:2*this.maxDispatchNumber}),this.queryResolveBuffer=this.device.createBuffer({size:2*this.maxDispatchNumber*8,usage:GPUBufferUsage.COPY_SRC|GPUBufferUsage.QUERY_RESOLVE})))}captureBegin(){LS("info","captureBegin"),this.capturedCommandList.get(this.currentSessionId)||this.capturedCommandList.set(this.currentSessionId,[]),this.capturedPendingKernels.get(this.currentSessionId)||this.capturedPendingKernels.set(this.currentSessionId,[]),this.flush(),this.sessionStatus="capturing"}captureEnd(){LS("info","captureEnd"),this.flush(),this.sessionStatus="default"}replay(){LS("info","replay"),this.sessionStatus="replaying";let e=this.capturedCommandList.get(this.currentSessionId),t=this.capturedPendingKernels.get(this.currentSessionId),n=e.length;this.pendingKernels=[];for(let r=0;r<n;r++){let n=this.getComputePassEncoder(),o=e[r];this.writeTimestamp(2*this.pendingDispatchNumber),n.setPipeline(o.computePipeline),n.setBindGroup(0,o.bindGroup),n.dispatchWorkgroups(...o.dispatchGroup),this.writeTimestamp(2*this.pendingDispatchNumber+1),this.pendingDispatchNumber++,"none"!==this.queryType&&this.pendingKernels.push(t[r]),(this.pendingDispatchNumber>=this.maxDispatchNumber||"at-passes"===this.queryType)&&this.endComputePass(),this.pendingDispatchNumber>=this.maxDispatchNumber&&this.flush()}this.flush(),this.sessionStatus="default"}onCreateSession(){this.gpuDataManager.onCreateSession()}onReleaseSession(e){this.unregisterBuffers(e),this.capturedCommandList.has(e)&&this.capturedCommandList.delete(e),this.capturedPendingKernels.has(e)&&this.capturedPendingKernels.delete(e),this.gpuDataManager.onReleaseSession(e)}onRunStart(e){this.currentSessionId=e,this.setQueryType()}}})),$O={};hD($O,{init:()=>QO});var XO,JO,QO,YO,eN,tN,nN,rN,oN,aN,iN,sN,lN,cN,uN,dN,pN,hN,fN,mN,gN,_N,vN,yN,wN,bN,xN,kN,CN,DN,SN,EN,TN,AN,MN,FN,IN,PN=pD((()=>{Iz(),zz(),Oz(),jz(),XO=class e{constructor(e,t,n,r){this.module=e,this.dataType=t,this.data=n,this.dims=r}getFloat32Array(){if(1!==this.dataType)throw new Error("Invalid data type");let e=qS.size(this.dims);return 0===e?new Float32Array:new Float32Array(this.module.HEAP8.buffer,this.data,e)}getBigInt64Array(){if(7!==this.dataType)throw new Error("Invalid data type");let e=qS.size(this.dims);return 0===e?new BigInt64Array:new BigInt64Array(this.module.HEAP8.buffer,this.data,e)}getInt32Array(){if(6!==this.dataType)throw new Error("Invalid data type");let e=qS.size(this.dims);return 0===e?new Int32Array:new Int32Array(this.module.HEAP8.buffer,this.data,e)}getUint16Array(){if(10!==this.dataType&&4!==this.dataType)throw new Error("Invalid data type");let e=qS.size(this.dims);return 0===e?new Uint16Array:new Uint16Array(this.module.HEAP8.buffer,this.data,e)}reshape(t){if(qS.size(t)!==qS.size(this.dims))throw new Error("Invalid new shape");return new e(this.module,this.dataType,this.data,t)}},JO=class{constructor(e,t,n){this.module=e,this.backend=t,this.customDataOffset=0,this.customDataSize=0,this.adapterInfo=t.adapterInfo;let r=e.PTR_SIZE,o=n/e.PTR_SIZE,a=4===r?"i32":"i64";this.opKernelContext=Number(e.getValue(r*o++,a));let i=Number(e.getValue(r*o++,a));this.outputCount=Number(e.getValue(r*o++,a)),this.customDataOffset=Number(e.getValue(r*o++,"*")),this.customDataSize=Number(e.getValue(r*o++,a));let s=[];for(let l=0;l<i;l++){let t=Number(e.getValue(r*o++,a)),n=Number(e.getValue(r*o++,"*")),i=Number(e.getValue(r*o++,a)),l=[];for(let s=0;s<i;s++)l.push(Number(e.getValue(r*o++,a)));s.push(new XO(e,t,n,l))}this.inputs=s}get kernelCustomData(){return this.backend.currentKernelCustomData}get customDataBuffer(){return this.module.HEAPU8.subarray(this.customDataOffset,this.customDataOffset+this.customDataSize)}compute(e,t){var n,r,o;let a=null!==(n=null===t||void 0===t||null===(r=t.inputs)||void 0===r?void 0:r.map((e=>"number"==typeof e?this.inputs[e]:e)))&&void 0!==n?n:this.inputs,i=null!==(o=null===t||void 0===t?void 0:t.outputs)&&void 0!==o?o:[];return this.backend.run(e,a,i,((e,t,n)=>new XO(this.module,t,this.output(e,n),n)),((e,t)=>{let n=SS(e,t);if(!n)throw new Error("Unsupported data type: ".concat(e));let r=n>0?this.backend.gpuDataManager.create(n).id:0;return new XO(this.module,e,r,t)}),this.outputCount)}output(e,t){let n=this.module.stackSave();try{let n=this.module.PTR_SIZE,r=4===n?"i32":"i64",o=this.module.stackAlloc((1+t.length)*n);this.module.setValue(o,t.length,r);for(let e=0;e<t.length;e++)this.module.setValue(o+n*(e+1),t[e],r);return this.module._JsepOutput(this.opKernelContext,e,o)}catch(r){throw new Error("Failed to generate kernel's output[".concat(e,"] with dims [").concat(t,"]. If you are running with pre-allocated output, please make sure the output type/dims are correct. Error: ").concat(r))}finally{this.module.stackRestore(n)}}},QO=async(e,t,n,r)=>{let o=t.jsepInit;if(!o)throw new Error("Failed to initialize JSEP. The WebAssembly module is not built with JSEP support.");if("webgpu"===e){let e=new(0,(ZO(),fD(UO)).WebGpuBackend);await e.initialize(n,r),o("webgpu",[e,t=>e.alloc(Number(t)),t=>e.free(t),function(n,r,o){if(arguments.length>3&&void 0!==arguments[3]&&arguments[3])LS("verbose",(()=>"[WebGPU] jsepCopyGpuToGpu: src=".concat(Number(n),", dst=").concat(Number(r),", size=").concat(Number(o)))),e.memcpy(Number(n),Number(r));else{LS("verbose",(()=>"[WebGPU] jsepCopyCpuToGpu: dataOffset=".concat(Number(n),", gpuDataId=").concat(Number(r),", size=").concat(Number(o))));let a=t.HEAPU8.subarray(Number(n>>>0),Number(n>>>0)+Number(o));e.upload(Number(r),a)}},async(n,r,o)=>{LS("verbose",(()=>"[WebGPU] jsepCopyGpuToCpu: gpuDataId=".concat(n,", dataOffset=").concat(r,", size=").concat(o))),await e.download(Number(n),(()=>t.HEAPU8.subarray(Number(r)>>>0,Number(r+o)>>>0)))},(n,r,o)=>e.createKernel(n,Number(r),o,t.UTF8ToString(t._JsepGetNodeName(Number(r)))),t=>e.releaseKernel(t),(n,r,o,a)=>{LS("verbose",(()=>"[WebGPU] jsepRun: sessionHandle=".concat(o,", kernel=").concat(n,", contextDataOffset=").concat(r)));let i=new JO(t,e,Number(r));return e.computeKernel(Number(n),i,a)},()=>e.captureBegin(),()=>e.captureEnd(),()=>e.replay()])}else{let e=new iE(n);o("webnn",[e,()=>e.reserveTensorId(),t=>e.releaseTensorId(t),async(t,n,r,o,a)=>e.ensureTensor(t,n,r,o,a),(t,n)=>{e.uploadTensor(t,n)},async(t,n)=>e.downloadTensor(t,n)])}}})),zN=pD((()=>{Mz(),Fz(),Iz(),Tz(),Az(),Pz(),YO=(e,t)=>{0!==hS()._OrtInit(e,t)&&gS("Can't initialize onnxruntime.")},eN=async e=>{YO(e.wasm.numThreads,TS(e.logLevel))},tN=async(e,t)=>{var n,r;null===(n=(r=hS()).asyncInit)||void 0===n||n.call(r);{let n=(PN(),fD($O)).init;if("webgpu"===t){if(typeof navigator>"u"||!navigator.gpu)throw new Error("WebGPU is not supported in current environment");let t=e.webgpu.adapter;if(t){if("object"!=typeof t.limits||"object"!=typeof t.features||"function"!=typeof t.requestDevice)throw new Error("Invalid GPU adapter set in `env.webgpu.adapter`. It must be a GPUAdapter object.")}else{let n=e.webgpu.powerPreference;if(void 0!==n&&"low-power"!==n&&"high-performance"!==n)throw new Error('Invalid powerPreference setting: "'.concat(n,'"'));let r=e.webgpu.forceFallbackAdapter;if(void 0!==r&&"boolean"!=typeof r)throw new Error('Invalid forceFallbackAdapter setting: "'.concat(r,'"'));if(t=await navigator.gpu.requestAdapter({powerPreference:n,forceFallbackAdapter:r}),!t)throw new Error('Failed to get GPU adapter. You may need to enable flag "--enable-unsafe-webgpu" if you are using Chrome.')}await n("webgpu",hS(),e,t)}if("webnn"===t){if(typeof navigator>"u"||!navigator.ml)throw new Error("WebNN is not supported in current environment");await n("webnn",hS(),e)}}},nN=new Map,rN=e=>{let t=hS(),n=t.stackSave();try{let n=t.PTR_SIZE,r=t.stackAlloc(2*n);0!==t._OrtGetInputOutputCount(e,r,r+n)&&gS("Can't get session input/output count.");let o=4===n?"i32":"i64";return[Number(t.getValue(r,o)),Number(t.getValue(r+n,o))]}finally{t.stackRestore(n)}},oN=(e,t)=>{let n=hS(),r=n.stackSave(),o=0;try{let r=n.PTR_SIZE,a=n.stackAlloc(2*r);0!==n._OrtGetInputOutputMetadata(e,t,a,a+r)&&gS("Can't get session input/output metadata.");let i=Number(n.getValue(a,"*"));o=Number(n.getValue(a+r,"*"));let s=n.HEAP32[o/4];if(0===s)return[i,0];let l=n.HEAPU32[o/4+1],c=[];for(let e=0;e<l;e++){let t=Number(n.getValue(o+8+e*r,"*"));c.push(0!==t?n.UTF8ToString(t):Number(n.getValue(o+8+(e+l)*r,"*")))}return[i,s,c]}finally{n.stackRestore(r),0!==o&&n._OrtFree(o)}},aN=e=>{let t=hS(),n=t._malloc(e.byteLength);if(0===n)throw new Error("Can't create a session. failed to allocate a buffer of size ".concat(e.byteLength,"."));return t.HEAPU8.set(e,n),[n,e.byteLength]},iN=async(e,t)=>{let n,r,o=hS();Array.isArray(e)?[n,r]=e:e.buffer===o.HEAPU8.buffer?[n,r]=[e.byteOffset,e.byteLength]:[n,r]=aN(e);let a=0,i=0,s=0,l=[],c=[],u=[];try{var d,p;if([i,l]=await kS(t),null!==t&&void 0!==t&&t.externalData&&o.mountExternalData){let e=[];for(let n of t.externalData){let t="string"==typeof n?n:n.path;e.push(IS("string"==typeof n?n:n.data).then((e=>{o.mountExternalData(t,e)})))}await Promise.all(e)}for(let n of null!==(h=null===t||void 0===t?void 0:t.executionProviders)&&void 0!==h?h:[]){var h;if("webnn"===("string"==typeof n?n:n.name)){if(o.shouldTransferToMLTensor=!1,"string"!=typeof n){let e=n,t=null===e||void 0===e?void 0:e.context,r=null===e||void 0===e?void 0:e.gpuDevice,a=null===e||void 0===e?void 0:e.deviceType,i=null===e||void 0===e?void 0:e.powerPreference;o.currentContext=t||(r?await o.webnnCreateMLContext(r):await o.webnnCreateMLContext({deviceType:a,powerPreference:i}))}else o.currentContext=await o.webnnCreateMLContext();break}}a=await o._OrtCreateSession(n,r,i),null!==(d=o.webgpuOnCreateSession)&&void 0!==d&&d.call(o,a),0===a&&gS("Can't create a session."),null!==(p=o.jsepOnCreateSession)&&void 0!==p&&p.call(o),o.currentContext&&(o.webnnRegisterMLContext(a,o.currentContext),o.currentContext=void 0,o.shouldTransferToMLTensor=!0);let[e,g]=rN(a),_=!(null===t||void 0===t||!t.enableGraphCapture),v=[],y=[],w=[],b=[],x=[];for(let t=0;t<e;t++){let[e,n,r]=oN(a,t);0===e&&gS("Can't get an input name."),c.push(e);let i=o.UTF8ToString(e);v.push(i),w.push(0===n?{name:i,isTensor:!1}:{name:i,isTensor:!0,type:DS(n),shape:r})}for(let n=0;n<g;n++){let[r,i,s]=oN(a,n+e);0===r&&gS("Can't get an output name."),u.push(r);let l=o.UTF8ToString(r);y.push(l),b.push(0===i?{name:l,isTensor:!1}:{name:l,isTensor:!0,type:DS(i),shape:s});{var f,m;if(_&&void 0===(null===t||void 0===t?void 0:t.preferredOutputLocation)){x.push("gpu-buffer");continue}let e="string"==typeof(null===t||void 0===t?void 0:t.preferredOutputLocation)?t.preferredOutputLocation:null!==(f=null===t||void 0===t||null===(m=t.preferredOutputLocation)||void 0===m?void 0:m[l])&&void 0!==f?f:"cpu";if("cpu"!==e&&"cpu-pinned"!==e&&"gpu-buffer"!==e&&"ml-tensor"!==e)throw new Error("Not supported preferred output location: ".concat(e,"."));if(_&&"gpu-buffer"!==e)throw new Error("Not supported preferred output location: ".concat(e,". Only 'gpu-buffer' location is supported when enableGraphCapture is true."));x.push(e)}}let k=null;return x.some((e=>"gpu-buffer"===e||"ml-tensor"===e))&&(s=o._OrtCreateBinding(a),0===s&&gS("Can't create IO binding."),k={handle:s,outputPreferredLocations:x,outputPreferredLocationsEncoded:x.map((e=>FS(e)))}),nN.set(a,[a,c,u,k,_,!1]),[a,v,y,w,b]}catch(js){throw c.forEach((e=>o._OrtFree(e))),u.forEach((e=>o._OrtFree(e))),0!==s&&0!==o._OrtReleaseBinding(s)&&gS("Can't release IO binding."),0!==a&&0!==o._OrtReleaseSession(a)&&gS("Can't release session."),js}finally{var g;o._free(n),0!==i&&0!==o._OrtReleaseSessionOptions(i)&&gS("Can't release session options."),l.forEach((e=>o._free(e))),null===(g=o.unmountExternalData)||void 0===g||g.call(o)}},sN=e=>{var t,n,r;let o=hS(),a=nN.get(e);if(!a)throw new Error("cannot release session. invalid session id: ".concat(e));let[i,s,l,c,u]=a;c&&(u&&0!==o._OrtClearBoundOutputs(c.handle)&&gS("Can't clear bound outputs."),0!==o._OrtReleaseBinding(c.handle)&&gS("Can't release IO binding.")),null!==(t=o.jsepOnReleaseSession)&&void 0!==t&&t.call(o,e),null!==(n=o.webnnOnReleaseSession)&&void 0!==n&&n.call(o,e),null!==(r=o.webgpuOnReleaseSession)&&void 0!==r&&r.call(o,e),s.forEach((e=>o._OrtFree(e))),l.forEach((e=>o._OrtFree(e))),0!==o._OrtReleaseSession(i)&&gS("Can't release session."),nN.delete(e)},lN=async function(e,t,n,r,o,a){let i=arguments.length>6&&void 0!==arguments[6]&&arguments[6];if(!e)return void t.push(0);let s,l,c=hS(),u=c.PTR_SIZE,d=e[0],p=e[1],h=e[3],f=h;if("string"===d&&("gpu-buffer"===h||"ml-tensor"===h))throw new Error("String tensor is not supported on GPU.");if(i&&"gpu-buffer"!==h)throw new Error("External buffer must be provided for input/output index ".concat(a," when enableGraphCapture is true."));if("gpu-buffer"===h){let t=e[2].gpuBuffer;l=SS(CS(d),p);{let e=c.jsepRegisterBuffer;if(!e)throw new Error('Tensor location "gpu-buffer" is not supported without using WebGPU.');s=e(r,a,t,l)}}else if("ml-tensor"===h){let t=e[2].mlTensor;l=SS(CS(d),p);let n=c.webnnRegisterMLTensor;if(!n)throw new Error('Tensor location "ml-tensor" is not supported without using WebNN.');s=n(r,t,CS(d),p)}else{let t=e[2];if(Array.isArray(t)){l=u*t.length,s=c._malloc(l),n.push(s);for(let e=0;e<t.length;e++){if("string"!=typeof t[e])throw new TypeError("tensor data at index ".concat(e," is not a string"));c.setValue(s+e*u,fS(t[e],n),"*")}}else{let e=c.webnnIsGraphInput;if("string"!==d&&e){if(e(r,c.UTF8ToString(o))){let e=CS(d);l=SS(e,p),f="ml-tensor";let n=c.webnnCreateTemporaryTensor,o=c.webnnUploadTensor;if(!n||!o)throw new Error('Tensor location "ml-tensor" is not supported without using WebNN.');let a=await n(r,e,p);o(a,new Uint8Array(t.buffer,t.byteOffset,t.byteLength)),s=a}else l=t.byteLength,s=c._malloc(l),n.push(s),c.HEAPU8.set(new Uint8Array(t.buffer,t.byteOffset,l),s)}else l=t.byteLength,s=c._malloc(l),n.push(s),c.HEAPU8.set(new Uint8Array(t.buffer,t.byteOffset,l),s)}}let m=c.stackSave(),g=c.stackAlloc(4*p.length);try{p.forEach(((e,t)=>c.setValue(g+t*u,e,4===u?"i32":"i64")));let e=c._OrtCreateTensor(CS(d),s,l,g,p.length,FS(f));0===e&&gS("Can't create tensor for input/output. session=".concat(r,", index=").concat(a,".")),t.push(e)}finally{c.stackRestore(m)}},cN=async(e,t,n,r,o,a)=>{let i=hS(),s=i.PTR_SIZE,l=nN.get(e);if(!l)throw new Error("cannot run inference. invalid session id: ".concat(e));let c=l[0],u=l[1],d=l[2],p=l[3],h=l[4],f=l[5],m=t.length,g=r.length,_=0,v=[],y=[],w=[],b=[],x=i.stackSave(),k=i.stackAlloc(m*s),C=i.stackAlloc(m*s),D=i.stackAlloc(g*s),S=i.stackAlloc(g*s);try{var E,T;[_,v]=_S(a);for(let r=0;r<m;r++)await lN(n[r],y,b,e,u[t[r]],t[r],h);for(let t=0;t<g;t++)await lN(o[t],w,b,e,d[r[t]],m+r[t],h);for(let e=0;e<m;e++)i.setValue(k+e*s,y[e],"*"),i.setValue(C+e*s,u[t[e]],"*");for(let e=0;e<g;e++)i.setValue(D+e*s,w[e],"*"),i.setValue(S+e*s,d[r[e]],"*");if(p&&!f){let{handle:n,outputPreferredLocations:a,outputPreferredLocationsEncoded:s}=p;if(u.length!==m)throw new Error("input count from feeds (".concat(m,") is expected to be always equal to model's input count (").concat(u.length,")."));for(let r=0;r<m;r++){let o=t[r];0!==await i._OrtBindInput(n,u[o],y[r])&&gS("Can't bind input[".concat(r,"] for session=").concat(e,"."))}for(let t=0;t<g;t++){var A;let l=r[t];null!==(A=o[t])&&void 0!==A&&A[3]?0!==i._OrtBindOutput(n,d[l],w[t],0)&&gS("Can't bind pre-allocated output[".concat(t,"] for session=").concat(e,".")):0!==i._OrtBindOutput(n,d[l],0,s[l])&&gS("Can't bind output[".concat(t,"] to ").concat(a[t]," for session=").concat(e,"."))}nN.set(e,[c,u,d,p,h,!0])}let l;null!==(E=i.jsepOnRunStart)&&void 0!==E&&E.call(i,c),null===(T=i.webnnOnRunStart)||void 0===T||T.call(i,c),l=p?await i._OrtRunWithBinding(c,p.handle,g,D,_):await i._OrtRun(c,C,k,m,S,g,D,_),0!==l&&gS("failed to call OrtRun().");let x=[];for(let t=0;t<g;t++){let n=Number(i.getValue(D+t*s,"*"));if(n===w[t]){x.push(o[t]);continue}let a,l=i.stackSave(),u=i.stackAlloc(4*s),d=!1,h=0;try{0!==i._OrtGetTensorData(n,u,u+s,u+2*s,u+3*s)&&gS("Can't access output tensor data on index ".concat(t,"."));let o=4===s?"i32":"i64",l=Number(i.getValue(u,o));h=i.getValue(u+s,"*");let c=i.getValue(u+2*s,"*"),f=Number(i.getValue(u+3*s,o)),m=[];for(let e=0;e<f;e++)m.push(Number(i.getValue(c+e*s,o)));0!==i._OrtFree(c)&&gS("Can't free memory for tensor dims.");let g=m.reduce(((e,t)=>e*t),1);a=DS(l);let _=null===p||void 0===p?void 0:p.outputPreferredLocations[r[t]];if("string"===a){if("gpu-buffer"===_||"ml-tensor"===_)throw new Error("String tensor is not supported on GPU.");let e=[];for(let t=0;t<g;t++){let n=i.getValue(h+t*s,"*"),r=i.getValue(h+(t+1)*s,"*"),o=t===g-1?void 0:r-n;e.push(i.UTF8ToString(n,o))}x.push([a,m,e,"cpu"])}else if("gpu-buffer"===_&&g>0){let e=i.jsepGetBuffer;if(!e)throw new Error('preferredLocation "gpu-buffer" is not supported without using WebGPU.');let t=e(h),r=SS(l,g);if(void 0===r||!AS(a))throw new Error("Unsupported data type: ".concat(a));d=!0,x.push([a,m,{gpuBuffer:t,download:i.jsepCreateDownloader(t,r,a),dispose:()=>{0!==i._OrtReleaseTensor(n)&&gS("Can't release tensor.")}},"gpu-buffer"])}else if("ml-tensor"===_&&g>0){let t=i.webnnEnsureTensor,r=i.webnnIsInt64Supported;if(!t||!r)throw new Error('preferredLocation "ml-tensor" is not supported without using WebNN.');if(void 0===SS(l,g)||!MS(a))throw new Error("Unsupported data type: ".concat(a));if("int64"===a&&!r(e))throw new Error('preferredLocation "ml-tensor" for int64 output is not supported by current WebNN Context.');let o=await t(e,h,l,m,!1);d=!0,x.push([a,m,{mlTensor:o,download:i.webnnCreateMLTensorDownloader(h,a),dispose:()=>{i.webnnReleaseTensorId(h),i._OrtReleaseTensor(n)}},"ml-tensor"])}else{let e=new(ES(a))(g);new Uint8Array(e.buffer,e.byteOffset,e.byteLength).set(i.HEAPU8.subarray(h,h+e.byteLength)),x.push([a,m,e,"cpu"])}}finally{var M;i.stackRestore(l),"string"===a&&h&&i._free(h),d||i._OrtReleaseTensor(n),null===(M=i.webnnOnRunEnd)||void 0===M||M.call(i,c)}}return p&&!h&&(0!==i._OrtClearBoundOutputs(p.handle)&&gS("Can't clear bound outputs."),nN.set(e,[c,u,d,p,h,!1])),x}finally{i.stackRestore(x),y.forEach((e=>i._OrtReleaseTensor(e))),w.forEach((e=>i._OrtReleaseTensor(e))),b.forEach((e=>i._free(e))),0!==_&&i._OrtReleaseRunOptions(_),v.forEach((e=>i._free(e)))}},uN=e=>{let t=hS(),n=nN.get(e);if(!n)throw new Error("invalid session id");let r=n[0],o=t._OrtEndProfiling(r);0===o&&gS("Can't get an profile file name."),t._OrtFree(o)},dN=e=>{let t=[];for(let n of e){let e=n[2];!Array.isArray(e)&&"buffer"in e&&t.push(e.buffer)}return t}})),ON=pD((()=>{zD(),zN(),Tz(),Ez(),pN=()=>!!jC.wasm.proxy&&typeof document<"u",fN=!1,mN=!1,gN=!1,yN=new Map,wN=(e,t)=>{let n=yN.get(e);n?n.push(t):yN.set(e,[t])},bN=()=>{if(fN||!mN||gN||!hN)throw new Error("worker not ready")},xN=e=>{switch(e.data.type){case"init-wasm":fN=!1,e.data.err?(gN=!0,vN[1](e.data.err)):(mN=!0,vN[0]()),_N&&(URL.revokeObjectURL(_N),_N=void 0);break;case"init-ep":case"copy-from":case"create":case"release":case"run":case"end-profiling":{let t=yN.get(e.data.type);e.data.err?t.shift()[1](e.data.err):t.shift()[0](e.data.out);break}}},kN=async()=>{if(!mN){if(fN)throw new Error("multiple calls to 'initWasm()' detected.");if(gN)throw new Error("previous call to 'initWasm()' failed.");if(fN=!0,pN())return new Promise(((e,t)=>{var r;null!==(r=hN)&&void 0!==r&&r.terminate(),nS().then((r=>{let[o,a]=r;try{(hN=a).onerror=e=>t(e),hN.onmessage=xN,vN=[e,t];let r={type:"init-wasm",in:jC};!r.in.wasm.wasmPaths&&(o||HD)&&(r.in.wasm.wasmPaths={wasm:new URL(n(98),n.b).href}),hN.postMessage(r),_N=o}catch(i){t(i)}}),t)}));try{await pS(jC.wasm),await eN(jC),mN=!0}catch(AC){throw gN=!0,AC}finally{fN=!1}}},CN=async e=>{if(pN())return bN(),new Promise(((t,n)=>{wN("init-ep",[t,n]);let r={type:"init-ep",in:{epName:e,env:jC}};hN.postMessage(r)}));await tN(jC,e)},DN=async e=>pN()?(bN(),new Promise(((t,n)=>{wN("copy-from",[t,n]);let r={type:"copy-from",in:{buffer:e}};hN.postMessage(r,[e.buffer])}))):aN(e),SN=async(e,t)=>{if(pN()){if(null!==t&&void 0!==t&&t.preferredOutputLocation)throw new Error('session option "preferredOutputLocation" is not supported for proxy.');return bN(),new Promise(((n,r)=>{wN("create",[n,r]);let o={type:"create",in:{model:e,options:so({},t)}},a=[];e instanceof Uint8Array&&a.push(e.buffer),hN.postMessage(o,a)}))}return iN(e,t)},EN=async e=>{if(pN())return bN(),new Promise(((t,n)=>{wN("release",[t,n]);let r={type:"release",in:e};hN.postMessage(r)}));sN(e)},TN=async(e,t,n,r,o,a)=>{if(pN()){if(n.some((e=>"cpu"!==e[3])))throw new Error("input tensor on GPU is not supported for proxy.");if(o.some((e=>e)))throw new Error("pre-allocated output tensor is not supported for proxy.");return bN(),new Promise(((o,i)=>{wN("run",[o,i]);let s=n,l={type:"run",in:{sessionId:e,inputIndices:t,inputs:s,outputIndices:r,options:a}};hN.postMessage(l,dN(s))}))}return cN(e,t,n,r,o,a)},AN=async e=>{if(pN())return bN(),new Promise(((t,n)=>{wN("end-profiling",[t,n]);let r={type:"end-profiling",in:e};hN.postMessage(r)}));uN(e)}})),NN=pD((()=>{zD(),ON(),Iz(),OD(),Pz(),MN=(e,t)=>{switch(e.location){case"cpu":return[e.type,e.dims,e.data,"cpu"];case"gpu-buffer":return[e.type,e.dims,{gpuBuffer:e.gpuBuffer},"gpu-buffer"];case"ml-tensor":return[e.type,e.dims,{mlTensor:e.mlTensor},"ml-tensor"];default:throw new Error("invalid data location: ".concat(e.location," for ").concat(t()))}},FN=e=>{switch(e[3]){case"cpu":return new eD(e[0],e[2],e[1]);case"gpu-buffer":{let t=e[0];if(!AS(t))throw new Error("not supported data type: ".concat(t," for deserializing GPU tensor"));let{gpuBuffer:n,download:r,dispose:o}=e[2];return eD.fromGpuBuffer(n,{dataType:t,dims:e[1],download:r,dispose:o})}case"ml-tensor":{let t=e[0];if(!MS(t))throw new Error("not supported data type: ".concat(t," for deserializing MLTensor tensor"));let{mlTensor:n,download:r,dispose:o}=e[2];return eD.fromMLTensor(n,{dataType:t,dims:e[1],download:r,dispose:o})}default:throw new Error("invalid data location: ".concat(e[3]))}},IN=class{async fetchModelAndCopyToWasmMemory(e){return DN(await IS(e))}async loadModel(e,t){let n;rD(),n="string"==typeof e?await this.fetchModelAndCopyToWasmMemory(e):e,[this.sessionId,this.inputNames,this.outputNames,this.inputMetadata,this.outputMetadata]=await SN(n,t),oD()}async dispose(){return EN(this.sessionId)}async run(e,t,n){rD();let r=[],o=[];Object.entries(e).forEach((e=>{let t=e[0],n=e[1],a=this.inputNames.indexOf(t);if(-1===a)throw new Error("invalid input '".concat(t,"'"));r.push(n),o.push(a)}));let a=[],i=[];Object.entries(t).forEach((e=>{let t=e[0],n=e[1],r=this.outputNames.indexOf(t);if(-1===r)throw new Error("invalid output '".concat(t,"'"));a.push(n),i.push(r)}));let s=r.map(((e,t)=>MN(e,(()=>'input "'.concat(this.inputNames[o[t]],'"'))))),l=a.map(((e,t)=>e?MN(e,(()=>'output "'.concat(this.outputNames[i[t]],'"'))):null)),c=await TN(this.sessionId,o,s,i,l,n),u={};for(let p=0;p<c.length;p++){var d;u[this.outputNames[i[p]]]=null!==(d=a[p])&&void 0!==d?d:FN(c[p])}return oD(),u}startProfiling(){}endProfiling(){AN(this.sessionId)}}})),BN={};hD(BN,{OnnxruntimeWebAssemblyBackend:()=>LN,initializeFlags:()=>jN,wasmBackend:()=>RN});var jN,LN,RN,VN=pD((()=>{zD(),ON(),NN(),jN=()=>{("number"!=typeof jC.wasm.initTimeout||jC.wasm.initTimeout<0)&&(jC.wasm.initTimeout=0);let e=jC.wasm.simd;if("boolean"!=typeof e&&void 0!==e&&"fixed"!==e&&"relaxed"!==e&&(console.warn('Property "env.wasm.simd" is set to unknown value "'.concat(e,'". Reset it to `false` and ignore SIMD feature checking.')),jC.wasm.simd=!1),"boolean"!=typeof jC.wasm.proxy&&(jC.wasm.proxy=!1),"boolean"!=typeof jC.wasm.trace&&(jC.wasm.trace=!1),"number"!=typeof jC.wasm.numThreads||!Number.isInteger(jC.wasm.numThreads)||jC.wasm.numThreads<=0)if(typeof self<"u"&&!self.crossOriginIsolated)jC.wasm.numThreads=1;else{let e=typeof navigator>"u"?dD("node:os").cpus().length:navigator.hardwareConcurrency;jC.wasm.numThreads=Math.min(4,Math.ceil((e||1)/2))}},LN=class{async init(e){jN(),await kN(),await CN(e)}async createInferenceSessionHandler(e,t){let n=new IN;return await n.loadModel(e,t),n}},RN=new LN}));zD(),zD(),zD();var qN=PD;{let e=(VN(),fD(BN)).wasmBackend;IC("webgpu",e,5),IC("webnn",e,5),IC("cpu",e,10),IC("wasm",e,10)}Object.defineProperty(jC.versions,"web",{value:"1.22.0-dev.20250409-89f8206ba4",enumerable:!0});const UN=["skip_prompt","callback_function","token_callback_function","skip_special_tokens","decode_kwargs"],WN=["encoder_outputs","input_ids","decoder_input_ids"],GN=["past_key_values"],HN=["encode_function","merge_function","modality_input_name","modality_output_name","input_ids","attention_mask","position_ids","inputs_embeds","past_key_values","generation_config","logits_processor"],KN=["input_ids","pixel_values","attention_mask"],ZN=["decoder_input_ids"],$N=["inputs","generation_config","logits_processor","stopping_criteria","streamer"],XN=["inputs","generation_config","logits_processor","stopping_criteria"],JN=["input_ids","attention_mask","pixel_values","image_sizes","position_ids","inputs_embeds","past_key_values","generation_config","logits_processor"],QN=["logits"],YN=["resize_mode","fill_color","interpolation","size"],eB=["tools","documents","chat_template","add_generation_prompt","tokenize","padding","truncation","max_length","return_tensor","return_dict","tokenizer_kwargs"];e={"onnxruntime-common":e=>{e.exports=r},"onnxruntime-web":e=>{e.exports=o},"?2ce3":()=>{},"?7a2c":()=>{},"?a42a":()=>{},"?2b25":()=>{},"?569f":()=>{},"?3f59":()=>{},"?154a":()=>{},"./node_modules/@huggingface/jinja/dist/index.js":(e,t,n)=>{n.r(t),n.d(t,{Environment:()=>te,Interpreter:()=>ne,Template:()=>ue,parse:()=>j,tokenize:()=>u});var r=Object.freeze({Text:"Text",NumericLiteral:"NumericLiteral",BooleanLiteral:"BooleanLiteral",NullLiteral:"NullLiteral",StringLiteral:"StringLiteral",Identifier:"Identifier",Equals:"Equals",OpenParen:"OpenParen",CloseParen:"CloseParen",OpenStatement:"OpenStatement",CloseStatement:"CloseStatement",OpenExpression:"OpenExpression",CloseExpression:"CloseExpression",OpenSquareBracket:"OpenSquareBracket",CloseSquareBracket:"CloseSquareBracket",OpenCurlyBracket:"OpenCurlyBracket",CloseCurlyBracket:"CloseCurlyBracket",Comma:"Comma",Dot:"Dot",Colon:"Colon",Pipe:"Pipe",CallOperator:"CallOperator",AdditiveBinaryOperator:"AdditiveBinaryOperator",MultiplicativeBinaryOperator:"MultiplicativeBinaryOperator",ComparisonBinaryOperator:"ComparisonBinaryOperator",UnaryOperator:"UnaryOperator",Set:"Set",If:"If",For:"For",In:"In",Is:"Is",NotIn:"NotIn",Else:"Else",EndSet:"EndSet",EndIf:"EndIf",ElseIf:"ElseIf",EndFor:"EndFor",And:"And",Or:"Or",Not:"UnaryOperator",Macro:"Macro",EndMacro:"EndMacro",Break:"Break",Continue:"Continue"}),o=Object.freeze({set:r.Set,for:r.For,in:r.In,is:r.Is,if:r.If,else:r.Else,endset:r.EndSet,endif:r.EndIf,elif:r.ElseIf,endfor:r.EndFor,and:r.And,or:r.Or,not:r.Not,"not in":r.NotIn,macro:r.Macro,endmacro:r.EndMacro,break:r.Break,continue:r.Continue,true:r.BooleanLiteral,false:r.BooleanLiteral,none:r.NullLiteral,True:r.BooleanLiteral,False:r.BooleanLiteral,None:r.NullLiteral}),a=class{constructor(e,t){this.value=e,this.type=t}};function i(e){return/\w/.test(e)}function s(e){return/[0-9]/.test(e)}var l=[["{%",r.OpenStatement],["%}",r.CloseStatement],["{{",r.OpenExpression],["}}",r.CloseExpression],["(",r.OpenParen],[")",r.CloseParen],["{",r.OpenCurlyBracket],["}",r.CloseCurlyBracket],["[",r.OpenSquareBracket],["]",r.CloseSquareBracket],[",",r.Comma],[".",r.Dot],[":",r.Colon],["|",r.Pipe],["<=",r.ComparisonBinaryOperator],[">=",r.ComparisonBinaryOperator],["==",r.ComparisonBinaryOperator],["!=",r.ComparisonBinaryOperator],["<",r.ComparisonBinaryOperator],[">",r.ComparisonBinaryOperator],["+",r.AdditiveBinaryOperator],["-",r.AdditiveBinaryOperator],["*",r.MultiplicativeBinaryOperator],["/",r.MultiplicativeBinaryOperator],["%",r.MultiplicativeBinaryOperator],["=",r.Equals]],c=new Map([["n","\n"],["t","\t"],["r","\r"],["b","\b"],["f","\f"],["v","\v"],["'","'"],['"','"'],["\\","\\"]]);function u(e){const t=[],n=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e.endsWith("\n")&&(e=e.slice(0,-1)),e=e.replace(/{#[^]*?#}/g,"{##}"),t.lstrip_blocks&&(e=e.replace(/^[ \t]*({[#%])/gm,"$1")),t.trim_blocks&&(e=e.replace(/([#%]})\n/g,"$1")),e.replace(/{##}/g,"").replace(/-%}\s*/g,"%}").replace(/\s*{%-/g,"{%").replace(/-}}\s*/g,"}}").replace(/\s*{{-/g,"{{")}(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{});let u=0;const d=e=>{let t="";for(;e(n[u]);)if("\\"!==n[u]){if(t+=n[u++],u>=n.length)throw new SyntaxError("Unexpected end of input")}else{if(++u,u>=n.length)throw new SyntaxError("Unexpected end of input");const e=n[u++],r=c.get(e);if(void 0===r)throw new SyntaxError("Unexpected escaped character: ".concat(e));t+=r}return t};e:for(;u<n.length;){var p;const e=null===(p=t.at(-1))||void 0===p?void 0:p.type;if(void 0===e||e===r.CloseStatement||e===r.CloseExpression){let e="";for(;u<n.length&&("{"!==n[u]||"%"!==n[u+1]&&"{"!==n[u+1]);)e+=n[u++];if(e.length>0){t.push(new a(e,r.Text));continue}}d((e=>/\s/.test(e)));const c=n[u];if("-"===c||"+"===c){var h;const e=null===(h=t.at(-1))||void 0===h?void 0:h.type;if(e===r.Text||void 0===e)throw new SyntaxError("Unexpected character: ".concat(c));switch(e){case r.Identifier:case r.NumericLiteral:case r.BooleanLiteral:case r.NullLiteral:case r.StringLiteral:case r.CloseParen:case r.CloseSquareBracket:break;default:{++u;const e=d(s);t.push(new a("".concat(c).concat(e),e.length>0?r.NumericLiteral:r.UnaryOperator));continue}}}for(const[r,o]of l){if(n.slice(u,u+r.length)===r){t.push(new a(r,o)),u+=r.length;continue e}}if("'"!==c&&'"'!==c)if(s(c)){const e=d(s);t.push(new a(e,r.NumericLiteral))}else{if(!i(c))throw new SyntaxError("Unexpected character: ".concat(c));{var f;const e=d(i),n=Object.hasOwn(o,e)?o[e]:r.Identifier;n===r.In&&(null===(f=t.at(-1))||void 0===f?void 0:f.type)===r.Not?(t.pop(),t.push(new a("not in",r.NotIn))):t.push(new a(e,n))}}else{++u;const e=d((e=>e!==c));t.push(new a(e,r.StringLiteral)),++u}}return t}var d=class{constructor(){ao(this,"type","Statement")}},p=class extends d{constructor(e){super(),ao(this,"type","Program"),this.body=e}},h=class extends d{constructor(e,t,n){super(),ao(this,"type","If"),this.test=e,this.body=t,this.alternate=n}},f=class extends d{constructor(e,t,n,r){super(),ao(this,"type","For"),this.loopvar=e,this.iterable=t,this.body=n,this.defaultBlock=r}},m=class extends d{constructor(){super(...arguments),ao(this,"type","Break")}},g=class extends d{constructor(){super(...arguments),ao(this,"type","Continue")}},_=class extends d{constructor(e,t,n){super(),ao(this,"type","Set"),this.assignee=e,this.value=t,this.body=n}},v=class extends d{constructor(e,t,n){super(),ao(this,"type","Macro"),this.name=e,this.args=t,this.body=n}},y=class extends d{constructor(){super(...arguments),ao(this,"type","Expression")}},w=class extends y{constructor(e,t,n){super(),ao(this,"type","MemberExpression"),this.object=e,this.property=t,this.computed=n}},b=class extends y{constructor(e,t){super(),ao(this,"type","CallExpression"),this.callee=e,this.args=t}},x=class extends y{constructor(e){super(),ao(this,"type","Identifier"),this.value=e}},k=class extends y{constructor(e){super(),ao(this,"type","Literal"),this.value=e}},C=class extends k{constructor(){super(...arguments),ao(this,"type","NumericLiteral")}},D=class extends k{constructor(){super(...arguments),ao(this,"type","StringLiteral")}},S=class extends k{constructor(){super(...arguments),ao(this,"type","BooleanLiteral")}},E=class extends k{constructor(){super(...arguments),ao(this,"type","NullLiteral")}},T=class extends k{constructor(){super(...arguments),ao(this,"type","ArrayLiteral")}},A=class extends k{constructor(){super(...arguments),ao(this,"type","TupleLiteral")}},M=class extends k{constructor(){super(...arguments),ao(this,"type","ObjectLiteral")}},F=class extends y{constructor(e,t,n){super(),ao(this,"type","BinaryExpression"),this.operator=e,this.left=t,this.right=n}},I=class extends y{constructor(e,t){super(),ao(this,"type","FilterExpression"),this.operand=e,this.filter=t}},P=class extends y{constructor(e,t){super(),ao(this,"type","SelectExpression"),this.iterable=e,this.test=t}},z=class extends y{constructor(e,t,n){super(),ao(this,"type","TestExpression"),this.operand=e,this.negate=t,this.test=n}},O=class extends y{constructor(e,t){super(),ao(this,"type","UnaryExpression"),this.operator=e,this.argument=t}},N=class extends y{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;super(),ao(this,"type","SliceExpression"),this.start=e,this.stop=t,this.step=n}},B=class extends y{constructor(e,t){super(),ao(this,"type","KeywordArgumentExpression"),this.key=e,this.value=t}};function j(e){const t=new p([]);let n=0;function o(t,r){const o=e[n++];if(!o||o.type!==t)throw new Error("Parser Error: ".concat(r,". ").concat(o.type," !== ").concat(t,"."));return o}function a(){switch(e[n].type){case r.Text:return new D(o(r.Text,"Expected text token").value);case r.OpenStatement:return function(){let t;switch(o(r.OpenStatement,"Expected opening statement token"),e[n].type){case r.Set:++n,t=function(){const t=u();if(s(r.Equals)){++n;const e=u();return new _(t,e,[])}{const s=[];for(o(r.CloseStatement,"Expected %} token");(null===(i=e[n])||void 0===i?void 0:i.type)!==r.OpenStatement||(null===(l=e[n+1])||void 0===l?void 0:l.type)!==r.EndSet;){var i,l;const e=a();s.push(e)}return o(r.OpenStatement,"Expected {% token"),o(r.EndSet,"Expected endset token"),new _(t,null,s)}}(),o(r.CloseStatement,"Expected closing statement token");break;case r.If:++n,t=l(),o(r.OpenStatement,"Expected {% token"),o(r.EndIf,"Expected endif token"),o(r.CloseStatement,"Expected %} token");break;case r.Macro:++n,t=function(){const e=G();if("Identifier"!==e.type)throw new SyntaxError("Expected identifier following macro statement");const t=R();o(r.CloseStatement,"Expected closing statement token");const n=[];for(;i(r.OpenStatement,r.EndMacro);)n.push(a());return new v(e,t,n)}(),o(r.OpenStatement,"Expected {% token"),o(r.EndMacro,"Expected endmacro token"),o(r.CloseStatement,"Expected %} token");break;case r.For:++n,t=function(){const e=c(!0);if(!(e instanceof x||e instanceof A))throw new SyntaxError("Expected identifier/tuple for the loop variable, got ".concat(e.type," instead"));o(r.In,"Expected `in` keyword following loop variable");const t=u();o(r.CloseStatement,"Expected closing statement token");const l=[];for(;i(r.OpenStatement,r.EndFor)&&i(r.OpenStatement,r.Else);)l.push(a());const d=[];if(s(r.OpenStatement,r.Else))for(++n,++n,o(r.CloseStatement,"Expected closing statement token");i(r.OpenStatement,r.EndFor);)d.push(a());return new f(e,t,l,d)}(),o(r.OpenStatement,"Expected {% token"),o(r.EndFor,"Expected endfor token"),o(r.CloseStatement,"Expected %} token");break;case r.Break:++n,o(r.CloseStatement,"Expected closing statement token"),t=new m;break;case r.Continue:++n,o(r.CloseStatement,"Expected closing statement token"),t=new g;break;default:throw new SyntaxError("Unknown statement type: ".concat(e[n].type))}return t}();case r.OpenExpression:return function(){o(r.OpenExpression,"Expected opening expression token");const e=u();return o(r.CloseExpression,"Expected closing expression token"),e}();default:throw new SyntaxError("Unexpected token type: ".concat(e[n].type))}}function i(){for(var t=arguments.length,r=new Array(t),o=0;o<t;o++)r[o]=arguments[o];return n+r.length<=e.length&&r.some(((t,r)=>t!==e[n+r].type))}function s(){for(var t=arguments.length,r=new Array(t),o=0;o<t;o++)r[o]=arguments[o];return n+r.length<=e.length&&r.every(((t,r)=>t===e[n+r].type))}function l(){var t,i;const c=u();o(r.CloseStatement,"Expected closing statement token");const d=[],p=[];for(;(null===(f=e[n])||void 0===f?void 0:f.type)!==r.OpenStatement||(null===(m=e[n+1])||void 0===m?void 0:m.type)!==r.ElseIf&&(null===(g=e[n+1])||void 0===g?void 0:g.type)!==r.Else&&(null===(_=e[n+1])||void 0===_?void 0:_.type)!==r.EndIf;){var f,m,g,_;d.push(a())}if((null===(t=e[n])||void 0===t?void 0:t.type)===r.OpenStatement&&(null===(i=e[n+1])||void 0===i?void 0:i.type)!==r.EndIf)if(++n,s(r.ElseIf))o(r.ElseIf,"Expected elseif token"),p.push(l());else for(o(r.Else,"Expected else token"),o(r.CloseStatement,"Expected closing statement token");(null===(v=e[n])||void 0===v?void 0:v.type)!==r.OpenStatement||(null===(y=e[n+1])||void 0===y?void 0:y.type)!==r.EndIf;){var v,y;p.push(a())}return new h(c,d,p)}function c(){const e=arguments.length>0&&void 0!==arguments[0]&&arguments[0]?G:u,t=[e()],o=s(r.Comma);for(;o&&(++n,t.push(e()),s(r.Comma)););return o?new A(t):t[0]}function u(){return function(){const e=d();if(s(r.If)){++n;const t=d();if(s(r.Else)){++n;const r=d();return new h(t,[e],[r])}return new P(e,t)}return e}()}function d(){let t=y();for(;s(r.Or);){const r=e[n];++n;const o=y();t=new F(r,t,o)}return t}function y(){let t=k();for(;s(r.And);){const r=e[n];++n;const o=k();t=new F(r,t,o)}return t}function k(){let t;for(;s(r.Not);){const r=e[n];++n;const o=k();t=new O(r,o)}return null!==t&&void 0!==t?t:function(){let t=j();for(;s(r.ComparisonBinaryOperator)||s(r.In)||s(r.NotIn);){const r=e[n];++n;const o=j();t=new F(r,t,o)}return t}()}function j(){let t=U();for(;s(r.AdditiveBinaryOperator);){const r=e[n];++n;const o=U();t=new F(r,t,o)}return t}function L(e){let t=new b(e,R());return t=q(t),s(r.OpenParen)&&(t=L(t)),t}function R(){o(r.OpenParen,"Expected opening parenthesis for arguments list");const e=function(){const e=[];for(;!s(r.CloseParen);){let t=u();if(s(r.Equals)){if(++n,!(t instanceof x))throw new SyntaxError("Expected identifier for keyword argument");const e=u();t=new B(t,e)}e.push(t),s(r.Comma)&&++n}return e}();return o(r.CloseParen,"Expected closing parenthesis for arguments list"),e}function V(){const e=[];let t=!1;for(;!s(r.CloseSquareBracket);)s(r.Colon)?(e.push(void 0),++n,t=!0):(e.push(u()),s(r.Colon)&&(++n,t=!0));if(0===e.length)throw new SyntaxError("Expected at least one argument for member/slice expression");if(t){if(e.length>3)throw new SyntaxError("Expected 0-3 arguments for slice expression");return new N(...e)}return e[0]}function q(t){for(;s(r.Dot)||s(r.OpenSquareBracket);){const a=e[n];let i;++n;const s=a.type!==r.Dot;if(s)i=V(),o(r.CloseSquareBracket,"Expected closing square bracket");else if(i=G(),"Identifier"!==i.type)throw new SyntaxError("Expected identifier following dot operator");t=new w(t,i,s)}return t}function U(){let t=W();for(;s(r.MultiplicativeBinaryOperator);){const r=e[n];++n;const o=W();t=new F(r,t,o)}return t}function W(){let e=function(){let e=function(){const e=q(G());return s(r.OpenParen)?L(e):e}();for(;s(r.Pipe);){++n;let t=G();if(!(t instanceof x))throw new SyntaxError("Expected identifier for the filter");s(r.OpenParen)&&(t=L(t)),e=new I(e,t)}return e}();for(;s(r.Is);){++n;const t=s(r.Not);t&&++n;let o=G();if(o instanceof S?o=new x(o.value.toString()):o instanceof E&&(o=new x("none")),!(o instanceof x))throw new SyntaxError("Expected identifier for the test");e=new z(e,t,o)}return e}function G(){const t=e[n];switch(t.type){case r.NumericLiteral:return++n,new C(Number(t.value));case r.StringLiteral:return++n,new D(t.value);case r.BooleanLiteral:return++n,new S("true"===t.value.toLowerCase());case r.NullLiteral:return++n,new E(null);case r.Identifier:return++n,new x(t.value);case r.OpenParen:{++n;const t=c();if(e[n].type!==r.CloseParen)throw new SyntaxError("Expected closing parenthesis, got ".concat(e[n].type," instead"));return++n,t}case r.OpenSquareBracket:{++n;const e=[];for(;!s(r.CloseSquareBracket);)e.push(u()),s(r.Comma)&&++n;return++n,new T(e)}case r.OpenCurlyBracket:{++n;const e=new Map;for(;!s(r.CloseCurlyBracket);){const t=u();o(r.Colon,"Expected colon between key and value in object literal");const a=u();e.set(t,a),s(r.Comma)&&++n}return++n,new M(e)}default:throw new SyntaxError("Unexpected token: ".concat(t.type))}}for(;n<e.length;)t.body.push(a());return t}function L(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;void 0===t&&(t=e,e=0);const r=[];for(let o=e;o<t;o+=n)r.push(o);return r}function R(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;const o=Math.sign(r);o>=0?(t=(null!==t&&void 0!==t?t:t=0)<0?Math.max(e.length+t,0):Math.min(t,e.length),n=(null!==n&&void 0!==n?n:n=e.length)<0?Math.max(e.length+n,0):Math.min(n,e.length)):(t=(null!==t&&void 0!==t?t:t=e.length-1)<0?Math.max(e.length+t,-1):Math.min(t,e.length-1),n=(null!==n&&void 0!==n?n:n=-1)<-1?Math.max(e.length+n,-1):Math.min(n,e.length-1));const a=[];for(let i=t;o*i<o*n;i+=r)a.push(e[i]);return a}function V(e){return e.replace(/\b\w/g,(e=>e.toUpperCase()))}var q=class extends Error{},U=class extends Error{},W=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;ao(this,"type","RuntimeValue"),ao(this,"value",void 0),ao(this,"builtins",new Map),this.value=e}__bool__(){return new K(!!this.value)}},G=class extends W{constructor(){super(...arguments),ao(this,"type","NumericValue")}},H=class extends W{constructor(){super(...arguments),ao(this,"type","StringValue"),ao(this,"builtins",new Map([["upper",new Q((()=>new H(this.value.toUpperCase())))],["lower",new Q((()=>new H(this.value.toLowerCase())))],["strip",new Q((()=>new H(this.value.trim())))],["title",new Q((()=>new H(V(this.value))))],["length",new G(this.value.length)],["rstrip",new Q((()=>new H(this.value.trimEnd())))],["lstrip",new Q((()=>new H(this.value.trimStart())))],["startswith",new Q((e=>{if(0===e.length)throw new Error("startswith() requires at least one argument");const t=e[0];if(!(t instanceof H))throw new Error("startswith() argument must be a string");return new K(this.value.startsWith(t.value))}))],["endswith",new Q((e=>{if(0===e.length)throw new Error("endswith() requires at least one argument");const t=e[0];if(!(t instanceof H))throw new Error("endswith() argument must be a string");return new K(this.value.endsWith(t.value))}))],["split",new Q((e=>{var t,n;const r=null!==(t=e[0])&&void 0!==t?t:new Y;if(!(r instanceof H||r instanceof Y))throw new Error("sep argument must be a string or null");const o=null!==(n=e[1])&&void 0!==n?n:new G(-1);if(!(o instanceof G))throw new Error("maxsplit argument must be a number");let a=[];if(r instanceof Y){const e=this.value.trimStart();for(const{0:t,index:n}of e.matchAll(/\S+/g)){if(-1!==o.value&&a.length>=o.value&&void 0!==n){a.push(t+e.slice(n+t.length));break}a.push(t)}}else{if(""===r.value)throw new Error("empty separator");a=this.value.split(r.value),-1!==o.value&&a.length>o.value&&a.push(a.splice(o.value).join(r.value))}return new X(a.map((e=>new H(e))))}))]]))}},K=class extends W{constructor(){super(...arguments),ao(this,"type","BooleanValue")}},Z=class extends W{constructor(){super(...arguments),ao(this,"type","ObjectValue"),ao(this,"builtins",new Map([["get",new Q((e=>{var t,n;let[r,o]=e;if(!(r instanceof H))throw new Error("Object key must be a string: got ".concat(r.type));return null!==(t=null!==(n=this.value.get(r.value))&&void 0!==n?n:o)&&void 0!==t?t:new Y}))],["items",new Q((()=>new X(Array.from(this.value.entries()).map((e=>{let[t,n]=e;return new X([new H(t),n])})))))]]))}__bool__(){return new K(this.value.size>0)}},$=class extends Z{constructor(){super(...arguments),ao(this,"type","KeywordArgumentsValue")}},X=class extends W{constructor(){super(...arguments),ao(this,"type","ArrayValue"),ao(this,"builtins",new Map([["length",new G(this.value.length)]]))}__bool__(){return new K(this.value.length>0)}},J=class extends X{constructor(){super(...arguments),ao(this,"type","TupleValue")}},Q=class extends W{constructor(){super(...arguments),ao(this,"type","FunctionValue")}},Y=class extends W{constructor(){super(...arguments),ao(this,"type","NullValue")}},ee=class extends W{constructor(){super(...arguments),ao(this,"type","UndefinedValue")}},te=class{constructor(e){ao(this,"variables",new Map([["namespace",new Q((e=>{if(0===e.length)return new Z(new Map);if(1!==e.length||!(e[0]instanceof Z))throw new Error("`namespace` expects either zero arguments or a single object argument");return e[0]}))]])),ao(this,"tests",new Map([["boolean",e=>"BooleanValue"===e.type],["callable",e=>e instanceof Q],["odd",e=>{if("NumericValue"!==e.type)throw new Error('Cannot apply test "odd" to type: '.concat(e.type));return e.value%2!==0}],["even",e=>{if("NumericValue"!==e.type)throw new Error('Cannot apply test "even" to type: '.concat(e.type));return e.value%2===0}],["false",e=>"BooleanValue"===e.type&&!e.value],["true",e=>"BooleanValue"===e.type&&e.value],["none",e=>"NullValue"===e.type],["string",e=>"StringValue"===e.type],["number",e=>"NumericValue"===e.type],["integer",e=>"NumericValue"===e.type&&Number.isInteger(e.value)],["iterable",e=>"ArrayValue"===e.type||"StringValue"===e.type],["mapping",e=>"ObjectValue"===e.type],["lower",e=>{const t=e.value;return"StringValue"===e.type&&t===t.toLowerCase()}],["upper",e=>{const t=e.value;return"StringValue"===e.type&&t===t.toUpperCase()}],["none",e=>"NullValue"===e.type],["defined",e=>"UndefinedValue"!==e.type],["undefined",e=>"UndefinedValue"===e.type],["equalto",(e,t)=>e.value===t.value],["eq",(e,t)=>e.value===t.value]])),this.parent=e}set(e,t){return this.declareVariable(e,re(t))}declareVariable(e,t){if(this.variables.has(e))throw new SyntaxError("Variable already declared: ".concat(e));return this.variables.set(e,t),t}setVariable(e,t){return this.variables.set(e,t),t}resolve(e){if(this.variables.has(e))return this;if(this.parent)return this.parent.resolve(e);throw new Error("Unknown variable: ".concat(e))}lookupVariable(e){try{var t;return null!==(t=this.resolve(e).variables.get(e))&&void 0!==t?t:new ee}catch(n){return new ee}}},ne=class{constructor(e){ao(this,"global",void 0),this.global=null!==e&&void 0!==e?e:new te}run(e){return this.evaluate(e,this.global)}evaluateBinaryExpression(e,t){const n=this.evaluate(e.left,t);switch(e.operator.value){case"and":return n.__bool__().value?this.evaluate(e.right,t):n;case"or":return n.__bool__().value?n:this.evaluate(e.right,t)}const r=this.evaluate(e.right,t);switch(e.operator.value){case"==":return new K(n.value==r.value);case"!=":return new K(n.value!=r.value)}if(n instanceof ee||r instanceof ee)throw new Error("Cannot perform operation on undefined values");if(n instanceof Y||r instanceof Y)throw new Error("Cannot perform operation on null values");if(n instanceof G&&r instanceof G)switch(e.operator.value){case"+":return new G(n.value+r.value);case"-":return new G(n.value-r.value);case"*":return new G(n.value*r.value);case"/":return new G(n.value/r.value);case"%":return new G(n.value%r.value);case"<":return new K(n.value<r.value);case">":return new K(n.value>r.value);case">=":return new K(n.value>=r.value);case"<=":return new K(n.value<=r.value)}else if(n instanceof X&&r instanceof X){if("+"===e.operator.value)return new X(n.value.concat(r.value))}else if(r instanceof X){const t=void 0!==r.value.find((e=>e.value===n.value));switch(e.operator.value){case"in":return new K(t);case"not in":return new K(!t)}}if((n instanceof H||r instanceof H)&&"+"===e.operator.value)return new H(n.value.toString()+r.value.toString());if(n instanceof H&&r instanceof H)switch(e.operator.value){case"in":return new K(r.value.includes(n.value));case"not in":return new K(!r.value.includes(n.value))}if(n instanceof H&&r instanceof Z)switch(e.operator.value){case"in":return new K(r.value.has(n.value));case"not in":return new K(!r.value.has(n.value))}throw new SyntaxError('Unknown operator "'.concat(e.operator.value,'" between ').concat(n.type," and ").concat(r.type))}evaluateArguments(e,t){const n=[],r=new Map;for(const o of e)if("KeywordArgumentExpression"===o.type){const e=o;r.set(e.key.value,this.evaluate(e.value,t))}else{if(r.size>0)throw new Error("Positional arguments must come before keyword arguments");n.push(this.evaluate(o,t))}return[n,r]}evaluateFilterExpression(e,t){const n=this.evaluate(e.operand,t);if("Identifier"===e.filter.type){const t=e.filter;if("tojson"===t.value)return new H(oe(n));if(n instanceof X)switch(t.value){case"list":return n;case"first":return n.value[0];case"last":return n.value[n.value.length-1];case"length":return new G(n.value.length);case"reverse":return new X(n.value.reverse());case"sort":return new X(n.value.sort(((e,t)=>{if(e.type!==t.type)throw new Error("Cannot compare different types: ".concat(e.type," and ").concat(t.type));switch(e.type){case"NumericValue":return e.value-t.value;case"StringValue":return e.value.localeCompare(t.value);default:throw new Error("Cannot compare type: ".concat(e.type))}})));case"join":return new H(n.value.map((e=>e.value)).join(""));case"string":return new H(oe(n));default:throw new Error("Unknown ArrayValue filter: ".concat(t.value))}else if(n instanceof H)switch(t.value){case"length":return new G(n.value.length);case"upper":return new H(n.value.toUpperCase());case"lower":return new H(n.value.toLowerCase());case"title":return new H(V(n.value));case"capitalize":return new H(n.value.charAt(0).toUpperCase()+n.value.slice(1));case"trim":return new H(n.value.trim());case"indent":return new H(n.value.split("\n").map(((e,t)=>0===t||0===e.length?e:"    "+e)).join("\n"));case"join":case"string":return n;default:throw new Error("Unknown StringValue filter: ".concat(t.value))}else{if(n instanceof G){if("abs"===t.value)return new G(Math.abs(n.value));throw new Error("Unknown NumericValue filter: ".concat(t.value))}if(n instanceof Z)switch(t.value){case"items":return new X(Array.from(n.value.entries()).map((e=>{let[t,n]=e;return new X([new H(t),n])})));case"length":return new G(n.value.size);default:throw new Error("Unknown ObjectValue filter: ".concat(t.value))}}throw new Error('Cannot apply filter "'.concat(t.value,'" to type: ').concat(n.type))}if("CallExpression"===e.filter.type){const p=e.filter;if("Identifier"!==p.callee.type)throw new Error("Unknown filter: ".concat(p.callee.type));const h=p.callee.value;if("tojson"===h){var r;const[,e]=this.evaluateArguments(p.args,t),o=null!==(r=e.get("indent"))&&void 0!==r?r:new Y;if(!(o instanceof G||o instanceof Y))throw new Error("If set, indent must be a number");return new H(oe(n,o.value))}if("join"===h){var o,a;let e;if(n instanceof H)e=Array.from(n.value);else{if(!(n instanceof X))throw new Error('Cannot apply filter "'.concat(h,'" to type: ').concat(n.type));e=n.value.map((e=>e.value))}const[r,i]=this.evaluateArguments(p.args,t),s=null!==(o=null!==(a=r.at(0))&&void 0!==a?a:i.get("separator"))&&void 0!==o?o:new H("");if(!(s instanceof H))throw new Error("separator must be a string");return new H(e.join(s.value))}if(n instanceof X){switch(h){case"selectattr":case"rejectattr":{const e="selectattr"===h;if(n.value.some((e=>!(e instanceof Z))))throw new Error("`".concat(h,"` can only be applied to array of objects"));if(p.args.some((e=>"StringLiteral"!==e.type)))throw new Error("arguments of `".concat(h,"` must be strings"));const[r,o,a]=p.args.map((e=>this.evaluate(e,t)));let i;if(o){const e=t.tests.get(o.value);if(!e)throw new Error("Unknown test: ".concat(o.value));i=e}else i=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t[0].__bool__().value};const s=n.value.filter((t=>{const n=t.value.get(r.value),o=!!n&&i(n,a);return e?o:!o}));return new X(s)}case"map":{const[,e]=this.evaluateArguments(p.args,t);if(e.has("attribute")){const t=e.get("attribute");if(!(t instanceof H))throw new Error("attribute must be a string");const r=e.get("default"),o=n.value.map((e=>{var n,o;if(!(e instanceof Z))throw new Error("items in map must be an object");return null!==(n=null!==(o=e.value.get(t.value))&&void 0!==o?o:r)&&void 0!==n?n:new ee}));return new X(o)}throw new Error("`map` expressions without `attribute` set are not currently supported.")}}throw new Error("Unknown ArrayValue filter: ".concat(h))}if(n instanceof H){if("indent"===h){var i,s,l,c,u,d;const[e,r]=this.evaluateArguments(p.args,t),o=null!==(i=null!==(s=e.at(0))&&void 0!==s?s:r.get("width"))&&void 0!==i?i:new G(4);if(!(o instanceof G))throw new Error("width must be a number");const a=null!==(l=null!==(c=e.at(1))&&void 0!==c?c:r.get("first"))&&void 0!==l?l:new K(!1),h=null!==(u=null!==(d=e.at(2))&&void 0!==d?d:r.get("blank"))&&void 0!==u?u:new K(!1),f=n.value.split("\n"),m=" ".repeat(o.value),g=f.map(((e,t)=>!a.value&&0===t||!h.value&&0===e.length?e:m+e));return new H(g.join("\n"))}throw new Error("Unknown StringValue filter: ".concat(h))}throw new Error('Cannot apply filter "'.concat(h,'" to type: ').concat(n.type))}throw new Error("Unknown filter: ".concat(e.filter.type))}evaluateTestExpression(e,t){const n=this.evaluate(e.operand,t),r=t.tests.get(e.test.value);if(!r)throw new Error("Unknown test: ".concat(e.test.value));const o=r(n);return new K(e.negate?!o:o)}evaluateUnaryExpression(e,t){const n=this.evaluate(e.argument,t);if("not"===e.operator.value)return new K(!n.value);throw new SyntaxError("Unknown operator: ".concat(e.operator.value))}evalProgram(e,t){return this.evaluateBlock(e.body,t)}evaluateBlock(e,t){let n="";for(const r of e){const e=this.evaluate(r,t);"NullValue"!==e.type&&"UndefinedValue"!==e.type&&(n+=e.value)}return new H(n)}evaluateIdentifier(e,t){return t.lookupVariable(e.value)}evaluateCallExpression(e,t){const[n,r]=this.evaluateArguments(e.args,t);r.size>0&&n.push(new $(r));const o=this.evaluate(e.callee,t);if("FunctionValue"!==o.type)throw new Error("Cannot call something that is not a function: got ".concat(o.type));return o.value(n,t)}evaluateSliceExpression(e,t,n){if(!(e instanceof X||e instanceof H))throw new Error("Slice object must be an array or string");const r=this.evaluate(t.start,n),o=this.evaluate(t.stop,n),a=this.evaluate(t.step,n);if(!(r instanceof G||r instanceof ee))throw new Error("Slice start must be numeric or undefined");if(!(o instanceof G||o instanceof ee))throw new Error("Slice stop must be numeric or undefined");if(!(a instanceof G||a instanceof ee))throw new Error("Slice step must be numeric or undefined");return e instanceof X?new X(R(e.value,r.value,o.value,a.value)):new H(R(Array.from(e.value),r.value,o.value,a.value).join(""))}evaluateMemberExpression(e,t){const n=this.evaluate(e.object,t);let r,o;if(e.computed){if("SliceExpression"===e.property.type)return this.evaluateSliceExpression(n,e.property,t);r=this.evaluate(e.property,t)}else r=new H(e.property.value);if(n instanceof Z){var a;if(!(r instanceof H))throw new Error("Cannot access property with non-string: got ".concat(r.type));o=null!==(a=n.value.get(r.value))&&void 0!==a?a:n.builtins.get(r.value)}else if(n instanceof X||n instanceof H)if(r instanceof G)o=n.value.at(r.value),n instanceof H&&(o=new H(n.value.at(r.value)));else{if(!(r instanceof H))throw new Error("Cannot access property with non-string/non-number: got ".concat(r.type));o=n.builtins.get(r.value)}else{if(!(r instanceof H))throw new Error("Cannot access property with non-string: got ".concat(r.type));o=n.builtins.get(r.value)}return o instanceof W?o:new ee}evaluateSet(e,t){const n=e.value?this.evaluate(e.value,t):this.evaluateBlock(e.body,t);if("Identifier"===e.assignee.type){const r=e.assignee.value;t.setVariable(r,n)}else{if("MemberExpression"!==e.assignee.type)throw new Error("Invalid LHS inside assignment expression: ".concat(JSON.stringify(e.assignee)));{const r=e.assignee,o=this.evaluate(r.object,t);if(!(o instanceof Z))throw new Error("Cannot assign to member of non-object");if("Identifier"!==r.property.type)throw new Error("Cannot assign to member with non-identifier property");o.value.set(r.property.value,n)}}return new Y}evaluateIf(e,t){const n=this.evaluate(e.test,t);return this.evaluateBlock(n.__bool__().value?e.body:e.alternate,t)}evaluateFor(e,t){const n=new te(t);let r,o;if("SelectExpression"===e.iterable.type){const t=e.iterable;o=this.evaluate(t.iterable,n),r=t.test}else o=this.evaluate(e.iterable,n);if(!(o instanceof X))throw new Error("Expected iterable type in for loop: got ".concat(o.type));const a=[],i=[];for(let u=0;u<o.value.length;++u){const t=new te(n),s=o.value[u];let l;if("Identifier"===e.loopvar.type)l=t=>t.setVariable(e.loopvar.value,s);else{if("TupleLiteral"!==e.loopvar.type)throw new Error("Invalid loop variable(s): ".concat(e.loopvar.type));{const t=e.loopvar;if("ArrayValue"!==s.type)throw new Error("Cannot unpack non-iterable type: ".concat(s.type));const n=s;if(t.value.length!==n.value.length)throw new Error("Too ".concat(t.value.length>n.value.length?"few":"many"," items to unpack"));l=e=>{for(let r=0;r<t.value.length;++r){if("Identifier"!==t.value[r].type)throw new Error("Cannot unpack non-identifier type: ".concat(t.value[r].type));e.setVariable(t.value[r].value,n.value[r])}}}}if(r){l(t);if(!this.evaluate(r,t).__bool__().value)continue}a.push(s),i.push(l)}let s="",l=!0;for(let u=0;u<a.length;++u){const t=new Map([["index",new G(u+1)],["index0",new G(u)],["revindex",new G(a.length-u)],["revindex0",new G(a.length-u-1)],["first",new K(0===u)],["last",new K(u===a.length-1)],["length",new G(a.length)],["previtem",u>0?a[u-1]:new ee],["nextitem",u<a.length-1?a[u+1]:new ee]]);n.setVariable("loop",new Z(t)),i[u](n);try{s+=this.evaluateBlock(e.body,n).value}catch(c){if(c instanceof U)continue;if(c instanceof q)break;throw c}l=!1}if(l){s+=this.evaluateBlock(e.defaultBlock,n).value}return new H(s)}evaluateMacro(e,t){return t.setVariable(e.name.value,new Q(((t,n)=>{var r;const o=new te(n);let a;"KeywordArgumentsValue"===(null===(r=(t=t.slice()).at(-1))||void 0===r?void 0:r.type)&&(a=t.pop());for(let l=0;l<e.args.length;++l){const n=e.args[l],r=t[l];if("Identifier"===n.type){const e=n;if(!r)throw new Error("Missing positional argument: ".concat(e.value));o.setVariable(e.value,r)}else{if("KeywordArgumentExpression"!==n.type)throw new Error("Unknown argument type: ".concat(n.type));{var i,s;const e=n,t=null!==(i=null!==r&&void 0!==r?r:null===(s=a)||void 0===s?void 0:s.value.get(e.key.value))&&void 0!==i?i:this.evaluate(e.value,o);o.setVariable(e.key.value,t)}}}return this.evaluateBlock(e.body,o)}))),new Y}evaluate(e,t){if(void 0===e)return new ee;switch(e.type){case"Program":return this.evalProgram(e,t);case"Set":return this.evaluateSet(e,t);case"If":return this.evaluateIf(e,t);case"For":return this.evaluateFor(e,t);case"Macro":return this.evaluateMacro(e,t);case"Break":throw new q;case"Continue":throw new U;case"NumericLiteral":return new G(Number(e.value));case"StringLiteral":return new H(e.value);case"BooleanLiteral":return new K(e.value);case"NullLiteral":return new Y(e.value);case"ArrayLiteral":return new X(e.value.map((e=>this.evaluate(e,t))));case"TupleLiteral":return new J(e.value.map((e=>this.evaluate(e,t))));case"ObjectLiteral":{const n=new Map;for(const[r,o]of e.value){const e=this.evaluate(r,t);if(!(e instanceof H))throw new Error("Object keys must be strings: got ".concat(e.type));n.set(e.value,this.evaluate(o,t))}return new Z(n)}case"Identifier":return this.evaluateIdentifier(e,t);case"CallExpression":return this.evaluateCallExpression(e,t);case"MemberExpression":return this.evaluateMemberExpression(e,t);case"UnaryExpression":return this.evaluateUnaryExpression(e,t);case"BinaryExpression":return this.evaluateBinaryExpression(e,t);case"FilterExpression":return this.evaluateFilterExpression(e,t);case"TestExpression":return this.evaluateTestExpression(e,t);default:throw new SyntaxError("Unknown node type: ".concat(e.type))}}};function re(e){switch(typeof e){case"number":return new G(e);case"string":return new H(e);case"boolean":return new K(e);case"undefined":return new ee;case"object":return null===e?new Y:Array.isArray(e)?new X(e.map(re)):new Z(new Map(Object.entries(e).map((e=>{let[t,n]=e;return[t,re(n)]}))));case"function":return new Q(((t,n)=>{var r;const o=null!==(r=e(...t.map((e=>e.value))))&&void 0!==r?r:null;return re(o)}));default:throw new Error("Cannot convert to runtime value: ".concat(e))}}function oe(e,t,n){const r=null!==n&&void 0!==n?n:0;switch(e.type){case"NullValue":case"UndefinedValue":return"null";case"NumericValue":case"StringValue":case"BooleanValue":return JSON.stringify(e.value);case"ArrayValue":case"ObjectValue":{const n=t?" ".repeat(t):"",o="\n"+n.repeat(r),a=o+n;if("ArrayValue"===e.type){const n=e.value.map((e=>oe(e,t,r+1)));return t?"[".concat(a).concat(n.join(",".concat(a))).concat(o,"]"):"[".concat(n.join(", "),"]")}{const n=Array.from(e.value.entries()).map((e=>{let[n,o]=e;const i='"'.concat(n,'": ').concat(oe(o,t,r+1));return t?"".concat(a).concat(i):i}));return t?"{".concat(n.join(",")).concat(o,"}"):"{".concat(n.join(", "),"}")}}default:throw new Error("Cannot convert to JSON: ".concat(e.type))}}var ae="\n",ie={MultiplicativeBinaryOperator:2,AdditiveBinaryOperator:1,ComparisonBinaryOperator:0};function se(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return"{%- "+t.join(" ")+" -%}"}function le(e,t,n){return e.map((e=>function(e,t,n){const r=n.repeat(t);switch(e.type){case"Program":return le(e.body,t,n);case"If":return function(e,t,n){const r=n.repeat(t),o=[];let a=e;for(;a&&(o.push({test:a.test,body:a.body}),1===a.alternate.length&&"If"===a.alternate[0].type);)a=a.alternate[0];let i=r+se("if",ce(o[0].test))+ae+le(o[0].body,t+1,n);for(let s=1;s<o.length;s++)i+=ae+r+se("elif",ce(o[s].test))+ae+le(o[s].body,t+1,n);a&&a.alternate.length>0&&(i+=ae+r+se("else")+ae+le(a.alternate,t+1,n));return i+=ae+r+se("endif"),i}(e,t,n);case"For":return function(e,t,n){const r=n.repeat(t);let o="";if("SelectExpression"===e.iterable.type){const t=e.iterable;o="".concat(ce(t.iterable)," if ").concat(ce(t.test))}else o=ce(e.iterable);let a=r+se("for",ce(e.loopvar),"in",o)+ae+le(e.body,t+1,n);e.defaultBlock.length>0&&(a+=ae+r+se("else")+ae+le(e.defaultBlock,t+1,n));return a+=ae+r+se("endfor"),a}(e,t,n);case"Set":return function(e,t,n){const r=n.repeat(t),o=ce(e.assignee),a=e.value?ce(e.value):"",i=r+se("set","".concat(o).concat(e.value?" = "+a:""));if(0===e.body.length)return i;return i+ae+le(e.body,t+1,n)+ae+r+se("endset")}(e,t,n);case"Macro":return function(e,t,n){const r=n.repeat(t),o=e.args.map(ce).join(", ");return r+se("macro","".concat(e.name.value,"(").concat(o,")"))+ae+le(e.body,t+1,n)+ae+r+se("endmacro")}(e,t,n);case"Break":return r+se("break");case"Continue":return r+se("continue");default:return r+"{{- "+ce(e)+" -}}"}}(e,t,n))).join(ae)}function ce(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;switch(e.type){case"Identifier":return e.value;case"NullLiteral":return"none";case"NumericLiteral":case"BooleanLiteral":return"".concat(e.value);case"StringLiteral":return JSON.stringify(e.value);case"BinaryExpression":{var n;const r=e,o=null!==(n=ie[r.operator.type])&&void 0!==n?n:0,a=ce(r.left,o),i=ce(r.right,o+1),s="".concat(a," ").concat(r.operator.value," ").concat(i);return o<t?"(".concat(s,")"):s}case"UnaryExpression":{const t=e;return t.operator.value+("not"===t.operator.value?" ":"")+ce(t.argument,1/0)}case"LogicalNegationExpression":return"not ".concat(ce(e.argument,1/0));case"CallExpression":{const t=e,n=t.args.map((e=>ce(e,-1))).join(", ");return"".concat(ce(t.callee,-1),"(").concat(n,")")}case"MemberExpression":{const t=e;let n=ce(t.object,-1);"Identifier"!==t.object.type&&(n="(".concat(n,")"));let r=ce(t.property,-1);return t.computed||"Identifier"===t.property.type||(r="(".concat(r,")")),t.computed?"".concat(n,"[").concat(r,"]"):"".concat(n,".").concat(r)}case"FilterExpression":{const t=e,n=ce(t.operand,1/0);return"CallExpression"===t.filter.type?"".concat(n," | ").concat(ce(t.filter,-1)):"".concat(n," | ").concat(t.filter.value)}case"SelectExpression":{const t=e;return"".concat(ce(t.iterable,-1)," | select(").concat(ce(t.test,-1),")")}case"TestExpression":{const t=e;return"".concat(ce(t.operand,-1)," is").concat(t.negate?" not":""," ").concat(t.test.value)}case"ArrayLiteral":case"TupleLiteral":{const t=e.value.map((e=>ce(e,-1))),n="ArrayLiteral"===e.type?"[]":"()";return"".concat(n[0]).concat(t.join(", ")).concat(n[1])}case"ObjectLiteral":{const t=Array.from(e.value.entries()).map((e=>{let[t,n]=e;return"".concat(ce(t,-1),": ").concat(ce(n,-1))}));return"{ ".concat(t.join(", ")," }")}case"SliceExpression":{const t=e,n=t.start?ce(t.start,-1):"",r=t.stop?ce(t.stop,-1):"",o=t.step?":".concat(ce(t.step,-1)):"";return"".concat(n,":").concat(r).concat(o)}case"KeywordArgumentExpression":{const t=e;return"".concat(t.key.value,"=").concat(ce(t.value,-1))}case"If":{const t=e,n=ce(t.test,-1),r=ce(t.body[0],0),o=ce(t.alternate[0],-1);return"".concat(r," if ").concat(n," else ").concat(o)}default:throw new Error("Unknown expression type: ".concat(e.type))}}var ue=class{constructor(e){ao(this,"parsed",void 0);const t=u(e,{lstrip_blocks:!0,trim_blocks:!0});this.parsed=j(t)}render(e){const t=new te;if(t.set("false",!1),t.set("true",!0),t.set("raise_exception",(e=>{throw new Error(e)})),t.set("range",L),e)for(const[n,r]of Object.entries(e))t.set(n,r);return new ne(t).run(this.parsed).value}format(e){return function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"\t";const n="number"===typeof t?" ".repeat(t):t;return le(e.body,0,n).replace(/\n$/,"")}(this.parsed,(null===e||void 0===e?void 0:e.indent)||"\t")}}},"./src/backends/onnx.js":(e,t,n)=>{var r,o;n.r(t),n.d(t,{Tensor:()=>l.Tensor,createInferenceSession:()=>_,deviceToExecutionProviders:()=>m,isONNXProxy:()=>w,isONNXTensor:()=>v});var a=n("./src/env.js"),i=n("?2ce3"),s=n("onnxruntime-web"),l=n("onnxruntime-common");const c=Object.freeze({auto:null,gpu:null,cpu:"cpu",wasm:"wasm",webgpu:"webgpu",cuda:"cuda",dml:"dml",webnn:{name:"webnn",deviceType:"cpu"},"webnn-npu":{name:"webnn",deviceType:"npu"},"webnn-gpu":{name:"webnn",deviceType:"gpu"},"webnn-cpu":{name:"webnn",deviceType:"cpu"}}),u=[];let d,p;const h=Symbol.for("onnxruntime");if(h in globalThis)p=globalThis[h];else if(a.apis.IS_NODE_ENV){switch(p=null!==i&&void 0!==i?i:o||(o=n.t(i,2)),process.platform){case"win32":u.push("dml");break;case"linux":"x64"===process.arch&&u.push("cuda")}u.push("cpu"),d=["cpu"]}else p=s,a.apis.IS_WEBNN_AVAILABLE&&u.push("webnn-npu","webnn-gpu","webnn-cpu","webnn"),a.apis.IS_WEBGPU_AVAILABLE&&u.push("webgpu"),u.push("wasm"),d=["wasm"];const f=p.InferenceSession;function m(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(!e)return d;switch(e){case"auto":return u;case"gpu":return u.filter((e=>["webgpu","cuda","dml","webnn-gpu"].includes(e)))}var t;if(u.includes(e))return[null!==(t=c[e])&&void 0!==t?t:e];throw new Error('Unsupported device: "'.concat(e,'". Should be one of: ').concat(u.join(", "),"."))}let g=null;async function _(e,t,n){g&&await g;const r=f.create(e,t);null!==g&&void 0!==g||(g=r);const o=await r;return o.config=n,o}function v(e){return e instanceof p.Tensor}const y=null===(r=p)||void 0===r?void 0:r.env;function w(){var e;return null===y||void 0===y||null===(e=y.wasm)||void 0===e?void 0:e.proxy}null!==y&&void 0!==y&&y.wasm&&("undefined"!==typeof ServiceWorkerGlobalScope&&self instanceof ServiceWorkerGlobalScope||y.wasm.wasmPaths||(y.wasm.wasmPaths="https://cdn.jsdelivr.net/npm/@huggingface/transformers@".concat(a.env.version,"/dist/")),y.wasm.proxy=!1),null!==y&&void 0!==y&&y.webgpu&&(y.webgpu.powerPreference="high-performance"),a.env.backends.onnx=y},"./src/base/feature_extraction_utils.js":(e,t,n)=>{n.r(t),n.d(t,{FeatureExtractor:()=>i,validate_audio_inputs:()=>s});var r=n("./src/utils/constants.js"),o=n("./src/utils/generic.js"),a=n("./src/utils/hub.js");class i extends o.Callable{constructor(e){super(),this.config=e}static async from_pretrained(e,t){return new this(await(0,a.getModelJSON)(e,r.FEATURE_EXTRACTOR_NAME,!0,t))}}function s(e,t){var n,r;if(!(e instanceof Float32Array||e instanceof Float64Array))throw new Error("".concat(t," expects input to be a Float32Array or a Float64Array, but got ").concat(null!==(n=null===e||void 0===e||null===(r=e.constructor)||void 0===r?void 0:r.name)&&void 0!==n?n:typeof e," instead. ")+"If using the feature extractor directly, remember to use `read_audio(url, sampling_rate)` to obtain the raw audio data of the file/url.")}},"./src/base/image_processors_utils.js":(e,t,n)=>{n.r(t),n.d(t,{ImageProcessor:()=>y,center_to_corners_format:()=>d,post_process_instance_segmentation:()=>v,post_process_object_detection:()=>p,post_process_panoptic_segmentation:()=>_,post_process_semantic_segmentation:()=>h});var r=n("./src/utils/generic.js"),o=n("./src/utils/tensor.js"),a=n("./src/utils/maths.js"),i=(n("./src/utils/image.js"),n("./src/utils/core.js")),s=n("./src/utils/hub.js"),l=n("./src/utils/constants.js");function c(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;const o=e/t;let i=(0,a.bankers_round)(o)*t;return null!==r&&i>r&&(i=Math.floor(o)*t),i<n&&(i=Math.ceil(o)*t),i}function u(e,t){let[n,r]=e;return[Math.max(Math.floor(n/t),1)*t,Math.max(Math.floor(r/t),1)*t]}function d(e){let[t,n,r,o]=e;return[t-r/2,n-o/2,t+r/2,n+o/2]}function p(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.5,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const o=e.logits,i=e.pred_boxes,[s,l,c]=o.dims;if(null!==n&&n.length!==s)throw Error("Make sure that you pass in as many target sizes as the batch dimension of the logits");let u=[];for(let p=0;p<s;++p){let e=null!==n?n[p]:null,s={boxes:[],classes:[],scores:[]},h=o[p],f=i[p];for(let n=0;n<l;++n){let o,i=h[n],l=[];if(r){o=i.sigmoid().data;for(let e=0;e<o.length;++e)o[e]>t&&l.push(e)}else{let e=(0,a.max)(i.data)[1];if(e===c-1)continue;if(o=(0,a.softmax)(i.data),o[e]<t)continue;l.push(e)}for(const t of l){let r=f[n].data;r=d(r),null!==e&&(r=r.map(((t,n)=>t*e[(n+1)%2]))),s.boxes.push(r),s.classes.push(t),s.scores.push(o[t])}}u.push(s)}return u}function h(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const n=e.logits,r=n.dims[0];if(null!==t&&t.length!==r)throw Error("Make sure that you pass in as many target sizes as the batch dimension of the logits");const a=[];for(let i=0;i<r;++i){const e=null!==t?t[i]:null;let r=n[i];null!==e&&(r=(0,o.interpolate)(r,e,"bilinear",!1));const[s,l]=null!==e&&void 0!==e?e:r.dims.slice(-2),c=new o.Tensor("int32",new Int32Array(s*l),[s,l]),u=r[0].data,d=c.data;for(let t=1;t<r.dims[0];++t){const e=r[t].data;for(let n=0;n<e.length;++n)e[n]>u[n]&&(u[n]=e[n],d[n]=t)}const p=new Array(r.dims[0]);for(let t=0;t<d.length;++t){const e=d[t];p[e]=e}const h=p.filter((e=>void 0!==e));a.push({segmentation:c,labels:h})}return a}function f(e,t,n,r){const o=[],i=[],s=[];for(let l=0;l<e.dims[0];++l){const c=e[l],u=t[l],d=(0,a.max)(c.data)[1];if(d===r)continue;const p=(0,a.softmax)(c.data)[d];p>n&&(o.push(u),i.push(p),s.push(d))}return[o,i,s]}function m(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.8;const a=[];let i=0,s=0;const l=t[n].data;for(let u=0;u<e.length;++u)e[u]===n&&(a.push(u),++i),l[u]>=r&&++s;let c=i>0&&s>0;if(c){c=i/s>o}return[c,a]}function g(e,t,n,r,a){let i=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;const[s,l]=null!==i&&void 0!==i?i:e[0].dims,c=new o.Tensor("int32",new Int32Array(s*l),[s,l]),u=[];if(null!==i)for(let m=0;m<e.length;++m)e[m]=(0,o.interpolate)(e[m],i,"bilinear",!1);const d=new Int32Array(e[0].data.length),p=new Float32Array(e[0].data.length);for(let o=0;o<e.length;++o){let n=t[o];const r=e[o].data;for(let e=0;e<r.length;++e)r[e]*=n,r[e]>p[e]&&(d[e]=o,p[e]=r[e])}let h=0;const f=c.data;for(let o=0;o<n.length;++o){const i=n[o],[s,l]=m(d,e,o,r,a);if(s){++h;for(const e of l)f[e]=h;u.push({id:h,label_id:i,score:t[o]})}}return[c,u]}function _(e){var t,n;let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.5,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.5,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.8,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null;null===s&&(console.warn("`label_ids_to_fuse` unset. No instance will be fused."),s=new Set);const c=null!==(t=e.class_queries_logits)&&void 0!==t?t:e.logits,u=(null!==(n=e.masks_queries_logits)&&void 0!==n?n:e.pred_masks).sigmoid();let[d,p,h]=c.dims;if(h-=1,null!==l&&l.length!==d)throw Error("Make sure that you pass in as many target sizes as the batch dimension of the logits");let m=[];for(let _=0;_<d;++_){let e=null!==l?l[_]:null,t=c[_],n=u[_],[d,p,v]=f(t,n,r,h);if(0===v.length){let[t,r]=null!==e&&void 0!==e?e:n.dims.slice(-2),a=new o.Tensor("int32",new Int32Array(t*r).fill(-1),[t,r]);m.push({segmentation:a,segments_info:[]});continue}let[y,w]=g(d,p,v,a,i,s,e);m.push({segmentation:y,segments_info:w})}return m}function v(e){throw new Error("`post_process_instance_segmentation` is not yet implemented.")}class y extends r.Callable{constructor(e){var t,n,r,o,a,i,s,l,c,u;super(),this.image_mean=null!==(t=e.image_mean)&&void 0!==t?t:e.mean,this.image_std=null!==(n=e.image_std)&&void 0!==n?n:e.std,this.resample=null!==(r=e.resample)&&void 0!==r?r:2,this.do_rescale=null===(o=e.do_rescale)||void 0===o||o,this.rescale_factor=null!==(a=e.rescale_factor)&&void 0!==a?a:1/255,this.do_normalize=e.do_normalize,this.do_thumbnail=e.do_thumbnail,this.size=null!==(i=e.size)&&void 0!==i?i:e.image_size,this.do_resize=null!==(s=e.do_resize)&&void 0!==s?s:void 0!==this.size,this.size_divisibility=null!==(l=e.size_divisibility)&&void 0!==l?l:e.size_divisor,this.do_center_crop=e.do_center_crop,this.crop_size=e.crop_size,this.do_convert_rgb=null===(c=e.do_convert_rgb)||void 0===c||c,this.do_crop_margin=e.do_crop_margin,this.pad_size=e.pad_size,this.do_pad=e.do_pad,this.min_pixels=e.min_pixels,this.max_pixels=e.max_pixels,this.do_pad&&!this.pad_size&&this.size&&void 0!==this.size.width&&void 0!==this.size.height&&(this.pad_size=this.size),this.do_flip_channel_order=null!==(u=e.do_flip_channel_order)&&void 0!==u&&u,this.config=e}async thumbnail(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2;const r=e.height,o=e.width,a=t.height,i=t.width;let s=Math.min(r,a),l=Math.min(o,i);return s===r&&l===o?e:(r>o?l=Math.floor(o*s/r):o>r&&(s=Math.floor(r*l/o)),await e.resize(l,s,{resample:n}))}async crop_margin(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200;const n=e.clone().grayscale(),r=(0,a.min)(n.data)[0],o=(0,a.max)(n.data)[0]-r;if(0===o)return e;const i=t/255;let s=n.width,l=n.height,c=0,u=0;const d=n.data;for(let a=0;a<n.height;++a){const e=a*n.width;for(let t=0;t<n.width;++t)(d[e+t]-r)/o<i&&(s=Math.min(s,t),l=Math.min(l,a),c=Math.max(c,t),u=Math.max(u,a))}return e=await e.crop([s,l,c,u])}pad_image(e,t,n){let{mode:r="constant",center:o=!1,constant_values:a=0}=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const[s,l,c]=t;let u,d;if("number"===typeof n?(u=n,d=n):"square"===n?u=d=Math.max(s,l):(u=n.width,d=n.height),u!==l||d!==s){const n=new Float32Array(u*d*c);if(Array.isArray(a))for(let e=0;e<n.length;++e)n[e]=a[e%c];else 0!==a&&n.fill(a);const[p,h]=o?[Math.floor((u-l)/2),Math.floor((d-s)/2)]:[0,0];for(let t=0;t<s;++t){const r=(t+h)*u,o=t*l;for(let t=0;t<l;++t){const a=(r+t+p)*c,i=(o+t)*c;for(let t=0;t<c;++t)n[a+t]=e[i+t]}}if("symmetric"===r){if(o)throw new Error("`center` padding is not supported when `mode` is set to `symmetric`.");const t=s-1,r=l-1;for(let o=0;o<d;++o){const a=o*u,d=(0,i.calculateReflectOffset)(o,t)*l;for(let t=0;t<u;++t){if(o<s&&t<l)continue;const u=(a+t)*c,p=(d+(0,i.calculateReflectOffset)(t,r))*c;for(let t=0;t<c;++t)n[u+t]=e[p+t]}}}e=n,t=[d,u,c]}return[e,t]}rescale(e){for(let t=0;t<e.length;++t)e[t]=this.rescale_factor*e[t]}get_resize_output_image_size(e,t){const[n,r]=e.size;let o,a;if(this.do_thumbnail){const{height:e,width:n}=t;o=Math.min(e,n)}else if(Number.isInteger(t)){var i;o=t,a=null!==(i=this.config.max_size)&&void 0!==i?i:o}else void 0!==t&&(o=t.shortest_edge,a=t.longest_edge);if(void 0!==o||void 0!==a){const e=void 0===o?1:Math.max(o/n,o/r),t=n*e,i=r*e,s=void 0===a?1:Math.min(a/t,a/i);let l=Math.floor(Number((t*s).toFixed(2))),c=Math.floor(Number((i*s).toFixed(2)));return void 0!==this.size_divisibility&&([l,c]=u([l,c],this.size_divisibility)),[l,c]}if(void 0!==t&&void 0!==t.width&&void 0!==t.height){let e=t.width,o=t.height;if(this.config.keep_aspect_ratio&&this.config.ensure_multiple_of){let t=o/r,a=e/n;Math.abs(1-a)<Math.abs(1-t)?t=a:a=t,o=c(t*r,this.config.ensure_multiple_of),e=c(a*n,this.config.ensure_multiple_of)}return[e,o]}if(void 0!==this.size_divisibility)return u([n,r],this.size_divisibility);if(void 0!==this.min_pixels&&void 0!==this.max_pixels){return function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:28,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:3136,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1003520;if(e<n||t<n)throw new Error("height:".concat(e," or width:").concat(t," must be larger than factor:").concat(n));if(Math.max(e,t)/Math.min(e,t)>200)throw new Error("absolute aspect ratio must be smaller than 200, got ".concat(Math.max(e,t)/Math.min(e,t)));let a=Math.round(e/n)*n,i=Math.round(t/n)*n;if(a*i>o){const r=Math.sqrt(e*t/o);a=Math.floor(e/r/n)*n,i=Math.floor(t/r/n)*n}else if(a*i<r){const o=Math.sqrt(r/(e*t));a=Math.ceil(e*o/n)*n,i=Math.ceil(t*o/n)*n}return[a,i]}(r,n,this.config.patch_size*this.config.merge_size,this.min_pixels,this.max_pixels)}throw new Error("Could not resize image due to unsupported `this.size` option in config: ".concat(JSON.stringify(t)))}async resize(e){const[t,n]=this.get_resize_output_image_size(e,this.size);return await e.resize(t,n,{resample:this.resample})}async preprocess(e){let{do_normalize:t=null,do_pad:n=null,do_convert_rgb:r=null,do_convert_grayscale:a=null,do_flip_channel_order:i=null}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.do_crop_margin&&(e=await this.crop_margin(e));const[s,l]=e.size;if((null!==r&&void 0!==r?r:this.do_convert_rgb)?e=e.rgb():a&&(e=e.grayscale()),this.do_resize&&(e=await this.resize(e)),this.do_thumbnail&&(e=await this.thumbnail(e,this.size,this.resample)),this.do_center_crop){let t,n;Number.isInteger(this.crop_size)?(t=this.crop_size,n=this.crop_size):(t=this.crop_size.width,n=this.crop_size.height),e=await e.center_crop(t,n)}const c=[e.height,e.width];let d=Float32Array.from(e.data),p=[e.height,e.width,e.channels];if(this.do_rescale&&this.rescale(d),null!==t&&void 0!==t?t:this.do_normalize){let t=this.image_mean;Array.isArray(this.image_mean)||(t=new Array(e.channels).fill(t));let n=this.image_std;if(Array.isArray(this.image_std)||(n=new Array(e.channels).fill(t)),t.length!==e.channels||n.length!==e.channels)throw new Error("When set to arrays, the length of `image_mean` (".concat(t.length,") and `image_std` (").concat(n.length,") must match the number of channels in the image (").concat(e.channels,")."));for(let r=0;r<d.length;r+=e.channels)for(let o=0;o<e.channels;++o)d[r+o]=(d[r+o]-t[o])/n[o]}if(null!==n&&void 0!==n?n:this.do_pad)if(this.pad_size){const t=this.pad_image(d,[e.height,e.width,e.channels],this.pad_size);[d,p]=t}else if(this.size_divisibility){const[e,t]=u([p[1],p[0]],this.size_divisibility);[d,p]=this.pad_image(d,p,{width:e,height:t})}if(null!==i&&void 0!==i?i:this.do_flip_channel_order){if(3!==p[2])throw new Error("Flipping channel order is only supported for RGB images.");for(let e=0;e<d.length;e+=3){const t=d[e];d[e]=d[e+2],d[e+2]=t}}return{original_size:[l,s],reshaped_input_size:c,pixel_values:new o.Tensor("float32",d,p).permute(2,0,1)}}async _call(e){Array.isArray(e)||(e=[e]);const t=await Promise.all(e.map((e=>this.preprocess(e)))),n=(0,o.stack)(t.map((e=>e.pixel_values)),0);return{pixel_values:n,original_sizes:t.map((e=>e.original_size)),reshaped_input_sizes:t.map((e=>e.reshaped_input_size))}}static async from_pretrained(e,t){return new this(await(0,s.getModelJSON)(e,l.IMAGE_PROCESSOR_NAME,!0,t))}}},"./src/base/processing_utils.js":(e,t,n)=>{n.r(t),n.d(t,{Processor:()=>i});var r=n("./src/utils/constants.js"),o=n("./src/utils/generic.js"),a=n("./src/utils/hub.js");class i extends o.Callable{constructor(e,t){super(),this.config=e,this.components=t}get image_processor(){return this.components.image_processor}get tokenizer(){return this.components.tokenizer}get feature_extractor(){return this.components.feature_extractor}apply_chat_template(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!this.tokenizer)throw new Error("Unable to apply chat template without a tokenizer.");return this.tokenizer.apply_chat_template(e,so({tokenize:!1},t))}batch_decode(){if(!this.tokenizer)throw new Error("Unable to decode without a tokenizer.");return this.tokenizer.batch_decode(...arguments)}decode(){if(!this.tokenizer)throw new Error("Unable to decode without a tokenizer.");return this.tokenizer.decode(...arguments)}async _call(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];for(const o of[this.image_processor,this.feature_extractor,this.tokenizer])if(o)return o(e,...n);throw new Error("No image processor, feature extractor, or tokenizer found.")}static async from_pretrained(e,t){const[n,o]=await Promise.all([this.uses_processor_config?(0,a.getModelJSON)(e,r.PROCESSOR_NAME,!0,t):{},Promise.all(this.classes.filter((e=>e in this)).map((async n=>{const r=await this[n].from_pretrained(e,t);return[n.replace(/_class$/,""),r]}))).then(Object.fromEntries)]);return new this(n,o)}}ao(i,"classes",["image_processor_class","tokenizer_class","feature_extractor_class"]),ao(i,"uses_processor_config",!1)},"./src/configs.js":(e,t,n)=>{n.r(t),n.d(t,{AutoConfig:()=>l,PretrainedConfig:()=>s,getKeyValueShapes:()=>i});var r=n("./src/utils/core.js"),o=n("./src/utils/hub.js");function a(e){const t={};let n={};switch(e.model_type){case"llava":case"paligemma":case"gemma3":case"florence2":case"llava_onevision":case"idefics3":case"ultravox":case"smolvlm":n=a(e.text_config);break;case"moondream1":n=a(e.phi_config);break;case"musicgen":n=a(e.decoder);break;case"multi_modality":n=a(e.language_config);break;case"gpt2":case"gptj":case"jais":case"codegen":case"gpt_bigcode":t.num_heads="n_head",t.num_layers="n_layer",t.hidden_size="n_embd";break;case"gpt_neox":case"stablelm":case"opt":case"falcon":t.num_heads="num_attention_heads",t.num_layers="num_hidden_layers",t.hidden_size="hidden_size";break;case"llama":case"olmo":case"olmo2":case"mobilellm":case"granite":case"cohere":case"mistral":case"starcoder2":case"qwen2":case"qwen2_vl":case"phi":case"phi3":case"phi3_v":t.num_heads="num_key_value_heads",t.num_layers="num_hidden_layers",t.hidden_size="hidden_size",t.num_attention_heads="num_attention_heads";break;case"qwen3":case"gemma":case"gemma2":case"gemma3_text":case"glm":case"helium":t.num_heads="num_key_value_heads",t.num_layers="num_hidden_layers",t.dim_kv="head_dim";break;case"openelm":t.num_heads="num_kv_heads",t.num_layers="num_transformer_layers",t.dim_kv="head_dim";break;case"gpt_neo":case"donut-swin":t.num_heads="num_heads",t.num_layers="num_layers",t.hidden_size="hidden_size";break;case"bloom":t.num_heads="n_head",t.num_layers="n_layer",t.hidden_size="hidden_size";break;case"mpt":t.num_heads="n_heads",t.num_layers="n_layers",t.hidden_size="d_model";break;case"exaone":t.num_heads="num_key_value_heads",t.num_layers="num_layers",t.dim_kv="head_dim",t.num_attention_heads="num_attention_heads";break;case"t5":case"mt5":case"longt5":t.num_decoder_layers="num_decoder_layers",t.num_decoder_heads="num_heads",t.decoder_dim_kv="d_kv",t.num_encoder_layers="num_layers",t.num_encoder_heads="num_heads",t.encoder_dim_kv="d_kv";break;case"bart":case"mbart":case"marian":case"whisper":case"lite-whisper":case"m2m_100":case"blenderbot":case"blenderbot-small":case"florence2_language":t.num_decoder_layers="decoder_layers",t.num_decoder_heads="decoder_attention_heads",t.decoder_hidden_size="d_model",t.num_encoder_layers="encoder_layers",t.num_encoder_heads="encoder_attention_heads",t.encoder_hidden_size="d_model";break;case"speecht5":t.num_decoder_layers="decoder_layers",t.num_decoder_heads="decoder_attention_heads",t.decoder_hidden_size="hidden_size",t.num_encoder_layers="encoder_layers",t.num_encoder_heads="encoder_attention_heads",t.encoder_hidden_size="hidden_size";break;case"trocr":t.num_encoder_layers=t.num_decoder_layers="decoder_layers",t.num_encoder_heads=t.num_decoder_heads="decoder_attention_heads",t.encoder_hidden_size=t.decoder_hidden_size="d_model";break;case"musicgen_decoder":t.num_encoder_layers=t.num_decoder_layers="num_hidden_layers",t.num_encoder_heads=t.num_decoder_heads="num_attention_heads",t.encoder_hidden_size=t.decoder_hidden_size="hidden_size";break;case"moonshine":t.num_decoder_layers="decoder_num_hidden_layers",t.num_decoder_heads="decoder_num_key_value_heads",t.num_encoder_layers="encoder_num_hidden_layers",t.num_encoder_heads="encoder_num_key_value_heads",t.encoder_hidden_size=t.decoder_hidden_size="hidden_size";break;case"vision-encoder-decoder":const o=a(e.decoder),i="num_decoder_layers"in o,s=(0,r.pick)(e,["model_type","is_encoder_decoder"]);return i?(s.num_decoder_layers=o.num_decoder_layers,s.num_decoder_heads=o.num_decoder_heads,s.decoder_hidden_size=o.decoder_hidden_size,s.num_encoder_layers=o.num_encoder_layers,s.num_encoder_heads=o.num_encoder_heads,s.encoder_hidden_size=o.encoder_hidden_size):(s.num_layers=o.num_layers,s.num_heads=o.num_heads,s.hidden_size=o.hidden_size),s}const o=so(so({},n),(0,r.pick)(e,["model_type","multi_query","is_encoder_decoder"]));for(const r in t)o[r]=e[t[r]];return o}function i(e){let{prefix:t="past_key_values",batch_size:n=1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const r={},o=e.normalized_config;if(o.is_encoder_decoder&&"num_encoder_heads"in o&&"num_decoder_heads"in o){var a,i;const e=null!==(a=o.encoder_dim_kv)&&void 0!==a?a:o.encoder_hidden_size/o.num_encoder_heads,s=null!==(i=o.decoder_dim_kv)&&void 0!==i?i:o.decoder_hidden_size/o.num_decoder_heads,l=[n,o.num_encoder_heads,0,e],c=[n,o.num_decoder_heads,0,s];for(let n=0;n<o.num_decoder_layers;++n)r["".concat(t,".").concat(n,".encoder.key")]=l,r["".concat(t,".").concat(n,".encoder.value")]=l,r["".concat(t,".").concat(n,".decoder.key")]=c,r["".concat(t,".").concat(n,".decoder.value")]=c}else{var s,l;const e=o.num_heads,a=o.num_layers,i=null!==(s=o.dim_kv)&&void 0!==s?s:o.hidden_size/(null!==(l=o.num_attention_heads)&&void 0!==l?l:e);if("falcon"===o.model_type){const o=[n*e,0,i];for(let e=0;e<a;++e)r["".concat(t,".").concat(e,".key")]=o,r["".concat(t,".").concat(e,".value")]=o}else if(o.multi_query){const o=[n*e,0,2*i];for(let e=0;e<a;++e)r["".concat(t,".").concat(e,".key_value")]=o}else if("bloom"===o.model_type){const o=[n*e,i,0],s=[n*e,0,i];for(let e=0;e<a;++e)r["".concat(t,".").concat(e,".key")]=o,r["".concat(t,".").concat(e,".value")]=s}else if("openelm"===o.model_type)for(let o=0;o<a;++o){const a=[n,e[o],0,i];r["".concat(t,".").concat(o,".key")]=a,r["".concat(t,".").concat(o,".value")]=a}else{const o=[n,e,0,i];for(let e=0;e<a;++e)r["".concat(t,".").concat(e,".key")]=o,r["".concat(t,".").concat(e,".value")]=o}}return r}class s{constructor(e){ao(this,"model_type",null),ao(this,"is_encoder_decoder",!1),ao(this,"max_position_embeddings",void 0),ao(this,"transformers.js_config",void 0),Object.assign(this,e),this.normalized_config=a(this)}static async from_pretrained(e){let{progress_callback:t=null,config:n=null,cache_dir:r=null,local_files_only:a=!1,revision:i="main"}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!n||n instanceof s||(n=new s(n));const l=null!==n&&void 0!==n?n:await async function(e,t){return await(0,o.getModelJSON)(e,"config.json",!0,t)}(e,{progress_callback:t,config:n,cache_dir:r,local_files_only:a,revision:i});return new this(l)}}class l{static async from_pretrained(){return s.from_pretrained(...arguments)}}},"./src/env.js":(e,t,n)=>{var r,o;n.r(t),n.d(t,{apis:()=>_,env:()=>x});var a=n("?569f"),i=n("?3f59"),s=n("?154a");const l="undefined"!==typeof window&&"undefined"!==typeof window.document,c="undefined"!==typeof self&&"DedicatedWorkerGlobalScope"===(null===(r=self.constructor)||void 0===r?void 0:r.name),u="undefined"!==typeof self&&"caches"in self,d="undefined"!==typeof navigator&&"gpu"in navigator,p="undefined"!==typeof navigator&&"ml"in navigator,h="undefined"!==typeof process,f=h&&"node"===(null===(o=process)||void 0===o||null===(o=o.release)||void 0===o?void 0:o.name),m=!k(a),g=!k(i),_=Object.freeze({IS_BROWSER_ENV:l,IS_WEBWORKER_ENV:c,IS_WEB_CACHE_AVAILABLE:u,IS_WEBGPU_AVAILABLE:d,IS_WEBNN_AVAILABLE:p,IS_PROCESS_AVAILABLE:h,IS_NODE_ENV:f,IS_FS_AVAILABLE:m,IS_PATH_AVAILABLE:g}),v=m&&g;let y="./";if(v){const e=Object({}).url;e?y=i.dirname(i.dirname(s.fileURLToPath(e))):"undefined"!==typeof __dirname&&(y=i.dirname(__dirname))}const w=v?i.join(y,"/.cache/"):null,b="/models/",x={version:"3.5.2",backends:{onnx:{}},allowRemoteModels:!0,remoteHost:"https://huggingface.co/",remotePathTemplate:"{model}/resolve/{revision}/",allowLocalModels:!(l||c),localModelPath:v?i.join(y,b):b,useFS:m,useBrowserCache:u,useFSCache:m,cacheDir:w,useCustomCache:!1,customCache:null};function k(e){return 0===Object.keys(e).length}},"./src/generation/configuration_utils.js":(e,t,n)=>{n.r(t),n.d(t,{GenerationConfig:()=>o});var r=n("./src/utils/core.js");class o{constructor(e){ao(this,"max_length",20),ao(this,"max_new_tokens",null),ao(this,"min_length",0),ao(this,"min_new_tokens",null),ao(this,"early_stopping",!1),ao(this,"max_time",null),ao(this,"do_sample",!1),ao(this,"num_beams",1),ao(this,"num_beam_groups",1),ao(this,"penalty_alpha",null),ao(this,"use_cache",!0),ao(this,"temperature",1),ao(this,"top_k",50),ao(this,"top_p",1),ao(this,"typical_p",1),ao(this,"epsilon_cutoff",0),ao(this,"eta_cutoff",0),ao(this,"diversity_penalty",0),ao(this,"repetition_penalty",1),ao(this,"encoder_repetition_penalty",1),ao(this,"length_penalty",1),ao(this,"no_repeat_ngram_size",0),ao(this,"bad_words_ids",null),ao(this,"force_words_ids",null),ao(this,"renormalize_logits",!1),ao(this,"constraints",null),ao(this,"forced_bos_token_id",null),ao(this,"forced_eos_token_id",null),ao(this,"remove_invalid_values",!1),ao(this,"exponential_decay_length_penalty",null),ao(this,"suppress_tokens",null),ao(this,"streamer",null),ao(this,"begin_suppress_tokens",null),ao(this,"forced_decoder_ids",null),ao(this,"guidance_scale",null),ao(this,"num_return_sequences",1),ao(this,"output_attentions",!1),ao(this,"output_hidden_states",!1),ao(this,"output_scores",!1),ao(this,"return_dict_in_generate",!1),ao(this,"pad_token_id",null),ao(this,"bos_token_id",null),ao(this,"eos_token_id",null),ao(this,"encoder_no_repeat_ngram_size",0),ao(this,"decoder_start_token_id",null),ao(this,"generation_kwargs",{}),Object.assign(this,(0,r.pick)(e,Object.getOwnPropertyNames(this)))}}},"./src/generation/logits_process.js":(e,t,n)=>{n.r(t),n.d(t,{ClassifierFreeGuidanceLogitsProcessor:()=>_,ForcedBOSTokenLogitsProcessor:()=>l,ForcedEOSTokenLogitsProcessor:()=>c,LogitsProcessor:()=>a,LogitsProcessorList:()=>s,LogitsWarper:()=>i,MinLengthLogitsProcessor:()=>f,MinNewTokensLengthLogitsProcessor:()=>m,NoBadWordsLogitsProcessor:()=>g,NoRepeatNGramLogitsProcessor:()=>p,RepetitionPenaltyLogitsProcessor:()=>h,SuppressTokensAtBeginLogitsProcessor:()=>u,TemperatureLogitsWarper:()=>v,TopKLogitsWarper:()=>w,TopPLogitsWarper:()=>y,WhisperTimeStampLogitsProcessor:()=>d});var r=n("./src/utils/generic.js"),o=(n("./src/utils/tensor.js"),n("./src/utils/maths.js"));class a extends r.Callable{_call(e,t){throw Error("`_call` should be implemented in a subclass")}}class i extends r.Callable{_call(e,t){throw Error("`_call` should be implemented in a subclass")}}class s extends r.Callable{constructor(){super(),this.processors=[]}push(e){this.processors.push(e)}extend(e){this.processors.push(...e)}_call(e,t){let n=t;for(const r of this.processors)n=r(e,n);return n}[Symbol.iterator](){return this.processors.values()}}class l extends a{constructor(e){super(),this.bos_token_id=e}_call(e,t){for(let n=0;n<e.length;++n)if(1===e[n].length){const e=t[n].data;e.fill(-1/0),e[this.bos_token_id]=0}return t}}class c extends a{constructor(e,t){super(),this.max_length=e,this.eos_token_id=Array.isArray(t)?t:[t]}_call(e,t){for(let n=0;n<e.length;++n)if(e[n].length===this.max_length-1){const e=t[n].data;e.fill(-1/0);for(const t of this.eos_token_id)e[t]=0}return t}}class u extends a{constructor(e,t){super(),this.begin_suppress_tokens=e,this.begin_index=t}_call(e,t){for(let n=0;n<e.length;++n)if(e[n].length===this.begin_index){const e=t[n].data;for(const t of this.begin_suppress_tokens)e[t]=-1/0}return t}}class d extends a{constructor(e,t){super(),this.eos_token_id=Array.isArray(e.eos_token_id)?e.eos_token_id[0]:e.eos_token_id,this.no_timestamps_token_id=e.no_timestamps_token_id,this.timestamp_begin=this.no_timestamps_token_id+1,this.begin_index=t.length,t.at(-1)===this.no_timestamps_token_id&&(this.begin_index-=1),this.max_initial_timestamp_index=e.max_initial_timestamp_index}_call(e,t){for(let n=0;n<e.length;++n){const r=t[n].data;if(r[this.no_timestamps_token_id]=-1/0,e[n].length===this.begin_index-1){r.fill(-1/0),r[this.timestamp_begin]=0;continue}const a=e[n].slice(this.begin_index),i=a.length>=1&&a[a.length-1]>=this.timestamp_begin,s=a.length<2||a[a.length-2]>=this.timestamp_begin;if(i&&(s?r.subarray(this.timestamp_begin).fill(-1/0):r.subarray(0,this.eos_token_id).fill(-1/0)),e[n].length===this.begin_index&&null!==this.max_initial_timestamp_index){const e=this.timestamp_begin+this.max_initial_timestamp_index;r.subarray(e+1).fill(-1/0)}const l=(0,o.log_softmax)(r),c=Math.log(l.subarray(this.timestamp_begin).map(Math.exp).reduce(((e,t)=>e+t)));c>(0,o.max)(l.subarray(0,this.timestamp_begin))[0]&&r.subarray(0,this.timestamp_begin).fill(-1/0)}return t}}class p extends a{constructor(e){super(),this.no_repeat_ngram_size=e}getNgrams(e){const t=e.length,n=[];for(let a=0;a<t+1-this.no_repeat_ngram_size;++a){const t=[];for(let n=0;n<this.no_repeat_ngram_size;++n)t.push(e[a+n]);n.push(t.map(Number))}const r=new Map;for(const a of n){var o;const e=a.slice(0,a.length-1),t=JSON.stringify(e),n=null!==(o=r.get(t))&&void 0!==o?o:[];n.push(a[a.length-1]),r.set(t,n)}return r}getGeneratedNgrams(e,t){var n;const r=t.slice(t.length+1-this.no_repeat_ngram_size,t.length);return null!==(n=e.get(JSON.stringify(r.map(Number))))&&void 0!==n?n:[]}calcBannedNgramTokens(e){const t=[];if(e.length+1<this.no_repeat_ngram_size)return t;{const t=this.getNgrams(e);return this.getGeneratedNgrams(t,e)}}_call(e,t){for(let n=0;n<e.length;++n){const r=t[n].data,o=this.calcBannedNgramTokens(e[n]);for(const e of o)r[e]=-1/0}return t}}class h extends a{constructor(e){super(),this.penalty=e}_call(e,t){for(let n=0;n<e.length;++n){const r=t[n].data;for(const t of new Set(e[n])){const e=Number(t);r[e]<0?r[e]*=this.penalty:r[e]/=this.penalty}}return t}}class f extends a{constructor(e,t){super(),this.min_length=e,this.eos_token_id=Array.isArray(t)?t:[t]}_call(e,t){for(let n=0;n<e.length;++n)if(e[n].length<this.min_length){const e=t[n].data;for(const t of this.eos_token_id)e[t]=-1/0}return t}}class m extends a{constructor(e,t,n){super(),this.prompt_length_to_skip=e,this.min_new_tokens=t,this.eos_token_id=Array.isArray(n)?n:[n]}_call(e,t){for(let n=0;n<e.length;++n){if(e[n].length-this.prompt_length_to_skip<this.min_new_tokens){const e=t[n].data;for(const t of this.eos_token_id)e[t]=-1/0}}return t}}class g extends a{constructor(e,t){super(),this.bad_words_ids=e,this.eos_token_id=Array.isArray(t)?t:[t]}_call(e,t){for(let n=0;n<e.length;++n){const r=t[n].data,o=e[n];for(const e of this.bad_words_ids){if(o.length<e.length-1)continue;let t=!0;for(let n=1;n<=e.length-1;++n)if(e.at(-n-1)!=o.at(-n)){t=!1;break}t&&(r[e.at(-1)]=-1/0)}}return t}}class _ extends a{constructor(e){if(super(),e<=1)throw new Error("Require guidance scale >1 to use the classifier free guidance processor, got guidance scale ".concat(e,"."));this.guidance_scale=e}_call(e,t){if(t.dims[0]!==2*e.length)throw new Error("Logits should have twice the batch size of the input ids, the first half of batches corresponding to the conditional inputs, and the second half of batches corresponding to the unconditional inputs. Got "+"batch size ".concat(t.dims[0]," for the logits and ").concat(e.length," for the input ids."));const n=e.length,r=t.slice([0,n],null),o=t.slice([n,t.dims[0]],null);for(let a=0;a<o.data.length;++a)o.data[a]+=(r.data[a]-o.data[a])*this.guidance_scale;return o}}class v extends i{constructor(e){if(super(),"number"!==typeof e||e<=0){let t="`temperature` (=".concat(e,") must be a strictly positive float, otherwise your next token scores will be invalid.");0===e&&(t+=" If you're looking for greedy decoding strategies, set `do_sample=false`.")}this.temperature=e}_call(e,t){const n=t.data;for(let r=0;r<n.length;++r)n[r]/=this.temperature;return t}}class y extends i{constructor(e){let{filter_value:t=-1/0,min_tokens_to_keep:n=1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(super(),e<0||e>1)throw new Error("`top_p` must be a float > 0 and < 1, but is ".concat(e));if(!Number.isInteger(n)||n<1)throw new Error("`min_tokens_to_keep` must be a positive integer, but is ".concat(n));this.top_p=e,this.filter_value=t,this.min_tokens_to_keep=n}}class w extends i{constructor(e){let{filter_value:t=-1/0,min_tokens_to_keep:n=1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(super(),!Number.isInteger(e)||e<0)throw new Error("`top_k` must be a positive integer, but is ".concat(e));this.top_k=Math.max(e,n),this.filter_value=t}}},"./src/generation/logits_sampler.js":(e,t,n)=>{n.r(t),n.d(t,{LogitsSampler:()=>i});var r=n("./src/utils/generic.js"),o=n("./src/utils/tensor.js"),a=n("./src/utils/maths.js");n("./src/generation/configuration_utils.js");class i extends r.Callable{constructor(e){super(),this.generation_config=e}async _call(e){return this.sample(e)}async sample(e){throw Error("sample should be implemented in subclasses.")}getLogits(e,t){let n=e.dims.at(-1),r=e.data;if(-1===t)r=r.slice(-n);else{let e=t*n;r=r.slice(e,e+n)}return r}randomSelect(e){let t=0;for(let r=0;r<e.length;++r)t+=e[r];let n=Math.random()*t;for(let r=0;r<e.length;++r)if(n-=e[r],n<=0)return r;return 0}static getSampler(e){if(e.do_sample)return new l(e);if(e.num_beams>1)return new c(e);if(e.num_return_sequences>1)throw Error("num_return_sequences has to be 1 when doing greedy search, but is ".concat(e.num_return_sequences,"."));return new s(e)}}class s extends i{async sample(e){const t=(0,a.max)(e.data)[1];return[[BigInt(t),0]]}}class l extends i{async sample(e){let t=e.dims.at(-1);this.generation_config.top_k>0&&(t=Math.min(this.generation_config.top_k,t));const[n,r]=await(0,o.topk)(e,t),i=(0,a.softmax)(n.data);return Array.from({length:this.generation_config.num_beams},(()=>{const e=this.randomSelect(i);return[r.data[e],Math.log(i[e])]}))}}class c extends i{async sample(e){let t=e.dims.at(-1);this.generation_config.top_k>0&&(t=Math.min(this.generation_config.top_k,t));const[n,r]=await(0,o.topk)(e,t),i=(0,a.softmax)(n.data);return Array.from({length:this.generation_config.num_beams},((e,t)=>[r.data[t],Math.log(i[t])]))}}},"./src/generation/stopping_criteria.js":(e,t,n)=>{n.r(t),n.d(t,{EosTokenCriteria:()=>s,InterruptableStoppingCriteria:()=>l,MaxLengthCriteria:()=>i,StoppingCriteria:()=>o,StoppingCriteriaList:()=>a});var r=n("./src/utils/generic.js");class o extends r.Callable{_call(e,t){throw Error("StoppingCriteria needs to be subclassed")}}class a extends r.Callable{constructor(){super(),this.criteria=[]}push(e){this.criteria.push(e)}extend(e){e instanceof a?e=e.criteria:e instanceof o&&(e=[e]),this.criteria.push(...e)}_call(e,t){const n=new Array(e.length).fill(!1);for(const o of this.criteria){const a=o(e,t);for(let e=0;e<n.length;++e){var r;n[r=e]||(n[r]=a[e])}}return n}[Symbol.iterator](){return this.criteria.values()}}class i extends o{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;super(),this.max_length=e,this.max_position_embeddings=t}_call(e){return e.map((e=>e.length>=this.max_length))}}class s extends o{constructor(e){super(),Array.isArray(e)||(e=[e]),this.eos_token_id=e}_call(e,t){return e.map((e=>{const t=e.at(-1);return this.eos_token_id.some((e=>t==e))}))}}class l extends o{constructor(){super(),this.interrupted=!1}interrupt(){this.interrupted=!0}reset(){this.interrupted=!1}_call(e,t){return new Array(e.length).fill(this.interrupted)}}},"./src/generation/streamers.js":(e,t,n)=>{n.r(t),n.d(t,{BaseStreamer:()=>i,TextStreamer:()=>l,WhisperTextStreamer:()=>c});var r=n("./src/utils/core.js"),o=n("./src/tokenizers.js"),a=n("./src/env.js");class i{put(e){throw Error("Not implemented")}end(){throw Error("Not implemented")}}const s=a.apis.IS_PROCESS_AVAILABLE?e=>process.stdout.write(e):e=>console.log(e);class l extends i{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{skip_prompt:n=!1,callback_function:r=null,token_callback_function:o=null,skip_special_tokens:a=!0,decode_kwargs:i={}}=t,l=Kc(t,UN);super(),this.tokenizer=e,this.skip_prompt=n,this.callback_function=null!==r&&void 0!==r?r:s,this.token_callback_function=o,this.decode_kwargs=so(so({skip_special_tokens:a},i),l),this.token_cache=[],this.print_len=0,this.next_tokens_are_prompt=!0}put(e){var t;if(e.length>1)throw Error("TextStreamer only supports batch size of 1");const n=this.next_tokens_are_prompt;if(n&&(this.next_tokens_are_prompt=!1,this.skip_prompt))return;const a=e[0];null===(t=this.token_callback_function)||void 0===t||t.call(this,a),this.token_cache=(0,r.mergeArrays)(this.token_cache,a);const i=this.tokenizer.decode(this.token_cache,this.decode_kwargs);let s;n||i.endsWith("\n")?(s=i.slice(this.print_len),this.token_cache=[],this.print_len=0):i.length>0&&(0,o.is_chinese_char)(i.charCodeAt(i.length-1))?(s=i.slice(this.print_len),this.print_len+=s.length):(s=i.slice(this.print_len,i.lastIndexOf(" ")+1),this.print_len+=s.length),this.on_finalized_text(s,!1)}end(){let e;if(this.token_cache.length>0){e=this.tokenizer.decode(this.token_cache,this.decode_kwargs).slice(this.print_len),this.token_cache=[],this.print_len=0}else e="";this.next_tokens_are_prompt=!0,this.on_finalized_text(e,!0)}on_finalized_text(e,t){var n,r;e.length>0&&(null===(n=this.callback_function)||void 0===n||n.call(this,e));t&&this.callback_function===s&&a.apis.IS_PROCESS_AVAILABLE&&(null===(r=this.callback_function)||void 0===r||r.call(this,"\n"))}}class c extends l{constructor(e){let{skip_prompt:t=!1,callback_function:n=null,token_callback_function:r=null,on_chunk_start:o=null,on_chunk_end:a=null,on_finalize:i=null,time_precision:s=.02,skip_special_tokens:l=!0,decode_kwargs:c={}}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(e,{skip_prompt:t,skip_special_tokens:l,callback_function:n,token_callback_function:r,decode_kwargs:c}),this.timestamp_begin=e.timestamp_begin,this.on_chunk_start=o,this.on_chunk_end=a,this.on_finalize=i,this.time_precision=s,this.waiting_for_timestamp=!1}put(e){if(e.length>1)throw Error("WhisperTextStreamer only supports batch size of 1");const t=e[0];if(1===t.length){const e=Number(t[0])-this.timestamp_begin;if(e>=0){var n;const a=e*this.time_precision;var r,o;if(this.waiting_for_timestamp)null===(r=this.on_chunk_end)||void 0===r||r.call(this,a);else null===(o=this.on_chunk_start)||void 0===o||o.call(this,a);return this.waiting_for_timestamp=!this.waiting_for_timestamp,void(null===(n=this.token_callback_function)||void 0===n||n.call(this,t))}}return super.put(e)}end(){var e;super.end(),null===(e=this.on_finalize)||void 0===e||e.call(this)}}},"./src/models.js":(e,t,n)=>{n.r(t),n.d(t,{ASTForAudioClassification:()=>kn,ASTModel:()=>xn,ASTPreTrainedModel:()=>bn,AlbertForMaskedLM:()=>Ft,AlbertForQuestionAnswering:()=>Mt,AlbertForSequenceClassification:()=>At,AlbertModel:()=>Tt,AlbertPreTrainedModel:()=>Et,AutoModel:()=>iu,AutoModelForAudioClassification:()=>Du,AutoModelForAudioFrameClassification:()=>Eu,AutoModelForAudioTextToText:()=>Nu,AutoModelForCTC:()=>Cu,AutoModelForCausalLM:()=>hu,AutoModelForDepthEstimation:()=>Fu,AutoModelForDocumentQuestionAnswering:()=>Tu,AutoModelForImageClassification:()=>_u,AutoModelForImageFeatureExtraction:()=>zu,AutoModelForImageMatting:()=>Au,AutoModelForImageSegmentation:()=>vu,AutoModelForImageTextToText:()=>Ou,AutoModelForImageToImage:()=>Mu,AutoModelForMaskGeneration:()=>ku,AutoModelForMaskedLM:()=>fu,AutoModelForNormalEstimation:()=>Iu,AutoModelForObjectDetection:()=>bu,AutoModelForPoseEstimation:()=>Pu,AutoModelForQuestionAnswering:()=>mu,AutoModelForSemanticSegmentation:()=>yu,AutoModelForSeq2SeqLM:()=>cu,AutoModelForSequenceClassification:()=>su,AutoModelForSpeechSeq2Seq:()=>uu,AutoModelForTextToSpectrogram:()=>du,AutoModelForTextToWaveform:()=>pu,AutoModelForTokenClassification:()=>lu,AutoModelForUniversalSegmentation:()=>wu,AutoModelForVision2Seq:()=>gu,AutoModelForXVector:()=>Su,AutoModelForZeroShotObjectDetection:()=>xu,BartForConditionalGeneration:()=>Ut,BartForSequenceClassification:()=>Wt,BartModel:()=>qt,BartPretrainedModel:()=>Vt,BaseModelOutput:()=>oe,BeitForImageClassification:()=>Da,BeitModel:()=>Ca,BeitPreTrainedModel:()=>ka,BertForMaskedLM:()=>se,BertForQuestionAnswering:()=>ue,BertForSequenceClassification:()=>le,BertForTokenClassification:()=>ce,BertModel:()=>ie,BertPreTrainedModel:()=>ae,BlenderbotForConditionalGeneration:()=>Qt,BlenderbotModel:()=>Jt,BlenderbotPreTrainedModel:()=>Xt,BlenderbotSmallForConditionalGeneration:()=>tn,BlenderbotSmallModel:()=>en,BlenderbotSmallPreTrainedModel:()=>Yt,BloomForCausalLM:()=>Oo,BloomModel:()=>zo,BloomPreTrainedModel:()=>Po,CLIPModel:()=>Hn,CLIPPreTrainedModel:()=>Gn,CLIPSegForImageSegmentation:()=>cr,CLIPSegModel:()=>lr,CLIPSegPreTrainedModel:()=>sr,CLIPTextModel:()=>Kn,CLIPTextModelWithProjection:()=>Zn,CLIPVisionModel:()=>$n,CLIPVisionModelWithProjection:()=>Xn,CamembertForMaskedLM:()=>je,CamembertForQuestionAnswering:()=>Ve,CamembertForSequenceClassification:()=>Le,CamembertForTokenClassification:()=>Re,CamembertModel:()=>Be,CamembertPreTrainedModel:()=>Ne,CausalLMOutput:()=>Uu,CausalLMOutputWithPast:()=>Wu,ChineseCLIPModel:()=>nr,ChineseCLIPPreTrainedModel:()=>tr,ClapAudioModelWithProjection:()=>cl,ClapModel:()=>sl,ClapPreTrainedModel:()=>il,ClapTextModelWithProjection:()=>ll,CodeGenForCausalLM:()=>Mr,CodeGenModel:()=>Ar,CodeGenPreTrainedModel:()=>Tr,CohereForCausalLM:()=>ro,CohereModel:()=>no,CoherePreTrainedModel:()=>to,ConvBertForMaskedLM:()=>Se,ConvBertForQuestionAnswering:()=>Ae,ConvBertForSequenceClassification:()=>Ee,ConvBertForTokenClassification:()=>Te,ConvBertModel:()=>De,ConvBertPreTrainedModel:()=>Ce,ConvNextForImageClassification:()=>ji,ConvNextModel:()=>Bi,ConvNextPreTrainedModel:()=>Ni,ConvNextV2ForImageClassification:()=>Vi,ConvNextV2Model:()=>Ri,ConvNextV2PreTrainedModel:()=>Li,DFineForObjectDetection:()=>Ha,DFineModel:()=>Ga,DFinePreTrainedModel:()=>Wa,DPTForDepthEstimation:()=>mi,DPTModel:()=>fi,DPTPreTrainedModel:()=>hi,DacDecoderModel:()=>fc,DacDecoderOutput:()=>dc,DacEncoderModel:()=>hc,DacEncoderOutput:()=>uc,DacModel:()=>pc,DacPreTrainedModel:()=>cc,DebertaForMaskedLM:()=>We,DebertaForQuestionAnswering:()=>Ke,DebertaForSequenceClassification:()=>Ge,DebertaForTokenClassification:()=>He,DebertaModel:()=>Ue,DebertaPreTrainedModel:()=>qe,DebertaV2ForMaskedLM:()=>Xe,DebertaV2ForQuestionAnswering:()=>Ye,DebertaV2ForSequenceClassification:()=>Je,DebertaV2ForTokenClassification:()=>Qe,DebertaV2Model:()=>$e,DebertaV2PreTrainedModel:()=>Ze,DecisionTransformerModel:()=>Ul,DecisionTransformerPreTrainedModel:()=>ql,DeiTForImageClassification:()=>Ya,DeiTModel:()=>Qa,DeiTPreTrainedModel:()=>Ja,DepthAnythingForDepthEstimation:()=>_i,DepthAnythingPreTrainedModel:()=>gi,DepthProForDepthEstimation:()=>ki,DepthProPreTrainedModel:()=>xi,DetrForObjectDetection:()=>Ta,DetrForSegmentation:()=>Aa,DetrModel:()=>Ea,DetrObjectDetectionOutput:()=>Ma,DetrPreTrainedModel:()=>Sa,DetrSegmentationOutput:()=>Fa,Dinov2ForImageClassification:()=>Wi,Dinov2Model:()=>Ui,Dinov2PreTrainedModel:()=>qi,Dinov2WithRegistersForImageClassification:()=>Ki,Dinov2WithRegistersModel:()=>Hi,Dinov2WithRegistersPreTrainedModel:()=>Gi,DistilBertForMaskedLM:()=>at,DistilBertForQuestionAnswering:()=>ot,DistilBertForSequenceClassification:()=>nt,DistilBertForTokenClassification:()=>rt,DistilBertModel:()=>tt,DistilBertPreTrainedModel:()=>et,DonutSwinModel:()=>Oi,DonutSwinPreTrainedModel:()=>zi,EfficientNetForImageClassification:()=>bl,EfficientNetModel:()=>wl,EfficientNetPreTrainedModel:()=>yl,ElectraForMaskedLM:()=>Ie,ElectraForQuestionAnswering:()=>Oe,ElectraForSequenceClassification:()=>Pe,ElectraForTokenClassification:()=>ze,ElectraModel:()=>Fe,ElectraPreTrainedModel:()=>Me,EsmForMaskedLM:()=>lt,EsmForSequenceClassification:()=>ct,EsmForTokenClassification:()=>ut,EsmModel:()=>st,EsmPreTrainedModel:()=>it,ExaoneForCausalLM:()=>qr,ExaoneModel:()=>Vr,ExaonePreTrainedModel:()=>Rr,FalconForCausalLM:()=>al,FalconModel:()=>ol,FalconPreTrainedModel:()=>rl,FastViTForImageClassification:()=>la,FastViTModel:()=>sa,FastViTPreTrainedModel:()=>ia,Florence2ForConditionalGeneration:()=>Bn,Florence2PreTrainedModel:()=>Nn,GLPNForDepthEstimation:()=>Pi,GLPNModel:()=>Ii,GLPNPreTrainedModel:()=>Fi,GPT2LMHeadModel:()=>pr,GPT2Model:()=>dr,GPT2PreTrainedModel:()=>ur,GPTBigCodeForCausalLM:()=>Er,GPTBigCodeModel:()=>Sr,GPTBigCodePreTrainedModel:()=>Dr,GPTJForCausalLM:()=>Cr,GPTJModel:()=>kr,GPTJPreTrainedModel:()=>xr,GPTNeoForCausalLM:()=>vr,GPTNeoModel:()=>_r,GPTNeoPreTrainedModel:()=>gr,GPTNeoXForCausalLM:()=>br,GPTNeoXModel:()=>wr,GPTNeoXPreTrainedModel:()=>yr,Gemma2ForCausalLM:()=>po,Gemma2Model:()=>uo,Gemma2PreTrainedModel:()=>co,Gemma3ForCausalLM:()=>mo,Gemma3Model:()=>fo,Gemma3PreTrainedModel:()=>ho,GemmaForCausalLM:()=>lo,GemmaModel:()=>io,GemmaPreTrainedModel:()=>oo,GlmForCausalLM:()=>Lr,GlmModel:()=>jr,GlmPreTrainedModel:()=>Br,GraniteForCausalLM:()=>eo,GraniteModel:()=>Yr,GranitePreTrainedModel:()=>Qr,GroundingDinoForObjectDetection:()=>$i,GroundingDinoPreTrainedModel:()=>Zi,GroupViTModel:()=>aa,GroupViTPreTrainedModel:()=>oa,HeliumForCausalLM:()=>Nr,HeliumModel:()=>Or,HeliumPreTrainedModel:()=>zr,HieraForImageClassification:()=>ni,HieraModel:()=>ti,HieraPreTrainedModel:()=>ei,HubertForCTC:()=>zs,HubertForSequenceClassification:()=>Os,HubertModel:()=>Ps,HubertPreTrainedModel:()=>Is,IJepaForImageClassification:()=>Ko,IJepaModel:()=>Ho,IJepaPreTrainedModel:()=>Go,Idefics3ForConditionalGeneration:()=>Vn,Idefics3PreTrainedModel:()=>Rn,ImageMattingOutput:()=>Gu,JAISLMHeadModel:()=>mr,JAISModel:()=>fr,JAISPreTrainedModel:()=>hr,JinaCLIPModel:()=>or,JinaCLIPPreTrainedModel:()=>rr,JinaCLIPTextModel:()=>ar,JinaCLIPVisionModel:()=>ir,LiteWhisperForConditionalGeneration:()=>En,LlamaForCausalLM:()=>Pr,LlamaModel:()=>Ir,LlamaPreTrainedModel:()=>Fr,LlavaForConditionalGeneration:()=>Pn,LlavaOnevisionForConditionalGeneration:()=>zn,LlavaPreTrainedModel:()=>In,LongT5ForConditionalGeneration:()=>Bt,LongT5Model:()=>Nt,LongT5PreTrainedModel:()=>Ot,M2M100ForConditionalGeneration:()=>ls,M2M100Model:()=>ss,M2M100PreTrainedModel:()=>is,MBartForCausalLM:()=>$t,MBartForConditionalGeneration:()=>Kt,MBartForSequenceClassification:()=>Zt,MBartModel:()=>Ht,MBartPreTrainedModel:()=>Gt,MPNetForMaskedLM:()=>vt,MPNetForQuestionAnswering:()=>bt,MPNetForSequenceClassification:()=>yt,MPNetForTokenClassification:()=>wt,MPNetModel:()=>_t,MPNetPreTrainedModel:()=>gt,MT5ForConditionalGeneration:()=>Rt,MT5Model:()=>Lt,MT5PreTrainedModel:()=>jt,MarianMTModel:()=>as,MarianModel:()=>os,MarianPreTrainedModel:()=>rs,MaskFormerForInstanceSegmentation:()=>Mi,MaskFormerModel:()=>Ai,MaskFormerPreTrainedModel:()=>Ti,MaskedLMOutput:()=>Vu,Metric3DForDepthEstimation:()=>Di,Metric3DPreTrainedModel:()=>Ci,Metric3Dv2ForDepthEstimation:()=>Ei,Metric3Dv2PreTrainedModel:()=>Si,MgpstrForSceneTextRecognition:()=>Zl,MgpstrModelOutput:()=>Hl,MgpstrPreTrainedModel:()=>Kl,MimiDecoderModel:()=>lc,MimiDecoderOutput:()=>ac,MimiEncoderModel:()=>sc,MimiEncoderOutput:()=>oc,MimiModel:()=>ic,MimiPreTrainedModel:()=>rc,MistralForCausalLM:()=>Ys,MistralModel:()=>Qs,MistralPreTrainedModel:()=>Js,MobileBertForMaskedLM:()=>ht,MobileBertForQuestionAnswering:()=>mt,MobileBertForSequenceClassification:()=>ft,MobileBertModel:()=>pt,MobileBertPreTrainedModel:()=>dt,MobileLLMForCausalLM:()=>Gr,MobileLLMModel:()=>Wr,MobileLLMPreTrainedModel:()=>Ur,MobileNetV1ForImageClassification:()=>Tl,MobileNetV1ForSemanticSegmentation:()=>Al,MobileNetV1Model:()=>El,MobileNetV1PreTrainedModel:()=>Sl,MobileNetV2ForImageClassification:()=>Il,MobileNetV2ForSemanticSegmentation:()=>Pl,MobileNetV2Model:()=>Fl,MobileNetV2PreTrainedModel:()=>Ml,MobileNetV3ForImageClassification:()=>Nl,MobileNetV3ForSemanticSegmentation:()=>Bl,MobileNetV3Model:()=>Ol,MobileNetV3PreTrainedModel:()=>zl,MobileNetV4ForImageClassification:()=>Rl,MobileNetV4ForSemanticSegmentation:()=>Vl,MobileNetV4Model:()=>Ll,MobileNetV4PreTrainedModel:()=>jl,MobileViTForImageClassification:()=>ha,MobileViTModel:()=>pa,MobileViTPreTrainedModel:()=>da,MobileViTV2ForImageClassification:()=>ga,MobileViTV2Model:()=>ma,MobileViTV2PreTrainedModel:()=>fa,ModelOutput:()=>re,ModernBertForMaskedLM:()=>he,ModernBertForSequenceClassification:()=>fe,ModernBertForTokenClassification:()=>me,ModernBertModel:()=>pe,ModernBertPreTrainedModel:()=>de,Moondream1ForConditionalGeneration:()=>On,MoonshineForConditionalGeneration:()=>Mn,MoonshineModel:()=>An,MoonshinePreTrainedModel:()=>Tn,MptForCausalLM:()=>jo,MptModel:()=>Bo,MptPreTrainedModel:()=>No,MultiModalityCausalLM:()=>Gl,MultiModalityPreTrainedModel:()=>Wl,MusicgenForCausalLM:()=>Cl,MusicgenForConditionalGeneration:()=>Dl,MusicgenModel:()=>kl,MusicgenPreTrainedModel:()=>xl,NomicBertModel:()=>_e,NomicBertPreTrainedModel:()=>ge,OPTForCausalLM:()=>Vo,OPTModel:()=>Ro,OPTPreTrainedModel:()=>Lo,Olmo2ForCausalLM:()=>Jr,Olmo2Model:()=>Xr,Olmo2PreTrainedModel:()=>$r,OlmoForCausalLM:()=>Zr,OlmoModel:()=>Kr,OlmoPreTrainedModel:()=>Hr,OpenELMForCausalLM:()=>vo,OpenELMModel:()=>_o,OpenELMPreTrainedModel:()=>go,OwlViTForObjectDetection:()=>ya,OwlViTModel:()=>va,OwlViTPreTrainedModel:()=>_a,Owlv2ForObjectDetection:()=>xa,Owlv2Model:()=>ba,Owlv2PreTrainedModel:()=>wa,PaliGemmaForConditionalGeneration:()=>Ln,PaliGemmaPreTrainedModel:()=>jn,PatchTSMixerForPrediction:()=>ec,PatchTSMixerModel:()=>Yl,PatchTSMixerPreTrainedModel:()=>Ql,PatchTSTForPrediction:()=>Jl,PatchTSTModel:()=>Xl,PatchTSTPreTrainedModel:()=>$l,Phi3ForCausalLM:()=>Io,Phi3Model:()=>Fo,Phi3PreTrainedModel:()=>Mo,Phi3VForCausalLM:()=>Wn,Phi3VPreTrainedModel:()=>Un,PhiForCausalLM:()=>Ao,PhiModel:()=>To,PhiPreTrainedModel:()=>Eo,PreTrainedModel:()=>ne,PretrainedMixin:()=>yc,PvtForImageClassification:()=>Qo,PvtModel:()=>Jo,PvtPreTrainedModel:()=>Xo,PyAnnoteForAudioFrameClassification:()=>gs,PyAnnoteModel:()=>ms,PyAnnotePreTrainedModel:()=>fs,QuestionAnsweringModelOutput:()=>qu,Qwen2ForCausalLM:()=>bo,Qwen2Model:()=>wo,Qwen2PreTrainedModel:()=>yo,Qwen2VLForConditionalGeneration:()=>So,Qwen2VLPreTrainedModel:()=>Do,Qwen3ForCausalLM:()=>Co,Qwen3Model:()=>ko,Qwen3PreTrainedModel:()=>xo,RFDetrForObjectDetection:()=>qa,RFDetrModel:()=>Va,RFDetrObjectDetectionOutput:()=>Ua,RFDetrPreTrainedModel:()=>Ra,RTDetrForObjectDetection:()=>za,RTDetrModel:()=>Pa,RTDetrObjectDetectionOutput:()=>Oa,RTDetrPreTrainedModel:()=>Ia,RTDetrV2ForObjectDetection:()=>ja,RTDetrV2Model:()=>Ba,RTDetrV2ObjectDetectionOutput:()=>La,RTDetrV2PreTrainedModel:()=>Na,ResNetForImageClassification:()=>ai,ResNetModel:()=>oi,ResNetPreTrainedModel:()=>ri,RoFormerForMaskedLM:()=>we,RoFormerForQuestionAnswering:()=>ke,RoFormerForSequenceClassification:()=>be,RoFormerForTokenClassification:()=>xe,RoFormerModel:()=>ye,RoFormerPreTrainedModel:()=>ve,RobertaForMaskedLM:()=>on,RobertaForQuestionAnswering:()=>ln,RobertaForSequenceClassification:()=>an,RobertaForTokenClassification:()=>sn,RobertaModel:()=>rn,RobertaPreTrainedModel:()=>nn,SamImageSegmentationOutput:()=>ns,SamModel:()=>ts,SamPreTrainedModel:()=>es,SapiensForDepthEstimation:()=>wi,SapiensForNormalEstimation:()=>bi,SapiensForSemanticSegmentation:()=>yi,SapiensPreTrainedModel:()=>vi,SegformerForImageClassification:()=>fl,SegformerForSemanticSegmentation:()=>ml,SegformerModel:()=>hl,SegformerPreTrainedModel:()=>pl,Seq2SeqLMOutput:()=>Bu,SequenceClassifierOutput:()=>ju,SiglipModel:()=>Qn,SiglipPreTrainedModel:()=>Jn,SiglipTextModel:()=>Yn,SiglipVisionModel:()=>er,SmolVLMForConditionalGeneration:()=>qn,SnacDecoderModel:()=>vc,SnacEncoderModel:()=>_c,SnacModel:()=>gc,SnacPreTrainedModel:()=>mc,SpeechT5ForSpeechToText:()=>Hs,SpeechT5ForTextToSpeech:()=>Ks,SpeechT5HifiGan:()=>Zs,SpeechT5Model:()=>Gs,SpeechT5PreTrainedModel:()=>Ws,SqueezeBertForMaskedLM:()=>Ct,SqueezeBertForQuestionAnswering:()=>St,SqueezeBertForSequenceClassification:()=>Dt,SqueezeBertModel:()=>kt,SqueezeBertPreTrainedModel:()=>xt,StableLmForCausalLM:()=>vl,StableLmModel:()=>_l,StableLmPreTrainedModel:()=>gl,Starcoder2ForCausalLM:()=>nl,Starcoder2Model:()=>tl,Starcoder2PreTrainedModel:()=>el,StyleTextToSpeech2Model:()=>Us,StyleTextToSpeech2PreTrainedModel:()=>qs,Swin2SRForImageSuperResolution:()=>pi,Swin2SRModel:()=>di,Swin2SRPreTrainedModel:()=>ui,SwinForImageClassification:()=>li,SwinForSemanticSegmentation:()=>ci,SwinModel:()=>si,SwinPreTrainedModel:()=>ii,T5ForConditionalGeneration:()=>zt,T5Model:()=>Pt,T5PreTrainedModel:()=>It,TableTransformerForObjectDetection:()=>$a,TableTransformerModel:()=>Za,TableTransformerObjectDetectionOutput:()=>Xa,TableTransformerPreTrainedModel:()=>Ka,TokenClassifierOutput:()=>Ru,TrOCRForCausalLM:()=>Xs,TrOCRPreTrainedModel:()=>$s,UltravoxModel:()=>nc,UltravoxPreTrainedModel:()=>tc,UniSpeechForCTC:()=>bs,UniSpeechForSequenceClassification:()=>xs,UniSpeechModel:()=>ws,UniSpeechPreTrainedModel:()=>ys,UniSpeechSatForAudioFrameClassification:()=>Es,UniSpeechSatForCTC:()=>Ds,UniSpeechSatForSequenceClassification:()=>Ss,UniSpeechSatModel:()=>Cs,UniSpeechSatPreTrainedModel:()=>ks,ViTForImageClassification:()=>Wo,ViTMAEModel:()=>ea,ViTMAEPreTrainedModel:()=>Yo,ViTMSNForImageClassification:()=>ra,ViTMSNModel:()=>na,ViTMSNPreTrainedModel:()=>ta,ViTModel:()=>Uo,ViTPreTrainedModel:()=>qo,VisionEncoderDecoderModel:()=>Fn,VitMatteForImageMatting:()=>ua,VitMattePreTrainedModel:()=>ca,VitPoseForPoseEstimation:()=>$o,VitPosePreTrainedModel:()=>Zo,VitsModel:()=>dl,VitsModelOutput:()=>Hu,VitsPreTrainedModel:()=>ul,Wav2Vec2BertForCTC:()=>Ms,Wav2Vec2BertForSequenceClassification:()=>Fs,Wav2Vec2BertModel:()=>As,Wav2Vec2BertPreTrainedModel:()=>Ts,Wav2Vec2ForAudioFrameClassification:()=>hs,Wav2Vec2ForCTC:()=>ds,Wav2Vec2ForSequenceClassification:()=>ps,Wav2Vec2Model:()=>us,Wav2Vec2PreTrainedModel:()=>cs,WavLMForAudioFrameClassification:()=>Vs,WavLMForCTC:()=>js,WavLMForSequenceClassification:()=>Ls,WavLMForXVector:()=>Rs,WavLMModel:()=>Bs,WavLMPreTrainedModel:()=>Ns,WeSpeakerResNetModel:()=>vs,WeSpeakerResNetPreTrainedModel:()=>_s,WhisperForConditionalGeneration:()=>Sn,WhisperModel:()=>Dn,WhisperPreTrainedModel:()=>Cn,XLMForQuestionAnswering:()=>fn,XLMForSequenceClassification:()=>pn,XLMForTokenClassification:()=>hn,XLMModel:()=>un,XLMPreTrainedModel:()=>cn,XLMRobertaForMaskedLM:()=>_n,XLMRobertaForQuestionAnswering:()=>wn,XLMRobertaForSequenceClassification:()=>vn,XLMRobertaForTokenClassification:()=>yn,XLMRobertaModel:()=>gn,XLMRobertaPreTrainedModel:()=>mn,XLMWithLMHeadModel:()=>dn,XVectorOutput:()=>Lu,YolosForObjectDetection:()=>Qi,YolosModel:()=>Ji,YolosObjectDetectionOutput:()=>Yi,YolosPreTrainedModel:()=>Xi});var r=n("./src/configs.js"),o=n("./src/backends/onnx.js"),a=n("./src/utils/dtypes.js"),i=n("./src/utils/generic.js"),s=n("./src/utils/core.js"),l=n("./src/utils/hub.js"),c=n("./src/utils/constants.js"),u=n("./src/generation/logits_process.js"),d=n("./src/generation/configuration_utils.js"),p=n("./src/utils/tensor.js"),h=n("./src/utils/image.js"),f=n("./src/utils/maths.js"),m=n("./src/generation/stopping_criteria.js"),g=n("./src/generation/logits_sampler.js"),_=n("./src/env.js"),v=n("./src/models/whisper/generation_whisper.js"),y=n("./src/models/whisper/common_whisper.js");const w=0,b=1,x=2,k=3,C=4,D=5,S=6,E=7,T=8,A=9,M=10,F=11,I=new Map,P=new Map,z=new Map;async function O(e,t,n){return Object.fromEntries(await Promise.all(Object.keys(t).map((async i=>{const{buffer_or_path:s,session_options:c,session_config:u}=await async function(e,t,n){var i,s,c,u,d,p,h,f,m;let g=null!==(i=null===(s=n.config)||void 0===s?void 0:s["transformers.js_config"])&&void 0!==i?i:{},v=null!==(c=n.device)&&void 0!==c?c:g.device;v&&"string"!==typeof v&&(v.hasOwnProperty(t)?v=v[t]:(console.warn('device not specified for "'.concat(t,'". Using the default device.')),v=null));const y=null!==v&&void 0!==v?v:_.apis.IS_NODE_ENV?"cpu":"wasm",w=(0,o.deviceToExecutionProviders)(y),b=null!==(u=g.device_config)&&void 0!==u?u:{};b.hasOwnProperty(y)&&(g=so(so({},g),b[y]));let x=null!==(d=n.dtype)&&void 0!==d?d:g.dtype;var k;if("string"!==typeof x&&(x&&x.hasOwnProperty(t)?x=x[t]:(x=null!==(k=a.DEFAULT_DEVICE_DTYPE_MAPPING[y])&&void 0!==k?k:a.DATA_TYPES.fp32,console.warn('dtype not specified for "'.concat(t,'". Using the default dtype (').concat(x,") for this device (").concat(y,").")))),x===a.DATA_TYPES.auto){let e=g.dtype;var C,D;"string"!==typeof e&&(e=null===(C=e)||void 0===C?void 0:C[t]),x=e&&e!==a.DATA_TYPES.auto&&a.DATA_TYPES.hasOwnProperty(e)?e:null!==(D=a.DEFAULT_DEVICE_DTYPE_MAPPING[y])&&void 0!==D?D:a.DATA_TYPES.fp32}const S=x;if(!a.DEFAULT_DTYPE_SUFFIX_MAPPING.hasOwnProperty(S))throw new Error("Invalid dtype: ".concat(S,". Should be one of: ").concat(Object.keys(a.DATA_TYPES).join(", ")));if(S===a.DATA_TYPES.fp16&&"webgpu"===y&&!await(0,a.isWebGpuFp16Supported)())throw new Error("The device (".concat(y,") does not support fp16."));const E=g.kv_cache_dtype,T=E?"string"===typeof E?E:null!==(p=E[S])&&void 0!==p?p:"float32":void 0;if(T&&!["float32","float16"].includes(T))throw new Error("Invalid kv_cache_dtype: ".concat(T,". Should be one of: float32, float16"));const A={dtype:S,kv_cache_dtype:T,device:y},M=a.DEFAULT_DTYPE_SUFFIX_MAPPING[S],F="".concat(t).concat(M,".onnx"),I="".concat(null!==(h=n.subfolder)&&void 0!==h?h:"","/").concat(F),P=so({},n.session_options);null!==(f=P.executionProviders)&&void 0!==f||(P.executionProviders=w);const z=g.free_dimension_overrides;var O;z?null!==(O=P.freeDimensionOverrides)&&void 0!==O||(P.freeDimensionOverrides=z):y.startsWith("webnn")&&!P.freeDimensionOverrides&&console.warn('WebNN does not currently support dynamic shapes and requires \'free_dimension_overrides\' to be set in config.json, preferably as a field within config["transformers.js_config"]["device_config"]["'.concat(y,'"]. ')+"When 'free_dimension_overrides' is not set, you may experience significant performance degradation.");const N=_.apis.IS_NODE_ENV&&_.env.useFSCache,B=(0,l.getModelFile)(e,I,!0,n,N),j=null!==(m=n.use_external_data_format)&&void 0!==m?m:g.use_external_data_format;let L=[];if(j){let r;r="object"===typeof j?j.hasOwnProperty(F)?j[F]:!!j.hasOwnProperty(t)&&j[t]:j;const o=+r;if(o>l.MAX_EXTERNAL_DATA_CHUNKS)throw new Error("The number of external data chunks (".concat(o,") exceeds the maximum allowed value (").concat(l.MAX_EXTERNAL_DATA_CHUNKS,")."));for(let t=0;t<o;++t){var R;const r="".concat(F,"_data").concat(0===t?"":"_"+t),o="".concat(null!==(R=n.subfolder)&&void 0!==R?R:"","/").concat(r);L.push(new Promise((async(t,a)=>{const i=await(0,l.getModelFile)(e,o,!0,n,N);t(i instanceof Uint8Array?{path:r,data:i}:r)})))}}else void 0!==P.externalData&&(L=P.externalData.map((async t=>{if("string"===typeof t.data){const r=await(0,l.getModelFile)(e,t.data,!0,n);return so(so({},t),{},{data:r})}return t})));if(L.length>0){const e=await Promise.all(L);_.apis.IS_NODE_ENV||(P.externalData=e)}if("webgpu"===y){const e=(0,r.getKeyValueShapes)(n.config,{prefix:"present"});if(Object.keys(e).length>0&&!(0,o.isONNXProxy)()){const t={};for(const n in e)t[n]="gpu-buffer";P.preferredOutputLocation=t}}return{buffer_or_path:await B,session_options:P,session_config:A}}(e,t[i],n);return[i,await(0,o.createInferenceSession)(s,c,u)]}))))}async function N(e,t,n){return Object.fromEntries(await Promise.all(Object.keys(t).map((async r=>[r,await(0,l.getModelJSON)(e,t[r],!1,n)]))))}let B=Promise.resolve();async function j(e,t){const n=function(e,t){const n=Object.create(null),r=[];for(const s of e.inputNames){const e=t[s];e instanceof p.Tensor?n[s]=(0,o.isONNXProxy)()?e.clone():e:r.push(s)}if(r.length>0)throw new Error('An error occurred during model execution: "Missing the following inputs: '.concat(r.join(", "),"."));const a=Object.keys(t).length,i=e.inputNames.length;if(a>i){let n=Object.keys(t).filter((t=>!e.inputNames.includes(t)));console.warn("WARNING: Too many inputs were provided (".concat(a," > ").concat(i,'). The following inputs will be ignored: "').concat(n.join(", "),'".'))}return n}(e,t);try{const t=Object.fromEntries(Object.entries(n).map((e=>{let[t,n]=e;return[t,n.ort_tensor]}))),r=()=>e.run(t);return L(await(_.apis.IS_BROWSER_ENV||_.apis.IS_WEBWORKER_ENV?B=B.then(r):r()))}catch(AC){const t=Object.fromEntries(Object.entries(n).map((e=>{let[t,n]=e;const r={type:n.type,dims:n.dims,location:n.location};return"gpu-buffer"!==r.location&&(r.data=n.data),[t,r]})));throw console.error('An error occurred during model execution: "'.concat(AC,'".')),console.error("Inputs given to model:",t),AC}}function L(e){for(let t in e)(0,o.isONNXTensor)(e[t])?e[t]=new p.Tensor(e[t]):"object"===typeof e[t]&&L(e[t]);return e}function R(e){if(e instanceof p.Tensor)return e;if(0===e.length)throw Error("items must be non-empty");if(Array.isArray(e[0])){if(e.some((t=>t.length!==e[0].length)))throw Error("Unable to create tensor, you should probably activate truncation and/or padding with 'padding=True' and/or 'truncation=True' to have batched tensors with the same length.");return new p.Tensor("int64",BigInt64Array.from(e.flat().map((e=>BigInt(e)))),[e.length,e[0].length])}return new p.Tensor("int64",BigInt64Array.from(e.map((e=>BigInt(e)))),[1,e.length])}function V(e){return new p.Tensor("bool",[e],[1])}async function q(e,t){let{encoder_outputs:n,input_ids:r,decoder_input_ids:o}=t,a=Kc(t,WN);if(!n){const r=(0,s.pick)(t,e.sessions.model.inputNames);n=(await U(e,r)).last_hidden_state}a.input_ids=o,a.encoder_hidden_states=n,e.sessions.decoder_model_merged.inputNames.includes("encoder_attention_mask")&&(a.encoder_attention_mask=t.attention_mask);return await G(e,a,!0)}async function U(e,t){const n=e.sessions.model,r=(0,s.pick)(t,n.inputNames);if(n.inputNames.includes("inputs_embeds")&&!r.inputs_embeds){if(!t.input_ids)throw new Error("Both `input_ids` and `inputs_embeds` are missing in the model inputs.");r.inputs_embeds=await e.encode_text({input_ids:t.input_ids})}if(n.inputNames.includes("token_type_ids")&&!r.token_type_ids){if(!r.input_ids)throw new Error("Both `input_ids` and `token_type_ids` are missing in the model inputs.");r.token_type_ids=(0,p.zeros_like)(r.input_ids)}if(n.inputNames.includes("pixel_mask")&&!r.pixel_mask){if(!r.pixel_values)throw new Error("Both `pixel_values` and `pixel_mask` are missing in the model inputs.");const e=r.pixel_values.dims;r.pixel_mask=(0,p.ones)([e[0],e[2],e[3]])}return await j(n,r)}async function W(e,t){const n=await e.encode(t);return await e.decode(n)}async function G(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=e.sessions[n?"decoder_model_merged":"model"],{past_key_values:o}=t,a=Kc(t,GN);if(r.inputNames.includes("use_cache_branch")&&(a.use_cache_branch=V(!!o)),r.inputNames.includes("position_ids")&&a.attention_mask&&!a.position_ids){const t=["paligemma","gemma3_text","gemma3"].includes(e.config.model_type)?1:0;a.position_ids=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const{input_ids:r,inputs_embeds:o,attention_mask:a}=e,{data:i,dims:s}=J(a,n);let l=new p.Tensor("int64",i,s);if(t){const e=-(null!==r&&void 0!==r?r:o).dims.at(1);l=l.slice(null,[e,null])}return l}(a,o,t)}e.addPastKeyValues(a,o);const i=(0,s.pick)(a,r.inputNames);return await j(r,i)}function H(e){let{modality_token_id:t,inputs_embeds:n,modality_features:r,input_ids:o,attention_mask:a}=e;const i=o.tolist().map((e=>e.reduce(((e,n,r)=>(n==t&&e.push(r),e)),[]))),s=i.reduce(((e,t)=>e+t.length),0),l=r.dims[0];if(s!==l)throw new Error("Number of tokens and features do not match: tokens: ".concat(s,", features ").concat(l));let c=0;for(let u=0;u<i.length;++u){const e=i[u],t=n[u];for(let n=0;n<e.length;++n)t[e[n]].data.set(r[c++].data)}return{inputs_embeds:n,attention_mask:a}}function K(e){let{image_token_id:t,inputs_embeds:n,image_features:r,input_ids:o,attention_mask:a}=e;return H({modality_token_id:t,inputs_embeds:n,modality_features:r,input_ids:o,attention_mask:a})}async function Z(e,t){let{encode_function:n,merge_function:r,modality_input_name:o,modality_output_name:a,input_ids:i=null,attention_mask:s=null,position_ids:l=null,inputs_embeds:c=null,past_key_values:u=null,generation_config:d=null,logits_processor:h=null}=t,f=Kc(t,HN);const m=f[o];if(!c)if(c=await e.encode_text(so({input_ids:i},f)),m&&1!==i.dims[1]){const e=await n(so({[o]:m},f));({inputs_embeds:c,attention_mask:s}=r({[a]:e,inputs_embeds:c,input_ids:i,attention_mask:s}))}else if(u&&m&&1===i.dims[1]){const e=i.dims[1],t=Object.values(u)[0].dims.at(-2);s=(0,p.cat)([(0,p.ones)([i.dims[0],t]),s.slice(null,[s.dims[1]-e,s.dims[1]])],1)}if(!l&&"qwen2_vl"===e.config.model_type){const{image_grid_thw:t,video_grid_thw:n}=f;[l]=e.get_rope_index(i,t,n,s)}return await G(e,{inputs_embeds:c,past_key_values:u,attention_mask:s,position_ids:l,generation_config:d,logits_processor:h},!0)}async function $(e,t){return await Z(e,so(so({},t),{},{modality_input_name:"audio_values",modality_output_name:"audio_features",encode_function:e.encode_audio.bind(e),merge_function:e._merge_input_ids_with_audio_features.bind(e)}))}async function X(e,t){return await Z(e,so(so({},t),{},{modality_input_name:"pixel_values",modality_output_name:"image_features",encode_function:e.encode_image.bind(e),merge_function:e._merge_input_ids_with_image_features.bind(e)}))}function J(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const[n,r]=e.dims,o=e.data,a=new BigInt64Array(o.length);for(let i=0;i<n;++i){const e=i*r;let n=BigInt(t);for(let t=0;t<r;++t){const r=e+t;0n===o[r]?a[r]=BigInt(1):(a[r]=n,n+=o[r])}}return{data:a,dims:e.dims}}function Q(e,t,n,r){if(n.past_key_values){const t=Object.values(n.past_key_values)[0].dims.at(-2),{input_ids:r,attention_mask:o}=n;if(o&&o.dims[1]>r.dims[1]);else if(t<r.dims[1])n.input_ids=r.slice(null,[t,null]);else if(null!=e.config.image_token_index&&r.data.some((t=>t==e.config.image_token_index))){const o=e.config.num_image_tokens;if(!o)throw new Error("`num_image_tokens` is missing in the model configuration.");const a=r.dims[1]-(t-o);n.input_ids=r.slice(null,[-a,null]),n.attention_mask=(0,p.ones)([1,t+a])}}return n}function Y(e,t,n,r){return n.past_key_values&&(t=t.map((e=>[e.at(-1)]))),so(so({},n),{},{decoder_input_ids:R(t)})}function ee(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return e.config.is_encoder_decoder?Y(e,...n):Q(e,...n)}function te(e,t,n,r){const o=!!n.past_key_values;if(null!==r.guidance_scale&&r.guidance_scale>1&&(o?n.input_ids=(0,p.cat)([n.input_ids,n.input_ids],0):(n.input_ids=(0,p.cat)([n.input_ids,(0,p.full_like)(n.input_ids,BigInt(r.pad_token_id))],0),n.attention_mask=(0,p.cat)([n.attention_mask,(0,p.full_like)(n.attention_mask,0n)],0))),!o&&n.pixel_values||(n.pixel_values=(0,p.full)([0,0,3,384,384],1)),o){const e=0,t=1,r=e>0?1:0,o=1;n.images_seq_mask=new p.Tensor("bool",new Array(e+t).fill(!0).fill(!1,0,t),[o,e+t]),n.images_emb_mask=new p.Tensor("bool",new Array(e).fill(!!r),[o,1,e])}return n}class ne extends i.Callable{constructor(e,t,n){var r;super(),ao(this,"main_input_name","input_ids"),ao(this,"forward_params",["input_ids","attention_mask"]),this.config=e,this.sessions=t,this.configs=n;const o=z.get(this.constructor),a=I.get(o);switch(this.can_generate=!1,this._forward=null,this._prepare_inputs_for_generation=null,a){case C:this.can_generate=!0,this._forward=G,this._prepare_inputs_for_generation=Q;break;case x:case k:case E:this.can_generate=!0,this._forward=q,this._prepare_inputs_for_generation=Y;break;case b:this._forward=q;break;case S:this.can_generate=!0,this._forward=X,this._prepare_inputs_for_generation=ee;break;case M:this.can_generate=!0,this._forward=$,this._prepare_inputs_for_generation=ee;break;case A:this.can_generate=!0,this._prepare_inputs_for_generation=ee;break;case T:this.can_generate=!0,this._prepare_inputs_for_generation=te;break;case F:this._forward=W;break;default:this._forward=U}this.can_generate&&this.forward_params.push("past_key_values"),this.custom_config=null!==(r=this.config["transformers.js_config"])&&void 0!==r?r:{}}async dispose(){const e=[];for(const n of Object.values(this.sessions)){var t;null!==n&&void 0!==n&&null!==(t=n.handler)&&void 0!==t&&t.dispose&&e.push(n.handler.dispose())}return await Promise.all(e)}static async from_pretrained(e){let{progress_callback:t=null,config:n=null,cache_dir:o=null,local_files_only:a=!1,revision:i="main",model_file_name:s=null,subfolder:l="onnx",device:u=null,dtype:d=null,use_external_data_format:p=null,session_options:h={}}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},f={progress_callback:t,config:n,cache_dir:o,local_files_only:a,revision:i,model_file_name:s,subfolder:l,device:u,dtype:d,use_external_data_format:p,session_options:h};const m=z.get(this),g=I.get(m);let _;var v;if(n=f.config=await r.AutoConfig.from_pretrained(e,f),g===C)_=await Promise.all([O(e,{model:null!==(v=f.model_file_name)&&void 0!==v?v:"model"},f),N(e,{generation_config:"generation_config.json"},f)]);else if(g===x||g===k)_=await Promise.all([O(e,{model:"encoder_model",decoder_model_merged:"decoder_model_merged"},f),N(e,{generation_config:"generation_config.json"},f)]);else if(g===D)_=await Promise.all([O(e,{model:"vision_encoder",prompt_encoder_mask_decoder:"prompt_encoder_mask_decoder"},f)]);else if(g===b)_=await Promise.all([O(e,{model:"encoder_model",decoder_model_merged:"decoder_model_merged"},f)]);else if(g===S){const t={embed_tokens:"embed_tokens",vision_encoder:"vision_encoder",decoder_model_merged:"decoder_model_merged"};n.is_encoder_decoder&&(t.model="encoder_model"),_=await Promise.all([O(e,t,f),N(e,{generation_config:"generation_config.json"},f)])}else if(g===M){const t={embed_tokens:"embed_tokens",audio_encoder:"audio_encoder",decoder_model_merged:"decoder_model_merged"};_=await Promise.all([O(e,t,f),N(e,{generation_config:"generation_config.json"},f)])}else if(g===E)_=await Promise.all([O(e,{model:"text_encoder",decoder_model_merged:"decoder_model_merged",encodec_decode:"encodec_decode"},f),N(e,{generation_config:"generation_config.json"},f)]);else if(g===T)_=await Promise.all([O(e,{prepare_inputs_embeds:"prepare_inputs_embeds",model:"language_model",lm_head:"lm_head",gen_head:"gen_head",gen_img_embeds:"gen_img_embeds",image_decode:"image_decode"},f),N(e,{generation_config:"generation_config.json"},f)]);else if(g===A)_=await Promise.all([O(e,{prepare_inputs_embeds:"prepare_inputs_embeds",model:"model",vision_encoder:"vision_encoder"},f),N(e,{generation_config:"generation_config.json"},f)]);else if(g===F)_=await Promise.all([O(e,{encoder_model:"encoder_model",decoder_model:"decoder_model"},f)]);else{var y;if(g!==w){var P;const e=null!==m&&void 0!==m?m:null===(P=n)||void 0===P?void 0:P.model_type;"custom"!==e&&console.warn("Model type for '".concat(e,"' not found, assuming encoder-only architecture. Please report this at ").concat(c.GITHUB_ISSUE_URL,"."))}_=await Promise.all([O(e,{model:null!==(y=f.model_file_name)&&void 0!==y?y:"model"},f)])}return new this(n,..._)}async _call(e){return await this.forward(e)}async forward(e){return await this._forward(this,e)}get generation_config(){var e,t;return null!==(e=null===(t=this.configs)||void 0===t?void 0:t.generation_config)&&void 0!==e?e:null}_get_logits_warper(e){const t=new u.LogitsProcessorList;return null!==e.temperature&&1!==e.temperature&&t.push(new u.TemperatureLogitsWarper(e.temperature)),null!==e.top_k&&0!==e.top_k&&t.push(new u.TopKLogitsWarper(e.top_k)),null!==e.top_p&&e.top_p<1&&t.push(new u.TopPLogitsWarper(e.top_p)),t}_get_logits_processor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const r=new u.LogitsProcessorList;if(null!==e.repetition_penalty&&1!==e.repetition_penalty&&r.push(new u.RepetitionPenaltyLogitsProcessor(e.repetition_penalty)),null!==e.no_repeat_ngram_size&&e.no_repeat_ngram_size>0&&r.push(new u.NoRepeatNGramLogitsProcessor(e.no_repeat_ngram_size)),null!==e.bad_words_ids&&r.push(new u.NoBadWordsLogitsProcessor(e.bad_words_ids,e.eos_token_id)),null!==e.min_length&&null!==e.eos_token_id&&e.min_length>0&&r.push(new u.MinLengthLogitsProcessor(e.min_length,e.eos_token_id)),null!==e.min_new_tokens&&null!==e.eos_token_id&&e.min_new_tokens>0&&r.push(new u.MinNewTokensLengthLogitsProcessor(t,e.min_new_tokens,e.eos_token_id)),null!==e.forced_bos_token_id&&r.push(new u.ForcedBOSTokenLogitsProcessor(e.forced_bos_token_id)),null!==e.forced_eos_token_id&&r.push(new u.ForcedEOSTokenLogitsProcessor(e.max_length,e.forced_eos_token_id)),null!==e.begin_suppress_tokens){const n=t>1||null===e.forced_bos_token_id?t:t+1;r.push(new u.SuppressTokensAtBeginLogitsProcessor(e.begin_suppress_tokens,n))}return null!==e.guidance_scale&&e.guidance_scale>1&&r.push(new u.ClassifierFreeGuidanceLogitsProcessor(e.guidance_scale)),null!==n&&r.extend(n),r}_prepare_generation_config(e,t){var n;let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:d.GenerationConfig;const o=so({},this.config);for(const i of["decoder","generator","text_config"])i in o&&Object.assign(o,o[i]);const a=new r(o);return Object.assign(a,null!==(n=this.generation_config)&&void 0!==n?n:{}),e&&Object.assign(a,e),t&&Object.assign(a,(0,s.pick)(t,Object.getOwnPropertyNames(a))),a}_get_stopping_criteria(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const n=new m.StoppingCriteriaList;var r;null!==e.max_length&&n.push(new m.MaxLengthCriteria(e.max_length,null!==(r=this.config.max_position_embeddings)&&void 0!==r?r:null));return null!==e.eos_token_id&&n.push(new m.EosTokenCriteria(e.eos_token_id)),t&&n.extend(t),n}_validate_model_class(){if(!this.can_generate){const e=[Mc,zc,Ac,Cc],t=z.get(this.constructor),n=new Set,r=this.config.model_type;for(const a of e){const e=a.get(r);e&&n.add(e[0])}let o="The current model class (".concat(t,") is not compatible with `.generate()`, as it doesn't have a language model head.");throw n.size>0&&(o+=" Please use the following class instead: ".concat([...n].join(", "))),Error(o)}}prepare_inputs_for_generation(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this._prepare_inputs_for_generation(this,...t)}_update_model_kwargs_for_generation(e){let{generated_input_ids:t,outputs:n,model_inputs:r,is_encoder_decoder:o}=e;return r.past_key_values=this.getPastKeyValues(n,r.past_key_values),r.input_ids=new p.Tensor("int64",t.flat(),[t.length,1]),o||(r.attention_mask=(0,p.cat)([r.attention_mask,(0,p.ones)([r.attention_mask.dims[0],1])],1)),r.position_ids=null,r}_prepare_model_inputs(e){let{inputs:t,bos_token_id:n,model_kwargs:r}=e;const o=(0,s.pick)(r,this.forward_params),a=this.main_input_name;if(a in o){if(t)throw new Error("`inputs`: {inputs}` were passed alongside {input_name} which is not allowed. Make sure to either pass {inputs} or {input_name}=...")}else o[a]=t;return{inputs_tensor:o[a],model_inputs:o,model_input_name:a}}async _prepare_encoder_decoder_kwargs_for_generation(e){let{inputs_tensor:t,model_inputs:n,model_input_name:r,generation_config:o}=e;if(this.sessions.model.inputNames.includes("inputs_embeds")&&!n.inputs_embeds&&"_prepare_inputs_embeds"in this){const{input_ids:e,pixel_values:t,attention_mask:r}=n,o=Kc(n,KN),a=await this._prepare_inputs_embeds(n);n=so(so({},o),(0,s.pick)(a,["inputs_embeds","attention_mask"]))}let{last_hidden_state:a}=await U(this,n);if(null!==o.guidance_scale&&o.guidance_scale>1)a=(0,p.cat)([a,(0,p.full_like)(a,0)],0),"attention_mask"in n&&(n.attention_mask=(0,p.cat)([n.attention_mask,(0,p.zeros_like)(n.attention_mask)],0));else if(n.decoder_input_ids){const e=R(n.decoder_input_ids).dims[0];if(e!==a.dims[0]){if(1!==a.dims[0])throw new Error("The encoder outputs have a different batch size (".concat(a.dims[0],") than the decoder inputs (").concat(e,")."));a=(0,p.cat)(Array.from({length:e},(()=>a)),0)}}return n.encoder_outputs=a,n}_prepare_decoder_input_ids_for_generation(e){let{batch_size:t,model_input_name:n,model_kwargs:r,decoder_start_token_id:o,bos_token_id:a,generation_config:i}=e,{decoder_input_ids:s}=r,l=Kc(r,ZN);if(!(s instanceof p.Tensor)){if(s)Array.isArray(s[0])||(s=Array.from({length:t},(()=>s)));else if(null!==o&&void 0!==o||(o=a),"musicgen"===this.config.model_type)s=Array.from({length:t*this.config.decoder.num_codebooks},(()=>[o]));else if(Array.isArray(o)){if(o.length!==t)throw new Error("`decoder_start_token_id` expcted to have length ".concat(t," but got ").concat(o.length));s=o}else s=Array.from({length:t},(()=>[o]));s=R(s)}return r.decoder_attention_mask=(0,p.ones_like)(s),{input_ids:s,model_inputs:l}}async generate(e){let{inputs:t=null,generation_config:n=null,logits_processor:r=null,stopping_criteria:o=null,streamer:a=null}=e,i=Kc(e,$N);this._validate_model_class(),n=this._prepare_generation_config(n,i);let{inputs_tensor:s,model_inputs:l,model_input_name:c}=this._prepare_model_inputs({inputs:t,model_kwargs:i});const u=this.config.is_encoder_decoder;let d;u&&("encoder_outputs"in l||(l=await this._prepare_encoder_decoder_kwargs_for_generation({inputs_tensor:s,model_inputs:l,model_input_name:c,generation_config:n}))),u?({input_ids:d,model_inputs:l}=this._prepare_decoder_input_ids_for_generation({batch_size:l[c].dims.at(0),model_input_name:c,model_kwargs:l,decoder_start_token_id:n.decoder_start_token_id,bos_token_id:n.bos_token_id,generation_config:n})):d=l[c];let h=d.dims.at(-1);null!==n.max_new_tokens&&(n.max_length=h+n.max_new_tokens);const f=this._get_logits_processor(n,h,r),m=this._get_stopping_criteria(n,o),_=l[c].dims.at(0),v=g.LogitsSampler.getSampler(n),y=new Array(_).fill(0),w=d.tolist();let b;a&&a.put(w);let x={};for(;;){if(l=this.prepare_inputs_for_generation(w,l,n),b=await this.forward(l),n.output_attentions&&n.return_dict_in_generate){const e=this.getAttentions(b);for(const t in e)t in x||(x[t]=[]),x[t].push(e[t])}const e=f(w,b.logits.slice(null,-1,null)),t=[];for(let n=0;n<e.dims.at(0);++n){const r=e[n],o=await v(r);for(const[e,a]of o){const r=BigInt(e);y[n]+=a,w[n].push(r),t.push([r]);break}}a&&a.put(t);if(m(w).every((e=>e)))break;l=this._update_model_kwargs_for_generation({generated_input_ids:t,outputs:b,model_inputs:l,is_encoder_decoder:u})}a&&a.end();const k=this.getPastKeyValues(b,l.past_key_values,!0),C=new p.Tensor("int64",w.flat(),[w.length,w[0].length]);if(n.return_dict_in_generate)return so({sequences:C,past_key_values:k},x);for(const p of Object.values(b))"gpu-buffer"===p.location&&p.dispose();return C}getPastKeyValues(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=Object.create(null);for(const o in e)if(o.startsWith("present")){const a=o.replace("present","past_key_values"),i=o.includes("encoder");if(r[a]=i&&t?t[a]:e[o],t&&(!i||n)){const e=t[a];"gpu-buffer"===e.location&&e.dispose()}}return r}getAttentions(e){const t={};for(const n of["cross_attentions","encoder_attentions","decoder_attentions"])for(const r in e)r.startsWith(n)&&(n in t||(t[n]=[]),t[n].push(e[r]));return t}addPastKeyValues(e,t){if(t)Object.assign(e,t);else{var n,o,a,i,s,l;const t=null!==(n=this.sessions.decoder_model_merged)&&void 0!==n?n:this.sessions.model,c=null!==(o=null===t||void 0===t||null===(a=t.config)||void 0===a?void 0:a.kv_cache_dtype)&&void 0!==o?o:"float32",u="float16"===c?new p.DataTypeMap.float16:[],d=null!==(i=null===(s=null!==(l=e[this.main_input_name])&&void 0!==l?l:e.attention_mask)||void 0===s||null===(s=s.dims)||void 0===s?void 0:s[0])&&void 0!==i?i:1,h=(0,r.getKeyValueShapes)(this.config,{batch_size:d});for(const n in h)e[n]=new p.Tensor(c,u,h[n])}}async encode_image(e){let{pixel_values:t}=e;const n=(await j(this.sessions.vision_encoder,{pixel_values:t})).image_features;return this.config.num_image_tokens||(console.warn("The number of image tokens was not set in the model configuration. "+"Setting it to the number of features detected by the vision encoder (".concat(n.dims[1],").")),this.config.num_image_tokens=n.dims[1]),n}async encode_text(e){let{input_ids:t}=e;return(await j(this.sessions.embed_tokens,{input_ids:t})).inputs_embeds}async encode_audio(e){let{audio_values:t}=e;return(await j(this.sessions.audio_encoder,{audio_values:t})).audio_features}}class re{}class oe extends re{constructor(e){let{last_hidden_state:t,hidden_states:n=null,attentions:r=null}=e;super(),this.last_hidden_state=t,this.hidden_states=n,this.attentions=r}}class ae extends ne{}class ie extends ae{}class se extends ae{async _call(e){return new Vu(await super._call(e))}}class le extends ae{async _call(e){return new ju(await super._call(e))}}class ce extends ae{async _call(e){return new Ru(await super._call(e))}}class ue extends ae{async _call(e){return new qu(await super._call(e))}}class de extends ne{}class pe extends de{}class he extends de{async _call(e){return new Vu(await super._call(e))}}class fe extends de{async _call(e){return new ju(await super._call(e))}}class me extends de{async _call(e){return new Ru(await super._call(e))}}class ge extends ne{}class _e extends ge{}class ve extends ne{}class ye extends ve{}class we extends ve{async _call(e){return new Vu(await super._call(e))}}class be extends ve{async _call(e){return new ju(await super._call(e))}}class xe extends ve{async _call(e){return new Ru(await super._call(e))}}class ke extends ve{async _call(e){return new qu(await super._call(e))}}class Ce extends ne{}class De extends Ce{}class Se extends Ce{async _call(e){return new Vu(await super._call(e))}}class Ee extends Ce{async _call(e){return new ju(await super._call(e))}}class Te extends Ce{async _call(e){return new Ru(await super._call(e))}}class Ae extends Ce{async _call(e){return new qu(await super._call(e))}}class Me extends ne{}class Fe extends Me{}class Ie extends Me{async _call(e){return new Vu(await super._call(e))}}class Pe extends Me{async _call(e){return new ju(await super._call(e))}}class ze extends Me{async _call(e){return new Ru(await super._call(e))}}class Oe extends Me{async _call(e){return new qu(await super._call(e))}}class Ne extends ne{}class Be extends Ne{}class je extends Ne{async _call(e){return new Vu(await super._call(e))}}class Le extends Ne{async _call(e){return new ju(await super._call(e))}}class Re extends Ne{async _call(e){return new Ru(await super._call(e))}}class Ve extends Ne{async _call(e){return new qu(await super._call(e))}}class qe extends ne{}class Ue extends qe{}class We extends qe{async _call(e){return new Vu(await super._call(e))}}class Ge extends qe{async _call(e){return new ju(await super._call(e))}}class He extends qe{async _call(e){return new Ru(await super._call(e))}}class Ke extends qe{async _call(e){return new qu(await super._call(e))}}class Ze extends ne{}class $e extends Ze{}class Xe extends Ze{async _call(e){return new Vu(await super._call(e))}}class Je extends Ze{async _call(e){return new ju(await super._call(e))}}class Qe extends Ze{async _call(e){return new Ru(await super._call(e))}}class Ye extends Ze{async _call(e){return new qu(await super._call(e))}}class et extends ne{}class tt extends et{}class nt extends et{async _call(e){return new ju(await super._call(e))}}class rt extends et{async _call(e){return new Ru(await super._call(e))}}class ot extends et{async _call(e){return new qu(await super._call(e))}}class at extends et{async _call(e){return new Vu(await super._call(e))}}class it extends ne{}class st extends it{}class lt extends it{async _call(e){return new Vu(await super._call(e))}}class ct extends it{async _call(e){return new ju(await super._call(e))}}class ut extends it{async _call(e){return new Ru(await super._call(e))}}class dt extends ne{}class pt extends dt{}class ht extends dt{async _call(e){return new Vu(await super._call(e))}}class ft extends dt{async _call(e){return new ju(await super._call(e))}}class mt extends dt{async _call(e){return new qu(await super._call(e))}}class gt extends ne{}class _t extends gt{}class vt extends gt{async _call(e){return new Vu(await super._call(e))}}class yt extends gt{async _call(e){return new ju(await super._call(e))}}class wt extends gt{async _call(e){return new Ru(await super._call(e))}}class bt extends gt{async _call(e){return new qu(await super._call(e))}}class xt extends ne{}class kt extends xt{}class Ct extends xt{async _call(e){return new Vu(await super._call(e))}}class Dt extends xt{async _call(e){return new ju(await super._call(e))}}class St extends xt{async _call(e){return new qu(await super._call(e))}}class Et extends ne{}class Tt extends Et{}class At extends Et{async _call(e){return new ju(await super._call(e))}}class Mt extends Et{async _call(e){return new qu(await super._call(e))}}class Ft extends Et{async _call(e){return new Vu(await super._call(e))}}class It extends ne{constructor(){super(...arguments),ao(this,"forward_params",["input_ids","attention_mask","encoder_outputs","decoder_input_ids","decoder_attention_mask","past_key_values"])}}class Pt extends It{}class zt extends It{}class Ot extends ne{}class Nt extends Ot{}class Bt extends Ot{}class jt extends ne{}class Lt extends jt{}class Rt extends jt{}class Vt extends ne{}class qt extends Vt{}class Ut extends Vt{}class Wt extends Vt{async _call(e){return new ju(await super._call(e))}}class Gt extends ne{}class Ht extends Gt{}class Kt extends Gt{}class Zt extends Gt{async _call(e){return new ju(await super._call(e))}}class $t extends Gt{}class Xt extends ne{}class Jt extends Xt{}class Qt extends Xt{}class Yt extends ne{}class en extends Yt{}class tn extends Yt{}class nn extends ne{}class rn extends nn{}class on extends nn{async _call(e){return new Vu(await super._call(e))}}class an extends nn{async _call(e){return new ju(await super._call(e))}}class sn extends nn{async _call(e){return new Ru(await super._call(e))}}class ln extends nn{async _call(e){return new qu(await super._call(e))}}class cn extends ne{}class un extends cn{}class dn extends cn{async _call(e){return new Vu(await super._call(e))}}class pn extends cn{async _call(e){return new ju(await super._call(e))}}class hn extends cn{async _call(e){return new Ru(await super._call(e))}}class fn extends cn{async _call(e){return new qu(await super._call(e))}}class mn extends ne{}class gn extends mn{}class _n extends mn{async _call(e){return new Vu(await super._call(e))}}class vn extends mn{async _call(e){return new ju(await super._call(e))}}class yn extends mn{async _call(e){return new Ru(await super._call(e))}}class wn extends mn{async _call(e){return new qu(await super._call(e))}}class bn extends ne{}class xn extends bn{}class kn extends bn{}class Cn extends ne{constructor(){super(...arguments),ao(this,"requires_attention_mask",!1),ao(this,"main_input_name","input_features"),ao(this,"forward_params",["input_features","attention_mask","decoder_input_ids","decoder_attention_mask","past_key_values"])}}class Dn extends Cn{}class Sn extends Cn{_prepare_generation_config(e,t){return super._prepare_generation_config(e,t,v.WhisperGenerationConfig)}_retrieve_init_tokens(e){const t=[e.decoder_start_token_id];let n=e.language;const r=e.task;if(e.is_multilingual){n||(console.warn("No language specified - defaulting to English (en)."),n="en");const o=(0,y.whisper_language_to_code)(n),a="<|".concat(o,"|>");t.push(e.lang_to_id[a]),t.push(e.task_to_id[null!==r&&void 0!==r?r:"transcribe"])}else if(n||r)throw new Error("Cannot specify `task` or `language` for an English-only model. If the model is intended to be multilingual, pass `is_multilingual=true` to generate, or update the generation config.");return!e.return_timestamps&&e.no_timestamps_token_id&&t.at(-1)!==e.no_timestamps_token_id?t.push(e.no_timestamps_token_id):e.return_timestamps&&t.at(-1)===e.no_timestamps_token_id&&(console.warn("<|notimestamps|> prompt token is removed from generation_config since `return_timestamps` is set to `true`."),t.pop()),t.filter((e=>null!=e))}async generate(e){var t;let{inputs:n=null,generation_config:r=null,logits_processor:o=null,stopping_criteria:a=null}=e,i=Kc(e,XN);r=this._prepare_generation_config(r,i);const s=null!==(t=i.decoder_input_ids)&&void 0!==t?t:this._retrieve_init_tokens(r);if(r.return_timestamps&&(null!==o&&void 0!==o||(o=new u.LogitsProcessorList),o.push(new u.WhisperTimeStampLogitsProcessor(r,s))),r.begin_suppress_tokens&&(null!==o&&void 0!==o||(o=new u.LogitsProcessorList),o.push(new u.SuppressTokensAtBeginLogitsProcessor(r.begin_suppress_tokens,s.length))),r.return_token_timestamps){if(!r.alignment_heads)throw new Error("Model generation config has no `alignment_heads`, token-level timestamps not available. See https://gist.github.com/hollance/42e32852f24243b748ae6bc1f985b13a on how to add this property to the generation config.");"translate"===r.task&&console.warn("Token-level timestamps may not be reliable for task 'translate'."),r.output_attentions=!0,r.return_dict_in_generate=!0}const l=await super.generate(so({inputs:n,generation_config:r,logits_processor:o,decoder_input_ids:s},i));return r.return_token_timestamps&&(l.token_timestamps=this._extract_token_timestamps(l,r.alignment_heads,r.num_frames)),l}_extract_token_timestamps(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.02;if(!e.cross_attentions)throw new Error("Model outputs must contain cross attentions to extract timestamps. This is most likely because the model was not exported with `output_attentions=True`.");null==n&&console.warn("`num_frames` has not been set, meaning the entire audio will be analyzed. This may lead to inaccurate token-level timestamps for short audios (< 30 seconds).");let o=this.config.median_filter_width;void 0===o&&(console.warn("Model config has no `median_filter_width`, using default value of 7."),o=7);const a=e.cross_attentions,i=Array.from({length:this.config.decoder_layers},((e,t)=>(0,p.cat)(a.map((e=>e[t])),2))),l=(0,p.stack)(t.map((e=>{let[t,r]=e;if(t>=i.length)throw new Error("Layer index ".concat(t," is out of bounds for cross attentions (length ").concat(i.length,")."));return n?i[t].slice(null,r,null,[0,n]):i[t].slice(null,r)}))).transpose(1,0,2,3),[c,u]=(0,p.std_mean)(l,-2,0,!0),d=l.clone();for(let s=0;s<d.dims[0];++s){const e=d[s];for(let t=0;t<e.dims[0];++t){const n=e[t],r=c[s][t][0].data,a=u[s][t][0].data;for(let e=0;e<n.dims[0];++e){let t=n[e].data;for(let e=0;e<t.length;++e)t[e]=(t[e]-a[e])/r[e];t.set((0,f.medianFilter)(t,o))}}}const h=[(0,p.mean)(d,1)],m=e.sequences.dims,g=new p.Tensor("float32",new Float32Array(m[0]*m[1]),m);for(let p=0;p<m[0];++p){const e=h[p].neg().squeeze_(0),[t,n]=(0,f.dynamic_time_warping)(e.tolist()),o=Array.from({length:t.length-1},((e,n)=>t[n+1]-t[n])),a=(0,s.mergeArrays)([1],o).map((e=>!!e)),i=[];for(let s=0;s<a.length;++s)a[s]&&i.push(n[s]*r);g[p].data.set(i,1)}return g}}class En extends Sn{}class Tn extends ne{constructor(){super(...arguments),ao(this,"requires_attention_mask",!1),ao(this,"main_input_name","input_values"),ao(this,"forward_params",["input_values","decoder_input_ids","past_key_values"])}}class An extends Tn{}class Mn extends Tn{}class Fn extends ne{constructor(){super(...arguments),ao(this,"main_input_name","pixel_values"),ao(this,"forward_params",["pixel_values","decoder_input_ids","encoder_hidden_states","past_key_values"])}}class In extends ne{constructor(){super(...arguments),ao(this,"forward_params",["input_ids","attention_mask","pixel_values","position_ids","past_key_values"])}}class Pn extends In{_merge_input_ids_with_image_features(e){let{inputs_embeds:t,image_features:n,input_ids:r,attention_mask:o}=e;const a=this.config.image_token_index,i=r.tolist().map((e=>e.findIndex((e=>e==a)))),s=i.every((e=>-1===e)),l=i.every((e=>-1!==e));if(!s&&!l)throw new Error("Every input should contain either 0 or 1 image token.");if(s)return{inputs_embeds:t,attention_mask:o};const c=[],u=[];for(let d=0;d<i.length;++d){const e=i[d],r=t[d],a=n[d],s=o[d];c.push((0,p.cat)([r.slice([0,e]),a,r.slice([e+1,r.dims[0]])],0)),u.push((0,p.cat)([s.slice([0,e]),(0,p.ones)([a.dims[0]]),s.slice([e+1,s.dims[0]])],0))}return{inputs_embeds:(0,p.stack)(c,0),attention_mask:(0,p.stack)(u,0)}}}class zn extends Pn{}class On extends Pn{}class Nn extends ne{constructor(){super(...arguments),ao(this,"forward_params",["input_ids","inputs_embeds","attention_mask","pixel_values","encoder_outputs","decoder_input_ids","decoder_inputs_embeds","decoder_attention_mask","past_key_values"]),ao(this,"main_input_name","inputs_embeds")}}class Bn extends Nn{_merge_input_ids_with_image_features(e){let{inputs_embeds:t,image_features:n,input_ids:r,attention_mask:o}=e;return{inputs_embeds:(0,p.cat)([n,t],1),attention_mask:(0,p.cat)([(0,p.ones)(n.dims.slice(0,2)),o],1)}}async _prepare_inputs_embeds(e){let t,n,{input_ids:r,pixel_values:o,inputs_embeds:a,attention_mask:i}=e;if(!r&&!o)throw new Error("Either `input_ids` or `pixel_values` should be provided.");return r&&(t=await this.encode_text({input_ids:r})),o&&(n=await this.encode_image({pixel_values:o})),t&&n?({inputs_embeds:a,attention_mask:i}=this._merge_input_ids_with_image_features({inputs_embeds:t,image_features:n,input_ids:r,attention_mask:i})):a=t||n,{inputs_embeds:a,attention_mask:i}}async forward(e){let{input_ids:t,pixel_values:n,attention_mask:r,decoder_input_ids:o,decoder_attention_mask:a,encoder_outputs:i,past_key_values:s,inputs_embeds:l,decoder_inputs_embeds:c}=e;if(l||({inputs_embeds:l,attention_mask:r}=await this._prepare_inputs_embeds({input_ids:t,pixel_values:n,inputs_embeds:l,attention_mask:r})),!i){let{last_hidden_state:e}=await U(this,{inputs_embeds:l,attention_mask:r});i=e}if(!c){if(!o)throw new Error("Either `decoder_input_ids` or `decoder_inputs_embeds` should be provided.");c=await this.encode_text({input_ids:o})}const u={inputs_embeds:c,attention_mask:a,encoder_attention_mask:r,encoder_hidden_states:i,past_key_values:s};return await G(this,u,!0)}}class jn extends ne{constructor(){super(...arguments),ao(this,"forward_params",["input_ids","attention_mask","pixel_values","position_ids","past_key_values"])}}class Ln extends jn{_merge_input_ids_with_image_features(e){const t=e.image_features.dims.at(-1),n=e.image_features.view(-1,t);return K(so(so({image_token_id:this.config.image_token_index},e),{},{image_features:n}))}}class Rn extends ne{constructor(){super(...arguments),ao(this,"forward_params",["input_ids","attention_mask","pixel_values","pixel_attention_mask","position_ids","past_key_values"])}}class Vn extends Rn{async encode_image(e){let{pixel_values:t,pixel_attention_mask:n}=e;return(await j(this.sessions.vision_encoder,{pixel_values:t,pixel_attention_mask:n})).image_features}_merge_input_ids_with_image_features(e){const t=e.image_features.dims.at(-1),n=e.image_features.view(-1,t);return K(so(so({image_token_id:this.config.image_token_id},e),{},{image_features:n}))}}class qn extends Vn{}class Un extends ne{constructor(){super(...arguments),ao(this,"forward_params",["input_ids","inputs_embeds","attention_mask","position_ids","pixel_values","image_sizes","past_key_values"])}}class Wn extends Un{async forward(e){let{input_ids:t=null,attention_mask:n=null,pixel_values:r=null,image_sizes:o=null,position_ids:a=null,inputs_embeds:i=null,past_key_values:s=null,generation_config:l=null,logits_processor:c=null}=e;Kc(e,JN);if(!i){let e;if(r&&1!==t.dims[1]){if(!o)throw new Error("`image_sizes` must be provided when `pixel_values` is provided.");({image_features:e}=await j(this.sessions.vision_encoder,{pixel_values:r,image_sizes:o}))}else{const t=this.config.normalized_config.hidden_size;e=new p.Tensor("float32",[],[0,t])}({inputs_embeds:i}=await j(this.sessions.prepare_inputs_embeds,{input_ids:t,image_features:e}))}return await G(this,{inputs_embeds:i,past_key_values:s,attention_mask:n,position_ids:a,generation_config:l,logits_processor:c},!1)}}class Gn extends ne{}class Hn extends Gn{}class Kn extends Gn{static async from_pretrained(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return super.from_pretrained(e,so(so({},n),{},{model_file_name:null!==(t=n.model_file_name)&&void 0!==t?t:"text_model"}))}}class Zn extends Gn{static async from_pretrained(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return super.from_pretrained(e,so(so({},n),{},{model_file_name:null!==(t=n.model_file_name)&&void 0!==t?t:"text_model"}))}}class $n extends Gn{static async from_pretrained(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return super.from_pretrained(e,so(so({},n),{},{model_file_name:null!==(t=n.model_file_name)&&void 0!==t?t:"vision_model"}))}}class Xn extends Gn{static async from_pretrained(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return super.from_pretrained(e,so(so({},n),{},{model_file_name:null!==(t=n.model_file_name)&&void 0!==t?t:"vision_model"}))}}class Jn extends ne{}class Qn extends Jn{}class Yn extends Jn{static async from_pretrained(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return super.from_pretrained(e,so(so({},n),{},{model_file_name:null!==(t=n.model_file_name)&&void 0!==t?t:"text_model"}))}}class er extends Gn{static async from_pretrained(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return super.from_pretrained(e,so(so({},n),{},{model_file_name:null!==(t=n.model_file_name)&&void 0!==t?t:"vision_model"}))}}class tr extends ne{}class nr extends tr{}class rr extends ne{}class or extends rr{async forward(e){const t=!e.input_ids,n=!e.pixel_values;if(t&&n)throw new Error("Either `input_ids` or `pixel_values` should be provided.");if(t&&(e.input_ids=(0,p.ones)([e.pixel_values.dims[0],1])),n){const{image_size:t}=this.config.vision_config;e.pixel_values=(0,p.full)([0,3,t,t],0)}const{text_embeddings:r,image_embeddings:o,l2norm_text_embeddings:a,l2norm_image_embeddings:i}=await super.forward(e),s={};return t||(s.text_embeddings=r,s.l2norm_text_embeddings=a),n||(s.image_embeddings=o,s.l2norm_image_embeddings=i),s}}class ar extends rr{static async from_pretrained(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return super.from_pretrained(e,so(so({},n),{},{model_file_name:null!==(t=n.model_file_name)&&void 0!==t?t:"text_model"}))}}class ir extends rr{static async from_pretrained(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return super.from_pretrained(e,so(so({},n),{},{model_file_name:null!==(t=n.model_file_name)&&void 0!==t?t:"vision_model"}))}}class sr extends ne{}class lr extends sr{}class cr extends sr{}class ur extends ne{}class dr extends ur{}class pr extends ur{}class hr extends ne{}class fr extends hr{}class mr extends hr{}class gr extends ne{}class _r extends gr{}class vr extends gr{}class yr extends ne{}class wr extends yr{}class br extends yr{}class xr extends ne{}class kr extends xr{}class Cr extends xr{}class Dr extends ne{}class Sr extends Dr{}class Er extends Dr{}class Tr extends ne{}class Ar extends Tr{}class Mr extends Tr{}class Fr extends ne{}class Ir extends Fr{}class Pr extends Fr{}class zr extends ne{}class Or extends zr{}class Nr extends zr{}class Br extends ne{}class jr extends Br{}class Lr extends Br{}class Rr extends ne{}class Vr extends Rr{}class qr extends Rr{}class Ur extends ne{}class Wr extends Ur{}class Gr extends Ur{}class Hr extends ne{}class Kr extends Hr{}class Zr extends Hr{}class $r extends ne{}class Xr extends $r{}class Jr extends $r{}class Qr extends ne{}class Yr extends Qr{}class eo extends Qr{}class to extends ne{}class no extends to{}class ro extends to{}class oo extends ne{}class io extends oo{}class lo extends oo{}class co extends ne{}class uo extends co{}class po extends co{}class ho extends ne{}class fo extends ho{}class mo extends ho{}class go extends ne{}class _o extends go{}class vo extends go{}class yo extends ne{}class wo extends yo{}class bo extends yo{}class xo extends ne{}class ko extends xo{}class Co extends xo{}class Do extends ne{constructor(){super(...arguments),ao(this,"forward_params",["input_ids","attention_mask","position_ids","past_key_values","pixel_values","image_grid_thw"])}}class So extends Do{get_rope_index(e,t,n,r){var o;const{vision_config:a,image_token_id:i,video_token_id:s,vision_start_token_id:l}=this.config,c=null!==(o=a.spatial_merge_size)&&void 0!==o?o:2,u=[];if(t||n){let o=e.tolist();r||(r=(0,p.ones_like)(e));const a=r.tolist(),d=Array.from({length:3},(t=>Array.from({length:e.dims[0]},(t=>Array.from({length:e.dims[1]},(e=>1)))))),h=t?t.tolist():[],m=n?n.tolist():[];let g=0,_=0;for(let e=0;e<o.length;++e){const t=o[e].filter(((t,n)=>1==a[e][n])),n=t.reduce(((e,t,n)=>(t==l&&e.push(n),e)),[]),r=n.map((e=>t[e+1])),p=r.filter((e=>e==i)).length,v=r.filter((e=>e==s)).length;let y=[],w=0,b=p,x=v;for(let e=0;e<r.length;++e){const e=t.findIndex(((e,t)=>t>w&&e==i)),n=t.findIndex(((e,t)=>t>w&&e==s)),r=b>0&&-1!==e?e:t.length+1,o=x>0&&-1!==n?n:t.length+1;let a,l,u,d;r<o?([l,u,d]=h[g],++g,--b,a=r):([l,u,d]=m[_],++_,--x,a=o);const[p,v,k]=[Number(l),Math.floor(Number(u)/c),Math.floor(Number(d)/c)],C=a-w,D=y.length>0?(0,f.max)(y.at(-1))[0]+1:0;y.push(Array.from({length:3*C},((e,t)=>D+t%C)));const S=C+D,E=p*v*k,T=Array.from({length:E},((e,t)=>S+Math.floor(t/(v*k)))),A=Array.from({length:E},((e,t)=>S+Math.floor(t/k)%v)),M=Array.from({length:E},((e,t)=>S+t%k));y.push([T,A,M].flat()),w=a+E}if(w<t.length){const e=y.length>0?(0,f.max)(y.at(-1))[0]+1:0,n=t.length-w;y.push(Array.from({length:3*n},((t,r)=>e+r%n)))}const k=y.reduce(((e,t)=>e+t.length),0),C=new Array(k);let D=0;for(let e=0;e<3;++e)for(let t=0;t<y.length;++t){const n=y[t],r=n.length/3;for(let t=e*r;t<(e+1)*r;++t)C[D++]=n[t]}let S=0;const E=a[e];for(let o=0;o<E.length;++o)if(1==E[o]){for(let t=0;t<3;++t)d[t][e][o]=C[t*k/3+S];++S}const T=(0,f.max)(C)[0];u.push(T+1-o[e].length)}return[new p.Tensor("int64",d.flat(1/0),[3,e.dims[0],e.dims[1]]),new p.Tensor("int64",u,[u.length,1])]}if(r){const{data:e,dims:t}=J(r),n=BigInt64Array.from({length:3*e.length},((t,n)=>e[n%e.length])),o=Array.from({length:t[0]},((n,r)=>(0,f.max)(e.subarray(t[1]*r,t[1]*(r+1)))[0]+1n+BigInt(t[1])));return[new p.Tensor("int64",n,[3,...t]),new p.Tensor("int64",o,[o.length,1])]}{const[t,n]=e.dims,r=BigInt64Array.from({length:3*t*n},((e,r)=>BigInt(Math.floor(r%n/t))));return[new p.Tensor("int64",r,[3,...e.dims]),(0,p.zeros)([t,1])]}}async encode_image(e){let{pixel_values:t,image_grid_thw:n}=e;return(await j(this.sessions.vision_encoder,{pixel_values:t,grid_thw:n})).image_features}_merge_input_ids_with_image_features(e){return K(so({image_token_id:this.config.image_token_id},e))}prepare_inputs_for_generation(e,t,n){if(t.attention_mask&&!t.position_ids)if(t.past_key_values){t.pixel_values=null;const e=BigInt(Object.values(t.past_key_values)[0].dims.at(-2)),n=t.rope_deltas.map((t=>e+t));t.position_ids=(0,p.stack)([n,n,n],0)}else[t.position_ids,t.rope_deltas]=this.get_rope_index(t.input_ids,t.image_grid_thw,t.video_grid_thw,t.attention_mask);return t}}class Eo extends ne{}class To extends Eo{}class Ao extends Eo{}class Mo extends ne{}class Fo extends Mo{}class Io extends Mo{}class Po extends ne{}class zo extends Po{}class Oo extends Po{}class No extends ne{}class Bo extends No{}class jo extends No{}class Lo extends ne{}class Ro extends Lo{}class Vo extends Lo{}class qo extends ne{}class Uo extends qo{}class Wo extends qo{async _call(e){return new ju(await super._call(e))}}class Go extends ne{}class Ho extends Go{}class Ko extends Go{async _call(e){return new ju(await super._call(e))}}class Zo extends ne{}class $o extends Zo{}class Xo extends ne{}class Jo extends Xo{}class Qo extends Xo{async _call(e){return new ju(await super._call(e))}}class Yo extends ne{}class ea extends Yo{}class ta extends ne{}class na extends ta{}class ra extends ta{async _call(e){return new ju(await super._call(e))}}class oa extends ne{}class aa extends oa{}class ia extends ne{}class sa extends ia{}class la extends ia{async _call(e){return new ju(await super._call(e))}}class ca extends ne{}class ua extends ca{async _call(e){return new Gu(await super._call(e))}}class da extends ne{}class pa extends da{}class ha extends da{async _call(e){return new ju(await super._call(e))}}class fa extends ne{}class ma extends fa{}class ga extends fa{async _call(e){return new ju(await super._call(e))}}class _a extends ne{}class va extends _a{}class ya extends _a{}class wa extends ne{}class ba extends wa{}class xa extends wa{}class ka extends ne{}class Ca extends ka{}class Da extends ka{async _call(e){return new ju(await super._call(e))}}class Sa extends ne{}class Ea extends Sa{}class Ta extends Sa{async _call(e){return new Ma(await super._call(e))}}class Aa extends Sa{async _call(e){return new Fa(await super._call(e))}}class Ma extends re{constructor(e){let{logits:t,pred_boxes:n}=e;super(),this.logits=t,this.pred_boxes=n}}class Fa extends re{constructor(e){let{logits:t,pred_boxes:n,pred_masks:r}=e;super(),this.logits=t,this.pred_boxes=n,this.pred_masks=r}}class Ia extends ne{}class Pa extends Ia{}class za extends Ia{async _call(e){return new Oa(await super._call(e))}}class Oa extends re{constructor(e){let{logits:t,pred_boxes:n}=e;super(),this.logits=t,this.pred_boxes=n}}class Na extends ne{}class Ba extends Na{}class ja extends Na{async _call(e){return new La(await super._call(e))}}class La extends Oa{}class Ra extends ne{}class Va extends Ra{}class qa extends Ra{async _call(e){return new Ua(await super._call(e))}}class Ua extends Oa{}class Wa extends ne{}class Ga extends Wa{}class Ha extends Wa{async _call(e){return new Oa(await super._call(e))}}class Ka extends ne{}class Za extends Ka{}class $a extends Ka{async _call(e){return new Xa(await super._call(e))}}class Xa extends Ma{}class Ja extends ne{}class Qa extends Ja{}class Ya extends Ja{async _call(e){return new ju(await super._call(e))}}class ei extends ne{}class ti extends ei{}class ni extends ei{async _call(e){return new ju(await super._call(e))}}class ri extends ne{}class oi extends ri{}class ai extends ri{async _call(e){return new ju(await super._call(e))}}class ii extends ne{}class si extends ii{}class li extends ii{async _call(e){return new ju(await super._call(e))}}class ci extends ii{}class ui extends ne{}class di extends ui{}class pi extends ui{}class hi extends ne{}class fi extends hi{}class mi extends hi{}class gi extends ne{}class _i extends gi{}class vi extends ne{}class yi extends vi{}class wi extends vi{}class bi extends vi{}class xi extends ne{}class ki extends xi{}class Ci extends ne{}class Di extends Ci{}class Si extends ne{}class Ei extends Si{}class Ti extends ne{}class Ai extends Ti{}class Mi extends Ti{}class Fi extends ne{}class Ii extends Fi{}class Pi extends Fi{}class zi extends ne{}class Oi extends zi{}class Ni extends ne{}class Bi extends Ni{}class ji extends Ni{async _call(e){return new ju(await super._call(e))}}class Li extends ne{}class Ri extends Li{}class Vi extends Li{async _call(e){return new ju(await super._call(e))}}class qi extends ne{}class Ui extends qi{}class Wi extends qi{async _call(e){return new ju(await super._call(e))}}class Gi extends ne{}class Hi extends Gi{}class Ki extends Gi{async _call(e){return new ju(await super._call(e))}}class Zi extends ne{}class $i extends Zi{}class Xi extends ne{}class Ji extends Xi{}class Qi extends Xi{async _call(e){return new Yi(await super._call(e))}}class Yi extends re{constructor(e){let{logits:t,pred_boxes:n}=e;super(),this.logits=t,this.pred_boxes=n}}class es extends ne{}class ts extends es{async get_image_embeddings(e){let{pixel_values:t}=e;return await U(this,{pixel_values:t})}async forward(e){if(e.image_embeddings&&e.image_positional_embeddings||(e=so(so({},e),await this.get_image_embeddings(e))),!e.input_labels&&e.input_points){const t=e.input_points.dims.slice(0,-1),n=t.reduce(((e,t)=>e*t),1);e.input_labels=new p.Tensor("int64",new BigInt64Array(n).fill(1n),t)}const t={image_embeddings:e.image_embeddings,image_positional_embeddings:e.image_positional_embeddings};return e.input_points&&(t.input_points=e.input_points),e.input_labels&&(t.input_labels=e.input_labels),e.input_boxes&&(t.input_boxes=e.input_boxes),await j(this.sessions.prompt_encoder_mask_decoder,t)}async _call(e){return new ns(await super._call(e))}}class ns extends re{constructor(e){let{iou_scores:t,pred_masks:n}=e;super(),this.iou_scores=t,this.pred_masks=n}}class rs extends ne{}class os extends rs{}class as extends rs{}class is extends ne{}class ss extends is{}class ls extends is{}class cs extends ne{}class us extends cs{}class ds extends cs{async _call(e){return new Uu(await super._call(e))}}class ps extends cs{async _call(e){return new ju(await super._call(e))}}class hs extends cs{async _call(e){return new Ru(await super._call(e))}}class fs extends ne{}class ms extends fs{}class gs extends fs{async _call(e){return new Ru(await super._call(e))}}class _s extends ne{}class vs extends _s{}class ys extends ne{}class ws extends ys{}class bs extends ys{async _call(e){return new Uu(await super._call(e))}}class xs extends ys{async _call(e){return new ju(await super._call(e))}}class ks extends ne{}class Cs extends ks{}class Ds extends ks{async _call(e){return new Uu(await super._call(e))}}class Ss extends ks{async _call(e){return new ju(await super._call(e))}}class Es extends ks{async _call(e){return new Ru(await super._call(e))}}class Ts extends ne{}class As extends Ts{}class Ms extends Ts{async _call(e){return new Uu(await super._call(e))}}class Fs extends Ts{async _call(e){return new ju(await super._call(e))}}class Is extends ne{}class Ps extends cs{}class zs extends cs{async _call(e){return new Uu(await super._call(e))}}class Os extends cs{async _call(e){return new ju(await super._call(e))}}class Ns extends ne{}class Bs extends Ns{}class js extends Ns{async _call(e){return new Uu(await super._call(e))}}class Ls extends Ns{async _call(e){return new ju(await super._call(e))}}class Rs extends Ns{async _call(e){return new Lu(await super._call(e))}}class Vs extends Ns{async _call(e){return new Ru(await super._call(e))}}class qs extends ne{}class Us extends qs{}class Ws extends ne{}class Gs extends Ws{}class Hs extends Ws{}class Ks extends Ws{async generate_speech(e,t){let{threshold:n=.5,minlenratio:r=0,maxlenratio:o=20,vocoder:a=null}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const i={input_ids:e},{encoder_outputs:s,encoder_attention_mask:l}=await U(this,i),c=s.dims[1]/this.config.reduction_factor,u=Math.floor(c*o),d=Math.floor(c*r),h=this.config.num_mel_bins;let f=[],m=null,g=null,_=0;for(;;){++_;const e=V(!!g);let r;r=g?g.output_sequence_out:new p.Tensor("float32",new Float32Array(h),[1,1,h]);let o={use_cache_branch:e,output_sequence:r,encoder_attention_mask:l,speaker_embeddings:t,encoder_hidden_states:s};this.addPastKeyValues(o,m),g=await j(this.sessions.decoder_model_merged,o),m=this.getPastKeyValues(g,m);const{prob:a,spectrum:i}=g;if(f.push(i),_>=d&&(Array.from(a.data).filter((e=>e>=n)).length>0||_>=u))break}const v=(0,p.cat)(f),{waveform:y}=await j(a.sessions.model,{spectrogram:v});return{spectrogram:v,waveform:y}}}class Zs extends ne{constructor(){super(...arguments),ao(this,"main_input_name","spectrogram")}}class $s extends ne{}class Xs extends $s{}class Js extends ne{}class Qs extends Js{}class Ys extends Js{}class el extends ne{}class tl extends el{}class nl extends el{}class rl extends ne{}class ol extends rl{}class al extends rl{}class il extends ne{}class sl extends il{}class ll extends il{static async from_pretrained(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return super.from_pretrained(e,so(so({},n),{},{model_file_name:null!==(t=n.model_file_name)&&void 0!==t?t:"text_model"}))}}class cl extends il{static async from_pretrained(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return super.from_pretrained(e,so(so({},n),{},{model_file_name:null!==(t=n.model_file_name)&&void 0!==t?t:"audio_model"}))}}class ul extends ne{}class dl extends ul{async _call(e){return new Hu(await super._call(e))}}class pl extends ne{}class hl extends pl{}class fl extends pl{}class ml extends pl{}class gl extends ne{}class _l extends gl{}class vl extends gl{}class yl extends ne{}class wl extends yl{}class bl extends yl{async _call(e){return new ju(await super._call(e))}}class xl extends ne{}class kl extends xl{}class Cl extends xl{}class Dl extends ne{constructor(){super(...arguments),ao(this,"forward_params",["input_ids","attention_mask","encoder_outputs","decoder_input_ids","decoder_attention_mask","past_key_values"])}_apply_and_filter_by_delay_pattern_mask(e){const[t,n]=e.dims,r=this.config.decoder.num_codebooks,o=n-r;let a=0;for(let l=0;l<e.size;++l){if(e.data[l]===this.config.decoder.pad_token_id)continue;const t=l%n-Math.floor(l/n)%r;t>0&&t<=o&&(e.data[a++]=e.data[l])}const i=Math.floor(t/r),s=a/(i*r);return new p.Tensor(e.type,e.data.slice(0,a),[i,r,s])}prepare_inputs_for_generation(e,t,n){let r=structuredClone(e);for(let o=0;o<r.length;++o)for(let e=0;e<r[o].length;++e)o%this.config.decoder.num_codebooks>=e&&(r[o][e]=BigInt(this.config.decoder.pad_token_id));null!==n.guidance_scale&&n.guidance_scale>1&&(r=r.concat(r));return super.prepare_inputs_for_generation(r,t,n)}async generate(e){const t=await super.generate(e),n=this._apply_and_filter_by_delay_pattern_mask(t).unsqueeze_(0),{audio_values:r}=await j(this.sessions.encodec_decode,{audio_codes:n});return r}}class Sl extends ne{}class El extends Sl{}class Tl extends Sl{async _call(e){return new ju(await super._call(e))}}class Al extends Sl{}class Ml extends ne{}class Fl extends Ml{}class Il extends Ml{async _call(e){return new ju(await super._call(e))}}class Pl extends Ml{}class zl extends ne{}class Ol extends zl{}class Nl extends zl{async _call(e){return new ju(await super._call(e))}}class Bl extends zl{}class jl extends ne{}class Ll extends jl{}class Rl extends jl{async _call(e){return new ju(await super._call(e))}}class Vl extends jl{}class ql extends ne{}class Ul extends ql{}class Wl extends ne{}class Gl extends Wl{constructor(){super(...arguments),ao(this,"forward_params",["input_ids","pixel_values","images_seq_mask","images_emb_mask","attention_mask","position_ids","past_key_values"]),this._generation_mode="text"}async forward(e){var t;const n=null!==(t=this._generation_mode)&&void 0!==t?t:"text";let r;if("text"!==n&&e.past_key_values){const t=this.sessions.gen_img_embeds,n=(0,s.pick)({image_ids:e.input_ids},t.inputNames);r=await j(t,n)}else{const t=this.sessions.prepare_inputs_embeds,n=(0,s.pick)(e,t.inputNames);r=await j(t,n)}const o=so(so({},e),r),a=await G(this,o),i=this.sessions["text"===n?"lm_head":"gen_head"];if(!i)throw new Error('Unable to find "'.concat(i,'" generation head'));const l=await j(i,(0,s.pick)(a,i.inputNames));return so(so(so({},r),a),l)}async generate(e){return this._generation_mode="text",super.generate(e)}async generate_images(e){var t;this._generation_mode="image";const n=(null!==(t=e.inputs)&&void 0!==t?t:e[this.main_input_name]).dims[1],r=(await super.generate(e)).slice(null,[n,null]),o=this.sessions.image_decode,{decoded_image:a}=await j(o,{generated_tokens:r}),i=a.add_(1).mul_(127.5).clamp_(0,255).to("uint8"),s=[];for(const l of i){const e=h.RawImage.fromTensor(l);s.push(e)}return s}}class Hl extends re{constructor(e){let{char_logits:t,bpe_logits:n,wp_logits:r}=e;super(),this.char_logits=t,this.bpe_logits=n,this.wp_logits=r}get logits(){return[this.char_logits,this.bpe_logits,this.wp_logits]}}class Kl extends ne{}class Zl extends Kl{async _call(e){return new Hl(await super._call(e))}}class $l extends ne{}class Xl extends $l{}class Jl extends $l{}class Ql extends ne{}class Yl extends Ql{}class ec extends Ql{}class tc extends ne{constructor(){super(...arguments),ao(this,"forward_params",["input_ids","attention_mask","position_ids","audio_values","past_key_values"])}}class nc extends tc{_merge_input_ids_with_audio_features(e){const t=e.audio_features.dims.at(-1),n=e.audio_features.view(-1,t);return function(e){let{audio_token_id:t,inputs_embeds:n,audio_features:r,input_ids:o,attention_mask:a}=e;return H({modality_token_id:t,inputs_embeds:n,modality_features:r,input_ids:o,attention_mask:a})}(so(so({audio_token_id:this.config.ignore_index},e),{},{audio_features:n}))}}class rc extends ne{constructor(){super(...arguments),ao(this,"main_input_name","input_values"),ao(this,"forward_params",["input_values"])}}class oc extends re{constructor(e){let{audio_codes:t}=e;super(),this.audio_codes=t}}class ac extends re{constructor(e){let{audio_values:t}=e;super(),this.audio_values=t}}class ic extends rc{async encode(e){return new oc(await j(this.sessions.encoder_model,e))}async decode(e){return new ac(await j(this.sessions.decoder_model,e))}}class sc extends rc{static async from_pretrained(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return super.from_pretrained(e,so(so({},n),{},{model_file_name:null!==(t=n.model_file_name)&&void 0!==t?t:"encoder_model"}))}}class lc extends rc{static async from_pretrained(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return super.from_pretrained(e,so(so({},n),{},{model_file_name:null!==(t=n.model_file_name)&&void 0!==t?t:"decoder_model"}))}}class cc extends ne{constructor(){super(...arguments),ao(this,"main_input_name","input_values"),ao(this,"forward_params",["input_values"])}}class uc extends re{constructor(e){let{audio_codes:t}=e;super(),this.audio_codes=t}}class dc extends re{constructor(e){let{audio_values:t}=e;super(),this.audio_values=t}}class pc extends cc{async encode(e){return new uc(await j(this.sessions.encoder_model,e))}async decode(e){return new dc(await j(this.sessions.decoder_model,e))}}class hc extends cc{static async from_pretrained(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return super.from_pretrained(e,so(so({},n),{},{model_file_name:null!==(t=n.model_file_name)&&void 0!==t?t:"encoder_model"}))}}class fc extends cc{static async from_pretrained(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return super.from_pretrained(e,so(so({},n),{},{model_file_name:null!==(t=n.model_file_name)&&void 0!==t?t:"decoder_model"}))}}class mc extends ne{constructor(){super(...arguments),ao(this,"main_input_name","input_values"),ao(this,"forward_params",["input_values"])}}class gc extends mc{async encode(e){return await j(this.sessions.encoder_model,e)}async decode(e){return await j(this.sessions.decoder_model,e)}}class _c extends mc{static async from_pretrained(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return super.from_pretrained(e,so(so({},n),{},{model_file_name:null!==(t=n.model_file_name)&&void 0!==t?t:"encoder_model"}))}}class vc extends mc{static async from_pretrained(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return super.from_pretrained(e,so(so({},n),{},{model_file_name:null!==(t=n.model_file_name)&&void 0!==t?t:"decoder_model"}))}}class yc{static async from_pretrained(e){let{progress_callback:t=null,config:n=null,cache_dir:o=null,local_files_only:a=!1,revision:i="main",model_file_name:s=null,subfolder:l="onnx",device:c=null,dtype:u=null,use_external_data_format:d=null,session_options:p={}}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const h={progress_callback:t,config:n,cache_dir:o,local_files_only:a,revision:i,model_file_name:s,subfolder:l,device:c,dtype:u,use_external_data_format:d,session_options:p};if(h.config=await r.AutoConfig.from_pretrained(e,h),!this.MODEL_CLASS_MAPPINGS)throw new Error("`MODEL_CLASS_MAPPINGS` not implemented for this type of `AutoClass`: "+this.name);const f=h.config.model_type;for(const r of this.MODEL_CLASS_MAPPINGS){let t=r.get(f);if(!t){for(const e of r.values())if(e[0]===f){t=e;break}if(!t)continue}return await t[1].from_pretrained(e,h)}if(this.BASE_IF_FAIL)return au.has(f)||console.warn('Unknown model class "'.concat(f,'", attempting to construct from base class.')),await ne.from_pretrained(e,h);throw Error("Unsupported model type: ".concat(f))}}ao(yc,"MODEL_CLASS_MAPPINGS",null),ao(yc,"BASE_IF_FAIL",!1);const wc=new Map([["bert",["BertModel",ie]],["modernbert",["ModernBertModel",pe]],["nomic_bert",["NomicBertModel",_e]],["roformer",["RoFormerModel",ye]],["electra",["ElectraModel",Fe]],["esm",["EsmModel",st]],["convbert",["ConvBertModel",De]],["camembert",["CamembertModel",Be]],["deberta",["DebertaModel",Ue]],["deberta-v2",["DebertaV2Model",$e]],["mpnet",["MPNetModel",_t]],["albert",["AlbertModel",Tt]],["distilbert",["DistilBertModel",tt]],["roberta",["RobertaModel",rn]],["xlm",["XLMModel",un]],["xlm-roberta",["XLMRobertaModel",gn]],["clap",["ClapModel",sl]],["clip",["CLIPModel",Hn]],["clipseg",["CLIPSegModel",lr]],["chinese_clip",["ChineseCLIPModel",nr]],["siglip",["SiglipModel",Qn]],["jina_clip",["JinaCLIPModel",or]],["mobilebert",["MobileBertModel",pt]],["squeezebert",["SqueezeBertModel",kt]],["wav2vec2",["Wav2Vec2Model",us]],["wav2vec2-bert",["Wav2Vec2BertModel",As]],["unispeech",["UniSpeechModel",ws]],["unispeech-sat",["UniSpeechSatModel",Cs]],["hubert",["HubertModel",Ps]],["wavlm",["WavLMModel",Bs]],["audio-spectrogram-transformer",["ASTModel",xn]],["vits",["VitsModel",dl]],["pyannote",["PyAnnoteModel",ms]],["wespeaker-resnet",["WeSpeakerResNetModel",vs]],["detr",["DetrModel",Ea]],["rt_detr",["RTDetrModel",Pa]],["rt_detr_v2",["RTDetrV2Model",Ba]],["rf_detr",["RFDetrModel",Va]],["d_fine",["DFineModel",Ga]],["table-transformer",["TableTransformerModel",Za]],["vit",["ViTModel",Uo]],["ijepa",["IJepaModel",Ho]],["pvt",["PvtModel",Jo]],["vit_msn",["ViTMSNModel",na]],["vit_mae",["ViTMAEModel",ea]],["groupvit",["GroupViTModel",aa]],["fastvit",["FastViTModel",sa]],["mobilevit",["MobileViTModel",pa]],["mobilevitv2",["MobileViTV2Model",ma]],["owlvit",["OwlViTModel",va]],["owlv2",["Owlv2Model",ba]],["beit",["BeitModel",Ca]],["deit",["DeiTModel",Qa]],["hiera",["HieraModel",ti]],["convnext",["ConvNextModel",Bi]],["convnextv2",["ConvNextV2Model",Ri]],["dinov2",["Dinov2Model",Ui]],["dinov2_with_registers",["Dinov2WithRegistersModel",Hi]],["resnet",["ResNetModel",oi]],["swin",["SwinModel",si]],["swin2sr",["Swin2SRModel",di]],["donut-swin",["DonutSwinModel",Oi]],["yolos",["YolosModel",Ji]],["dpt",["DPTModel",fi]],["glpn",["GLPNModel",Ii]],["hifigan",["SpeechT5HifiGan",Zs]],["efficientnet",["EfficientNetModel",wl]],["decision_transformer",["DecisionTransformerModel",Ul]],["patchtst",["PatchTSTForPrediction",Xl]],["patchtsmixer",["PatchTSMixerForPrediction",Yl]],["mobilenet_v1",["MobileNetV1Model",El]],["mobilenet_v2",["MobileNetV2Model",Fl]],["mobilenet_v3",["MobileNetV3Model",Ol]],["mobilenet_v4",["MobileNetV4Model",Ll]],["maskformer",["MaskFormerModel",Ai]],["mgp-str",["MgpstrForSceneTextRecognition",Zl]],["style_text_to_speech_2",["StyleTextToSpeech2Model",Us]]]),bc=new Map([["t5",["T5Model",Pt]],["longt5",["LongT5Model",Nt]],["mt5",["MT5Model",Lt]],["bart",["BartModel",qt]],["mbart",["MBartModel",Ht]],["marian",["MarianModel",os]],["whisper",["WhisperModel",Dn]],["m2m_100",["M2M100Model",ss]],["blenderbot",["BlenderbotModel",Jt]],["blenderbot-small",["BlenderbotSmallModel",en]]]),xc=new Map([["mimi",["MimiModel",ic]],["dac",["DacModel",pc]],["snac",["SnacModel",gc]]]),kc=new Map([["bloom",["BloomModel",zo]],["jais",["JAISModel",fr]],["gpt2",["GPT2Model",dr]],["gptj",["GPTJModel",kr]],["gpt_bigcode",["GPTBigCodeModel",Sr]],["gpt_neo",["GPTNeoModel",_r]],["gpt_neox",["GPTNeoXModel",wr]],["codegen",["CodeGenModel",Ar]],["llama",["LlamaModel",Ir]],["exaone",["ExaoneModel",Vr]],["olmo",["OlmoModel",Kr]],["olmo2",["Olmo2Model",Xr]],["mobilellm",["MobileLLMModel",Wr]],["granite",["GraniteModel",Yr]],["cohere",["CohereModel",no]],["gemma",["GemmaModel",io]],["gemma2",["Gemma2Model",uo]],["gemma3_text",["Gemma3Model",fo]],["helium",["HeliumModel",Or]],["glm",["GlmModel",jr]],["openelm",["OpenELMModel",_o]],["qwen2",["Qwen2Model",wo]],["qwen3",["Qwen3Model",ko]],["phi",["PhiModel",To]],["phi3",["Phi3Model",Fo]],["mpt",["MptModel",Bo]],["opt",["OPTModel",Ro]],["mistral",["MistralModel",Qs]],["starcoder2",["Starcoder2Model",tl]],["falcon",["FalconModel",ol]],["stablelm",["StableLmModel",_l]]]),Cc=new Map([["speecht5",["SpeechT5ForSpeechToText",Hs]],["whisper",["WhisperForConditionalGeneration",Sn]],["lite-whisper",["LiteWhisperForConditionalGeneration",En]],["moonshine",["MoonshineForConditionalGeneration",Mn]]]),Dc=new Map([["speecht5",["SpeechT5ForTextToSpeech",Ks]]]),Sc=new Map([["vits",["VitsModel",dl]],["musicgen",["MusicgenForConditionalGeneration",Dl]]]),Ec=new Map([["bert",["BertForSequenceClassification",le]],["modernbert",["ModernBertForSequenceClassification",fe]],["roformer",["RoFormerForSequenceClassification",be]],["electra",["ElectraForSequenceClassification",Pe]],["esm",["EsmForSequenceClassification",ct]],["convbert",["ConvBertForSequenceClassification",Ee]],["camembert",["CamembertForSequenceClassification",Le]],["deberta",["DebertaForSequenceClassification",Ge]],["deberta-v2",["DebertaV2ForSequenceClassification",Je]],["mpnet",["MPNetForSequenceClassification",yt]],["albert",["AlbertForSequenceClassification",At]],["distilbert",["DistilBertForSequenceClassification",nt]],["roberta",["RobertaForSequenceClassification",an]],["xlm",["XLMForSequenceClassification",pn]],["xlm-roberta",["XLMRobertaForSequenceClassification",vn]],["bart",["BartForSequenceClassification",Wt]],["mbart",["MBartForSequenceClassification",Zt]],["mobilebert",["MobileBertForSequenceClassification",ft]],["squeezebert",["SqueezeBertForSequenceClassification",Dt]]]),Tc=new Map([["bert",["BertForTokenClassification",ce]],["modernbert",["ModernBertForTokenClassification",me]],["roformer",["RoFormerForTokenClassification",xe]],["electra",["ElectraForTokenClassification",ze]],["esm",["EsmForTokenClassification",ut]],["convbert",["ConvBertForTokenClassification",Te]],["camembert",["CamembertForTokenClassification",Re]],["deberta",["DebertaForTokenClassification",He]],["deberta-v2",["DebertaV2ForTokenClassification",Qe]],["mpnet",["MPNetForTokenClassification",wt]],["distilbert",["DistilBertForTokenClassification",rt]],["roberta",["RobertaForTokenClassification",sn]],["xlm",["XLMForTokenClassification",hn]],["xlm-roberta",["XLMRobertaForTokenClassification",yn]]]),Ac=new Map([["t5",["T5ForConditionalGeneration",zt]],["longt5",["LongT5ForConditionalGeneration",Bt]],["mt5",["MT5ForConditionalGeneration",Rt]],["bart",["BartForConditionalGeneration",Ut]],["mbart",["MBartForConditionalGeneration",Kt]],["marian",["MarianMTModel",as]],["m2m_100",["M2M100ForConditionalGeneration",ls]],["blenderbot",["BlenderbotForConditionalGeneration",Qt]],["blenderbot-small",["BlenderbotSmallForConditionalGeneration",tn]]]),Mc=new Map([["bloom",["BloomForCausalLM",Oo]],["gpt2",["GPT2LMHeadModel",pr]],["jais",["JAISLMHeadModel",mr]],["gptj",["GPTJForCausalLM",Cr]],["gpt_bigcode",["GPTBigCodeForCausalLM",Er]],["gpt_neo",["GPTNeoForCausalLM",vr]],["gpt_neox",["GPTNeoXForCausalLM",br]],["codegen",["CodeGenForCausalLM",Mr]],["llama",["LlamaForCausalLM",Pr]],["exaone",["ExaoneForCausalLM",qr]],["olmo",["OlmoForCausalLM",Zr]],["olmo2",["Olmo2ForCausalLM",Jr]],["mobilellm",["MobileLLMForCausalLM",Gr]],["granite",["GraniteForCausalLM",eo]],["cohere",["CohereForCausalLM",ro]],["gemma",["GemmaForCausalLM",lo]],["gemma2",["Gemma2ForCausalLM",po]],["gemma3_text",["Gemma3ForCausalLM",mo]],["helium",["HeliumForCausalLM",Nr]],["glm",["GlmForCausalLM",Lr]],["openelm",["OpenELMForCausalLM",vo]],["qwen2",["Qwen2ForCausalLM",bo]],["qwen3",["Qwen3ForCausalLM",Co]],["phi",["PhiForCausalLM",Ao]],["phi3",["Phi3ForCausalLM",Io]],["mpt",["MptForCausalLM",jo]],["opt",["OPTForCausalLM",Vo]],["mbart",["MBartForCausalLM",$t]],["mistral",["MistralForCausalLM",Ys]],["starcoder2",["Starcoder2ForCausalLM",nl]],["falcon",["FalconForCausalLM",al]],["trocr",["TrOCRForCausalLM",Xs]],["stablelm",["StableLmForCausalLM",vl]],["phi3_v",["Phi3VForCausalLM",Wn]]]),Fc=new Map([["multi_modality",["MultiModalityCausalLM",Gl]]]),Ic=new Map([["bert",["BertForMaskedLM",se]],["modernbert",["ModernBertForMaskedLM",he]],["roformer",["RoFormerForMaskedLM",we]],["electra",["ElectraForMaskedLM",Ie]],["esm",["EsmForMaskedLM",lt]],["convbert",["ConvBertForMaskedLM",Se]],["camembert",["CamembertForMaskedLM",je]],["deberta",["DebertaForMaskedLM",We]],["deberta-v2",["DebertaV2ForMaskedLM",Xe]],["mpnet",["MPNetForMaskedLM",vt]],["albert",["AlbertForMaskedLM",Ft]],["distilbert",["DistilBertForMaskedLM",at]],["roberta",["RobertaForMaskedLM",on]],["xlm",["XLMWithLMHeadModel",dn]],["xlm-roberta",["XLMRobertaForMaskedLM",_n]],["mobilebert",["MobileBertForMaskedLM",ht]],["squeezebert",["SqueezeBertForMaskedLM",Ct]]]),Pc=new Map([["bert",["BertForQuestionAnswering",ue]],["roformer",["RoFormerForQuestionAnswering",ke]],["electra",["ElectraForQuestionAnswering",Oe]],["convbert",["ConvBertForQuestionAnswering",Ae]],["camembert",["CamembertForQuestionAnswering",Ve]],["deberta",["DebertaForQuestionAnswering",Ke]],["deberta-v2",["DebertaV2ForQuestionAnswering",Ye]],["mpnet",["MPNetForQuestionAnswering",bt]],["albert",["AlbertForQuestionAnswering",Mt]],["distilbert",["DistilBertForQuestionAnswering",ot]],["roberta",["RobertaForQuestionAnswering",ln]],["xlm",["XLMForQuestionAnswering",fn]],["xlm-roberta",["XLMRobertaForQuestionAnswering",wn]],["mobilebert",["MobileBertForQuestionAnswering",mt]],["squeezebert",["SqueezeBertForQuestionAnswering",St]]]),zc=new Map([["vision-encoder-decoder",["VisionEncoderDecoderModel",Fn]],["idefics3",["Idefics3ForConditionalGeneration",Vn]],["smolvlm",["SmolVLMForConditionalGeneration",qn]]]),Oc=new Map([["llava",["LlavaForConditionalGeneration",Pn]],["llava_onevision",["LlavaOnevisionForConditionalGeneration",zn]],["moondream1",["Moondream1ForConditionalGeneration",On]],["florence2",["Florence2ForConditionalGeneration",Bn]],["qwen2-vl",["Qwen2VLForConditionalGeneration",So]],["idefics3",["Idefics3ForConditionalGeneration",Vn]],["smolvlm",["SmolVLMForConditionalGeneration",qn]],["paligemma",["PaliGemmaForConditionalGeneration",Ln]]]),Nc=new Map([["ultravox",["UltravoxModel",nc]]]),Bc=new Map([["vision-encoder-decoder",["VisionEncoderDecoderModel",Fn]]]),jc=new Map([["vit",["ViTForImageClassification",Wo]],["ijepa",["IJepaForImageClassification",Ko]],["pvt",["PvtForImageClassification",Qo]],["vit_msn",["ViTMSNForImageClassification",ra]],["fastvit",["FastViTForImageClassification",la]],["mobilevit",["MobileViTForImageClassification",ha]],["mobilevitv2",["MobileViTV2ForImageClassification",ga]],["beit",["BeitForImageClassification",Da]],["deit",["DeiTForImageClassification",Ya]],["hiera",["HieraForImageClassification",ni]],["convnext",["ConvNextForImageClassification",ji]],["convnextv2",["ConvNextV2ForImageClassification",Vi]],["dinov2",["Dinov2ForImageClassification",Wi]],["dinov2_with_registers",["Dinov2WithRegistersForImageClassification",Ki]],["resnet",["ResNetForImageClassification",ai]],["swin",["SwinForImageClassification",li]],["segformer",["SegformerForImageClassification",fl]],["efficientnet",["EfficientNetForImageClassification",bl]],["mobilenet_v1",["MobileNetV1ForImageClassification",Tl]],["mobilenet_v2",["MobileNetV2ForImageClassification",Il]],["mobilenet_v3",["MobileNetV3ForImageClassification",Nl]],["mobilenet_v4",["MobileNetV4ForImageClassification",Rl]]]),Lc=new Map([["detr",["DetrForObjectDetection",Ta]],["rt_detr",["RTDetrForObjectDetection",za]],["rt_detr_v2",["RTDetrV2ForObjectDetection",ja]],["rf_detr",["RFDetrForObjectDetection",qa]],["d_fine",["DFineForObjectDetection",Ha]],["table-transformer",["TableTransformerForObjectDetection",$a]],["yolos",["YolosForObjectDetection",Qi]]]),Rc=new Map([["owlvit",["OwlViTForObjectDetection",ya]],["owlv2",["Owlv2ForObjectDetection",xa]],["grounding-dino",["GroundingDinoForObjectDetection",$i]]]),Vc=new Map([["detr",["DetrForSegmentation",Aa]],["clipseg",["CLIPSegForImageSegmentation",cr]]]),qc=new Map([["segformer",["SegformerForSemanticSegmentation",ml]],["sapiens",["SapiensForSemanticSegmentation",yi]],["swin",["SwinForSemanticSegmentation",ci]],["mobilenet_v1",["MobileNetV1ForSemanticSegmentation",Al]],["mobilenet_v2",["MobileNetV2ForSemanticSegmentation",Pl]],["mobilenet_v3",["MobileNetV3ForSemanticSegmentation",Bl]],["mobilenet_v4",["MobileNetV4ForSemanticSegmentation",Vl]]]),Uc=new Map([["detr",["DetrForSegmentation",Aa]],["maskformer",["MaskFormerForInstanceSegmentation",Mi]]]),Wc=new Map([["sam",["SamModel",ts]]]),Gc=new Map([["wav2vec2",["Wav2Vec2ForCTC",ds]],["wav2vec2-bert",["Wav2Vec2BertForCTC",Ms]],["unispeech",["UniSpeechForCTC",bs]],["unispeech-sat",["UniSpeechSatForCTC",Ds]],["wavlm",["WavLMForCTC",js]],["hubert",["HubertForCTC",zs]]]),Hc=new Map([["wav2vec2",["Wav2Vec2ForSequenceClassification",ps]],["wav2vec2-bert",["Wav2Vec2BertForSequenceClassification",Fs]],["unispeech",["UniSpeechForSequenceClassification",xs]],["unispeech-sat",["UniSpeechSatForSequenceClassification",Ss]],["wavlm",["WavLMForSequenceClassification",Ls]],["hubert",["HubertForSequenceClassification",Os]],["audio-spectrogram-transformer",["ASTForAudioClassification",kn]]]),Zc=new Map([["wavlm",["WavLMForXVector",Rs]]]),$c=new Map([["unispeech-sat",["UniSpeechSatForAudioFrameClassification",Es]],["wavlm",["WavLMForAudioFrameClassification",Vs]],["wav2vec2",["Wav2Vec2ForAudioFrameClassification",hs]],["pyannote",["PyAnnoteForAudioFrameClassification",gs]]]),Xc=new Map([["vitmatte",["VitMatteForImageMatting",ua]]]),Jc=new Map([["patchtst",["PatchTSTForPrediction",Jl]],["patchtsmixer",["PatchTSMixerForPrediction",ec]]]),Qc=new Map([["swin2sr",["Swin2SRForImageSuperResolution",pi]]]),Yc=new Map([["dpt",["DPTForDepthEstimation",mi]],["depth_anything",["DepthAnythingForDepthEstimation",_i]],["glpn",["GLPNForDepthEstimation",Pi]],["sapiens",["SapiensForDepthEstimation",wi]],["depth_pro",["DepthProForDepthEstimation",ki]],["metric3d",["Metric3DForDepthEstimation",Di]],["metric3dv2",["Metric3Dv2ForDepthEstimation",Ei]]]),eu=new Map([["sapiens",["SapiensForNormalEstimation",bi]]]),tu=new Map([["vitpose",["VitPoseForPoseEstimation",$o]]]),nu=new Map([["clip",["CLIPVisionModelWithProjection",Xn]],["siglip",["SiglipVisionModel",er]],["jina_clip",["JinaCLIPVisionModel",ir]]]),ru=[[wc,w],[bc,b],[kc,C],[xc,F],[Ec,w],[Tc,w],[Ac,x],[Cc,x],[Mc,C],[Fc,T],[Ic,w],[Pc,w],[zc,k],[Oc,S],[Nc,M],[jc,w],[Vc,w],[Uc,w],[qc,w],[Xc,w],[Jc,w],[Qc,w],[Yc,w],[eu,w],[tu,w],[Lc,w],[Rc,w],[Wc,D],[Gc,w],[Hc,w],[Dc,x],[Sc,w],[Zc,w],[$c,w],[nu,w]];for(const[ao,so]of ru)for(const[e,t]of ao.values())I.set(e,so),z.set(t,e),P.set(e,t);const ou=[["MusicgenForConditionalGeneration",Dl,E],["Phi3VForCausalLM",Wn,A],["CLIPTextModelWithProjection",Zn,w],["SiglipTextModel",Yn,w],["JinaCLIPTextModel",ar,w],["ClapTextModelWithProjection",ll,w],["ClapAudioModelWithProjection",cl,w],["DacEncoderModel",hc,w],["DacDecoderModel",fc,w],["MimiEncoderModel",sc,w],["MimiDecoderModel",lc,w],["SnacEncoderModel",_c,w],["SnacDecoderModel",vc,w]];for(const[ao,so,Kc]of ou)I.set(ao,Kc),z.set(so,ao),P.set(ao,so);const au=new Map([["modnet",Vc],["birefnet",Vc],["isnet",Vc],["ben",Vc]]);for(const[ao,so]of au.entries())so.set(ao,["PreTrainedModel",ne]),I.set(ao,w),z.set(ne,ao),P.set(ao,ne);class iu extends yc{}ao(iu,"MODEL_CLASS_MAPPINGS",ru.map((e=>e[0]))),ao(iu,"BASE_IF_FAIL",!0);class su extends yc{}ao(su,"MODEL_CLASS_MAPPINGS",[Ec]);class lu extends yc{}ao(lu,"MODEL_CLASS_MAPPINGS",[Tc]);class cu extends yc{}ao(cu,"MODEL_CLASS_MAPPINGS",[Ac]);class uu extends yc{}ao(uu,"MODEL_CLASS_MAPPINGS",[Cc]);class du extends yc{}ao(du,"MODEL_CLASS_MAPPINGS",[Dc]);class pu extends yc{}ao(pu,"MODEL_CLASS_MAPPINGS",[Sc]);class hu extends yc{}ao(hu,"MODEL_CLASS_MAPPINGS",[Mc]);class fu extends yc{}ao(fu,"MODEL_CLASS_MAPPINGS",[Ic]);class mu extends yc{}ao(mu,"MODEL_CLASS_MAPPINGS",[Pc]);class gu extends yc{}ao(gu,"MODEL_CLASS_MAPPINGS",[zc]);class _u extends yc{}ao(_u,"MODEL_CLASS_MAPPINGS",[jc]);class vu extends yc{}ao(vu,"MODEL_CLASS_MAPPINGS",[Vc]);class yu extends yc{}ao(yu,"MODEL_CLASS_MAPPINGS",[qc]);class wu extends yc{}ao(wu,"MODEL_CLASS_MAPPINGS",[Uc]);class bu extends yc{}ao(bu,"MODEL_CLASS_MAPPINGS",[Lc]);class xu extends yc{}ao(xu,"MODEL_CLASS_MAPPINGS",[Rc]);class ku extends yc{}ao(ku,"MODEL_CLASS_MAPPINGS",[Wc]);class Cu extends yc{}ao(Cu,"MODEL_CLASS_MAPPINGS",[Gc]);class Du extends yc{}ao(Du,"MODEL_CLASS_MAPPINGS",[Hc]);class Su extends yc{}ao(Su,"MODEL_CLASS_MAPPINGS",[Zc]);class Eu extends yc{}ao(Eu,"MODEL_CLASS_MAPPINGS",[$c]);class Tu extends yc{}ao(Tu,"MODEL_CLASS_MAPPINGS",[Bc]);class Au extends yc{}ao(Au,"MODEL_CLASS_MAPPINGS",[Xc]);class Mu extends yc{}ao(Mu,"MODEL_CLASS_MAPPINGS",[Qc]);class Fu extends yc{}ao(Fu,"MODEL_CLASS_MAPPINGS",[Yc]);class Iu extends yc{}ao(Iu,"MODEL_CLASS_MAPPINGS",[eu]);class Pu extends yc{}ao(Pu,"MODEL_CLASS_MAPPINGS",[tu]);class zu extends yc{}ao(zu,"MODEL_CLASS_MAPPINGS",[nu]);class Ou extends yc{}ao(Ou,"MODEL_CLASS_MAPPINGS",[Oc]);class Nu extends yc{}ao(Nu,"MODEL_CLASS_MAPPINGS",[Nc]);class Bu extends re{constructor(e){let{logits:t,past_key_values:n,encoder_outputs:r,decoder_attentions:o=null,cross_attentions:a=null}=e;super(),this.logits=t,this.past_key_values=n,this.encoder_outputs=r,this.decoder_attentions=o,this.cross_attentions=a}}class ju extends re{constructor(e){let{logits:t}=e,n=Kc(e,QN);super(),this.logits=t;const r=Object.values(n);r.length>0&&(this.attentions=r)}}class Lu extends re{constructor(e){let{logits:t,embeddings:n}=e;super(),this.logits=t,this.embeddings=n}}class Ru extends re{constructor(e){let{logits:t}=e;super(),this.logits=t}}class Vu extends re{constructor(e){let{logits:t}=e;super(),this.logits=t}}class qu extends re{constructor(e){let{start_logits:t,end_logits:n}=e;super(),this.start_logits=t,this.end_logits=n}}class Uu extends re{constructor(e){let{logits:t}=e;super(),this.logits=t}}class Wu extends re{constructor(e){let{logits:t,past_key_values:n}=e;super(),this.logits=t,this.past_key_values=n}}class Gu extends re{constructor(e){let{alphas:t}=e;super(),this.alphas=t}}class Hu extends re{constructor(e){let{waveform:t,spectrogram:n}=e;super(),this.waveform=t,this.spectrogram=n}}},"./src/models/audio_spectrogram_transformer/feature_extraction_audio_spectrogram_transformer.js":(e,t,n)=>{n.r(t),n.d(t,{ASTFeatureExtractor:()=>a});var r=n("./src/base/feature_extraction_utils.js"),o=(n("./src/utils/tensor.js"),n("./src/utils/audio.js"));class a extends r.FeatureExtractor{constructor(e){super(e);const t=this.config.sampling_rate,n=(0,o.mel_filter_bank)(257,this.config.num_mel_bins,20,Math.floor(t/2),t,null,"kaldi",!0);this.mel_filters=n,this.window=(0,o.window_function)(400,"hann",{periodic:!1}),this.mean=this.config.mean,this.std=this.config.std}async _extract_fbank_features(e,t){return(0,o.spectrogram)(e,this.window,400,160,{fft_length:512,power:2,center:!1,preemphasis:.97,mel_filters:this.mel_filters,log_mel:"log",mel_floor:1.192092955078125e-7,remove_dc_offset:!0,max_num_frames:t,transpose:!0})}async _call(e){(0,r.validate_audio_inputs)(e,"ASTFeatureExtractor");const t=await this._extract_fbank_features(e,this.config.max_length);if(this.config.do_normalize){const e=2*this.std,n=t.data;for(let t=0;t<n.length;++t)n[t]=(n[t]-this.mean)/e}return{input_values:t.unsqueeze_(0)}}}},"./src/models/auto/feature_extraction_auto.js":(e,t,n)=>{n.r(t),n.d(t,{AutoFeatureExtractor:()=>i});var r=n("./src/utils/constants.js"),o=n("./src/utils/hub.js"),a=(n("./src/base/feature_extraction_utils.js"),n("./src/models/feature_extractors.js"));class i{static async from_pretrained(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=await(0,o.getModelJSON)(e,r.FEATURE_EXTRACTOR_NAME,!0,t),i=n.feature_extractor_type,s=a[i];if(!s)throw new Error("Unknown feature_extractor_type: '".concat(i,"'. Please report this at ").concat(r.GITHUB_ISSUE_URL,"."));return new s(n)}}},"./src/models/auto/image_processing_auto.js":(e,t,n)=>{n.r(t),n.d(t,{AutoImageProcessor:()=>s});var r=n("./src/utils/constants.js"),o=n("./src/utils/hub.js"),a=n("./src/base/image_processors_utils.js"),i=n("./src/models/image_processors.js");class s{static async from_pretrained(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const s=await(0,o.getModelJSON)(e,r.IMAGE_PROCESSOR_NAME,!0,n),l=null!==(t=s.image_processor_type)&&void 0!==t?t:s.feature_extractor_type;let c=i[l];return c||(void 0!==l&&console.warn("Image processor type '".concat(l,"' not found, assuming base ImageProcessor. Please report this at ").concat(r.GITHUB_ISSUE_URL,".")),c=a.ImageProcessor),new c(s)}}},"./src/models/auto/processing_auto.js":(e,t,n)=>{n.r(t),n.d(t,{AutoProcessor:()=>c});var r=n("./src/utils/constants.js"),o=n("./src/utils/hub.js"),a=n("./src/base/processing_utils.js"),i=n("./src/models/processors.js"),s=n("./src/models/image_processors.js"),l=n("./src/models/feature_extractors.js");class c{static async from_pretrained(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=await(0,o.getModelJSON)(e,r.IMAGE_PROCESSOR_NAME,!0,t),{image_processor_type:c,feature_extractor_type:u,processor_class:d}=n;if(d&&i[d])return i[d].from_pretrained(e,t);if(!c&&!u)throw new Error("No `image_processor_type` or `feature_extractor_type` found in the config.");const p={};if(c){const e=s[c];if(!e)throw new Error("Unknown image_processor_type: '".concat(c,"'."));p.image_processor=new e(n)}if(u){const e=s[u];if(e)p.image_processor=new e(n);else{const e=l[u];if(!e)throw new Error("Unknown feature_extractor_type: '".concat(u,"'."));p.feature_extractor=new e(n)}}return new a.Processor({},p)}}},"./src/models/beit/image_processing_beit.js":(e,t,n)=>{n.r(t),n.d(t,{BeitFeatureExtractor:()=>o});var r=n("./src/base/image_processors_utils.js");class o extends r.ImageProcessor{}},"./src/models/bit/image_processing_bit.js":(e,t,n)=>{n.r(t),n.d(t,{BitImageProcessor:()=>o});var r=n("./src/base/image_processors_utils.js");class o extends r.ImageProcessor{}},"./src/models/chinese_clip/image_processing_chinese_clip.js":(e,t,n)=>{n.r(t),n.d(t,{ChineseCLIPFeatureExtractor:()=>o});var r=n("./src/base/image_processors_utils.js");class o extends r.ImageProcessor{}},"./src/models/clap/feature_extraction_clap.js":(e,t,n)=>{n.r(t),n.d(t,{ClapFeatureExtractor:()=>a});var r=n("./src/base/feature_extraction_utils.js"),o=(n("./src/utils/tensor.js"),n("./src/utils/audio.js"));class a extends r.FeatureExtractor{constructor(e){super(e),this.mel_filters=(0,o.mel_filter_bank)(this.config.nb_frequency_bins,this.config.feature_size,this.config.frequency_min,this.config.frequency_max,this.config.sampling_rate,null,"htk"),this.mel_filters_slaney=(0,o.mel_filter_bank)(this.config.nb_frequency_bins,this.config.feature_size,this.config.frequency_min,this.config.frequency_max,this.config.sampling_rate,"slaney","slaney"),this.window=(0,o.window_function)(this.config.fft_window_size,"hann")}async _get_input_mel(e,t,n,r){let o,a=!1;const i=e.length-t;if(i>0){if("rand_trunc"!==n)throw new Error('Truncation strategy "'.concat(n,'" not implemented'));{a=!0;const n=Math.floor(Math.random()*(i+1));e=e.subarray(n,n+t),o=await this._extract_fbank_features(e,this.mel_filters_slaney,this.config.nb_max_samples)}}else{if(i<0){let n=new Float64Array(t);if(n.set(e),"repeat"===r)for(let r=e.length;r<t;r+=e.length)n.set(e.subarray(0,Math.min(e.length,t-r)),r);else if("repeatpad"===r)for(let t=e.length;t<-i;t+=e.length)n.set(e,t);e=n}if("fusion"===n)throw new Error('Truncation strategy "'.concat(n,'" not implemented'));o=await this._extract_fbank_features(e,this.mel_filters_slaney,this.config.nb_max_samples)}return o.unsqueeze_(0)}async _extract_fbank_features(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return(0,o.spectrogram)(e,this.window,this.config.fft_window_size,this.config.hop_length,{power:2,mel_filters:t,log_mel:"dB",max_num_frames:n,do_pad:!1,transpose:!0})}async _call(e){let{max_length:t=null}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,r.validate_audio_inputs)(e,"ClapFeatureExtractor");return{input_features:(await this._get_input_mel(e,null!==t&&void 0!==t?t:this.config.nb_max_samples,this.config.truncation,this.config.padding)).unsqueeze_(0)}}}},"./src/models/clip/image_processing_clip.js":(e,t,n)=>{n.r(t),n.d(t,{CLIPFeatureExtractor:()=>a,CLIPImageProcessor:()=>o});var r=n("./src/base/image_processors_utils.js");class o extends r.ImageProcessor{}class a extends o{}},"./src/models/convnext/image_processing_convnext.js":(e,t,n)=>{n.r(t),n.d(t,{ConvNextFeatureExtractor:()=>a,ConvNextImageProcessor:()=>o});var r=n("./src/base/image_processors_utils.js");class o extends r.ImageProcessor{constructor(e){var t;super(e),this.crop_pct=null!==(t=this.config.crop_pct)&&void 0!==t?t:.875}async resize(e){var t;const n=null===(t=this.size)||void 0===t?void 0:t.shortest_edge;if(void 0===n)throw new Error("Size dictionary must contain 'shortest_edge' key.");if(n<384){const t=Math.floor(n/this.crop_pct),[r,o]=this.get_resize_output_image_size(e,{shortest_edge:t});e=await e.resize(r,o,{resample:this.resample}),e=await e.center_crop(n,n)}else e=await e.resize(n,n,{resample:this.resample});return e}}class a extends o{}},"./src/models/dac/feature_extraction_dac.js":(e,t,n)=>{n.r(t),n.d(t,{DacFeatureExtractor:()=>o});var r=n("./src/models/encodec/feature_extraction_encodec.js");class o extends r.EncodecFeatureExtractor{}},"./src/models/deit/image_processing_deit.js":(e,t,n)=>{n.r(t),n.d(t,{DeiTFeatureExtractor:()=>a,DeiTImageProcessor:()=>o});var r=n("./src/base/image_processors_utils.js");class o extends r.ImageProcessor{}class a extends o{}},"./src/models/detr/image_processing_detr.js":(e,t,n)=>{n.r(t),n.d(t,{DetrFeatureExtractor:()=>i,DetrImageProcessor:()=>a});var r=n("./src/base/image_processors_utils.js"),o=n("./src/utils/tensor.js");class a extends r.ImageProcessor{async _call(e){const t=await super._call(e),n=[t.pixel_values.dims[0],64,64],r=(0,o.full)(n,1n);return so(so({},t),{},{pixel_mask:r})}post_process_object_detection(){return(0,r.post_process_object_detection)(...arguments)}post_process_panoptic_segmentation(){return(0,r.post_process_panoptic_segmentation)(...arguments)}post_process_instance_segmentation(){return(0,r.post_process_instance_segmentation)(...arguments)}}class i extends a{}},"./src/models/donut/image_processing_donut.js":(e,t,n)=>{n.r(t),n.d(t,{DonutFeatureExtractor:()=>a,DonutImageProcessor:()=>o});var r=n("./src/base/image_processors_utils.js");class o extends r.ImageProcessor{pad_image(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const[o,a,i]=t;let s=this.image_mean;Array.isArray(this.image_mean)||(s=new Array(i).fill(s));let l=this.image_std;Array.isArray(l)||(l=new Array(i).fill(s));const c=s.map(((e,t)=>-e/l[t]));return super.pad_image(e,t,n,so({center:!0,constant_values:c},r))}}class a extends o{}},"./src/models/dpt/image_processing_dpt.js":(e,t,n)=>{n.r(t),n.d(t,{DPTFeatureExtractor:()=>a,DPTImageProcessor:()=>o});var r=n("./src/base/image_processors_utils.js");class o extends r.ImageProcessor{}class a extends o{}},"./src/models/efficientnet/image_processing_efficientnet.js":(e,t,n)=>{n.r(t),n.d(t,{EfficientNetImageProcessor:()=>o});var r=n("./src/base/image_processors_utils.js");class o extends r.ImageProcessor{constructor(e){var t;super(e),this.include_top=null===(t=this.config.include_top)||void 0===t||t,this.include_top&&(this.image_std=this.image_std.map((e=>e*e)))}}},"./src/models/encodec/feature_extraction_encodec.js":(e,t,n)=>{n.r(t),n.d(t,{EncodecFeatureExtractor:()=>a});var r=n("./src/base/feature_extraction_utils.js"),o=n("./src/utils/tensor.js");class a extends r.FeatureExtractor{async _call(e){(0,r.validate_audio_inputs)(e,"EncodecFeatureExtractor"),e instanceof Float64Array&&(e=new Float32Array(e));const t=this.config.feature_size;if(e.length%t!==0)throw new Error("The length of the audio data must be a multiple of the number of channels (".concat(t,")."));const n=[1,t,e.length/t];return{input_values:new o.Tensor("float32",e,n)}}}},"./src/models/feature_extractors.js":(e,t,n)=>{n.r(t),n.d(t,{ASTFeatureExtractor:()=>r.ASTFeatureExtractor,ClapFeatureExtractor:()=>a.ClapFeatureExtractor,DacFeatureExtractor:()=>i.DacFeatureExtractor,EncodecFeatureExtractor:()=>o.EncodecFeatureExtractor,ImageFeatureExtractor:()=>m.ImageProcessor,MoonshineFeatureExtractor:()=>s.MoonshineFeatureExtractor,PyAnnoteFeatureExtractor:()=>l.PyAnnoteFeatureExtractor,SeamlessM4TFeatureExtractor:()=>c.SeamlessM4TFeatureExtractor,SnacFeatureExtractor:()=>u.SnacFeatureExtractor,SpeechT5FeatureExtractor:()=>d.SpeechT5FeatureExtractor,Wav2Vec2FeatureExtractor:()=>p.Wav2Vec2FeatureExtractor,WeSpeakerFeatureExtractor:()=>h.WeSpeakerFeatureExtractor,WhisperFeatureExtractor:()=>f.WhisperFeatureExtractor});var r=n("./src/models/audio_spectrogram_transformer/feature_extraction_audio_spectrogram_transformer.js"),o=n("./src/models/encodec/feature_extraction_encodec.js"),a=n("./src/models/clap/feature_extraction_clap.js"),i=n("./src/models/dac/feature_extraction_dac.js"),s=n("./src/models/moonshine/feature_extraction_moonshine.js"),l=n("./src/models/pyannote/feature_extraction_pyannote.js"),c=n("./src/models/seamless_m4t/feature_extraction_seamless_m4t.js"),u=n("./src/models/snac/feature_extraction_snac.js"),d=n("./src/models/speecht5/feature_extraction_speecht5.js"),p=n("./src/models/wav2vec2/feature_extraction_wav2vec2.js"),h=n("./src/models/wespeaker/feature_extraction_wespeaker.js"),f=n("./src/models/whisper/feature_extraction_whisper.js"),m=n("./src/base/image_processors_utils.js")},"./src/models/florence2/processing_florence2.js":(e,t,n)=>{n.r(t),n.d(t,{Florence2Processor:()=>i});var r=n("./src/base/processing_utils.js"),o=n("./src/models/auto/image_processing_auto.js"),a=n("./src/tokenizers.js");class i extends r.Processor{constructor(e,t){super(e,t);const{tasks_answer_post_processing_type:n,task_prompts_without_inputs:r,task_prompts_with_input:o}=this.image_processor.config;this.tasks_answer_post_processing_type=new Map(Object.entries(null!==n&&void 0!==n?n:{})),this.task_prompts_without_inputs=new Map(Object.entries(null!==r&&void 0!==r?r:{})),this.task_prompts_with_input=new Map(Object.entries(null!==o&&void 0!==o?o:{})),this.regexes={quad_boxes:/(.+?)<loc_(\d+)><loc_(\d+)><loc_(\d+)><loc_(\d+)><loc_(\d+)><loc_(\d+)><loc_(\d+)><loc_(\d+)>/gm,bboxes:/([^<]+)?<loc_(\d+)><loc_(\d+)><loc_(\d+)><loc_(\d+)>/gm},this.size_per_bin=1e3}construct_prompts(e){"string"===typeof e&&(e=[e]);const t=[];for(const n of e)if(this.task_prompts_without_inputs.has(n))t.push(this.task_prompts_without_inputs.get(n));else{for(const[e,r]of this.task_prompts_with_input)if(n.includes(e)){t.push(r.replaceAll("{input}",n).replaceAll(e,""));break}t.length!==e.length&&t.push(n)}return t}post_process_generation(e,t,n){var r;const o=null!==(r=this.tasks_answer_post_processing_type.get(t))&&void 0!==r?r:"pure_text";let a;switch(e=e.replaceAll("<s>","").replaceAll("</s>",""),o){case"pure_text":a=e;break;case"description_with_bboxes":case"bboxes":case"phrase_grounding":case"ocr":const r="ocr"===o?"quad_boxes":"bboxes",s=e.matchAll(this.regexes[r]),l=[],c=[];for(const[e,t,...o]of s){var i;l.push(t?t.trim():null!==(i=l.at(-1))&&void 0!==i?i:""),c.push(o.map(((e,t)=>(Number(e)+.5)/this.size_per_bin*n[t%2])))}a={labels:l,[r]:c};break;default:throw new Error('Task "'.concat(t,'" (of type "').concat(o,'") not yet implemented.'))}return{[t]:a}}async _call(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!e&&!t)throw new Error("Either text or images must be provided");const r=await this.image_processor(e,n),o=t?this.tokenizer(t,n):{};return so(so({},r),o)}}ao(i,"tokenizer_class",a.AutoTokenizer),ao(i,"image_processor_class",o.AutoImageProcessor)},"./src/models/glpn/image_processing_glpn.js":(e,t,n)=>{n.r(t),n.d(t,{GLPNFeatureExtractor:()=>o});var r=n("./src/base/image_processors_utils.js");class o extends r.ImageProcessor{}},"./src/models/grounding_dino/image_processing_grounding_dino.js":(e,t,n)=>{n.r(t),n.d(t,{GroundingDinoImageProcessor:()=>a});var r=n("./src/base/image_processors_utils.js"),o=n("./src/utils/tensor.js");class a extends r.ImageProcessor{async _call(e){const t=await super._call(e),n=t.pixel_values.dims,r=(0,o.ones)([n[0],n[2],n[3]]);return so(so({},t),{},{pixel_mask:r})}}},"./src/models/grounding_dino/processing_grounding_dino.js":(e,t,n)=>{n.r(t),n.d(t,{GroundingDinoProcessor:()=>l});var r=n("./src/base/processing_utils.js"),o=n("./src/models/auto/image_processing_auto.js"),a=n("./src/tokenizers.js"),i=n("./src/base/image_processors_utils.js");function s(e,t){const n=e.dims.at(-1)-1,r=e.tolist();r.fill(!1,0,1),r.fill(!1,n);const o=t.tolist();return r.map(((e,t)=>e?t:null)).filter((e=>null!==e)).map((e=>o[e]))}class l extends r.Processor{async _call(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=e?await this.image_processor(e,n):{};return so(so({},t?this.tokenizer(t,n):{}),r)}post_process_grounded_object_detection(e,t){let{box_threshold:n=.25,text_threshold:r=.25,target_sizes:o=null}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const{logits:a,pred_boxes:l}=e,c=a.dims[0];if(null!==o&&o.length!==c)throw Error("Make sure that you pass in as many target sizes as the batch dimension of the logits");const u=a.dims.at(1),d=a.sigmoid(),p=d.max(-1).tolist(),h=l.tolist().map((e=>e.map((e=>(0,i.center_to_corners_format)(e))))),f=[];for(let i=0;i<c;++i){const e=null!==o?o[i]:null;null!==e&&(h[i]=h[i].map((t=>t.map(((t,n)=>t*e[(n+1)%2])))));const a=p[i],l=[],c=[],m=[];for(let o=0;o<u;++o){const e=a[o];if(e<=n)continue;const u=h[i][o],p=d[i][o];l.push(e),m.push(u);const f=s(p.gt(r),t[i]);c.push(f)}f.push({scores:l,boxes:m,labels:this.batch_decode(c)})}return f}}ao(l,"tokenizer_class",a.AutoTokenizer),ao(l,"image_processor_class",o.AutoImageProcessor)},"./src/models/idefics3/image_processing_idefics3.js":(e,t,n)=>{n.r(t),n.d(t,{Idefics3ImageProcessor:()=>a});var r=n("./src/base/image_processors_utils.js"),o=n("./src/utils/tensor.js");class a extends r.ImageProcessor{constructor(e){var t;super(e),this.do_image_splitting=null===(t=e.do_image_splitting)||void 0===t||t,this.max_image_size=e.max_image_size}get_resize_for_vision_encoder(e,t){let[n,r]=e.dims.slice(-2);const o=r/n;return r>=n?(r=Math.ceil(r/t)*t,n=Math.floor(r/o),n=Math.ceil(n/t)*t):(n=Math.ceil(n/t)*t,r=Math.floor(n*o),r=Math.ceil(r/t)*t),{height:n,width:r}}async _call(e){let t,{do_image_splitting:n=null,return_row_col_info:r=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(Array.isArray(e)){if(0===e.length||!e[0])throw new Error("No images provided.");t=Array.isArray(e[0])?e:[e]}else t=[[e]];let a=[],i=[],s=[];const l=[],c=[];for(const _ of t){let e=await Promise.all(_.map((e=>this.preprocess(e))));l.push(...e.map((e=>e.original_size))),c.push(...e.map((e=>e.reshaped_input_size))),e.forEach((e=>e.pixel_values.unsqueeze_(0)));const{longest_edge:t}=this.max_image_size;let r;if(null!==n&&void 0!==n?n:this.do_image_splitting){let n=new Array(e.length),a=new Array(e.length);r=await Promise.all(e.map((async(e,r)=>{const i=this.get_resize_for_vision_encoder(e.pixel_values,t),s=await(0,o.interpolate_4d)(e.pixel_values,{size:[i.height,i.width]}),{frames:l,num_splits_h:c,num_splits_w:u}=await this.split_image(s,this.max_image_size);return n[r]=c,a[r]=u,(0,o.cat)(l,0)}))),i.push(n),s.push(a)}else{const n=[t,t];r=await Promise.all(e.map((e=>(0,o.interpolate_4d)(e.pixel_values,{size:n})))),i.push(new Array(e.length).fill(0)),s.push(new Array(e.length).fill(0))}a.push((0,o.cat)(r,0))}const u=a.length,[d,p,h,f]=a[0].dims;let m,g;if(1===u)m=a[0].unsqueeze_(0),g=(0,o.full)([u,d,h,f],!0);else{const e=Math.max(...a.map((e=>e.dims.at(0))));g=(0,o.full)([u,e,h,f],!0);const t=g.data,n=e*h*f;for(let r=0;r<u;++r){const i=a[r].dims[0];if(i<e){a[r]=(0,o.cat)([a[r],(0,o.full)([e-i,p,h,f],0)],0);const s=r*n+i*h*f,l=(r+1)*n;t.fill(!1,s,l)}}m=(0,o.stack)(a,0)}return so({pixel_values:m,pixel_attention_mask:g,original_sizes:l,reshaped_input_sizes:c},r?{rows:i,cols:s}:{})}async split_image(e,t){let{longest_edge:n}=t;const r=n,a=n,i=[],[s,l]=e.dims.slice(-2);let c=0,u=0;if(s>r||l>a){c=Math.ceil(s/r),u=Math.ceil(l/a);const t=Math.ceil(s/c),n=Math.ceil(l/u);for(let r=0;r<c;++r)for(let a=0;a<u;++a){let d,p,h,f;r===c-1?(p=s-t,f=s):(p=r*t,f=(r+1)*t),a===u-1?(d=l-n,h=l):(d=a*n,h=(a+1)*n);const m=[p,d],g=[f,h],_=await(0,o.slice)(e,m,g,[2,3]);i.push(_)}const d=r,p=a;s===d&&l===p||(e=await(0,o.interpolate_4d)(e,{size:[d,p]}))}return i.push(e),{frames:i,num_splits_h:c,num_splits_w:u}}}},"./src/models/idefics3/processing_idefics3.js":(e,t,n)=>{n.r(t),n.d(t,{Idefics3Processor:()=>l});var r=n("./src/base/processing_utils.js"),o=n("./src/models/auto/image_processing_auto.js"),a=n("./src/tokenizers.js"),i=(n("./src/utils/image.js"),n("./src/utils/core.js"));function s(e,t,n,r,o,a){return 0===e&&0===t?function(e,t,n,r){return"".concat(t)+"".concat(r)+n.repeat(e)+"".concat(t)}(n,r,o,a):function(e,t,n,r,o,a){let i="";for(let s=0;s<t;++s){for(let t=0;t<n;++t)i+=r+"<row_".concat(s+1,"_col_").concat(t+1,">")+o.repeat(e);i+="\n"}return i+="\n".concat(r)+"".concat(a)+o.repeat(e)+"".concat(r),i}(n,e,t,r,o,a)}class l extends r.Processor{constructor(){super(...arguments),ao(this,"fake_image_token","<fake_token_around_image>"),ao(this,"image_token","<image>"),ao(this,"global_img_token","<global-img>")}async _call(e){var t,n,r;let o,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};null!==(t=l.return_row_col_info)&&void 0!==t||(l.return_row_col_info=!0),a&&(o=await this.image_processor(a,l)),Array.isArray(e)||(e=[e]);const c=null!==(n=o.rows)&&void 0!==n?n:[new Array(e.length).fill(0)],u=null!==(r=o.cols)&&void 0!==r?r:[new Array(e.length).fill(0)],d=this.config.image_seq_len,p=[],h=[];for(let f=0;f<e.length;++f){const t=e[f],n=c[f],r=u[f];p.push((0,i.count)(t,this.image_token));const o=n.map(((e,t)=>s(e,r[t],d,this.fake_image_token,this.image_token,this.global_img_token))),a=t.split(this.image_token);if(0===a.length)throw new Error("The image token should be present in the text.");let l=a[0];for(let e=0;e<o.length;++e)l+=o[e]+a[e+1];h.push(l)}return so(so({},this.tokenizer(h)),o)}}ao(l,"image_processor_class",o.AutoImageProcessor),ao(l,"tokenizer_class",a.AutoTokenizer),ao(l,"uses_processor_config",!0)},"./src/models/image_processors.js":(e,t,n)=>{n.r(t),n.d(t,{BeitFeatureExtractor:()=>r.BeitFeatureExtractor,BitImageProcessor:()=>o.BitImageProcessor,CLIPFeatureExtractor:()=>i.CLIPFeatureExtractor,CLIPImageProcessor:()=>i.CLIPImageProcessor,ChineseCLIPFeatureExtractor:()=>a.ChineseCLIPFeatureExtractor,ConvNextFeatureExtractor:()=>s.ConvNextFeatureExtractor,ConvNextImageProcessor:()=>s.ConvNextImageProcessor,DPTFeatureExtractor:()=>d.DPTFeatureExtractor,DPTImageProcessor:()=>d.DPTImageProcessor,DeiTFeatureExtractor:()=>l.DeiTFeatureExtractor,DeiTImageProcessor:()=>l.DeiTImageProcessor,DetrFeatureExtractor:()=>c.DetrFeatureExtractor,DetrImageProcessor:()=>c.DetrImageProcessor,DonutFeatureExtractor:()=>u.DonutFeatureExtractor,DonutImageProcessor:()=>u.DonutImageProcessor,EfficientNetImageProcessor:()=>p.EfficientNetImageProcessor,GLPNFeatureExtractor:()=>h.GLPNFeatureExtractor,GroundingDinoImageProcessor:()=>f.GroundingDinoImageProcessor,Idefics3ImageProcessor:()=>m.Idefics3ImageProcessor,JinaCLIPImageProcessor:()=>_.JinaCLIPImageProcessor,LlavaOnevisionImageProcessor:()=>v.LlavaOnevisionImageProcessor,Mask2FormerImageProcessor:()=>y.Mask2FormerImageProcessor,MaskFormerFeatureExtractor:()=>w.MaskFormerFeatureExtractor,MaskFormerImageProcessor:()=>w.MaskFormerImageProcessor,MobileNetV1FeatureExtractor:()=>b.MobileNetV1FeatureExtractor,MobileNetV1ImageProcessor:()=>b.MobileNetV1ImageProcessor,MobileNetV2FeatureExtractor:()=>x.MobileNetV2FeatureExtractor,MobileNetV2ImageProcessor:()=>x.MobileNetV2ImageProcessor,MobileNetV3FeatureExtractor:()=>k.MobileNetV3FeatureExtractor,MobileNetV3ImageProcessor:()=>k.MobileNetV3ImageProcessor,MobileNetV4FeatureExtractor:()=>C.MobileNetV4FeatureExtractor,MobileNetV4ImageProcessor:()=>C.MobileNetV4ImageProcessor,MobileViTFeatureExtractor:()=>D.MobileViTFeatureExtractor,MobileViTImageProcessor:()=>D.MobileViTImageProcessor,NougatImageProcessor:()=>S.NougatImageProcessor,OwlViTFeatureExtractor:()=>T.OwlViTFeatureExtractor,OwlViTImageProcessor:()=>T.OwlViTImageProcessor,Owlv2ImageProcessor:()=>E.Owlv2ImageProcessor,Phi3VImageProcessor:()=>A.Phi3VImageProcessor,PvtImageProcessor:()=>M.PvtImageProcessor,Qwen2VLImageProcessor:()=>F.Qwen2VLImageProcessor,RTDetrImageProcessor:()=>I.RTDetrImageProcessor,SamImageProcessor:()=>P.SamImageProcessor,SegformerFeatureExtractor:()=>z.SegformerFeatureExtractor,SegformerImageProcessor:()=>z.SegformerImageProcessor,SiglipImageProcessor:()=>O.SiglipImageProcessor,SmolVLMImageProcessor:()=>N.SmolVLMImageProcessor,Swin2SRImageProcessor:()=>B.Swin2SRImageProcessor,VLMImageProcessor:()=>g.VLMImageProcessor,ViTFeatureExtractor:()=>j.ViTFeatureExtractor,ViTImageProcessor:()=>j.ViTImageProcessor,VitMatteImageProcessor:()=>L.VitMatteImageProcessor,VitPoseImageProcessor:()=>R.VitPoseImageProcessor,YolosFeatureExtractor:()=>V.YolosFeatureExtractor,YolosImageProcessor:()=>V.YolosImageProcessor});var r=n("./src/models/beit/image_processing_beit.js"),o=n("./src/models/bit/image_processing_bit.js"),a=n("./src/models/chinese_clip/image_processing_chinese_clip.js"),i=n("./src/models/clip/image_processing_clip.js"),s=n("./src/models/convnext/image_processing_convnext.js"),l=n("./src/models/deit/image_processing_deit.js"),c=n("./src/models/detr/image_processing_detr.js"),u=n("./src/models/donut/image_processing_donut.js"),d=n("./src/models/dpt/image_processing_dpt.js"),p=n("./src/models/efficientnet/image_processing_efficientnet.js"),h=n("./src/models/glpn/image_processing_glpn.js"),f=n("./src/models/grounding_dino/image_processing_grounding_dino.js"),m=n("./src/models/idefics3/image_processing_idefics3.js"),g=n("./src/models/janus/image_processing_janus.js"),_=n("./src/models/jina_clip/image_processing_jina_clip.js"),v=n("./src/models/llava_onevision/image_processing_llava_onevision.js"),y=n("./src/models/mask2former/image_processing_mask2former.js"),w=n("./src/models/maskformer/image_processing_maskformer.js"),b=n("./src/models/mobilenet_v1/image_processing_mobilenet_v1.js"),x=n("./src/models/mobilenet_v2/image_processing_mobilenet_v2.js"),k=n("./src/models/mobilenet_v3/image_processing_mobilenet_v3.js"),C=n("./src/models/mobilenet_v4/image_processing_mobilenet_v4.js"),D=n("./src/models/mobilevit/image_processing_mobilevit.js"),S=n("./src/models/nougat/image_processing_nougat.js"),E=n("./src/models/owlv2/image_processing_owlv2.js"),T=n("./src/models/owlvit/image_processing_owlvit.js"),A=n("./src/models/phi3_v/image_processing_phi3_v.js"),M=n("./src/models/pvt/image_processing_pvt.js"),F=n("./src/models/qwen2_vl/image_processing_qwen2_vl.js"),I=n("./src/models/rt_detr/image_processing_rt_detr.js"),P=n("./src/models/sam/image_processing_sam.js"),z=n("./src/models/segformer/image_processing_segformer.js"),O=n("./src/models/siglip/image_processing_siglip.js"),N=n("./src/models/smolvlm/image_processing_smolvlm.js"),B=n("./src/models/swin2sr/image_processing_swin2sr.js"),j=n("./src/models/vit/image_processing_vit.js"),L=n("./src/models/vitmatte/image_processing_vitmatte.js"),R=n("./src/models/vitpose/image_processing_vitpose.js"),V=n("./src/models/yolos/image_processing_yolos.js")},"./src/models/janus/image_processing_janus.js":(e,t,n)=>{n.r(t),n.d(t,{VLMImageProcessor:()=>o});var r=n("./src/base/image_processors_utils.js");class o extends r.ImageProcessor{constructor(e){super(so({do_pad:!0,pad_size:{width:e.image_size,height:e.image_size}},e)),this.constant_values=this.config.background_color.map((e=>e*this.rescale_factor))}pad_image(e,t,n,r){return super.pad_image(e,t,n,so({constant_values:this.constant_values,center:!0},r))}}},"./src/models/janus/processing_janus.js":(e,t,n)=>{n.r(t),n.d(t,{VLChatProcessor:()=>c});var r=n("./src/base/processing_utils.js"),o=n("./src/models/auto/image_processing_auto.js"),a=n("./src/tokenizers.js"),i=n("./src/utils/core.js"),s=n("./src/utils/tensor.js"),l=n("./src/utils/image.js");class c extends r.Processor{constructor(e,t){super(e,t),this.image_tag=this.config.image_tag,this.image_start_tag=this.config.image_start_tag,this.image_end_tag=this.config.image_end_tag,this.num_image_tokens=this.config.num_image_tokens}async _call(e){let{images:t=null,chat_template:n="default"}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t?Array.isArray(t)||(t=[t]):t=await Promise.all(e.filter((e=>e.images)).flatMap((e=>e.images)).map((e=>l.RawImage.read(e))));const r=this.tokenizer,o=e=>r.encode(e,{add_special_tokens:!1}),a=r.apply_chat_template(e,{tokenize:!1,add_generation_prompt:!0,chat_template:n}).split(this.image_tag),c=a.length-1;if(t.length!==c)throw new Error("Number of images provided (".concat(t.length,') does not match number of "').concat(this.image_tag,'" image tags (').concat(c,")"));const[u,d,p]=r.model.convert_tokens_to_ids([this.image_tag,this.image_start_tag,this.image_end_tag]);let h=o(a[0]),f=new Array(h.length).fill(!1);for(let s=1;s<a.length;++s){const e=new Array(this.num_image_tokens).fill(u),t=o(a[s]);h=(0,i.mergeArrays)(h,[d],e,[p],t);const n=new Array(this.num_image_tokens).fill(!0);f=(0,i.mergeArrays)(f,[!1],n,[!1],new Array(t.length).fill(!1))}const m=[1,h.length],g={input_ids:new s.Tensor("int64",h,m),attention_mask:new s.Tensor("int64",new Array(h.length).fill(1),m),images_seq_mask:new s.Tensor("bool",f,m),images_emb_mask:new s.Tensor("bool",new Array(c*this.num_image_tokens).fill(!0),[1,c,this.num_image_tokens])};if(t&&t.length>0){const e=await this.image_processor(t);return e.pixel_values.unsqueeze_(0),so(so({},g),e)}return g}}ao(c,"image_processor_class",o.AutoImageProcessor),ao(c,"tokenizer_class",a.AutoTokenizer),ao(c,"uses_processor_config",!0)},"./src/models/jina_clip/image_processing_jina_clip.js":(e,t,n)=>{n.r(t),n.d(t,{JinaCLIPImageProcessor:()=>o});var r=n("./src/base/image_processors_utils.js");class o extends r.ImageProcessor{constructor(e){const{resize_mode:t,fill_color:n,interpolation:r,size:o}=e,a="squash"===t?{width:o,height:o}:"shortest"===t?{shortest_edge:o}:{longest_edge:o},i="bicubic"===r?3:2;super(so(so({},Kc(e,YN)),{},{size:a,resample:i,do_center_crop:!0,crop_size:o,do_normalize:!0}))}}},"./src/models/jina_clip/processing_jina_clip.js":(e,t,n)=>{n.r(t),n.d(t,{JinaCLIPProcessor:()=>i});var r=n("./src/base/processing_utils.js"),o=n("./src/models/auto/image_processing_auto.js"),a=n("./src/tokenizers.js");class i extends r.Processor{async _call(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!e&&!t)throw new Error("Either text or images must be provided");const r=e?this.tokenizer(e,n):{},o=t?await this.image_processor(t,n):{};return so(so({},r),o)}}ao(i,"tokenizer_class",a.AutoTokenizer),ao(i,"image_processor_class",o.AutoImageProcessor)},"./src/models/llava_onevision/image_processing_llava_onevision.js":(e,t,n)=>{n.r(t),n.d(t,{LlavaOnevisionImageProcessor:()=>o});var r=n("./src/base/image_processors_utils.js");class o extends r.ImageProcessor{}},"./src/models/mask2former/image_processing_mask2former.js":(e,t,n)=>{n.r(t),n.d(t,{Mask2FormerImageProcessor:()=>o});var r=n("./src/models/maskformer/image_processing_maskformer.js");class o extends r.MaskFormerImageProcessor{}},"./src/models/maskformer/image_processing_maskformer.js":(e,t,n)=>{n.r(t),n.d(t,{MaskFormerFeatureExtractor:()=>a,MaskFormerImageProcessor:()=>o});var r=n("./src/base/image_processors_utils.js");class o extends r.ImageProcessor{post_process_panoptic_segmentation(){return(0,r.post_process_panoptic_segmentation)(...arguments)}post_process_instance_segmentation(){return(0,r.post_process_instance_segmentation)(...arguments)}}class a extends o{}},"./src/models/mgp_str/processing_mgp_str.js":(e,t,n)=>{n.r(t),n.d(t,{MgpstrProcessor:()=>l});var r=n("./src/base/processing_utils.js"),o=n("./src/models/auto/image_processing_auto.js"),a=n("./src/tokenizers.js"),i=n("./src/utils/maths.js");const s={char:["char_decode",1],bpe:["bpe_decode",2],wp:["wp_decode",102]};class l extends r.Processor{get char_tokenizer(){return this.components.char_tokenizer}get bpe_tokenizer(){return this.components.bpe_tokenizer}get wp_tokenizer(){return this.components.wp_tokenizer}_decode_helper(e,t){if(!s.hasOwnProperty(t))throw new Error("Format ".concat(t," is not supported."));const[n,r]=s[t],o=this[n].bind(this),[a,l]=e.dims,c=[],u=[],d=e.tolist();for(let s=0;s<a;++s){const e=d[s],t=[],n=[];for(let a=1;a<l;++a){const[o,s]=(0,i.max)((0,i.softmax)(e[a]));if(n.push(o),s==r)break;t.push(s)}const o=n.length>0?n.reduce(((e,t)=>e*t),1):0;u.push(t),c.push(o)}return[o(u),c]}char_decode(e){return this.char_tokenizer.batch_decode(e).map((e=>e.replaceAll(" ","")))}bpe_decode(e){return this.bpe_tokenizer.batch_decode(e)}wp_decode(e){return this.wp_tokenizer.batch_decode(e).map((e=>e.replaceAll(" ","")))}batch_decode(e){let[t,n,r]=e;const[o,a]=this._decode_helper(t,"char"),[s,l]=this._decode_helper(n,"bpe"),[c,u]=this._decode_helper(r,"wp"),d=[],p=[];for(let h=0;h<o.length;++h){const[e,t]=(0,i.max)([a[h],l[h],u[h]]);d.push([o[h],s[h],c[h]][t]),p.push(e)}return{generated_text:d,scores:p,char_preds:o,bpe_preds:s,wp_preds:c}}static async from_pretrained(){const e=await super.from_pretrained(...arguments),t=await a.AutoTokenizer.from_pretrained("Xenova/gpt2"),n=await a.AutoTokenizer.from_pretrained("Xenova/bert-base-uncased");return e.components={image_processor:e.image_processor,char_tokenizer:e.tokenizer,bpe_tokenizer:t,wp_tokenizer:n},e}async _call(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const n=await this.image_processor(e);return t&&(n.labels=this.tokenizer(t).input_ids),n}}ao(l,"tokenizer_class",a.AutoTokenizer),ao(l,"image_processor_class",o.AutoImageProcessor)},"./src/models/mobilenet_v1/image_processing_mobilenet_v1.js":(e,t,n)=>{n.r(t),n.d(t,{MobileNetV1FeatureExtractor:()=>a,MobileNetV1ImageProcessor:()=>o});var r=n("./src/base/image_processors_utils.js");class o extends r.ImageProcessor{}class a extends o{}},"./src/models/mobilenet_v2/image_processing_mobilenet_v2.js":(e,t,n)=>{n.r(t),n.d(t,{MobileNetV2FeatureExtractor:()=>a,MobileNetV2ImageProcessor:()=>o});var r=n("./src/base/image_processors_utils.js");class o extends r.ImageProcessor{}class a extends o{}},"./src/models/mobilenet_v3/image_processing_mobilenet_v3.js":(e,t,n)=>{n.r(t),n.d(t,{MobileNetV3FeatureExtractor:()=>a,MobileNetV3ImageProcessor:()=>o});var r=n("./src/base/image_processors_utils.js");class o extends r.ImageProcessor{}class a extends o{}},"./src/models/mobilenet_v4/image_processing_mobilenet_v4.js":(e,t,n)=>{n.r(t),n.d(t,{MobileNetV4FeatureExtractor:()=>a,MobileNetV4ImageProcessor:()=>o});var r=n("./src/base/image_processors_utils.js");class o extends r.ImageProcessor{}class a extends o{}},"./src/models/mobilevit/image_processing_mobilevit.js":(e,t,n)=>{n.r(t),n.d(t,{MobileViTFeatureExtractor:()=>a,MobileViTImageProcessor:()=>o});var r=n("./src/base/image_processors_utils.js");class o extends r.ImageProcessor{}class a extends o{}},"./src/models/moonshine/feature_extraction_moonshine.js":(e,t,n)=>{n.r(t),n.d(t,{MoonshineFeatureExtractor:()=>a});var r=n("./src/base/feature_extraction_utils.js"),o=n("./src/utils/tensor.js");class a extends r.FeatureExtractor{async _call(e){(0,r.validate_audio_inputs)(e,"MoonshineFeatureExtractor"),e instanceof Float64Array&&(e=new Float32Array(e));const t=[1,e.length];return{input_values:new o.Tensor("float32",e,t)}}}},"./src/models/moonshine/processing_moonshine.js":(e,t,n)=>{n.r(t),n.d(t,{MoonshineProcessor:()=>i});var r=n("./src/models/auto/feature_extraction_auto.js"),o=n("./src/tokenizers.js"),a=n("./src/base/processing_utils.js");class i extends a.Processor{async _call(e){return await this.feature_extractor(e)}}ao(i,"tokenizer_class",o.AutoTokenizer),ao(i,"feature_extractor_class",r.AutoFeatureExtractor)},"./src/models/nougat/image_processing_nougat.js":(e,t,n)=>{n.r(t),n.d(t,{NougatImageProcessor:()=>o});var r=n("./src/models/donut/image_processing_donut.js");class o extends r.DonutImageProcessor{}},"./src/models/owlv2/image_processing_owlv2.js":(e,t,n)=>{n.r(t),n.d(t,{Owlv2ImageProcessor:()=>o});var r=n("./src/models/owlvit/image_processing_owlvit.js");class o extends r.OwlViTImageProcessor{}},"./src/models/owlvit/image_processing_owlvit.js":(e,t,n)=>{n.r(t),n.d(t,{OwlViTFeatureExtractor:()=>a,OwlViTImageProcessor:()=>o});var r=n("./src/base/image_processors_utils.js");class o extends r.ImageProcessor{post_process_object_detection(){return(0,r.post_process_object_detection)(...arguments)}}class a extends o{}},"./src/models/owlvit/processing_owlvit.js":(e,t,n)=>{n.r(t),n.d(t,{OwlViTProcessor:()=>i});var r=n("./src/base/processing_utils.js"),o=n("./src/models/auto/image_processing_auto.js"),a=n("./src/tokenizers.js");class i extends r.Processor{}ao(i,"tokenizer_class",a.AutoTokenizer),ao(i,"image_processor_class",o.AutoImageProcessor)},"./src/models/paligemma/processing_paligemma.js":(e,t,n)=>{n.r(t),n.d(t,{PaliGemmaProcessor:()=>s});var r=n("./src/base/processing_utils.js"),o=n("./src/models/auto/image_processing_auto.js"),a=n("./src/tokenizers.js");const i="<image>";class s extends r.Processor{async _call(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};t||(console.warn("You are using PaliGemma without a text prefix. It will perform as a picture-captioning model."),t=""),Array.isArray(e)||(e=[e]),Array.isArray(t)||(t=[t]);const r=this.tokenizer.bos_token,o=this.image_processor.config.image_seq_length;let a;t.some((e=>e.includes(i)))?a=t.map((e=>{const t=e.replaceAll(i,i.repeat(o)),n=t.lastIndexOf(i),a=-1===n?0:n+7;return t.slice(0,a)+r+t.slice(a)+"\n"})):(console.warn("You are passing both `text` and `images` to `PaliGemmaProcessor`. The processor expects special image tokens in the text, as many tokens as there are images per each text. It is recommended to add `<image>` tokens in the very beginning of your text. For this call, we will infer how many images each text has and add special tokens."),a=t.map((t=>function(e,t,n,r,o){return"".concat(r.repeat(n*o)).concat(t).concat(e,"\n")}(t,r,o,i,e.length))));const s=this.tokenizer(a,n);return so(so({},await this.image_processor(e,n)),s)}}ao(s,"tokenizer_class",a.AutoTokenizer),ao(s,"image_processor_class",o.AutoImageProcessor),ao(s,"uses_processor_config",!1)},"./src/models/phi3_v/image_processing_phi3_v.js":(e,t,n)=>{n.r(t),n.d(t,{Phi3VImageProcessor:()=>u});var r=n("./src/base/image_processors_utils.js"),o=n("./src/utils/tensor.js");const a=336,i=[2,3],{ceil:s,floor:l,sqrt:c}=Math;class u extends r.ImageProcessor{constructor(e){super(so(so({},e),{},{do_normalize:!0,do_pad:!0,pad_size:"custom",do_convert_rgb:!0,do_resize:!0})),this._num_crops=e.num_crops}calc_num_image_tokens_from_image_size(e,t){const{num_img_tokens:n}=this.config;return l((l(t/a)*l(e/a)+1)*n+1+(l(t/a)+1)*c(n))}get_resize_output_image_size(e,t){const n=this._num_crops,[r,o]=e.size;let a=r/o,i=1;for(;i*Math.ceil(i/a)<=n;)i+=1;i-=1;const s=Math.floor(336*i);return[s,Math.floor(s/a)]}pad_image(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const[o,i]=t,l=a*s(o/a),c=a*s(i/a),u=[1,1,1].map(((e,t)=>(e-this.image_mean[t])/this.image_std[t]));return super.pad_image(e,t,{width:c,height:l},so({center:!0,constant_values:u},r))}async _call(e){let{num_crops:t=null}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this._num_crops=null!==t&&void 0!==t?t:t=this.config.num_crops,t<4||c(t)%1!==0)throw new Error("num_crops must be a square number >= 4");Array.isArray(e)||(e=[e]);const n=e.length,r=await Promise.all(e.map((e=>this.preprocess(e)))),u=r.map((e=>e.original_size)),d=r.map((e=>e.reshaped_input_size)),p=[];for(const{pixel_values:s}of r){s.unsqueeze_(0);const[e,n]=s.dims.slice(-2),r=await(0,o.interpolate_4d)(s,{size:[a,a],mode:"bicubic"});if(t>0){const u=[],d=c(t),h=l(n/d),f=l(e/d);for(let t=0;t<d;++t)for(let r=0;r<d;++r){let a,l,c,p;t===d-1?(l=e-f,p=e):(l=t*f,p=(t+1)*f),r===d-1?(a=n-h,c=n):(a=r*h,c=(r+1)*h);const m=[l,a],g=[p,c],_=await(0,o.slice)(s,m,g,i);u.push(_)}const m=await(0,o.interpolate_4d)((0,o.cat)(u,0),{size:[a,a],mode:"bicubic"});p.push((0,o.cat)([r,m],0))}else p.push(r)}const h=(0,o.stack)(p,0),f=d.map((e=>e.map((e=>a*s(e/a))))),m=new o.Tensor("int64",f.flat(),[n,2]),g=f.map((e=>{let[t,n]=e;return this.calc_num_image_tokens_from_image_size(n,t)}));return{pixel_values:h,original_sizes:u,reshaped_input_sizes:d,image_sizes:m,num_img_tokens:g}}}},"./src/models/phi3_v/processing_phi3_v.js":(e,t,n)=>{n.r(t),n.d(t,{Phi3VProcessor:()=>l});var r=n("./src/base/processing_utils.js"),o=n("./src/models/auto/image_processing_auto.js"),a=n("./src/tokenizers.js");n("./src/utils/image.js");const i="<|image|>",s=/<\|image_\d+\|>/g;class l extends r.Processor{async _call(e){let t,n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,{padding:o=!0,truncation:a=!0,num_crops:l=null}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(Array.isArray(e)||(e=[e]),r){n=await this.image_processor(r,{num_crops:l});const{num_img_tokens:c}=n,u=e.map(((e,t)=>e.split(s).join(i.repeat(c[t]))));t=this.tokenizer(u,{padding:o,truncation:a});const d=this.tokenizer.model.convert_tokens_to_ids([i])[0];t.input_ids.map_((e=>e==d?-e:e))}else t=this.tokenizer(e);return so(so({},t),n)}}ao(l,"image_processor_class",o.AutoImageProcessor),ao(l,"tokenizer_class",a.AutoTokenizer)},"./src/models/processors.js":(e,t,n)=>{n.r(t),n.d(t,{Florence2Processor:()=>r.Florence2Processor,GroundingDinoProcessor:()=>o.GroundingDinoProcessor,Idefics3Processor:()=>a.Idefics3Processor,JinaCLIPProcessor:()=>s.JinaCLIPProcessor,MgpstrProcessor:()=>l.MgpstrProcessor,MoonshineProcessor:()=>c.MoonshineProcessor,OwlViTProcessor:()=>u.OwlViTProcessor,PaliGemmaProcessor:()=>p.PaliGemmaProcessor,Phi3VProcessor:()=>d.Phi3VProcessor,PyAnnoteProcessor:()=>h.PyAnnoteProcessor,Qwen2VLProcessor:()=>f.Qwen2VLProcessor,SamProcessor:()=>m.SamProcessor,SmolVLMProcessor:()=>g.SmolVLMProcessor,SpeechT5Processor:()=>_.SpeechT5Processor,UltravoxProcessor:()=>v.UltravoxProcessor,VLChatProcessor:()=>i.VLChatProcessor,Wav2Vec2Processor:()=>y.Wav2Vec2Processor,Wav2Vec2ProcessorWithLM:()=>w.Wav2Vec2ProcessorWithLM,WhisperProcessor:()=>b.WhisperProcessor});var r=n("./src/models/florence2/processing_florence2.js"),o=n("./src/models/grounding_dino/processing_grounding_dino.js"),a=n("./src/models/idefics3/processing_idefics3.js"),i=n("./src/models/janus/processing_janus.js"),s=n("./src/models/jina_clip/processing_jina_clip.js"),l=n("./src/models/mgp_str/processing_mgp_str.js"),c=n("./src/models/moonshine/processing_moonshine.js"),u=n("./src/models/owlvit/processing_owlvit.js"),d=n("./src/models/phi3_v/processing_phi3_v.js"),p=n("./src/models/paligemma/processing_paligemma.js"),h=n("./src/models/pyannote/processing_pyannote.js"),f=n("./src/models/qwen2_vl/processing_qwen2_vl.js"),m=n("./src/models/sam/processing_sam.js"),g=n("./src/models/smolvlm/processing_smolvlm.js"),_=n("./src/models/speecht5/processing_speecht5.js"),v=n("./src/models/ultravox/processing_ultravox.js"),y=n("./src/models/wav2vec2/processing_wav2vec2.js"),w=n("./src/models/wav2vec2_with_lm/processing_wav2vec2_with_lm.js"),b=n("./src/models/whisper/processing_whisper.js")},"./src/models/pvt/image_processing_pvt.js":(e,t,n)=>{n.r(t),n.d(t,{PvtImageProcessor:()=>o});var r=n("./src/base/image_processors_utils.js");class o extends r.ImageProcessor{}},"./src/models/pyannote/feature_extraction_pyannote.js":(e,t,n)=>{n.r(t),n.d(t,{PyAnnoteFeatureExtractor:()=>i});var r=n("./src/base/feature_extraction_utils.js"),o=n("./src/utils/tensor.js"),a=n("./src/utils/maths.js");class i extends r.FeatureExtractor{async _call(e){(0,r.validate_audio_inputs)(e,"PyAnnoteFeatureExtractor"),e instanceof Float64Array&&(e=new Float32Array(e));const t=[1,1,e.length];return{input_values:new o.Tensor("float32",e,t)}}samples_to_frames(e){return(e-this.config.offset)/this.config.step}post_process_speaker_diarization(e,t){const n=t/this.samples_to_frames(t)/this.config.sampling_rate,r=[];for(const o of e.tolist()){const e=[];let t=-1;for(let n=0;n<o.length;++n){const r=(0,a.softmax)(o[n]),[i,s]=(0,a.max)(r),[l,c]=[n,n+1];s!==t?(t=s,e.push({id:s,start:l,end:c,score:i})):(e.at(-1).end=c,e.at(-1).score+=i)}r.push(e.map((e=>{let{id:t,start:r,end:o,score:a}=e;return{id:t,start:r*n,end:o*n,confidence:a/(o-r)}})))}return r}}},"./src/models/pyannote/processing_pyannote.js":(e,t,n)=>{n.r(t),n.d(t,{PyAnnoteProcessor:()=>a});var r=n("./src/base/processing_utils.js"),o=n("./src/models/pyannote/feature_extraction_pyannote.js");class a extends r.Processor{async _call(e){return await this.feature_extractor(e)}post_process_speaker_diarization(){return this.feature_extractor.post_process_speaker_diarization(...arguments)}get sampling_rate(){return this.feature_extractor.config.sampling_rate}}ao(a,"feature_extractor_class",o.PyAnnoteFeatureExtractor)},"./src/models/qwen2_vl/image_processing_qwen2_vl.js":(e,t,n)=>{n.r(t),n.d(t,{Qwen2VLImageProcessor:()=>a});var r=n("./src/base/image_processors_utils.js"),o=n("./src/utils/tensor.js");class a extends r.ImageProcessor{async _call(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const{pixel_values:a,original_sizes:i,reshaped_input_sizes:s}=await super._call(e,...n);let l=a;const{temporal_patch_size:c,merge_size:u,patch_size:d}=this.config;1===l.dims[0]&&(l=(0,o.cat)(Array.from({length:c},(()=>l)),0));const p=l.dims[0]/c,h=l.dims[1],f=Math.floor(l.dims[2]/d),m=Math.floor(l.dims[3]/d);return{pixel_values:l.view(p,c,h,Math.floor(f/u),u,d,Math.floor(m/u),u,d).permute(0,3,6,4,7,2,1,5,8).view(p*f*m,h*c*d*d),image_grid_thw:new o.Tensor("int64",[p,f,m],[1,3]),original_sizes:i,reshaped_input_sizes:s}}}},"./src/models/qwen2_vl/processing_qwen2_vl.js":(e,t,n)=>{n.r(t),n.d(t,{Qwen2VLProcessor:()=>i});var r=n("./src/base/processing_utils.js"),o=n("./src/models/auto/image_processing_auto.js"),a=n("./src/tokenizers.js");n("./src/utils/image.js");class i extends r.Processor{async _call(e){let t,n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(Array.isArray(e)||(e=[e]),r&&(t=await this.image_processor(r),n=t.image_grid_thw),n){let t=this.image_processor.config.merge_size**2,r=0;const o=n.tolist();e=e.map((e=>{for(;e.includes("<|image_pad|>");){const n=Number(o[r++].reduce(((e,t)=>e*t),1n));e=e.replace("<|image_pad|>","<|placeholder|>".repeat(Math.floor(n/t)))}return e.replaceAll("<|placeholder|>","<|image_pad|>")}))}return so(so({},this.tokenizer(e)),t)}}ao(i,"image_processor_class",o.AutoImageProcessor),ao(i,"tokenizer_class",a.AutoTokenizer)},"./src/models/rt_detr/image_processing_rt_detr.js":(e,t,n)=>{n.r(t),n.d(t,{RTDetrImageProcessor:()=>o});var r=n("./src/base/image_processors_utils.js");class o extends r.ImageProcessor{post_process_object_detection(){return(0,r.post_process_object_detection)(...arguments)}}},"./src/models/sam/image_processing_sam.js":(e,t,n)=>{n.r(t),n.d(t,{SamImageProcessor:()=>i});var r=n("./src/base/image_processors_utils.js"),o=n("./src/utils/core.js"),a=n("./src/utils/tensor.js");class i extends r.ImageProcessor{reshape_input_points(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];e=structuredClone(e);let i=(0,o.calculateDimensions)(e);if(3===i.length)r||(i=[1,...i]),e=[e];else if(4!==i.length)throw Error("The input_points must be a 4D tensor of shape `batch_size`, `point_batch_size`, `nb_points_per_image`, `2`.");for(let o=0;o<e.length;++o){let r=t[o],a=n[o],i=[a[0]/r[0],a[1]/r[1]];for(let t=0;t<e[o].length;++t)for(let n=0;n<e[o][t].length;++n)for(let r=0;r<e[o][t][n].length;++r)e[o][t][n][r]*=i[r%2]}return new a.Tensor("float32",Float32Array.from(e.flat(1/0)),i)}add_input_labels(e,t){let n=(0,o.calculateDimensions)(e);if(2===n.length)n=[1,...n],e=[e];else if(3!==n.length)throw Error("The input_points must be a 4D tensor of shape `batch_size`, `point_batch_size`, `nb_points_per_image`, `2`.");if(n.some(((e,n)=>e!==t.dims[n])))throw Error("The first ".concat(n.length," dimensions of 'input_points' and 'input_labels' must be the same."));return new a.Tensor("int64",e.flat(1/0).map(BigInt),n)}async _call(e){let{input_points:t=null,input_labels:n=null,input_boxes:r=null}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const o=await super._call(e);if(t&&(o.input_points=this.reshape_input_points(t,o.original_sizes,o.reshaped_input_sizes)),n){if(!o.input_points)throw Error("`input_points` must be provided if `input_labels` are provided.");o.input_labels=this.add_input_labels(n,o.input_points)}return r&&(o.input_boxes=this.reshape_input_points(r,o.original_sizes,o.reshaped_input_sizes,!0)),o}async post_process_masks(e,t,n){let{mask_threshold:r=0,binarize:o=!0,pad_size:i=null}=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const s=[];i=null!==i&&void 0!==i?i:this.pad_size;const l=[i.height,i.width];for(let c=0;c<t.length;++c){const i=t[c],u=n[c];let d=await(0,a.interpolate_4d)(e[c],{mode:"bilinear",size:l});if(d=d.slice(null,null,[0,u[0]],[0,u[1]]),d=await(0,a.interpolate_4d)(d,{mode:"bilinear",size:i}),o){const e=d.data,t=new Uint8Array(e.length);for(let n=0;n<e.length;++n)e[n]>r&&(t[n]=1);d=new a.Tensor("bool",t,d.dims)}s.push(d)}return s}generate_crop_boxes(e,t){let{crop_n_layers:n=0,overlap_ratio:r=512/1500,points_per_crop:o=32,crop_n_points_downscale_factor:a=1}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}}}},"./src/models/sam/processing_sam.js":(e,t,n)=>{n.r(t),n.d(t,{SamProcessor:()=>a});var r=n("./src/base/processing_utils.js"),o=n("./src/models/auto/image_processing_auto.js");class a extends r.Processor{async _call(){return await this.image_processor(...arguments)}post_process_masks(){return this.image_processor.post_process_masks(...arguments)}reshape_input_points(){return this.image_processor.reshape_input_points(...arguments)}}ao(a,"image_processor_class",o.AutoImageProcessor)},"./src/models/seamless_m4t/feature_extraction_seamless_m4t.js":(e,t,n)=>{n.r(t),n.d(t,{SeamlessM4TFeatureExtractor:()=>i});var r=n("./src/base/feature_extraction_utils.js"),o=n("./src/utils/tensor.js"),a=n("./src/utils/audio.js");class i extends r.FeatureExtractor{constructor(e){super(e);const t=this.config.sampling_rate,n=(0,a.mel_filter_bank)(257,this.config.num_mel_bins,20,Math.floor(t/2),t,null,"kaldi",!0);this.mel_filters=n,this.window=(0,a.window_function)(400,"povey",{periodic:!1})}async _extract_fbank_features(e,t){return e=e.map((e=>32768*e)),(0,a.spectrogram)(e,this.window,400,160,{fft_length:512,power:2,center:!1,preemphasis:.97,mel_filters:this.mel_filters,log_mel:"log",mel_floor:1.192092955078125e-7,remove_dc_offset:!0,max_num_frames:t,transpose:!0})}async _call(e){let{padding:t=!0,pad_to_multiple_of:n=2,do_normalize_per_mel_bins:a=!0,return_attention_mask:i=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,r.validate_audio_inputs)(e,"SeamlessM4TFeatureExtractor");let s,l=await this._extract_fbank_features(e,this.config.max_length);if(a){const[e,t]=l.dims,n=l.data;for(let r=0;r<t;++r){let o=0;for(let l=0;l<e;++l)o+=n[l*t+r];const a=o/e;let i=0;for(let l=0;l<e;++l)i+=(n[l*t+r]-a)**2;i/=e-1;const s=Math.sqrt(i+1e-7);for(let l=0;l<e;++l){const e=l*t+r;n[e]=(n[e]-a)/s}}}if(t){const[e,t]=l.dims,r=l.data,a=e%n;if(a>0){const n=new Float32Array(t*(e+a));n.set(r),n.fill(this.config.padding_value,r.length);const c=e+a;l=new o.Tensor(l.type,n,[c,t]),i&&(s=new o.Tensor("int64",new BigInt64Array(c),[1,c]),s.data.fill(1n,0,e))}}const[c,u]=l.dims,d=this.config.stride;if(0!==c%d)throw new Error("The number of frames (".concat(c,") must be a multiple of the stride (").concat(d,")."));const p=l.view(1,Math.floor(c/d),u*d),h={input_features:p};if(i){const e=p.dims[1],t=new BigInt64Array(e);if(s){const e=s.data;for(let n=1,r=0;n<c;n+=d,++r)t[r]=e[n]}else t.fill(1n);h.attention_mask=new o.Tensor("int64",t,[1,e])}return h}}},"./src/models/segformer/image_processing_segformer.js":(e,t,n)=>{n.r(t),n.d(t,{SegformerFeatureExtractor:()=>a,SegformerImageProcessor:()=>o});var r=n("./src/base/image_processors_utils.js");class o extends r.ImageProcessor{post_process_semantic_segmentation(){return(0,r.post_process_semantic_segmentation)(...arguments)}}class a extends o{}},"./src/models/siglip/image_processing_siglip.js":(e,t,n)=>{n.r(t),n.d(t,{SiglipImageProcessor:()=>o});var r=n("./src/base/image_processors_utils.js");class o extends r.ImageProcessor{}},"./src/models/smolvlm/image_processing_smolvlm.js":(e,t,n)=>{n.r(t),n.d(t,{SmolVLMImageProcessor:()=>r.Idefics3ImageProcessor});var r=n("./src/models/idefics3/image_processing_idefics3.js")},"./src/models/smolvlm/processing_smolvlm.js":(e,t,n)=>{n.r(t),n.d(t,{SmolVLMProcessor:()=>r.Idefics3Processor});var r=n("./src/models/idefics3/processing_idefics3.js")},"./src/models/snac/feature_extraction_snac.js":(e,t,n)=>{n.r(t),n.d(t,{SnacFeatureExtractor:()=>o});var r=n("./src/models/dac/feature_extraction_dac.js");class o extends r.DacFeatureExtractor{}},"./src/models/speecht5/feature_extraction_speecht5.js":(e,t,n)=>{n.r(t),n.d(t,{SpeechT5FeatureExtractor:()=>o});var r=n("./src/base/feature_extraction_utils.js");class o extends r.FeatureExtractor{}},"./src/models/speecht5/processing_speecht5.js":(e,t,n)=>{n.r(t),n.d(t,{SpeechT5Processor:()=>i});var r=n("./src/base/processing_utils.js"),o=n("./src/tokenizers.js"),a=n("./src/models/auto/feature_extraction_auto.js");class i extends r.Processor{async _call(e){return await this.feature_extractor(e)}}ao(i,"tokenizer_class",o.AutoTokenizer),ao(i,"feature_extractor_class",a.AutoFeatureExtractor)},"./src/models/swin2sr/image_processing_swin2sr.js":(e,t,n)=>{n.r(t),n.d(t,{Swin2SRImageProcessor:()=>o});var r=n("./src/base/image_processors_utils.js");class o extends r.ImageProcessor{pad_image(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const[o,a,i]=t;return super.pad_image(e,t,{width:a+(n-a%n)%n,height:o+(n-o%n)%n},so({mode:"symmetric",center:!1,constant_values:-1},r))}}},"./src/models/ultravox/processing_ultravox.js":(e,t,n)=>{n.r(t),n.d(t,{UltravoxProcessor:()=>i});var r=n("./src/models/auto/feature_extraction_auto.js"),o=n("./src/tokenizers.js"),a=n("./src/base/processing_utils.js");class i extends a.Processor{async _call(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(Array.isArray(e))throw new Error("Batched inputs are not supported yet.");let r={};if(t){const o=t.length,{input_features:a}=await this.feature_extractor(t,so(so({},n),{},{max_length:o})),i=Math.round(o/this.config.encoder_ds_factor+1e-4),s=1+Math.ceil(i/this.config.stack_factor);r.audio_token_len=[s],r.audio_values=a;const l=this.config.audio_placeholder;if(!e.includes(l))throw new Error("The input text does not contain the image token ".concat(l,"."));e=e.replaceAll(l,l.repeat(s))}const o=this.tokenizer(e,so({add_special_tokens:!1},n));return so(so({},o),r)}}ao(i,"tokenizer_class",o.AutoTokenizer),ao(i,"feature_extractor_class",r.AutoFeatureExtractor),ao(i,"uses_processor_config",!0)},"./src/models/vit/image_processing_vit.js":(e,t,n)=>{n.r(t),n.d(t,{ViTFeatureExtractor:()=>a,ViTImageProcessor:()=>o});var r=n("./src/base/image_processors_utils.js");class o extends r.ImageProcessor{}class a extends o{}},"./src/models/vitmatte/image_processing_vitmatte.js":(e,t,n)=>{n.r(t),n.d(t,{VitMatteImageProcessor:()=>a});var r=n("./src/base/image_processors_utils.js"),o=n("./src/utils/tensor.js");class a extends r.ImageProcessor{async _call(e,t){Array.isArray(e)||(e=[e]),Array.isArray(t)||(t=[t]);const n=await Promise.all(e.map((e=>this.preprocess(e)))),r=await Promise.all(t.map((e=>this.preprocess(e,{do_normalize:!1,do_convert_rgb:!1,do_convert_grayscale:!0})))),a=(0,o.stack)(n.map(((e,t)=>(0,o.cat)([e.pixel_values,r[t].pixel_values],0))),0);return{pixel_values:a,original_sizes:n.map((e=>e.original_size)),reshaped_input_sizes:n.map((e=>e.reshaped_input_size))}}}},"./src/models/vitpose/image_processing_vitpose.js":(e,t,n)=>{n.r(t),n.d(t,{VitPoseImageProcessor:()=>o});var r=n("./src/base/image_processors_utils.js");class o extends r.ImageProcessor{post_process_pose_estimation(e,t){let{threshold:n=null}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=e.tolist(),[o,a,i,s]=e.dims,l=[];for(let c=0;c<o;++c){const e=r[c],o=t[c],a=[];for(let t=0;t<o.length;++t){const r=o[t],l=[],c=[],u=[],d=r.at(-2)/s,p=r.at(-1)/i;for(let t=0;t<e.length;++t){let[r,o]=[0,0],a=0,i=-1/0;const s=e[t];for(let e=0;e<s.length;++e){const t=s[e];for(let n=0;n<t.length;++n){const s=t[n];a+=s,i=Math.max(i,s),r+=(n+.5)*s,o+=e*s}}if(null!=n&&i<n)continue;const h=[d*r/a,p*o/a];l.push(h),u.push(t),c.push(i)}a.push({bbox:r,scores:c,labels:u,keypoints:l})}l.push(a)}return l}}},"./src/models/wav2vec2/feature_extraction_wav2vec2.js":(e,t,n)=>{n.r(t),n.d(t,{Wav2Vec2FeatureExtractor:()=>a});var r=n("./src/base/feature_extraction_utils.js"),o=n("./src/utils/tensor.js");class a extends r.FeatureExtractor{_zero_mean_unit_var_norm(e){const t=e.reduce(((e,t)=>e+t),0),n=t/e.length,r=e.reduce(((e,t)=>e+(t-n)**2),0)/e.length;return e.map((e=>(e-n)/Math.sqrt(r+1e-7)))}async _call(e){(0,r.validate_audio_inputs)(e,"Wav2Vec2FeatureExtractor"),e instanceof Float64Array&&(e=new Float32Array(e));let t=e;this.config.do_normalize&&(t=this._zero_mean_unit_var_norm(t));const n=[1,t.length];return{input_values:new o.Tensor("float32",t,n),attention_mask:new o.Tensor("int64",new BigInt64Array(t.length).fill(1n),n)}}}},"./src/models/wav2vec2/processing_wav2vec2.js":(e,t,n)=>{n.r(t),n.d(t,{Wav2Vec2Processor:()=>i});var r=n("./src/tokenizers.js"),o=n("./src/models/auto/feature_extraction_auto.js"),a=n("./src/base/processing_utils.js");class i extends a.Processor{async _call(e){return await this.feature_extractor(e)}}ao(i,"tokenizer_class",r.AutoTokenizer),ao(i,"feature_extractor_class",o.AutoFeatureExtractor)},"./src/models/wav2vec2_with_lm/processing_wav2vec2_with_lm.js":(e,t,n)=>{n.r(t),n.d(t,{Wav2Vec2ProcessorWithLM:()=>i});var r=n("./src/tokenizers.js"),o=n("./src/models/auto/feature_extraction_auto.js"),a=n("./src/base/processing_utils.js");class i extends a.Processor{async _call(e){return await this.feature_extractor(e)}}ao(i,"tokenizer_class",r.AutoTokenizer),ao(i,"feature_extractor_class",o.AutoFeatureExtractor)},"./src/models/wespeaker/feature_extraction_wespeaker.js":(e,t,n)=>{n.r(t),n.d(t,{WeSpeakerFeatureExtractor:()=>a});var r=n("./src/base/feature_extraction_utils.js"),o=(n("./src/utils/tensor.js"),n("./src/utils/audio.js"));class a extends r.FeatureExtractor{constructor(e){super(e);const t=this.config.sampling_rate,n=(0,o.mel_filter_bank)(257,this.config.num_mel_bins,20,Math.floor(t/2),t,null,"kaldi",!0);this.mel_filters=n,this.window=(0,o.window_function)(400,"hamming",{periodic:!1}),this.min_num_frames=this.config.min_num_frames}async _extract_fbank_features(e){return e=e.map((e=>32768*e)),(0,o.spectrogram)(e,this.window,400,160,{fft_length:512,power:2,center:!1,preemphasis:.97,mel_filters:this.mel_filters,log_mel:"log",mel_floor:1.192092955078125e-7,remove_dc_offset:!0,transpose:!0,min_num_frames:this.min_num_frames})}async _call(e){(0,r.validate_audio_inputs)(e,"WeSpeakerFeatureExtractor");const t=(await this._extract_fbank_features(e)).unsqueeze_(0);if(null===this.config.fbank_centering_span){const e=t.mean(1).data,n=t.data,[r,o,a]=t.dims;for(let t=0;t<r;++t){const r=t*o*a,i=t*a;for(let t=0;t<o;++t){const o=r+t*a;for(let t=0;t<a;++t)n[o+t]-=e[i+t]}}}return{input_features:t}}}},"./src/models/whisper/common_whisper.js":(e,t,n)=>{n.r(t),n.d(t,{WHISPER_LANGUAGE_MAPPING:()=>o,WHISPER_TO_LANGUAGE_CODE_MAPPING:()=>a,whisper_language_to_code:()=>i});const r=[["en","english"],["zh","chinese"],["de","german"],["es","spanish"],["ru","russian"],["ko","korean"],["fr","french"],["ja","japanese"],["pt","portuguese"],["tr","turkish"],["pl","polish"],["ca","catalan"],["nl","dutch"],["ar","arabic"],["sv","swedish"],["it","italian"],["id","indonesian"],["hi","hindi"],["fi","finnish"],["vi","vietnamese"],["he","hebrew"],["uk","ukrainian"],["el","greek"],["ms","malay"],["cs","czech"],["ro","romanian"],["da","danish"],["hu","hungarian"],["ta","tamil"],["no","norwegian"],["th","thai"],["ur","urdu"],["hr","croatian"],["bg","bulgarian"],["lt","lithuanian"],["la","latin"],["mi","maori"],["ml","malayalam"],["cy","welsh"],["sk","slovak"],["te","telugu"],["fa","persian"],["lv","latvian"],["bn","bengali"],["sr","serbian"],["az","azerbaijani"],["sl","slovenian"],["kn","kannada"],["et","estonian"],["mk","macedonian"],["br","breton"],["eu","basque"],["is","icelandic"],["hy","armenian"],["ne","nepali"],["mn","mongolian"],["bs","bosnian"],["kk","kazakh"],["sq","albanian"],["sw","swahili"],["gl","galician"],["mr","marathi"],["pa","punjabi"],["si","sinhala"],["km","khmer"],["sn","shona"],["yo","yoruba"],["so","somali"],["af","afrikaans"],["oc","occitan"],["ka","georgian"],["be","belarusian"],["tg","tajik"],["sd","sindhi"],["gu","gujarati"],["am","amharic"],["yi","yiddish"],["lo","lao"],["uz","uzbek"],["fo","faroese"],["ht","haitian creole"],["ps","pashto"],["tk","turkmen"],["nn","nynorsk"],["mt","maltese"],["sa","sanskrit"],["lb","luxembourgish"],["my","myanmar"],["bo","tibetan"],["tl","tagalog"],["mg","malagasy"],["as","assamese"],["tt","tatar"],["haw","hawaiian"],["ln","lingala"],["ha","hausa"],["ba","bashkir"],["jw","javanese"],["su","sundanese"]],o=new Map(r),a=new Map([...r.map((e=>{let[t,n]=e;return[n,t]})),["burmese","my"],["valencian","ca"],["flemish","nl"],["haitian","ht"],["letzeburgesch","lb"],["pushto","ps"],["panjabi","pa"],["moldavian","ro"],["moldovan","ro"],["sinhalese","si"],["castilian","es"]]);function i(e){e=e.toLowerCase();let t=a.get(e);if(void 0===t){const n=e.match(/^<\|([a-z]{2})\|>$/);if(n&&(e=n[1]),!o.has(e)){const t=2===e.length?o.keys():o.values();throw new Error('Language "'.concat(e,'" is not supported. Must be one of: ').concat(JSON.stringify(Array.from(t))))}t=e}return t}},"./src/models/whisper/feature_extraction_whisper.js":(e,t,n)=>{n.r(t),n.d(t,{WhisperFeatureExtractor:()=>i});var r=n("./src/base/feature_extraction_utils.js"),o=(n("./src/utils/tensor.js"),n("./src/utils/audio.js")),a=n("./src/utils/maths.js");class i extends r.FeatureExtractor{constructor(e){var t,n;super(e),null!==(n=(t=this.config).mel_filters)&&void 0!==n||(t.mel_filters=(0,o.mel_filter_bank)(Math.floor(1+this.config.n_fft/2),this.config.feature_size,0,8e3,this.config.sampling_rate,"slaney","slaney")),this.window=(0,o.window_function)(this.config.n_fft,"hann")}async _extract_fbank_features(e){const t=await(0,o.spectrogram)(e,this.window,this.config.n_fft,this.config.hop_length,{power:2,mel_filters:this.config.mel_filters,log_mel:"log10",max_num_frames:Math.min(Math.floor(e.length/this.config.hop_length),this.config.nb_max_frames)}),n=t.data,r=(0,a.max)(n)[0];for(let o=0;o<n.length;++o)n[o]=(Math.max(n[o],r-8)+4)/4;return t}async _call(e){let t,{max_length:n=null}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,r.validate_audio_inputs)(e,"WhisperFeatureExtractor");const o=null!==n&&void 0!==n?n:this.config.n_samples;e.length>o?(e.length>this.config.n_samples&&console.warn("Attempting to extract features for audio longer than 30 seconds. If using a pipeline to extract transcript from a long audio clip, remember to specify `chunk_length_s` and/or `stride_length_s`."),t=e.slice(0,o)):(t=new Float32Array(o),t.set(e));return{input_features:(await this._extract_fbank_features(t)).unsqueeze_(0)}}}},"./src/models/whisper/generation_whisper.js":(e,t,n)=>{n.r(t),n.d(t,{WhisperGenerationConfig:()=>o});var r=n("./src/generation/configuration_utils.js");class o extends r.GenerationConfig{constructor(){super(...arguments),ao(this,"return_timestamps",null),ao(this,"return_token_timestamps",null),ao(this,"num_frames",null),ao(this,"alignment_heads",null),ao(this,"task",null),ao(this,"language",null),ao(this,"no_timestamps_token_id",null),ao(this,"prompt_ids",null),ao(this,"is_multilingual",null),ao(this,"lang_to_id",null),ao(this,"task_to_id",null),ao(this,"max_initial_timestamp_index",1)}}},"./src/models/whisper/processing_whisper.js":(e,t,n)=>{n.r(t),n.d(t,{WhisperProcessor:()=>i});var r=n("./src/models/auto/feature_extraction_auto.js"),o=n("./src/tokenizers.js"),a=n("./src/base/processing_utils.js");class i extends a.Processor{async _call(e){return await this.feature_extractor(e)}}ao(i,"tokenizer_class",o.AutoTokenizer),ao(i,"feature_extractor_class",r.AutoFeatureExtractor)},"./src/models/yolos/image_processing_yolos.js":(e,t,n)=>{n.r(t),n.d(t,{YolosFeatureExtractor:()=>a,YolosImageProcessor:()=>o});var r=n("./src/base/image_processors_utils.js");class o extends r.ImageProcessor{post_process_object_detection(){return(0,r.post_process_object_detection)(...arguments)}}class a extends o{}},"./src/ops/registry.js":(e,t,n)=>{n.r(t),n.d(t,{TensorOpRegistry:()=>l});var r=n("./src/backends/onnx.js"),o=n("./src/utils/tensor.js"),a=n("./src/env.js");const i=a.apis.IS_BROWSER_ENV||a.apis.IS_WEBWORKER_ENV,s=async(e,t,n)=>{const a=await(0,r.createInferenceSession)(new Uint8Array(e),t);let s=Promise.resolve();return async e=>{const t=(0,r.isONNXProxy)(),l=Object.fromEntries(Object.entries(e).map((e=>{let[n,r]=e;return[n,(t?r.clone():r).ort_tensor]}))),c=await(s=i?s.then((()=>a.run(l))):a.run(l));return Array.isArray(n)?n.map((e=>new o.Tensor(c[e]))):new o.Tensor(c[n])}};class l{static get nearest_interpolate_4d(){return this._nearest_interpolate_4d||(this._nearest_interpolate_4d=s([8,10,18,0,58,129,1,10,41,10,1,120,10,0,10,0,10,1,115,18,1,121,34,6,82,101,115,105,122,101,42,18,10,4,109,111,100,101,34,7,110,101,97,114,101,115,116,160,1,3,18,1,114,90,31,10,1,120,18,26,10,24,8,1,18,20,10,3,18,1,98,10,3,18,1,99,10,3,18,1,104,10,3,18,1,119,90,15,10,1,115,18,10,10,8,8,7,18,4,10,2,8,4,98,31,10,1,121,18,26,10,24,8,1,18,20,10,3,18,1,98,10,3,18,1,99,10,3,18,1,104,10,3,18,1,119,66,2,16,21],this.session_options,"y")),this._nearest_interpolate_4d}static get bilinear_interpolate_4d(){return this._bilinear_interpolate_4d||(this._bilinear_interpolate_4d=s([8,9,18,0,58,128,1,10,40,10,1,120,10,0,10,0,10,1,115,18,1,121,34,6,82,101,115,105,122,101,42,17,10,4,109,111,100,101,34,6,108,105,110,101,97,114,160,1,3,18,1,114,90,31,10,1,120,18,26,10,24,8,1,18,20,10,3,18,1,98,10,3,18,1,99,10,3,18,1,104,10,3,18,1,119,90,15,10,1,115,18,10,10,8,8,7,18,4,10,2,8,4,98,31,10,1,121,18,26,10,24,8,1,18,20,10,3,18,1,98,10,3,18,1,99,10,3,18,1,104,10,3,18,1,119,66,2,16,20],this.session_options,"y")),this._bilinear_interpolate_4d}static get bicubic_interpolate_4d(){return this._bicubic_interpolate_4d||(this._bicubic_interpolate_4d=s([8,9,18,0,58,127,10,39,10,1,120,10,0,10,0,10,1,115,18,1,121,34,6,82,101,115,105,122,101,42,16,10,4,109,111,100,101,34,5,99,117,98,105,99,160,1,3,18,1,114,90,31,10,1,120,18,26,10,24,8,1,18,20,10,3,18,1,98,10,3,18,1,99,10,3,18,1,104,10,3,18,1,119,90,15,10,1,115,18,10,10,8,8,7,18,4,10,2,8,4,98,31,10,1,121,18,26,10,24,8,1,18,20,10,3,18,1,98,10,3,18,1,99,10,3,18,1,104,10,3,18,1,119,66,2,16,20],this.session_options,"y")),this._bicubic_interpolate_4d}static get matmul(){return this._matmul||(this._matmul=s([8,9,18,0,58,55,10,17,10,1,97,10,1,98,18,1,99,34,6,77,97,116,77,117,108,18,1,114,90,9,10,1,97,18,4,10,2,8,1,90,9,10,1,98,18,4,10,2,8,1,98,9,10,1,99,18,4,10,2,8,1,66,2,16,20],this.session_options,"c")),this._matmul}static get stft(){return this._stft||(this._stft=s([8,7,18,0,58,148,1,10,38,10,1,115,10,1,106,10,1,119,10,1,108,18,1,111,34,4,83,84,70,84,42,15,10,8,111,110,101,115,105,100,101,100,24,1,160,1,2,18,1,115,90,26,10,1,115,18,21,10,19,8,1,18,15,10,3,18,1,98,10,3,18,1,115,10,3,18,1,99,90,11,10,1,106,18,6,10,4,8,7,18,0,90,16,10,1,119,18,11,10,9,8,1,18,5,10,3,18,1,119,90,11,10,1,108,18,6,10,4,8,7,18,0,98,31,10,1,111,18,26,10,24,8,1,18,20,10,3,18,1,98,10,3,18,1,102,10,3,18,1,100,10,3,18,1,99,66,2,16,17],this.session_options,"o")),this._stft}static get rfft(){return this._rfft||(this._rfft=s([8,9,18,0,58,97,10,33,10,1,120,10,0,10,1,97,18,1,121,34,3,68,70,84,42,15,10,8,111,110,101,115,105,100,101,100,24,1,160,1,2,18,1,100,90,21,10,1,120,18,16,10,14,8,1,18,10,10,3,18,1,115,10,3,18,1,99,90,11,10,1,97,18,6,10,4,8,7,18,0,98,21,10,1,121,18,16,10,14,8,1,18,10,10,3,18,1,115,10,3,18,1,99,66,2,16,20],this.session_options,"y")),this._rfft}static get top_k(){return this._top_k||(this._top_k=s([8,10,18,0,58,73,10,18,10,1,120,10,1,107,18,1,118,18,1,105,34,4,84,111,112,75,18,1,116,90,9,10,1,120,18,4,10,2,8,1,90,15,10,1,107,18,10,10,8,8,7,18,4,10,2,8,1,98,9,10,1,118,18,4,10,2,8,1,98,9,10,1,105,18,4,10,2,8,7,66,2,16,21],this.session_options,["v","i"])),this._top_k}static get slice(){return this._slice||(this._slice=s([8,7,18,0,58,96,10,25,10,1,120,10,1,115,10,1,101,10,1,97,10,1,116,18,1,121,34,5,83,108,105,99,101,18,1,114,90,9,10,1,120,18,4,10,2,8,1,90,9,10,1,115,18,4,10,2,8,7,90,9,10,1,101,18,4,10,2,8,7,90,9,10,1,97,18,4,10,2,8,7,90,9,10,1,116,18,4,10,2,8,7,98,9,10,1,121,18,4,10,2,8,1,66,2,16,13],this.session_options,"y")),this._slice}}ao(l,"session_options",{})},"./src/pipelines.js":(e,t,n)=>{n.r(t),n.d(t,{AudioClassificationPipeline:()=>T,AutomaticSpeechRecognitionPipeline:()=>M,BackgroundRemovalPipeline:()=>z,DepthEstimationPipeline:()=>V,DocumentQuestionAnsweringPipeline:()=>j,FeatureExtractionPipeline:()=>S,FillMaskPipeline:()=>y,ImageClassificationPipeline:()=>I,ImageFeatureExtractionPipeline:()=>E,ImageSegmentationPipeline:()=>P,ImageToImagePipeline:()=>R,ImageToTextPipeline:()=>F,ObjectDetectionPipeline:()=>N,Pipeline:()=>m,QuestionAnsweringPipeline:()=>v,SummarizationPipeline:()=>b,Text2TextGenerationPipeline:()=>w,TextClassificationPipeline:()=>g,TextGenerationPipeline:()=>C,TextToAudioPipeline:()=>L,TokenClassificationPipeline:()=>_,TranslationPipeline:()=>x,ZeroShotAudioClassificationPipeline:()=>A,ZeroShotClassificationPipeline:()=>D,ZeroShotImageClassificationPipeline:()=>O,ZeroShotObjectDetectionPipeline:()=>B,pipeline:()=>W});var r=n("./src/tokenizers.js"),o=n("./src/models.js"),a=n("./src/models/auto/processing_auto.js"),i=(n("./src/base/processing_utils.js"),n("./src/utils/generic.js")),s=n("./src/utils/core.js"),l=n("./src/utils/maths.js"),c=n("./src/utils/audio.js"),u=n("./src/utils/tensor.js"),d=n("./src/utils/image.js");async function p(e){return Array.isArray(e)||(e=[e]),await Promise.all(e.map((e=>d.RawImage.read(e))))}async function h(e,t){return Array.isArray(e)||(e=[e]),await Promise.all(e.map((e=>"string"===typeof e||e instanceof URL?(0,c.read_audio)(e,t):e instanceof Float64Array?new Float32Array(e):e)))}function f(e,t){t&&(e=e.map((e=>0|e)));const[n,r,o,a]=e;return{xmin:n,ymin:r,xmax:o,ymax:a}}class m extends i.Callable{constructor(e){let{task:t,model:n,tokenizer:r=null,processor:o=null}=e;super(),this.task=t,this.model=n,this.tokenizer=r,this.processor=o}async dispose(){await this.model.dispose()}}class g extends m{constructor(e){super(e)}async _call(e){let{top_k:t=1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=this.tokenizer(e,{padding:!0,truncation:!0}),r=await this.model(n),o="multi_label_classification"===this.model.config.problem_type?e=>e.sigmoid():e=>new u.Tensor("float32",(0,l.softmax)(e.data),e.dims),a=this.model.config.id2label,i=[];for(const s of r.logits){const e=o(s),n=await(0,u.topk)(e,t),r=n[0].tolist(),l=n[1].tolist().map(((e,t)=>({label:a?a[e]:"LABEL_".concat(e),score:r[t]})));1===t?i.push(...l):i.push(l)}return Array.isArray(e)||1===t?i:i[0]}}class _ extends m{constructor(e){super(e)}async _call(e){let{ignore_labels:t=["O"]}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=Array.isArray(e),r=this.tokenizer(n?e:[e],{padding:!0,truncation:!0}),o=(await this.model(r)).logits,a=this.model.config.id2label,i=[];for(let s=0;s<o.dims[0];++s){const e=r.input_ids[s],n=o[s],c=[];for(let r=0;r<n.dims[0];++r){const o=n[r],i=(0,l.max)(o.data)[1],s=a?a[i]:"LABEL_".concat(i);if(t.includes(s))continue;const u=this.tokenizer.decode([e[r].item()],{skip_special_tokens:!0});if(""===u)continue;const d=(0,l.softmax)(o.data);c.push({entity:s,score:d[i],index:r,word:u})}i.push(c)}return n?i:i[0]}}class v extends m{constructor(e){super(e)}async _call(e,t){let{top_k:n=1}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=this.tokenizer(e,{text_pair:t,padding:!0,truncation:!0}),{start_logits:o,end_logits:a}=await this.model(r),i=r.input_ids.tolist(),c=r.attention_mask.tolist(),u=this.tokenizer.all_special_ids,d=[];for(let p=0;p<o.dims[0];++p){const e=i[p],t=e.findIndex((e=>e==this.tokenizer.sep_token_id)),r=(c[p].map(((n,r)=>1==n&&(0===r||r>t&&-1===u.findIndex((t=>t==e[r]))))),o[p].tolist()),h=a[p].tolist();for(let n=1;n<r.length;++n)(0==c[p]||n<=t||-1!==u.findIndex((t=>t==e[n])))&&(r[n]=-1/0,h[n]=-1/0);const f=(0,l.softmax)(r).map(((e,t)=>[e,t])),m=(0,l.softmax)(h).map(((e,t)=>[e,t]));f[0][0]=0,m[0][0]=0;const g=(0,s.product)(f,m).filter((e=>e[0][1]<=e[1][1])).map((e=>[e[0][1],e[1][1],e[0][0]*e[1][0]])).sort(((e,t)=>t[2]-e[2]));for(let o=0;o<Math.min(g.length,n);++o){const[t,n,r]=g[o],a=e.slice(t,n+1),i=this.tokenizer.decode(a,{skip_special_tokens:!0});d.push({answer:i,score:r})}}return 1===n?d[0]:d}}class y extends m{constructor(e){super(e)}async _call(e){let{top_k:t=5}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=this.tokenizer(e,{padding:!0,truncation:!0}),{logits:r}=await this.model(n),o=[],a=n.input_ids.tolist();for(let i=0;i<a.length;++i){const e=a[i],n=e.findIndex((e=>e==this.tokenizer.mask_token_id));if(-1===n)throw Error("Mask token (".concat(this.tokenizer.mask_token,") not found in text."));const s=r[i][n],c=await(0,u.topk)(new u.Tensor("float32",(0,l.softmax)(s.data),s.dims),t),d=c[0].tolist(),p=c[1].tolist();o.push(p.map(((t,r)=>{const o=e.slice();return o[n]=t,{score:d[r],token:Number(t),token_str:this.tokenizer.decode([t]),sequence:this.tokenizer.decode(o,{skip_special_tokens:!0})}})))}return Array.isArray(e)?o:o[0]}}class w extends m{constructor(e){super(e),ao(this,"_key","generated_text")}async _call(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Array.isArray(e)||(e=[e]),this.model.config.prefix&&(e=e.map((e=>this.model.config.prefix+e)));const n=this.model.config.task_specific_params;n&&n[this.task]&&n[this.task].prefix&&(e=e.map((e=>n[this.task].prefix+e)));const r=this.tokenizer,o={padding:!0,truncation:!0};let a;a=this instanceof x&&"_build_translation_inputs"in r?r._build_translation_inputs(e,o,t):r(e,o);const i=await this.model.generate(so(so({},a),t));return r.batch_decode(i,{skip_special_tokens:!0}).map((e=>({[this._key]:e})))}}class b extends w{constructor(e){super(e),ao(this,"_key","summary_text")}}class x extends w{constructor(e){super(e),ao(this,"_key","translation_text")}}function k(e){return Array.isArray(e)&&e.every((e=>"role"in e&&"content"in e))}class C extends m{constructor(e){super(e)}async _call(e){var t,n;let r,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=!1,i=!1;if("string"===typeof e)r=e=[e];else if(Array.isArray(e)&&e.every((e=>"string"===typeof e)))a=!0,r=e;else{if(k(e))e=[e];else{if(!Array.isArray(e)||!e.every(k))throw new Error("Input must be a string, an array of strings, a Chat, or an array of Chats");a=!0}i=!0,r=e.map((e=>this.tokenizer.apply_chat_template(e,{tokenize:!1,add_generation_prompt:!0})))}const s=null!==(t=o.add_special_tokens)&&void 0!==t&&t,l=!i&&(null===(n=o.return_full_text)||void 0===n||n);this.tokenizer.padding_side="left";const c=this.tokenizer(r,{add_special_tokens:s,padding:!0,truncation:!0}),u=await this.model.generate(so(so({},c),o)),d=this.tokenizer.batch_decode(u,{skip_special_tokens:!0});let p;!l&&c.input_ids.dims.at(-1)>0&&(p=this.tokenizer.batch_decode(c.input_ids,{skip_special_tokens:!0}).map((e=>e.length)));const h=Array.from({length:e.length},(e=>[]));for(let f=0;f<d.length;++f){const t=Math.floor(f/u.dims[0]*e.length);p&&(d[f]=d[f].slice(p[t])),h[t].push({generated_text:i?[...e[t],{role:"assistant",content:d[f]}]:d[f]})}return a||1!==h.length?h:h[0]}}class D extends m{constructor(e){var t;super(e),this.label2id=Object.fromEntries(Object.entries(this.model.config.label2id).map((e=>{let[t,n]=e;return[t.toLowerCase(),n]}))),this.entailment_id=this.label2id.entailment,void 0===this.entailment_id&&(console.warn("Could not find 'entailment' in label2id mapping. Using 2 as entailment_id."),this.entailment_id=2),this.contradiction_id=null!==(t=this.label2id.contradiction)&&void 0!==t?t:this.label2id.not_entailment,void 0===this.contradiction_id&&(console.warn("Could not find 'contradiction' in label2id mapping. Using 0 as contradiction_id."),this.contradiction_id=0)}async _call(e,t){let{hypothesis_template:n="This example is {}.",multi_label:r=!1}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const o=Array.isArray(e);o||(e=[e]),Array.isArray(t)||(t=[t]);const a=t.map((e=>n.replace("{}",e))),i=r||1===t.length,s=[];for(const c of e){const e=[];for(const t of a){const n=this.tokenizer(c,{text_pair:t,padding:!0,truncation:!0}),r=await this.model(n);i?e.push([r.logits.data[this.contradiction_id],r.logits.data[this.entailment_id]]):e.push(r.logits.data[this.entailment_id])}const n=i?e.map((e=>(0,l.softmax)(e)[1])):(0,l.softmax)(e),r=n.map(((e,t)=>[e,t])).sort(((e,t)=>t[0]-e[0]));s.push({sequence:c,labels:r.map((e=>t[e[1]])),scores:r.map((e=>e[0]))})}return o?s:s[0]}}class S extends m{constructor(e){super(e)}async _call(e){var t,n;let{pooling:r="none",normalize:o=!1,quantize:a=!1,precision:i="binary"}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const s=this.tokenizer(e,{padding:!0,truncation:!0}),l=await this.model(s);let c=null!==(t=null!==(n=l.last_hidden_state)&&void 0!==n?n:l.logits)&&void 0!==t?t:l.token_embeddings;if("none"===r);else if("mean"===r)c=(0,u.mean_pooling)(c,s.attention_mask);else{if("cls"!==r)throw Error("Pooling method '".concat(r,"' not supported."));c=c.slice(null,0)}return o&&(c=c.normalize(2,-1)),a&&(c=(0,u.quantize_embeddings)(c,i)),c}}class E extends m{constructor(e){super(e)}async _call(e){let{pool:t=null}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=await p(e),{pixel_values:r}=await this.processor(n),o=await this.model({pixel_values:r});let a;if(t){if(!("pooler_output"in o))throw Error("No pooled output was returned. Make sure the model has a 'pooler' layer when using the 'pool' option.");a=o.pooler_output}else{var i,s;a=null!==(i=null!==(s=o.last_hidden_state)&&void 0!==s?s:o.logits)&&void 0!==i?i:o.image_embeds}return a}}class T extends m{constructor(e){super(e)}async _call(e){let{top_k:t=5}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=this.processor.feature_extractor.config.sampling_rate,r=await h(e,n),o=this.model.config.id2label,a=[];for(const i of r){const e=await this.processor(i),n=(await this.model(e)).logits[0],r=await(0,u.topk)(new u.Tensor("float32",(0,l.softmax)(n.data),n.dims),t),s=r[0].tolist(),c=r[1].tolist().map(((e,t)=>({label:o?o[e]:"LABEL_".concat(e),score:s[t]})));a.push(c)}return Array.isArray(e)?a:a[0]}}class A extends m{constructor(e){super(e)}async _call(e,t){let{hypothesis_template:n="This is a sound of {}."}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=!Array.isArray(e);r&&(e=[e]);const o=t.map((e=>n.replace("{}",e))),a=this.tokenizer(o,{padding:!0,truncation:!0}),i=this.processor.feature_extractor.config.sampling_rate,s=await h(e,i),c=[];for(const u of s){const e=await this.processor(u),n=await this.model(so(so({},a),e)),r=(0,l.softmax)(n.logits_per_audio.data);c.push([...r].map(((e,n)=>({score:e,label:t[n]}))))}return r?c[0]:c}}class M extends m{constructor(e){super(e)}async _call(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};switch(this.model.config.model_type){case"whisper":case"lite-whisper":return this._call_whisper(e,t);case"wav2vec2":case"wav2vec2-bert":case"unispeech":case"unispeech-sat":case"hubert":return this._call_wav2vec2(e,t);case"moonshine":return this._call_moonshine(e,t);default:throw new Error("AutomaticSpeechRecognitionPipeline does not support model type '".concat(this.model.config.model_type,"'."))}}async _call_wav2vec2(e,t){t.language&&console.warn('`language` parameter is not yet supported for `wav2vec2` models, defaulting to "English".'),t.task&&console.warn('`task` parameter is not yet supported for `wav2vec2` models, defaulting to "transcribe".');const n=!Array.isArray(e);n&&(e=[e]);const r=this.processor.feature_extractor.config.sampling_rate,o=await h(e,r),a=[];for(const i of o){const e=await this.processor(i),t=(await this.model(e)).logits[0],n=[];for(const o of t)n.push((0,l.max)(o.data)[1]);const r=this.tokenizer.decode(n);a.push({text:r})}return n?a[0]:a}async _call_whisper(e,t){var n,r,o,a;const i=null!==(n=t.return_timestamps)&&void 0!==n&&n,s=null!==(r=t.chunk_length_s)&&void 0!==r?r:0,c=null!==(o=t.force_full_sequences)&&void 0!==o&&o;let u=null!==(a=t.stride_length_s)&&void 0!==a?a:null;const d=so({},t);"word"===i&&(d.return_token_timestamps=!0,d.return_timestamps=!1);const p=!Array.isArray(e);p&&(e=[e]);const f=this.processor.feature_extractor.config.chunk_length/this.model.config.max_source_positions,m=this.processor.feature_extractor.config.hop_length,g=this.processor.feature_extractor.config.sampling_rate,_=await h(e,g),v=[];for(const h of _){let e=[];if(s>0){if(null===u)u=s/6;else if(s<=u)throw Error("`chunk_length_s` must be larger than `stride_length_s`.");const t=g*s,n=g*u,r=t-2*n;let o=0;for(;;){const a=o+t,i=h.subarray(o,a),s=await this.processor(i),l=0===o,c=a>=h.length;if(e.push({stride:[i.length,l?0:n,c?0:n],input_features:s.input_features,is_last:c}),c)break;o+=r}}else e=[{stride:[h.length,0,0],input_features:(await this.processor(h)).input_features,is_last:!0}];for(const r of e){d.num_frames=Math.floor(r.stride[0]/m);const e=await this.model.generate(so({inputs:r.input_features},d));"word"===i?(r.tokens=e.sequences.tolist()[0],r.token_timestamps=e.token_timestamps.tolist()[0].map((e=>(0,l.round)(e,2)))):r.tokens=e[0].tolist(),r.stride=r.stride.map((e=>e/g))}const[t,n]=this.tokenizer._decode_asr(e,{time_precision:f,return_timestamps:i,force_full_sequences:c});v.push(so({text:t},n))}return p?v[0]:v}async _call_moonshine(e,t){const n=!Array.isArray(e);n&&(e=[e]);const r=this.processor.feature_extractor.config.sampling_rate,o=await h(e,r),a=[];for(const i of o){const e=await this.processor(i),n=6*Math.floor(i.length/r),o=await this.model.generate(so(so({max_new_tokens:n},t),e)),s=this.processor.batch_decode(o,{skip_special_tokens:!0})[0];a.push({text:s})}return n?a[0]:a}}class F extends m{constructor(e){super(e)}async _call(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=Array.isArray(e),r=await p(e),{pixel_values:o}=await this.processor(r),a=[];for(const i of o){i.dims=[1,...i.dims];const e=await this.model.generate(so({inputs:i},t)),n=this.tokenizer.batch_decode(e,{skip_special_tokens:!0}).map((e=>({generated_text:e.trim()})));a.push(n)}return n?a:a[0]}}class I extends m{constructor(e){super(e)}async _call(e){let{top_k:t=5}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=await p(e),{pixel_values:r}=await this.processor(n),o=await this.model({pixel_values:r}),a=this.model.config.id2label,i=[];for(const s of o.logits){const e=await(0,u.topk)(new u.Tensor("float32",(0,l.softmax)(s.data),s.dims),t),n=e[0].tolist(),r=e[1].tolist().map(((e,t)=>({label:a?a[e]:"LABEL_".concat(e),score:n[t]})));i.push(r)}return Array.isArray(e)?i:i[0]}}class P extends m{constructor(e){super(e),this.subtasks_mapping={panoptic:"post_process_panoptic_segmentation",instance:"post_process_instance_segmentation",semantic:"post_process_semantic_segmentation"}}async _call(e){let{threshold:t=.5,mask_threshold:n=.5,overlap_mask_area_threshold:r=.8,label_ids_to_fuse:o=null,target_sizes:a=null,subtask:i=null}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(Array.isArray(e)&&1!==e.length)throw Error("Image segmentation pipeline currently only supports a batch size of 1.");const s=await p(e),l=s.map((e=>[e.height,e.width])),c=await this.processor(s),{inputNames:u,outputNames:h}=this.model.sessions.model;if(!u.includes("pixel_values")){if(1!==u.length)throw Error("Expected a single input name, but got ".concat(u.length," inputs: ").concat(u,"."));const e=u[0];if(e in c)throw Error("Input name ".concat(e," already exists in the inputs."));c[e]=c.pixel_values}const f=await this.model(c);let m=null;if(null!==i)m=this.subtasks_mapping[i];else if(this.processor.image_processor)for(const[d,p]of Object.entries(this.subtasks_mapping))if(p in this.processor.image_processor){m=this.processor.image_processor[p].bind(this.processor.image_processor),i=d;break}const g=this.model.config.id2label,_=[];if(i)if("panoptic"===i||"instance"===i){const e=m(f,t,n,r,o,null!==a&&void 0!==a?a:l)[0],i=e.segmentation;for(const t of e.segments_info){const e=new Uint8ClampedArray(i.data.length);for(let r=0;r<i.data.length;++r)i.data[r]===t.id&&(e[r]=255);const n=new d.RawImage(e,i.dims[1],i.dims[0],1);_.push({score:t.score,label:g[t.label_id],mask:n})}}else{if("semantic"!==i)throw Error("Subtask ".concat(i," not supported."));{const{segmentation:e,labels:t}=m(f,null!==a&&void 0!==a?a:l)[0];for(const n of t){const t=new Uint8ClampedArray(e.data.length);for(let o=0;o<e.data.length;++o)e.data[o]===n&&(t[o]=255);const r=new d.RawImage(t,e.dims[1],e.dims[0],1);_.push({score:null,label:g[n],mask:r})}}}else{const e=1e-5,t=f[h[0]];for(let n=0;n<l.length;++n){const r=l[n],o=t[n];o.data.some((t=>t<-e||t>1+e))&&o.sigmoid_();const a=await d.RawImage.fromTensor(o.mul_(255).to("uint8")).resize(r[1],r[0]);_.push({label:null,score:null,mask:a})}}return _}}class z extends P{constructor(e){super(e)}async _call(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(Array.isArray(e)&&1!==e.length)throw Error("Background removal pipeline currently only supports a batch size of 1.");const n=await p(e),r=await super._call(e,t);return n.map(((e,t)=>{const n=e.clone();return n.putAlpha(r[t].mask),n}))}}class O extends m{constructor(e){super(e)}async _call(e,t){let{hypothesis_template:n="This is a photo of {}"}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=Array.isArray(e),o=await p(e),a=t.map((e=>n.replace("{}",e))),i=this.tokenizer(a,{padding:"siglip"!==this.model.config.model_type||"max_length",truncation:!0}),{pixel_values:s}=await this.processor(o),c=await this.model(so(so({},i),{},{pixel_values:s})),u="siglip"===this.model.config.model_type?e=>e.sigmoid().data:e=>(0,l.softmax)(e.data),d=[];for(const l of c.logits_per_image){const e=[...u(l)].map(((e,n)=>({score:e,label:t[n]})));e.sort(((e,t)=>t.score-e.score)),d.push(e)}return r?d:d[0]}}class N extends m{constructor(e){super(e)}async _call(e){let{threshold:t=.9,percentage:n=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const r=Array.isArray(e);if(r&&1!==e.length)throw Error("Object detection pipeline currently only supports a batch size of 1.");const o=await p(e),a=n?null:o.map((e=>[e.height,e.width])),{pixel_values:i,pixel_mask:s}=await this.processor(o),l=await this.model({pixel_values:i,pixel_mask:s}),c=this.processor.image_processor.post_process_object_detection(l,t,a),u=this.model.config.id2label,d=c.map((e=>e.boxes.map(((t,r)=>({score:e.scores[r],label:u[e.classes[r]],box:f(t,!n)})))));return r?d:d[0]}}class B extends m{constructor(e){super(e)}async _call(e,t){let{threshold:n=.1,top_k:r=null,percentage:o=!1}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const a=Array.isArray(e),i=await p(e),s=this.tokenizer(t,{padding:!0,truncation:!0}),l=await this.processor(i),c=[];for(let u=0;u<i.length;++u){const e=i[u],a=o?null:[[e.height,e.width]],d=l.pixel_values[u].unsqueeze_(0),p=await this.model(so(so({},s),{},{pixel_values:d}));let h;if("post_process_grounded_object_detection"in this.processor){const e=this.processor.post_process_grounded_object_detection(p,s.input_ids,{box_threshold:n,text_threshold:n,target_sizes:a})[0];h=e.boxes.map(((t,n)=>({score:e.scores[n],label:e.labels[n],box:f(t,!o)})))}else{const e=this.processor.image_processor.post_process_object_detection(p,n,a,!0)[0];h=e.boxes.map(((n,r)=>({score:e.scores[r],label:t[e.classes[r]],box:f(n,!o)})))}h.sort(((e,t)=>t.score-e.score)),null!==r&&(h=h.slice(0,r)),c.push(h)}return a?c:c[0]}}class j extends m{constructor(e){super(e)}async _call(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=(await p(e))[0],{pixel_values:o}=await this.processor(r),a="<s_docvqa><s_question>".concat(t,"</s_question><s_answer>"),i=this.tokenizer(a,{add_special_tokens:!1,padding:!0,truncation:!0}).input_ids,s=await this.model.generate(so({inputs:o,max_length:this.model.config.decoder.max_position_embeddings,decoder_input_ids:i},n)),l=this.tokenizer.batch_decode(s)[0].match(/<s_answer>(.*?)<\/s_answer>/);let c=null;return l&&l.length>=2&&(c=l[1].trim()),[{answer:c}]}}class L extends m{constructor(e){var t;super(e),ao(this,"DEFAULT_VOCODER_ID","Xenova/speecht5_hifigan"),this.vocoder=null!==(t=e.vocoder)&&void 0!==t?t:null}async _call(e){let{speaker_embeddings:t=null}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.processor?this._call_text_to_spectrogram(e,{speaker_embeddings:t}):this._call_text_to_waveform(e)}async _call_text_to_waveform(e){const t=this.tokenizer(e,{padding:!0,truncation:!0}),{waveform:n}=await this.model(t),r=this.model.config.sampling_rate;return new c.RawAudio(n.data,r)}async _call_text_to_spectrogram(e,t){let{speaker_embeddings:n}=t;if(this.vocoder||(console.log("No vocoder specified, using default HifiGan vocoder."),this.vocoder=await o.AutoModel.from_pretrained(this.DEFAULT_VOCODER_ID,{dtype:"fp32"})),("string"===typeof n||n instanceof URL)&&(n=new Float32Array(await(await fetch(n)).arrayBuffer())),n instanceof Float32Array)n=new u.Tensor("float32",n,[1,n.length]);else if(!(n instanceof u.Tensor))throw new Error("Speaker embeddings must be a `Tensor`, `Float32Array`, `string`, or `URL`.");const{input_ids:r}=this.tokenizer(e,{padding:!0,truncation:!0}),{waveform:a}=await this.model.generate_speech(r,n,{vocoder:this.vocoder}),i=this.processor.feature_extractor.config.sampling_rate;return new c.RawAudio(a.data,i)}}class R extends m{constructor(e){super(e)}async _call(e){const t=await p(e),n=await this.processor(t),r=await this.model(n),o=[];for(const a of r.reconstruction){const e=a.squeeze().clamp_(0,1).mul_(255).round_().to("uint8");o.push(d.RawImage.fromTensor(e))}return o.length>1?o:o[0]}}class V extends m{constructor(e){super(e)}async _call(e){const t=await p(e),n=await this.processor(t),{predicted_depth:r}=await this.model(n),o=[];for(let a=0;a<t.length;++a){const e=r[a],[n,i]=e.dims.slice(-2),[s,l]=t[a].size,c=(await(0,u.interpolate_4d)(e.view(1,1,n,i),{size:[l,s],mode:"bilinear"})).view(l,s),p=c.min().item(),h=c.max().item(),f=c.sub(p).div_(h-p).mul_(255).to("uint8").unsqueeze(0),m=d.RawImage.fromTensor(f);o.push({predicted_depth:c,depth:m})}return o.length>1?o:o[0]}}const q=Object.freeze({"text-classification":{tokenizer:r.AutoTokenizer,pipeline:g,model:o.AutoModelForSequenceClassification,default:{model:"Xenova/distilbert-base-uncased-finetuned-sst-2-english"},type:"text"},"token-classification":{tokenizer:r.AutoTokenizer,pipeline:_,model:o.AutoModelForTokenClassification,default:{model:"Xenova/bert-base-multilingual-cased-ner-hrl"},type:"text"},"question-answering":{tokenizer:r.AutoTokenizer,pipeline:v,model:o.AutoModelForQuestionAnswering,default:{model:"Xenova/distilbert-base-cased-distilled-squad"},type:"text"},"fill-mask":{tokenizer:r.AutoTokenizer,pipeline:y,model:o.AutoModelForMaskedLM,default:{model:"Xenova/bert-base-uncased"},type:"text"},summarization:{tokenizer:r.AutoTokenizer,pipeline:b,model:o.AutoModelForSeq2SeqLM,default:{model:"Xenova/distilbart-cnn-6-6"},type:"text"},translation:{tokenizer:r.AutoTokenizer,pipeline:x,model:o.AutoModelForSeq2SeqLM,default:{model:"Xenova/t5-small"},type:"text"},"text2text-generation":{tokenizer:r.AutoTokenizer,pipeline:w,model:o.AutoModelForSeq2SeqLM,default:{model:"Xenova/flan-t5-small"},type:"text"},"text-generation":{tokenizer:r.AutoTokenizer,pipeline:C,model:o.AutoModelForCausalLM,default:{model:"Xenova/gpt2"},type:"text"},"zero-shot-classification":{tokenizer:r.AutoTokenizer,pipeline:D,model:o.AutoModelForSequenceClassification,default:{model:"Xenova/distilbert-base-uncased-mnli"},type:"text"},"audio-classification":{pipeline:T,model:o.AutoModelForAudioClassification,processor:a.AutoProcessor,default:{model:"Xenova/wav2vec2-base-superb-ks"},type:"audio"},"zero-shot-audio-classification":{tokenizer:r.AutoTokenizer,pipeline:A,model:o.AutoModel,processor:a.AutoProcessor,default:{model:"Xenova/clap-htsat-unfused"},type:"multimodal"},"automatic-speech-recognition":{tokenizer:r.AutoTokenizer,pipeline:M,model:[o.AutoModelForSpeechSeq2Seq,o.AutoModelForCTC],processor:a.AutoProcessor,default:{model:"Xenova/whisper-tiny.en"},type:"multimodal"},"text-to-audio":{tokenizer:r.AutoTokenizer,pipeline:L,model:[o.AutoModelForTextToWaveform,o.AutoModelForTextToSpectrogram],processor:[a.AutoProcessor,null],default:{model:"Xenova/speecht5_tts"},type:"text"},"image-to-text":{tokenizer:r.AutoTokenizer,pipeline:F,model:o.AutoModelForVision2Seq,processor:a.AutoProcessor,default:{model:"Xenova/vit-gpt2-image-captioning"},type:"multimodal"},"image-classification":{pipeline:I,model:o.AutoModelForImageClassification,processor:a.AutoProcessor,default:{model:"Xenova/vit-base-patch16-224"},type:"multimodal"},"image-segmentation":{pipeline:P,model:[o.AutoModelForImageSegmentation,o.AutoModelForSemanticSegmentation,o.AutoModelForUniversalSegmentation],processor:a.AutoProcessor,default:{model:"Xenova/detr-resnet-50-panoptic"},type:"multimodal"},"background-removal":{pipeline:z,model:[o.AutoModelForImageSegmentation,o.AutoModelForSemanticSegmentation,o.AutoModelForUniversalSegmentation],processor:a.AutoProcessor,default:{model:"Xenova/modnet"},type:"image"},"zero-shot-image-classification":{tokenizer:r.AutoTokenizer,pipeline:O,model:o.AutoModel,processor:a.AutoProcessor,default:{model:"Xenova/clip-vit-base-patch32"},type:"multimodal"},"object-detection":{pipeline:N,model:o.AutoModelForObjectDetection,processor:a.AutoProcessor,default:{model:"Xenova/detr-resnet-50"},type:"multimodal"},"zero-shot-object-detection":{tokenizer:r.AutoTokenizer,pipeline:B,model:o.AutoModelForZeroShotObjectDetection,processor:a.AutoProcessor,default:{model:"Xenova/owlvit-base-patch32"},type:"multimodal"},"document-question-answering":{tokenizer:r.AutoTokenizer,pipeline:j,model:o.AutoModelForDocumentQuestionAnswering,processor:a.AutoProcessor,default:{model:"Xenova/donut-base-finetuned-docvqa"},type:"multimodal"},"image-to-image":{pipeline:R,model:o.AutoModelForImageToImage,processor:a.AutoProcessor,default:{model:"Xenova/swin2SR-classical-sr-x2-64"},type:"image"},"depth-estimation":{pipeline:V,model:o.AutoModelForDepthEstimation,processor:a.AutoProcessor,default:{model:"Xenova/dpt-large"},type:"image"},"feature-extraction":{tokenizer:r.AutoTokenizer,pipeline:S,model:o.AutoModel,default:{model:"Xenova/all-MiniLM-L6-v2"},type:"text"},"image-feature-extraction":{processor:a.AutoProcessor,pipeline:E,model:[o.AutoModelForImageFeatureExtraction,o.AutoModel],default:{model:"Xenova/vit-base-patch16-224-in21k"},type:"image"}}),U=Object.freeze({"sentiment-analysis":"text-classification",ner:"token-classification",asr:"automatic-speech-recognition","text-to-speech":"text-to-audio",embeddings:"feature-extraction"});async function W(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,{progress_callback:r=null,config:o=null,cache_dir:a=null,local_files_only:i=!1,revision:l="main",device:c=null,dtype:u=null,subfolder:d="onnx",use_external_data_format:p=null,model_file_name:h=null,session_options:f={}}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};e=null!==(t=U[e])&&void 0!==t?t:e;const m=q[e.split("_",1)[0]];if(!m)throw Error("Unsupported pipeline: ".concat(e,". Must be one of [").concat(Object.keys(q),"]"));n||(n=m.default.model,console.log('No model specified. Using default model: "'.concat(n,'".')));const g={progress_callback:r,config:o,cache_dir:a,local_files_only:i,revision:l,device:c,dtype:u,subfolder:d,use_external_data_format:p,model_file_name:h,session_options:f},_=new Map([["tokenizer",m.tokenizer],["model",m.model],["processor",m.processor]]),v=await async function(e,t,n){const r=Object.create(null),o=[];for(const[a,i]of e.entries()){if(!i)continue;let e;e=Array.isArray(i)?new Promise((async(e,r)=>{let o;for(const c of i){if(null===c)return void e(null);try{return void e(await c.from_pretrained(t,n))}catch(l){var a,s;if(null!==(a=l.message)&&void 0!==a&&a.includes("Unsupported model type"))o=l;else{if(null===(s=l.message)||void 0===s||!s.includes("Could not locate file"))return void r(l);o=l}}}r(o)})):i.from_pretrained(t,n),r[a]=e,o.push(e)}await Promise.all(o);for(const[a,i]of Object.entries(r))r[a]=await i;return r}(_,n,g);v.task=e,(0,s.dispatchCallback)(r,{status:"ready",task:e,model:n});return new(0,m.pipeline)(v)}},"./src/tokenizers.js":(e,t,n)=>{n.r(t),n.d(t,{AlbertTokenizer:()=>Ce,AutoTokenizer:()=>gt,BartTokenizer:()=>je,BertTokenizer:()=>ke,BlenderbotSmallTokenizer:()=>ut,BlenderbotTokenizer:()=>ct,BloomTokenizer:()=>qe,CLIPTokenizer:()=>at,CamembertTokenizer:()=>Pe,CodeGenTokenizer:()=>ot,CodeLlamaTokenizer:()=>Ge,CohereTokenizer:()=>ft,ConvBertTokenizer:()=>Me,DebertaTokenizer:()=>Ee,DebertaV2Tokenizer:()=>Te,DistilBertTokenizer:()=>Ie,ElectraTokenizer:()=>Oe,EsmTokenizer:()=>Xe,FalconTokenizer:()=>Ze,GPT2Tokenizer:()=>Be,GPTNeoXTokenizer:()=>$e,GemmaTokenizer:()=>Qe,Grok1Tokenizer:()=>Ye,HerbertTokenizer:()=>Ae,LlamaTokenizer:()=>We,M2M100Tokenizer:()=>nt,MBart50Tokenizer:()=>Re,MBartTokenizer:()=>Le,MPNetTokenizer:()=>Ke,MarianTokenizer:()=>st,MgpstrTokenizer:()=>mt,MobileBertTokenizer:()=>De,NllbTokenizer:()=>tt,NougatTokenizer:()=>pt,PreTrainedTokenizer:()=>xe,Qwen2Tokenizer:()=>Je,RoFormerTokenizer:()=>Fe,RobertaTokenizer:()=>Ve,SiglipTokenizer:()=>it,SpeechT5Tokenizer:()=>dt,SqueezeBertTokenizer:()=>Se,T5Tokenizer:()=>Ne,TokenizerModel:()=>k,VitsTokenizer:()=>ht,Wav2Vec2CTCTokenizer:()=>lt,WhisperTokenizer:()=>rt,XLMRobertaTokenizer:()=>He,XLMTokenizer:()=>ze,is_chinese_char:()=>_});var r=n("./src/utils/generic.js"),o=n("./src/utils/core.js"),a=n("./src/utils/hub.js"),i=n("./src/utils/maths.js"),s=n("./src/utils/tensor.js"),l=n("./src/utils/data-structures.js"),c=n("./node_modules/@huggingface/jinja/dist/index.js"),u=n("./src/models/whisper/common_whisper.js");async function d(e,t){const n=await Promise.all([(0,a.getModelJSON)(e,"tokenizer.json",!0,t),(0,a.getModelJSON)(e,"tokenizer_config.json",!0,t)]);return null!==t.legacy&&(n[1].legacy=t.legacy),n}function p(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(void 0!==e.Regex){let t=e.Regex.replace(/\\([#&~])/g,"$1");for(const[e,n]of b)t=t.replaceAll(e,n);return new RegExp(t,"gu")}if(void 0!==e.String){const n=(0,o.escapeRegExp)(e.String);return new RegExp(t?n:"(".concat(n,")"),"gu")}return console.warn("Unknown pattern type:",e),null}function h(e){return new Map(Object.entries(e))}function f(e){const t=e.dims;switch(t.length){case 1:return e.tolist();case 2:if(1!==t[0])throw new Error("Unable to decode tensor with `batch size !== 1`. Use `tokenizer.batch_decode(...)` for batched inputs.");return e.tolist()[0];default:throw new Error("Expected tensor to have 1-2 dimensions, got ".concat(t.length,"."))}}function m(e){return e.replace(/ \./g,".").replace(/ \?/g,"?").replace(/ \!/g,"!").replace(/ ,/g,",").replace(/ \' /g,"'").replace(/ n\'t/g,"n't").replace(/ \'m/g,"'m").replace(/ \'s/g,"'s").replace(/ \'ve/g,"'ve").replace(/ \'re/g,"'re")}function g(e){return e.replace(/(?:[\u0300-\u036F\u0483-\u0489\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u0610-\u061A\u064B-\u065F\u0670\u06D6-\u06DC\u06DF-\u06E4\u06E7\u06E8\u06EA-\u06ED\u0711\u0730-\u074A\u07A6-\u07B0\u07EB-\u07F3\u07FD\u0816-\u0819\u081B-\u0823\u0825-\u0827\u0829-\u082D\u0859-\u085B\u0897-\u089F\u08CA-\u08E1\u08E3-\u0903\u093A-\u093C\u093E-\u094F\u0951-\u0957\u0962\u0963\u0981-\u0983\u09BC\u09BE-\u09C4\u09C7\u09C8\u09CB-\u09CD\u09D7\u09E2\u09E3\u09FE\u0A01-\u0A03\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A70\u0A71\u0A75\u0A81-\u0A83\u0ABC\u0ABE-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AE2\u0AE3\u0AFA-\u0AFF\u0B01-\u0B03\u0B3C\u0B3E-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B55-\u0B57\u0B62\u0B63\u0B82\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD7\u0C00-\u0C04\u0C3C\u0C3E-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C62\u0C63\u0C81-\u0C83\u0CBC\u0CBE-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CE2\u0CE3\u0CF3\u0D00-\u0D03\u0D3B\u0D3C\u0D3E-\u0D44\u0D46-\u0D48\u0D4A-\u0D4D\u0D57\u0D62\u0D63\u0D81-\u0D83\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DF2\u0DF3\u0E31\u0E34-\u0E3A\u0E47-\u0E4E\u0EB1\u0EB4-\u0EBC\u0EC8-\u0ECE\u0F18\u0F19\u0F35\u0F37\u0F39\u0F3E\u0F3F\u0F71-\u0F84\u0F86\u0F87\u0F8D-\u0F97\u0F99-\u0FBC\u0FC6\u102B-\u103E\u1056-\u1059\u105E-\u1060\u1062-\u1064\u1067-\u106D\u1071-\u1074\u1082-\u108D\u108F\u109A-\u109D\u135D-\u135F\u1712-\u1715\u1732-\u1734\u1752\u1753\u1772\u1773\u17B4-\u17D3\u17DD\u180B-\u180D\u180F\u1885\u1886\u18A9\u1920-\u192B\u1930-\u193B\u1A17-\u1A1B\u1A55-\u1A5E\u1A60-\u1A7C\u1A7F\u1AB0-\u1ACE\u1B00-\u1B04\u1B34-\u1B44\u1B6B-\u1B73\u1B80-\u1B82\u1BA1-\u1BAD\u1BE6-\u1BF3\u1C24-\u1C37\u1CD0-\u1CD2\u1CD4-\u1CE8\u1CED\u1CF4\u1CF7-\u1CF9\u1DC0-\u1DFF\u20D0-\u20F0\u2CEF-\u2CF1\u2D7F\u2DE0-\u2DFF\u302A-\u302F\u3099\u309A\uA66F-\uA672\uA674-\uA67D\uA69E\uA69F\uA6F0\uA6F1\uA802\uA806\uA80B\uA823-\uA827\uA82C\uA880\uA881\uA8B4-\uA8C5\uA8E0-\uA8F1\uA8FF\uA926-\uA92D\uA947-\uA953\uA980-\uA983\uA9B3-\uA9C0\uA9E5\uAA29-\uAA36\uAA43\uAA4C\uAA4D\uAA7B-\uAA7D\uAAB0\uAAB2-\uAAB4\uAAB7\uAAB8\uAABE\uAABF\uAAC1\uAAEB-\uAAEF\uAAF5\uAAF6\uABE3-\uABEA\uABEC\uABED\uFB1E\uFE00-\uFE0F\uFE20-\uFE2F]|\uD800[\uDDFD\uDEE0\uDF76-\uDF7A]|\uD802[\uDE01-\uDE03\uDE05\uDE06\uDE0C-\uDE0F\uDE38-\uDE3A\uDE3F\uDEE5\uDEE6]|\uD803[\uDD24-\uDD27\uDD69-\uDD6D\uDEAB\uDEAC\uDEFC-\uDEFF\uDF46-\uDF50\uDF82-\uDF85]|\uD804[\uDC00-\uDC02\uDC38-\uDC46\uDC70\uDC73\uDC74\uDC7F-\uDC82\uDCB0-\uDCBA\uDCC2\uDD00-\uDD02\uDD27-\uDD34\uDD45\uDD46\uDD73\uDD80-\uDD82\uDDB3-\uDDC0\uDDC9-\uDDCC\uDDCE\uDDCF\uDE2C-\uDE37\uDE3E\uDE41\uDEDF-\uDEEA\uDF00-\uDF03\uDF3B\uDF3C\uDF3E-\uDF44\uDF47\uDF48\uDF4B-\uDF4D\uDF57\uDF62\uDF63\uDF66-\uDF6C\uDF70-\uDF74\uDFB8-\uDFC0\uDFC2\uDFC5\uDFC7-\uDFCA\uDFCC-\uDFD0\uDFD2\uDFE1\uDFE2]|\uD805[\uDC35-\uDC46\uDC5E\uDCB0-\uDCC3\uDDAF-\uDDB5\uDDB8-\uDDC0\uDDDC\uDDDD\uDE30-\uDE40\uDEAB-\uDEB7\uDF1D-\uDF2B]|\uD806[\uDC2C-\uDC3A\uDD30-\uDD35\uDD37\uDD38\uDD3B-\uDD3E\uDD40\uDD42\uDD43\uDDD1-\uDDD7\uDDDA-\uDDE0\uDDE4\uDE01-\uDE0A\uDE33-\uDE39\uDE3B-\uDE3E\uDE47\uDE51-\uDE5B\uDE8A-\uDE99]|\uD807[\uDC2F-\uDC36\uDC38-\uDC3F\uDC92-\uDCA7\uDCA9-\uDCB6\uDD31-\uDD36\uDD3A\uDD3C\uDD3D\uDD3F-\uDD45\uDD47\uDD8A-\uDD8E\uDD90\uDD91\uDD93-\uDD97\uDEF3-\uDEF6\uDF00\uDF01\uDF03\uDF34-\uDF3A\uDF3E-\uDF42\uDF5A]|\uD80D[\uDC40\uDC47-\uDC55]|\uD818[\uDD1E-\uDD2F]|\uD81A[\uDEF0-\uDEF4\uDF30-\uDF36]|\uD81B[\uDF4F\uDF51-\uDF87\uDF8F-\uDF92\uDFE4\uDFF0\uDFF1]|\uD82F[\uDC9D\uDC9E]|\uD833[\uDF00-\uDF2D\uDF30-\uDF46]|\uD834[\uDD65-\uDD69\uDD6D-\uDD72\uDD7B-\uDD82\uDD85-\uDD8B\uDDAA-\uDDAD\uDE42-\uDE44]|\uD836[\uDE00-\uDE36\uDE3B-\uDE6C\uDE75\uDE84\uDE9B-\uDE9F\uDEA1-\uDEAF]|\uD838[\uDC00-\uDC06\uDC08-\uDC18\uDC1B-\uDC21\uDC23\uDC24\uDC26-\uDC2A\uDC8F\uDD30-\uDD36\uDEAE\uDEEC-\uDEEF]|\uD839[\uDCEC-\uDCEF\uDDEE\uDDEF]|\uD83A[\uDCD0-\uDCD6\uDD44-\uDD4A]|\uDB40[\uDD00-\uDDEF])/g,"")}function _(e){return e>=19968&&e<=40959||e>=13312&&e<=19903||e>=131072&&e<=173791||e>=173824&&e<=177983||e>=177984&&e<=178207||e>=178208&&e<=183983||e>=63744&&e<=64255||e>=194560&&e<=195103}const v="\\p{P}\\u0021-\\u002F\\u003A-\\u0040\\u005B-\\u0060\\u007B-\\u007E",y=new RegExp("^[".concat(v,"]+$"),"gu"),w=".,!?\u2026\u3002\uff0c\u3001\u0964\u06d4\u060c",b=new Map([["(?i:'s|'t|'re|'ve|'m|'ll|'d)","(?:'([sS]|[tT]|[rR][eE]|[vV][eE]|[mM]|[lL][lL]|[dD]))"],[" ?[^(\\s|[".concat(w,"])]+")," ?[^\\s".concat(w,"]+")]]);class x{constructor(e){var t,n,r,o,a;this.content=e.content,this.id=e.id,this.single_word=null!==(t=e.single_word)&&void 0!==t&&t,this.lstrip=null!==(n=e.lstrip)&&void 0!==n&&n,this.rstrip=null!==(r=e.rstrip)&&void 0!==r&&r,this.special=null!==(o=e.special)&&void 0!==o&&o,this.normalized=null!==(a=e.normalized)&&void 0!==a?a:null}}class k extends r.Callable{constructor(e){var t;super(),this.config=e,this.vocab=[],this.tokens_to_ids=new Map,this.unk_token_id=void 0,this.unk_token=void 0,this.end_of_word_suffix=void 0,this.fuse_unk=null!==(t=this.config.fuse_unk)&&void 0!==t&&t}static fromConfig(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];switch(e.type){case"WordPiece":return new C(e);case"Unigram":return new D(e,...n);case"BPE":return new T(e);default:if(e.vocab)return Array.isArray(e.vocab)?new D(e,...n):Object.hasOwn(e,"continuing_subword_prefix")&&Object.hasOwn(e,"unk_token")?Object.hasOwn(e,"merges")?new T(e):new C(e):new A(e,...n);throw new Error("Unknown TokenizerModel type: ".concat(e.type))}}_call(e){return e=this.encode(e),this.fuse_unk&&(e=function(e,t,n){const r=[];let o=0;for(;o<e.length;){var a;if(r.push(e[o]),(null!==(a=t.get(e[o]))&&void 0!==a?a:n)===n)for(;++o<e.length&&(null!==(i=t.get(e[o]))&&void 0!==i?i:n)===n;){var i;t.get(r.at(-1))!==n&&(r[r.length-1]+=e[o])}else++o}return r}(e,this.tokens_to_ids,this.unk_token_id)),e}encode(e){throw Error("encode should be implemented in subclass.")}convert_tokens_to_ids(e){return e.map((e=>{var t;return null!==(t=this.tokens_to_ids.get(e))&&void 0!==t?t:this.unk_token_id}))}convert_ids_to_tokens(e){return e.map((e=>{var t;return null!==(t=this.vocab[e])&&void 0!==t?t:this.unk_token}))}}class C extends k{constructor(e){var t;super(e),this.tokens_to_ids=h(e.vocab),this.unk_token_id=this.tokens_to_ids.get(e.unk_token),this.unk_token=e.unk_token,this.max_input_chars_per_word=null!==(t=e.max_input_chars_per_word)&&void 0!==t?t:100,this.vocab=new Array(this.tokens_to_ids.size);for(const[n,r]of this.tokens_to_ids)this.vocab[r]=n}encode(e){const t=[];for(const n of e){const e=[...n];if(e.length>this.max_input_chars_per_word){t.push(this.unk_token);continue}let r=!1,o=0;const a=[];for(;o<e.length;){let t=e.length,n=null;for(;o<t;){let r=e.slice(o,t).join("");if(o>0&&(r=this.config.continuing_subword_prefix+r),this.tokens_to_ids.has(r)){n=r;break}--t}if(null===n){r=!0;break}a.push(n),o=t}r?t.push(this.unk_token):t.push(...a)}return t}}class D extends k{constructor(e,t){super(e);const n=e.vocab.length;this.vocab=new Array(n),this.scores=new Array(n);for(let r=0;r<n;++r)[this.vocab[r],this.scores[r]]=e.vocab[r];this.unk_token_id=e.unk_id,this.unk_token=this.vocab[e.unk_id],this.tokens_to_ids=new Map(this.vocab.map(((e,t)=>[e,t]))),this.bos_token=" ",this.bos_token_id=this.tokens_to_ids.get(this.bos_token),this.eos_token=t.eos_token,this.eos_token_id=this.tokens_to_ids.get(this.eos_token),this.unk_token=this.vocab[this.unk_token_id],this.minScore=(0,i.min)(this.scores)[0],this.unk_score=this.minScore-10,this.scores[this.unk_token_id]=this.unk_score,this.trie=new l.CharTrie,this.trie.extend(this.vocab),this.fuse_unk=!0}populateNodes(e){const t=e.chars;let n=0;for(;n<t.length;){let r=!1;const a=[],i=t.slice(n).join(""),s=this.trie.commonPrefixSearch(i);for(const t of s){a.push(t);const i=this.tokens_to_ids.get(t),s=this.scores[i],l=(0,o.len)(t);e.insert(n,l,s,i),r||1!==l||(r=!0)}r||e.insert(n,1,this.unk_score,this.unk_token_id),n+=1}}tokenize(e){const t=new l.TokenLattice(e,this.bos_token_id,this.eos_token_id);return this.populateNodes(t),t.tokens()}encode(e){const t=[];for(const n of e){const e=this.tokenize(n);t.push(...e)}return t}}const S=(()=>{const e=[...Array.from({length:"~".charCodeAt(0)-"!".charCodeAt(0)+1},((e,t)=>t+"!".charCodeAt(0))),...Array.from({length:"\xac".charCodeAt(0)-"\xa1".charCodeAt(0)+1},((e,t)=>t+"\xa1".charCodeAt(0))),...Array.from({length:"\xff".charCodeAt(0)-"\xae".charCodeAt(0)+1},((e,t)=>t+"\xae".charCodeAt(0)))],t=e.slice();let n=0;for(let o=0;o<256;++o)e.includes(o)||(e.push(o),t.push(256+n),n+=1);const r=t.map((e=>String.fromCharCode(e)));return Object.fromEntries(e.map(((e,t)=>[e,r[t]])))})(),E=(0,o.reverseDictionary)(S);class T extends k{constructor(e){var t,n,r;super(e),this.tokens_to_ids=h(e.vocab),this.unk_token_id=this.tokens_to_ids.get(e.unk_token),this.unk_token=e.unk_token,this.vocab=new Array(this.tokens_to_ids.size);for(const[a,i]of this.tokens_to_ids)this.vocab[i]=a;const o=Array.isArray(e.merges[0]);this.merges=o?e.merges:e.merges.map((e=>e.split(" ",2))),this.bpe_ranks=new Map(this.merges.map(((e,t)=>[JSON.stringify(e),t]))),this.end_of_word_suffix=e.end_of_word_suffix,this.continuing_subword_suffix=null!==(t=e.continuing_subword_suffix)&&void 0!==t?t:null,this.byte_fallback=null!==(n=this.config.byte_fallback)&&void 0!==n&&n,this.byte_fallback&&(this.text_encoder=new TextEncoder),this.ignore_merges=null!==(r=this.config.ignore_merges)&&void 0!==r&&r,this.max_length_to_cache=256,this.cache_capacity=1e4,this.cache=new l.LRUCache(this.cache_capacity)}clear_cache(){this.cache.clear()}bpe(e){if(0===e.length)return[];const t=this.cache.get(e);if(void 0!==t)return t;const n=Array.from(e);this.end_of_word_suffix&&(n[n.length-1]+=this.end_of_word_suffix);let r=[];if(n.length>1){const e=new l.PriorityQueue(((e,t)=>e.score<t.score));let t={token:n[0],bias:0,prev:null,next:null},o=t;for(let r=1;r<n.length;++r){const t={bias:r/n.length,token:n[r],prev:o,next:null};o.next=t,this._add_node(e,o),o=t}for(;!e.isEmpty();){const n=e.pop();if(n.deleted||!n.next||n.next.deleted)continue;if(n.deleted=!0,n.next.deleted=!0,n.prev){const e=so({},n.prev);n.prev.deleted=!0,n.prev=e,e.prev?e.prev.next=e:t=e}const r={token:n.token+n.next.token,bias:n.bias,prev:n.prev,next:n.next.next};r.prev?(r.prev.next=r,this._add_node(e,r.prev)):t=r,r.next&&(r.next.prev=r,this._add_node(e,r))}for(let n=t;null!==n;n=n.next)r.push(n.token)}else r=n;if(this.continuing_subword_suffix)for(let o=0;o<r.length-1;++o)r[o]+=this.continuing_subword_suffix;return e.length<this.max_length_to_cache&&this.cache.put(e,r),r}_add_node(e,t){const n=this.bpe_ranks.get(JSON.stringify([t.token,t.next.token]));void 0!==n&&(t.score=n+t.bias,e.push(t))}encode(e){const t=[];for(const n of e){if(this.ignore_merges&&this.tokens_to_ids.has(n)){t.push(n);continue}const e=this.bpe(n);for(const n of e)if(this.tokens_to_ids.has(n))t.push(n);else if(this.byte_fallback){const e=Array.from(this.text_encoder.encode(n)).map((e=>"<0x".concat(e.toString(16).toUpperCase().padStart(2,"0"),">")));e.every((e=>this.tokens_to_ids.has(e)))?t.push(...e):t.push(this.unk_token)}else t.push(this.unk_token)}return t}}class A extends k{constructor(e,t){super(e),this.tokens_to_ids=h(t.target_lang?e.vocab[t.target_lang]:e.vocab),this.bos_token=t.bos_token,this.bos_token_id=this.tokens_to_ids.get(this.bos_token),this.eos_token=t.eos_token,this.eos_token_id=this.tokens_to_ids.get(this.eos_token),this.pad_token=t.pad_token,this.pad_token_id=this.tokens_to_ids.get(this.pad_token),this.unk_token=t.unk_token,this.unk_token_id=this.tokens_to_ids.get(this.unk_token),this.vocab=new Array(this.tokens_to_ids.size);for(const[n,r]of this.tokens_to_ids)this.vocab[r]=n}encode(e){return e}}class M extends r.Callable{constructor(e){super(),this.config=e}static fromConfig(e){if(null===e)return null;switch(e.type){case"BertNormalizer":return new q(e);case"Precompiled":return new fe(e);case"Sequence":return new V(e);case"Replace":return new F(e);case"NFC":return new P(e);case"NFD":return new z(e);case"NFKC":return new O(e);case"NFKD":return new N(e);case"Strip":return new B(e);case"StripAccents":return new j(e);case"Lowercase":return new L(e);case"Prepend":return new R(e);default:throw new Error("Unknown Normalizer type: ".concat(e.type))}}normalize(e){throw Error("normalize should be implemented in subclass.")}_call(e){return this.normalize(e)}}class F extends M{normalize(e){const t=p(this.config.pattern);return null===t?e:e.replaceAll(t,this.config.content)}}class I extends M{constructor(){super(...arguments),ao(this,"form",void 0)}normalize(e){return e=e.normalize(this.form)}}class P extends I{constructor(){super(...arguments),ao(this,"form","NFC")}}class z extends I{constructor(){super(...arguments),ao(this,"form","NFD")}}class O extends I{constructor(){super(...arguments),ao(this,"form","NFKC")}}class N extends I{constructor(){super(...arguments),ao(this,"form","NFKD")}}class B extends M{normalize(e){return this.config.strip_left&&this.config.strip_right?e=e.trim():(this.config.strip_left&&(e=e.trimStart()),this.config.strip_right&&(e=e.trimEnd())),e}}class j extends M{normalize(e){return e=g(e)}}class L extends M{normalize(e){return e=e.toLowerCase()}}class R extends M{normalize(e){return e=this.config.prepend+e}}class V extends M{constructor(e){super(e),this.normalizers=e.normalizers.map((e=>M.fromConfig(e)))}normalize(e){return this.normalizers.reduce(((e,t)=>t.normalize(e)),e)}}class q extends M{_tokenize_chinese_chars(e){const t=[];for(let n=0;n<e.length;++n){const r=e[n];_(r.charCodeAt(0))?(t.push(" "),t.push(r),t.push(" ")):t.push(r)}return t.join("")}stripAccents(e){return e.normalize("NFD").replace(/(?:[\u0300-\u036F\u0483-\u0487\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u0610-\u061A\u064B-\u065F\u0670\u06D6-\u06DC\u06DF-\u06E4\u06E7\u06E8\u06EA-\u06ED\u0711\u0730-\u074A\u07A6-\u07B0\u07EB-\u07F3\u07FD\u0816-\u0819\u081B-\u0823\u0825-\u0827\u0829-\u082D\u0859-\u085B\u0897-\u089F\u08CA-\u08E1\u08E3-\u0902\u093A\u093C\u0941-\u0948\u094D\u0951-\u0957\u0962\u0963\u0981\u09BC\u09C1-\u09C4\u09CD\u09E2\u09E3\u09FE\u0A01\u0A02\u0A3C\u0A41\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A70\u0A71\u0A75\u0A81\u0A82\u0ABC\u0AC1-\u0AC5\u0AC7\u0AC8\u0ACD\u0AE2\u0AE3\u0AFA-\u0AFF\u0B01\u0B3C\u0B3F\u0B41-\u0B44\u0B4D\u0B55\u0B56\u0B62\u0B63\u0B82\u0BC0\u0BCD\u0C00\u0C04\u0C3C\u0C3E-\u0C40\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C62\u0C63\u0C81\u0CBC\u0CBF\u0CC6\u0CCC\u0CCD\u0CE2\u0CE3\u0D00\u0D01\u0D3B\u0D3C\u0D41-\u0D44\u0D4D\u0D62\u0D63\u0D81\u0DCA\u0DD2-\u0DD4\u0DD6\u0E31\u0E34-\u0E3A\u0E47-\u0E4E\u0EB1\u0EB4-\u0EBC\u0EC8-\u0ECE\u0F18\u0F19\u0F35\u0F37\u0F39\u0F71-\u0F7E\u0F80-\u0F84\u0F86\u0F87\u0F8D-\u0F97\u0F99-\u0FBC\u0FC6\u102D-\u1030\u1032-\u1037\u1039\u103A\u103D\u103E\u1058\u1059\u105E-\u1060\u1071-\u1074\u1082\u1085\u1086\u108D\u109D\u135D-\u135F\u1712-\u1714\u1732\u1733\u1752\u1753\u1772\u1773\u17B4\u17B5\u17B7-\u17BD\u17C6\u17C9-\u17D3\u17DD\u180B-\u180D\u180F\u1885\u1886\u18A9\u1920-\u1922\u1927\u1928\u1932\u1939-\u193B\u1A17\u1A18\u1A1B\u1A56\u1A58-\u1A5E\u1A60\u1A62\u1A65-\u1A6C\u1A73-\u1A7C\u1A7F\u1AB0-\u1ABD\u1ABF-\u1ACE\u1B00-\u1B03\u1B34\u1B36-\u1B3A\u1B3C\u1B42\u1B6B-\u1B73\u1B80\u1B81\u1BA2-\u1BA5\u1BA8\u1BA9\u1BAB-\u1BAD\u1BE6\u1BE8\u1BE9\u1BED\u1BEF-\u1BF1\u1C2C-\u1C33\u1C36\u1C37\u1CD0-\u1CD2\u1CD4-\u1CE0\u1CE2-\u1CE8\u1CED\u1CF4\u1CF8\u1CF9\u1DC0-\u1DFF\u20D0-\u20DC\u20E1\u20E5-\u20F0\u2CEF-\u2CF1\u2D7F\u2DE0-\u2DFF\u302A-\u302D\u3099\u309A\uA66F\uA674-\uA67D\uA69E\uA69F\uA6F0\uA6F1\uA802\uA806\uA80B\uA825\uA826\uA82C\uA8C4\uA8C5\uA8E0-\uA8F1\uA8FF\uA926-\uA92D\uA947-\uA951\uA980-\uA982\uA9B3\uA9B6-\uA9B9\uA9BC\uA9BD\uA9E5\uAA29-\uAA2E\uAA31\uAA32\uAA35\uAA36\uAA43\uAA4C\uAA7C\uAAB0\uAAB2-\uAAB4\uAAB7\uAAB8\uAABE\uAABF\uAAC1\uAAEC\uAAED\uAAF6\uABE5\uABE8\uABED\uFB1E\uFE00-\uFE0F\uFE20-\uFE2F]|\uD800[\uDDFD\uDEE0\uDF76-\uDF7A]|\uD802[\uDE01-\uDE03\uDE05\uDE06\uDE0C-\uDE0F\uDE38-\uDE3A\uDE3F\uDEE5\uDEE6]|\uD803[\uDD24-\uDD27\uDD69-\uDD6D\uDEAB\uDEAC\uDEFC-\uDEFF\uDF46-\uDF50\uDF82-\uDF85]|\uD804[\uDC01\uDC38-\uDC46\uDC70\uDC73\uDC74\uDC7F-\uDC81\uDCB3-\uDCB6\uDCB9\uDCBA\uDCC2\uDD00-\uDD02\uDD27-\uDD2B\uDD2D-\uDD34\uDD73\uDD80\uDD81\uDDB6-\uDDBE\uDDC9-\uDDCC\uDDCF\uDE2F-\uDE31\uDE34\uDE36\uDE37\uDE3E\uDE41\uDEDF\uDEE3-\uDEEA\uDF00\uDF01\uDF3B\uDF3C\uDF40\uDF66-\uDF6C\uDF70-\uDF74\uDFBB-\uDFC0\uDFCE\uDFD0\uDFD2\uDFE1\uDFE2]|\uD805[\uDC38-\uDC3F\uDC42-\uDC44\uDC46\uDC5E\uDCB3-\uDCB8\uDCBA\uDCBF\uDCC0\uDCC2\uDCC3\uDDB2-\uDDB5\uDDBC\uDDBD\uDDBF\uDDC0\uDDDC\uDDDD\uDE33-\uDE3A\uDE3D\uDE3F\uDE40\uDEAB\uDEAD\uDEB0-\uDEB5\uDEB7\uDF1D\uDF1F\uDF22-\uDF25\uDF27-\uDF2B]|\uD806[\uDC2F-\uDC37\uDC39\uDC3A\uDD3B\uDD3C\uDD3E\uDD43\uDDD4-\uDDD7\uDDDA\uDDDB\uDDE0\uDE01-\uDE0A\uDE33-\uDE38\uDE3B-\uDE3E\uDE47\uDE51-\uDE56\uDE59-\uDE5B\uDE8A-\uDE96\uDE98\uDE99]|\uD807[\uDC30-\uDC36\uDC38-\uDC3D\uDC3F\uDC92-\uDCA7\uDCAA-\uDCB0\uDCB2\uDCB3\uDCB5\uDCB6\uDD31-\uDD36\uDD3A\uDD3C\uDD3D\uDD3F-\uDD45\uDD47\uDD90\uDD91\uDD95\uDD97\uDEF3\uDEF4\uDF00\uDF01\uDF36-\uDF3A\uDF40\uDF42\uDF5A]|\uD80D[\uDC40\uDC47-\uDC55]|\uD818[\uDD1E-\uDD29\uDD2D-\uDD2F]|\uD81A[\uDEF0-\uDEF4\uDF30-\uDF36]|\uD81B[\uDF4F\uDF8F-\uDF92\uDFE4]|\uD82F[\uDC9D\uDC9E]|\uD833[\uDF00-\uDF2D\uDF30-\uDF46]|\uD834[\uDD67-\uDD69\uDD7B-\uDD82\uDD85-\uDD8B\uDDAA-\uDDAD\uDE42-\uDE44]|\uD836[\uDE00-\uDE36\uDE3B-\uDE6C\uDE75\uDE84\uDE9B-\uDE9F\uDEA1-\uDEAF]|\uD838[\uDC00-\uDC06\uDC08-\uDC18\uDC1B-\uDC21\uDC23\uDC24\uDC26-\uDC2A\uDC8F\uDD30-\uDD36\uDEAE\uDEEC-\uDEEF]|\uD839[\uDCEC-\uDCEF\uDDEE\uDDEF]|\uD83A[\uDCD0-\uDCD6\uDD44-\uDD4A]|\uDB40[\uDD00-\uDDEF])/g,"")}_is_control(e){switch(e){case"\t":case"\n":case"\r":return!1;default:return/^[\0-\x1F\x7F-\x9F]|(?:[\xAD\u0600-\u0605\u061C\u06DD\u070F\u0890\u0891\u08E2\u180E\u200B-\u200F\u202A-\u202E\u2060-\u2064\u2066-\u206F\uFEFF\uFFF9-\uFFFB]|\uD804[\uDCBD\uDCCD]|\uD80D[\uDC30-\uDC3F]|\uD82F[\uDCA0-\uDCA3]|\uD834[\uDD73-\uDD7A]|\uDB40[\uDC01\uDC20-\uDC7F])|(?:[\uE000-\uF8FF]|[\uDB80-\uDBBE\uDBC0-\uDBFE][\uDC00-\uDFFF]|[\uDBBF\uDBFF][\uDC00-\uDFFD])|(?:[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])$/.test(e)}}_clean_text(e){const t=[];for(const n of e){const e=n.charCodeAt(0);0===e||65533===e||this._is_control(n)||(/^\s$/.test(n)?t.push(" "):t.push(n))}return t.join("")}normalize(e){return this.config.clean_text&&(e=this._clean_text(e)),this.config.handle_chinese_chars&&(e=this._tokenize_chinese_chars(e)),this.config.lowercase?(e=e.toLowerCase(),!1!==this.config.strip_accents&&(e=this.stripAccents(e))):this.config.strip_accents&&(e=this.stripAccents(e)),e}}class U extends r.Callable{static fromConfig(e){if(null===e)return null;switch(e.type){case"BertPreTokenizer":return new W(e);case"Sequence":return new me(e);case"Whitespace":return new ge(e);case"WhitespaceSplit":return new _e(e);case"Metaspace":return new pe(e);case"ByteLevel":return new G(e);case"Split":return new H(e);case"Punctuation":return new K(e);case"Digits":return new Z(e);case"Replace":return new ve(e);default:throw new Error("Unknown PreTokenizer type: ".concat(e.type))}}pre_tokenize_text(e,t){throw Error("pre_tokenize_text should be implemented in subclass.")}pre_tokenize(e,t){return(Array.isArray(e)?e.map((e=>this.pre_tokenize_text(e,t))):this.pre_tokenize_text(e,t)).flat()}_call(e,t){return this.pre_tokenize(e,t)}}class W extends U{constructor(e){super(),this.pattern=new RegExp("[^\\s".concat(v,"]+|[").concat(v,"]"),"gu")}pre_tokenize_text(e,t){return e.trim().match(this.pattern)||[]}}class G extends U{constructor(e){var t;super(),this.config=e,this.add_prefix_space=this.config.add_prefix_space,this.trim_offsets=this.config.trim_offsets,this.use_regex=null===(t=this.config.use_regex)||void 0===t||t,this.pattern=/'s|'t|'re|'ve|'m|'ll|'d| ?(?:[A-Za-z\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u0870-\u0887\u0889-\u088E\u08A0-\u08C9\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C5D\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D04-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16F1-\u16F8\u1700-\u1711\u171F-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1878\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4C\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C8A\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u31BF\u31F0-\u31FF\u3400-\u4DBF\u4E00-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA7CD\uA7D0\uA7D1\uA7D3\uA7D5-\uA7DC\uA7F2-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF2D-\uDF40\uDF42-\uDF49\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF]|\uD801[\uDC00-\uDC9D\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDD70-\uDD7A\uDD7C-\uDD8A\uDD8C-\uDD92\uDD94\uDD95\uDD97-\uDDA1\uDDA3-\uDDB1\uDDB3-\uDDB9\uDDBB\uDDBC\uDDC0-\uDDF3\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67\uDF80-\uDF85\uDF87-\uDFB0\uDFB2-\uDFBA]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDD00-\uDD23\uDD4A-\uDD65\uDD6F-\uDD85\uDE80-\uDEA9\uDEB0\uDEB1\uDEC2-\uDEC4\uDF00-\uDF1C\uDF27\uDF30-\uDF45\uDF70-\uDF81\uDFB0-\uDFC4\uDFE0-\uDFF6]|\uD804[\uDC03-\uDC37\uDC71\uDC72\uDC75\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD44\uDD47\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE3F\uDE40\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61\uDF80-\uDF89\uDF8B\uDF8E\uDF90-\uDFB5\uDFB7\uDFD1\uDFD3]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC5F-\uDC61\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDEB8\uDF00-\uDF1A\uDF40-\uDF46]|\uD806[\uDC00-\uDC2B\uDCA0-\uDCDF\uDCFF-\uDD06\uDD09\uDD0C-\uDD13\uDD15\uDD16\uDD18-\uDD2F\uDD3F\uDD41\uDDA0-\uDDA7\uDDAA-\uDDD0\uDDE1\uDDE3\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE89\uDE9D\uDEB0-\uDEF8\uDFC0-\uDFE0]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD89\uDD98\uDEE0-\uDEF2\uDF02\uDF04-\uDF10\uDF12-\uDF33\uDFB0]|\uD808[\uDC00-\uDF99]|\uD809[\uDC80-\uDD43]|\uD80B[\uDF90-\uDFF0]|[\uD80C\uD80E\uD80F\uD81C-\uD820\uD822\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879\uD880-\uD883\uD885-\uD887][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2F\uDC41-\uDC46\uDC60-\uDFFF]|\uD810[\uDC00-\uDFFA]|\uD811[\uDC00-\uDE46]|\uD818[\uDD00-\uDD1D]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE70-\uDEBE\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDD40-\uDD6C\uDE40-\uDE7F\uDF00-\uDF4A\uDF50\uDF93-\uDF9F\uDFE0\uDFE1\uDFE3]|\uD821[\uDC00-\uDFF7]|\uD823[\uDC00-\uDCD5\uDCFF-\uDD08]|\uD82B[\uDFF0-\uDFF3\uDFF5-\uDFFB\uDFFD\uDFFE]|\uD82C[\uDC00-\uDD22\uDD32\uDD50-\uDD52\uDD55\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD837[\uDF00-\uDF1E\uDF25-\uDF2A]|\uD838[\uDC30-\uDC6D\uDD00-\uDD2C\uDD37-\uDD3D\uDD4E\uDE90-\uDEAD\uDEC0-\uDEEB]|\uD839[\uDCD0-\uDCEB\uDDD0-\uDDED\uDDF0\uDFE0-\uDFE6\uDFE8-\uDFEB\uDFED\uDFEE\uDFF0-\uDFFE]|\uD83A[\uDC00-\uDCC4\uDD00-\uDD43\uDD4B]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF39\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0\uDFF0-\uDFFF]|\uD87B[\uDC00-\uDE5D]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A\uDF50-\uDFFF]|\uD888[\uDC00-\uDFAF])+| ?(?:[0-9\xB2\xB3\xB9\xBC-\xBE\u0660-\u0669\u06F0-\u06F9\u07C0-\u07C9\u0966-\u096F\u09E6-\u09EF\u09F4-\u09F9\u0A66-\u0A6F\u0AE6-\u0AEF\u0B66-\u0B6F\u0B72-\u0B77\u0BE6-\u0BF2\u0C66-\u0C6F\u0C78-\u0C7E\u0CE6-\u0CEF\u0D58-\u0D5E\u0D66-\u0D78\u0DE6-\u0DEF\u0E50-\u0E59\u0ED0-\u0ED9\u0F20-\u0F33\u1040-\u1049\u1090-\u1099\u1369-\u137C\u16EE-\u16F0\u17E0-\u17E9\u17F0-\u17F9\u1810-\u1819\u1946-\u194F\u19D0-\u19DA\u1A80-\u1A89\u1A90-\u1A99\u1B50-\u1B59\u1BB0-\u1BB9\u1C40-\u1C49\u1C50-\u1C59\u2070\u2074-\u2079\u2080-\u2089\u2150-\u2182\u2185-\u2189\u2460-\u249B\u24EA-\u24FF\u2776-\u2793\u2CFD\u3007\u3021-\u3029\u3038-\u303A\u3192-\u3195\u3220-\u3229\u3248-\u324F\u3251-\u325F\u3280-\u3289\u32B1-\u32BF\uA620-\uA629\uA6E6-\uA6EF\uA830-\uA835\uA8D0-\uA8D9\uA900-\uA909\uA9D0-\uA9D9\uA9F0-\uA9F9\uAA50-\uAA59\uABF0-\uABF9\uFF10-\uFF19]|\uD800[\uDD07-\uDD33\uDD40-\uDD78\uDD8A\uDD8B\uDEE1-\uDEFB\uDF20-\uDF23\uDF41\uDF4A\uDFD1-\uDFD5]|\uD801[\uDCA0-\uDCA9]|\uD802[\uDC58-\uDC5F\uDC79-\uDC7F\uDCA7-\uDCAF\uDCFB-\uDCFF\uDD16-\uDD1B\uDDBC\uDDBD\uDDC0-\uDDCF\uDDD2-\uDDFF\uDE40-\uDE48\uDE7D\uDE7E\uDE9D-\uDE9F\uDEEB-\uDEEF\uDF58-\uDF5F\uDF78-\uDF7F\uDFA9-\uDFAF]|\uD803[\uDCFA-\uDCFF\uDD30-\uDD39\uDD40-\uDD49\uDE60-\uDE7E\uDF1D-\uDF26\uDF51-\uDF54\uDFC5-\uDFCB]|\uD804[\uDC52-\uDC6F\uDCF0-\uDCF9\uDD36-\uDD3F\uDDD0-\uDDD9\uDDE1-\uDDF4\uDEF0-\uDEF9]|\uD805[\uDC50-\uDC59\uDCD0-\uDCD9\uDE50-\uDE59\uDEC0-\uDEC9\uDED0-\uDEE3\uDF30-\uDF3B]|\uD806[\uDCE0-\uDCF2\uDD50-\uDD59\uDFF0-\uDFF9]|\uD807[\uDC50-\uDC6C\uDD50-\uDD59\uDDA0-\uDDA9\uDF50-\uDF59\uDFC0-\uDFD4]|\uD809[\uDC00-\uDC6E]|\uD818[\uDD30-\uDD39]|\uD81A[\uDE60-\uDE69\uDEC0-\uDEC9\uDF50-\uDF59\uDF5B-\uDF61]|\uD81B[\uDD70-\uDD79\uDE80-\uDE96]|\uD833[\uDCF0-\uDCF9]|\uD834[\uDEC0-\uDED3\uDEE0-\uDEF3\uDF60-\uDF78]|\uD835[\uDFCE-\uDFFF]|\uD838[\uDD40-\uDD49\uDEF0-\uDEF9]|\uD839[\uDCF0-\uDCF9\uDDF1-\uDDFA]|\uD83A[\uDCC7-\uDCCF\uDD50-\uDD59]|\uD83B[\uDC71-\uDCAB\uDCAD-\uDCAF\uDCB1-\uDCB4\uDD01-\uDD2D\uDD2F-\uDD3D]|\uD83C[\uDD00-\uDD0C]|\uD83E[\uDFF0-\uDFF9])+| ?(?:[\0-\x08\x0E-\x1F!-\/:-@\[-`\{-\x9F\xA1-\xA9\xAB-\xB1\xB4\xB6-\xB8\xBB\xBF\xD7\xF7\u02C2-\u02C5\u02D2-\u02DF\u02E5-\u02EB\u02ED\u02EF-\u036F\u0375\u0378\u0379\u037E\u0380-\u0385\u0387\u038B\u038D\u03A2\u03F6\u0482-\u0489\u0530\u0557\u0558\u055A-\u055F\u0589-\u05CF\u05EB-\u05EE\u05F3-\u061F\u064B-\u065F\u066A-\u066D\u0670\u06D4\u06D6-\u06E4\u06E7-\u06ED\u06FD\u06FE\u0700-\u070F\u0711\u0730-\u074C\u07A6-\u07B0\u07B2-\u07BF\u07EB-\u07F3\u07F6-\u07F9\u07FB-\u07FF\u0816-\u0819\u081B-\u0823\u0825-\u0827\u0829-\u083F\u0859-\u085F\u086B-\u086F\u0888\u088F-\u089F\u08CA-\u0903\u093A-\u093C\u093E-\u094F\u0951-\u0957\u0962-\u0965\u0970\u0981-\u0984\u098D\u098E\u0991\u0992\u09A9\u09B1\u09B3-\u09B5\u09BA-\u09BC\u09BE-\u09CD\u09CF-\u09DB\u09DE\u09E2-\u09E5\u09F2\u09F3\u09FA\u09FB\u09FD-\u0A04\u0A0B-\u0A0E\u0A11\u0A12\u0A29\u0A31\u0A34\u0A37\u0A3A-\u0A58\u0A5D\u0A5F-\u0A65\u0A70\u0A71\u0A75-\u0A84\u0A8E\u0A92\u0AA9\u0AB1\u0AB4\u0ABA-\u0ABC\u0ABE-\u0ACF\u0AD1-\u0ADF\u0AE2-\u0AE5\u0AF0-\u0AF8\u0AFA-\u0B04\u0B0D\u0B0E\u0B11\u0B12\u0B29\u0B31\u0B34\u0B3A-\u0B3C\u0B3E-\u0B5B\u0B5E\u0B62-\u0B65\u0B70\u0B78-\u0B82\u0B84\u0B8B-\u0B8D\u0B91\u0B96-\u0B98\u0B9B\u0B9D\u0BA0-\u0BA2\u0BA5-\u0BA7\u0BAB-\u0BAD\u0BBA-\u0BCF\u0BD1-\u0BE5\u0BF3-\u0C04\u0C0D\u0C11\u0C29\u0C3A-\u0C3C\u0C3E-\u0C57\u0C5B\u0C5C\u0C5E\u0C5F\u0C62-\u0C65\u0C70-\u0C77\u0C7F\u0C81-\u0C84\u0C8D\u0C91\u0CA9\u0CB4\u0CBA-\u0CBC\u0CBE-\u0CDC\u0CDF\u0CE2-\u0CE5\u0CF0\u0CF3-\u0D03\u0D0D\u0D11\u0D3B\u0D3C\u0D3E-\u0D4D\u0D4F-\u0D53\u0D57\u0D62-\u0D65\u0D79\u0D80-\u0D84\u0D97-\u0D99\u0DB2\u0DBC\u0DBE\u0DBF\u0DC7-\u0DE5\u0DF0-\u0E00\u0E31\u0E34-\u0E3F\u0E47-\u0E4F\u0E5A-\u0E80\u0E83\u0E85\u0E8B\u0EA4\u0EA6\u0EB1\u0EB4-\u0EBC\u0EBE\u0EBF\u0EC5\u0EC7-\u0ECF\u0EDA\u0EDB\u0EE0-\u0EFF\u0F01-\u0F1F\u0F34-\u0F3F\u0F48\u0F6D-\u0F87\u0F8D-\u0FFF\u102B-\u103E\u104A-\u104F\u1056-\u1059\u105E-\u1060\u1062-\u1064\u1067-\u106D\u1071-\u1074\u1082-\u108D\u108F\u109A-\u109F\u10C6\u10C8-\u10CC\u10CE\u10CF\u10FB\u1249\u124E\u124F\u1257\u1259\u125E\u125F\u1289\u128E\u128F\u12B1\u12B6\u12B7\u12BF\u12C1\u12C6\u12C7\u12D7\u1311\u1316\u1317\u135B-\u1368\u137D-\u137F\u1390-\u139F\u13F6\u13F7\u13FE-\u1400\u166D\u166E\u169B-\u169F\u16EB-\u16ED\u16F9-\u16FF\u1712-\u171E\u1732-\u173F\u1752-\u175F\u176D\u1771-\u177F\u17B4-\u17D6\u17D8-\u17DB\u17DD-\u17DF\u17EA-\u17EF\u17FA-\u180F\u181A-\u181F\u1879-\u187F\u1885\u1886\u18A9\u18AB-\u18AF\u18F6-\u18FF\u191F-\u1945\u196E\u196F\u1975-\u197F\u19AC-\u19AF\u19CA-\u19CF\u19DB-\u19FF\u1A17-\u1A1F\u1A55-\u1A7F\u1A8A-\u1A8F\u1A9A-\u1AA6\u1AA8-\u1B04\u1B34-\u1B44\u1B4D-\u1B4F\u1B5A-\u1B82\u1BA1-\u1BAD\u1BE6-\u1BFF\u1C24-\u1C3F\u1C4A-\u1C4C\u1C7E\u1C7F\u1C8B-\u1C8F\u1CBB\u1CBC\u1CC0-\u1CE8\u1CED\u1CF4\u1CF7-\u1CF9\u1CFB-\u1CFF\u1DC0-\u1DFF\u1F16\u1F17\u1F1E\u1F1F\u1F46\u1F47\u1F4E\u1F4F\u1F58\u1F5A\u1F5C\u1F5E\u1F7E\u1F7F\u1FB5\u1FBD\u1FBF-\u1FC1\u1FC5\u1FCD-\u1FCF\u1FD4\u1FD5\u1FDC-\u1FDF\u1FED-\u1FF1\u1FF5\u1FFD-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u206F\u2072\u2073\u207A-\u207E\u208A-\u208F\u209D-\u2101\u2103-\u2106\u2108\u2109\u2114\u2116-\u2118\u211E-\u2123\u2125\u2127\u2129\u212E\u213A\u213B\u2140-\u2144\u214A-\u214D\u214F\u218A-\u245F\u249C-\u24E9\u2500-\u2775\u2794-\u2BFF\u2CE5-\u2CEA\u2CEF-\u2CF1\u2CF4-\u2CFC\u2CFE\u2CFF\u2D26\u2D28-\u2D2C\u2D2E\u2D2F\u2D68-\u2D6E\u2D70-\u2D7F\u2D97-\u2D9F\u2DA7\u2DAF\u2DB7\u2DBF\u2DC7\u2DCF\u2DD7\u2DDF-\u2E2E\u2E30-\u2FFF\u3001-\u3004\u3008-\u3020\u302A-\u3030\u3036\u3037\u303D-\u3040\u3097-\u309C\u30A0\u30FB\u3100-\u3104\u3130\u318F-\u3191\u3196-\u319F\u31C0-\u31EF\u3200-\u321F\u322A-\u3247\u3250\u3260-\u327F\u328A-\u32B0\u32C0-\u33FF\u4DC0-\u4DFF\uA48D-\uA4CF\uA4FE\uA4FF\uA60D-\uA60F\uA62C-\uA63F\uA66F-\uA67E\uA69E\uA69F\uA6F0-\uA716\uA720\uA721\uA789\uA78A\uA7CE\uA7CF\uA7D2\uA7D4\uA7DD-\uA7F1\uA802\uA806\uA80B\uA823-\uA82F\uA836-\uA83F\uA874-\uA881\uA8B4-\uA8CF\uA8DA-\uA8F1\uA8F8-\uA8FA\uA8FC\uA8FF\uA926-\uA92F\uA947-\uA95F\uA97D-\uA983\uA9B3-\uA9CE\uA9DA-\uA9DF\uA9E5\uA9FF\uAA29-\uAA3F\uAA43\uAA4C-\uAA4F\uAA5A-\uAA5F\uAA77-\uAA79\uAA7B-\uAA7D\uAAB0\uAAB2-\uAAB4\uAAB7\uAAB8\uAABE\uAABF\uAAC1\uAAC3-\uAADA\uAADE\uAADF\uAAEB-\uAAF1\uAAF5-\uAB00\uAB07\uAB08\uAB0F\uAB10\uAB17-\uAB1F\uAB27\uAB2F\uAB5B\uAB6A-\uAB6F\uABE3-\uABEF\uABFA-\uABFF\uD7A4-\uD7AF\uD7C7-\uD7CA\uD7FC-\uD7FF\uE000-\uF8FF\uFA6E\uFA6F\uFADA-\uFAFF\uFB07-\uFB12\uFB18-\uFB1C\uFB1E\uFB29\uFB37\uFB3D\uFB3F\uFB42\uFB45\uFBB2-\uFBD2\uFD3E-\uFD4F\uFD90\uFD91\uFDC8-\uFDEF\uFDFC-\uFE6F\uFE75\uFEFD\uFEFE\uFF00-\uFF0F\uFF1A-\uFF20\uFF3B-\uFF40\uFF5B-\uFF65\uFFBF-\uFFC1\uFFC8\uFFC9\uFFD0\uFFD1\uFFD8\uFFD9\uFFDD-\uFFFF]|\uD800[\uDC0C\uDC27\uDC3B\uDC3E\uDC4E\uDC4F\uDC5E-\uDC7F\uDCFB-\uDD06\uDD34-\uDD3F\uDD79-\uDD89\uDD8C-\uDE7F\uDE9D-\uDE9F\uDED1-\uDEE0\uDEFC-\uDEFF\uDF24-\uDF2C\uDF4B-\uDF4F\uDF76-\uDF7F\uDF9E\uDF9F\uDFC4-\uDFC7\uDFD0\uDFD6-\uDFFF]|\uD801[\uDC9E\uDC9F\uDCAA-\uDCAF\uDCD4-\uDCD7\uDCFC-\uDCFF\uDD28-\uDD2F\uDD64-\uDD6F\uDD7B\uDD8B\uDD93\uDD96\uDDA2\uDDB2\uDDBA\uDDBD-\uDDBF\uDDF4-\uDDFF\uDF37-\uDF3F\uDF56-\uDF5F\uDF68-\uDF7F\uDF86\uDFB1\uDFBB-\uDFFF]|\uD802[\uDC06\uDC07\uDC09\uDC36\uDC39-\uDC3B\uDC3D\uDC3E\uDC56\uDC57\uDC77\uDC78\uDC9F-\uDCA6\uDCB0-\uDCDF\uDCF3\uDCF6-\uDCFA\uDD1C-\uDD1F\uDD3A-\uDD7F\uDDB8-\uDDBB\uDDD0\uDDD1\uDE01-\uDE0F\uDE14\uDE18\uDE36-\uDE3F\uDE49-\uDE5F\uDE7F\uDEA0-\uDEBF\uDEC8\uDEE5-\uDEEA\uDEF0-\uDEFF\uDF36-\uDF3F\uDF56\uDF57\uDF73-\uDF77\uDF92-\uDFA8\uDFB0-\uDFFF]|\uD803[\uDC49-\uDC7F\uDCB3-\uDCBF\uDCF3-\uDCF9\uDD24-\uDD2F\uDD3A-\uDD3F\uDD66-\uDD6E\uDD86-\uDE5F\uDE7F\uDEAA-\uDEAF\uDEB2-\uDEC1\uDEC5-\uDEFF\uDF28-\uDF2F\uDF46-\uDF50\uDF55-\uDF6F\uDF82-\uDFAF\uDFCC-\uDFDF\uDFF7-\uDFFF]|\uD804[\uDC00-\uDC02\uDC38-\uDC51\uDC70\uDC73\uDC74\uDC76-\uDC82\uDCB0-\uDCCF\uDCE9-\uDCEF\uDCFA-\uDD02\uDD27-\uDD35\uDD40-\uDD43\uDD45\uDD46\uDD48-\uDD4F\uDD73-\uDD75\uDD77-\uDD82\uDDB3-\uDDC0\uDDC5-\uDDCF\uDDDB\uDDDD-\uDDE0\uDDF5-\uDDFF\uDE12\uDE2C-\uDE3E\uDE41-\uDE7F\uDE87\uDE89\uDE8E\uDE9E\uDEA9-\uDEAF\uDEDF-\uDEEF\uDEFA-\uDF04\uDF0D\uDF0E\uDF11\uDF12\uDF29\uDF31\uDF34\uDF3A-\uDF3C\uDF3E-\uDF4F\uDF51-\uDF5C\uDF62-\uDF7F\uDF8A\uDF8C\uDF8D\uDF8F\uDFB6\uDFB8-\uDFD0\uDFD2\uDFD4-\uDFFF]|\uD805[\uDC35-\uDC46\uDC4B-\uDC4F\uDC5A-\uDC5E\uDC62-\uDC7F\uDCB0-\uDCC3\uDCC6\uDCC8-\uDCCF\uDCDA-\uDD7F\uDDAF-\uDDD7\uDDDC-\uDDFF\uDE30-\uDE43\uDE45-\uDE4F\uDE5A-\uDE7F\uDEAB-\uDEB7\uDEB9-\uDEBF\uDECA-\uDECF\uDEE4-\uDEFF\uDF1B-\uDF2F\uDF3C-\uDF3F\uDF47-\uDFFF]|\uD806[\uDC2C-\uDC9F\uDCF3-\uDCFE\uDD07\uDD08\uDD0A\uDD0B\uDD14\uDD17\uDD30-\uDD3E\uDD40\uDD42-\uDD4F\uDD5A-\uDD9F\uDDA8\uDDA9\uDDD1-\uDDE0\uDDE2\uDDE4-\uDDFF\uDE01-\uDE0A\uDE33-\uDE39\uDE3B-\uDE4F\uDE51-\uDE5B\uDE8A-\uDE9C\uDE9E-\uDEAF\uDEF9-\uDFBF\uDFE1-\uDFEF\uDFFA-\uDFFF]|\uD807[\uDC09\uDC2F-\uDC3F\uDC41-\uDC4F\uDC6D-\uDC71\uDC90-\uDCFF\uDD07\uDD0A\uDD31-\uDD45\uDD47-\uDD4F\uDD5A-\uDD5F\uDD66\uDD69\uDD8A-\uDD97\uDD99-\uDD9F\uDDAA-\uDEDF\uDEF3-\uDF01\uDF03\uDF11\uDF34-\uDF4F\uDF5A-\uDFAF\uDFB1-\uDFBF\uDFD5-\uDFFF]|\uD808[\uDF9A-\uDFFF]|\uD809[\uDC6F-\uDC7F\uDD44-\uDFFF]|[\uD80A\uD812-\uD817\uD819\uD824-\uD82A\uD82D\uD82E\uD830-\uD832\uD836\uD83D\uD83F\uD87C\uD87D\uD87F\uD889-\uDBFF][\uDC00-\uDFFF]|\uD80B[\uDC00-\uDF8F\uDFF1-\uDFFF]|\uD80D[\uDC30-\uDC40\uDC47-\uDC5F]|\uD810[\uDFFB-\uDFFF]|\uD811[\uDE47-\uDFFF]|\uD818[\uDC00-\uDCFF\uDD1E-\uDD2F\uDD3A-\uDFFF]|\uD81A[\uDE39-\uDE3F\uDE5F\uDE6A-\uDE6F\uDEBF\uDECA-\uDECF\uDEEE-\uDEFF\uDF30-\uDF3F\uDF44-\uDF4F\uDF5A\uDF62\uDF78-\uDF7C\uDF90-\uDFFF]|\uD81B[\uDC00-\uDD3F\uDD6D-\uDD6F\uDD7A-\uDE3F\uDE97-\uDEFF\uDF4B-\uDF4F\uDF51-\uDF92\uDFA0-\uDFDF\uDFE2\uDFE4-\uDFFF]|\uD821[\uDFF8-\uDFFF]|\uD823[\uDCD6-\uDCFE\uDD09-\uDFFF]|\uD82B[\uDC00-\uDFEF\uDFF4\uDFFC\uDFFF]|\uD82C[\uDD23-\uDD31\uDD33-\uDD4F\uDD53\uDD54\uDD56-\uDD63\uDD68-\uDD6F\uDEFC-\uDFFF]|\uD82F[\uDC6B-\uDC6F\uDC7D-\uDC7F\uDC89-\uDC8F\uDC9A-\uDFFF]|\uD833[\uDC00-\uDCEF\uDCFA-\uDFFF]|\uD834[\uDC00-\uDEBF\uDED4-\uDEDF\uDEF4-\uDF5F\uDF79-\uDFFF]|\uD835[\uDC55\uDC9D\uDCA0\uDCA1\uDCA3\uDCA4\uDCA7\uDCA8\uDCAD\uDCBA\uDCBC\uDCC4\uDD06\uDD0B\uDD0C\uDD15\uDD1D\uDD3A\uDD3F\uDD45\uDD47-\uDD49\uDD51\uDEA6\uDEA7\uDEC1\uDEDB\uDEFB\uDF15\uDF35\uDF4F\uDF6F\uDF89\uDFA9\uDFC3\uDFCC\uDFCD]|\uD837[\uDC00-\uDEFF\uDF1F-\uDF24\uDF2B-\uDFFF]|\uD838[\uDC00-\uDC2F\uDC6E-\uDCFF\uDD2D-\uDD36\uDD3E\uDD3F\uDD4A-\uDD4D\uDD4F-\uDE8F\uDEAE-\uDEBF\uDEEC-\uDEEF\uDEFA-\uDFFF]|\uD839[\uDC00-\uDCCF\uDCEC-\uDCEF\uDCFA-\uDDCF\uDDEE\uDDEF\uDDFB-\uDFDF\uDFE7\uDFEC\uDFEF\uDFFF]|\uD83A[\uDCC5\uDCC6\uDCD0-\uDCFF\uDD44-\uDD4A\uDD4C-\uDD4F\uDD5A-\uDFFF]|\uD83B[\uDC00-\uDC70\uDCAC\uDCB0\uDCB5-\uDD00\uDD2E\uDD3E-\uDDFF\uDE04\uDE20\uDE23\uDE25\uDE26\uDE28\uDE33\uDE38\uDE3A\uDE3C-\uDE41\uDE43-\uDE46\uDE48\uDE4A\uDE4C\uDE50\uDE53\uDE55\uDE56\uDE58\uDE5A\uDE5C\uDE5E\uDE60\uDE63\uDE65\uDE66\uDE6B\uDE73\uDE78\uDE7D\uDE7F\uDE8A\uDE9C-\uDEA0\uDEA4\uDEAA\uDEBC-\uDFFF]|\uD83C[\uDC00-\uDCFF\uDD0D-\uDFFF]|\uD83E[\uDC00-\uDFEF\uDFFA-\uDFFF]|\uD869[\uDEE0-\uDEFF]|\uD86D[\uDF3A-\uDF3F]|\uD86E[\uDC1E\uDC1F]|\uD873[\uDEA2-\uDEAF]|\uD87A[\uDFE1-\uDFEF]|\uD87B[\uDE5E-\uDFFF]|\uD87E[\uDE1E-\uDFFF]|\uD884[\uDF4B-\uDF4F]|\uD888[\uDFB0-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+|[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+(?!(?:[\0-\x08\x0E-\x1F!-\x9F\xA1-\u167F\u1681-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2FFF\u3001-\uD7FF\uE000-\uFEFE\uFF00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]))|[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+/g,this.byte_encoder=S,this.text_encoder=new TextEncoder}pre_tokenize_text(e,t){this.add_prefix_space&&!e.startsWith(" ")&&(e=" "+e);return(this.use_regex?e.match(this.pattern)||[]:[e]).map((e=>Array.from(this.text_encoder.encode(e),(e=>this.byte_encoder[e])).join("")))}}class H extends U{constructor(e){super(),this.config=e,this.pattern=p(this.config.pattern,this.config.invert)}pre_tokenize_text(e,t){var n;return null===this.pattern?[]:this.config.invert?e.match(this.pattern)||[]:"removed"===(null===(n=this.config.behavior)||void 0===n?void 0:n.toLowerCase())?e.split(this.pattern).filter((e=>e)):function(e,t){const n=[];let r=0;for(const o of e.matchAll(t)){const t=o[0];r<o.index&&n.push(e.slice(r,o.index)),t.length>0&&n.push(t),r=o.index+t.length}return r<e.length&&n.push(e.slice(r)),n}(e,this.pattern)}}class K extends U{constructor(e){super(),this.config=e,this.pattern=new RegExp("[^".concat(v,"]+|[").concat(v,"]+"),"gu")}pre_tokenize_text(e,t){return e.match(this.pattern)||[]}}class Z extends U{constructor(e){super(),this.config=e;const t="[^\\d]+|\\d".concat(this.config.individual_digits?"":"+");this.pattern=new RegExp(t,"gu")}pre_tokenize_text(e,t){return e.match(this.pattern)||[]}}class $ extends r.Callable{constructor(e){super(),this.config=e}static fromConfig(e){if(null===e)return null;switch(e.type){case"TemplateProcessing":return new Q(e);case"ByteLevel":return new Y(e);case"RobertaProcessing":return new J(e);case"BertProcessing":return new X(e);case"Sequence":return new ee(e);default:throw new Error("Unknown PostProcessor type: ".concat(e.type))}}post_process(e){throw Error("post_process should be implemented in subclass.")}_call(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return this.post_process(e,...n)}}class X extends ${constructor(e){super(e),this.cls=e.cls[0],this.sep=e.sep[0]}post_process(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,{add_special_tokens:n=!0}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};n&&(e=(0,o.mergeArrays)([this.cls],e,[this.sep]));let r=new Array(e.length).fill(0);if(null!==t){const a=n&&this instanceof J?[this.sep]:[],i=n?[this.sep]:[];e=(0,o.mergeArrays)(e,a,t,i),r=(0,o.mergeArrays)(r,new Array(t.length+a.length+i.length).fill(1))}return{tokens:e,token_type_ids:r}}}class J extends X{}class Q extends ${constructor(e){super(e),this.single=e.single,this.pair=e.pair}post_process(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,{add_special_tokens:n=!0}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=null===t?this.single:this.pair;let a=[],i=[];for(const s of r)"SpecialToken"in s?n&&(a.push(s.SpecialToken.id),i.push(s.SpecialToken.type_id)):"Sequence"in s&&("A"===s.Sequence.id?(a=(0,o.mergeArrays)(a,e),i=(0,o.mergeArrays)(i,new Array(e.length).fill(s.Sequence.type_id))):"B"===s.Sequence.id&&(a=(0,o.mergeArrays)(a,t),i=(0,o.mergeArrays)(i,new Array(t.length).fill(s.Sequence.type_id))));return{tokens:a,token_type_ids:i}}}class Y extends ${post_process(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return t&&(e=(0,o.mergeArrays)(e,t)),{tokens:e}}}class ee extends ${constructor(e){super(e),this.processors=e.processors.map((e=>$.fromConfig(e)))}post_process(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};for(const o of this.processors)if(o instanceof Y){if(e=o.post_process(e).tokens,n){n=o.post_process(n).tokens}}else{const a=o.post_process(e,n,r);e=a.tokens,t=a.token_type_ids}return{tokens:e,token_type_ids:t}}}class te extends r.Callable{constructor(e){super(),this.config=e,this.added_tokens=[],this.end_of_word_suffix=null,this.trim_offsets=e.trim_offsets}static fromConfig(e){if(null===e)return null;switch(e.type){case"WordPiece":return new ie(e);case"Metaspace":return new he(e);case"ByteLevel":return new se(e);case"Replace":return new ne(e);case"ByteFallback":return new re(e);case"Fuse":return new oe(e);case"Strip":return new ae(e);case"Sequence":return new ce(e);case"CTC":return new le(e);case"BPEDecoder":return new ue(e);default:throw new Error("Unknown Decoder type: ".concat(e.type))}}_call(e){return this.decode(e)}decode(e){return this.decode_chain(e).join("")}decode_chain(e){throw Error("`decode_chain` should be implemented in subclass.")}}class ne extends te{decode_chain(e){const t=p(this.config.pattern);return null===t?e:e.map((e=>e.replaceAll(t,this.config.content)))}}class re extends te{constructor(e){super(e),this.text_decoder=new TextDecoder}decode_chain(e){const t=[];let n=[];for(const r of e){let e=null;if(6===r.length&&r.startsWith("<0x")&&r.endsWith(">")){const t=parseInt(r.slice(3,5),16);isNaN(t)||(e=t)}if(null!==e)n.push(e);else{if(n.length>0){const e=this.text_decoder.decode(Uint8Array.from(n));t.push(e),n=[]}t.push(r)}}if(n.length>0){const e=this.text_decoder.decode(Uint8Array.from(n));t.push(e),n=[]}return t}}class oe extends te{decode_chain(e){return[e.join("")]}}class ae extends te{constructor(e){super(e),this.content=this.config.content,this.start=this.config.start,this.stop=this.config.stop}decode_chain(e){return e.map((e=>{let t=0;for(let r=0;r<this.start&&e[r]===this.content;++r)t=r+1;let n=e.length;for(let r=0;r<this.stop;++r){const t=e.length-r-1;if(e[t]!==this.content)break;n=t}return e.slice(t,n)}))}}class ie extends te{constructor(e){super(e),this.cleanup=e.cleanup}decode_chain(e){return e.map(((e,t)=>(0!==t&&(e=e.startsWith(this.config.prefix)?e.replace(this.config.prefix,""):" "+e),this.cleanup&&(e=m(e)),e)))}}class se extends te{constructor(e){super(e),this.byte_decoder=E,this.text_decoder=new TextDecoder("utf-8",{fatal:!1,ignoreBOM:!0}),this.end_of_word_suffix=null}convert_tokens_to_string(e){const t=e.join(""),n=new Uint8Array([...t].map((e=>this.byte_decoder[e])));return this.text_decoder.decode(n)}decode_chain(e){const t=[];let n=[];for(const r of e)void 0!==this.added_tokens.find((e=>e.content===r))?(n.length>0&&(t.push(this.convert_tokens_to_string(n)),n=[]),t.push(r)):n.push(r);return n.length>0&&t.push(this.convert_tokens_to_string(n)),t}}class le extends te{constructor(e){super(e),this.pad_token=this.config.pad_token,this.word_delimiter_token=this.config.word_delimiter_token,this.cleanup=this.config.cleanup}convert_tokens_to_string(e){if(0===e.length)return"";const t=[e[0]];for(let o=1;o<e.length;++o)e[o]!==t.at(-1)&&t.push(e[o]);const n=t.filter((e=>e!==this.pad_token));let r=n.join("");return this.cleanup&&(r=m(r).replaceAll(this.word_delimiter_token," ").trim()),r}decode_chain(e){return[this.convert_tokens_to_string(e)]}}class ce extends te{constructor(e){super(e),this.decoders=e.decoders.map((e=>te.fromConfig(e)))}decode_chain(e){return this.decoders.reduce(((e,t)=>t.decode_chain(e)),e)}}class ue extends te{constructor(e){super(e),this.suffix=this.config.suffix}decode_chain(e){return e.map(((t,n)=>t.replaceAll(this.suffix,n===e.length-1?"":" ")))}}class de extends te{decode_chain(e){let t="";for(let n=1;n<e.length;n+=2)t+=e[n];return[t]}}class pe extends U{constructor(e){var t;super(),this.addPrefixSpace=e.add_prefix_space,this.replacement=e.replacement,this.strRep=e.str_rep||this.replacement,this.prepend_scheme=null!==(t=e.prepend_scheme)&&void 0!==t?t:"always"}pre_tokenize_text(e){let{section_index:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.replaceAll(" ",this.strRep);return this.addPrefixSpace&&!n.startsWith(this.replacement)&&("always"===this.prepend_scheme||"first"===this.prepend_scheme&&0===t)&&(n=this.strRep+n),[n]}}class he extends te{constructor(e){super(e),this.addPrefixSpace=e.add_prefix_space,this.replacement=e.replacement}decode_chain(e){const t=[];for(let n=0;n<e.length;++n){let r=e[n].replaceAll(this.replacement," ");this.addPrefixSpace&&0==n&&r.startsWith(" ")&&(r=r.substring(1)),t.push(r)}return t}}class fe extends M{constructor(e){super(e),this.charsmap=e.precompiled_charsmap}normalize(e){if((e=(e=e.replace(/[\u0001-\u0008\u000B\u000E-\u001F\u007F\u008F\u009F]/gm,"")).replace(/[\u0009\u000A\u000C\u000D\u00A0\u1680\u2000-\u200F\u2028\u2029\u202F\u205F\u2581\u3000\uFEFF\uFFFD]/gm," ")).includes("\uff5e")){const t=e.split("\uff5e");e=t.map((e=>e.normalize("NFKC"))).join("\uff5e")}else e=e.normalize("NFKC");return e}}class me extends U{constructor(e){super(),this.tokenizers=e.pretokenizers.map((e=>U.fromConfig(e)))}pre_tokenize_text(e,t){return this.tokenizers.reduce(((e,n)=>n.pre_tokenize(e,t)),[e])}}class ge extends U{constructor(e){super()}pre_tokenize_text(e,t){return e.match(/\w+|[^\w\s]+/g)||[]}}class _e extends U{constructor(e){super()}pre_tokenize_text(e,t){return function(e){return e.match(/\S+/g)||[]}(e)}}class ve extends U{constructor(e){super(),this.config=e,this.pattern=p(this.config.pattern),this.content=this.config.content}pre_tokenize_text(e,t){return null===this.pattern?[e]:[e.replaceAll(this.pattern,this.config.content)]}}const ye=["bos_token","eos_token","unk_token","sep_token","pad_token","cls_token","mask_token"];function we(e,t,n,r){for(const a of Object.keys(e)){const i=t-e[a].length,s=n(a),l=new Array(i).fill(s);e[a]="right"===r?(0,o.mergeArrays)(e[a],l):(0,o.mergeArrays)(l,e[a])}}function be(e,t){for(const n of Object.keys(e))e[n].length=t}class xe extends r.Callable{constructor(e,t){var n,r,o,a;super(),ao(this,"return_token_type_ids",!1),ao(this,"padding_side","right"),this._tokenizer_config=t,this.normalizer=M.fromConfig(e.normalizer),this.pre_tokenizer=U.fromConfig(e.pre_tokenizer),this.model=k.fromConfig(e.model,t),this.post_processor=$.fromConfig(e.post_processor),this.decoder=te.fromConfig(e.decoder),this.special_tokens=[],this.all_special_ids=[],this.added_tokens=[];for(const i of e.added_tokens){const e=new x(i);this.added_tokens.push(e),this.model.tokens_to_ids.set(e.content,e.id),this.model.vocab[e.id]=e.content,e.special&&(this.special_tokens.push(e.content),this.all_special_ids.push(e.id))}if(this.additional_special_tokens=null!==(n=t.additional_special_tokens)&&void 0!==n?n:[],this.special_tokens.push(...this.additional_special_tokens),this.special_tokens=[...new Set(this.special_tokens)],this.decoder&&(this.decoder.added_tokens=this.added_tokens,this.decoder.end_of_word_suffix=this.model.end_of_word_suffix),this.added_tokens_splitter=new l.DictionarySplitter(this.added_tokens.map((e=>e.content))),this.added_tokens_map=new Map(this.added_tokens.map((e=>[e.content,e]))),this.mask_token=this.getToken("mask_token"),this.mask_token_id=this.model.tokens_to_ids.get(this.mask_token),this.pad_token=this.getToken("pad_token","eos_token"),this.pad_token_id=this.model.tokens_to_ids.get(this.pad_token),this.sep_token=this.getToken("sep_token"),this.sep_token_id=this.model.tokens_to_ids.get(this.sep_token),this.unk_token=this.getToken("unk_token"),this.unk_token_id=this.model.tokens_to_ids.get(this.unk_token),this.bos_token=this.getToken("bos_token"),this.bos_token_id=this.model.tokens_to_ids.get(this.bos_token),this.eos_token=this.getToken("eos_token"),this.eos_token_id=this.model.tokens_to_ids.get(this.eos_token),this.model_max_length=t.model_max_length,this.remove_space=t.remove_space,this.clean_up_tokenization_spaces=null===(r=t.clean_up_tokenization_spaces)||void 0===r||r,this.do_lowercase_and_remove_accent=null!==(o=t.do_lowercase_and_remove_accent)&&void 0!==o&&o,t.padding_side&&(this.padding_side=t.padding_side),this.legacy=!1,this.chat_template=null!==(a=t.chat_template)&&void 0!==a?a:null,Array.isArray(this.chat_template)){const e=Object.create(null);for(const{name:t,template:n}of this.chat_template){if("string"!==typeof t||"string"!==typeof n)throw new Error('Chat template must be a list of objects with "name" and "template" properties');e[t]=n}this.chat_template=e}this._compiled_template_cache=new Map}getToken(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(const r of t){const e=this._tokenizer_config[r];if(e){if("object"===typeof e){if("AddedToken"===e.__type)return e.content;throw Error("Unknown token: ".concat(e))}return e}}return null}static async from_pretrained(e){let{progress_callback:t=null,config:n=null,cache_dir:r=null,local_files_only:o=!1,revision:a="main",legacy:i=null}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new this(...await d(e,{progress_callback:t,config:n,cache_dir:r,local_files_only:o,revision:a,legacy:i}))}_call(e){var t;let{text_pair:n=null,add_special_tokens:r=!0,padding:o=!1,truncation:a=null,max_length:l=null,return_tensor:c=!0,return_token_type_ids:u=null}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const d=Array.isArray(e);let p;if(d){if(0===e.length)throw Error("text array must be non-empty");if(null!==n){if(!Array.isArray(n))throw Error("text_pair must also be an array");if(e.length!==n.length)throw Error("text and text_pair must have the same length");p=e.map(((e,t)=>this._encode_plus(e,{text_pair:n[t],add_special_tokens:r,return_token_type_ids:u})))}else p=e.map((e=>this._encode_plus(e,{add_special_tokens:r,return_token_type_ids:u})))}else{if(null===e||void 0===e)throw Error("text may not be null or undefined");if(Array.isArray(n))throw Error("When specifying `text_pair`, since `text` is a string, `text_pair` must also be a string (i.e., not an array).");p=[this._encode_plus(e,{text_pair:n,add_special_tokens:r,return_token_type_ids:u})]}if(null===l?l=this.model_max_length:null===a&&(!0===o?(console.warn("`max_length` is ignored when `padding: true` and there is no truncation strategy. To pad to max length, use `padding: 'max_length'`."),l=this.model_max_length):!1===o&&(console.warn("Truncation was not explicitly activated but `max_length` is provided a specific value, please use `truncation: true` to explicitly truncate examples to max length."),a=!0)),!0===o&&(l=Math.min((0,i.max)(p.map((e=>e.input_ids.length)))[0],null!==l&&void 0!==l?l:1/0)),l=Math.min(l,null!==(t=this.model_max_length)&&void 0!==t?t:1/0),o||a)for(let i=0;i<p.length;++i)p[i].input_ids.length!==l&&(p[i].input_ids.length>l?a&&be(p[i],l):o&&we(p[i],l,(e=>"input_ids"===e?this.pad_token_id:0),this.padding_side));const h={};if(c){if((!o||!a)&&p.some((e=>{for(const n of Object.keys(e)){var t;if(e[n].length!==(null===(t=p[0][n])||void 0===t?void 0:t.length))return!0}return!1})))throw Error("Unable to create tensor, you should probably activate truncation and/or padding with 'padding=true' and 'truncation=true' to have batched tensors with the same length.");const e=[p.length,p[0].input_ids.length];for(const t of Object.keys(p[0]))h[t]=new s.Tensor("int64",BigInt64Array.from(p.flatMap((e=>e[t])).map(BigInt)),e)}else{for(const e of Object.keys(p[0]))h[e]=p.map((t=>t[e]));if(!d)for(const e of Object.keys(h))h[e]=h[e][0]}return h}_encode_text(e){if(null===e)return null;const t=this.added_tokens_splitter.split(e);for(let r=0;r<t.length;++r){const e=this.added_tokens_map.get(t[r]);e&&(e.lstrip&&r>0&&(t[r-1]=t[r-1].trimEnd()),e.rstrip&&r<t.length-1&&(t[r+1]=t[r+1].trimStart()))}const n=t.flatMap(((e,t)=>{if(0===e.length)return[];if(this.added_tokens_map.has(e))return[e];if(!0===this.remove_space&&(e=e.trim().split(/\s+/).join(" ")),this.do_lowercase_and_remove_accent&&(e=function(e){return g(e.toLowerCase())}(e)),null!==this.normalizer&&(e=this.normalizer(e)),0===e.length)return[];const n=null!==this.pre_tokenizer?this.pre_tokenizer(e,{section_index:t}):[e];return this.model(n)}));return n}_encode_plus(e){let{text_pair:t=null,add_special_tokens:n=!0,return_token_type_ids:r=null}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{tokens:o,token_type_ids:a}=this._tokenize_helper(e,{pair:t,add_special_tokens:n}),i=this.model.convert_tokens_to_ids(o),s={input_ids:i,attention_mask:new Array(i.length).fill(1)};return(null!==r&&void 0!==r?r:this.return_token_type_ids)&&a&&(s.token_type_ids=a),s}_tokenize_helper(e){let{pair:t=null,add_special_tokens:n=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const r=this._encode_text(e),a=this._encode_text(t);return this.post_processor?this.post_processor(r,a,{add_special_tokens:n}):{tokens:(0,o.mergeArrays)(null!==r&&void 0!==r?r:[],null!==a&&void 0!==a?a:[])}}tokenize(e){let{pair:t=null,add_special_tokens:n=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this._tokenize_helper(e,{pair:t,add_special_tokens:n}).tokens}encode(e){let{text_pair:t=null,add_special_tokens:n=!0,return_token_type_ids:r=null}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this._encode_plus(e,{text_pair:t,add_special_tokens:n,return_token_type_ids:r}).input_ids}batch_decode(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e instanceof s.Tensor&&(e=e.tolist()),e.map((e=>this.decode(e,t)))}decode(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(e instanceof s.Tensor&&(e=f(e)),!Array.isArray(e)||0===e.length||!(0,o.isIntegralNumber)(e[0]))throw Error("token_ids must be a non-empty array of integers.");return this.decode_single(e,t)}decode_single(e,t){let{skip_special_tokens:n=!1,clean_up_tokenization_spaces:r=null}=t,o=this.model.convert_ids_to_tokens(e);n&&(o=o.filter((e=>!this.special_tokens.includes(e))));let a=this.decoder?this.decoder(o):o.join(" ");return this.decoder&&this.decoder.end_of_word_suffix&&(a=a.replaceAll(this.decoder.end_of_word_suffix," "),n&&(a=a.trim())),(null!==r&&void 0!==r?r:this.clean_up_tokenization_spaces)&&(a=m(a)),a}get_chat_template(){let{chat_template:e=null,tools:t=null}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this.chat_template&&"object"===typeof this.chat_template){const n=this.chat_template;if(null!==e&&Object.hasOwn(n,e))e=n[e];else if(null===e)if(null!==t&&"tool_use"in n)e=n.tool_use;else{if(!("default"in n))throw Error("This model has multiple chat templates with no default specified! Please either pass a chat template or the name of the template you wish to use to the 'chat_template' argument. Available "+"template names are ".concat(Object.keys(n).sort(),"."));e=n.default}}else if(null===e){if(!this.chat_template)throw Error("Cannot use apply_chat_template() because tokenizer.chat_template is not set and no template argument was passed! For information about writing templates and setting the tokenizer.chat_template attribute, please see the documentation at https://huggingface.co/docs/transformers/main/en/chat_templating");e=this.chat_template}return e}apply_chat_template(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{tools:n=null,documents:r=null,chat_template:o=null,add_generation_prompt:a=!1,tokenize:i=!0,padding:s=!1,truncation:l=!1,max_length:u=null,return_tensor:d=!0,return_dict:p=!1,tokenizer_kwargs:h={}}=t,f=Kc(t,eB);if(o=this.get_chat_template({chat_template:o,tools:n}),"string"!==typeof o)throw Error("chat_template must be a string, but got ".concat(typeof o));let m=this._compiled_template_cache.get(o);void 0===m&&(m=new c.Template(o),this._compiled_template_cache.set(o,m));const g=Object.create(null);for(const c of ye){const e=this.getToken(c);e&&(g[c]=e)}const _=m.render(so(so({messages:e,add_generation_prompt:a,tools:n,documents:r},g),f));if(i){const e=this._call(_,so({add_special_tokens:!1,padding:s,truncation:l,max_length:u,return_tensor:d},h));return p?e:e.input_ids}return _}}class ke extends xe{constructor(){super(...arguments),ao(this,"return_token_type_ids",!0)}}class Ce extends xe{constructor(){super(...arguments),ao(this,"return_token_type_ids",!0)}}class De extends xe{constructor(){super(...arguments),ao(this,"return_token_type_ids",!0)}}class Se extends xe{constructor(){super(...arguments),ao(this,"return_token_type_ids",!0)}}class Ee extends xe{constructor(){super(...arguments),ao(this,"return_token_type_ids",!0)}}class Te extends xe{constructor(){super(...arguments),ao(this,"return_token_type_ids",!0)}}class Ae extends xe{constructor(){super(...arguments),ao(this,"return_token_type_ids",!0)}}class Me extends xe{constructor(){super(...arguments),ao(this,"return_token_type_ids",!0)}}class Fe extends xe{constructor(){super(...arguments),ao(this,"return_token_type_ids",!0)}}class Ie extends xe{}class Pe extends xe{}class ze extends xe{constructor(e,t){super(e,t),ao(this,"return_token_type_ids",!0),console.warn('WARNING: `XLMTokenizer` is not yet supported by Hugging Face\'s "fast" tokenizers library. Therefore, you may experience slightly inaccurate results.')}}class Oe extends xe{constructor(){super(...arguments),ao(this,"return_token_type_ids",!0)}}class Ne extends xe{}class Be extends xe{}class je extends xe{}class Le extends xe{constructor(e,t){super(e,t),this.languageRegex=/^[a-z]{2}_[A-Z]{2}$/,this.language_codes=this.special_tokens.filter((e=>this.languageRegex.test(e))),this.lang_to_token=e=>e}_build_translation_inputs(e,t,n){return et(this,e,t,n)}}class Re extends Le{}class Ve extends xe{}class qe extends xe{}const Ue="\u2581";class We extends xe{constructor(e,t){var n;super(e,t),ao(this,"padding_side","left"),this.legacy=null===(n=t.legacy)||void 0===n||n,this.legacy||(this.normalizer=null,this.pre_tokenizer=new pe({replacement:Ue,add_prefix_space:!0,prepend_scheme:"first"}))}_encode_text(e){if(null===e)return null;if(this.legacy||0===e.length)return super._encode_text(e);let t=super._encode_text(Ue+e.replaceAll(Ue," "));return t.length>1&&t[0]===Ue&&this.special_tokens.includes(t[1])&&(t=t.slice(1)),t}}class Ge extends xe{}class He extends xe{}class Ke extends xe{}class Ze extends xe{}class $e extends xe{}class Xe extends xe{}class Je extends xe{}class Qe extends xe{}class Ye extends xe{}function et(e,t,n,r){if(!("language_codes"in e)||!Array.isArray(e.language_codes))throw new Error("Tokenizer must have `language_codes` attribute set and it should be an array of language ids.");if(!("languageRegex"in e)||!(e.languageRegex instanceof RegExp))throw new Error("Tokenizer must have `languageRegex` attribute set and it should be a regular expression.");if(!("lang_to_token"in e)||"function"!==typeof e.lang_to_token)throw new Error("Tokenizer must have `lang_to_token` attribute set and it should be a function.");const o=r.src_lang,a=r.tgt_lang;if(!e.language_codes.includes(a))throw new Error('Target language code "'.concat(a,'" is not valid. Must be one of: {').concat(e.language_codes.join(", "),"}"));if(void 0!==o){if(!e.language_codes.includes(o))throw new Error('Source language code "'.concat(o,'" is not valid. Must be one of: {').concat(e.language_codes.join(", "),"}"));for(const t of e.post_processor.config.single)if("SpecialToken"in t&&e.languageRegex.test(t.SpecialToken.id)){t.SpecialToken.id=e.lang_to_token(o);break}}return r.forced_bos_token_id=e.model.convert_tokens_to_ids([e.lang_to_token(a)])[0],e._call(t,n)}class tt extends xe{constructor(e,t){super(e,t),this.languageRegex=/^[a-z]{3}_[A-Z][a-z]{3}$/,this.language_codes=this.special_tokens.filter((e=>this.languageRegex.test(e))),this.lang_to_token=e=>e}_build_translation_inputs(e,t,n){return et(this,e,t,n)}}class nt extends xe{constructor(e,t){super(e,t),this.languageRegex=/^__[a-z]{2,3}__$/,this.language_codes=this.special_tokens.filter((e=>this.languageRegex.test(e))).map((e=>e.slice(2,-2))),this.lang_to_token=e=>"__".concat(e,"__")}_build_translation_inputs(e,t,n){return et(this,e,t,n)}}class rt extends xe{get timestamp_begin(){return this.model.convert_tokens_to_ids(["<|notimestamps|>"])[0]+1}_decode_asr(e){let{return_timestamps:t=!1,return_language:n=!1,time_precision:r=null,force_full_sequences:o=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(null===r)throw Error("Must specify time_precision");let a=null;const s="word"===t;function l(){return{language:a,timestamp:[null,null],text:""}}const c=[];let d=l(),p=0;const h=this.timestamp_begin,f=h+1500;let m=[],g=[],_=!1,v=null;const w=new Set(this.all_special_ids);for(const k of e){const e=k.tokens,n=s?k.token_timestamps:null;let o=null,b=h;if("stride"in k){const[t,n,a]=k.stride;if(p-=n,v=t-a,n&&(b=n/r+h),a)for(let i=e.length-1;i>=0;--i){const t=Number(e[i]);if(t>=h){if(null!==o&&(t-h)*r<v)break;o=t}}}let x=[],C=[];for(let v=0;v<e.length;++v){const k=Number(e[v]);if(w.has(k)){const e=this.decode([k]),n=u.WHISPER_LANGUAGE_MAPPING.get(e.slice(2,-2));if(void 0!==n){if(null!==a&&n!==a&&!t){m.push(x);const e=this.findLongestCommonSequence(m)[0],t=this.decode(e);d.text=t,c.push(d),m=[],x=[],d=l()}a=d.language=n}}else if(k>=h&&k<=f){const e=(k-h)*r+p,t=(0,i.round)(e,2);if(null!==o&&k>=o)_=!0;else if(_||m.length>0&&k<b)_=!1;else if(null===d.timestamp[0])d.timestamp[0]=t;else if(t===d.timestamp[0]);else{d.timestamp[1]=t,m.push(x),s&&g.push(C);const[e,n]=this.findLongestCommonSequence(m,g),r=this.decode(e);d.text=r,s&&(d.words=this.collateWordTimestamps(e,n,a)),c.push(d),m=[],x=[],g=[],C=[],d=l()}}else if(x.push(k),s){let e,t=(0,i.round)(n[v]+p,2);if(v+1<n.length){e=(0,i.round)(n[v+1]+p,2);const o=this.decode([k]);y.test(o)&&(e=(0,i.round)(Math.min(t+r,e),2))}else e=null;C.push([t,e])}}if("stride"in k){const[e,t,n]=k.stride;p+=e-n}x.length>0?(m.push(x),s&&g.push(C)):m.every((e=>0===e.length))&&(d=l(),m=[],x=[],g=[],C=[])}if(m.length>0){if(o&&t)throw new Error("Whisper did not predict an ending timestamp, which can happen if audio is cut off in the middle of a word. Also make sure WhisperTimeStampLogitsProcessor was used during generation.");const[e,n]=this.findLongestCommonSequence(m,g),r=this.decode(e);d.text=r,s&&(d.words=this.collateWordTimestamps(e,n,a)),c.push(d)}let b=Object.create(null);const x=c.map((e=>e.text)).join("");if(t||n){for(let e=0;e<c.length;++e){const r=c[e];t||delete r.timestamp,n||delete r.language}if(s){const e=[];for(const t of c)for(const n of t.words)e.push(n);b={chunks:e}}else b={chunks:c}}return[x,b]}findLongestCommonSequence(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=e[0],r=n.length,o=[];const a=Array.isArray(t)&&t.length>0;let i=a?[]:null,s=a?t[0]:null;for(let l=1;l<e.length;++l){const c=e[l];let u=0,d=[r,r,0,0];const p=c.length;for(let e=1;e<r+p;++e){const o=Math.max(0,r-e),i=Math.min(r,r+p-e),h=n.slice(o,i),f=Math.max(0,e-r),m=Math.min(p,e),g=c.slice(f,m);if(h.length!==g.length)throw new Error("There is a bug within whisper `decode_asr` function, please report it. Dropping to prevent bad inference.");let _;_=a?h.filter(((e,n)=>e===g[n]&&s[o+n]<=t[l][f+n])).length:h.filter(((e,t)=>e===g[t])).length;const v=_/e+e/1e4;_>1&&v>u&&(u=v,d=[o,i,f,m])}const[h,f,m,g]=d,_=Math.floor((f+h)/2),v=Math.floor((g+m)/2);o.push(...n.slice(0,_)),n=c.slice(v),r=n.length,a&&(i.push(...s.slice(0,_)),s=t[l].slice(v))}return o.push(...n),a?(i.push(...s),[o,i]):[o,[]]}collateWordTimestamps(e,t,n){const[r,o,a]=this.combineTokensIntoWords(e,n),i=[];for(let s=0;s<r.length;++s){const e=a[s];i.push({text:r[s],timestamp:[t[e.at(0)][0],t[e.at(-1)][1]]})}return i}combineTokensIntoWords(e,t){let n,r,o,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"\"'\u201c\xa1\xbf([{-",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"\"'.\u3002,\uff0c!\uff01?\uff1f:\uff1a\u201d)]}\u3001";return["chinese","japanese","thai","lao","myanmar"].includes(t=null!==t&&void 0!==t?t:"english")?[n,r,o]=this.splitTokensOnUnicode(e):[n,r,o]=this.splitTokensOnSpaces(e),this.mergePunctuations(n,r,o,a,i)}decode(e,t){let n;return null!==t&&void 0!==t&&t.decode_with_timestamps?(e instanceof s.Tensor&&(e=f(e)),n=this.decodeWithTimestamps(e,t)):n=super.decode(e,t),n}decodeWithTimestamps(e,t){var n;const r=null!==(n=null===t||void 0===t?void 0:t.time_precision)&&void 0!==n?n:.02,o=Array.from(this.all_special_ids).at(-1)+1;let a=[[]];for(let i of e)if(i=Number(i),i>=o){const e=((i-o)*r).toFixed(2);a.push("<|".concat(e,"|>")),a.push([])}else a[a.length-1].push(i);return a=a.map((e=>"string"===typeof e?e:super.decode(e,t))),a.join("")}splitTokensOnUnicode(e){const t=this.decode(e,{decode_with_timestamps:!0}),n=[],r=[],o=[];let a=[],i=[],s=0;for(let l=0;l<e.length;++l){const c=e[l];a.push(c),i.push(l);const u=this.decode(a,{decode_with_timestamps:!0});u.includes("\ufffd")&&"\ufffd"!==t[s+u.indexOf("\ufffd")]||(n.push(u),r.push(a),o.push(i),a=[],i=[],s+=u.length)}return[n,r,o]}splitTokensOnSpaces(e){const[t,n,r]=this.splitTokensOnUnicode(e),o=[],a=[],i=[],s=new RegExp("^[".concat(v,"]$"),"gu");for(let l=0;l<t.length;++l){const e=t[l],c=n[l],u=r[l],d=c[0]>=this.model.tokens_to_ids.get("<|endoftext|>"),p=e.startsWith(" "),h=e.trim(),f=s.test(h);if(d||p||f||0===o.length)o.push(e),a.push(c),i.push(u);else{const t=o.length-1;o[t]+=e,a[t].push(...c),i[t].push(...u)}}return[o,a,i]}mergePunctuations(e,t,n,r,a){const i=structuredClone(e),s=structuredClone(t),l=structuredClone(n);let c=i.length-2,u=i.length-1;for(;c>=0;)i[c].startsWith(" ")&&r.includes(i[c].trim())?(i[u]=i[c]+i[u],s[u]=(0,o.mergeArrays)(s[c],s[u]),l[u]=(0,o.mergeArrays)(l[c],l[u]),i[c]="",s[c]=[],l[c]=[]):u=c,--c;for(c=0,u=1;u<i.length;)!i[c].endsWith(" ")&&a.includes(i[u])?(i[c]+=i[u],s[c]=(0,o.mergeArrays)(s[c],s[u]),l[c]=(0,o.mergeArrays)(l[c],l[u]),i[u]="",s[u]=[],l[u]=[]):c=u,++u;return[i.filter((e=>e)),s.filter((e=>e.length>0)),l.filter((e=>e.length>0))]}}class ot extends xe{}class at extends xe{}class it extends xe{}class st extends xe{constructor(e,t){super(e,t),this.languageRegex=/^(>>\w+<<)\s*/g,this.supported_language_codes=this.model.vocab.filter((e=>this.languageRegex.test(e))),console.warn('WARNING: `MarianTokenizer` is not yet supported by Hugging Face\'s "fast" tokenizers library. Therefore, you may experience slightly inaccurate results.')}_encode_text(e){if(null===e)return null;const[t,...n]=e.trim().split(this.languageRegex);if(0===n.length)return super._encode_text(t);if(2===n.length){const[e,t]=n;return this.supported_language_codes.includes(e)||console.warn('Unsupported language code "'.concat(e,'" detected, which may lead to unexpected behavior. Should be one of: ').concat(JSON.stringify(this.supported_language_codes))),(0,o.mergeArrays)([e],super._encode_text(t))}}}class lt extends xe{}class ct extends xe{}class ut extends xe{}class dt extends xe{}class pt extends xe{}class ht extends xe{constructor(e,t){super(e,t),this.decoder=new de({})}}class ft extends xe{}class mt extends xe{}class gt{static async from_pretrained(e){var t,n;let{progress_callback:r=null,config:o=null,cache_dir:a=null,local_files_only:i=!1,revision:s="main",legacy:l=null}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const[c,u]=await d(e,{progress_callback:r,config:o,cache_dir:a,local_files_only:i,revision:s,legacy:l}),p=null!==(t=null===(n=u.tokenizer_class)||void 0===n?void 0:n.replace(/Fast$/,""))&&void 0!==t?t:"PreTrainedTokenizer";let h=this.TOKENIZER_CLASS_MAPPING[p];return h||(console.warn('Unknown tokenizer class "'.concat(p,'", attempting to construct from base class.')),h=xe),new h(c,u)}}ao(gt,"TOKENIZER_CLASS_MAPPING",{T5Tokenizer:Ne,DistilBertTokenizer:Ie,CamembertTokenizer:Pe,DebertaTokenizer:Ee,DebertaV2Tokenizer:Te,BertTokenizer:ke,HerbertTokenizer:Ae,ConvBertTokenizer:Me,RoFormerTokenizer:Fe,XLMTokenizer:ze,ElectraTokenizer:Oe,MobileBertTokenizer:De,SqueezeBertTokenizer:Se,AlbertTokenizer:Ce,GPT2Tokenizer:Be,BartTokenizer:je,MBartTokenizer:Le,MBart50Tokenizer:Re,RobertaTokenizer:Ve,WhisperTokenizer:rt,CodeGenTokenizer:ot,CLIPTokenizer:at,SiglipTokenizer:it,MarianTokenizer:st,BloomTokenizer:qe,NllbTokenizer:tt,M2M100Tokenizer:nt,LlamaTokenizer:We,CodeLlamaTokenizer:Ge,XLMRobertaTokenizer:He,MPNetTokenizer:Ke,FalconTokenizer:Ze,GPTNeoXTokenizer:$e,EsmTokenizer:Xe,Wav2Vec2CTCTokenizer:lt,BlenderbotTokenizer:ct,BlenderbotSmallTokenizer:ut,SpeechT5Tokenizer:dt,NougatTokenizer:pt,VitsTokenizer:ht,Qwen2Tokenizer:Je,GemmaTokenizer:Qe,Grok1Tokenizer:Ye,CohereTokenizer:ft,MgpstrTokenizer:mt,PreTrainedTokenizer:xe})},"./src/utils/audio.js":(e,t,n)=>{n.r(t),n.d(t,{RawAudio:()=>x,hamming:()=>p,hanning:()=>d,mel_filter_bank:()=>_,read_audio:()=>c,spectrogram:()=>y,window_function:()=>w});var r=n("./src/utils/hub.js"),o=n("./src/utils/maths.js"),a=n("./src/utils/core.js"),i=n("./src/env.js"),s=n("?7a2c"),l=n("./src/utils/tensor.js");async function c(e,t){if("undefined"===typeof AudioContext)throw Error("Unable to load audio from path/URL since `AudioContext` is not available in your environment. Instead, audio data should be passed directly to the pipeline/processor. For more information and some example code, see https://huggingface.co/docs/transformers.js/guides/node-audio-processing.");const n=await(await(0,r.getFile)(e)).arrayBuffer(),o=new AudioContext({sampleRate:t});"undefined"===typeof t&&console.warn("No sampling rate provided, using default of ".concat(o.sampleRate,"Hz."));const a=await o.decodeAudioData(n);let i;if(2===a.numberOfChannels){const e=Math.sqrt(2),t=a.getChannelData(0),n=a.getChannelData(1);i=new Float32Array(t.length);for(let r=0;r<a.length;++r)i[r]=e*(t[r]+n[r])/2}else i=a.getChannelData(0);return i}function u(e,t){if(e<1)return new Float64Array;if(1===e)return new Float64Array([1]);const n=1-t,r=2*Math.PI/(e-1),o=new Float64Array(e);for(let a=0;a<e;++a)o[a]=t-n*Math.cos(a*r);return o}function d(e){return u(e,.5)}function p(e){return u(e,.54)}const h={htk:e=>2595*Math.log10(1+e/700),kaldi:e=>1127*Math.log(1+e/700),slaney:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:15,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:27/Math.log(6.4);return e>=t?n+Math.log(e/t)*r:3*e/200}};function f(e){const t=h[arguments.length>1&&void 0!==arguments[1]?arguments[1]:"htk"];if(!t)throw new Error('mel_scale should be one of "htk", "slaney" or "kaldi".');return"number"===typeof e?t(e):e.map((e=>t(e)))}const m={htk:e=>700*(10**(e/2595)-1),kaldi:e=>700*(Math.exp(e/1127)-1),slaney:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:15,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Math.log(6.4)/27;return e>=n?t*Math.exp(r*(e-n)):200*e/3}};function g(e,t,n){const r=(t-e)/(n-1);return Float64Array.from({length:n},((t,n)=>e+r*n))}function _(e,t,n,r,o){let a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,i=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"htk",s=arguments.length>7&&void 0!==arguments[7]&&arguments[7];if(null!==a&&"slaney"!==a)throw new Error('norm must be one of null or "slaney"');if(e<2)throw new Error("Require num_frequency_bins: ".concat(e," >= 2"));if(n>r)throw new Error("Require min_frequency: ".concat(n," <= max_frequency: ").concat(r));const l=g(f(n,i),f(r,i),t+2);let c,u=function(e){const t=m[arguments.length>1&&void 0!==arguments[1]?arguments[1]:"htk"];if(!t)throw new Error('mel_scale should be one of "htk", "slaney" or "kaldi".');return"number"===typeof e?t(e):e.map((e=>t(e)))}(l,i);if(s){const t=o/(2*(e-1));c=f(Float64Array.from({length:e},((e,n)=>n*t)),i),u=l}else c=g(0,Math.floor(o/2),e);const d=function(e,t){const n=Float64Array.from({length:t.length-1},((e,n)=>t[n+1]-t[n])),r=Array.from({length:e.length},(()=>new Array(t.length)));for(let i=0;i<e.length;++i){const n=r[i];for(let r=0;r<t.length;++r)n[r]=t[r]-e[i]}const o=t.length-2,a=Array.from({length:o},(()=>new Array(e.length)));for(let i=0;i<e.length;++i){const e=r[i];for(let t=0;t<o;++t){const r=-e[t]/n[t],o=e[t+2]/n[t+1];a[t][i]=Math.max(0,Math.min(r,o))}}return a}(c,u);if(null!==a&&"slaney"===a)for(let p=0;p<t;++p){const t=d[p],n=2/(u[p+2]-u[p]);for(let r=0;r<e;++r)t[r]*=n}return d}function v(e,t,n,r,a){if(n<=0)throw new Error("reference must be greater than zero");if(r<=0)throw new Error("min_value must be greater than zero");n=Math.max(r,n);const i=Math.log10(n);for(let o=0;o<e.length;++o)e[o]=t*Math.log10(Math.max(r,e[o])-i);if(null!==a){if(a<=0)throw new Error("db_range must be greater than zero");const t=(0,o.max)(e)[0]-a;for(let n=0;n<e.length;++n)e[n]=Math.max(e[n],t)}return e}async function y(e,t,n,r){let{fft_length:i=null,power:s=1,center:c=!0,pad_mode:u="reflect",onesided:d=!0,preemphasis:p=null,mel_filters:h=null,mel_floor:f=1e-10,log_mel:m=null,reference:g=1,min_value:_=1e-10,db_range:y=null,remove_dc_offset:w=null,min_num_frames:b=null,max_num_frames:x=null,do_pad:k=!0,transpose:C=!1}=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};const D=t.length;if(null===i&&(i=n),n>i)throw Error("frame_length (".concat(n,") may not be larger than fft_length (").concat(i,")"));if(D!==n)throw new Error("Length of the window (".concat(D,") must equal frame_length (").concat(n,")"));if(r<=0)throw new Error("hop_length must be greater than zero");if(null===s&&null!==h)throw new Error("You have provided `mel_filters` but `power` is `None`. Mel spectrogram computation is not yet supported for complex-valued spectrogram. Specify `power` to fix this issue.");if(c){if("reflect"!==u)throw new Error('pad_mode="'.concat(u,'" not implemented yet.'));const t=Math.floor((i-1)/2)+1;e=function(e,t,n){const r=new e.constructor(e.length+t+n),o=e.length-1;for(let a=0;a<e.length;++a)r[t+a]=e[a];for(let i=1;i<=t;++i)r[t-i]=e[(0,a.calculateReflectOffset)(i,o)];for(let i=1;i<=n;++i)r[o+t+i]=e[(0,a.calculateReflectOffset)(o-i,o)];return r}(e,t,t)}let S=Math.floor(1+Math.floor((e.length-n)/r));null!==b&&S<b&&(S=b);const E=d?Math.floor(i/2)+1:i;let T=S,A=S;null!==x&&(x>S?k&&(A=x):A=T=x);const M=new o.FFT(i),F=new Float64Array(i),I=new Float64Array(M.outputBufferSize),P=new Float32Array(E*A);for(let o=0;o<T;++o){const a=o*r,i=Math.min(e.length-a,n);i!==n&&F.fill(0,0,n);for(let t=0;t<i;++t)F[t]=e[a+t];if(w){let e=0;for(let n=0;n<i;++n)e+=F[n];const t=e/i;for(let n=0;n<i;++n)F[n]-=t}if(null!==p){for(let e=i-1;e>=1;--e)F[e]-=p*F[e-1];F[0]*=1-p}for(let e=0;e<t.length;++e)F[e]*=t[e];M.realTransform(I,F);for(let e=0;e<E;++e){const t=e<<1;P[e*A+o]=I[t]**2+I[t+1]**2}}if(null!==s&&2!==s){const e=2/s;for(let t=0;t<P.length;++t)P[t]**=e}const z=h.length;let O=await(0,l.matmul)(new l.Tensor("float32",h.flat(),[z,E]),new l.Tensor("float32",P,[E,A]));C&&(O=O.transpose(1,0));const N=O.data;for(let o=0;o<N.length;++o)N[o]=Math.max(f,N[o]);if(null!==s&&null!==m){const e=Math.min(N.length,T*z);switch(m){case"log":for(let t=0;t<e;++t)N[t]=Math.log(N[t]);break;case"log10":for(let t=0;t<e;++t)N[t]=Math.log10(N[t]);break;case"dB":if(1===s)!function(e){v(e,20,arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e-5,arguments.length>3&&void 0!==arguments[3]?arguments[3]:null)}(N,g,_,y);else{if(2!==s)throw new Error("Cannot use log_mel option '".concat(m,"' with power ").concat(s));!function(e){v(e,10,arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e-10,arguments.length>3&&void 0!==arguments[3]?arguments[3]:null)}(N,g,_,y)}break;default:throw new Error("log_mel must be one of null, 'log', 'log10' or 'dB'. Got '".concat(m,"'"))}}return O}function w(e,t){let{periodic:n=!0,frame_length:r=null,center:o=!0}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const a=n?e+1:e;let i;switch(t){case"boxcar":i=new Float64Array(a).fill(1);break;case"hann":case"hann_window":i=d(a);break;case"hamming":i=p(a);break;case"povey":i=d(a).map((e=>Math.pow(e,.85)));break;default:throw new Error("Unknown window type ".concat(t,"."))}if(n&&(i=i.subarray(0,e)),null===r)return i;if(e>r)throw new Error("Length of the window (".concat(e,") may not be larger than frame_length (").concat(r,")"));return i}function b(e,t,n){for(let r=0;r<n.length;++r)e.setUint8(t+r,n.charCodeAt(r))}class x{constructor(e,t){this.audio=e,this.sampling_rate=t}toWav(){return function(e,t){let n=44;const r=new ArrayBuffer(n+4*e.length),o=new DataView(r);b(o,0,"RIFF"),o.setUint32(4,36+4*e.length,!0),b(o,8,"WAVE"),b(o,12,"fmt "),o.setUint32(16,16,!0),o.setUint16(20,3,!0),o.setUint16(22,1,!0),o.setUint32(24,t,!0),o.setUint32(28,4*t,!0),o.setUint16(32,4,!0),o.setUint16(34,32,!0),b(o,36,"data"),o.setUint32(40,4*e.length,!0);for(let a=0;a<e.length;++a,n+=4)o.setFloat32(n,e[a],!0);return r}(this.audio,this.sampling_rate)}toBlob(){const e=this.toWav();return new Blob([e],{type:"audio/wav"})}async save(e){let t;if(i.apis.IS_BROWSER_ENV){if(i.apis.IS_WEBWORKER_ENV)throw new Error("Unable to save a file from a Web Worker.");t=a.saveBlob}else{if(!i.apis.IS_FS_AVAILABLE)throw new Error("Unable to save because filesystem is disabled in this environment.");t=async(e,t)=>{let n=await t.arrayBuffer();s.writeFileSync(e,Buffer.from(n))}}await t(e,this.toBlob())}}},"./src/utils/constants.js":(e,t,n)=>{n.r(t),n.d(t,{CHAT_TEMPLATE_NAME:()=>l,CONFIG_NAME:()=>o,FEATURE_EXTRACTOR_NAME:()=>a,GENERATION_CONFIG_NAME:()=>c,GITHUB_ISSUE_URL:()=>r,IMAGE_PROCESSOR_NAME:()=>i,PROCESSOR_NAME:()=>s});const r="https://github.com/huggingface/transformers.js/issues/new/choose",o="config.json",a="preprocessor_config.json",i=a,s="processor_config.json",l="chat_template.json",c="generation_config.json"},"./src/utils/core.js":(e,t,n)=>{function r(e,t){e&&e(t)}function o(e){return Object.fromEntries(Object.entries(e).map((e=>{let[t,n]=e;return[n,t]})))}function a(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function i(e){var t;return"TypedArray"===(null===e||void 0===e||null===(t=e.prototype)||void 0===t||null===(t=t.__proto__)||void 0===t||null===(t=t.constructor)||void 0===t?void 0:t.name)}function s(e){return Number.isInteger(e)||"bigint"===typeof e}function l(e){return null===e||void 0===e||-1===e}function c(e){const t=[];let n=e;for(;Array.isArray(n);)t.push(n.length),n=n[0];return t}function u(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;const r=e[t];if(void 0!==r)return delete e[t],r;if(void 0===n)throw Error("Key ".concat(t," does not exist in object."));return n}function d(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Array.prototype.concat.apply([],t)}function p(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.reduce(((e,t)=>e.flatMap((e=>t.map((t=>[e,t]))))))}function h(e,t){return Math.abs((e+t)%(2*t)-t)}function f(e,t){const n=URL.createObjectURL(t),r=document.createElement("a");r.href=n,r.download=e,r.click(),r.remove(),URL.revokeObjectURL(n)}function m(e,t){return Object.assign({},...t.map((t=>{if(void 0!==e[t])return{[t]:e[t]}})))}function g(e){let t=0;for(const n of e)++t;return t}function _(e,t){let n=0;for(const r of e)r===t&&++n;return n}n.r(t),n.d(t,{calculateDimensions:()=>c,calculateReflectOffset:()=>h,count:()=>_,dispatchCallback:()=>r,escapeRegExp:()=>a,isIntegralNumber:()=>s,isNullishDimension:()=>l,isTypedArray:()=>i,len:()=>g,mergeArrays:()=>d,pick:()=>m,pop:()=>u,product:()=>p,reverseDictionary:()=>o,saveBlob:()=>f})},"./src/utils/data-structures.js":(e,t,n)=>{n.r(t),n.d(t,{CharTrie:()=>o,DictionarySplitter:()=>l,LRUCache:()=>c,PriorityQueue:()=>r,TokenLattice:()=>i});class r{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(e,t)=>e>t,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0;this._heap=[],this._comparator=e,this._maxSize=t}get size(){return this._heap.length}isEmpty(){return 0===this.size}peek(){return this._heap[0]}push(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.extend(t)}extend(e){for(const t of e)if(this.size<this._maxSize)this._heap.push(t),this._siftUp();else{const e=this._smallest();this._comparator(t,this._heap[e])&&(this._heap[e]=t,this._siftUpFrom(e))}return this.size}pop(){const e=this.peek(),t=this.size-1;return t>0&&this._swap(0,t),this._heap.pop(),this._siftDown(),e}replace(e){const t=this.peek();return this._heap[0]=e,this._siftDown(),t}_parent(e){return(e+1>>>1)-1}_left(e){return 1+(e<<1)}_right(e){return e+1<<1}_greater(e,t){return this._comparator(this._heap[e],this._heap[t])}_swap(e,t){const n=this._heap[e];this._heap[e]=this._heap[t],this._heap[t]=n}_siftUp(){this._siftUpFrom(this.size-1)}_siftUpFrom(e){for(;e>0&&this._greater(e,this._parent(e));)this._swap(e,this._parent(e)),e=this._parent(e)}_siftDown(){let e=0;for(;this._left(e)<this.size&&this._greater(this._left(e),e)||this._right(e)<this.size&&this._greater(this._right(e),e);){const t=this._right(e)<this.size&&this._greater(this._right(e),this._left(e))?this._right(e):this._left(e);this._swap(e,t),e=t}}_smallest(){return 2**Math.floor(Math.log2(this.size))-1}}class o{constructor(){this.root=a.default()}extend(e){for(const t of e)this.push(t)}push(e){let t=this.root;for(const n of e){let e=t.children.get(n);void 0===e&&(e=a.default(),t.children.set(n,e)),t=e}t.isLeaf=!0}*commonPrefixSearch(e){let t=this.root;if(void 0===t)return;let n="";for(const r of e){if(n+=r,t=t.children.get(r),void 0===t)return;t.isLeaf&&(yield n)}}}class a{constructor(e,t){this.isLeaf=e,this.children=t}static default(){return new a(!1,new Map)}}class i{constructor(e,t,n){this.chars=Array.from(e),this.len=this.chars.length,this.bosTokenId=t,this.eosTokenId=n,this.nodes=[],this.beginNodes=Array.from({length:this.len+1},(()=>[])),this.endNodes=Array.from({length:this.len+1},(()=>[]));const r=new s(this.bosTokenId,0,0,0,0),o=new s(this.eosTokenId,1,this.len,0,0);this.nodes.push(r.clone()),this.nodes.push(o.clone()),this.beginNodes[this.len].push(o),this.endNodes[0].push(r)}insert(e,t,n,r){const o=this.nodes.length,a=new s(r,o,e,t,n);this.beginNodes[e].push(a),this.endNodes[e+t].push(a),this.nodes.push(a)}viterbi(){const e=this.len;let t=0;for(;t<=e;){if(0==this.beginNodes[t].length)return[];for(let e of this.beginNodes[t]){e.prev=null;let n=0,r=null;for(let o of this.endNodes[t]){const t=o.backtraceScore+e.score;(null===r||t>n)&&(r=o.clone(),n=t)}if(null===r)return[];e.prev=r,e.backtraceScore=n}++t}const n=[],r=this.beginNodes[e][0].prev;if(null===r)return[];let o=r.clone();for(;null!==o.prev;){n.push(o.clone());const e=o.clone();o=e.prev.clone()}return n.reverse(),n}piece(e){return this.chars.slice(e.pos,e.pos+e.length).join("")}tokens(){return this.viterbi().map((e=>this.piece(e)))}tokenIds(){return this.viterbi().map((e=>e.tokenId))}}class s{constructor(e,t,n,r,o){this.tokenId=e,this.nodeId=t,this.pos=n,this.length=r,this.score=o,this.prev=null,this.backtraceScore=0}clone(){const e=new s(this.tokenId,this.nodeId,this.pos,this.length,this.score);return e.prev=this.prev,e.backtraceScore=this.backtraceScore,e}}class l{constructor(e){this.trie=this._buildTrie(e)}_buildTrie(e){const t=Object.create(null);for(const a of e){let e=t;for(let t=0;t<a.length;++t){var n,r,o;e=null!==(o=(n=e)[r=a[t]])&&void 0!==o?o:n[r]=Object.create(null)}e.end=a}return t}split(e){const t=[],n=e.length;let r=0,o=0;for(;o<n;){let a=this.trie,i=null,s=o;for(;s<n&&(a=a[e[s]]);)a.end&&(i=a.end),++s;i?(o>r&&t.push(e.slice(r,o)),t.push(i),o+=i.length,r=o):++o}return r<n&&t.push(e.slice(r)),t}}class c{constructor(e){this.capacity=e,this.cache=new Map}get(e){if(!this.cache.has(e))return;const t=this.cache.get(e);return this.cache.delete(e),this.cache.set(e,t),t}put(e,t){this.cache.has(e)&&this.cache.delete(e),this.cache.set(e,t),this.cache.size>this.capacity&&this.cache.delete(this.cache.keys().next().value)}clear(){this.cache.clear()}}},"./src/utils/devices.js":(e,t,n)=>{n.r(t),n.d(t,{DEVICE_TYPES:()=>r});const r=Object.freeze({auto:"auto",gpu:"gpu",cpu:"cpu",wasm:"wasm",webgpu:"webgpu",cuda:"cuda",dml:"dml",webnn:"webnn","webnn-npu":"webnn-npu","webnn-gpu":"webnn-gpu","webnn-cpu":"webnn-cpu"})},"./src/utils/dtypes.js":(e,t,n)=>{n.r(t),n.d(t,{DATA_TYPES:()=>i,DEFAULT_DEVICE_DTYPE_MAPPING:()=>s,DEFAULT_DTYPE_SUFFIX_MAPPING:()=>l,isWebGpuFp16Supported:()=>a});var r=n("./src/env.js"),o=n("./src/utils/devices.js");const a=function(){let e;return async function(){if(void 0===e)if(r.apis.IS_WEBGPU_AVAILABLE)try{const t=await navigator.gpu.requestAdapter();e=t.features.has("shader-f16")}catch(AC){e=!1}else e=!1;return e}}(),i=Object.freeze({auto:"auto",fp32:"fp32",fp16:"fp16",q8:"q8",int8:"int8",uint8:"uint8",q4:"q4",bnb4:"bnb4",q4f16:"q4f16"}),s=Object.freeze({[o.DEVICE_TYPES.wasm]:i.q8}),l=Object.freeze({[i.fp32]:"",[i.fp16]:"_fp16",[i.int8]:"_int8",[i.uint8]:"_uint8",[i.q8]:"_quantized",[i.q4]:"_q4",[i.q4f16]:"_q4f16",[i.bnb4]:"_bnb4"})},"./src/utils/generic.js":(e,t,n)=>{n.r(t),n.d(t,{Callable:()=>r});const r=class{constructor(){let e=function(){return e._call(...arguments)};return Object.setPrototypeOf(e,new.target.prototype)}_call(){throw Error("Must implement _call method in subclass")}}},"./src/utils/hub.js":(e,t,n)=>{n.r(t),n.d(t,{MAX_EXTERNAL_DATA_CHUNKS:()=>s,getFile:()=>p,getModelFile:()=>m,getModelJSON:()=>g});var r=n("?7a2c"),o=n("?a42a"),a=n("./src/env.js"),i=n("./src/utils/core.js");const s=100,l={txt:"text/plain",html:"text/html",css:"text/css",js:"text/javascript",json:"application/json",png:"image/png",jpg:"image/jpeg",jpeg:"image/jpeg",gif:"image/gif"};class c{constructor(e){if(this.filePath=e,this.headers=new Headers,this.exists=r.existsSync(e),this.exists){this.status=200,this.statusText="OK";let t=r.statSync(e);this.headers.set("content-length",t.size.toString()),this.updateContentType();const n=r.createReadStream(e);this.body=new ReadableStream({start(e){n.on("data",(t=>e.enqueue(t))),n.on("end",(()=>e.close())),n.on("error",(t=>e.error(t)))},cancel(){n.destroy()}})}else this.status=404,this.statusText="Not Found",this.body=null}updateContentType(){var e;const t=this.filePath.toString().split(".").pop().toLowerCase();this.headers.set("content-type",null!==(e=l[t])&&void 0!==e?e:"application/octet-stream")}clone(){let e=new c(this.filePath);return e.exists=this.exists,e.status=this.status,e.statusText=this.statusText,e.headers=new Headers(this.headers),e}async arrayBuffer(){return(await r.promises.readFile(this.filePath)).buffer}async blob(){const e=await r.promises.readFile(this.filePath);return new Blob([e],{type:this.headers.get("content-type")})}async text(){return await r.promises.readFile(this.filePath,"utf8")}async json(){return JSON.parse(await this.text())}}function u(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;try{t=new URL(e)}catch(o){return!1}return!(n&&!n.includes(t.protocol))&&!(r&&!r.includes(t.hostname))}const d=/^(\b[\w\-.]+\b\/)?\b[\w\-.]{1,96}\b$/;async function p(e){var t;if(a.env.useFS&&!u(e,["http:","https:","blob:"]))return new c(e instanceof URL?"file:"===e.protocol?e.pathname:e.toString():e);if("undefined"!==typeof process&&"node"===(null===(t=process)||void 0===t||null===(t=t.release)||void 0===t?void 0:t.name)){var n;const t=!(null===(n={NODE_ENV:"production",PUBLIC_URL:"/llm-consistency-vis",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0})||void 0===n||!n.TESTING_REMOTELY),s=a.env.version,l=new Headers;l.set("User-Agent","transformers.js/".concat(s,"; is_ci/").concat(t,";"));if(u(e,["http:","https:"],["huggingface.co","hf.co"])){var r,o,i;const e=null!==(r=null===(o={NODE_ENV:"production",PUBLIC_URL:"/llm-consistency-vis",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0})||void 0===o?void 0:o.HF_TOKEN)&&void 0!==r?r:null===(i={NODE_ENV:"production",PUBLIC_URL:"/llm-consistency-vis",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0})||void 0===i?void 0:i.HF_ACCESS_TOKEN;e&&l.set("Authorization","Bearer ".concat(e))}return fetch(e,{headers:l})}return fetch(e)}const h={400:"Bad request error occurred while trying to load file",401:"Unauthorized access to file",403:"Forbidden access to file",404:"Could not locate file",408:"Request timeout error occurred while trying to load file",500:"Internal server error error occurred while trying to load file",502:"Bad gateway error occurred while trying to load file",503:"Service unavailable error occurred while trying to load file",504:"Gateway timeout error occurred while trying to load file"};class f{constructor(e){this.path=e}async match(e){let t=o.join(this.path,e),n=new c(t);return n.exists?n:void 0}async put(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,a=o.join(this.path,e);try{const e=t.headers.get("Content-Length"),i=parseInt(null!==e&&void 0!==e?e:"0");let s=0;await r.promises.mkdir(o.dirname(a),{recursive:!0});const l=r.createWriteStream(a),c=t.body.getReader();for(;;){const{done:e,value:t}=await c.read();if(e)break;await new Promise(((e,n)=>{l.write(t,(t=>{t?n(t):e()}))})),s+=t.length;null===n||void 0===n||n({progress:i?s/i*100:0,loaded:s,total:i})}l.close()}catch(i){try{await r.promises.unlink(a)}catch(s){}throw i}}}async function m(e,t){var n,r;let o,s=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},m=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(!a.env.allowLocalModels){if(l.local_files_only)throw Error("Invalid configuration detected: local models are disabled (`env.allowLocalModels=false`) but you have requested to only use local models (`local_files_only=true`).");if(!a.env.allowRemoteModels)throw Error("Invalid configuration detected: both local and remote models are disabled. Fix by setting `env.allowLocalModels` or `env.allowRemoteModels` to `true`.")}if((0,i.dispatchCallback)(l.progress_callback,{status:"initiate",name:e,file:t}),!o&&a.env.useCustomCache){if(!a.env.customCache)throw Error("`env.useCustomCache=true`, but `env.customCache` is not defined.");if(!a.env.customCache.match||!a.env.customCache.put)throw new Error("`env.customCache` must be an object which implements the `match` and `put` functions of the Web Cache API. For more information, see https://developer.mozilla.org/en-US/docs/Web/API/Cache");o=a.env.customCache}if(!o&&a.env.useBrowserCache){if("undefined"===typeof caches)throw Error("Browser cache is not available in this environment.");try{o=await caches.open("transformers-cache")}catch(AC){console.warn("An error occurred while opening the browser cache:",AC)}}if(!o&&a.env.useFSCache){var g;if(!a.apis.IS_FS_AVAILABLE)throw Error("File System Cache is not available in this environment.");o=new f(null!==(g=l.cache_dir)&&void 0!==g?g:a.env.cacheDir)}const v=null!==(n=l.revision)&&void 0!==n?n:"main",y=_(e,t),w=function(e){return!!d.test(e)&&!e.includes("..")&&!e.includes("--")&&!e.endsWith(".git")&&!e.endsWith(".ipynb")}(e),b=w?_(a.env.localModelPath,y):y,x=_(a.env.remoteHost,a.env.remotePathTemplate.replaceAll("{model}",e).replaceAll("{revision}",encodeURIComponent(v)),t);let k;const C=o instanceof f?"main"===v?y:_(e,v,t):x;let D,S=!1;o&&(D=await async function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];for(let o of n)try{let t=await e.match(o);if(t)return t}catch(AC){continue}}(o,b,C));const E=void 0!==D;if(void 0===D){if(a.env.allowLocalModels){if(u(y,["http:","https:"])){if(l.local_files_only)throw new Error("`local_files_only=true`, but attempted to load a remote file from: ".concat(y,"."));if(!a.env.allowRemoteModels)throw new Error("`env.allowRemoteModels=false`, but attempted to load a remote file from: ".concat(y,"."))}else try{D=await p(b),k=b}catch(AC){console.warn('Unable to load from local path "'.concat(b,'": "').concat(AC,'"'))}}if(void 0===D||404===D.status){if(l.local_files_only||!a.env.allowRemoteModels){if(s)throw Error('`local_files_only=true` or `env.allowRemoteModels=false` and file was not found locally at "'.concat(b,'".'));return null}if(!w)throw Error('Local file missing at "'.concat(b,'" and download aborted due to invalid model ID "').concat(e,'".'));if(D=await p(x),200!==D.status)return function(e,t,n){var r;if(!n)return null;const o=null!==(r=h[e])&&void 0!==r?r:"Error (".concat(e,") occurred while trying to load file");throw Error("".concat(o,': "').concat(t,'".'))}(D.status,x,s);k=C}S=o&&"undefined"!==typeof Response&&D instanceof Response&&200===D.status}let T;if((0,i.dispatchCallback)(l.progress_callback,{status:"download",name:e,file:t}),!a.apis.IS_NODE_ENV||!m){let n;l.progress_callback?E&&"undefined"!==typeof navigator&&/firefox/i.test(navigator.userAgent)?(n=new Uint8Array(await D.arrayBuffer()),(0,i.dispatchCallback)(l.progress_callback,{status:"progress",name:e,file:t,progress:100,loaded:n.length,total:n.length})):n=await async function(e,t){const n=e.headers.get("Content-Length");null===n&&console.warn("Unable to determine content-length from response headers. Will expand buffer when needed.");let r=parseInt(null!==n&&void 0!==n?n:"0"),o=new Uint8Array(r),a=0;const i=e.body.getReader();async function s(){const{done:e,value:n}=await i.read();if(e)return;const l=a+n.length;if(l>r){r=l;const e=new Uint8Array(r);e.set(o),o=e}o.set(n,a),a=l;return t({progress:a/r*100,loaded:a,total:r}),s()}return await s(),o}(D,(n=>{(0,i.dispatchCallback)(l.progress_callback,so({status:"progress",name:e,file:t},n))})):n=new Uint8Array(await D.arrayBuffer()),T=n}if(S&&k&&void 0===await o.match(k)&&(T?await o.put(k,new Response(T,{headers:D.headers})).catch((e=>{console.warn("Unable to add response to browser cache: ".concat(e,"."))})):await o.put(k,D,l.progress_callback)),(0,i.dispatchCallback)(l.progress_callback,{status:"done",name:e,file:t}),T){if(!a.apis.IS_NODE_ENV&&m)throw new Error("Cannot return path in a browser environment.");return T}if(D instanceof c)return D.filePath;const A=await(null===(r=o)||void 0===r?void 0:r.match(k));if(A instanceof c)return A.filePath;if(A instanceof Response)return new Uint8Array(await A.arrayBuffer());if("string"===typeof A)return A;throw new Error("Unable to get model file path or buffer.")}async function g(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const o=await m(e,t,n,r,!1);if(null===o)return{};const a=new TextDecoder("utf-8").decode(o);return JSON.parse(a)}function _(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t=t.map(((e,n)=>(n&&(e=e.replace(new RegExp("^/"),"")),n!==t.length-1&&(e=e.replace(new RegExp("/$"),"")),e))),t.join("/")}},"./src/utils/image.js":(e,t,n)=>{n.r(t),n.d(t,{RawImage:()=>f,load_image:()=>m});var r=n("./src/utils/core.js"),o=n("./src/utils/hub.js"),a=n("./src/env.js"),i=n("./src/utils/tensor.js"),s=n("?2b25");let l,c,u;const d=a.apis.IS_BROWSER_ENV||a.apis.IS_WEBWORKER_ENV;if(d)l=(e,t)=>{if(!self.OffscreenCanvas)throw new Error("OffscreenCanvas not supported by this browser.");return new self.OffscreenCanvas(e,t)},u=self.createImageBitmap,c=self.ImageData;else{if(!s)throw new Error("Unable to load image processing library.");u=async e=>{const t=(await e.metadata()).channels,{data:n,info:r}=await e.rotate().raw().toBuffer({resolveWithObject:!0}),o=new f(new Uint8ClampedArray(n),r.width,r.height,r.channels);return void 0!==t&&t!==r.channels&&o.convert(t),o}}const p={0:"nearest",1:"lanczos",2:"bilinear",3:"bicubic",4:"box",5:"hamming"},h=new Map([["png","image/png"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["gif","image/gif"]]);class f{constructor(e,t,n,r){this.data=e,this.width=t,this.height=n,this.channels=r}get size(){return[this.width,this.height]}static async read(e){if(e instanceof f)return e;if("string"===typeof e||e instanceof URL)return await this.fromURL(e);if(e instanceof Blob)return await this.fromBlob(e);if("undefined"!==typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!==typeof OffscreenCanvas&&e instanceof OffscreenCanvas)return this.fromCanvas(e);throw new Error("Unsupported input type: ".concat(typeof e))}static fromCanvas(e){if(!d)throw new Error("fromCanvas() is only supported in browser environments.");const t=e.getContext("2d").getImageData(0,0,e.width,e.height).data;return new f(t,e.width,e.height,4)}static async fromURL(e){const t=await(0,o.getFile)(e);if(200!==t.status)throw new Error('Unable to read image from "'.concat(e,'" (').concat(t.status," ").concat(t.statusText,")"));const n=await t.blob();return this.fromBlob(n)}static async fromBlob(e){if(d){const t=await u(e),n=l(t.width,t.height).getContext("2d");return n.drawImage(t,0,0),new this(n.getImageData(0,0,t.width,t.height).data,t.width,t.height,4)}{const t=s(await e.arrayBuffer());return await u(t)}}static fromTensor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"CHW";if(3!==e.dims.length)throw new Error("Tensor should have 3 dimensions, but has ".concat(e.dims.length," dimensions."));if("CHW"===t)e=e.transpose(1,2,0);else if("HWC"!==t)throw new Error("Unsupported channel format: ".concat(t));if(!(e.data instanceof Uint8ClampedArray||e.data instanceof Uint8Array))throw new Error("Unsupported tensor type: ".concat(e.type));switch(e.dims[2]){case 1:case 2:case 3:case 4:return new f(e.data,e.dims[1],e.dims[0],e.dims[2]);default:throw new Error("Unsupported number of channels: ".concat(e.dims[2]))}}grayscale(){if(1===this.channels)return this;const e=new Uint8ClampedArray(this.width*this.height*1);switch(this.channels){case 3:case 4:for(let t=0,n=0;t<this.data.length;t+=this.channels){const r=this.data[t],o=this.data[t+1],a=this.data[t+2];e[n++]=Math.round(.2989*r+.587*o+.114*a)}break;default:throw new Error("Conversion failed due to unsupported number of channels: ".concat(this.channels))}return this._update(e,this.width,this.height,1)}rgb(){if(3===this.channels)return this;const e=new Uint8ClampedArray(this.width*this.height*3);switch(this.channels){case 1:for(let t=0,n=0;t<this.data.length;++t)e[n++]=this.data[t],e[n++]=this.data[t],e[n++]=this.data[t];break;case 4:for(let t=0,n=0;t<this.data.length;t+=4)e[n++]=this.data[t],e[n++]=this.data[t+1],e[n++]=this.data[t+2];break;default:throw new Error("Conversion failed due to unsupported number of channels: ".concat(this.channels))}return this._update(e,this.width,this.height,3)}rgba(){if(4===this.channels)return this;const e=new Uint8ClampedArray(this.width*this.height*4);switch(this.channels){case 1:for(let t=0,n=0;t<this.data.length;++t)e[n++]=this.data[t],e[n++]=this.data[t],e[n++]=this.data[t],e[n++]=255;break;case 3:for(let t=0,n=0;t<this.data.length;t+=3)e[n++]=this.data[t],e[n++]=this.data[t+1],e[n++]=this.data[t+2],e[n++]=255;break;default:throw new Error("Conversion failed due to unsupported number of channels: ".concat(this.channels))}return this._update(e,this.width,this.height,4)}putAlpha(e){if(e.width!==this.width||e.height!==this.height)throw new Error("Expected mask size to be ".concat(this.width,"x").concat(this.height,", but got ").concat(e.width,"x").concat(e.height));if(1!==e.channels)throw new Error("Expected mask to have 1 channel, but got ".concat(e.channels));const t=this.data,n=e.data,r=this.width*this.height;if(3===this.channels){const e=new Uint8ClampedArray(4*r);for(let o=0,a=0,i=0;o<r;++o)e[i++]=t[a++],e[i++]=t[a++],e[i++]=t[a++],e[i++]=n[o];return this._update(e,this.width,this.height,4)}if(4===this.channels){for(let e=0;e<r;++e)t[4*e+3]=n[e];return this}throw new Error("Expected image to have 3 or 4 channels, but got ".concat(this.channels))}async resize(e,t){var n;let{resample:o=2}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(this.width===e&&this.height===t)return this;let a=null!==(n=p[o])&&void 0!==n?n:o;const i=(0,r.isNullishDimension)(e),s=(0,r.isNullishDimension)(t);if(i&&s)return this;if(i?e=t/this.height*this.width:s&&(t=e/this.width*this.height),d){const n=this.channels,r=this.toCanvas(),o=l(e,t).getContext("2d");o.drawImage(r,0,0,e,t);return new f(o.getImageData(0,0,e,t).data,e,t,4).convert(n)}{let n=this.toSharp();switch(a){case"box":case"hamming":"box"!==a&&"hamming"!==a||(console.warn("Resampling method ".concat(a," is not yet supported. Using bilinear instead.")),a="bilinear");case"nearest":case"bilinear":case"bicubic":n=n.affine([e/this.width,0,0,t/this.height],{interpolator:a});break;case"lanczos":n=n.resize({width:e,height:t,fit:"fill",kernel:"lanczos3"});break;default:throw new Error("Resampling method ".concat(a," is not supported."))}return await u(n)}}async pad(e){let[t,n,r,o]=e;if(t=Math.max(t,0),n=Math.max(n,0),r=Math.max(r,0),o=Math.max(o,0),0===t&&0===n&&0===r&&0===o)return this;if(d){const e=this.channels,a=this.toCanvas(),i=this.width+t+n,s=this.height+r+o,c=l(i,s).getContext("2d");c.drawImage(a,0,0,this.width,this.height,t,r,this.width,this.height);return new f(c.getImageData(0,0,i,s).data,i,s,4).convert(e)}{const e=this.toSharp().extend({left:t,right:n,top:r,bottom:o});return await u(e)}}async crop(e){let[t,n,r,o]=e;if(t=Math.max(t,0),n=Math.max(n,0),r=Math.min(r,this.width-1),o=Math.min(o,this.height-1),0===t&&0===n&&r===this.width-1&&o===this.height-1)return this;const a=r-t+1,i=o-n+1;if(d){const e=this.channels,r=this.toCanvas(),o=l(a,i).getContext("2d");o.drawImage(r,t,n,a,i,0,0,a,i);return new f(o.getImageData(0,0,a,i).data,a,i,4).convert(e)}{const e=this.toSharp().extract({left:t,top:n,width:a,height:i});return await u(e)}}async center_crop(e,t){if(this.width===e&&this.height===t)return this;const n=(this.width-e)/2,r=(this.height-t)/2;if(d){const o=this.channels,a=this.toCanvas(),i=l(e,t).getContext("2d");let s=0,c=0,u=0,d=0;n>=0?s=n:u=-n,r>=0?c=r:d=-r,i.drawImage(a,s,c,e,t,u,d,e,t);return new f(i.getImageData(0,0,e,t).data,e,t,4).convert(o)}{let o=this.toSharp();if(n>=0&&r>=0)o=o.extract({left:Math.floor(n),top:Math.floor(r),width:e,height:t});else if(n<=0&&r<=0){const a=Math.floor(-r),i=Math.floor(-n);o=o.extend({top:a,left:i,right:e-this.width-i,bottom:t-this.height-a})}else{let a=[0,0],i=0;r<0?(a[0]=Math.floor(-r),a[1]=t-this.height-a[0]):i=Math.floor(r);let s=[0,0],l=0;n<0?(s[0]=Math.floor(-n),s[1]=e-this.width-s[0]):l=Math.floor(n),o=o.extend({top:a[0],bottom:a[1],left:s[0],right:s[1]}).extract({left:l,top:i,width:e,height:t})}return await u(o)}}async toBlob(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"image/png",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(!d)throw new Error("toBlob() is only supported in browser environments.");const n=this.toCanvas();return await n.convertToBlob({type:e,quality:t})}toTensor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"CHW",t=new i.Tensor("uint8",new Uint8Array(this.data),[this.height,this.width,this.channels]);if("HWC"===e);else{if("CHW"!==e)throw new Error("Unsupported channel format: ".concat(e));t=t.permute(2,0,1)}return t}toCanvas(){if(!d)throw new Error("toCanvas() is only supported in browser environments.");const e=this.clone().rgba(),t=l(e.width,e.height),n=new c(e.data,e.width,e.height);return t.getContext("2d").putImageData(n,0,0),t}split(){const{data:e,width:t,height:n,channels:r}=this,o=e.constructor,a=e.length/r,i=Array.from({length:r},(()=>new o(a)));for(let s=0;s<a;++s){const t=r*s;for(let n=0;n<r;++n)i[n][s]=e[t+n]}return i.map((e=>new f(e,t,n,1)))}_update(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return this.data=e,this.width=t,this.height=n,null!==r&&(this.channels=r),this}clone(){return new f(this.data.slice(),this.width,this.height,this.channels)}convert(e){if(this.channels===e)return this;switch(e){case 1:this.grayscale();break;case 3:this.rgb();break;case 4:this.rgba();break;default:throw new Error("Conversion failed due to unsupported number of channels: ".concat(this.channels))}return this}async save(e){if(!d){if(a.apis.IS_FS_AVAILABLE){const t=this.toSharp();return await t.toFile(e)}throw new Error("Unable to save the image because filesystem is disabled in this environment.")}{var t;if(a.apis.IS_WEBWORKER_ENV)throw new Error("Unable to save an image from a Web Worker.");const n=e.split(".").pop().toLowerCase(),o=null!==(t=h.get(n))&&void 0!==t?t:"image/png",i=await this.toBlob(o);(0,r.saveBlob)(e,i)}}toSharp(){if(d)throw new Error("toSharp() is only supported in server-side environments.");return s(this.data,{raw:{width:this.width,height:this.height,channels:this.channels}})}}const m=f.read.bind(f)},"./src/utils/maths.js":(e,t,n)=>{function r(e,t,n){let[r,o,a]=t,[i,s]=n;const l=s/a,c=i/o,u=new e.constructor(i*s*r),d=o*a,p=i*s;for(let h=0;h<i;++h)for(let t=0;t<s;++t){const n=h*s+t,i=(t+.5)/l-.5,f=(h+.5)/c-.5;let m=Math.floor(i),g=Math.floor(f);const _=Math.min(m+1,a-1),v=Math.min(g+1,o-1);m=Math.max(m,0),g=Math.max(g,0);const y=i-m,w=f-g,b=(1-y)*(1-w),x=y*(1-w),k=(1-y)*w,C=y*w,D=g*a,S=v*a,E=D+m,T=D+_,A=S+m,M=S+_;for(let t=0;t<r;++t){const r=t*d;u[t*p+n]=b*e[r+E]+x*e[r+T]+k*e[r+A]+C*e[r+M]}}return u}function o(e,t,n){const r=new Array(n.length),o=new Array(n.length);for(let s=n.length-1,l=1;s>=0;--s)o[s]=l,r[s]=t[n[s]],l*=r[s];const a=n.map(((e,t)=>o[n.indexOf(t)])),i=new e.constructor(e.length);for(let s=0;s<e.length;++s){let n=0;for(let e=t.length-1,r=s;e>=0;--e)n+=r%t[e]*a[e],r=Math.floor(r/t[e]);i[n]=e[s]}return[i,r]}function a(e){const t=d(e)[0],n=e.map((e=>Math.exp(e-t))),r=n.reduce(((e,t)=>e+t),0),o=n.map((e=>e/r));return o}function i(e){const t=d(e)[0];let n=0;for(let a=0;a<e.length;++a)n+=Math.exp(e[a]-t);const r=Math.log(n),o=e.map((e=>e-t-r));return o}function s(e,t){let n=0;for(let r=0;r<e.length;++r)n+=e[r]*t[r];return n}function l(e,t){return s(e,t)/(c(e)*c(t))}function c(e){return Math.sqrt(e.reduce(((e,t)=>e+t*t),0))}function u(e){if(0===e.length)throw Error("Array must not be empty");let t=e[0],n=0;for(let r=1;r<e.length;++r)e[r]<t&&(t=e[r],n=r);return[t,n]}function d(e){if(0===e.length)throw Error("Array must not be empty");let t=e[0],n=0;for(let r=1;r<e.length;++r)e[r]>t&&(t=e[r],n=r);return[t,n]}function p(e){return e>0&&0===(e&e-1)}n.r(t),n.d(t,{FFT:()=>m,bankers_round:()=>v,cos_sim:()=>l,dot:()=>s,dynamic_time_warping:()=>y,interpolate_data:()=>r,log_softmax:()=>i,magnitude:()=>c,max:()=>d,medianFilter:()=>g,min:()=>u,permute_data:()=>o,round:()=>_,softmax:()=>a});class h{constructor(e){if(this.size=0|e,this.size<=1||!p(this.size))throw new Error("FFT size must be a power of two larger than 1");this._csize=e<<1,this.table=new Float64Array(2*this.size);for(let n=0;n<this.table.length;n+=2){const e=Math.PI*n/this.size;this.table[n]=Math.cos(e),this.table[n+1]=-Math.sin(e)}let t=0;for(let n=1;this.size>n;n<<=1)++t;this._width=t%2===0?t-1:t,this._bitrev=new Int32Array(1<<this._width);for(let n=0;n<this._bitrev.length;++n){this._bitrev[n]=0;for(let e=0;e<this._width;e+=2){const t=this._width-e-2;this._bitrev[n]|=(n>>>e&3)<<t}}}createComplexArray(){return new Float64Array(this._csize)}fromComplexArray(e,t){const n=t||new Array(e.length>>>1);for(let r=0;r<e.length;r+=2)n[r>>>1]=e[r];return n}toComplexArray(e,t){const n=t||this.createComplexArray();for(let r=0;r<n.length;r+=2)n[r]=e[r>>>1],n[r+1]=0;return n}transform(e,t){if(e===t)throw new Error("Input and output buffers must be different");this._transform4(e,t,1)}realTransform(e,t){if(e===t)throw new Error("Input and output buffers must be different");this._realTransform4(e,t,1)}inverseTransform(e,t){if(e===t)throw new Error("Input and output buffers must be different");this._transform4(e,t,-1);for(let n=0;n<e.length;++n)e[n]/=this.size}_transform4(e,t,n){const r=this._csize;let o,a,i=1<<this._width,s=r/i<<1;const l=this._bitrev;if(4===s)for(o=0,a=0;o<r;o+=s,++a){const n=l[a];this._singleTransform2(t,e,o,n,i)}else for(o=0,a=0;o<r;o+=s,++a){const r=l[a];this._singleTransform4(t,e,o,r,i,n)}const c=this.table;for(i>>=2;i>=2;i>>=2){s=r/i<<1;const t=s>>>2;for(o=0;o<r;o+=s){const r=o+t-1;for(let a=o,s=0;a<r;a+=2,s+=i){const r=a,o=r+t,i=o+t,l=i+t,u=e[r],d=e[r+1],p=e[o],h=e[o+1],f=e[i],m=e[i+1],g=e[l],_=e[l+1],v=c[s],y=n*c[s+1],w=p*v-h*y,b=p*y+h*v,x=c[2*s],k=n*c[2*s+1],C=f*x-m*k,D=f*k+m*x,S=c[3*s],E=n*c[3*s+1],T=g*S-_*E,A=g*E+_*S,M=u+C,F=d+D,I=u-C,P=d-D,z=w+T,O=b+A,N=n*(w-T),B=n*(b-A);e[r]=M+z,e[r+1]=F+O,e[o]=I+B,e[o+1]=P-N,e[i]=M-z,e[i+1]=F-O,e[l]=I-B,e[l+1]=P+N}}}}_singleTransform2(e,t,n,r,o){const a=e[r],i=e[r+1],s=e[r+o],l=e[r+o+1];t[n]=a+s,t[n+1]=i+l,t[n+2]=a-s,t[n+3]=i-l}_singleTransform4(e,t,n,r,o,a){const i=2*o,s=3*o,l=e[r],c=e[r+1],u=e[r+o],d=e[r+o+1],p=e[r+i],h=e[r+i+1],f=e[r+s],m=e[r+s+1],g=l+p,_=c+h,v=l-p,y=c-h,w=u+f,b=d+m,x=a*(u-f),k=a*(d-m);t[n]=g+w,t[n+1]=_+b,t[n+2]=v+k,t[n+3]=y-x,t[n+4]=g-w,t[n+5]=_-b,t[n+6]=v-k,t[n+7]=y+x}_realTransform4(e,t,n){const r=this._csize;let o,a,i=1<<this._width,s=r/i<<1;const l=this._bitrev;if(4===s)for(o=0,a=0;o<r;o+=s,++a){const n=l[a];this._singleRealTransform2(t,e,o,n>>>1,i>>>1)}else for(o=0,a=0;o<r;o+=s,++a){const r=l[a];this._singleRealTransform4(t,e,o,r>>>1,i>>>1,n)}const c=this.table;for(i>>=2;i>=2;i>>=2){s=r/i<<1;const t=s>>>1,a=t>>>1,l=a>>>1;for(o=0;o<r;o+=s)for(let r=0,s=0;r<=l;r+=2,s+=i){const i=o+r,u=i+a,d=u+a,p=d+a,h=e[i],f=e[i+1],m=e[u],g=e[u+1],_=e[d],v=e[d+1],y=e[p],w=e[p+1],b=h,x=f,k=c[s],C=n*c[s+1],D=m*k-g*C,S=m*C+g*k,E=c[2*s],T=n*c[2*s+1],A=_*E-v*T,M=_*T+v*E,F=c[3*s],I=n*c[3*s+1],P=y*F-w*I,z=y*I+w*F,O=b+A,N=x+M,B=b-A,j=x-M,L=D+P,R=S+z,V=n*(D-P),q=n*(S-z);if(e[i]=O+L,e[i+1]=N+R,e[u]=B+q,e[u+1]=j-V,0===r){e[d]=O-L,e[d+1]=N-R;continue}if(r===l)continue;const U=o+a-r,W=o+t-r;e[U]=B-n*q,e[U+1]=-j-n*V,e[W]=O-n*L,e[W+1]=n*R-N}}const u=r>>>1;for(let d=2;d<u;d+=2)e[r-d]=e[d],e[r-d+1]=-e[d+1]}_singleRealTransform2(e,t,n,r,o){const a=e[r],i=e[r+o];t[n]=a+i,t[n+1]=0,t[n+2]=a-i,t[n+3]=0}_singleRealTransform4(e,t,n,r,o,a){const i=2*o,s=3*o,l=e[r],c=e[r+o],u=e[r+i],d=e[r+s],p=l+u,h=l-u,f=c+d,m=a*(c-d);t[n]=p+f,t[n+1]=0,t[n+2]=h,t[n+3]=-m,t[n+4]=p-f,t[n+5]=0,t[n+6]=h,t[n+7]=m}}class f{constructor(e){const t=2*(e-1),n=2*(2*e-1),r=2**Math.ceil(Math.log2(n));this.bufferSize=r,this._a=t;const o=new Float64Array(n),a=new Float64Array(r);this._chirpBuffer=new Float64Array(r),this._buffer1=new Float64Array(r),this._buffer2=new Float64Array(r),this._outBuffer1=new Float64Array(r),this._outBuffer2=new Float64Array(r);const i=-2*Math.PI/e,s=Math.cos(i),l=Math.sin(i);for(let c=0;c<n>>1;++c){const t=(c+1-e)**2/2,n=Math.sqrt(s**2+l**2)**t,r=t*Math.atan2(l,s),i=2*c;o[i]=n*Math.cos(r),o[i+1]=n*Math.sin(r),a[i]=o[i],a[i+1]=-o[i+1]}this._slicedChirpBuffer=o.subarray(t,n),this._f=new h(r>>1),this._f.transform(this._chirpBuffer,a)}_transform(e,t,n){const r=this._buffer1,o=this._buffer2,a=this._outBuffer1,i=this._outBuffer2,s=this._chirpBuffer,l=this._slicedChirpBuffer,c=this._a;if(n)for(let u=0;u<l.length;u+=2){const e=u+1,n=t[u>>1];r[u]=n*l[u],r[e]=n*l[e]}else for(let u=0;u<l.length;u+=2){const e=u+1;r[u]=t[u]*l[u]-t[e]*l[e],r[e]=t[u]*l[e]+t[e]*l[u]}this._f.transform(a,r);for(let u=0;u<s.length;u+=2){const e=u+1;o[u]=a[u]*s[u]-a[e]*s[e],o[e]=a[u]*s[e]+a[e]*s[u]}this._f.inverseTransform(i,o);for(let u=0;u<i.length;u+=2){const t=i[u+c],n=i[u+c+1],r=l[u],o=l[u+1];e[u]=t*r-n*o,e[u+1]=t*o+n*r}}transform(e,t){this._transform(e,t,!1)}realTransform(e,t){this._transform(e,t,!0)}}class m{constructor(e){this.fft_length=e,this.isPowerOfTwo=p(e),this.isPowerOfTwo?(this.fft=new h(e),this.outputBufferSize=2*e):(this.fft=new f(e),this.outputBufferSize=this.fft.bufferSize)}realTransform(e,t){this.fft.realTransform(e,t)}transform(e,t){this.fft.transform(e,t)}}function g(e,t){if(t%2===0||t<=0)throw new Error("Window size must be a positive odd number");const n=new e.constructor(e.length),r=new e.constructor(t),o=Math.floor(t/2);for(let a=0;a<e.length;++a){let t=0;for(let n=-o;n<=o;++n){let o=a+n;o<0?o=Math.abs(o):o>=e.length&&(o=2*(e.length-1)-o),r[t++]=e[o]}r.sort(),n[a]=r[o]}return n}function _(e,t){const n=Math.pow(10,t);return Math.round(e*n)/n}function v(e){const t=Math.round(e);return Math.abs(e)%1===.5?t%2===0?t:t-1:t}function y(e){const t=e.length,n=e[0].length,r=[t+1,n+1],o=Array.from({length:r[0]},(()=>Array(r[1]).fill(1/0)));o[0][0]=0;const a=Array.from({length:r[0]},(()=>Array(r[1]).fill(-1)));for(let u=1;u<r[1];++u)for(let t=1;t<r[0];++t){const n=o[t-1][u-1],r=o[t-1][u],i=o[t][u-1];let s,l;n<r&&n<i?(s=n,l=0):r<n&&r<i?(s=r,l=1):(s=i,l=2),o[t][u]=e[t-1][u-1]+s,a[t][u]=l}for(let u=0;u<r[1];++u)a[0][u]=2;for(let u=0;u<r[0];++u)a[u][0]=1;let i=t,s=n,l=[],c=[];for(;i>0||s>0;)switch(l.push(i-1),c.push(s-1),a[i][s]){case 0:--i,--s;break;case 1:--i;break;case 2:--s;break;default:throw new Error("Internal error in dynamic time warping. Unexpected trace[".concat(i,", ").concat(s,"]. Please file a bug report."))}return l.reverse(),c.reverse(),[l,c]}},"./src/utils/tensor.js":(e,t,n)=>{n.r(t),n.d(t,{DataTypeMap:()=>i,Tensor:()=>s,cat:()=>b,full:()=>E,full_like:()=>T,interpolate:()=>c,interpolate_4d:()=>u,layer_norm:()=>_,matmul:()=>d,mean:()=>D,mean_pooling:()=>g,ones:()=>A,ones_like:()=>M,permute:()=>l,quantize_embeddings:()=>z,rand:()=>P,rfft:()=>p,slice:()=>m,stack:()=>x,std_mean:()=>C,topk:()=>h,zeros:()=>F,zeros_like:()=>I});var r=n("./src/utils/maths.js"),o=n("./src/backends/onnx.js"),a=n("./src/ops/registry.js");const i=Object.freeze({float32:Float32Array,float16:"undefined"!==typeof Float16Array?Float16Array:Uint16Array,float64:Float64Array,string:Array,int8:Int8Array,uint8:Uint8Array,int16:Int16Array,uint16:Uint16Array,int32:Int32Array,uint32:Uint32Array,int64:BigInt64Array,uint64:BigUint64Array,bool:Uint8Array,uint4:Uint8Array,int4:Int8Array});class s{get dims(){return this.ort_tensor.dims}set dims(e){this.ort_tensor.dims=e}get type(){return this.ort_tensor.type}get data(){return this.ort_tensor.data}get size(){return this.ort_tensor.size}get location(){return this.ort_tensor.location}constructor(){return ao(this,"ort_tensor",void 0),(0,o.isONNXTensor)(arguments.length<=0?void 0:arguments[0])?this.ort_tensor=arguments.length<=0?void 0:arguments[0]:this.ort_tensor=new o.Tensor(arguments.length<=0?void 0:arguments[0],arguments.length<=1?void 0:arguments[1],arguments.length<=2?void 0:arguments[2]),new Proxy(this,{get:(e,t)=>{if("string"===typeof t){let n=Number(t);if(Number.isInteger(n))return e._getitem(n)}return e[t]},set:(e,t,n)=>e[t]=n})}dispose(){this.ort_tensor.dispose()}*[Symbol.iterator](){const[e,...t]=this.dims;if(t.length>0){const n=t.reduce(((e,t)=>e*t));for(let r=0;r<e;++r)yield this._subarray(r,n,t)}else yield*this.data}_getitem(e){const[t,...n]=this.dims;if(e=w(e,t),n.length>0){const t=n.reduce(((e,t)=>e*t));return this._subarray(e,t,n)}return new s(this.type,[this.data[e]],n)}indexOf(e){const t=this.data;for(let n=0;n<t.length;++n)if(t[n]==e)return n;return-1}_subarray(e,t,n){const r=e*t,o=(e+1)*t,a="subarray"in this.data?this.data.subarray(r,o):this.data.slice(r,o);return new s(this.type,a,n)}item(){const e=this.data;if(1!==e.length)throw new Error("a Tensor with ".concat(e.length," elements cannot be converted to Scalar"));return e[0]}tolist(){return function(e,t){const n=e.length,r=t.reduce(((e,t)=>e*t));if(n!==r)throw Error("cannot reshape array of size ".concat(n," into shape (").concat(t,")"));let o=e;for(let a=t.length-1;a>=0;a--)o=o.reduce(((e,n)=>{let r=e[e.length-1];return r.length<t[a]?r.push(n):e.push([n]),e}),[[]]);return o[0]}(this.data,this.dims)}sigmoid(){return this.clone().sigmoid_()}sigmoid_(){const e=this.data;for(let t=0;t<e.length;++t)e[t]=1/(1+Math.exp(-e[t]));return this}map(e){return this.clone().map_(e)}map_(e){const t=this.data;for(let n=0;n<t.length;++n)t[n]=e(t[n],n,t);return this}mul(e){return this.clone().mul_(e)}mul_(e){const t=this.data;for(let n=0;n<t.length;++n)t[n]*=e;return this}div(e){return this.clone().div_(e)}div_(e){const t=this.data;for(let n=0;n<t.length;++n)t[n]/=e;return this}add(e){return this.clone().add_(e)}add_(e){const t=this.data;for(let n=0;n<t.length;++n)t[n]+=e;return this}sub(e){return this.clone().sub_(e)}sub_(e){const t=this.data;for(let n=0;n<t.length;++n)t[n]-=e;return this}clone(){return new s(this.type,this.data.slice(),this.dims.slice())}slice(){const e=[],t=[];for(let s=0;s<this.dims.length;++s){let n=s<0||arguments.length<=s?void 0:arguments[s];if(null===n||void 0===n)t.push([0,this.dims[s]]),e.push(this.dims[s]);else if("number"===typeof n)n=w(n,this.dims[s],s),t.push([n,n+1]);else{if(!Array.isArray(n)||2!==n.length)throw new Error("Invalid slice: ".concat(n));{let[r,o]=n;if(r=null===r?0:w(r,this.dims[s],s,!1),o=null===o?this.dims[s]:w(o,this.dims[s],s,!1),r>o)throw new Error("Invalid slice: ".concat(n));const a=[Math.max(r,0),Math.min(o,this.dims[s])];t.push(a),e.push(a[1]-a[0])}}}const n=t.map((e=>{let[t,n]=e;return n-t})),r=n.reduce(((e,t)=>e*t)),o=this.data,a=new o.constructor(r),i=this.stride();for(let s=0;s<r;++s){let e=0;for(let r=n.length-1,o=s;r>=0;--r){const a=n[r];e+=(o%a+t[r][0])*i[r],o=Math.floor(o/a)}a[s]=o[e]}return new s(this.type,a,e)}permute(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return l(this,t)}transpose(){return this.permute(...arguments)}sum(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.norm(1,e,t)}norm(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"fro",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if("fro"===e)e=2;else if("string"===typeof e)throw Error("Unsupported norm: ".concat(e));const r=this.data,o=(t,n)=>t+n**e;if(null===t){const t=r.reduce(o,0)**(1/e);return new s(this.type,[t],[])}const[a,i,l]=k(o,this,t,n);if(1!==e)for(let s=0;s<i.length;++s)i[s]=i[s]**(1/e);return new s(a,i,l)}normalize_(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;t=w(t,this.dims.length);const n=this.norm(e,t,!0),r=this.data,o=n.data;for(let a=0;a<r.length;++a){let e=0;for(let n=this.dims.length-1,r=a,o=1;n>=0;--n){const a=this.dims[n];if(n!==t){e+=r%a*o,o*=this.dims[n]}r=Math.floor(r/a)}r[a]/=o[e]}return this}normalize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return this.clone().normalize_(e,t)}stride(){return function(e){const t=new Array(e.length);for(let n=e.length-1,r=1;n>=0;--n)t[n]=r,r*=e[n];return t}(this.dims)}squeeze(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return new s(this.type,this.data,v(this.dims,e))}squeeze_(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return this.dims=v(this.dims,e),this}unsqueeze(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return new s(this.type,this.data,y(this.dims,e))}unsqueeze_(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return this.dims=y(this.dims,e),this}flatten_(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;t=(t+this.dims.length)%this.dims.length;let n=this.dims.slice(0,e),r=this.dims.slice(e,t+1),o=this.dims.slice(t+1);return this.dims=[...n,r.reduce(((e,t)=>e*t),1),...o],this}flatten(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;return this.clone().flatten_(e,t)}view(){let e=-1;for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(let a=0;a<n.length;++a)if(-1===n[a]){if(-1!==e)throw new Error("Only one dimension can be inferred");e=a}const o=this.data;if(-1!==e){const t=n.reduce(((t,n,r)=>r!==e?t*n:t),1);n[e]=o.length/t}return new s(this.type,o,n)}neg_(){const e=this.data;for(let t=0;t<e.length;++t)e[t]=-e[t];return this}neg(){return this.clone().neg_()}gt(e){const t=new Uint8Array(this.data.length),n=this.data;for(let r=0;r<n.length;++r)t[r]=n[r]>e?1:0;return new s("bool",t,this.dims)}lt(e){const t=new Uint8Array(this.data.length),n=this.data;for(let r=0;r<n.length;++r)t[r]=n[r]<e?1:0;return new s("bool",t,this.dims)}clamp_(e,t){const n=this.data;for(let r=0;r<n.length;++r)n[r]=Math.min(Math.max(n[r],e),t);return this}clamp(e,t){return this.clone().clamp_(e,t)}round_(){const e=this.data;for(let t=0;t<e.length;++t)e[t]=Math.round(e[t]);return this}round(){return this.clone().round_()}mean(){return D(this,arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,arguments.length>1&&void 0!==arguments[1]&&arguments[1])}min(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(null===e){const e=(0,r.min)(this.data)[0];return new s(this.type,[e],[])}const[n,o,a]=k(((e,t)=>Math.min(e,t)),this,e,t,1/0);return new s(n,o,a)}max(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(null===e){const e=(0,r.max)(this.data)[0];return new s(this.type,[e],[])}const[n,o,a]=k(((e,t)=>Math.max(e,t)),this,e,t,-1/0);return new s(n,o,a)}argmin(){if(null!==(arguments.length>0&&void 0!==arguments[0]?arguments[0]:null))throw new Error("`dim !== null` not yet implemented.");const e=(0,r.min)(this.data)[1];return new s("int64",[BigInt(e)],[])}argmax(){if(null!==(arguments.length>0&&void 0!==arguments[0]?arguments[0]:null))throw new Error("`dim !== null` not yet implemented.");const e=(0,r.max)(this.data)[1];return new s("int64",[BigInt(e)],[])}to(e){if(this.type===e)return this;if(!i.hasOwnProperty(e))throw new Error("Unsupported type: ".concat(e));let t;const n=["int64","uint64"].includes(this.type),r=["int64","uint64"].includes(e);return n&&!r?t=Number:!n&&r&&(t=BigInt),new s(e,i[e].from(this.data,t),this.dims)}}function l(e,t){const[n,o]=(0,r.permute_data)(e.data,e.dims,t);return new s(e.type,n,o)}function c(e,t){var n;let[o,a]=t,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"bilinear",l=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const c=null!==(n=e.dims.at(-3))&&void 0!==n?n:1,u=e.dims.at(-2),d=e.dims.at(-1);let p=(0,r.interpolate_data)(e.data,[c,u,d],[o,a],i,l);return new s(e.type,p,[c,o,a])}async function u(e){let t,n,{size:r=null,mode:o="bilinear"}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(4!==e.dims.length)throw new Error("`interpolate_4d` currently only supports 4D input.");if(!r)throw new Error("`interpolate_4d` requires a `size` argument.");if(2===r.length)t=[...e.dims.slice(0,2),...r];else if(3===r.length)t=[e.dims[0],...r];else{if(4!==r.length)throw new Error("`size` must be of length 2, 3, or 4.");t=r}if("nearest"===o)n=await a.TensorOpRegistry.nearest_interpolate_4d;else if("bilinear"===o)n=await a.TensorOpRegistry.bilinear_interpolate_4d;else{if("bicubic"!==o)throw new Error("Unsupported mode: ".concat(o));n=await a.TensorOpRegistry.bicubic_interpolate_4d}const i=new s("int64",new BigInt64Array(t.map(BigInt)),[t.length]);return await n({x:e,s:i})}async function d(e,t){const n=await a.TensorOpRegistry.matmul;return await n({a:e,b:t})}async function p(e,t){const n=await a.TensorOpRegistry.rfft;return await n({x:e,a:t})}async function h(e,t){const n=await a.TensorOpRegistry.top_k;return t=null==t?e.dims.at(-1):Math.min(t,e.dims.at(-1)),await n({x:e,k:new s("int64",[BigInt(t)],[1])})}const f=e=>new s("int64",e,[e.length]);async function m(e,t,n,r,o){const i=await a.TensorOpRegistry.slice;return await i({x:e,s:f(t),e:f(n),a:f(r),t:f(null!==o&&void 0!==o?o:new Array(r.length).fill(1))})}function g(e,t){const n=e.data,r=t.data,o=[e.dims[0],e.dims[2]],a=new n.constructor(o[0]*o[1]),[i,l,c]=e.dims;let u=0;for(let s=0;s<i;++s){const e=s*c*l;for(let t=0;t<c;++t){let o=0,i=0;const d=s*l,p=e+t;for(let e=0;e<l;++e){const t=Number(r[d+e]);i+=t,o+=n[p+e*c]*t}const h=o/i;a[u++]=h}}return new s(e.type,a,o)}function _(e,t){let{eps:n=1e-5}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(2!==e.dims.length)throw new Error("`layer_norm` currently only supports 2D input.");const[r,o]=e.dims;if(1!==t.length&&t[0]!==o)throw new Error("`normalized_shape` must be a 1D array with shape `[input.dims[1]]`.");const[a,i]=C(e,1,0,!0),l=a.data,c=i.data,u=e.data,d=new u.constructor(u.length);for(let s=0;s<r;++s){const e=s*o;for(let t=0;t<o;++t){const r=e+t;d[r]=(u[r]-c[s])/(l[s]+n)}}return new s(e.type,d,e.dims)}function v(e,t){return e=e.slice(),null===t?e=e.filter((e=>1!==e)):"number"===typeof t?1===e[t]&&e.splice(t,1):Array.isArray(t)&&(e=e.filter(((e,n)=>1!==e||!t.includes(n)))),e}function y(e,t){return t=w(t,e.length+1),(e=e.slice()).splice(t,0,1),e}function w(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(e<-t||e>=t){if(!(arguments.length>3&&void 0!==arguments[3])||arguments[3])throw new Error("IndexError: index ".concat(e," is out of bounds for dimension").concat(null===n?"":" "+n," with size ").concat(t));return e<-t?0:t}return e<0&&(e=(e%t+t)%t),e}function b(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;t=w(t,e[0].dims.length);const n=e[0].dims.slice();n[t]=e.reduce(((e,n)=>e+n.dims[t]),0);const r=n.reduce(((e,t)=>e*t),1),o=new e[0].data.constructor(r),a=e[0].type;if(0===t){let t=0;for(const n of e){const e=n.data;o.set(e,t),t+=e.length}}else{let r=0;for(let a=0;a<e.length;++a){const{data:i,dims:s}=e[a];for(let e=0;e<i.length;++e){let a=0;for(let o=s.length-1,i=e,l=1;o>=0;--o){const e=s[o];let c=i%e;o===t&&(c+=r),a+=c*l,l*=n[o],i=Math.floor(i/e)}o[a]=i[e]}r+=s[t]}}return new s(a,o,n)}function x(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return b(e.map((e=>e.unsqueeze(t))),t)}function k(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;const a=t.data,i=t.dims;n=w(n,i.length);const s=i.slice();s[n]=1;const l=new a.constructor(a.length/i[n]);null!==o&&l.fill(o);for(let c=0;c<a.length;++c){let t=0;for(let e=i.length-1,r=c,o=1;e>=0;--e){const a=i[e];if(e!==n){t+=r%a*o,o*=s[e]}r=Math.floor(r/a)}l[t]=e(l[t],a[c],c,t)}return r||s.splice(n,1),[t.type,l,s]}function C(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const o=e.data,a=e.dims;if(null===t){const t=o.reduce(((e,t)=>e+t),0),r=t/o.length,a=Math.sqrt(o.reduce(((e,t)=>e+(t-r)**2),0)/(o.length-n)),i=new s(e.type,[r],[]);return[new s(e.type,[a],[]),i]}t=w(t,a.length);const i=D(e,t,r),l=i.data,[c,u,d]=k(((e,t,n,r)=>e+(t-l[r])**2),e,t,r);for(let s=0;s<u.length;++s)u[s]=Math.sqrt(u[s]/(a[t]-n));return[new s(c,u,d),i]}function D(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=e.dims,o=e.data;if(null===t){const t=o.reduce(((e,t)=>e+t),0);return new s(e.type,[t/o.length],[])}t=w(t,r.length);const[a,i,l]=k(((e,t)=>e+t),e,t,n);if(1!==r[t])for(let s=0;s<i.length;++s)i[s]/=r[t];return new s(a,i,l)}function S(e,t,n,r){const o=e.reduce(((e,t)=>e*t),1);return new s(n,new r(o).fill(t),e)}function E(e,t){let n,r;if("number"===typeof t)n="float32",r=Float32Array;else if("bigint"===typeof t)n="int64",r=BigInt64Array;else{if("boolean"!==typeof t)throw new Error("Unsupported data type: ".concat(typeof t));n="bool",r=Uint8Array}return S(e,t,n,r)}function T(e,t){return E(e.dims,t)}function A(e){return S(e,1n,"int64",BigInt64Array)}function M(e){return A(e.dims)}function F(e){return S(e,0n,"int64",BigInt64Array)}function I(e){return F(e.dims)}function P(e){const t=e.reduce(((e,t)=>e*t),1);return new s("float32",Float32Array.from({length:t},(()=>Math.random())),e)}function z(e,t){if(2!==e.dims.length)throw new Error("The tensor must have 2 dimensions");if(e.dims.at(-1)%8!==0)throw new Error("The last dimension of the tensor must be a multiple of 8");if(!["binary","ubinary"].includes(t))throw new Error("The precision must be either 'binary' or 'ubinary'");const n="binary"===t,r=n?"int8":"uint8",o=n?Int8Array:Uint8Array,a=e.data,i=new o(a.length/8);for(let s=0;s<a.length;++s){const e=a[s]>0?1:0,t=Math.floor(s/8),r=s%8;i[t]|=e<<7-r,n&&0===r&&(i[t]-=128)}return new s(r,i,[e.dims[0],e.dims[1]/8])}},"./src/utils/video.js":(e,t,n)=>{n.r(t),n.d(t,{RawVideo:()=>i,RawVideoFrame:()=>a,load_video:()=>s});var r=n("./src/utils/image.js"),o=n("./src/env.js");class a{constructor(e,t){this.image=e,this.timestamp=t}}class i{constructor(e,t){e.length>0&&e[0]instanceof r.RawImage&&(e=e.map(((n,r)=>new a(n,(r+1)/(e.length+1)*t)))),this.frames=e,this.duration=t}get width(){return this.frames[0].image.width}get height(){return this.frames[0].image.height}get fps(){return this.frames.length/this.duration}}async function s(e){let{num_frames:t=null,fps:n=null}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!o.apis.IS_BROWSER_ENV)throw new Error("`load_video` is currently only supported in browser environments.");if(null==t&&null==n)throw new Error("Either num_frames or fps must be provided.");const s=[],l=document.createElement("video");if(l.crossOrigin="anonymous",l.muted=!0,"string"===typeof e)l.src=e;else if(e instanceof Blob)l.src=URL.createObjectURL(e);else{if(!(e instanceof HTMLVideoElement))throw new Error("Invalid URL or video element provided.");l.src=e.src}if(await new Promise((e=>l.onloadedmetadata=e)),l.seekable.start(0)===l.seekable.end(0)){const e=await fetch(l.src),t=await e.blob();l.src=URL.createObjectURL(t),await new Promise((e=>l.onloadedmetadata=e))}const c=l.duration;let u,d;null!=t?(u=t,d=1===t?0:c/(t-1)):(d=1/n,u=Math.floor(c/d));let p=[];for(let r=0;r<u;++r)p.push(1===t?c/2:r*d);const h=document.createElement("canvas");h.width=l.videoWidth,h.height=l.videoHeight;const f=h.getContext("2d",{willReadFrequently:!0});for(const o of p){l.currentTime=o,await new Promise((e=>{l.onseeked=e})),f.drawImage(l,0,0,h.width,h.height);const e=f.getImageData(0,0,h.width,h.height),t=new r.RawImage(e.data,h.width,h.height,4),n=new a(t,o);s.push(n)}return l.remove(),new i(s,c)}}},t={};function tB(n){var r=t[n];if(void 0!==r)return r.exports;var o=t[n]={exports:{}};return e[n](o,o.exports,tB),o.exports}(()=>{var e,t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__;tB.t=function(n,r){if(1&r&&(n=this(n)),8&r)return n;if("object"===typeof n&&n){if(4&r&&n.__esModule)return n;if(16&r&&"function"===typeof n.then)return n}var o=Object.create(null);tB.r(o);var a={};e=e||[null,t({}),t([]),t(t)];for(var i=2&r&&n;"object"==typeof i&&!~e.indexOf(i);i=t(i))Object.getOwnPropertyNames(i).forEach((e=>a[e]=()=>n[e]));return a.default=()=>n,tB.d(o,a),o}})(),tB.d=(e,t)=>{for(var n in t)tB.o(t,n)&&!tB.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},tB.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),tB.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var nB={};(()=>{tB.r(nB),tB.d(nB,{ASTFeatureExtractor:()=>d.ASTFeatureExtractor,ASTForAudioClassification:()=>n.ASTForAudioClassification,ASTModel:()=>n.ASTModel,ASTPreTrainedModel:()=>n.ASTPreTrainedModel,AlbertForMaskedLM:()=>n.AlbertForMaskedLM,AlbertForQuestionAnswering:()=>n.AlbertForQuestionAnswering,AlbertForSequenceClassification:()=>n.AlbertForSequenceClassification,AlbertModel:()=>n.AlbertModel,AlbertPreTrainedModel:()=>n.AlbertPreTrainedModel,AlbertTokenizer:()=>r.AlbertTokenizer,AudioClassificationPipeline:()=>t.AudioClassificationPipeline,AutoConfig:()=>o.AutoConfig,AutoFeatureExtractor:()=>p.AutoFeatureExtractor,AutoImageProcessor:()=>m.AutoImageProcessor,AutoModel:()=>n.AutoModel,AutoModelForAudioClassification:()=>n.AutoModelForAudioClassification,AutoModelForAudioFrameClassification:()=>n.AutoModelForAudioFrameClassification,AutoModelForAudioTextToText:()=>n.AutoModelForAudioTextToText,AutoModelForCTC:()=>n.AutoModelForCTC,AutoModelForCausalLM:()=>n.AutoModelForCausalLM,AutoModelForDepthEstimation:()=>n.AutoModelForDepthEstimation,AutoModelForDocumentQuestionAnswering:()=>n.AutoModelForDocumentQuestionAnswering,AutoModelForImageClassification:()=>n.AutoModelForImageClassification,AutoModelForImageFeatureExtraction:()=>n.AutoModelForImageFeatureExtraction,AutoModelForImageMatting:()=>n.AutoModelForImageMatting,AutoModelForImageSegmentation:()=>n.AutoModelForImageSegmentation,AutoModelForImageTextToText:()=>n.AutoModelForImageTextToText,AutoModelForImageToImage:()=>n.AutoModelForImageToImage,AutoModelForMaskGeneration:()=>n.AutoModelForMaskGeneration,AutoModelForMaskedLM:()=>n.AutoModelForMaskedLM,AutoModelForNormalEstimation:()=>n.AutoModelForNormalEstimation,AutoModelForObjectDetection:()=>n.AutoModelForObjectDetection,AutoModelForPoseEstimation:()=>n.AutoModelForPoseEstimation,AutoModelForQuestionAnswering:()=>n.AutoModelForQuestionAnswering,AutoModelForSemanticSegmentation:()=>n.AutoModelForSemanticSegmentation,AutoModelForSeq2SeqLM:()=>n.AutoModelForSeq2SeqLM,AutoModelForSequenceClassification:()=>n.AutoModelForSequenceClassification,AutoModelForSpeechSeq2Seq:()=>n.AutoModelForSpeechSeq2Seq,AutoModelForTextToSpectrogram:()=>n.AutoModelForTextToSpectrogram,AutoModelForTextToWaveform:()=>n.AutoModelForTextToWaveform,AutoModelForTokenClassification:()=>n.AutoModelForTokenClassification,AutoModelForUniversalSegmentation:()=>n.AutoModelForUniversalSegmentation,AutoModelForVision2Seq:()=>n.AutoModelForVision2Seq,AutoModelForXVector:()=>n.AutoModelForXVector,AutoModelForZeroShotObjectDetection:()=>n.AutoModelForZeroShotObjectDetection,AutoProcessor:()=>v.AutoProcessor,AutoTokenizer:()=>r.AutoTokenizer,AutomaticSpeechRecognitionPipeline:()=>t.AutomaticSpeechRecognitionPipeline,BackgroundRemovalPipeline:()=>t.BackgroundRemovalPipeline,BartForConditionalGeneration:()=>n.BartForConditionalGeneration,BartForSequenceClassification:()=>n.BartForSequenceClassification,BartModel:()=>n.BartModel,BartPretrainedModel:()=>n.BartPretrainedModel,BartTokenizer:()=>r.BartTokenizer,BaseModelOutput:()=>n.BaseModelOutput,BaseStreamer:()=>y.BaseStreamer,BeitFeatureExtractor:()=>f.BeitFeatureExtractor,BeitForImageClassification:()=>n.BeitForImageClassification,BeitModel:()=>n.BeitModel,BeitPreTrainedModel:()=>n.BeitPreTrainedModel,BertForMaskedLM:()=>n.BertForMaskedLM,BertForQuestionAnswering:()=>n.BertForQuestionAnswering,BertForSequenceClassification:()=>n.BertForSequenceClassification,BertForTokenClassification:()=>n.BertForTokenClassification,BertModel:()=>n.BertModel,BertPreTrainedModel:()=>n.BertPreTrainedModel,BertTokenizer:()=>r.BertTokenizer,BitImageProcessor:()=>f.BitImageProcessor,BlenderbotForConditionalGeneration:()=>n.BlenderbotForConditionalGeneration,BlenderbotModel:()=>n.BlenderbotModel,BlenderbotPreTrainedModel:()=>n.BlenderbotPreTrainedModel,BlenderbotSmallForConditionalGeneration:()=>n.BlenderbotSmallForConditionalGeneration,BlenderbotSmallModel:()=>n.BlenderbotSmallModel,BlenderbotSmallPreTrainedModel:()=>n.BlenderbotSmallPreTrainedModel,BlenderbotSmallTokenizer:()=>r.BlenderbotSmallTokenizer,BlenderbotTokenizer:()=>r.BlenderbotTokenizer,BloomForCausalLM:()=>n.BloomForCausalLM,BloomModel:()=>n.BloomModel,BloomPreTrainedModel:()=>n.BloomPreTrainedModel,BloomTokenizer:()=>r.BloomTokenizer,CLIPFeatureExtractor:()=>f.CLIPFeatureExtractor,CLIPImageProcessor:()=>f.CLIPImageProcessor,CLIPModel:()=>n.CLIPModel,CLIPPreTrainedModel:()=>n.CLIPPreTrainedModel,CLIPSegForImageSegmentation:()=>n.CLIPSegForImageSegmentation,CLIPSegModel:()=>n.CLIPSegModel,CLIPSegPreTrainedModel:()=>n.CLIPSegPreTrainedModel,CLIPTextModel:()=>n.CLIPTextModel,CLIPTextModelWithProjection:()=>n.CLIPTextModelWithProjection,CLIPTokenizer:()=>r.CLIPTokenizer,CLIPVisionModel:()=>n.CLIPVisionModel,CLIPVisionModelWithProjection:()=>n.CLIPVisionModelWithProjection,CamembertForMaskedLM:()=>n.CamembertForMaskedLM,CamembertForQuestionAnswering:()=>n.CamembertForQuestionAnswering,CamembertForSequenceClassification:()=>n.CamembertForSequenceClassification,CamembertForTokenClassification:()=>n.CamembertForTokenClassification,CamembertModel:()=>n.CamembertModel,CamembertPreTrainedModel:()=>n.CamembertPreTrainedModel,CamembertTokenizer:()=>r.CamembertTokenizer,CausalLMOutput:()=>n.CausalLMOutput,CausalLMOutputWithPast:()=>n.CausalLMOutputWithPast,ChineseCLIPFeatureExtractor:()=>f.ChineseCLIPFeatureExtractor,ChineseCLIPModel:()=>n.ChineseCLIPModel,ChineseCLIPPreTrainedModel:()=>n.ChineseCLIPPreTrainedModel,ClapAudioModelWithProjection:()=>n.ClapAudioModelWithProjection,ClapFeatureExtractor:()=>d.ClapFeatureExtractor,ClapModel:()=>n.ClapModel,ClapPreTrainedModel:()=>n.ClapPreTrainedModel,ClapTextModelWithProjection:()=>n.ClapTextModelWithProjection,ClassifierFreeGuidanceLogitsProcessor:()=>b.ClassifierFreeGuidanceLogitsProcessor,CodeGenForCausalLM:()=>n.CodeGenForCausalLM,CodeGenModel:()=>n.CodeGenModel,CodeGenPreTrainedModel:()=>n.CodeGenPreTrainedModel,CodeGenTokenizer:()=>r.CodeGenTokenizer,CodeLlamaTokenizer:()=>r.CodeLlamaTokenizer,CohereForCausalLM:()=>n.CohereForCausalLM,CohereModel:()=>n.CohereModel,CoherePreTrainedModel:()=>n.CoherePreTrainedModel,CohereTokenizer:()=>r.CohereTokenizer,ConvBertForMaskedLM:()=>n.ConvBertForMaskedLM,ConvBertForQuestionAnswering:()=>n.ConvBertForQuestionAnswering,ConvBertForSequenceClassification:()=>n.ConvBertForSequenceClassification,ConvBertForTokenClassification:()=>n.ConvBertForTokenClassification,ConvBertModel:()=>n.ConvBertModel,ConvBertPreTrainedModel:()=>n.ConvBertPreTrainedModel,ConvBertTokenizer:()=>r.ConvBertTokenizer,ConvNextFeatureExtractor:()=>f.ConvNextFeatureExtractor,ConvNextForImageClassification:()=>n.ConvNextForImageClassification,ConvNextImageProcessor:()=>f.ConvNextImageProcessor,ConvNextModel:()=>n.ConvNextModel,ConvNextPreTrainedModel:()=>n.ConvNextPreTrainedModel,ConvNextV2ForImageClassification:()=>n.ConvNextV2ForImageClassification,ConvNextV2Model:()=>n.ConvNextV2Model,ConvNextV2PreTrainedModel:()=>n.ConvNextV2PreTrainedModel,DFineForObjectDetection:()=>n.DFineForObjectDetection,DFineModel:()=>n.DFineModel,DFinePreTrainedModel:()=>n.DFinePreTrainedModel,DPTFeatureExtractor:()=>f.DPTFeatureExtractor,DPTForDepthEstimation:()=>n.DPTForDepthEstimation,DPTImageProcessor:()=>f.DPTImageProcessor,DPTModel:()=>n.DPTModel,DPTPreTrainedModel:()=>n.DPTPreTrainedModel,DacDecoderModel:()=>n.DacDecoderModel,DacDecoderOutput:()=>n.DacDecoderOutput,DacEncoderModel:()=>n.DacEncoderModel,DacEncoderOutput:()=>n.DacEncoderOutput,DacFeatureExtractor:()=>d.DacFeatureExtractor,DacModel:()=>n.DacModel,DacPreTrainedModel:()=>n.DacPreTrainedModel,DataTypeMap:()=>l.DataTypeMap,DebertaForMaskedLM:()=>n.DebertaForMaskedLM,DebertaForQuestionAnswering:()=>n.DebertaForQuestionAnswering,DebertaForSequenceClassification:()=>n.DebertaForSequenceClassification,DebertaForTokenClassification:()=>n.DebertaForTokenClassification,DebertaModel:()=>n.DebertaModel,DebertaPreTrainedModel:()=>n.DebertaPreTrainedModel,DebertaTokenizer:()=>r.DebertaTokenizer,DebertaV2ForMaskedLM:()=>n.DebertaV2ForMaskedLM,DebertaV2ForQuestionAnswering:()=>n.DebertaV2ForQuestionAnswering,DebertaV2ForSequenceClassification:()=>n.DebertaV2ForSequenceClassification,DebertaV2ForTokenClassification:()=>n.DebertaV2ForTokenClassification,DebertaV2Model:()=>n.DebertaV2Model,DebertaV2PreTrainedModel:()=>n.DebertaV2PreTrainedModel,DebertaV2Tokenizer:()=>r.DebertaV2Tokenizer,DecisionTransformerModel:()=>n.DecisionTransformerModel,DecisionTransformerPreTrainedModel:()=>n.DecisionTransformerPreTrainedModel,DeiTFeatureExtractor:()=>f.DeiTFeatureExtractor,DeiTForImageClassification:()=>n.DeiTForImageClassification,DeiTImageProcessor:()=>f.DeiTImageProcessor,DeiTModel:()=>n.DeiTModel,DeiTPreTrainedModel:()=>n.DeiTPreTrainedModel,DepthAnythingForDepthEstimation:()=>n.DepthAnythingForDepthEstimation,DepthAnythingPreTrainedModel:()=>n.DepthAnythingPreTrainedModel,DepthEstimationPipeline:()=>t.DepthEstimationPipeline,DepthProForDepthEstimation:()=>n.DepthProForDepthEstimation,DepthProPreTrainedModel:()=>n.DepthProPreTrainedModel,DetrFeatureExtractor:()=>f.DetrFeatureExtractor,DetrForObjectDetection:()=>n.DetrForObjectDetection,DetrForSegmentation:()=>n.DetrForSegmentation,DetrImageProcessor:()=>f.DetrImageProcessor,DetrModel:()=>n.DetrModel,DetrObjectDetectionOutput:()=>n.DetrObjectDetectionOutput,DetrPreTrainedModel:()=>n.DetrPreTrainedModel,DetrSegmentationOutput:()=>n.DetrSegmentationOutput,Dinov2ForImageClassification:()=>n.Dinov2ForImageClassification,Dinov2Model:()=>n.Dinov2Model,Dinov2PreTrainedModel:()=>n.Dinov2PreTrainedModel,Dinov2WithRegistersForImageClassification:()=>n.Dinov2WithRegistersForImageClassification,Dinov2WithRegistersModel:()=>n.Dinov2WithRegistersModel,Dinov2WithRegistersPreTrainedModel:()=>n.Dinov2WithRegistersPreTrainedModel,DistilBertForMaskedLM:()=>n.DistilBertForMaskedLM,DistilBertForQuestionAnswering:()=>n.DistilBertForQuestionAnswering,DistilBertForSequenceClassification:()=>n.DistilBertForSequenceClassification,DistilBertForTokenClassification:()=>n.DistilBertForTokenClassification,DistilBertModel:()=>n.DistilBertModel,DistilBertPreTrainedModel:()=>n.DistilBertPreTrainedModel,DistilBertTokenizer:()=>r.DistilBertTokenizer,DocumentQuestionAnsweringPipeline:()=>t.DocumentQuestionAnsweringPipeline,DonutFeatureExtractor:()=>f.DonutFeatureExtractor,DonutImageProcessor:()=>f.DonutImageProcessor,DonutSwinModel:()=>n.DonutSwinModel,DonutSwinPreTrainedModel:()=>n.DonutSwinPreTrainedModel,EfficientNetForImageClassification:()=>n.EfficientNetForImageClassification,EfficientNetImageProcessor:()=>f.EfficientNetImageProcessor,EfficientNetModel:()=>n.EfficientNetModel,EfficientNetPreTrainedModel:()=>n.EfficientNetPreTrainedModel,ElectraForMaskedLM:()=>n.ElectraForMaskedLM,ElectraForQuestionAnswering:()=>n.ElectraForQuestionAnswering,ElectraForSequenceClassification:()=>n.ElectraForSequenceClassification,ElectraForTokenClassification:()=>n.ElectraForTokenClassification,ElectraModel:()=>n.ElectraModel,ElectraPreTrainedModel:()=>n.ElectraPreTrainedModel,ElectraTokenizer:()=>r.ElectraTokenizer,EncodecFeatureExtractor:()=>d.EncodecFeatureExtractor,EosTokenCriteria:()=>w.EosTokenCriteria,EsmForMaskedLM:()=>n.EsmForMaskedLM,EsmForSequenceClassification:()=>n.EsmForSequenceClassification,EsmForTokenClassification:()=>n.EsmForTokenClassification,EsmModel:()=>n.EsmModel,EsmPreTrainedModel:()=>n.EsmPreTrainedModel,EsmTokenizer:()=>r.EsmTokenizer,ExaoneForCausalLM:()=>n.ExaoneForCausalLM,ExaoneModel:()=>n.ExaoneModel,ExaonePreTrainedModel:()=>n.ExaonePreTrainedModel,FFT:()=>c.FFT,FalconForCausalLM:()=>n.FalconForCausalLM,FalconModel:()=>n.FalconModel,FalconPreTrainedModel:()=>n.FalconPreTrainedModel,FalconTokenizer:()=>r.FalconTokenizer,FastViTForImageClassification:()=>n.FastViTForImageClassification,FastViTModel:()=>n.FastViTModel,FastViTPreTrainedModel:()=>n.FastViTPreTrainedModel,FeatureExtractionPipeline:()=>t.FeatureExtractionPipeline,FeatureExtractor:()=>u.FeatureExtractor,FillMaskPipeline:()=>t.FillMaskPipeline,Florence2ForConditionalGeneration:()=>n.Florence2ForConditionalGeneration,Florence2PreTrainedModel:()=>n.Florence2PreTrainedModel,Florence2Processor:()=>_.Florence2Processor,ForcedBOSTokenLogitsProcessor:()=>b.ForcedBOSTokenLogitsProcessor,ForcedEOSTokenLogitsProcessor:()=>b.ForcedEOSTokenLogitsProcessor,GLPNFeatureExtractor:()=>f.GLPNFeatureExtractor,GLPNForDepthEstimation:()=>n.GLPNForDepthEstimation,GLPNModel:()=>n.GLPNModel,GLPNPreTrainedModel:()=>n.GLPNPreTrainedModel,GPT2LMHeadModel:()=>n.GPT2LMHeadModel,GPT2Model:()=>n.GPT2Model,GPT2PreTrainedModel:()=>n.GPT2PreTrainedModel,GPT2Tokenizer:()=>r.GPT2Tokenizer,GPTBigCodeForCausalLM:()=>n.GPTBigCodeForCausalLM,GPTBigCodeModel:()=>n.GPTBigCodeModel,GPTBigCodePreTrainedModel:()=>n.GPTBigCodePreTrainedModel,GPTJForCausalLM:()=>n.GPTJForCausalLM,GPTJModel:()=>n.GPTJModel,GPTJPreTrainedModel:()=>n.GPTJPreTrainedModel,GPTNeoForCausalLM:()=>n.GPTNeoForCausalLM,GPTNeoModel:()=>n.GPTNeoModel,GPTNeoPreTrainedModel:()=>n.GPTNeoPreTrainedModel,GPTNeoXForCausalLM:()=>n.GPTNeoXForCausalLM,GPTNeoXModel:()=>n.GPTNeoXModel,GPTNeoXPreTrainedModel:()=>n.GPTNeoXPreTrainedModel,GPTNeoXTokenizer:()=>r.GPTNeoXTokenizer,Gemma2ForCausalLM:()=>n.Gemma2ForCausalLM,Gemma2Model:()=>n.Gemma2Model,Gemma2PreTrainedModel:()=>n.Gemma2PreTrainedModel,Gemma3ForCausalLM:()=>n.Gemma3ForCausalLM,Gemma3Model:()=>n.Gemma3Model,Gemma3PreTrainedModel:()=>n.Gemma3PreTrainedModel,GemmaForCausalLM:()=>n.GemmaForCausalLM,GemmaModel:()=>n.GemmaModel,GemmaPreTrainedModel:()=>n.GemmaPreTrainedModel,GemmaTokenizer:()=>r.GemmaTokenizer,GlmForCausalLM:()=>n.GlmForCausalLM,GlmModel:()=>n.GlmModel,GlmPreTrainedModel:()=>n.GlmPreTrainedModel,GraniteForCausalLM:()=>n.GraniteForCausalLM,GraniteModel:()=>n.GraniteModel,GranitePreTrainedModel:()=>n.GranitePreTrainedModel,Grok1Tokenizer:()=>r.Grok1Tokenizer,GroundingDinoForObjectDetection:()=>n.GroundingDinoForObjectDetection,GroundingDinoImageProcessor:()=>f.GroundingDinoImageProcessor,GroundingDinoPreTrainedModel:()=>n.GroundingDinoPreTrainedModel,GroundingDinoProcessor:()=>_.GroundingDinoProcessor,GroupViTModel:()=>n.GroupViTModel,GroupViTPreTrainedModel:()=>n.GroupViTPreTrainedModel,HeliumForCausalLM:()=>n.HeliumForCausalLM,HeliumModel:()=>n.HeliumModel,HeliumPreTrainedModel:()=>n.HeliumPreTrainedModel,HerbertTokenizer:()=>r.HerbertTokenizer,HieraForImageClassification:()=>n.HieraForImageClassification,HieraModel:()=>n.HieraModel,HieraPreTrainedModel:()=>n.HieraPreTrainedModel,HubertForCTC:()=>n.HubertForCTC,HubertForSequenceClassification:()=>n.HubertForSequenceClassification,HubertModel:()=>n.HubertModel,HubertPreTrainedModel:()=>n.HubertPreTrainedModel,IJepaForImageClassification:()=>n.IJepaForImageClassification,IJepaModel:()=>n.IJepaModel,IJepaPreTrainedModel:()=>n.IJepaPreTrainedModel,Idefics3ForConditionalGeneration:()=>n.Idefics3ForConditionalGeneration,Idefics3ImageProcessor:()=>f.Idefics3ImageProcessor,Idefics3PreTrainedModel:()=>n.Idefics3PreTrainedModel,Idefics3Processor:()=>_.Idefics3Processor,ImageClassificationPipeline:()=>t.ImageClassificationPipeline,ImageFeatureExtractionPipeline:()=>t.ImageFeatureExtractionPipeline,ImageFeatureExtractor:()=>d.ImageFeatureExtractor,ImageMattingOutput:()=>n.ImageMattingOutput,ImageProcessor:()=>h.ImageProcessor,ImageSegmentationPipeline:()=>t.ImageSegmentationPipeline,ImageToImagePipeline:()=>t.ImageToImagePipeline,ImageToTextPipeline:()=>t.ImageToTextPipeline,InterruptableStoppingCriteria:()=>w.InterruptableStoppingCriteria,JAISLMHeadModel:()=>n.JAISLMHeadModel,JAISModel:()=>n.JAISModel,JAISPreTrainedModel:()=>n.JAISPreTrainedModel,JinaCLIPImageProcessor:()=>f.JinaCLIPImageProcessor,JinaCLIPModel:()=>n.JinaCLIPModel,JinaCLIPPreTrainedModel:()=>n.JinaCLIPPreTrainedModel,JinaCLIPProcessor:()=>_.JinaCLIPProcessor,JinaCLIPTextModel:()=>n.JinaCLIPTextModel,JinaCLIPVisionModel:()=>n.JinaCLIPVisionModel,LiteWhisperForConditionalGeneration:()=>n.LiteWhisperForConditionalGeneration,LlamaForCausalLM:()=>n.LlamaForCausalLM,LlamaModel:()=>n.LlamaModel,LlamaPreTrainedModel:()=>n.LlamaPreTrainedModel,LlamaTokenizer:()=>r.LlamaTokenizer,LlavaForConditionalGeneration:()=>n.LlavaForConditionalGeneration,LlavaOnevisionForConditionalGeneration:()=>n.LlavaOnevisionForConditionalGeneration,LlavaOnevisionImageProcessor:()=>f.LlavaOnevisionImageProcessor,LlavaPreTrainedModel:()=>n.LlavaPreTrainedModel,LogitsProcessor:()=>b.LogitsProcessor,LogitsProcessorList:()=>b.LogitsProcessorList,LogitsWarper:()=>b.LogitsWarper,LongT5ForConditionalGeneration:()=>n.LongT5ForConditionalGeneration,LongT5Model:()=>n.LongT5Model,LongT5PreTrainedModel:()=>n.LongT5PreTrainedModel,M2M100ForConditionalGeneration:()=>n.M2M100ForConditionalGeneration,M2M100Model:()=>n.M2M100Model,M2M100PreTrainedModel:()=>n.M2M100PreTrainedModel,M2M100Tokenizer:()=>r.M2M100Tokenizer,MBart50Tokenizer:()=>r.MBart50Tokenizer,MBartForCausalLM:()=>n.MBartForCausalLM,MBartForConditionalGeneration:()=>n.MBartForConditionalGeneration,MBartForSequenceClassification:()=>n.MBartForSequenceClassification,MBartModel:()=>n.MBartModel,MBartPreTrainedModel:()=>n.MBartPreTrainedModel,MBartTokenizer:()=>r.MBartTokenizer,MPNetForMaskedLM:()=>n.MPNetForMaskedLM,MPNetForQuestionAnswering:()=>n.MPNetForQuestionAnswering,MPNetForSequenceClassification:()=>n.MPNetForSequenceClassification,MPNetForTokenClassification:()=>n.MPNetForTokenClassification,MPNetModel:()=>n.MPNetModel,MPNetPreTrainedModel:()=>n.MPNetPreTrainedModel,MPNetTokenizer:()=>r.MPNetTokenizer,MT5ForConditionalGeneration:()=>n.MT5ForConditionalGeneration,MT5Model:()=>n.MT5Model,MT5PreTrainedModel:()=>n.MT5PreTrainedModel,MarianMTModel:()=>n.MarianMTModel,MarianModel:()=>n.MarianModel,MarianPreTrainedModel:()=>n.MarianPreTrainedModel,MarianTokenizer:()=>r.MarianTokenizer,Mask2FormerImageProcessor:()=>f.Mask2FormerImageProcessor,MaskFormerFeatureExtractor:()=>f.MaskFormerFeatureExtractor,MaskFormerForInstanceSegmentation:()=>n.MaskFormerForInstanceSegmentation,MaskFormerImageProcessor:()=>f.MaskFormerImageProcessor,MaskFormerModel:()=>n.MaskFormerModel,MaskFormerPreTrainedModel:()=>n.MaskFormerPreTrainedModel,MaskedLMOutput:()=>n.MaskedLMOutput,MaxLengthCriteria:()=>w.MaxLengthCriteria,Metric3DForDepthEstimation:()=>n.Metric3DForDepthEstimation,Metric3DPreTrainedModel:()=>n.Metric3DPreTrainedModel,Metric3Dv2ForDepthEstimation:()=>n.Metric3Dv2ForDepthEstimation,Metric3Dv2PreTrainedModel:()=>n.Metric3Dv2PreTrainedModel,MgpstrForSceneTextRecognition:()=>n.MgpstrForSceneTextRecognition,MgpstrModelOutput:()=>n.MgpstrModelOutput,MgpstrPreTrainedModel:()=>n.MgpstrPreTrainedModel,MgpstrProcessor:()=>_.MgpstrProcessor,MgpstrTokenizer:()=>r.MgpstrTokenizer,MimiDecoderModel:()=>n.MimiDecoderModel,MimiDecoderOutput:()=>n.MimiDecoderOutput,MimiEncoderModel:()=>n.MimiEncoderModel,MimiEncoderOutput:()=>n.MimiEncoderOutput,MimiModel:()=>n.MimiModel,MimiPreTrainedModel:()=>n.MimiPreTrainedModel,MinLengthLogitsProcessor:()=>b.MinLengthLogitsProcessor,MinNewTokensLengthLogitsProcessor:()=>b.MinNewTokensLengthLogitsProcessor,MistralForCausalLM:()=>n.MistralForCausalLM,MistralModel:()=>n.MistralModel,MistralPreTrainedModel:()=>n.MistralPreTrainedModel,MobileBertForMaskedLM:()=>n.MobileBertForMaskedLM,MobileBertForQuestionAnswering:()=>n.MobileBertForQuestionAnswering,MobileBertForSequenceClassification:()=>n.MobileBertForSequenceClassification,MobileBertModel:()=>n.MobileBertModel,MobileBertPreTrainedModel:()=>n.MobileBertPreTrainedModel,MobileBertTokenizer:()=>r.MobileBertTokenizer,MobileLLMForCausalLM:()=>n.MobileLLMForCausalLM,MobileLLMModel:()=>n.MobileLLMModel,MobileLLMPreTrainedModel:()=>n.MobileLLMPreTrainedModel,MobileNetV1FeatureExtractor:()=>f.MobileNetV1FeatureExtractor,MobileNetV1ForImageClassification:()=>n.MobileNetV1ForImageClassification,MobileNetV1ForSemanticSegmentation:()=>n.MobileNetV1ForSemanticSegmentation,MobileNetV1ImageProcessor:()=>f.MobileNetV1ImageProcessor,MobileNetV1Model:()=>n.MobileNetV1Model,MobileNetV1PreTrainedModel:()=>n.MobileNetV1PreTrainedModel,MobileNetV2FeatureExtractor:()=>f.MobileNetV2FeatureExtractor,MobileNetV2ForImageClassification:()=>n.MobileNetV2ForImageClassification,MobileNetV2ForSemanticSegmentation:()=>n.MobileNetV2ForSemanticSegmentation,MobileNetV2ImageProcessor:()=>f.MobileNetV2ImageProcessor,MobileNetV2Model:()=>n.MobileNetV2Model,MobileNetV2PreTrainedModel:()=>n.MobileNetV2PreTrainedModel,MobileNetV3FeatureExtractor:()=>f.MobileNetV3FeatureExtractor,MobileNetV3ForImageClassification:()=>n.MobileNetV3ForImageClassification,MobileNetV3ForSemanticSegmentation:()=>n.MobileNetV3ForSemanticSegmentation,MobileNetV3ImageProcessor:()=>f.MobileNetV3ImageProcessor,MobileNetV3Model:()=>n.MobileNetV3Model,MobileNetV3PreTrainedModel:()=>n.MobileNetV3PreTrainedModel,MobileNetV4FeatureExtractor:()=>f.MobileNetV4FeatureExtractor,MobileNetV4ForImageClassification:()=>n.MobileNetV4ForImageClassification,MobileNetV4ForSemanticSegmentation:()=>n.MobileNetV4ForSemanticSegmentation,MobileNetV4ImageProcessor:()=>f.MobileNetV4ImageProcessor,MobileNetV4Model:()=>n.MobileNetV4Model,MobileNetV4PreTrainedModel:()=>n.MobileNetV4PreTrainedModel,MobileViTFeatureExtractor:()=>f.MobileViTFeatureExtractor,MobileViTForImageClassification:()=>n.MobileViTForImageClassification,MobileViTImageProcessor:()=>f.MobileViTImageProcessor,MobileViTModel:()=>n.MobileViTModel,MobileViTPreTrainedModel:()=>n.MobileViTPreTrainedModel,MobileViTV2ForImageClassification:()=>n.MobileViTV2ForImageClassification,MobileViTV2Model:()=>n.MobileViTV2Model,MobileViTV2PreTrainedModel:()=>n.MobileViTV2PreTrainedModel,ModelOutput:()=>n.ModelOutput,ModernBertForMaskedLM:()=>n.ModernBertForMaskedLM,ModernBertForSequenceClassification:()=>n.ModernBertForSequenceClassification,ModernBertForTokenClassification:()=>n.ModernBertForTokenClassification,ModernBertModel:()=>n.ModernBertModel,ModernBertPreTrainedModel:()=>n.ModernBertPreTrainedModel,Moondream1ForConditionalGeneration:()=>n.Moondream1ForConditionalGeneration,MoonshineFeatureExtractor:()=>d.MoonshineFeatureExtractor,MoonshineForConditionalGeneration:()=>n.MoonshineForConditionalGeneration,MoonshineModel:()=>n.MoonshineModel,MoonshinePreTrainedModel:()=>n.MoonshinePreTrainedModel,MoonshineProcessor:()=>_.MoonshineProcessor,MptForCausalLM:()=>n.MptForCausalLM,MptModel:()=>n.MptModel,MptPreTrainedModel:()=>n.MptPreTrainedModel,MultiModalityCausalLM:()=>n.MultiModalityCausalLM,MultiModalityPreTrainedModel:()=>n.MultiModalityPreTrainedModel,MusicgenForCausalLM:()=>n.MusicgenForCausalLM,MusicgenForConditionalGeneration:()=>n.MusicgenForConditionalGeneration,MusicgenModel:()=>n.MusicgenModel,MusicgenPreTrainedModel:()=>n.MusicgenPreTrainedModel,NllbTokenizer:()=>r.NllbTokenizer,NoBadWordsLogitsProcessor:()=>b.NoBadWordsLogitsProcessor,NoRepeatNGramLogitsProcessor:()=>b.NoRepeatNGramLogitsProcessor,NomicBertModel:()=>n.NomicBertModel,NomicBertPreTrainedModel:()=>n.NomicBertPreTrainedModel,NougatImageProcessor:()=>f.NougatImageProcessor,NougatTokenizer:()=>r.NougatTokenizer,OPTForCausalLM:()=>n.OPTForCausalLM,OPTModel:()=>n.OPTModel,OPTPreTrainedModel:()=>n.OPTPreTrainedModel,ObjectDetectionPipeline:()=>t.ObjectDetectionPipeline,Olmo2ForCausalLM:()=>n.Olmo2ForCausalLM,Olmo2Model:()=>n.Olmo2Model,Olmo2PreTrainedModel:()=>n.Olmo2PreTrainedModel,OlmoForCausalLM:()=>n.OlmoForCausalLM,OlmoModel:()=>n.OlmoModel,OlmoPreTrainedModel:()=>n.OlmoPreTrainedModel,OpenELMForCausalLM:()=>n.OpenELMForCausalLM,OpenELMModel:()=>n.OpenELMModel,OpenELMPreTrainedModel:()=>n.OpenELMPreTrainedModel,OwlViTFeatureExtractor:()=>f.OwlViTFeatureExtractor,OwlViTForObjectDetection:()=>n.OwlViTForObjectDetection,OwlViTImageProcessor:()=>f.OwlViTImageProcessor,OwlViTModel:()=>n.OwlViTModel,OwlViTPreTrainedModel:()=>n.OwlViTPreTrainedModel,OwlViTProcessor:()=>_.OwlViTProcessor,Owlv2ForObjectDetection:()=>n.Owlv2ForObjectDetection,Owlv2ImageProcessor:()=>f.Owlv2ImageProcessor,Owlv2Model:()=>n.Owlv2Model,Owlv2PreTrainedModel:()=>n.Owlv2PreTrainedModel,PaliGemmaForConditionalGeneration:()=>n.PaliGemmaForConditionalGeneration,PaliGemmaPreTrainedModel:()=>n.PaliGemmaPreTrainedModel,PaliGemmaProcessor:()=>_.PaliGemmaProcessor,PatchTSMixerForPrediction:()=>n.PatchTSMixerForPrediction,PatchTSMixerModel:()=>n.PatchTSMixerModel,PatchTSMixerPreTrainedModel:()=>n.PatchTSMixerPreTrainedModel,PatchTSTForPrediction:()=>n.PatchTSTForPrediction,PatchTSTModel:()=>n.PatchTSTModel,PatchTSTPreTrainedModel:()=>n.PatchTSTPreTrainedModel,Phi3ForCausalLM:()=>n.Phi3ForCausalLM,Phi3Model:()=>n.Phi3Model,Phi3PreTrainedModel:()=>n.Phi3PreTrainedModel,Phi3VForCausalLM:()=>n.Phi3VForCausalLM,Phi3VImageProcessor:()=>f.Phi3VImageProcessor,Phi3VPreTrainedModel:()=>n.Phi3VPreTrainedModel,Phi3VProcessor:()=>_.Phi3VProcessor,PhiForCausalLM:()=>n.PhiForCausalLM,PhiModel:()=>n.PhiModel,PhiPreTrainedModel:()=>n.PhiPreTrainedModel,Pipeline:()=>t.Pipeline,PreTrainedModel:()=>n.PreTrainedModel,PreTrainedTokenizer:()=>r.PreTrainedTokenizer,PretrainedConfig:()=>o.PretrainedConfig,PretrainedMixin:()=>n.PretrainedMixin,Processor:()=>g.Processor,PvtForImageClassification:()=>n.PvtForImageClassification,PvtImageProcessor:()=>f.PvtImageProcessor,PvtModel:()=>n.PvtModel,PvtPreTrainedModel:()=>n.PvtPreTrainedModel,PyAnnoteFeatureExtractor:()=>d.PyAnnoteFeatureExtractor,PyAnnoteForAudioFrameClassification:()=>n.PyAnnoteForAudioFrameClassification,PyAnnoteModel:()=>n.PyAnnoteModel,PyAnnotePreTrainedModel:()=>n.PyAnnotePreTrainedModel,PyAnnoteProcessor:()=>_.PyAnnoteProcessor,QuestionAnsweringModelOutput:()=>n.QuestionAnsweringModelOutput,QuestionAnsweringPipeline:()=>t.QuestionAnsweringPipeline,Qwen2ForCausalLM:()=>n.Qwen2ForCausalLM,Qwen2Model:()=>n.Qwen2Model,Qwen2PreTrainedModel:()=>n.Qwen2PreTrainedModel,Qwen2Tokenizer:()=>r.Qwen2Tokenizer,Qwen2VLForConditionalGeneration:()=>n.Qwen2VLForConditionalGeneration,Qwen2VLImageProcessor:()=>f.Qwen2VLImageProcessor,Qwen2VLPreTrainedModel:()=>n.Qwen2VLPreTrainedModel,Qwen2VLProcessor:()=>_.Qwen2VLProcessor,Qwen3ForCausalLM:()=>n.Qwen3ForCausalLM,Qwen3Model:()=>n.Qwen3Model,Qwen3PreTrainedModel:()=>n.Qwen3PreTrainedModel,RFDetrForObjectDetection:()=>n.RFDetrForObjectDetection,RFDetrModel:()=>n.RFDetrModel,RFDetrObjectDetectionOutput:()=>n.RFDetrObjectDetectionOutput,RFDetrPreTrainedModel:()=>n.RFDetrPreTrainedModel,RTDetrForObjectDetection:()=>n.RTDetrForObjectDetection,RTDetrImageProcessor:()=>f.RTDetrImageProcessor,RTDetrModel:()=>n.RTDetrModel,RTDetrObjectDetectionOutput:()=>n.RTDetrObjectDetectionOutput,RTDetrPreTrainedModel:()=>n.RTDetrPreTrainedModel,RTDetrV2ForObjectDetection:()=>n.RTDetrV2ForObjectDetection,RTDetrV2Model:()=>n.RTDetrV2Model,RTDetrV2ObjectDetectionOutput:()=>n.RTDetrV2ObjectDetectionOutput,RTDetrV2PreTrainedModel:()=>n.RTDetrV2PreTrainedModel,RawAudio:()=>a.RawAudio,RawImage:()=>i.RawImage,RawVideo:()=>s.RawVideo,RawVideoFrame:()=>s.RawVideoFrame,RepetitionPenaltyLogitsProcessor:()=>b.RepetitionPenaltyLogitsProcessor,ResNetForImageClassification:()=>n.ResNetForImageClassification,ResNetModel:()=>n.ResNetModel,ResNetPreTrainedModel:()=>n.ResNetPreTrainedModel,RoFormerForMaskedLM:()=>n.RoFormerForMaskedLM,RoFormerForQuestionAnswering:()=>n.RoFormerForQuestionAnswering,RoFormerForSequenceClassification:()=>n.RoFormerForSequenceClassification,RoFormerForTokenClassification:()=>n.RoFormerForTokenClassification,RoFormerModel:()=>n.RoFormerModel,RoFormerPreTrainedModel:()=>n.RoFormerPreTrainedModel,RoFormerTokenizer:()=>r.RoFormerTokenizer,RobertaForMaskedLM:()=>n.RobertaForMaskedLM,RobertaForQuestionAnswering:()=>n.RobertaForQuestionAnswering,RobertaForSequenceClassification:()=>n.RobertaForSequenceClassification,RobertaForTokenClassification:()=>n.RobertaForTokenClassification,RobertaModel:()=>n.RobertaModel,RobertaPreTrainedModel:()=>n.RobertaPreTrainedModel,RobertaTokenizer:()=>r.RobertaTokenizer,SamImageProcessor:()=>f.SamImageProcessor,SamImageSegmentationOutput:()=>n.SamImageSegmentationOutput,SamModel:()=>n.SamModel,SamPreTrainedModel:()=>n.SamPreTrainedModel,SamProcessor:()=>_.SamProcessor,SapiensForDepthEstimation:()=>n.SapiensForDepthEstimation,SapiensForNormalEstimation:()=>n.SapiensForNormalEstimation,SapiensForSemanticSegmentation:()=>n.SapiensForSemanticSegmentation,SapiensPreTrainedModel:()=>n.SapiensPreTrainedModel,SeamlessM4TFeatureExtractor:()=>d.SeamlessM4TFeatureExtractor,SegformerFeatureExtractor:()=>f.SegformerFeatureExtractor,SegformerForImageClassification:()=>n.SegformerForImageClassification,SegformerForSemanticSegmentation:()=>n.SegformerForSemanticSegmentation,SegformerImageProcessor:()=>f.SegformerImageProcessor,SegformerModel:()=>n.SegformerModel,SegformerPreTrainedModel:()=>n.SegformerPreTrainedModel,Seq2SeqLMOutput:()=>n.Seq2SeqLMOutput,SequenceClassifierOutput:()=>n.SequenceClassifierOutput,SiglipImageProcessor:()=>f.SiglipImageProcessor,SiglipModel:()=>n.SiglipModel,SiglipPreTrainedModel:()=>n.SiglipPreTrainedModel,SiglipTextModel:()=>n.SiglipTextModel,SiglipTokenizer:()=>r.SiglipTokenizer,SiglipVisionModel:()=>n.SiglipVisionModel,SmolVLMForConditionalGeneration:()=>n.SmolVLMForConditionalGeneration,SmolVLMImageProcessor:()=>f.SmolVLMImageProcessor,SmolVLMProcessor:()=>_.SmolVLMProcessor,SnacDecoderModel:()=>n.SnacDecoderModel,SnacEncoderModel:()=>n.SnacEncoderModel,SnacFeatureExtractor:()=>d.SnacFeatureExtractor,SnacModel:()=>n.SnacModel,SnacPreTrainedModel:()=>n.SnacPreTrainedModel,SpeechT5FeatureExtractor:()=>d.SpeechT5FeatureExtractor,SpeechT5ForSpeechToText:()=>n.SpeechT5ForSpeechToText,SpeechT5ForTextToSpeech:()=>n.SpeechT5ForTextToSpeech,SpeechT5HifiGan:()=>n.SpeechT5HifiGan,SpeechT5Model:()=>n.SpeechT5Model,SpeechT5PreTrainedModel:()=>n.SpeechT5PreTrainedModel,SpeechT5Processor:()=>_.SpeechT5Processor,SpeechT5Tokenizer:()=>r.SpeechT5Tokenizer,SqueezeBertForMaskedLM:()=>n.SqueezeBertForMaskedLM,SqueezeBertForQuestionAnswering:()=>n.SqueezeBertForQuestionAnswering,SqueezeBertForSequenceClassification:()=>n.SqueezeBertForSequenceClassification,SqueezeBertModel:()=>n.SqueezeBertModel,SqueezeBertPreTrainedModel:()=>n.SqueezeBertPreTrainedModel,SqueezeBertTokenizer:()=>r.SqueezeBertTokenizer,StableLmForCausalLM:()=>n.StableLmForCausalLM,StableLmModel:()=>n.StableLmModel,StableLmPreTrainedModel:()=>n.StableLmPreTrainedModel,Starcoder2ForCausalLM:()=>n.Starcoder2ForCausalLM,Starcoder2Model:()=>n.Starcoder2Model,Starcoder2PreTrainedModel:()=>n.Starcoder2PreTrainedModel,StoppingCriteria:()=>w.StoppingCriteria,StoppingCriteriaList:()=>w.StoppingCriteriaList,StyleTextToSpeech2Model:()=>n.StyleTextToSpeech2Model,StyleTextToSpeech2PreTrainedModel:()=>n.StyleTextToSpeech2PreTrainedModel,SummarizationPipeline:()=>t.SummarizationPipeline,SuppressTokensAtBeginLogitsProcessor:()=>b.SuppressTokensAtBeginLogitsProcessor,Swin2SRForImageSuperResolution:()=>n.Swin2SRForImageSuperResolution,Swin2SRImageProcessor:()=>f.Swin2SRImageProcessor,Swin2SRModel:()=>n.Swin2SRModel,Swin2SRPreTrainedModel:()=>n.Swin2SRPreTrainedModel,SwinForImageClassification:()=>n.SwinForImageClassification,SwinForSemanticSegmentation:()=>n.SwinForSemanticSegmentation,SwinModel:()=>n.SwinModel,SwinPreTrainedModel:()=>n.SwinPreTrainedModel,T5ForConditionalGeneration:()=>n.T5ForConditionalGeneration,T5Model:()=>n.T5Model,T5PreTrainedModel:()=>n.T5PreTrainedModel,T5Tokenizer:()=>r.T5Tokenizer,TableTransformerForObjectDetection:()=>n.TableTransformerForObjectDetection,TableTransformerModel:()=>n.TableTransformerModel,TableTransformerObjectDetectionOutput:()=>n.TableTransformerObjectDetectionOutput,TableTransformerPreTrainedModel:()=>n.TableTransformerPreTrainedModel,TemperatureLogitsWarper:()=>b.TemperatureLogitsWarper,Tensor:()=>l.Tensor,Text2TextGenerationPipeline:()=>t.Text2TextGenerationPipeline,TextClassificationPipeline:()=>t.TextClassificationPipeline,TextGenerationPipeline:()=>t.TextGenerationPipeline,TextStreamer:()=>y.TextStreamer,TextToAudioPipeline:()=>t.TextToAudioPipeline,TokenClassificationPipeline:()=>t.TokenClassificationPipeline,TokenClassifierOutput:()=>n.TokenClassifierOutput,TokenizerModel:()=>r.TokenizerModel,TopKLogitsWarper:()=>b.TopKLogitsWarper,TopPLogitsWarper:()=>b.TopPLogitsWarper,TrOCRForCausalLM:()=>n.TrOCRForCausalLM,TrOCRPreTrainedModel:()=>n.TrOCRPreTrainedModel,TranslationPipeline:()=>t.TranslationPipeline,UltravoxModel:()=>n.UltravoxModel,UltravoxPreTrainedModel:()=>n.UltravoxPreTrainedModel,UltravoxProcessor:()=>_.UltravoxProcessor,UniSpeechForCTC:()=>n.UniSpeechForCTC,UniSpeechForSequenceClassification:()=>n.UniSpeechForSequenceClassification,UniSpeechModel:()=>n.UniSpeechModel,UniSpeechPreTrainedModel:()=>n.UniSpeechPreTrainedModel,UniSpeechSatForAudioFrameClassification:()=>n.UniSpeechSatForAudioFrameClassification,UniSpeechSatForCTC:()=>n.UniSpeechSatForCTC,UniSpeechSatForSequenceClassification:()=>n.UniSpeechSatForSequenceClassification,UniSpeechSatModel:()=>n.UniSpeechSatModel,UniSpeechSatPreTrainedModel:()=>n.UniSpeechSatPreTrainedModel,VLChatProcessor:()=>_.VLChatProcessor,VLMImageProcessor:()=>f.VLMImageProcessor,ViTFeatureExtractor:()=>f.ViTFeatureExtractor,ViTForImageClassification:()=>n.ViTForImageClassification,ViTImageProcessor:()=>f.ViTImageProcessor,ViTMAEModel:()=>n.ViTMAEModel,ViTMAEPreTrainedModel:()=>n.ViTMAEPreTrainedModel,ViTMSNForImageClassification:()=>n.ViTMSNForImageClassification,ViTMSNModel:()=>n.ViTMSNModel,ViTMSNPreTrainedModel:()=>n.ViTMSNPreTrainedModel,ViTModel:()=>n.ViTModel,ViTPreTrainedModel:()=>n.ViTPreTrainedModel,VisionEncoderDecoderModel:()=>n.VisionEncoderDecoderModel,VitMatteForImageMatting:()=>n.VitMatteForImageMatting,VitMatteImageProcessor:()=>f.VitMatteImageProcessor,VitMattePreTrainedModel:()=>n.VitMattePreTrainedModel,VitPoseForPoseEstimation:()=>n.VitPoseForPoseEstimation,VitPoseImageProcessor:()=>f.VitPoseImageProcessor,VitPosePreTrainedModel:()=>n.VitPosePreTrainedModel,VitsModel:()=>n.VitsModel,VitsModelOutput:()=>n.VitsModelOutput,VitsPreTrainedModel:()=>n.VitsPreTrainedModel,VitsTokenizer:()=>r.VitsTokenizer,Wav2Vec2BertForCTC:()=>n.Wav2Vec2BertForCTC,Wav2Vec2BertForSequenceClassification:()=>n.Wav2Vec2BertForSequenceClassification,Wav2Vec2BertModel:()=>n.Wav2Vec2BertModel,Wav2Vec2BertPreTrainedModel:()=>n.Wav2Vec2BertPreTrainedModel,Wav2Vec2CTCTokenizer:()=>r.Wav2Vec2CTCTokenizer,Wav2Vec2FeatureExtractor:()=>d.Wav2Vec2FeatureExtractor,Wav2Vec2ForAudioFrameClassification:()=>n.Wav2Vec2ForAudioFrameClassification,Wav2Vec2ForCTC:()=>n.Wav2Vec2ForCTC,Wav2Vec2ForSequenceClassification:()=>n.Wav2Vec2ForSequenceClassification,Wav2Vec2Model:()=>n.Wav2Vec2Model,Wav2Vec2PreTrainedModel:()=>n.Wav2Vec2PreTrainedModel,Wav2Vec2Processor:()=>_.Wav2Vec2Processor,Wav2Vec2ProcessorWithLM:()=>_.Wav2Vec2ProcessorWithLM,WavLMForAudioFrameClassification:()=>n.WavLMForAudioFrameClassification,WavLMForCTC:()=>n.WavLMForCTC,WavLMForSequenceClassification:()=>n.WavLMForSequenceClassification,WavLMForXVector:()=>n.WavLMForXVector,WavLMModel:()=>n.WavLMModel,WavLMPreTrainedModel:()=>n.WavLMPreTrainedModel,WeSpeakerFeatureExtractor:()=>d.WeSpeakerFeatureExtractor,WeSpeakerResNetModel:()=>n.WeSpeakerResNetModel,WeSpeakerResNetPreTrainedModel:()=>n.WeSpeakerResNetPreTrainedModel,WhisperFeatureExtractor:()=>d.WhisperFeatureExtractor,WhisperForConditionalGeneration:()=>n.WhisperForConditionalGeneration,WhisperModel:()=>n.WhisperModel,WhisperPreTrainedModel:()=>n.WhisperPreTrainedModel,WhisperProcessor:()=>_.WhisperProcessor,WhisperTextStreamer:()=>y.WhisperTextStreamer,WhisperTimeStampLogitsProcessor:()=>b.WhisperTimeStampLogitsProcessor,WhisperTokenizer:()=>r.WhisperTokenizer,XLMForQuestionAnswering:()=>n.XLMForQuestionAnswering,XLMForSequenceClassification:()=>n.XLMForSequenceClassification,XLMForTokenClassification:()=>n.XLMForTokenClassification,XLMModel:()=>n.XLMModel,XLMPreTrainedModel:()=>n.XLMPreTrainedModel,XLMRobertaForMaskedLM:()=>n.XLMRobertaForMaskedLM,XLMRobertaForQuestionAnswering:()=>n.XLMRobertaForQuestionAnswering,XLMRobertaForSequenceClassification:()=>n.XLMRobertaForSequenceClassification,XLMRobertaForTokenClassification:()=>n.XLMRobertaForTokenClassification,XLMRobertaModel:()=>n.XLMRobertaModel,XLMRobertaPreTrainedModel:()=>n.XLMRobertaPreTrainedModel,XLMRobertaTokenizer:()=>r.XLMRobertaTokenizer,XLMTokenizer:()=>r.XLMTokenizer,XLMWithLMHeadModel:()=>n.XLMWithLMHeadModel,XVectorOutput:()=>n.XVectorOutput,YolosFeatureExtractor:()=>f.YolosFeatureExtractor,YolosForObjectDetection:()=>n.YolosForObjectDetection,YolosImageProcessor:()=>f.YolosImageProcessor,YolosModel:()=>n.YolosModel,YolosObjectDetectionOutput:()=>n.YolosObjectDetectionOutput,YolosPreTrainedModel:()=>n.YolosPreTrainedModel,ZeroShotAudioClassificationPipeline:()=>t.ZeroShotAudioClassificationPipeline,ZeroShotClassificationPipeline:()=>t.ZeroShotClassificationPipeline,ZeroShotImageClassificationPipeline:()=>t.ZeroShotImageClassificationPipeline,ZeroShotObjectDetectionPipeline:()=>t.ZeroShotObjectDetectionPipeline,bankers_round:()=>c.bankers_round,cat:()=>l.cat,cos_sim:()=>c.cos_sim,dot:()=>c.dot,dynamic_time_warping:()=>c.dynamic_time_warping,env:()=>e.env,full:()=>l.full,full_like:()=>l.full_like,getKeyValueShapes:()=>o.getKeyValueShapes,hamming:()=>a.hamming,hanning:()=>a.hanning,interpolate:()=>l.interpolate,interpolate_4d:()=>l.interpolate_4d,interpolate_data:()=>c.interpolate_data,is_chinese_char:()=>r.is_chinese_char,layer_norm:()=>l.layer_norm,load_image:()=>i.load_image,load_video:()=>s.load_video,log_softmax:()=>c.log_softmax,magnitude:()=>c.magnitude,matmul:()=>l.matmul,max:()=>c.max,mean:()=>l.mean,mean_pooling:()=>l.mean_pooling,medianFilter:()=>c.medianFilter,mel_filter_bank:()=>a.mel_filter_bank,min:()=>c.min,ones:()=>l.ones,ones_like:()=>l.ones_like,permute:()=>l.permute,permute_data:()=>c.permute_data,pipeline:()=>t.pipeline,quantize_embeddings:()=>l.quantize_embeddings,rand:()=>l.rand,read_audio:()=>a.read_audio,rfft:()=>l.rfft,round:()=>c.round,slice:()=>l.slice,softmax:()=>c.softmax,spectrogram:()=>a.spectrogram,stack:()=>l.stack,std_mean:()=>l.std_mean,topk:()=>l.topk,window_function:()=>a.window_function,zeros:()=>l.zeros,zeros_like:()=>l.zeros_like});var e=tB("./src/env.js"),t=tB("./src/pipelines.js"),n=tB("./src/models.js"),r=tB("./src/tokenizers.js"),o=tB("./src/configs.js"),a=tB("./src/utils/audio.js"),i=tB("./src/utils/image.js"),s=tB("./src/utils/video.js"),l=tB("./src/utils/tensor.js"),c=tB("./src/utils/maths.js"),u=tB("./src/base/feature_extraction_utils.js"),d=tB("./src/models/feature_extractors.js"),p=tB("./src/models/auto/feature_extraction_auto.js"),h=tB("./src/base/image_processors_utils.js"),f=tB("./src/models/image_processors.js"),m=tB("./src/models/auto/image_processing_auto.js"),g=tB("./src/base/processing_utils.js"),_=tB("./src/models/processors.js"),v=tB("./src/models/auto/processing_auto.js"),y=tB("./src/generation/streamers.js"),w=tB("./src/generation/stopping_criteria.js"),b=tB("./src/generation/logits_process.js")})();var rB=nB.pipeline;let oB=null;const aB=new Map;async function iB(e){const t=function(e){if(aB.has(e)){const t=aB.get(e);return aB.delete(e),aB.set(e,t),t}return null}(e=hB(e));if(null!==t)return t;oB||(oB=await rB("feature-extraction","Xenova/all-MiniLM-L6-v2"));const n=(await oB([e],{normalize:!0})).tolist()[0],r=n[0].length,o=new Array(r).fill(0);for(const i of n)for(let e=0;e<r;e++)o[e]+=i[e];let a=o.map((e=>e/n.length));return a=a.slice(0,50),function(e,t){if(aB.size>=500){const e=aB.keys().next().value;void 0!==e&&aB.delete(e)}aB.set(e,t)}(e,a),a}var sB=n(78);class lB{constructor(){this.reachable={}}initReachability(e){e in this.reachable||(this.reachable[e]={},this.reachable[e][e]=!0)}addEdge(e,t){this.initReachability(e),this.initReachability(t),this.reachable[e][t]=!0;for(const n in this.reachable)if(this.reachable[n]&&this.reachable[n][e]&&(this.reachable[n][t]||(this.reachable[n][t]=!0),this.reachable[t]))for(const e in this.reachable[t])this.reachable[n][e]||(this.reachable[n][e]=!0);if(this.reachable[t])for(const n in this.reachable[t])this.reachable[e][n]||(this.reachable[e][n]=!0)}wouldCreateCycleThroughIncomingEdge(e,t){return this.initReachability(e),this.initReachability(t),!(!this.reachable[e]||!this.reachable[e][t])}initNode(e){this.initReachability(e)}}const cB={},uB={},dB=new Set(["a","an","and","are","as","at","be","by","for","from","has","he","in","is","it","its","of","on","that","the","to","was","will","with","or","but","not","this","these","those","i","you","we","they","them","their","our","your","been","being","have","had","do","does","did","am"]);function pB(e){const t=hB(e);return dB.has(t)}function hB(e){return e.toLowerCase().replace(/[^\w\s\'.!?]|_/g,"").replace(/\s+/g," ").trim()}function fB(e){return cB[e]}async function mB(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"space",r=[];"space"===n?r=e.split(/\s+/):"comma"===n?r=e.split(/\s*,\s*/):"sentence"===n&&(r=e.split(/(?<=[.!?])\s+/)),r=r.filter((e=>e.length>0));let o=[];for(let i=0;i<r.length;i++){const e=r[i],n=e,s=e;let l=s+t+i,c="";for(let t=i-1;t>=0;t--)if(!pB(r[t])){c=r[t];break}let u="";for(let t=i+1;t<r.length;t++)if(!pB(r[t])){u=r[t];break}const d={word:s,prevWord:c,nextWord:u,idx:i};try{const e=await iB(s);d.embedding=e;const t=await iB(c);d.prevWordEmb=t;const n=await iB(u);d.nextWordEmb=n}catch(a){console.warn('Failed to get embedding for "'.concat(s,'":'),a),console.log("prevWord",c),console.log("nextWord",u)}uB[l]=d,cB[l]=n,o.push(l)}return o}function gB(e,t){const n=uB[e]||{word:"",prevWord:"",nextWord:"",idx:0},r=uB[t]||{word:"",prevWord:"",nextWord:"",idx:0};let o=0;const a=pB(n.word)&&pB(r.word),i=!n.prevWord||!r.prevWord||!n.nextWord||!r.nextWord,s=hB(n.word)===hB(r.word);if(a&&!i&&s){const e=(0,sB.Lb)(n.prevWordEmb||[],r.prevWordEmb||[]),t=(0,sB.Lb)(n.nextWordEmb||[],r.nextWordEmb||[]);o+=.5*Math.min(e+t)}else o+=a&&!s?0:(0,sB.Lb)(n.embedding||[],r.embedding||[]);const l=Math.abs(n.idx-r.idx);return o-=l*l/100,o}function _B(e){return{x:0,y:0,vx:0,vy:0,rx:0,ry:0,fontSize:0,textLength:0,count:0,word:e,origWordIndices:[],origSentIndices:[],origPromptIds:[],origSentenceInfo:[],children:[],parents:[]}}function vB(e,t,n,r,o){e.count+=1;const a=r[t];return e.origWordIndices.push(t),e.origSentIndices.push(n),e.origPromptIds&&e.origPromptIds.push(o),e.origSentenceInfo.push({sentIdx:n,wordIdx:t,origWords:[fB(a)]}),0===t&&(e.isRoot=!0),t===r.length-1&&(e.isEnd=!0),e}function yB(e,t,n,r,o,a){if(!r)return;e[n].parents.push(e[r]),e[r].children.push(e[n]),t[r]=t[r]||{};const i=t[r][n]||[];i.push({sentIdx:o,promptId:a}),t[r][n]=i}async function wB(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.5,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"space";const o={},a={},i=new lB;let s=0;for(const{promptId:u,generations:d}of e)for(const e of d){s++;let n="";const l=await mB(e,s,r);l.forEach(((e,r)=>{var c,d;let p=Object.keys(a).map((r=>{var o;if(null===(o=a[r])||void 0===o?void 0:o.origSentIndices.includes(s))return;const l=gB(r,e);return l<t||n&&i.wouldCreateCycleThroughIncomingEdge(r,n)?void 0:[l,r]})).filter((e=>void 0!==e));p=p.sort(((e,t)=>t[0]-e[0]));const h=(null===(c=p)||void 0===c||null===(d=c[0])||void 0===d?void 0:d[1])||null;h?e=h:(a[e]=_B(e),i.initNode(e)),a[e]=vB(a[e],r,s,l,u),n&&i.addEdge(n,e),yB(a,o,e,n,s,u),n=e}))}Object.values(a).forEach((e=>{e.parents=[],e.children=[]})),function(e,t){for(let n=0;n<Object.keys(e).length;n++)for(const r in e){if(!(r in t))continue;const n=Object.keys(t[r]),o=n[0],a=Object.keys(t).filter((e=>t[e][o]));if(1===n.length&&1===a.length){const n=r+" "+o;cB[n]=fB(r)+" "+fB(o),e[n]=so(so({},e[r]),{},{word:n}),e[o].isEnd&&(e[n].isEnd=!0);const a=e[r].origSentenceInfo,i=e[o].origSentenceInfo;if(a&&i){const t=[];a.forEach((e=>{const n=e.wordIdx+e.origWords.length,r=i.find((t=>t.sentIdx===e.sentIdx&&t.wordIdx===n));r?t.push({sentIdx:e.sentIdx,wordIdx:e.wordIdx,origWords:[...e.origWords,...r.origWords]}):t.push(e)})),e[n].origSentenceInfo=t}delete e[o],delete e[r],t[n]=so({},t[o]),delete t[o],delete t[r];for(const e in t){let o=t[e];r in o&&(o[n]=o[r],delete o[r])}}}}(a,o);const l=Object.values(a),c=Object.entries(o).flatMap((e=>{let[t,r]=e;return Object.entries(r).flatMap((e=>{let[r,o]=e;const i=a[r],s=a[t];return n&&(s.origSentIndices=po(s.origSentIndices),i.origSentIndices=po(i.origSentIndices)),a[r]||console.log("target not found",r),[...o].map((e=>{var t,n;let{sentIdx:r,promptId:o}=e;return null===s||void 0===s||null===(t=s.children)||void 0===t||t.push(i),null===i||void 0===i||null===(n=i.parents)||void 0===n||n.push(s),{source:s,target:i,sentIdx:r,promptId:o}}))}))}));return{nodesData:l,linksData:c}}class bB{constructor(e,t,n){this.apiKey=null,this.modelId=void 0,this.provider=null,this.config=void 0,this.config=e,this.apiKey=n||null,this.modelId=t||e.defaultModel}setModel(e){this.modelId=e,this.provider=null}getApiKey(e,t){let n=function(e){const t=new URLSearchParams(window.location.search).get(e);return t?decodeURIComponent(t):null}(e)||this.apiKey;return n||(n=prompt(t)||"",n&&function(e,t){const n=new URLSearchParams(window.location.search);n.set(e,encodeURIComponent(t));const r="".concat(window.location.pathname,"?").concat(n.toString());window.history.pushState({},"",r)}(e,n)),n}getProvider(){if(!this.provider){const e=this.config.name,t="".concat(e.toLowerCase().replace(/\s+/g,"_"),"_api_key"),n="Please enter your ".concat(e," API key:"),r=this.getApiKey(t,n);if(!r)throw new Error("".concat(e," API key is required"));this.provider=this.config.createProvider(r.trim())}return this.provider}async generateCompletions(e,t,n){try{const r=this.getProvider()(this.modelId),o=this.config.name;console.log("Calling ".concat(o," API via Vercel AI SDK"),e,t,n,"with model:",this.modelId);const a=Array.from({length:n},(()=>Ok({model:r,messages:[{role:"system",content:"You are a helpful assistant. Answer in at most one short sentence."},{role:"user",content:e}],temperature:t})));return(await Promise.all(a)).map((e=>e.text))}catch(r){const e=r instanceof Error?r.message:String(r);return console.error("Error generating completions with ".concat(this.config.name,":"),r),alert("Error calling ".concat(this.config.name," API: ").concat(e,"\n\nPlease check your API key and model selection, then try again.")),[]}}validateApiKey(e){return null!==e&&e.trim().length>0}}function xB(e){return function(e,t){return new e(so({type:"number",coerce:!0,checks:[]},zd(t)))}(vv,e)}var kB=Ov({error:Ov({message:X_(),type:X_().nullish(),param:Ev().nullish(),code:Lv([X_(),yv()]).nullish()})}),CB=Ef({errorSchema:kB,errorToMessage:e=>e.error.message});function DB(e){let{id:t,model:n,created:r}=e;return{id:null!=t?t:void 0,modelId:null!=n?n:void 0,timestamp:null!=r?new Date(1e3*r):void 0}}function SB(e){switch(e){case"stop":return"stop";case"length":return"length";case"content_filter":return"content-filter";case"function_call":case"tool_calls":return"tool-calls";default:return"unknown"}}var EB=hf((()=>pm(Ov({id:X_().nullish(),created:yv().nullish(),model:X_().nullish(),choices:Pv(Ov({message:Ov({role:Xv("assistant").nullish(),content:X_().nullish(),tool_calls:Pv(Ov({id:X_().nullish(),type:Xv("function"),function:Ov({name:X_(),arguments:X_()})})).nullish(),annotations:Pv(Ov({type:Xv("url_citation"),start_index:yv(),end_index:yv(),url:X_(),title:X_()})).nullish()}),index:yv(),logprobs:Ov({content:Pv(Ov({token:X_(),logprob:yv(),top_logprobs:Pv(Ov({token:X_(),logprob:yv()}))})).nullish()}).nullish(),finish_reason:X_().nullish()})),usage:Ov({prompt_tokens:yv().nullish(),completion_tokens:yv().nullish(),total_tokens:yv().nullish(),prompt_tokens_details:Ov({cached_tokens:yv().nullish()}).nullish(),completion_tokens_details:Ov({reasoning_tokens:yv().nullish(),accepted_prediction_tokens:yv().nullish(),rejected_prediction_tokens:yv().nullish()}).nullish()}).nullish()})))),TB=hf((()=>pm(Lv([Ov({id:X_().nullish(),created:yv().nullish(),model:X_().nullish(),choices:Pv(Ov({delta:Ov({role:Zv(["assistant"]).nullish(),content:X_().nullish(),tool_calls:Pv(Ov({index:yv(),id:X_().nullish(),type:Xv("function").nullish(),function:Ov({name:X_().nullish(),arguments:X_().nullish()})})).nullish(),annotations:Pv(Ov({type:Xv("url_citation"),start_index:yv(),end_index:yv(),url:X_(),title:X_()})).nullish()}).nullish(),logprobs:Ov({content:Pv(Ov({token:X_(),logprob:yv(),top_logprobs:Pv(Ov({token:X_(),logprob:yv()}))})).nullish()}).nullish(),finish_reason:X_().nullish(),index:yv()})),usage:Ov({prompt_tokens:yv().nullish(),completion_tokens:yv().nullish(),total_tokens:yv().nullish(),prompt_tokens_details:Ov({cached_tokens:yv().nullish()}).nullish(),completion_tokens_details:Ov({reasoning_tokens:yv().nullish(),accepted_prediction_tokens:yv().nullish(),rejected_prediction_tokens:yv().nullish()}).nullish()}).nullish()}),kB])))),AB=hf((()=>pm(Ov({logitBias:Hv(xB(),yv()).optional(),logprobs:Lv([kv(),yv()]).optional(),parallelToolCalls:kv().optional(),user:X_().optional(),reasoningEffort:Zv(["minimal","low","medium","high"]).optional(),maxCompletionTokens:yv().optional(),store:kv().optional(),metadata:Hv(X_().max(64),X_().max(512)).optional(),prediction:Hv(X_(),Ev()).optional(),structuredOutputs:kv().optional(),serviceTier:Zv(["auto","flex","priority","default"]).optional(),strictJsonSchema:kv().optional(),textVerbosity:Zv(["low","medium","high"]).optional(),promptCacheKey:X_().optional(),safetyIdentifier:X_().optional()}))));var MB=class{constructor(e,t){this.specificationVersion="v2",this.supportedUrls={"image/*":[/^https?:\/\/.*$/]},this.modelId=e,this.config=t}get provider(){return this.config.provider}async getArgs(e){let{prompt:t,maxOutputTokens:n,temperature:r,topP:o,topK:a,frequencyPenalty:i,presencePenalty:s,stopSequences:l,responseFormat:c,seed:u,tools:d,toolChoice:p,providerOptions:h}=e;var f,m,g,_;const v=[],y=null!=(f=await wf({provider:"openai",providerOptions:h,schema:AB}))?f:{},w=null==(m=y.structuredOutputs)||m;null!=a&&v.push({type:"unsupported-setting",setting:"topK"}),"json"!==(null==c?void 0:c.type)||null==c.schema||w||v.push({type:"unsupported-setting",setting:"responseFormat",details:"JSON response format schema is only supported with structuredOutputs"});const{messages:b,warnings:x}=function(e){let{prompt:t,systemMessageMode:n="system"}=e;const r=[],o=[];for(const{role:a,content:i}of t)switch(a){case"system":switch(n){case"system":r.push({role:"system",content:i});break;case"developer":r.push({role:"developer",content:i});break;case"remove":o.push({type:"other",message:"system messages are removed for this model"});break;default:throw new Error("Unsupported system message mode: ".concat(n))}break;case"user":if(1===i.length&&"text"===i[0].type){r.push({role:"user",content:i[0].text});break}r.push({role:"user",content:i.map(((e,t)=>{var n,r,o;switch(e.type){case"text":return{type:"text",text:e.text};case"file":if(e.mediaType.startsWith("image/")){const t="image/*"===e.mediaType?"image/jpeg":e.mediaType;return{type:"image_url",image_url:{url:e.data instanceof URL?e.data.toString():"data:".concat(t,";base64,").concat(bm(e.data)),detail:null==(r=null==(n=e.providerOptions)?void 0:n.openai)?void 0:r.imageDetail}}}if(!e.mediaType.startsWith("audio/")){if("application/pdf"===e.mediaType){if(e.data instanceof URL)throw new dd({functionality:"PDF file parts with URLs"});return{type:"file",file:"string"===typeof e.data&&e.data.startsWith("file-")?{file_id:e.data}:{filename:null!=(o=e.filename)?o:"part-".concat(t,".pdf"),file_data:"data:application/pdf;base64,".concat(bm(e.data))}}}throw new dd({functionality:"file part media type ".concat(e.mediaType)})}if(e.data instanceof URL)throw new dd({functionality:"audio file parts with URLs"});switch(e.mediaType){case"audio/wav":return{type:"input_audio",input_audio:{data:bm(e.data),format:"wav"}};case"audio/mp3":case"audio/mpeg":return{type:"input_audio",input_audio:{data:bm(e.data),format:"mp3"}};default:throw new dd({functionality:"audio content parts with media type ".concat(e.mediaType)})}}}))});break;case"assistant":{let e="";const t=[];for(const n of i)switch(n.type){case"text":e+=n.text;break;case"tool-call":t.push({id:n.toolCallId,type:"function",function:{name:n.toolName,arguments:JSON.stringify(n.input)}})}r.push({role:"assistant",content:e,tool_calls:t.length>0?t:void 0});break}case"tool":for(const e of i){const t=e.output;let n;switch(t.type){case"text":case"error-text":n=t.value;break;case"content":case"json":case"error-json":n=JSON.stringify(t.value)}r.push({role:"tool",tool_call_id:e.toolCallId,content:n})}break;default:throw new Error("Unsupported role: ".concat(a))}return{messages:r,warnings:o}}({prompt:t,systemMessageMode:IB(this.modelId)});v.push(...x);const k=null!=(g=y.strictJsonSchema)&&g,C={model:this.modelId,logit_bias:y.logitBias,logprobs:!0===y.logprobs||"number"===typeof y.logprobs||void 0,top_logprobs:"number"===typeof y.logprobs?y.logprobs:"boolean"===typeof y.logprobs&&y.logprobs?0:void 0,user:y.user,parallel_tool_calls:y.parallelToolCalls,max_tokens:n,temperature:r,top_p:o,frequency_penalty:i,presence_penalty:s,response_format:"json"===(null==c?void 0:c.type)?w&&null!=c.schema?{type:"json_schema",json_schema:{schema:c.schema,strict:k,name:null!=(_=c.name)?_:"response",description:c.description}}:{type:"json_object"}:void 0,stop:l,seed:u,verbosity:y.textVerbosity,max_completion_tokens:y.maxCompletionTokens,store:y.store,metadata:y.metadata,prediction:y.prediction,reasoning_effort:y.reasoningEffort,service_tier:y.serviceTier,prompt_cache_key:y.promptCacheKey,safety_identifier:y.safetyIdentifier,messages:b};FB(this.modelId)?(null!=C.temperature&&(C.temperature=void 0,v.push({type:"unsupported-setting",setting:"temperature",details:"temperature is not supported for reasoning models"})),null!=C.top_p&&(C.top_p=void 0,v.push({type:"unsupported-setting",setting:"topP",details:"topP is not supported for reasoning models"})),null!=C.frequency_penalty&&(C.frequency_penalty=void 0,v.push({type:"unsupported-setting",setting:"frequencyPenalty",details:"frequencyPenalty is not supported for reasoning models"})),null!=C.presence_penalty&&(C.presence_penalty=void 0,v.push({type:"unsupported-setting",setting:"presencePenalty",details:"presencePenalty is not supported for reasoning models"})),null!=C.logit_bias&&(C.logit_bias=void 0,v.push({type:"other",message:"logitBias is not supported for reasoning models"})),null!=C.logprobs&&(C.logprobs=void 0,v.push({type:"other",message:"logprobs is not supported for reasoning models"})),null!=C.top_logprobs&&(C.top_logprobs=void 0,v.push({type:"other",message:"topLogprobs is not supported for reasoning models"})),null!=C.max_tokens&&(null==C.max_completion_tokens&&(C.max_completion_tokens=C.max_tokens),C.max_tokens=void 0)):(this.modelId.startsWith("gpt-4o-search-preview")||this.modelId.startsWith("gpt-4o-mini-search-preview"))&&null!=C.temperature&&(C.temperature=void 0,v.push({type:"unsupported-setting",setting:"temperature",details:"temperature is not supported for the search preview models and has been removed."})),"flex"!==y.serviceTier||function(e){return e.startsWith("o3")||e.startsWith("o4-mini")||e.startsWith("gpt-5")&&!e.startsWith("gpt-5-chat")}(this.modelId)||(v.push({type:"unsupported-setting",setting:"serviceTier",details:"flex processing is only available for o3, o4-mini, and gpt-5 models"}),C.service_tier=void 0),"priority"!==y.serviceTier||function(e){return e.startsWith("gpt-4")||e.startsWith("gpt-5-mini")||e.startsWith("gpt-5")&&!e.startsWith("gpt-5-nano")&&!e.startsWith("gpt-5-chat")||e.startsWith("o3")||e.startsWith("o4-mini")}(this.modelId)||(v.push({type:"unsupported-setting",setting:"serviceTier",details:"priority processing is only available for supported models (gpt-4, gpt-5, gpt-5-mini, o3, o4-mini) and requires Enterprise access. gpt-5-nano is not supported"}),C.service_tier=void 0);const{tools:D,toolChoice:S,toolWarnings:E}=function(e){let{tools:t,toolChoice:n,structuredOutputs:r,strictJsonSchema:o}=e;t=(null==t?void 0:t.length)?t:void 0;const a=[];if(null==t)return{tools:void 0,toolChoice:void 0,toolWarnings:a};const i=[];for(const l of t)"function"===l.type?i.push({type:"function",function:{name:l.name,description:l.description,parameters:l.inputSchema,strict:r?o:void 0}}):a.push({type:"unsupported-tool",tool:l});if(null==n)return{tools:i,toolChoice:void 0,toolWarnings:a};const s=n.type;switch(s){case"auto":case"none":case"required":return{tools:i,toolChoice:s,toolWarnings:a};case"tool":return{tools:i,toolChoice:{type:"function",function:{name:n.toolName}},toolWarnings:a};default:throw new dd({functionality:"tool choice type: ".concat(s)})}}({tools:d,toolChoice:p,structuredOutputs:w,strictJsonSchema:k});return{args:so(so({},C),{},{tools:D,tool_choice:S}),warnings:[...v,...E]}}async doGenerate(e){var t,n,r,o,a,i,s,l,c,u,d,p,h,f;const{args:m,warnings:g}=await this.getArgs(e),{responseHeaders:_,value:v,rawValue:y}=await xf({url:this.config.url({path:"/chat/completions",modelId:this.modelId}),headers:Wh(this.config.headers(),e.headers),body:m,failedResponseHandler:CB,successfulResponseHandler:Af(EB),abortSignal:e.abortSignal,fetch:this.config.fetch}),w=v.choices[0],b=[],x=w.message.content;null!=x&&x.length>0&&b.push({type:"text",text:x});for(const S of null!=(t=w.message.tool_calls)?t:[])b.push({type:"tool-call",toolCallId:null!=(n=S.id)?n:Zh(),toolName:S.function.name,input:S.function.arguments});for(const S of null!=(r=w.message.annotations)?r:[])b.push({type:"source",sourceType:"url",id:Zh(),url:S.url,title:S.title});const k=null==(o=v.usage)?void 0:o.completion_tokens_details,C=null==(a=v.usage)?void 0:a.prompt_tokens_details,D={openai:{}};return null!=(null==k?void 0:k.accepted_prediction_tokens)&&(D.openai.acceptedPredictionTokens=null==k?void 0:k.accepted_prediction_tokens),null!=(null==k?void 0:k.rejected_prediction_tokens)&&(D.openai.rejectedPredictionTokens=null==k?void 0:k.rejected_prediction_tokens),null!=(null==(i=w.logprobs)?void 0:i.content)&&(D.openai.logprobs=w.logprobs.content),{content:b,finishReason:SB(w.finish_reason),usage:{inputTokens:null!=(l=null==(s=v.usage)?void 0:s.prompt_tokens)?l:void 0,outputTokens:null!=(u=null==(c=v.usage)?void 0:c.completion_tokens)?u:void 0,totalTokens:null!=(p=null==(d=v.usage)?void 0:d.total_tokens)?p:void 0,reasoningTokens:null!=(h=null==k?void 0:k.reasoning_tokens)?h:void 0,cachedInputTokens:null!=(f=null==C?void 0:C.cached_tokens)?f:void 0},request:{body:m},response:so(so({},DB(v)),{},{headers:_,body:y}),warnings:g,providerMetadata:D}}async doStream(e){const{args:t,warnings:n}=await this.getArgs(e),r=so(so({},t),{},{stream:!0,stream_options:{include_usage:!0}}),{responseHeaders:o,value:a}=await xf({url:this.config.url({path:"/chat/completions",modelId:this.modelId}),headers:Wh(this.config.headers(),e.headers),body:r,failedResponseHandler:CB,successfulResponseHandler:Tf(TB),abortSignal:e.abortSignal,fetch:this.config.fetch}),i=[];let s="unknown";const l={inputTokens:void 0,outputTokens:void 0,totalTokens:void 0};let c=!0,u=!1;const d={openai:{}};return{stream:a.pipeThrough(new TransformStream({start(e){e.enqueue({type:"stream-start",warnings:n})},transform(t,n){var r,o,a,p,h,f,m,g,_,v,y,w,b,x,k,C,D,S,E,T,A,M,F,I;if(e.includeRawChunks&&n.enqueue({type:"raw",rawValue:t.rawValue}),!t.success)return s="error",void n.enqueue({type:"error",error:t.error});const P=t.value;if("error"in P)return s="error",void n.enqueue({type:"error",error:P.error});c&&(c=!1,n.enqueue(so({type:"response-metadata"},DB(P)))),null!=P.usage&&(l.inputTokens=null!=(r=P.usage.prompt_tokens)?r:void 0,l.outputTokens=null!=(o=P.usage.completion_tokens)?o:void 0,l.totalTokens=null!=(a=P.usage.total_tokens)?a:void 0,l.reasoningTokens=null!=(h=null==(p=P.usage.completion_tokens_details)?void 0:p.reasoning_tokens)?h:void 0,l.cachedInputTokens=null!=(m=null==(f=P.usage.prompt_tokens_details)?void 0:f.cached_tokens)?m:void 0,null!=(null==(g=P.usage.completion_tokens_details)?void 0:g.accepted_prediction_tokens)&&(d.openai.acceptedPredictionTokens=null==(_=P.usage.completion_tokens_details)?void 0:_.accepted_prediction_tokens),null!=(null==(v=P.usage.completion_tokens_details)?void 0:v.rejected_prediction_tokens)&&(d.openai.rejectedPredictionTokens=null==(y=P.usage.completion_tokens_details)?void 0:y.rejected_prediction_tokens));const z=P.choices[0];if(null!=(null==z?void 0:z.finish_reason)&&(s=SB(z.finish_reason)),null!=(null==(w=null==z?void 0:z.logprobs)?void 0:w.content)&&(d.openai.logprobs=z.logprobs.content),null==(null==z?void 0:z.delta))return;const O=z.delta;if(null!=O.content&&(u||(n.enqueue({type:"text-start",id:"0"}),u=!0),n.enqueue({type:"text-delta",id:"0",delta:O.content})),null!=O.tool_calls)for(const e of O.tool_calls){const t=e.index;if(null==i[t]){if("function"!==e.type)throw new Au({data:e,message:"Expected 'function' type."});if(null==e.id)throw new Au({data:e,message:"Expected 'id' to be a string."});if(null==(null==(b=e.function)?void 0:b.name))throw new Au({data:e,message:"Expected 'function.name' to be a string."});n.enqueue({type:"tool-input-start",id:e.id,toolName:e.function.name}),i[t]={id:e.id,type:"function",function:{name:e.function.name,arguments:null!=(x=e.function.arguments)?x:""},hasFinished:!1};const r=i[t];null!=(null==(k=r.function)?void 0:k.name)&&null!=(null==(C=r.function)?void 0:C.arguments)&&(r.function.arguments.length>0&&n.enqueue({type:"tool-input-delta",id:r.id,delta:r.function.arguments}),vf(r.function.arguments)&&(n.enqueue({type:"tool-input-end",id:r.id}),n.enqueue({type:"tool-call",toolCallId:null!=(D=r.id)?D:Zh(),toolName:r.function.name,input:r.function.arguments}),r.hasFinished=!0));continue}const r=i[t];r.hasFinished||(null!=(null==(S=e.function)?void 0:S.arguments)&&(r.function.arguments+=null!=(T=null==(E=e.function)?void 0:E.arguments)?T:""),n.enqueue({type:"tool-input-delta",id:r.id,delta:null!=(A=e.function.arguments)?A:""}),null!=(null==(M=r.function)?void 0:M.name)&&null!=(null==(F=r.function)?void 0:F.arguments)&&vf(r.function.arguments)&&(n.enqueue({type:"tool-input-end",id:r.id}),n.enqueue({type:"tool-call",toolCallId:null!=(I=r.id)?I:Zh(),toolName:r.function.name,input:r.function.arguments}),r.hasFinished=!0))}if(null!=O.annotations)for(const e of O.annotations)n.enqueue({type:"source",sourceType:"url",id:Zh(),url:e.url,title:e.title})},flush(e){u&&e.enqueue({type:"text-end",id:"0"}),e.enqueue(so({type:"finish",finishReason:s,usage:l},null!=d?{providerMetadata:d}:{}))}})),request:{body:r},response:{headers:o}}}};function FB(e){return(e.startsWith("o")||e.startsWith("gpt-5"))&&!e.startsWith("gpt-5-chat")}function IB(e){var t,n;return FB(e)?null!=(n=null==(t=PB[e])?void 0:t.systemMessageMode)?n:"developer":"system"}var PB={"o1-mini":{systemMessageMode:"remove"},"o1-mini-2024-09-12":{systemMessageMode:"remove"},"o1-preview":{systemMessageMode:"remove"},"o1-preview-2024-09-12":{systemMessageMode:"remove"},o3:{systemMessageMode:"developer"},"o3-2025-04-16":{systemMessageMode:"developer"},"o3-mini":{systemMessageMode:"developer"},"o3-mini-2025-01-31":{systemMessageMode:"developer"},"o4-mini":{systemMessageMode:"developer"},"o4-mini-2025-04-16":{systemMessageMode:"developer"}};function zB(e){let{id:t,model:n,created:r}=e;return{id:null!=t?t:void 0,modelId:null!=n?n:void 0,timestamp:null!=r?new Date(1e3*r):void 0}}function OB(e){switch(e){case"stop":return"stop";case"length":return"length";case"content_filter":return"content-filter";case"function_call":case"tool_calls":return"tool-calls";default:return"unknown"}}var NB=hf((()=>pm(Ov({id:X_().nullish(),created:yv().nullish(),model:X_().nullish(),choices:Pv(Ov({text:X_(),finish_reason:X_(),logprobs:Ov({tokens:Pv(X_()),token_logprobs:Pv(yv()),top_logprobs:Pv(Hv(X_(),yv())).nullish()}).nullish()})),usage:Ov({prompt_tokens:yv(),completion_tokens:yv(),total_tokens:yv()}).nullish()})))),BB=hf((()=>pm(Lv([Ov({id:X_().nullish(),created:yv().nullish(),model:X_().nullish(),choices:Pv(Ov({text:X_(),finish_reason:X_().nullish(),index:yv(),logprobs:Ov({tokens:Pv(X_()),token_logprobs:Pv(yv()),top_logprobs:Pv(Hv(X_(),yv())).nullish()}).nullish()})),usage:Ov({prompt_tokens:yv(),completion_tokens:yv(),total_tokens:yv()}).nullish()}),kB])))),jB=hf((()=>pm(Ov({echo:kv().optional(),logitBias:Hv(X_(),yv()).optional(),suffix:X_().optional(),user:X_().optional(),logprobs:Lv([kv(),yv()]).optional()})))),LB=class{constructor(e,t){this.specificationVersion="v2",this.supportedUrls={},this.modelId=e,this.config=t}get providerOptionsName(){return this.config.provider.split(".")[0].trim()}get provider(){return this.config.provider}async getArgs(e){let{prompt:t,maxOutputTokens:n,temperature:r,topP:o,topK:a,frequencyPenalty:i,presencePenalty:s,stopSequences:l,responseFormat:c,tools:u,toolChoice:d,seed:p,providerOptions:h}=e;const f=[],m=so(so({},await wf({provider:"openai",providerOptions:h,schema:jB})),await wf({provider:this.providerOptionsName,providerOptions:h,schema:jB}));null!=a&&f.push({type:"unsupported-setting",setting:"topK"}),(null==u?void 0:u.length)&&f.push({type:"unsupported-setting",setting:"tools"}),null!=d&&f.push({type:"unsupported-setting",setting:"toolChoice"}),null!=c&&"text"!==c.type&&f.push({type:"unsupported-setting",setting:"responseFormat",details:"JSON response format is not supported."});const{prompt:g,stopSequences:_}=function(e){let{prompt:t,user:n="user",assistant:r="assistant"}=e,o="";"system"===t[0].role&&(o+="".concat(t[0].content,"\n\n"),t=t.slice(1));for(const{role:a,content:i}of t)switch(a){case"system":throw new Cu({message:"Unexpected system message in prompt: ${content}",prompt:t});case"user":{const e=i.map((e=>{if("text"===e.type)return e.text})).filter(Boolean).join("");o+="".concat(n,":\n").concat(e,"\n\n");break}case"assistant":{const e=i.map((e=>{switch(e.type){case"text":return e.text;case"tool-call":throw new dd({functionality:"tool-call messages"})}})).join("");o+="".concat(r,":\n").concat(e,"\n\n");break}case"tool":throw new dd({functionality:"tool messages"});default:throw new Error("Unsupported role: ".concat(a))}return o+="".concat(r,":\n"),{prompt:o,stopSequences:["\n".concat(n,":")]}}({prompt:t}),v=[...null!=_?_:[],...null!=l?l:[]];return{args:{model:this.modelId,echo:m.echo,logit_bias:m.logitBias,logprobs:!0===(null==m?void 0:m.logprobs)?0:!1===(null==m?void 0:m.logprobs)||null==m?void 0:m.logprobs,suffix:m.suffix,user:m.user,max_tokens:n,temperature:r,top_p:o,frequency_penalty:i,presence_penalty:s,seed:p,prompt:g,stop:v.length>0?v:void 0},warnings:f}}async doGenerate(e){var t,n,r;const{args:o,warnings:a}=await this.getArgs(e),{responseHeaders:i,value:s,rawValue:l}=await xf({url:this.config.url({path:"/completions",modelId:this.modelId}),headers:Wh(this.config.headers(),e.headers),body:o,failedResponseHandler:CB,successfulResponseHandler:Af(NB),abortSignal:e.abortSignal,fetch:this.config.fetch}),c=s.choices[0],u={openai:{}};return null!=c.logprobs&&(u.openai.logprobs=c.logprobs),{content:[{type:"text",text:c.text}],usage:{inputTokens:null==(t=s.usage)?void 0:t.prompt_tokens,outputTokens:null==(n=s.usage)?void 0:n.completion_tokens,totalTokens:null==(r=s.usage)?void 0:r.total_tokens},finishReason:OB(c.finish_reason),request:{body:o},response:so(so({},zB(s)),{},{headers:i,body:l}),providerMetadata:u,warnings:a}}async doStream(e){const{args:t,warnings:n}=await this.getArgs(e),r=so(so({},t),{},{stream:!0,stream_options:{include_usage:!0}}),{responseHeaders:o,value:a}=await xf({url:this.config.url({path:"/completions",modelId:this.modelId}),headers:Wh(this.config.headers(),e.headers),body:r,failedResponseHandler:CB,successfulResponseHandler:Tf(BB),abortSignal:e.abortSignal,fetch:this.config.fetch});let i="unknown";const s={openai:{}},l={inputTokens:void 0,outputTokens:void 0,totalTokens:void 0};let c=!0;return{stream:a.pipeThrough(new TransformStream({start(e){e.enqueue({type:"stream-start",warnings:n})},transform(t,n){if(e.includeRawChunks&&n.enqueue({type:"raw",rawValue:t.rawValue}),!t.success)return i="error",void n.enqueue({type:"error",error:t.error});const r=t.value;if("error"in r)return i="error",void n.enqueue({type:"error",error:r.error});c&&(c=!1,n.enqueue(so({type:"response-metadata"},zB(r))),n.enqueue({type:"text-start",id:"0"})),null!=r.usage&&(l.inputTokens=r.usage.prompt_tokens,l.outputTokens=r.usage.completion_tokens,l.totalTokens=r.usage.total_tokens);const o=r.choices[0];null!=(null==o?void 0:o.finish_reason)&&(i=OB(o.finish_reason)),null!=(null==o?void 0:o.logprobs)&&(s.openai.logprobs=o.logprobs),null!=(null==o?void 0:o.text)&&o.text.length>0&&n.enqueue({type:"text-delta",id:"0",delta:o.text})},flush(e){c||e.enqueue({type:"text-end",id:"0"}),e.enqueue({type:"finish",finishReason:i,providerMetadata:s,usage:l})}})),request:{body:r},response:{headers:o}}}},RB=hf((()=>pm(Ov({dimensions:yv().optional(),user:X_().optional()})))),VB=hf((()=>pm(Ov({data:Pv(Ov({embedding:Pv(yv())})),usage:Ov({prompt_tokens:yv()}).nullish()})))),qB=class{constructor(e,t){this.specificationVersion="v2",this.maxEmbeddingsPerCall=2048,this.supportsParallelCalls=!0,this.modelId=e,this.config=t}get provider(){return this.config.provider}async doEmbed(e){let{values:t,headers:n,abortSignal:r,providerOptions:o}=e;var a;if(t.length>this.maxEmbeddingsPerCall)throw new td({provider:this.provider,modelId:this.modelId,maxEmbeddingsPerCall:this.maxEmbeddingsPerCall,values:t});const i=null!=(a=await wf({provider:"openai",providerOptions:o,schema:RB}))?a:{},{responseHeaders:s,value:l,rawValue:c}=await xf({url:this.config.url({path:"/embeddings",modelId:this.modelId}),headers:Wh(this.config.headers(),n),body:{model:this.modelId,input:t,encoding_format:"float",dimensions:i.dimensions,user:i.user},failedResponseHandler:CB,successfulResponseHandler:Af(VB),abortSignal:r,fetch:this.config.fetch});return{embeddings:l.data.map((e=>e.embedding)),usage:l.usage?{tokens:l.usage.prompt_tokens}:void 0,response:{headers:s,body:c}}}},UB=hf((()=>pm(Ov({data:Pv(Ov({b64_json:X_(),revised_prompt:X_().optional()}))})))),WB={"dall-e-3":1,"dall-e-2":10,"gpt-image-1":10,"gpt-image-1-mini":10},GB=new Set(["gpt-image-1","gpt-image-1-mini"]),HB=class{constructor(e,t){this.modelId=e,this.config=t,this.specificationVersion="v2"}get maxImagesPerCall(){var e;return null!=(e=WB[this.modelId])?e:1}get provider(){return this.config.provider}async doGenerate(e){let{prompt:t,n:n,size:r,aspectRatio:o,seed:a,providerOptions:i,headers:s,abortSignal:l}=e;var c,u,d,p;const h=[];null!=o&&h.push({type:"unsupported-setting",setting:"aspectRatio",details:"This model does not support aspect ratio. Use `size` instead."}),null!=a&&h.push({type:"unsupported-setting",setting:"seed"});const f=null!=(d=null==(u=null==(c=this.config._internal)?void 0:c.currentDate)?void 0:u.call(c))?d:new Date,{value:m,responseHeaders:g}=await xf({url:this.config.url({path:"/images/generations",modelId:this.modelId}),headers:Wh(this.config.headers(),s),body:so(so({model:this.modelId,prompt:t,n:n,size:r},null!=(p=i.openai)?p:{}),GB.has(this.modelId)?{}:{response_format:"b64_json"}),failedResponseHandler:CB,successfulResponseHandler:Af(UB),abortSignal:l,fetch:this.config.fetch});return{images:m.data.map((e=>e.b64_json)),warnings:h,response:{timestamp:f,modelId:this.modelId,headers:g},providerMetadata:{openai:{images:m.data.map((e=>e.revised_prompt?{revisedPrompt:e.revised_prompt}:null))}}}}},KB=fm((()=>pm(Ov({code:X_().nullish(),containerId:X_()})))),ZB=fm((()=>pm(Ov({outputs:Pv(Vv("type",[Ov({type:Xv("logs"),logs:X_()}),Ov({type:Xv("image"),url:X_()})])).nullish()})))),$B=fm((()=>pm(Ov({container:Lv([X_(),Ov({fileIds:Pv(X_()).optional()})]).optional()})))),XB=Df({id:"openai.code_interpreter",name:"code_interpreter",inputSchema:KB,outputSchema:ZB}),JB=Ov({key:X_(),type:Zv(["eq","ne","gt","gte","lt","lte"]),value:Lv([X_(),yv(),kv()])}),QB=Ov({type:Zv(["and","or"]),filters:Pv(Lv([JB,dy((()=>QB))]))}),YB=fm((()=>pm(Ov({vectorStoreIds:Pv(X_()),maxNumResults:yv().optional(),ranking:Ov({ranker:X_().optional(),scoreThreshold:yv().optional()}).optional(),filters:Lv([JB,QB]).optional()})))),ej=fm((()=>pm(Ov({queries:Pv(X_()),results:Pv(Ov({attributes:Hv(X_(),Av()),fileId:X_(),filename:X_(),score:yv(),text:X_()})).nullable()})))),tj=Df({id:"openai.file_search",name:"file_search",inputSchema:Ov({}),outputSchema:ej}),nj=fm((()=>pm(Ov({background:Zv(["auto","opaque","transparent"]).optional(),inputFidelity:Zv(["low","high"]).optional(),inputImageMask:Ov({fileId:X_().optional(),imageUrl:X_().optional()}).optional(),model:X_().optional(),moderation:Zv(["auto"]).optional(),outputCompression:yv().int().min(0).max(100).optional(),outputFormat:Zv(["png","jpeg","webp"]).optional(),partialImages:yv().int().min(0).max(3).optional(),quality:Zv(["auto","low","medium","high"]).optional(),size:Zv(["1024x1024","1024x1536","1536x1024","auto"]).optional()}).strict()))),rj=Df({id:"openai.image_generation",name:"image_generation",inputSchema:fm((()=>pm(Ov({})))),outputSchema:fm((()=>pm(Ov({result:X_()}))))}),oj=fm((()=>pm(Ov({action:Ov({type:Xv("exec"),command:Pv(X_()),timeoutMs:yv().optional(),user:X_().optional(),workingDirectory:X_().optional(),env:Hv(X_(),X_()).optional()})})))),aj=fm((()=>pm(Ov({output:X_()})))),ij=Df({id:"openai.local_shell",name:"local_shell",inputSchema:oj,outputSchema:aj}),sj=fm((()=>pm(Ov({filters:Ov({allowedDomains:Pv(X_()).optional()}).optional(),searchContextSize:Zv(["low","medium","high"]).optional(),userLocation:Ov({type:Xv("approximate"),country:X_().optional(),city:X_().optional(),region:X_().optional(),timezone:X_().optional()}).optional()})))),lj=Df({id:"openai.web_search",name:"web_search",inputSchema:fm((()=>pm(Ov({})))),outputSchema:fm((()=>pm(Ov({action:Vv("type",[Ov({type:Xv("search"),query:X_().optional()}),Ov({type:Xv("openPage"),url:X_()}),Ov({type:Xv("find"),url:X_(),pattern:X_()})])}))))}),cj=fm((()=>pm(Ov({searchContextSize:Zv(["low","medium","high"]).optional(),userLocation:Ov({type:Xv("approximate"),country:X_().optional(),city:X_().optional(),region:X_().optional(),timezone:X_().optional()}).optional()})))),uj={codeInterpreter:function(){return XB(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})},fileSearch:tj,imageGeneration:function(){return rj(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})},localShell:ij,webSearchPreview:Df({id:"openai.web_search_preview",name:"web_search_preview",inputSchema:fm((()=>pm(Ov({})))),outputSchema:fm((()=>pm(Ov({action:Vv("type",[Ov({type:Xv("search"),query:X_().optional()}),Ov({type:Xv("openPage"),url:X_()}),Ov({type:Xv("find"),url:X_(),pattern:X_()})])}))))}),webSearch:function(){return lj(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}};function dj(e,t){return!!t&&t.some((t=>e.startsWith(t)))}var pj=Ov({itemId:X_().nullish(),reasoningEncryptedContent:X_().nullish()});function hj(e){let{finishReason:t,hasFunctionCall:n}=e;switch(t){case void 0:case null:return n?"tool-calls":"stop";case"max_output_tokens":return"length";case"content_filter":return"content-filter";default:return n?"tool-calls":"unknown"}}var fj=hf((()=>pm(Lv([Ov({type:Xv("response.output_text.delta"),item_id:X_(),delta:X_(),logprobs:Pv(Ov({token:X_(),logprob:yv(),top_logprobs:Pv(Ov({token:X_(),logprob:yv()}))})).nullish()}),Ov({type:Zv(["response.completed","response.incomplete"]),response:Ov({incomplete_details:Ov({reason:X_()}).nullish(),usage:Ov({input_tokens:yv(),input_tokens_details:Ov({cached_tokens:yv().nullish()}).nullish(),output_tokens:yv(),output_tokens_details:Ov({reasoning_tokens:yv().nullish()}).nullish()}),service_tier:X_().nullish()})}),Ov({type:Xv("response.created"),response:Ov({id:X_(),created_at:yv(),model:X_(),service_tier:X_().nullish()})}),Ov({type:Xv("response.output_item.added"),output_index:yv(),item:Vv("type",[Ov({type:Xv("message"),id:X_()}),Ov({type:Xv("reasoning"),id:X_(),encrypted_content:X_().nullish()}),Ov({type:Xv("function_call"),id:X_(),call_id:X_(),name:X_(),arguments:X_()}),Ov({type:Xv("web_search_call"),id:X_(),status:X_()}),Ov({type:Xv("computer_call"),id:X_(),status:X_()}),Ov({type:Xv("file_search_call"),id:X_()}),Ov({type:Xv("image_generation_call"),id:X_()}),Ov({type:Xv("code_interpreter_call"),id:X_(),container_id:X_(),code:X_().nullable(),outputs:Pv(Vv("type",[Ov({type:Xv("logs"),logs:X_()}),Ov({type:Xv("image"),url:X_()})])).nullable(),status:X_()})])}),Ov({type:Xv("response.output_item.done"),output_index:yv(),item:Vv("type",[Ov({type:Xv("message"),id:X_()}),Ov({type:Xv("reasoning"),id:X_(),encrypted_content:X_().nullish()}),Ov({type:Xv("function_call"),id:X_(),call_id:X_(),name:X_(),arguments:X_(),status:Xv("completed")}),Ov({type:Xv("code_interpreter_call"),id:X_(),code:X_().nullable(),container_id:X_(),outputs:Pv(Vv("type",[Ov({type:Xv("logs"),logs:X_()}),Ov({type:Xv("image"),url:X_()})])).nullable()}),Ov({type:Xv("image_generation_call"),id:X_(),result:X_()}),Ov({type:Xv("web_search_call"),id:X_(),status:X_(),action:Vv("type",[Ov({type:Xv("search"),query:X_().nullish()}),Ov({type:Xv("open_page"),url:X_()}),Ov({type:Xv("find"),url:X_(),pattern:X_()})])}),Ov({type:Xv("file_search_call"),id:X_(),queries:Pv(X_()),results:Pv(Ov({attributes:Hv(X_(),Av()),file_id:X_(),filename:X_(),score:yv(),text:X_()})).nullish()}),Ov({type:Xv("local_shell_call"),id:X_(),call_id:X_(),action:Ov({type:Xv("exec"),command:Pv(X_()),timeout_ms:yv().optional(),user:X_().optional(),working_directory:X_().optional(),env:Hv(X_(),X_()).optional()})}),Ov({type:Xv("computer_call"),id:X_(),status:Xv("completed")})])}),Ov({type:Xv("response.function_call_arguments.delta"),item_id:X_(),output_index:yv(),delta:X_()}),Ov({type:Xv("response.image_generation_call.partial_image"),item_id:X_(),output_index:yv(),partial_image_b64:X_()}),Ov({type:Xv("response.code_interpreter_call_code.delta"),item_id:X_(),output_index:yv(),delta:X_()}),Ov({type:Xv("response.code_interpreter_call_code.done"),item_id:X_(),output_index:yv(),code:X_()}),Ov({type:Xv("response.output_text.annotation.added"),annotation:Vv("type",[Ov({type:Xv("url_citation"),url:X_(),title:X_()}),Ov({type:Xv("file_citation"),file_id:X_(),filename:X_().nullish(),index:yv().nullish(),start_index:yv().nullish(),end_index:yv().nullish(),quote:X_().nullish()})])}),Ov({type:Xv("response.reasoning_summary_part.added"),item_id:X_(),summary_index:yv()}),Ov({type:Xv("response.reasoning_summary_text.delta"),item_id:X_(),summary_index:yv(),delta:X_()}),Ov({type:Xv("response.reasoning_summary_part.done"),item_id:X_(),summary_index:yv()}),Ov({type:Xv("error"),code:X_(),message:X_(),param:X_().nullish(),sequence_number:yv()}),Ov({type:X_()}).loose().transform((e=>({type:"unknown_chunk",message:e.type})))])))),mj=hf((()=>pm(Ov({id:X_(),created_at:yv(),error:Ov({code:X_(),message:X_()}).nullish(),model:X_(),output:Pv(Vv("type",[Ov({type:Xv("message"),role:Xv("assistant"),id:X_(),content:Pv(Ov({type:Xv("output_text"),text:X_(),logprobs:Pv(Ov({token:X_(),logprob:yv(),top_logprobs:Pv(Ov({token:X_(),logprob:yv()}))})).nullish(),annotations:Pv(Vv("type",[Ov({type:Xv("url_citation"),start_index:yv(),end_index:yv(),url:X_(),title:X_()}),Ov({type:Xv("file_citation"),file_id:X_(),filename:X_().nullish(),index:yv().nullish(),start_index:yv().nullish(),end_index:yv().nullish(),quote:X_().nullish()}),Ov({type:Xv("container_file_citation")})]))}))}),Ov({type:Xv("web_search_call"),id:X_(),status:X_(),action:Vv("type",[Ov({type:Xv("search"),query:X_().nullish()}),Ov({type:Xv("open_page"),url:X_()}),Ov({type:Xv("find"),url:X_(),pattern:X_()})])}),Ov({type:Xv("file_search_call"),id:X_(),queries:Pv(X_()),results:Pv(Ov({attributes:Hv(X_(),Av()),file_id:X_(),filename:X_(),score:yv(),text:X_()})).nullish()}),Ov({type:Xv("code_interpreter_call"),id:X_(),code:X_().nullable(),container_id:X_(),outputs:Pv(Vv("type",[Ov({type:Xv("logs"),logs:X_()}),Ov({type:Xv("image"),url:X_()})])).nullable()}),Ov({type:Xv("image_generation_call"),id:X_(),result:X_()}),Ov({type:Xv("local_shell_call"),id:X_(),call_id:X_(),action:Ov({type:Xv("exec"),command:Pv(X_()),timeout_ms:yv().optional(),user:X_().optional(),working_directory:X_().optional(),env:Hv(X_(),X_()).optional()})}),Ov({type:Xv("function_call"),call_id:X_(),name:X_(),arguments:X_(),id:X_()}),Ov({type:Xv("computer_call"),id:X_(),status:X_().optional()}),Ov({type:Xv("reasoning"),id:X_(),encrypted_content:X_().nullish(),summary:Pv(Ov({type:Xv("summary_text"),text:X_()}))})])),service_tier:X_().nullish(),incomplete_details:Ov({reason:X_()}).nullish(),usage:Ov({input_tokens:yv(),input_tokens_details:Ov({cached_tokens:yv().nullish()}).nullish(),output_tokens:yv(),output_tokens_details:Ov({reasoning_tokens:yv().nullish()}).nullish()})})))),gj=hf((()=>pm(Ov({include:Pv(Zv(["reasoning.encrypted_content","file_search_call.results","message.output_text.logprobs"])).nullish(),instructions:X_().nullish(),logprobs:Lv([kv(),yv().min(1).max(20)]).optional(),maxToolCalls:yv().nullish(),metadata:Ev().nullish(),parallelToolCalls:kv().nullish(),previousResponseId:X_().nullish(),promptCacheKey:X_().nullish(),reasoningEffort:X_().nullish(),reasoningSummary:X_().nullish(),safetyIdentifier:X_().nullish(),serviceTier:Zv(["auto","flex","priority","default"]).nullish(),store:kv().nullish(),strictJsonSchema:kv().nullish(),textVerbosity:Zv(["low","medium","high"]).nullish(),user:X_().nullish()}))));var _j=class{constructor(e,t){this.specificationVersion="v2",this.supportedUrls={"image/*":[/^https?:\/\/.*$/],"application/pdf":[/^https?:\/\/.*$/]},this.modelId=e,this.config=t}get provider(){return this.config.provider}async getArgs(e){let{maxOutputTokens:t,temperature:n,stopSequences:r,topP:o,topK:a,presencePenalty:i,frequencyPenalty:s,seed:l,prompt:c,providerOptions:u,tools:d,toolChoice:p,responseFormat:h}=e;var f,m,g,_;const v=[],y=function(e){const t=e.startsWith("o3")||e.startsWith("o4-mini")||e.startsWith("gpt-5")&&!e.startsWith("gpt-5-chat"),n=e.startsWith("gpt-4")||e.startsWith("gpt-5-mini")||e.startsWith("gpt-5")&&!e.startsWith("gpt-5-nano")&&!e.startsWith("gpt-5-chat")||e.startsWith("o3")||e.startsWith("o4-mini"),r={requiredAutoTruncation:!1,systemMessageMode:"system",supportsFlexProcessing:t,supportsPriorityProcessing:n};if(e.startsWith("gpt-5-chat"))return so(so({},r),{},{isReasoningModel:!1});if(e.startsWith("o")||e.startsWith("gpt-5")||e.startsWith("codex-")||e.startsWith("computer-use"))return e.startsWith("o1-mini")||e.startsWith("o1-preview")?so(so({},r),{},{isReasoningModel:!0,systemMessageMode:"remove"}):so(so({},r),{},{isReasoningModel:!0,systemMessageMode:"developer"});return so(so({},r),{},{isReasoningModel:!1})}(this.modelId);null!=a&&v.push({type:"unsupported-setting",setting:"topK"}),null!=l&&v.push({type:"unsupported-setting",setting:"seed"}),null!=i&&v.push({type:"unsupported-setting",setting:"presencePenalty"}),null!=s&&v.push({type:"unsupported-setting",setting:"frequencyPenalty"}),null!=r&&v.push({type:"unsupported-setting",setting:"stopSequences"});const w=await wf({provider:"openai",providerOptions:u,schema:gj}),{input:b,warnings:x}=await async function(e){let{prompt:t,systemMessageMode:n,fileIdPrefixes:r,store:o,hasLocalShellTool:a=!1}=e;var i,s,l,c;const u=[],d=[];for(const{role:p,content:h}of t)switch(p){case"system":switch(n){case"system":u.push({role:"system",content:h});break;case"developer":u.push({role:"developer",content:h});break;case"remove":d.push({type:"other",message:"system messages are removed for this model"});break;default:throw new Error("Unsupported system message mode: ".concat(n))}break;case"user":u.push({role:"user",content:h.map(((e,t)=>{var n,o,a;switch(e.type){case"text":return{type:"input_text",text:e.text};case"file":if(e.mediaType.startsWith("image/")){const t="image/*"===e.mediaType?"image/jpeg":e.mediaType;return so(so({type:"input_image"},e.data instanceof URL?{image_url:e.data.toString()}:"string"===typeof e.data&&dj(e.data,r)?{file_id:e.data}:{image_url:"data:".concat(t,";base64,").concat(bm(e.data))}),{},{detail:null==(o=null==(n=e.providerOptions)?void 0:n.openai)?void 0:o.imageDetail})}if("application/pdf"===e.mediaType)return e.data instanceof URL?{type:"input_file",file_url:e.data.toString()}:so({type:"input_file"},"string"===typeof e.data&&dj(e.data,r)?{file_id:e.data}:{filename:null!=(a=e.filename)?a:"part-".concat(t,".pdf"),file_data:"data:application/pdf;base64,".concat(bm(e.data))});throw new dd({functionality:"file part media type ".concat(e.mediaType)})}}))});break;case"assistant":{const e={},t={};for(const n of h)switch(n.type){case"text":{const e=null==(s=null==(i=n.providerOptions)?void 0:i.openai)?void 0:s.itemId;if(o&&null!=e){u.push({type:"item_reference",id:e});break}u.push({role:"assistant",content:[{type:"output_text",text:n.text}],id:e});break}case"tool-call":{if(t[n.toolCallId]=n,n.providerExecuted)break;const e=null==(c=null==(l=n.providerOptions)?void 0:l.openai)?void 0:c.itemId;if(o&&null!=e){u.push({type:"item_reference",id:e});break}if(a&&"local_shell"===n.toolName){const t=await mf({value:n.input,schema:oj});u.push({type:"local_shell_call",call_id:n.toolCallId,id:e,action:{type:"exec",command:t.action.command,timeout_ms:t.action.timeoutMs,user:t.action.user,working_directory:t.action.workingDirectory,env:t.action.env}});break}u.push({type:"function_call",call_id:n.toolCallId,name:n.toolName,arguments:JSON.stringify(n.input),id:e});break}case"tool-result":o?u.push({type:"item_reference",id:n.toolCallId}):d.push({type:"other",message:"Results for OpenAI tool ".concat(n.toolName," are not sent to the API when store is false")});break;case"reasoning":{const t=await wf({provider:"openai",providerOptions:n.providerOptions,schema:pj}),r=null==t?void 0:t.itemId;if(null!=r){const a=e[r];if(o)void 0===a&&(u.push({type:"item_reference",id:r}),e[r]={type:"reasoning",id:r,summary:[]});else{const o=[];n.text.length>0?o.push({type:"summary_text",text:n.text}):void 0!==a&&d.push({type:"other",message:"Cannot append empty reasoning part to existing reasoning sequence. Skipping reasoning part: ".concat(JSON.stringify(n),".")}),void 0===a?(e[r]={type:"reasoning",id:r,encrypted_content:null==t?void 0:t.reasoningEncryptedContent,summary:o},u.push(e[r])):(a.summary.push(...o),null!=(null==t?void 0:t.reasoningEncryptedContent)&&(a.encrypted_content=t.reasoningEncryptedContent))}}else d.push({type:"other",message:"Non-OpenAI reasoning parts are not supported. Skipping reasoning part: ".concat(JSON.stringify(n),".")});break}}break}case"tool":for(const e of h){const t=e.output;if(a&&"local_shell"===e.toolName&&"json"===t.type){const n=await mf({value:t.value,schema:aj});u.push({type:"local_shell_call_output",call_id:e.toolCallId,output:n.output});break}let n;switch(t.type){case"text":case"error-text":n=t.value;break;case"json":case"error-json":n=JSON.stringify(t.value);break;case"content":n=t.value.map((e=>{switch(e.type){case"text":return{type:"input_text",text:e.text};case"media":return e.mediaType.startsWith("image/")?{type:"input_image",image_url:"data:".concat(e.mediaType,";base64,").concat(e.data)}:{type:"input_file",filename:"data",file_data:"data:".concat(e.mediaType,";base64,").concat(e.data)}}}))}u.push({type:"function_call_output",call_id:e.toolCallId,output:n})}break;default:throw new Error("Unsupported role: ".concat(p))}return{input:u,warnings:d}}({prompt:c,systemMessageMode:y.systemMessageMode,fileIdPrefixes:this.config.fileIdPrefixes,store:null==(f=null==w?void 0:w.store)||f,hasLocalShellTool:S("openai.local_shell")});v.push(...x);const k=null!=(m=null==w?void 0:w.strictJsonSchema)&&m;let C=null==w?void 0:w.include;function D(e){null==C?C=[e]:C.includes(e)||(C=[...C,e])}function S(e){return null!=(null==d?void 0:d.find((t=>"provider-defined"===t.type&&t.id===e)))}const E="number"===typeof(null==w?void 0:w.logprobs)?null==w?void 0:w.logprobs:!0===(null==w?void 0:w.logprobs)?20:void 0;E&&D("message.output_text.logprobs");const T=null==(g=null==d?void 0:d.find((e=>"provider-defined"===e.type&&("openai.web_search"===e.id||"openai.web_search_preview"===e.id))))?void 0:g.name;T&&D("web_search_call.action.sources"),S("openai.code_interpreter")&&D("code_interpreter_call.outputs");const A=null==w?void 0:w.store;!1===A&&y.isReasoningModel&&D("reasoning.encrypted_content");const M=so(so(so({model:this.modelId,input:b,temperature:n,top_p:o,max_output_tokens:t},("json"===(null==h?void 0:h.type)||(null==w?void 0:w.textVerbosity))&&{text:so(so({},"json"===(null==h?void 0:h.type)&&{format:null!=h.schema?{type:"json_schema",strict:k,name:null!=(_=h.name)?_:"response",description:h.description,schema:h.schema}:{type:"json_object"}}),(null==w?void 0:w.textVerbosity)&&{verbosity:w.textVerbosity})}),{},{max_tool_calls:null==w?void 0:w.maxToolCalls,metadata:null==w?void 0:w.metadata,parallel_tool_calls:null==w?void 0:w.parallelToolCalls,previous_response_id:null==w?void 0:w.previousResponseId,store:A,user:null==w?void 0:w.user,instructions:null==w?void 0:w.instructions,service_tier:null==w?void 0:w.serviceTier,include:C,prompt_cache_key:null==w?void 0:w.promptCacheKey,safety_identifier:null==w?void 0:w.safetyIdentifier,top_logprobs:E},y.isReasoningModel&&(null!=(null==w?void 0:w.reasoningEffort)||null!=(null==w?void 0:w.reasoningSummary))&&{reasoning:so(so({},null!=(null==w?void 0:w.reasoningEffort)&&{effort:w.reasoningEffort}),null!=(null==w?void 0:w.reasoningSummary)&&{summary:w.reasoningSummary})}),y.requiredAutoTruncation&&{truncation:"auto"});y.isReasoningModel?(null!=M.temperature&&(M.temperature=void 0,v.push({type:"unsupported-setting",setting:"temperature",details:"temperature is not supported for reasoning models"})),null!=M.top_p&&(M.top_p=void 0,v.push({type:"unsupported-setting",setting:"topP",details:"topP is not supported for reasoning models"}))):(null!=(null==w?void 0:w.reasoningEffort)&&v.push({type:"unsupported-setting",setting:"reasoningEffort",details:"reasoningEffort is not supported for non-reasoning models"}),null!=(null==w?void 0:w.reasoningSummary)&&v.push({type:"unsupported-setting",setting:"reasoningSummary",details:"reasoningSummary is not supported for non-reasoning models"})),"flex"!==(null==w?void 0:w.serviceTier)||y.supportsFlexProcessing||(v.push({type:"unsupported-setting",setting:"serviceTier",details:"flex processing is only available for o3, o4-mini, and gpt-5 models"}),delete M.service_tier),"priority"!==(null==w?void 0:w.serviceTier)||y.supportsPriorityProcessing||(v.push({type:"unsupported-setting",setting:"serviceTier",details:"priority processing is only available for supported models (gpt-4, gpt-5, gpt-5-mini, o3, o4-mini) and requires Enterprise access. gpt-5-nano is not supported"}),delete M.service_tier);const{tools:F,toolChoice:I,toolWarnings:P}=await async function(e){let{tools:t,toolChoice:n,strictJsonSchema:r}=e;t=(null==t?void 0:t.length)?t:void 0;const o=[];if(null==t)return{tools:void 0,toolChoice:void 0,toolWarnings:o};const a=[];for(const s of t)switch(s.type){case"function":a.push({type:"function",name:s.name,description:s.description,parameters:s.inputSchema,strict:r});break;case"provider-defined":switch(s.id){case"openai.file_search":{const e=await mf({value:s.args,schema:YB});a.push({type:"file_search",vector_store_ids:e.vectorStoreIds,max_num_results:e.maxNumResults,ranking_options:e.ranking?{ranker:e.ranking.ranker,score_threshold:e.ranking.scoreThreshold}:void 0,filters:e.filters});break}case"openai.local_shell":a.push({type:"local_shell"});break;case"openai.web_search_preview":{const e=await mf({value:s.args,schema:cj});a.push({type:"web_search_preview",search_context_size:e.searchContextSize,user_location:e.userLocation});break}case"openai.web_search":{const e=await mf({value:s.args,schema:sj});a.push({type:"web_search",filters:null!=e.filters?{allowed_domains:e.filters.allowedDomains}:void 0,search_context_size:e.searchContextSize,user_location:e.userLocation});break}case"openai.code_interpreter":{const e=await mf({value:s.args,schema:$B});a.push({type:"code_interpreter",container:null==e.container?{type:"auto",file_ids:void 0}:"string"===typeof e.container?e.container:{type:"auto",file_ids:e.container.fileIds}});break}case"openai.image_generation":{const e=await mf({value:s.args,schema:nj});a.push({type:"image_generation",background:e.background,input_fidelity:e.inputFidelity,input_image_mask:e.inputImageMask?{file_id:e.inputImageMask.fileId,image_url:e.inputImageMask.imageUrl}:void 0,model:e.model,size:e.size,quality:e.quality,moderation:e.moderation,output_format:e.outputFormat,output_compression:e.outputCompression});break}}break;default:o.push({type:"unsupported-tool",tool:s})}if(null==n)return{tools:a,toolChoice:void 0,toolWarnings:o};const i=n.type;switch(i){case"auto":case"none":case"required":return{tools:a,toolChoice:i,toolWarnings:o};case"tool":return{tools:a,toolChoice:"code_interpreter"===n.toolName||"file_search"===n.toolName||"image_generation"===n.toolName||"web_search_preview"===n.toolName||"web_search"===n.toolName?{type:n.toolName}:{type:"function",name:n.toolName},toolWarnings:o};default:throw new dd({functionality:"tool choice type: ".concat(i)})}}({tools:d,toolChoice:p,strictJsonSchema:k});return{webSearchToolName:T,args:so(so({},M),{},{tools:F,tool_choice:I}),warnings:[...v,...P],store:A}}async doGenerate(e){var t,n,r,o,a,i,s,l,c,u,d,p,h,f,m,g,_,v,y;const{args:w,warnings:b,webSearchToolName:x}=await this.getArgs(e),k=this.config.url({path:"/responses",modelId:this.modelId}),{responseHeaders:C,value:D,rawValue:S}=await xf({url:k,headers:Wh(this.config.headers(),e.headers),body:w,failedResponseHandler:CB,successfulResponseHandler:Af(mj),abortSignal:e.abortSignal,fetch:this.config.fetch});if(D.error)throw new lu({message:D.error.message,url:k,requestBodyValues:w,statusCode:400,responseHeaders:C,responseBody:S,isRetryable:!1});const E=[],T=[];let A=!1;for(const F of D.output)switch(F.type){case"reasoning":0===F.summary.length&&F.summary.push({type:"summary_text",text:""});for(const e of F.summary)E.push({type:"reasoning",text:e.text,providerMetadata:{openai:{itemId:F.id,reasoningEncryptedContent:null!=(t=F.encrypted_content)?t:null}}});break;case"image_generation_call":E.push({type:"tool-call",toolCallId:F.id,toolName:"image_generation",input:"{}",providerExecuted:!0}),E.push({type:"tool-result",toolCallId:F.id,toolName:"image_generation",result:{result:F.result},providerExecuted:!0});break;case"local_shell_call":E.push({type:"tool-call",toolCallId:F.call_id,toolName:"local_shell",input:JSON.stringify({action:F.action}),providerMetadata:{openai:{itemId:F.id}}});break;case"message":for(const t of F.content){(null==(r=null==(n=e.providerOptions)?void 0:n.openai)?void 0:r.logprobs)&&t.logprobs&&T.push(t.logprobs),E.push({type:"text",text:t.text,providerMetadata:{openai:{itemId:F.id}}});for(const e of t.annotations)"url_citation"===e.type?E.push({type:"source",sourceType:"url",id:null!=(i=null==(a=(o=this.config).generateId)?void 0:a.call(o))?i:Zh(),url:e.url,title:e.title}):"file_citation"===e.type&&E.push({type:"source",sourceType:"document",id:null!=(c=null==(l=(s=this.config).generateId)?void 0:l.call(s))?c:Zh(),mediaType:"text/plain",title:null!=(d=null!=(u=e.quote)?u:e.filename)?d:"Document",filename:null!=(p=e.filename)?p:e.file_id})}break;case"function_call":A=!0,E.push({type:"tool-call",toolCallId:F.call_id,toolName:F.name,input:F.arguments,providerMetadata:{openai:{itemId:F.id}}});break;case"web_search_call":E.push({type:"tool-call",toolCallId:F.id,toolName:null!=x?x:"web_search",input:JSON.stringify({}),providerExecuted:!0}),E.push({type:"tool-result",toolCallId:F.id,toolName:null!=x?x:"web_search",result:yj(F.action),providerExecuted:!0});break;case"computer_call":E.push({type:"tool-call",toolCallId:F.id,toolName:"computer_use",input:"",providerExecuted:!0}),E.push({type:"tool-result",toolCallId:F.id,toolName:"computer_use",result:{type:"computer_use_tool_result",status:F.status||"completed"},providerExecuted:!0});break;case"file_search_call":E.push({type:"tool-call",toolCallId:F.id,toolName:"file_search",input:"{}",providerExecuted:!0}),E.push({type:"tool-result",toolCallId:F.id,toolName:"file_search",result:{queries:F.queries,results:null!=(f=null==(h=F.results)?void 0:h.map((e=>({attributes:e.attributes,fileId:e.file_id,filename:e.filename,score:e.score,text:e.text}))))?f:null},providerExecuted:!0});break;case"code_interpreter_call":E.push({type:"tool-call",toolCallId:F.id,toolName:"code_interpreter",input:JSON.stringify({code:F.code,containerId:F.container_id}),providerExecuted:!0}),E.push({type:"tool-result",toolCallId:F.id,toolName:"code_interpreter",result:{outputs:F.outputs},providerExecuted:!0})}const M={openai:{responseId:D.id}};return T.length>0&&(M.openai.logprobs=T),"string"===typeof D.service_tier&&(M.openai.serviceTier=D.service_tier),{content:E,finishReason:hj({finishReason:null==(m=D.incomplete_details)?void 0:m.reason,hasFunctionCall:A}),usage:{inputTokens:D.usage.input_tokens,outputTokens:D.usage.output_tokens,totalTokens:D.usage.input_tokens+D.usage.output_tokens,reasoningTokens:null!=(_=null==(g=D.usage.output_tokens_details)?void 0:g.reasoning_tokens)?_:void 0,cachedInputTokens:null!=(y=null==(v=D.usage.input_tokens_details)?void 0:v.cached_tokens)?y:void 0},request:{body:w},response:{id:D.id,timestamp:new Date(1e3*D.created_at),modelId:D.model,headers:C,body:S},providerMetadata:M,warnings:b}}async doStream(e){const{args:t,warnings:n,webSearchToolName:r,store:o}=await this.getArgs(e),{responseHeaders:a,value:i}=await xf({url:this.config.url({path:"/responses",modelId:this.modelId}),headers:Wh(this.config.headers(),e.headers),body:so(so({},t),{},{stream:!0}),failedResponseHandler:CB,successfulResponseHandler:Tf(fj),abortSignal:e.abortSignal,fetch:this.config.fetch}),s=this;let l="unknown";const c={inputTokens:void 0,outputTokens:void 0,totalTokens:void 0},u=[];let d=null;const p={};let h=!1;const f={};let m;return{stream:i.pipeThrough(new TransformStream({start(e){e.enqueue({type:"stream-start",warnings:n})},transform(t,n){var a,i,g,_,v,y,w,b,x,k,C,D,S,E,T,A,M,F,I,P,z,O;if(e.includeRawChunks&&n.enqueue({type:"raw",rawValue:t.rawValue}),!t.success)return l="error",void n.enqueue({type:"error",error:t.error});const N=t.value;if(vj(N))"function_call"===N.item.type?(p[N.output_index]={toolName:N.item.name,toolCallId:N.item.call_id},n.enqueue({type:"tool-input-start",id:N.item.call_id,toolName:N.item.name})):"web_search_call"===N.item.type?(p[N.output_index]={toolName:null!=r?r:"web_search",toolCallId:N.item.id},n.enqueue({type:"tool-input-start",id:N.item.id,toolName:null!=r?r:"web_search",providerExecuted:!0}),n.enqueue({type:"tool-input-end",id:N.item.id}),n.enqueue({type:"tool-call",toolCallId:N.item.id,toolName:"web_search",input:JSON.stringify({}),providerExecuted:!0})):"computer_call"===N.item.type?(p[N.output_index]={toolName:"computer_use",toolCallId:N.item.id},n.enqueue({type:"tool-input-start",id:N.item.id,toolName:"computer_use",providerExecuted:!0})):"code_interpreter_call"===N.item.type?(p[N.output_index]={toolName:"code_interpreter",toolCallId:N.item.id,codeInterpreter:{containerId:N.item.container_id}},n.enqueue({type:"tool-input-start",id:N.item.id,toolName:"code_interpreter",providerExecuted:!0}),n.enqueue({type:"tool-input-delta",id:N.item.id,delta:'{"containerId":"'.concat(N.item.container_id,'","code":"')})):"file_search_call"===N.item.type?n.enqueue({type:"tool-call",toolCallId:N.item.id,toolName:"file_search",input:"{}",providerExecuted:!0}):"image_generation_call"===N.item.type?n.enqueue({type:"tool-call",toolCallId:N.item.id,toolName:"image_generation",input:"{}",providerExecuted:!0}):"message"===N.item.type?n.enqueue({type:"text-start",id:N.item.id,providerMetadata:{openai:{itemId:N.item.id}}}):vj(N)&&"reasoning"===N.item.type&&(f[N.item.id]={encryptedContent:N.item.encrypted_content,summaryParts:{0:"active"}},n.enqueue({type:"reasoning-start",id:"".concat(N.item.id,":0"),providerMetadata:{openai:{itemId:N.item.id,reasoningEncryptedContent:null!=(a=N.item.encrypted_content)?a:null}}}));else if(function(e){return"response.output_item.done"===e.type}(N)){if("function_call"===N.item.type)p[N.output_index]=void 0,h=!0,n.enqueue({type:"tool-input-end",id:N.item.call_id}),n.enqueue({type:"tool-call",toolCallId:N.item.call_id,toolName:N.item.name,input:N.item.arguments,providerMetadata:{openai:{itemId:N.item.id}}});else if("web_search_call"===N.item.type)p[N.output_index]=void 0,n.enqueue({type:"tool-result",toolCallId:N.item.id,toolName:"web_search",result:yj(N.item.action),providerExecuted:!0});else if("computer_call"===N.item.type)p[N.output_index]=void 0,n.enqueue({type:"tool-input-end",id:N.item.id}),n.enqueue({type:"tool-call",toolCallId:N.item.id,toolName:"computer_use",input:"",providerExecuted:!0}),n.enqueue({type:"tool-result",toolCallId:N.item.id,toolName:"computer_use",result:{type:"computer_use_tool_result",status:N.item.status||"completed"},providerExecuted:!0});else if("file_search_call"===N.item.type)p[N.output_index]=void 0,n.enqueue({type:"tool-result",toolCallId:N.item.id,toolName:"file_search",result:{queries:N.item.queries,results:null!=(g=null==(i=N.item.results)?void 0:i.map((e=>({attributes:e.attributes,fileId:e.file_id,filename:e.filename,score:e.score,text:e.text}))))?g:null},providerExecuted:!0});else if("code_interpreter_call"===N.item.type)p[N.output_index]=void 0,n.enqueue({type:"tool-result",toolCallId:N.item.id,toolName:"code_interpreter",result:{outputs:N.item.outputs},providerExecuted:!0});else if("image_generation_call"===N.item.type)n.enqueue({type:"tool-result",toolCallId:N.item.id,toolName:"image_generation",result:{result:N.item.result},providerExecuted:!0});else if("local_shell_call"===N.item.type)p[N.output_index]=void 0,n.enqueue({type:"tool-call",toolCallId:N.item.call_id,toolName:"local_shell",input:JSON.stringify({action:{type:"exec",command:N.item.action.command,timeoutMs:N.item.action.timeout_ms,user:N.item.action.user,workingDirectory:N.item.action.working_directory,env:N.item.action.env}}),providerMetadata:{openai:{itemId:N.item.id}}});else if("message"===N.item.type)n.enqueue({type:"text-end",id:N.item.id});else if("reasoning"===N.item.type){const e=f[N.item.id],t=Object.entries(e.summaryParts).filter((e=>{let[t,n]=e;return"active"===n||"can-conclude"===n})).map((e=>{let[t]=e;return t}));for(const r of t)n.enqueue({type:"reasoning-end",id:"".concat(N.item.id,":").concat(r),providerMetadata:{openai:{itemId:N.item.id,reasoningEncryptedContent:null!=(_=N.item.encrypted_content)?_:null}}});delete f[N.item.id]}}else if(function(e){return"response.function_call_arguments.delta"===e.type}(N)){const e=p[N.output_index];null!=e&&n.enqueue({type:"tool-input-delta",id:e.toolCallId,delta:N.delta})}else if(function(e){return"response.code_interpreter_call_code.delta"===e.type}(N)){const e=p[N.output_index];null!=e&&n.enqueue({type:"tool-input-delta",id:e.toolCallId,delta:JSON.stringify(N.delta).slice(1,-1)})}else if(function(e){return"response.code_interpreter_call_code.done"===e.type}(N)){const e=p[N.output_index];null!=e&&(n.enqueue({type:"tool-input-delta",id:e.toolCallId,delta:'"}'}),n.enqueue({type:"tool-input-end",id:e.toolCallId}),n.enqueue({type:"tool-call",toolCallId:e.toolCallId,toolName:"code_interpreter",input:JSON.stringify({code:N.code,containerId:e.codeInterpreter.containerId}),providerExecuted:!0}))}else if(function(e){return"response.created"===e.type}(N))d=N.response.id,n.enqueue({type:"response-metadata",id:N.response.id,timestamp:new Date(1e3*N.response.created_at),modelId:N.response.model});else if(function(e){return"response.output_text.delta"===e.type}(N))n.enqueue({type:"text-delta",id:N.item_id,delta:N.delta}),(null==(y=null==(v=e.providerOptions)?void 0:v.openai)?void 0:y.logprobs)&&N.logprobs&&u.push(N.logprobs);else if("response.reasoning_summary_part.added"===N.type){if(N.summary_index>0){const e=f[N.item_id];e.summaryParts[N.summary_index]="active";for(const t of Object.keys(e.summaryParts))"can-conclude"===e.summaryParts[t]&&(n.enqueue({type:"reasoning-end",id:"".concat(N.item_id,":").concat(t),providerMetadata:{openai:{itemId:N.item_id}}}),e.summaryParts[t]="concluded");n.enqueue({type:"reasoning-start",id:"".concat(N.item_id,":").concat(N.summary_index),providerMetadata:{openai:{itemId:N.item_id,reasoningEncryptedContent:null!=(b=null==(w=f[N.item_id])?void 0:w.encryptedContent)?b:null}}})}}else"response.reasoning_summary_text.delta"===N.type?n.enqueue({type:"reasoning-delta",id:"".concat(N.item_id,":").concat(N.summary_index),delta:N.delta,providerMetadata:{openai:{itemId:N.item_id}}}):"response.reasoning_summary_part.done"===N.type?o?(n.enqueue({type:"reasoning-end",id:"".concat(N.item_id,":").concat(N.summary_index),providerMetadata:{openai:{itemId:N.item_id}}}),f[N.item_id].summaryParts[N.summary_index]="concluded"):f[N.item_id].summaryParts[N.summary_index]="can-conclude":!function(e){return"response.completed"===e.type||"response.incomplete"===e.type}(N)?!function(e){return"response.output_text.annotation.added"===e.type}(N)?function(e){return"error"===e.type}(N)&&n.enqueue({type:"error",error:N}):"url_citation"===N.annotation.type?n.enqueue({type:"source",sourceType:"url",id:null!=(A=null==(T=(E=s.config).generateId)?void 0:T.call(E))?A:Zh(),url:N.annotation.url,title:N.annotation.title}):"file_citation"===N.annotation.type&&n.enqueue({type:"source",sourceType:"document",id:null!=(I=null==(F=(M=s.config).generateId)?void 0:F.call(M))?I:Zh(),mediaType:"text/plain",title:null!=(z=null!=(P=N.annotation.quote)?P:N.annotation.filename)?z:"Document",filename:null!=(O=N.annotation.filename)?O:N.annotation.file_id}):(l=hj({finishReason:null==(x=N.response.incomplete_details)?void 0:x.reason,hasFunctionCall:h}),c.inputTokens=N.response.usage.input_tokens,c.outputTokens=N.response.usage.output_tokens,c.totalTokens=N.response.usage.input_tokens+N.response.usage.output_tokens,c.reasoningTokens=null!=(C=null==(k=N.response.usage.output_tokens_details)?void 0:k.reasoning_tokens)?C:void 0,c.cachedInputTokens=null!=(S=null==(D=N.response.usage.input_tokens_details)?void 0:D.cached_tokens)?S:void 0,"string"===typeof N.response.service_tier&&(m=N.response.service_tier))},flush(e){const t={openai:{responseId:d}};u.length>0&&(t.openai.logprobs=u),void 0!==m&&(t.openai.serviceTier=m),e.enqueue({type:"finish",finishReason:l,usage:c,providerMetadata:t})}})),request:{body:t},response:{headers:a}}}};function vj(e){return"response.output_item.added"===e.type}function yj(e){var t;switch(e.type){case"search":return{action:{type:"search",query:null!=(t=e.query)?t:void 0}};case"open_page":return{action:{type:"openPage",url:e.url}};case"find":return{action:{type:"find",url:e.url,pattern:e.pattern}}}}var wj=hf((()=>pm(Ov({instructions:X_().nullish(),speed:yv().min(.25).max(4).default(1).nullish()})))),bj=class{constructor(e,t){this.modelId=e,this.config=t,this.specificationVersion="v2"}get provider(){return this.config.provider}async getArgs(e){let{text:t,voice:n="alloy",outputFormat:r="mp3",speed:o,instructions:a,language:i,providerOptions:s}=e;const l=[],c=await wf({provider:"openai",providerOptions:s,schema:wj}),u={model:this.modelId,input:t,voice:n,response_format:"mp3",speed:o,instructions:a};if(r&&(["mp3","opus","aac","flac","wav","pcm"].includes(r)?u.response_format=r:l.push({type:"unsupported-setting",setting:"outputFormat",details:"Unsupported output format: ".concat(r,". Using mp3 instead.")})),c){const e={};for(const t in e){const n=e[t];void 0!==n&&(u[t]=n)}}return i&&l.push({type:"unsupported-setting",setting:"language",details:'OpenAI speech models do not support language selection. Language parameter "'.concat(i,'" was ignored.')}),{requestBody:u,warnings:l}}async doGenerate(e){var t,n,r;const o=null!=(r=null==(n=null==(t=this.config._internal)?void 0:t.currentDate)?void 0:n.call(t))?r:new Date,{requestBody:a,warnings:i}=await this.getArgs(e),{value:s,responseHeaders:l,rawValue:c}=await xf({url:this.config.url({path:"/audio/speech",modelId:this.modelId}),headers:Wh(this.config.headers(),e.headers),body:a,failedResponseHandler:CB,successfulResponseHandler:async e=>{let{response:t,url:n,requestBodyValues:r}=e;const o=Hh(t);if(!t.body)throw new lu({message:"Response body is empty",url:n,requestBodyValues:r,statusCode:t.status,responseHeaders:o,responseBody:void 0});try{const e=await t.arrayBuffer();return{responseHeaders:o,value:new Uint8Array(e)}}catch(a){throw new lu({message:"Failed to read response as array buffer",url:n,requestBodyValues:r,statusCode:t.status,responseHeaders:o,responseBody:void 0,cause:a})}},abortSignal:e.abortSignal,fetch:this.config.fetch});return{audio:s,warnings:i,request:{body:JSON.stringify(a)},response:{timestamp:o,modelId:this.modelId,headers:l,body:c}}}},xj=hf((()=>pm(Ov({text:X_(),language:X_().nullish(),duration:yv().nullish(),words:Pv(Ov({word:X_(),start:yv(),end:yv()})).nullish(),segments:Pv(Ov({id:yv(),seek:yv(),start:yv(),end:yv(),text:X_(),tokens:Pv(yv()),temperature:yv(),avg_logprob:yv(),compression_ratio:yv(),no_speech_prob:yv()})).nullish()})))),kj=hf((()=>pm(Ov({include:Pv(X_()).optional(),language:X_().optional(),prompt:X_().optional(),temperature:yv().min(0).max(1).default(0).optional(),timestampGranularities:Pv(Zv(["word","segment"])).default(["segment"]).optional()})))),Cj={afrikaans:"af",arabic:"ar",armenian:"hy",azerbaijani:"az",belarusian:"be",bosnian:"bs",bulgarian:"bg",catalan:"ca",chinese:"zh",croatian:"hr",czech:"cs",danish:"da",dutch:"nl",english:"en",estonian:"et",finnish:"fi",french:"fr",galician:"gl",german:"de",greek:"el",hebrew:"he",hindi:"hi",hungarian:"hu",icelandic:"is",indonesian:"id",italian:"it",japanese:"ja",kannada:"kn",kazakh:"kk",korean:"ko",latvian:"lv",lithuanian:"lt",macedonian:"mk",malay:"ms",marathi:"mr",maori:"mi",nepali:"ne",norwegian:"no",persian:"fa",polish:"pl",portuguese:"pt",romanian:"ro",russian:"ru",serbian:"sr",slovak:"sk",slovenian:"sl",spanish:"es",swahili:"sw",swedish:"sv",tagalog:"tl",tamil:"ta",thai:"th",turkish:"tr",ukrainian:"uk",urdu:"ur",vietnamese:"vi",welsh:"cy"},Dj=class{constructor(e,t){this.modelId=e,this.config=t,this.specificationVersion="v2"}get provider(){return this.config.provider}async getArgs(e){let{audio:t,mediaType:n,providerOptions:r}=e;const o=await wf({provider:"openai",providerOptions:r,schema:kj}),a=new FormData,i=t instanceof Uint8Array?new Blob([t]):new Blob([ym(t)]);a.append("model",this.modelId);const s=function(e){var t;const[n,r=""]=e.toLowerCase().split("/");return null!=(t={mpeg:"mp3","x-wav":"wav",opus:"ogg",mp4:"m4a","x-m4a":"m4a"}[r])?t:r}(n);if(a.append("file",new File([i],"audio",{type:n}),"audio.".concat(s)),o){const e={include:o.include,language:o.language,prompt:o.prompt,response_format:["gpt-4o-transcribe","gpt-4o-mini-transcribe"].includes(this.modelId)?"json":"verbose_json",temperature:o.temperature,timestamp_granularities:o.timestampGranularities};for(const[t,n]of Object.entries(e))if(null!=n)if(Array.isArray(n))for(const e of n)a.append("".concat(t,"[]"),String(e));else a.append(t,String(n))}return{formData:a,warnings:[]}}async doGenerate(e){var t,n,r,o,a,i,s,l;const c=null!=(r=null==(n=null==(t=this.config._internal)?void 0:t.currentDate)?void 0:n.call(t))?r:new Date,{formData:u,warnings:d}=await this.getArgs(e),{value:p,responseHeaders:h,rawValue:f}=await(async e=>{let{url:t,headers:n,formData:r,failedResponseHandler:o,successfulResponseHandler:a,abortSignal:i,fetch:s}=e;return kf({url:t,headers:n,body:{content:r,values:Object.fromEntries(r.entries())},failedResponseHandler:o,successfulResponseHandler:a,abortSignal:i,fetch:s})})({url:this.config.url({path:"/audio/transcriptions",modelId:this.modelId}),headers:Wh(this.config.headers(),e.headers),formData:u,failedResponseHandler:CB,successfulResponseHandler:Af(xj),abortSignal:e.abortSignal,fetch:this.config.fetch}),m=null!=p.language&&p.language in Cj?Cj[p.language]:void 0;return{text:p.text,segments:null!=(s=null!=(i=null==(o=p.segments)?void 0:o.map((e=>({text:e.text,startSecond:e.start,endSecond:e.end}))))?i:null==(a=p.words)?void 0:a.map((e=>({text:e.word,startSecond:e.start,endSecond:e.end}))))?s:[],language:m,durationInSeconds:null!=(l=p.duration)?l:void 0,warnings:d,response:{timestamp:c,modelId:this.modelId,headers:h,body:f}}}};function Sj(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};var t,n;const r=null!=(t=xm(sf({settingValue:e.baseURL,environmentVariableName:"OPENAI_BASE_URL"})))?t:"https://api.openai.com/v1",o=null!=(n=e.name)?n:"openai",a=()=>ef(so({Authorization:"Bearer ".concat(af({apiKey:e.apiKey,environmentVariableName:"OPENAI_API_KEY",description:"OpenAI"})),"OpenAI-Organization":e.organization,"OpenAI-Project":e.project},e.headers),"ai-sdk/openai/".concat("2.0.52")),i=t=>new qB(t,{provider:"".concat(o,".embedding"),url:e=>{let{path:t}=e;return"".concat(r).concat(t)},headers:a,fetch:e.fetch}),s=t=>new HB(t,{provider:"".concat(o,".image"),url:e=>{let{path:t}=e;return"".concat(r).concat(t)},headers:a,fetch:e.fetch}),l=t=>new Dj(t,{provider:"".concat(o,".transcription"),url:e=>{let{path:t}=e;return"".concat(r).concat(t)},headers:a,fetch:e.fetch}),c=t=>new bj(t,{provider:"".concat(o,".speech"),url:e=>{let{path:t}=e;return"".concat(r).concat(t)},headers:a,fetch:e.fetch}),u=e=>{if(new.target)throw new Error("The OpenAI model function cannot be called with the new keyword.");return d(e)},d=t=>new _j(t,{provider:"".concat(o,".responses"),url:e=>{let{path:t}=e;return"".concat(r).concat(t)},headers:a,fetch:e.fetch,fileIdPrefixes:["file-"]}),p=function(e){return u(e)};return p.languageModel=u,p.chat=t=>new MB(t,{provider:"".concat(o,".chat"),url:e=>{let{path:t}=e;return"".concat(r).concat(t)},headers:a,fetch:e.fetch}),p.completion=t=>new LB(t,{provider:"".concat(o,".completion"),url:e=>{let{path:t}=e;return"".concat(r).concat(t)},headers:a,fetch:e.fetch}),p.responses=d,p.embedding=i,p.textEmbedding=i,p.textEmbeddingModel=i,p.image=s,p.imageModel=s,p.transcription=l,p.transcriptionModel=l,p.speech=c,p.speechModel=c,p.tools=uj,p}Sj();Ov({user:X_().optional(),reasoningEffort:X_().optional(),textVerbosity:X_().optional()});var Ej={errorSchema:Ov({error:Ov({message:X_(),type:X_().nullish(),param:Ev().nullish(),code:Lv([X_(),yv()]).nullish()})}),errorToMessage:e=>e.error.message};var Tj=Ov({prompt_tokens:yv().nullish(),completion_tokens:yv().nullish(),total_tokens:yv().nullish(),prompt_tokens_details:Ov({cached_tokens:yv().nullish()}).nullish(),completion_tokens_details:Ov({reasoning_tokens:yv().nullish(),accepted_prediction_tokens:yv().nullish(),rejected_prediction_tokens:yv().nullish()}).nullish()}).nullish();Ov({id:X_().nullish(),created:yv().nullish(),model:X_().nullish(),choices:Pv(Ov({message:Ov({role:Xv("assistant").nullish(),content:X_().nullish(),reasoning_content:X_().nullish(),reasoning:X_().nullish(),tool_calls:Pv(Ov({id:X_().nullish(),function:Ov({name:X_(),arguments:X_()})})).nullish()}),finish_reason:X_().nullish()})),usage:Tj});Ov({echo:kv().optional(),logitBias:Hv(X_(),yv()).optional(),suffix:X_().optional(),user:X_().optional()});var Aj=Ov({prompt_tokens:yv(),completion_tokens:yv(),total_tokens:yv()}),Mj=(Ov({id:X_().nullish(),created:yv().nullish(),model:X_().nullish(),choices:Pv(Ov({text:X_(),finish_reason:X_()})),usage:Aj.nullish()}),Ov({dimensions:yv().optional(),user:X_().optional()}),Ov({data:Pv(Ov({embedding:Pv(yv())})),usage:Ov({prompt_tokens:yv()}).nullish(),providerMetadata:Hv(X_(),Hv(X_(),Ev())).optional()}),class{constructor(e,t){this.modelId=e,this.config=t,this.specificationVersion="v2",this.maxImagesPerCall=10}get provider(){return this.config.provider}async doGenerate(e){let{prompt:t,n:n,size:r,aspectRatio:o,seed:a,providerOptions:i,headers:s,abortSignal:l}=e;var c,u,d,p,h;const f=[];null!=o&&f.push({type:"unsupported-setting",setting:"aspectRatio",details:"This model does not support aspect ratio. Use `size` instead."}),null!=a&&f.push({type:"unsupported-setting",setting:"seed"});const m=null!=(d=null==(u=null==(c=this.config._internal)?void 0:c.currentDate)?void 0:u.call(c))?d:new Date,{value:g,responseHeaders:_}=await xf({url:this.config.url({path:"/images/generations",modelId:this.modelId}),headers:Wh(this.config.headers(),s),body:so(so({model:this.modelId,prompt:t,n:n,size:r},null!=(p=i.openai)?p:{}),{},{response_format:"b64_json"}),failedResponseHandler:Ef(null!=(h=this.config.errorStructure)?h:Ej),successfulResponseHandler:Af(Fj),abortSignal:l,fetch:this.config.fetch});return{images:g.data.map((e=>e.b64_json)),warnings:f,response:{timestamp:m,modelId:this.modelId,headers:_}}}}),Fj=Ov({data:Pv(Ov({b64_json:X_()}))});function Ij(e){let{id:t,model:n,created:r}=e;return{id:null!=t?t:void 0,modelId:null!=n?n:void 0,timestamp:null!=r?new Date(1e3*r):void 0}}function Pj(e){switch(e){case"stop":return"stop";case"length":return"length";case"tool_calls":case"function_call":return"tool-calls";case"content_filter":return"content-filter";default:return"unknown"}}var zj=Vv("type",[Ov({type:Xv("web"),country:X_().length(2).optional(),excludedWebsites:Pv(X_()).max(5).optional(),allowedWebsites:Pv(X_()).max(5).optional(),safeSearch:kv().optional()}),Ov({type:Xv("x"),excludedXHandles:Pv(X_()).optional(),includedXHandles:Pv(X_()).optional(),postFavoriteCount:yv().int().optional(),postViewCount:yv().int().optional(),xHandles:Pv(X_()).optional()}),Ov({type:Xv("news"),country:X_().length(2).optional(),excludedWebsites:Pv(X_()).max(5).optional(),safeSearch:kv().optional()}),Ov({type:Xv("rss"),links:Pv(X_().url()).max(1)})]),Oj=Ov({reasoningEffort:Zv(["low","high"]).optional(),searchParameters:Ov({mode:Zv(["off","auto","on"]),returnCitations:kv().optional(),fromDate:X_().optional(),toDate:X_().optional(),maxSearchResults:yv().min(1).max(50).optional(),sources:Pv(zj).optional()}).optional()}),Nj=Ov({error:Ov({message:X_(),type:X_().nullish(),param:Ev().nullish(),code:Lv([X_(),yv()]).nullish()})}),Bj=Ef({errorSchema:Nj,errorToMessage:e=>e.error.message});var jj=class{constructor(e,t){this.specificationVersion="v2",this.supportedUrls={"image/*":[/^https?:\/\/.*$/]},this.modelId=e,this.config=t}get provider(){return this.config.provider}async getArgs(e){let{prompt:t,maxOutputTokens:n,temperature:r,topP:o,topK:a,frequencyPenalty:i,presencePenalty:s,stopSequences:l,seed:c,responseFormat:u,providerOptions:d,tools:p,toolChoice:h}=e;var f,m,g;const _=[],v=null!=(f=await wf({provider:"xai",providerOptions:d,schema:Oj}))?f:{};null!=a&&_.push({type:"unsupported-setting",setting:"topK"}),null!=i&&_.push({type:"unsupported-setting",setting:"frequencyPenalty"}),null!=s&&_.push({type:"unsupported-setting",setting:"presencePenalty"}),null!=l&&_.push({type:"unsupported-setting",setting:"stopSequences"}),null!=u&&"json"===u.type&&null!=u.schema&&_.push({type:"unsupported-setting",setting:"responseFormat",details:"JSON response format schema is not supported"});const{messages:y,warnings:w}=function(e){const t=[];for(const{role:n,content:r}of e)switch(n){case"system":t.push({role:"system",content:r});break;case"user":if(1===r.length&&"text"===r[0].type){t.push({role:"user",content:r[0].text});break}t.push({role:"user",content:r.map((e=>{switch(e.type){case"text":return{type:"text",text:e.text};case"file":if(e.mediaType.startsWith("image/")){const t="image/*"===e.mediaType?"image/jpeg":e.mediaType;return{type:"image_url",image_url:{url:e.data instanceof URL?e.data.toString():"data:".concat(t,";base64,").concat(bm(e.data))}}}throw new dd({functionality:"file part media type ".concat(e.mediaType)})}}))});break;case"assistant":{let e="";const n=[];for(const t of r)switch(t.type){case"text":e+=t.text;break;case"tool-call":n.push({id:t.toolCallId,type:"function",function:{name:t.toolName,arguments:JSON.stringify(t.input)}})}t.push({role:"assistant",content:e,tool_calls:n.length>0?n:void 0});break}case"tool":for(const e of r){const n=e.output;let r;switch(n.type){case"text":case"error-text":r=n.value;break;case"content":case"json":case"error-json":r=JSON.stringify(n.value)}t.push({role:"tool",tool_call_id:e.toolCallId,content:r})}break;default:throw new Error("Unsupported role: ".concat(n))}return{messages:t,warnings:[]}}(t);_.push(...w);const{tools:b,toolChoice:x,toolWarnings:k}=function(e){let{tools:t,toolChoice:n}=e;t=(null==t?void 0:t.length)?t:void 0;const r=[];if(null==t)return{tools:void 0,toolChoice:void 0,toolWarnings:r};const o=[];for(const i of t)"provider-defined"===i.type?r.push({type:"unsupported-tool",tool:i}):o.push({type:"function",function:{name:i.name,description:i.description,parameters:i.inputSchema}});if(null==n)return{tools:o,toolChoice:void 0,toolWarnings:r};const a=n.type;switch(a){case"auto":case"none":return{tools:o,toolChoice:a,toolWarnings:r};case"required":return{tools:o,toolChoice:"required",toolWarnings:r};case"tool":return{tools:o,toolChoice:{type:"function",function:{name:n.toolName}},toolWarnings:r};default:throw new dd({functionality:"tool choice type: ".concat(a)})}}({tools:p,toolChoice:h});_.push(...k);const C={model:this.modelId,max_tokens:n,temperature:r,top_p:o,seed:c,reasoning_effort:v.reasoningEffort,response_format:"json"===(null==u?void 0:u.type)?null!=u.schema?{type:"json_schema",json_schema:{name:null!=(m=u.name)?m:"response",schema:u.schema,strict:!0}}:{type:"json_object"}:void 0,search_parameters:v.searchParameters?{mode:v.searchParameters.mode,return_citations:v.searchParameters.returnCitations,from_date:v.searchParameters.fromDate,to_date:v.searchParameters.toDate,max_search_results:v.searchParameters.maxSearchResults,sources:null==(g=v.searchParameters.sources)?void 0:g.map((e=>{var t;return so(so(so(so({type:e.type},"web"===e.type&&{country:e.country,excluded_websites:e.excludedWebsites,allowed_websites:e.allowedWebsites,safe_search:e.safeSearch}),"x"===e.type&&{excluded_x_handles:e.excludedXHandles,included_x_handles:null!=(t=e.includedXHandles)?t:e.xHandles,post_favorite_count:e.postFavoriteCount,post_view_count:e.postViewCount}),"news"===e.type&&{country:e.country,excluded_websites:e.excludedWebsites,safe_search:e.safeSearch}),"rss"===e.type&&{links:e.links})}))}:void 0,messages:y,tools:b,tool_choice:x};return{args:C,warnings:_}}async doGenerate(e){var t,n,r;const{args:o,warnings:a}=await this.getArgs(e),{responseHeaders:i,value:s,rawValue:l}=await xf({url:"".concat(null!=(t=this.config.baseURL)?t:"https://api.x.ai/v1","/chat/completions"),headers:Wh(this.config.headers(),e.headers),body:o,failedResponseHandler:Bj,successfulResponseHandler:Af(Rj),abortSignal:e.abortSignal,fetch:this.config.fetch}),c=s.choices[0],u=[];if(null!=c.message.content&&c.message.content.length>0){let e=c.message.content;const t=o.messages[o.messages.length-1];"assistant"===(null==t?void 0:t.role)&&e===t.content&&(e=""),e.length>0&&u.push({type:"text",text:e})}if(null!=c.message.reasoning_content&&c.message.reasoning_content.length>0&&u.push({type:"reasoning",text:c.message.reasoning_content}),null!=c.message.tool_calls)for(const d of c.message.tool_calls)u.push({type:"tool-call",toolCallId:d.id,toolName:d.function.name,input:d.function.arguments});if(null!=s.citations)for(const d of s.citations)u.push({type:"source",sourceType:"url",id:this.config.generateId(),url:d});return{content:u,finishReason:Pj(c.finish_reason),usage:{inputTokens:s.usage.prompt_tokens,outputTokens:s.usage.completion_tokens,totalTokens:s.usage.total_tokens,reasoningTokens:null!=(r=null==(n=s.usage.completion_tokens_details)?void 0:n.reasoning_tokens)?r:void 0},request:{body:o},response:so(so({},Ij(s)),{},{headers:i,body:l}),warnings:a}}async doStream(e){var t;const{args:n,warnings:r}=await this.getArgs(e),o=so(so({},n),{},{stream:!0,stream_options:{include_usage:!0}}),{responseHeaders:a,value:i}=await xf({url:"".concat(null!=(t=this.config.baseURL)?t:"https://api.x.ai/v1","/chat/completions"),headers:Wh(this.config.headers(),e.headers),body:o,failedResponseHandler:Bj,successfulResponseHandler:Tf(Vj),abortSignal:e.abortSignal,fetch:this.config.fetch});let s="unknown";const l={inputTokens:void 0,outputTokens:void 0,totalTokens:void 0};let c=!0;const u={},d={},p=this;return{stream:i.pipeThrough(new TransformStream({start(e){e.enqueue({type:"stream-start",warnings:r})},transform(t,n){var r,a;if(e.includeRawChunks&&n.enqueue({type:"raw",rawValue:t.rawValue}),!t.success)return void n.enqueue({type:"error",error:t.error});const i=t.value;if(c&&(n.enqueue(so({type:"response-metadata"},Ij(i))),c=!1),null!=i.citations)for(const e of i.citations)n.enqueue({type:"source",sourceType:"url",id:p.config.generateId(),url:e});null!=i.usage&&(l.inputTokens=i.usage.prompt_tokens,l.outputTokens=i.usage.completion_tokens,l.totalTokens=i.usage.total_tokens,l.reasoningTokens=null!=(a=null==(r=i.usage.completion_tokens_details)?void 0:r.reasoning_tokens)?a:void 0);const h=i.choices[0];if(null!=(null==h?void 0:h.finish_reason)&&(s=Pj(h.finish_reason)),null==(null==h?void 0:h.delta))return;const f=h.delta,m=h.index;if(null!=f.content&&f.content.length>0){const e=f.content,t=o.messages[o.messages.length-1];if("assistant"===(null==t?void 0:t.role)&&e===t.content)return;const r="text-".concat(i.id||m);null==u[r]&&(u[r]={type:"text"},n.enqueue({type:"text-start",id:r})),n.enqueue({type:"text-delta",id:r,delta:e})}if(null!=f.reasoning_content&&f.reasoning_content.length>0){const e="reasoning-".concat(i.id||m);if(d[e]===f.reasoning_content)return;d[e]=f.reasoning_content,null==u[e]&&(u[e]={type:"reasoning"},n.enqueue({type:"reasoning-start",id:e})),n.enqueue({type:"reasoning-delta",id:e,delta:f.reasoning_content})}if(null!=f.tool_calls)for(const e of f.tool_calls){const t=e.id;n.enqueue({type:"tool-input-start",id:t,toolName:e.function.name}),n.enqueue({type:"tool-input-delta",id:t,delta:e.function.arguments}),n.enqueue({type:"tool-input-end",id:t}),n.enqueue({type:"tool-call",toolCallId:t,toolName:e.function.name,input:e.function.arguments})}},flush(e){for(const[t,n]of Object.entries(u))e.enqueue({type:"text"===n.type?"text-end":"reasoning-end",id:t});e.enqueue({type:"finish",finishReason:s,usage:l})}})),request:{body:o},response:{headers:a}}}},Lj=Ov({prompt_tokens:yv(),completion_tokens:yv(),total_tokens:yv(),completion_tokens_details:Ov({reasoning_tokens:yv().nullish()}).nullish()}),Rj=Ov({id:X_().nullish(),created:yv().nullish(),model:X_().nullish(),choices:Pv(Ov({message:Ov({role:Xv("assistant"),content:X_().nullish(),reasoning_content:X_().nullish(),tool_calls:Pv(Ov({id:X_(),type:Xv("function"),function:Ov({name:X_(),arguments:X_()})})).nullish()}),index:yv(),finish_reason:X_().nullish()})),object:Xv("chat.completion"),usage:Lj,citations:Pv(X_().url()).nullish()}),Vj=Ov({id:X_().nullish(),created:yv().nullish(),model:X_().nullish(),choices:Pv(Ov({delta:Ov({role:Zv(["assistant"]).optional(),content:X_().nullish(),reasoning_content:X_().nullish(),tool_calls:Pv(Ov({id:X_(),type:Xv("function"),function:Ov({name:X_(),arguments:X_()})})).nullish()}),finish_reason:X_().nullish(),index:yv()})),usage:Lj.nullish(),citations:Pv(X_().url()).nullish()}),qj={errorSchema:Nj,errorToMessage:e=>e.error.message};function Uj(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};var t;const n=xm(null!=(t=e.baseURL)?t:"https://api.x.ai/v1"),r=()=>ef(so({Authorization:"Bearer ".concat(af({apiKey:e.apiKey,environmentVariableName:"XAI_API_KEY",description:"xAI API key"}))},e.headers),"ai-sdk/xai/".concat("2.0.26")),o=t=>new jj(t,{provider:"xai.chat",baseURL:n,headers:r,generateId:Zh,fetch:e.fetch}),a=t=>new Mj(t,{provider:"xai.image",url:e=>{let{path:t}=e;return"".concat(n).concat(t)},headers:r,fetch:e.fetch,errorStructure:qj}),i=e=>o(e);return i.languageModel=o,i.chat=o,i.textEmbeddingModel=e=>{throw new Xu({modelId:e,modelType:"textEmbeddingModel"})},i.imageModel=a,i.image=a,i}Uj();var Wj=fm((()=>pm(Ov({type:Xv("error"),error:Ov({type:X_(),message:X_()})})))),Gj=Ef({errorSchema:Wj,errorToMessage:e=>e.error.message}),Hj=fm((()=>pm(Ov({type:Xv("message"),id:X_().nullish(),model:X_().nullish(),content:Pv(Vv("type",[Ov({type:Xv("text"),text:X_(),citations:Pv(Vv("type",[Ov({type:Xv("web_search_result_location"),cited_text:X_(),url:X_(),title:X_(),encrypted_index:X_()}),Ov({type:Xv("page_location"),cited_text:X_(),document_index:yv(),document_title:X_().nullable(),start_page_number:yv(),end_page_number:yv()}),Ov({type:Xv("char_location"),cited_text:X_(),document_index:yv(),document_title:X_().nullable(),start_char_index:yv(),end_char_index:yv()})])).optional()}),Ov({type:Xv("thinking"),thinking:X_(),signature:X_()}),Ov({type:Xv("redacted_thinking"),data:X_()}),Ov({type:Xv("tool_use"),id:X_(),name:X_(),input:Av()}),Ov({type:Xv("server_tool_use"),id:X_(),name:X_(),input:Hv(X_(),Av()).nullish()}),Ov({type:Xv("web_fetch_tool_result"),tool_use_id:X_(),content:Lv([Ov({type:Xv("web_fetch_result"),url:X_(),retrieved_at:X_(),content:Ov({type:Xv("document"),title:X_().nullable(),citations:Ov({enabled:kv()}).optional(),source:Ov({type:Xv("text"),media_type:X_(),data:X_()})})}),Ov({type:Xv("web_fetch_tool_result_error"),error_code:X_()})])}),Ov({type:Xv("web_search_tool_result"),tool_use_id:X_(),content:Lv([Pv(Ov({type:Xv("web_search_result"),url:X_(),title:X_(),encrypted_content:X_(),page_age:X_().nullish()})),Ov({type:Xv("web_search_tool_result_error"),error_code:X_()})])}),Ov({type:Xv("code_execution_tool_result"),tool_use_id:X_(),content:Lv([Ov({type:Xv("code_execution_result"),stdout:X_(),stderr:X_(),return_code:yv()}),Ov({type:Xv("code_execution_tool_result_error"),error_code:X_()})])}),Ov({type:Xv("bash_code_execution_tool_result"),tool_use_id:X_(),content:Vv("type",[Ov({type:Xv("bash_code_execution_result"),content:Pv(Ov({type:Xv("bash_code_execution_output"),file_id:X_()})),stdout:X_(),stderr:X_(),return_code:yv()}),Ov({type:Xv("bash_code_execution_tool_result_error"),error_code:X_()})])}),Ov({type:Xv("text_editor_code_execution_tool_result"),tool_use_id:X_(),content:Vv("type",[Ov({type:Xv("text_editor_code_execution_tool_result_error"),error_code:X_()}),Ov({type:Xv("text_editor_code_execution_view_result"),content:X_(),file_type:X_(),num_lines:yv().nullable(),start_line:yv().nullable(),total_lines:yv().nullable()}),Ov({type:Xv("text_editor_code_execution_create_result"),is_file_update:kv()}),Ov({type:Xv("text_editor_code_execution_str_replace_result"),lines:Pv(X_()).nullable(),new_lines:yv().nullable(),new_start:yv().nullable(),old_lines:yv().nullable(),old_start:yv().nullable()})])})])),stop_reason:X_().nullish(),stop_sequence:X_().nullish(),usage:Bv({input_tokens:yv(),output_tokens:yv(),cache_creation_input_tokens:yv().nullish(),cache_read_input_tokens:yv().nullish()})})))),Kj=fm((()=>pm(Vv("type",[Ov({type:Xv("message_start"),message:Ov({id:X_().nullish(),model:X_().nullish(),usage:Bv({input_tokens:yv(),cache_creation_input_tokens:yv().nullish(),cache_read_input_tokens:yv().nullish()})})}),Ov({type:Xv("content_block_start"),index:yv(),content_block:Vv("type",[Ov({type:Xv("text"),text:X_()}),Ov({type:Xv("thinking"),thinking:X_()}),Ov({type:Xv("tool_use"),id:X_(),name:X_()}),Ov({type:Xv("redacted_thinking"),data:X_()}),Ov({type:Xv("server_tool_use"),id:X_(),name:X_(),input:Hv(X_(),Av()).nullish()}),Ov({type:Xv("web_fetch_tool_result"),tool_use_id:X_(),content:Lv([Ov({type:Xv("web_fetch_result"),url:X_(),retrieved_at:X_(),content:Ov({type:Xv("document"),title:X_().nullable(),citations:Ov({enabled:kv()}).optional(),source:Ov({type:Xv("text"),media_type:X_(),data:X_()})})}),Ov({type:Xv("web_fetch_tool_result_error"),error_code:X_()})])}),Ov({type:Xv("web_search_tool_result"),tool_use_id:X_(),content:Lv([Pv(Ov({type:Xv("web_search_result"),url:X_(),title:X_(),encrypted_content:X_(),page_age:X_().nullish()})),Ov({type:Xv("web_search_tool_result_error"),error_code:X_()})])}),Ov({type:Xv("code_execution_tool_result"),tool_use_id:X_(),content:Lv([Ov({type:Xv("code_execution_result"),stdout:X_(),stderr:X_(),return_code:yv()}),Ov({type:Xv("code_execution_tool_result_error"),error_code:X_()})])}),Ov({type:Xv("bash_code_execution_tool_result"),tool_use_id:X_(),content:Vv("type",[Ov({type:Xv("bash_code_execution_result"),content:Pv(Ov({type:Xv("bash_code_execution_output"),file_id:X_()})),stdout:X_(),stderr:X_(),return_code:yv()}),Ov({type:Xv("bash_code_execution_tool_result_error"),error_code:X_()})])}),Ov({type:Xv("text_editor_code_execution_tool_result"),tool_use_id:X_(),content:Vv("type",[Ov({type:Xv("text_editor_code_execution_tool_result_error"),error_code:X_()}),Ov({type:Xv("text_editor_code_execution_view_result"),content:X_(),file_type:X_(),num_lines:yv().nullable(),start_line:yv().nullable(),total_lines:yv().nullable()}),Ov({type:Xv("text_editor_code_execution_create_result"),is_file_update:kv()}),Ov({type:Xv("text_editor_code_execution_str_replace_result"),lines:Pv(X_()).nullable(),new_lines:yv().nullable(),new_start:yv().nullable(),old_lines:yv().nullable(),old_start:yv().nullable()})])})])}),Ov({type:Xv("content_block_delta"),index:yv(),delta:Vv("type",[Ov({type:Xv("input_json_delta"),partial_json:X_()}),Ov({type:Xv("text_delta"),text:X_()}),Ov({type:Xv("thinking_delta"),thinking:X_()}),Ov({type:Xv("signature_delta"),signature:X_()}),Ov({type:Xv("citations_delta"),citation:Vv("type",[Ov({type:Xv("web_search_result_location"),cited_text:X_(),url:X_(),title:X_(),encrypted_index:X_()}),Ov({type:Xv("page_location"),cited_text:X_(),document_index:yv(),document_title:X_().nullable(),start_page_number:yv(),end_page_number:yv()}),Ov({type:Xv("char_location"),cited_text:X_(),document_index:yv(),document_title:X_().nullable(),start_char_index:yv(),end_char_index:yv()})])})])}),Ov({type:Xv("content_block_stop"),index:yv()}),Ov({type:Xv("error"),error:Ov({type:X_(),message:X_()})}),Ov({type:Xv("message_delta"),delta:Ov({stop_reason:X_().nullish(),stop_sequence:X_().nullish()}),usage:Bv({output_tokens:yv(),cache_creation_input_tokens:yv().nullish()})}),Ov({type:Xv("message_stop")}),Ov({type:Xv("ping")})])))),Zj=fm((()=>pm(Ov({signature:X_().optional(),redactedData:X_().optional()})))),$j=Ov({citations:Ov({enabled:kv()}).optional(),title:X_().optional(),context:X_().optional()}),Xj=Ov({sendReasoning:kv().optional(),thinking:Ov({type:Lv([Xv("enabled"),Xv("disabled")]),budgetTokens:yv().optional()}).optional(),disableParallelToolUse:kv().optional(),cacheControl:Ov({type:Xv("ephemeral"),ttl:Lv([Xv("5m"),Xv("1h")]).optional()}).optional()});function Jj(e){var t;const n=null==e?void 0:e.anthropic;return null!=(t=null==n?void 0:n.cacheControl)?t:null==n?void 0:n.cache_control}var Qj=fm((()=>pm(Ov({maxCharacters:yv().optional()})))),Yj=Cf({id:"anthropic.text_editor_20250728",name:"str_replace_based_edit_tool",inputSchema:fm((()=>pm(Ov({command:Zv(["view","create","str_replace","insert"]),path:X_(),file_text:X_().optional(),insert_line:yv().int().optional(),new_str:X_().optional(),old_str:X_().optional(),view_range:Pv(yv().int()).optional()}))))}),eL=fm((()=>pm(Ov({maxUses:yv().optional(),allowedDomains:Pv(X_()).optional(),blockedDomains:Pv(X_()).optional(),userLocation:Ov({type:Xv("approximate"),city:X_().optional(),region:X_().optional(),country:X_().optional(),timezone:X_().optional()}).optional()})))),tL=fm((()=>pm(Pv(Ov({url:X_(),title:X_(),pageAge:X_().nullable(),encryptedContent:X_(),type:Xv("web_search_result")}))))),nL=Df({id:"anthropic.web_search_20250305",name:"web_search",inputSchema:fm((()=>pm(Ov({query:X_()})))),outputSchema:tL}),rL=fm((()=>pm(Ov({maxUses:yv().optional(),allowedDomains:Pv(X_()).optional(),blockedDomains:Pv(X_()).optional(),citations:Ov({enabled:kv()}).optional(),maxContentTokens:yv().optional()})))),oL=fm((()=>pm(Ov({type:Xv("web_fetch_result"),url:X_(),content:Ov({type:Xv("document"),title:X_(),citations:Ov({enabled:kv()}).optional(),source:Lv([Ov({type:Xv("base64"),mediaType:Xv("application/pdf"),data:X_()}),Ov({type:Xv("text"),mediaType:Xv("text/plain"),data:X_()})])}),retrievedAt:X_().nullable()})))),aL=Df({id:"anthropic.web_fetch_20250910",name:"web_fetch",inputSchema:fm((()=>pm(Ov({url:X_()})))),outputSchema:oL});var iL=fm((()=>pm(Ov({type:Xv("code_execution_result"),stdout:X_(),stderr:X_(),return_code:yv()})))),sL=Df({id:"anthropic.code_execution_20250522",name:"code_execution",inputSchema:fm((()=>pm(Ov({code:X_()})))),outputSchema:iL}),lL=fm((()=>pm(Vv("type",[Ov({type:Xv("bash_code_execution_result"),content:Pv(Ov({type:Xv("bash_code_execution_output"),file_id:X_()})),stdout:X_(),stderr:X_(),return_code:yv()}),Ov({type:Xv("bash_code_execution_tool_result_error"),error_code:X_()}),Ov({type:Xv("text_editor_code_execution_tool_result_error"),error_code:X_()}),Ov({type:Xv("text_editor_code_execution_view_result"),content:X_(),file_type:X_(),num_lines:yv().nullable(),start_line:yv().nullable(),total_lines:yv().nullable()}),Ov({type:Xv("text_editor_code_execution_create_result"),is_file_update:kv()}),Ov({type:Xv("text_editor_code_execution_str_replace_result"),lines:Pv(X_()).nullable(),new_lines:yv().nullable(),new_start:yv().nullable(),old_lines:yv().nullable(),old_start:yv().nullable()})])))),cL=Df({id:"anthropic.code_execution_20250825",name:"code_execution",inputSchema:fm((()=>pm(Vv("type",[Ov({type:Xv("bash_code_execution"),command:X_()}),Vv("command",[Ov({type:Xv("text_editor_code_execution"),command:Xv("view"),path:X_()}),Ov({type:Xv("text_editor_code_execution"),command:Xv("create"),path:X_(),file_text:X_().nullish()}),Ov({type:Xv("text_editor_code_execution"),command:Xv("str_replace"),path:X_(),old_str:X_(),new_str:X_()})])])))),outputSchema:lL});function uL(e){if("string"===typeof e)return Buffer.from(e,"base64").toString("utf-8");if(e instanceof Uint8Array)return(new TextDecoder).decode(e);if(e instanceof URL)throw new dd({functionality:"URL-based text documents are not supported for citations"});throw new dd({functionality:"unsupported data type for text documents: ".concat(typeof e)})}async function dL(e){let{prompt:t,sendReasoning:n,warnings:r}=e;var o,a,i,s,l;const c=new Set,u=function(e){const t=[];let n;for(const r of e){const{role:e}=r;switch(e){case"system":"system"!==(null==n?void 0:n.type)&&(n={type:"system",messages:[]},t.push(n)),n.messages.push(r);break;case"assistant":"assistant"!==(null==n?void 0:n.type)&&(n={type:"assistant",messages:[]},t.push(n)),n.messages.push(r);break;case"user":case"tool":"user"!==(null==n?void 0:n.type)&&(n={type:"user",messages:[]},t.push(n)),n.messages.push(r);break;default:throw new Error("Unsupported role: ".concat(e))}}return t}(t);let d;const p=[];async function h(e){var t,n;const r=await wf({provider:"anthropic",providerOptions:e,schema:$j});return null!=(n=null==(t=null==r?void 0:r.citations)?void 0:t.enabled)&&n}async function f(e){const t=await wf({provider:"anthropic",providerOptions:e,schema:$j});return{title:null==t?void 0:t.title,context:null==t?void 0:t.context}}for(let m=0;m<u.length;m++){const e=u[m],t=m===u.length-1,g=e.type;switch(g){case"system":if(null!=d)throw new dd({functionality:"Multiple system messages that are separated by user/assistant messages"});d=e.messages.map((e=>{let{content:t,providerOptions:n}=e;return{type:"text",text:t,cache_control:Jj(n)}}));break;case"user":{const t=[];for(const n of e.messages){const{role:e,content:r}=n;switch(e){case"user":for(let e=0;e<r.length;e++){const s=r[e],l=e===r.length-1,u=null!=(o=Jj(s.providerOptions))?o:l?Jj(n.providerOptions):void 0;switch(s.type){case"text":t.push({type:"text",text:s.text,cache_control:u});break;case"file":if(s.mediaType.startsWith("image/"))t.push({type:"image",source:s.data instanceof URL?{type:"url",url:s.data.toString()}:{type:"base64",media_type:"image/*"===s.mediaType?"image/jpeg":s.mediaType,data:bm(s.data)},cache_control:u});else if("application/pdf"===s.mediaType){c.add("pdfs-2024-09-25");const e=await h(s.providerOptions),n=await f(s.providerOptions);t.push(so(so(so({type:"document",source:s.data instanceof URL?{type:"url",url:s.data.toString()}:{type:"base64",media_type:"application/pdf",data:bm(s.data)},title:null!=(a=n.title)?a:s.filename},n.context&&{context:n.context}),e&&{citations:{enabled:!0}}),{},{cache_control:u}))}else{if("text/plain"!==s.mediaType)throw new dd({functionality:"media type: ".concat(s.mediaType)});{const e=await h(s.providerOptions),n=await f(s.providerOptions);t.push(so(so(so({type:"document",source:s.data instanceof URL?{type:"url",url:s.data.toString()}:{type:"text",media_type:"text/plain",data:uL(s.data)},title:null!=(i=n.title)?i:s.filename},n.context&&{context:n.context}),e&&{citations:{enabled:!0}}),{},{cache_control:u}))}}}}break;case"tool":for(let e=0;e<r.length;e++){const o=r[e],a=e===r.length-1,i=null!=(s=Jj(o.providerOptions))?s:a?Jj(n.providerOptions):void 0,l=o.output;let u;switch(l.type){case"content":u=l.value.map((e=>{switch(e.type){case"text":return{type:"text",text:e.text,cache_control:void 0};case"media":if(e.mediaType.startsWith("image/"))return{type:"image",source:{type:"base64",media_type:e.mediaType,data:e.data},cache_control:void 0};if("application/pdf"===e.mediaType)return c.add("pdfs-2024-09-25"),{type:"document",source:{type:"base64",media_type:e.mediaType,data:e.data},cache_control:void 0};throw new dd({functionality:"media type: ".concat(e.mediaType)})}}));break;case"text":case"error-text":u=l.value;break;default:u=JSON.stringify(l.value)}t.push({type:"tool_result",tool_use_id:o.toolCallId,content:u,is_error:"error-text"===l.type||"error-json"===l.type||void 0,cache_control:i})}break;default:throw new Error("Unsupported role: ".concat(e))}}p.push({role:"user",content:t});break}case"assistant":{const o=[];for(let a=0;a<e.messages.length;a++){const i=e.messages[a],s=a===e.messages.length-1,{content:c}=i;for(let e=0;e<c.length;e++){const a=c[e],u=e===c.length-1,d=null!=(l=Jj(a.providerOptions))?l:u?Jj(i.providerOptions):void 0;switch(a.type){case"text":o.push({type:"text",text:t&&s&&u?a.text.trim():a.text,cache_control:d});break;case"reasoning":if(n){const e=await wf({provider:"anthropic",providerOptions:a.providerOptions,schema:Zj});null!=e?null!=e.signature?o.push({type:"thinking",thinking:a.text,signature:e.signature,cache_control:d}):null!=e.redactedData?o.push({type:"redacted_thinking",data:e.redactedData,cache_control:d}):r.push({type:"other",message:"unsupported reasoning metadata"}):r.push({type:"other",message:"unsupported reasoning metadata"})}else r.push({type:"other",message:"sending reasoning content is disabled for this model"});break;case"tool-call":if(a.providerExecuted){"code_execution"!==a.toolName||null==a.input||"object"!==typeof a.input||!("type"in a.input)||"string"!==typeof a.input.type||"bash_code_execution"!==a.input.type&&"text_editor_code_execution"!==a.input.type?"code_execution"===a.toolName||"web_fetch"===a.toolName||"web_search"===a.toolName?o.push({type:"server_tool_use",id:a.toolCallId,name:a.toolName,input:a.input,cache_control:d}):r.push({type:"other",message:"provider executed tool call for tool ".concat(a.toolName," is not supported")}):o.push({type:"server_tool_use",id:a.toolCallId,name:a.input.type,input:a.input,cache_control:d});break}o.push({type:"tool_use",id:a.toolCallId,name:a.toolName,input:a.input,cache_control:d});break;case"tool-result":if("code_execution"===a.toolName){const e=a.output;if("json"!==e.type){r.push({type:"other",message:"provider executed tool result output type ".concat(e.type," for tool ").concat(a.toolName," is not supported")});break}if(null==e.value||"object"!==typeof e.value||!("type"in e.value)||"string"!==typeof e.value.type){r.push({type:"other",message:"provider executed tool result output value is not a valid code execution result for tool ".concat(a.toolName)});break}if("code_execution_result"===e.value.type){const t=await mf({value:e.value,schema:iL});o.push({type:"code_execution_tool_result",tool_use_id:a.toolCallId,content:{type:t.type,stdout:t.stdout,stderr:t.stderr,return_code:t.return_code},cache_control:d})}else{const t=await mf({value:e.value,schema:lL});o.push("bash_code_execution_result"===t.type||"bash_code_execution_tool_result_error"===t.type?{type:"bash_code_execution_tool_result",tool_use_id:a.toolCallId,cache_control:d,content:t}:{type:"text_editor_code_execution_tool_result",tool_use_id:a.toolCallId,cache_control:d,content:t})}break}if("web_fetch"===a.toolName){const e=a.output;if("json"!==e.type){r.push({type:"other",message:"provider executed tool result output type ".concat(e.type," for tool ").concat(a.toolName," is not supported")});break}const t=await mf({value:e.value,schema:oL});o.push({type:"web_fetch_tool_result",tool_use_id:a.toolCallId,content:{type:"web_fetch_result",url:t.url,retrieved_at:t.retrievedAt,content:{type:"document",title:t.content.title,citations:t.content.citations,source:{type:t.content.source.type,media_type:t.content.source.mediaType,data:t.content.source.data}}},cache_control:d});break}if("web_search"===a.toolName){const e=a.output;if("json"!==e.type){r.push({type:"other",message:"provider executed tool result output type ".concat(e.type," for tool ").concat(a.toolName," is not supported")});break}const t=await mf({value:e.value,schema:tL});o.push({type:"web_search_tool_result",tool_use_id:a.toolCallId,content:t.map((e=>({url:e.url,title:e.title,page_age:e.pageAge,encrypted_content:e.encryptedContent,type:e.type}))),cache_control:d});break}r.push({type:"other",message:"provider executed tool result for tool ".concat(a.toolName," is not supported")})}}}p.push({role:"assistant",content:o});break}default:throw new Error("content type: ".concat(g))}}return{prompt:{system:d,messages:p},betas:c}}function pL(e){let{finishReason:t,isJsonResponseFromTool:n}=e;switch(t){case"pause_turn":case"end_turn":case"stop_sequence":return"stop";case"refusal":return"content-filter";case"tool_use":return n?"stop":"tool-calls";case"max_tokens":return"length";default:return"unknown"}}function hL(e,t,n){var r;if("page_location"!==e.type&&"char_location"!==e.type)return;const o=t[e.document_index];return o?{type:"source",sourceType:"document",id:n(),mediaType:o.mediaType,title:null!=(r=e.document_title)?r:o.title,filename:o.filename,providerMetadata:{anthropic:"page_location"===e.type?{citedText:e.cited_text,startPageNumber:e.start_page_number,endPageNumber:e.end_page_number}:{citedText:e.cited_text,startCharIndex:e.start_char_index,endCharIndex:e.end_char_index}}}:void 0}var fL=class{constructor(e,t){var n;this.specificationVersion="v2",this.modelId=e,this.config=t,this.generateId=null!=(n=t.generateId)?n:Zh}supportsUrl(e){return"https:"===e.protocol}get provider(){return this.config.provider}get supportedUrls(){var e,t,n;return null!=(n=null==(t=(e=this.config).supportedUrls)?void 0:t.call(e))?n:{}}async getArgs(e){let{prompt:t,maxOutputTokens:n=4096,temperature:r,topP:o,topK:a,frequencyPenalty:i,presencePenalty:s,stopSequences:l,responseFormat:c,seed:u,tools:d,toolChoice:p,providerOptions:h}=e;var f,m,g;const _=[];null!=i&&_.push({type:"unsupported-setting",setting:"frequencyPenalty"}),null!=s&&_.push({type:"unsupported-setting",setting:"presencePenalty"}),null!=u&&_.push({type:"unsupported-setting",setting:"seed"}),"json"===(null==c?void 0:c.type)&&(null==c.schema?_.push({type:"unsupported-setting",setting:"responseFormat",details:"JSON response format requires a schema. The response format is ignored."}):null!=d&&_.push({type:"unsupported-setting",setting:"tools",details:"JSON response format does not support tools. The provided tools are ignored."}));const v="json"===(null==c?void 0:c.type)&&null!=c.schema?{type:"function",name:"json",description:"Respond with a JSON object.",inputSchema:c.schema}:void 0,y=await wf({provider:"anthropic",providerOptions:h,schema:Xj}),{prompt:w,betas:b}=await dL({prompt:t,sendReasoning:null==(f=null==y?void 0:y.sendReasoning)||f,warnings:_}),x="enabled"===(null==(m=null==y?void 0:y.thinking)?void 0:m.type),k=null==(g=null==y?void 0:y.thinking)?void 0:g.budgetTokens,C=so(so({model:this.modelId,max_tokens:n,temperature:r,top_k:a,top_p:o,stop_sequences:l},x&&{thinking:{type:"enabled",budget_tokens:k}}),{},{system:w.system,messages:w.messages});if(x){if(null==k)throw new dd({functionality:"thinking requires a budget"});null!=C.temperature&&(C.temperature=void 0,_.push({type:"unsupported-setting",setting:"temperature",details:"temperature is not supported when thinking is enabled"})),null!=a&&(C.top_k=void 0,_.push({type:"unsupported-setting",setting:"topK",details:"topK is not supported when thinking is enabled"})),null!=o&&(C.top_p=void 0,_.push({type:"unsupported-setting",setting:"topP",details:"topP is not supported when thinking is enabled"})),C.max_tokens=n+k}const{tools:D,toolChoice:S,toolWarnings:E,betas:T}=await async function(e){let{tools:t,toolChoice:n,disableParallelToolUse:r}=e;t=(null==t?void 0:t.length)?t:void 0;const o=[],a=new Set;if(null==t)return{tools:void 0,toolChoice:void 0,toolWarnings:o,betas:a};const i=[];for(const l of t)switch(l.type){case"function":{const e=Jj(l.providerOptions);i.push({name:l.name,description:l.description,input_schema:l.inputSchema,cache_control:e});break}case"provider-defined":switch(l.id){case"anthropic.code_execution_20250522":a.add("code-execution-2025-05-22"),i.push({type:"code_execution_20250522",name:"code_execution"});break;case"anthropic.code_execution_20250825":a.add("code-execution-2025-08-25"),i.push({type:"code_execution_20250825",name:"code_execution"});break;case"anthropic.computer_20250124":a.add("computer-use-2025-01-24"),i.push({name:"computer",type:"computer_20250124",display_width_px:l.args.displayWidthPx,display_height_px:l.args.displayHeightPx,display_number:l.args.displayNumber});break;case"anthropic.computer_20241022":a.add("computer-use-2024-10-22"),i.push({name:"computer",type:"computer_20241022",display_width_px:l.args.displayWidthPx,display_height_px:l.args.displayHeightPx,display_number:l.args.displayNumber});break;case"anthropic.text_editor_20250124":a.add("computer-use-2025-01-24"),i.push({name:"str_replace_editor",type:"text_editor_20250124"});break;case"anthropic.text_editor_20241022":a.add("computer-use-2024-10-22"),i.push({name:"str_replace_editor",type:"text_editor_20241022"});break;case"anthropic.text_editor_20250429":a.add("computer-use-2025-01-24"),i.push({name:"str_replace_based_edit_tool",type:"text_editor_20250429"});break;case"anthropic.text_editor_20250728":{const e=await mf({value:l.args,schema:Qj});i.push({name:"str_replace_based_edit_tool",type:"text_editor_20250728",max_characters:e.maxCharacters});break}case"anthropic.bash_20250124":a.add("computer-use-2025-01-24"),i.push({name:"bash",type:"bash_20250124"});break;case"anthropic.bash_20241022":a.add("computer-use-2024-10-22"),i.push({name:"bash",type:"bash_20241022"});break;case"anthropic.memory_20250818":a.add("context-management-2025-06-27"),i.push({name:"memory",type:"memory_20250818"});break;case"anthropic.web_fetch_20250910":{a.add("web-fetch-2025-09-10");const e=await mf({value:l.args,schema:rL});i.push({type:"web_fetch_20250910",name:"web_fetch",max_uses:e.maxUses,allowed_domains:e.allowedDomains,blocked_domains:e.blockedDomains,citations:e.citations,max_content_tokens:e.maxContentTokens});break}case"anthropic.web_search_20250305":{const e=await mf({value:l.args,schema:eL});i.push({type:"web_search_20250305",name:"web_search",max_uses:e.maxUses,allowed_domains:e.allowedDomains,blocked_domains:e.blockedDomains,user_location:e.userLocation});break}default:o.push({type:"unsupported-tool",tool:l})}break;default:o.push({type:"unsupported-tool",tool:l})}if(null==n)return{tools:i,toolChoice:r?{type:"auto",disable_parallel_tool_use:r}:void 0,toolWarnings:o,betas:a};const s=n.type;switch(s){case"auto":return{tools:i,toolChoice:{type:"auto",disable_parallel_tool_use:r},toolWarnings:o,betas:a};case"required":return{tools:i,toolChoice:{type:"any",disable_parallel_tool_use:r},toolWarnings:o,betas:a};case"none":return{tools:void 0,toolChoice:void 0,toolWarnings:o,betas:a};case"tool":return{tools:i,toolChoice:{type:"tool",name:n.toolName,disable_parallel_tool_use:r},toolWarnings:o,betas:a};default:throw new dd({functionality:"tool choice type: ".concat(s)})}}(null!=v?{tools:[v],toolChoice:{type:"tool",toolName:v.name},disableParallelToolUse:!0}:{tools:null!=d?d:[],toolChoice:p,disableParallelToolUse:null==y?void 0:y.disableParallelToolUse});return{args:so(so({},C),{},{tools:D,tool_choice:S}),warnings:[..._,...E],betas:new Set([...b,...T]),usesJsonResponseTool:null!=v}}async getHeaders(e){let{betas:t,headers:n}=e;return Wh(await Sf(this.config.headers),t.size>0?{"anthropic-beta":Array.from(t).join(",")}:{},n)}buildRequestUrl(e){var t,n,r;return null!=(r=null==(n=(t=this.config).buildRequestUrl)?void 0:n.call(t,this.config.baseURL,e))?r:"".concat(this.config.baseURL,"/messages")}transformRequestBody(e){var t,n,r;return null!=(r=null==(n=(t=this.config).transformRequestBody)?void 0:n.call(t,e))?r:e}extractCitationDocuments(e){return e.filter((e=>"user"===e.role)).flatMap((e=>e.content)).filter((e=>{var t,n;if("file"!==e.type)return!1;if("application/pdf"!==e.mediaType&&"text/plain"!==e.mediaType)return!1;const r=null==(t=e.providerOptions)?void 0:t.anthropic,o=null==r?void 0:r.citations;return null!=(n=null==o?void 0:o.enabled)&&n})).map((e=>{var t;const n=e;return{title:null!=(t=n.filename)?t:"Untitled Document",filename:n.filename,mediaType:n.mediaType}}))}async doGenerate(e){var t,n,r,o,a,i;const{args:s,warnings:l,betas:c,usesJsonResponseTool:u}=await this.getArgs(e),d=this.extractCitationDocuments(e.prompt),{responseHeaders:p,value:h,rawValue:f}=await xf({url:this.buildRequestUrl(!1),headers:await this.getHeaders({betas:c,headers:e.headers}),body:this.transformRequestBody(s),failedResponseHandler:Gj,successfulResponseHandler:Af(Hj),abortSignal:e.abortSignal,fetch:this.config.fetch}),m=[];for(const g of h.content)switch(g.type){case"text":if(!u&&(m.push({type:"text",text:g.text}),g.citations))for(const e of g.citations){const t=hL(e,d,this.generateId);t&&m.push(t)}break;case"thinking":m.push({type:"reasoning",text:g.thinking,providerMetadata:{anthropic:{signature:g.signature}}});break;case"redacted_thinking":m.push({type:"reasoning",text:"",providerMetadata:{anthropic:{redactedData:g.data}}});break;case"tool_use":m.push(u?{type:"text",text:JSON.stringify(g.input)}:{type:"tool-call",toolCallId:g.id,toolName:g.name,input:JSON.stringify(g.input)});break;case"server_tool_use":"text_editor_code_execution"===g.name||"bash_code_execution"===g.name?m.push({type:"tool-call",toolCallId:g.id,toolName:"code_execution",input:JSON.stringify(so({type:g.name},g.input)),providerExecuted:!0}):"web_search"!==g.name&&"code_execution"!==g.name&&"web_fetch"!==g.name||m.push({type:"tool-call",toolCallId:g.id,toolName:g.name,input:JSON.stringify(g.input),providerExecuted:!0});break;case"web_fetch_tool_result":"web_fetch_result"===g.content.type?m.push({type:"tool-result",toolCallId:g.tool_use_id,toolName:"web_fetch",result:{type:"web_fetch_result",url:g.content.url,retrievedAt:g.content.retrieved_at,content:{type:g.content.content.type,title:g.content.content.title,citations:g.content.content.citations,source:{type:g.content.content.source.type,mediaType:g.content.content.source.media_type,data:g.content.content.source.data}}},providerExecuted:!0}):"web_fetch_tool_result_error"===g.content.type&&m.push({type:"tool-result",toolCallId:g.tool_use_id,toolName:"web_fetch",isError:!0,result:{type:"web_fetch_tool_result_error",errorCode:g.content.error_code},providerExecuted:!0});break;case"web_search_tool_result":if(Array.isArray(g.content)){m.push({type:"tool-result",toolCallId:g.tool_use_id,toolName:"web_search",result:g.content.map((e=>{var t;return{url:e.url,title:e.title,pageAge:null!=(t=e.page_age)?t:null,encryptedContent:e.encrypted_content,type:e.type}})),providerExecuted:!0});for(const e of g.content)m.push({type:"source",sourceType:"url",id:this.generateId(),url:e.url,title:e.title,providerMetadata:{anthropic:{pageAge:null!=(t=e.page_age)?t:null}}})}else m.push({type:"tool-result",toolCallId:g.tool_use_id,toolName:"web_search",isError:!0,result:{type:"web_search_tool_result_error",errorCode:g.content.error_code},providerExecuted:!0});break;case"code_execution_tool_result":"code_execution_result"===g.content.type?m.push({type:"tool-result",toolCallId:g.tool_use_id,toolName:"code_execution",result:{type:g.content.type,stdout:g.content.stdout,stderr:g.content.stderr,return_code:g.content.return_code},providerExecuted:!0}):"code_execution_tool_result_error"===g.content.type&&m.push({type:"tool-result",toolCallId:g.tool_use_id,toolName:"code_execution",isError:!0,result:{type:"code_execution_tool_result_error",errorCode:g.content.error_code},providerExecuted:!0});break;case"bash_code_execution_tool_result":case"text_editor_code_execution_tool_result":m.push({type:"tool-result",toolCallId:g.tool_use_id,toolName:"code_execution",result:g.content,providerExecuted:!0})}return{content:m,finishReason:pL({finishReason:h.stop_reason,isJsonResponseFromTool:u}),usage:{inputTokens:h.usage.input_tokens,outputTokens:h.usage.output_tokens,totalTokens:h.usage.input_tokens+h.usage.output_tokens,cachedInputTokens:null!=(n=h.usage.cache_read_input_tokens)?n:void 0},request:{body:s},response:{id:null!=(r=h.id)?r:void 0,modelId:null!=(o=h.model)?o:void 0,headers:p,body:f},warnings:l,providerMetadata:{anthropic:{usage:h.usage,cacheCreationInputTokens:null!=(a=h.usage.cache_creation_input_tokens)?a:null,stopSequence:null!=(i=h.stop_sequence)?i:null}}}}async doStream(e){const{args:t,warnings:n,betas:r,usesJsonResponseTool:o}=await this.getArgs(e),a=this.extractCitationDocuments(e.prompt),i=so(so({},t),{},{stream:!0}),{responseHeaders:s,value:l}=await xf({url:this.buildRequestUrl(!0),headers:await this.getHeaders({betas:r,headers:e.headers}),body:this.transformRequestBody(i),failedResponseHandler:Gj,successfulResponseHandler:Tf(Kj),abortSignal:e.abortSignal,fetch:this.config.fetch});let c="unknown";const u={inputTokens:void 0,outputTokens:void 0,totalTokens:void 0},d={};let p,h,f=null,m=null;const g=this.generateId;return{stream:l.pipeThrough(new TransformStream({start(e){e.enqueue({type:"stream-start",warnings:n})},transform(t,n){var r,i,s,l,_,v,y,w;if(e.includeRawChunks&&n.enqueue({type:"raw",rawValue:t.rawValue}),!t.success)return void n.enqueue({type:"error",error:t.error});const b=t.value;switch(b.type){case"ping":return;case"content_block_start":{const e=b.content_block.type;switch(h=e,e){case"text":return d[b.index]={type:"text"},void n.enqueue({type:"text-start",id:String(b.index)});case"thinking":return d[b.index]={type:"reasoning"},void n.enqueue({type:"reasoning-start",id:String(b.index)});case"redacted_thinking":return d[b.index]={type:"reasoning"},void n.enqueue({type:"reasoning-start",id:String(b.index),providerMetadata:{anthropic:{redactedData:b.content_block.data}}});case"tool_use":return d[b.index]=o?{type:"text"}:{type:"tool-call",toolCallId:b.content_block.id,toolName:b.content_block.name,input:"",firstDelta:!0},void n.enqueue(o?{type:"text-start",id:String(b.index)}:{type:"tool-input-start",id:b.content_block.id,toolName:b.content_block.name});case"server_tool_use":if(["web_fetch","web_search","code_execution","text_editor_code_execution","bash_code_execution"].includes(b.content_block.name)){d[b.index]={type:"tool-call",toolCallId:b.content_block.id,toolName:b.content_block.name,input:"",providerExecuted:!0,firstDelta:!0};const e="text_editor_code_execution"===b.content_block.name||"bash_code_execution"===b.content_block.name?"code_execution":b.content_block.name;n.enqueue({type:"tool-input-start",id:b.content_block.id,toolName:e,providerExecuted:!0})}return;case"web_fetch_tool_result":{const e=b.content_block;return void("web_fetch_result"===e.content.type?n.enqueue({type:"tool-result",toolCallId:e.tool_use_id,toolName:"web_fetch",result:{type:"web_fetch_result",url:e.content.url,retrievedAt:e.content.retrieved_at,content:{type:e.content.content.type,title:e.content.content.title,citations:e.content.content.citations,source:{type:e.content.content.source.type,mediaType:e.content.content.source.media_type,data:e.content.content.source.data}}}}):"web_fetch_tool_result_error"===e.content.type&&n.enqueue({type:"tool-result",toolCallId:e.tool_use_id,toolName:"web_fetch",isError:!0,result:{type:"web_fetch_tool_result_error",errorCode:e.content.error_code},providerExecuted:!0}))}case"web_search_tool_result":{const e=b.content_block;if(Array.isArray(e.content)){n.enqueue({type:"tool-result",toolCallId:e.tool_use_id,toolName:"web_search",result:e.content.map((e=>{var t;return{url:e.url,title:e.title,pageAge:null!=(t=e.page_age)?t:null,encryptedContent:e.encrypted_content,type:e.type}})),providerExecuted:!0});for(const t of e.content)n.enqueue({type:"source",sourceType:"url",id:g(),url:t.url,title:t.title,providerMetadata:{anthropic:{pageAge:null!=(r=t.page_age)?r:null}}})}else n.enqueue({type:"tool-result",toolCallId:e.tool_use_id,toolName:"web_search",isError:!0,result:{type:"web_search_tool_result_error",errorCode:e.content.error_code},providerExecuted:!0});return}case"code_execution_tool_result":{const e=b.content_block;return void("code_execution_result"===e.content.type?n.enqueue({type:"tool-result",toolCallId:e.tool_use_id,toolName:"code_execution",result:{type:e.content.type,stdout:e.content.stdout,stderr:e.content.stderr,return_code:e.content.return_code},providerExecuted:!0}):"code_execution_tool_result_error"===e.content.type&&n.enqueue({type:"tool-result",toolCallId:e.tool_use_id,toolName:"code_execution",isError:!0,result:{type:"code_execution_tool_result_error",errorCode:e.content.error_code},providerExecuted:!0}))}case"bash_code_execution_tool_result":case"text_editor_code_execution_tool_result":{const e=b.content_block;return void n.enqueue({type:"tool-result",toolCallId:e.tool_use_id,toolName:"code_execution",result:e.content,providerExecuted:!0})}default:throw new Error("Unsupported content block type: ".concat(e))}}case"content_block_stop":if(null!=d[b.index]){const e=d[b.index];switch(e.type){case"text":n.enqueue({type:"text-end",id:String(b.index)});break;case"reasoning":n.enqueue({type:"reasoning-end",id:String(b.index)});break;case"tool-call":if(!o){n.enqueue({type:"tool-input-end",id:e.toolCallId});const t="text_editor_code_execution"===e.toolName||"bash_code_execution"===e.toolName?"code_execution":e.toolName;n.enqueue({type:"tool-call",toolCallId:e.toolCallId,toolName:t,input:e.input,providerExecuted:e.providerExecuted})}}delete d[b.index]}return void(h=void 0);case"content_block_delta":{const e=b.delta.type;switch(e){case"text_delta":if(o)return;return void n.enqueue({type:"text-delta",id:String(b.index),delta:b.delta.text});case"thinking_delta":return void n.enqueue({type:"reasoning-delta",id:String(b.index),delta:b.delta.thinking});case"signature_delta":return void("thinking"===h&&n.enqueue({type:"reasoning-delta",id:String(b.index),delta:"",providerMetadata:{anthropic:{signature:b.delta.signature}}}));case"input_json_delta":{const e=d[b.index];let t=b.delta.partial_json;if(0===t.length)return;if(o){if("text"!==(null==e?void 0:e.type))return;n.enqueue({type:"text-delta",id:String(b.index),delta:t})}else{if("tool-call"!==(null==e?void 0:e.type))return;!e.firstDelta||"bash_code_execution"!==e.toolName&&"text_editor_code_execution"!==e.toolName||(t='{"type": "'.concat(e.toolName,'",').concat(t.substring(1))),n.enqueue({type:"tool-input-delta",id:e.toolCallId,delta:t}),e.input+=t,e.firstDelta=!1}return}case"citations_delta":{const e=hL(b.delta.citation,a,g);return void(e&&n.enqueue(e))}default:throw new Error("Unsupported delta type: ".concat(e))}}case"message_start":return u.inputTokens=b.message.usage.input_tokens,u.cachedInputTokens=null!=(i=b.message.usage.cache_read_input_tokens)?i:void 0,p=so({},b.message.usage),f=null!=(s=b.message.usage.cache_creation_input_tokens)?s:null,void n.enqueue({type:"response-metadata",id:null!=(l=b.message.id)?l:void 0,modelId:null!=(_=b.message.model)?_:void 0});case"message_delta":return u.outputTokens=b.usage.output_tokens,u.totalTokens=(null!=(v=u.inputTokens)?v:0)+(null!=(y=b.usage.output_tokens)?y:0),c=pL({finishReason:b.delta.stop_reason,isJsonResponseFromTool:o}),m=null!=(w=b.delta.stop_sequence)?w:null,void(p=so(so({},p),b.usage));case"message_stop":return void n.enqueue({type:"finish",finishReason:c,usage:u,providerMetadata:{anthropic:{usage:null!=p?p:null,cacheCreationInputTokens:f,stopSequence:m}}});case"error":return void n.enqueue({type:"error",error:b.error});default:throw new Error("Unsupported chunk type: ".concat(b))}}})),request:{body:i},response:{headers:s}}}},mL={bash_20241022:Cf({id:"anthropic.bash_20241022",name:"bash",inputSchema:fm((()=>pm(Ov({command:X_(),restart:kv().optional()}))))}),bash_20250124:Cf({id:"anthropic.bash_20250124",name:"bash",inputSchema:fm((()=>pm(Ov({command:X_(),restart:kv().optional()}))))}),codeExecution_20250522:function(){return sL(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})},codeExecution_20250825:function(){return cL(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})},computer_20241022:Cf({id:"anthropic.computer_20241022",name:"computer",inputSchema:fm((()=>pm(Ov({action:Zv(["key","type","mouse_move","left_click","left_click_drag","right_click","middle_click","double_click","screenshot","cursor_position"]),coordinate:Pv(yv().int()).optional(),text:X_().optional()}))))}),computer_20250124:Cf({id:"anthropic.computer_20250124",name:"computer",inputSchema:fm((()=>pm(Ov({action:Zv(["key","hold_key","type","cursor_position","mouse_move","left_mouse_down","left_mouse_up","left_click","left_click_drag","right_click","middle_click","double_click","triple_click","scroll","wait","screenshot"]),coordinate:Wv([yv().int(),yv().int()]).optional(),duration:yv().optional(),scroll_amount:yv().optional(),scroll_direction:Zv(["up","down","left","right"]).optional(),start_coordinate:Wv([yv().int(),yv().int()]).optional(),text:X_().optional()}))))}),memory_20250818:Cf({id:"anthropic.memory_20250818",name:"memory",inputSchema:fm((()=>pm(Vv("command",[Ov({command:Xv("view"),path:X_(),view_range:Wv([yv(),yv()]).optional()}),Ov({command:Xv("create"),path:X_(),file_text:X_()}),Ov({command:Xv("str_replace"),path:X_(),old_str:X_(),new_str:X_()}),Ov({command:Xv("insert"),path:X_(),insert_line:yv(),insert_text:X_()}),Ov({command:Xv("delete"),path:X_()}),Ov({command:Xv("rename"),old_path:X_(),new_path:X_()})]))))}),textEditor_20241022:Cf({id:"anthropic.text_editor_20241022",name:"str_replace_editor",inputSchema:fm((()=>pm(Ov({command:Zv(["view","create","str_replace","insert","undo_edit"]),path:X_(),file_text:X_().optional(),insert_line:yv().int().optional(),new_str:X_().optional(),old_str:X_().optional(),view_range:Pv(yv().int()).optional()}))))}),textEditor_20250124:Cf({id:"anthropic.text_editor_20250124",name:"str_replace_editor",inputSchema:fm((()=>pm(Ov({command:Zv(["view","create","str_replace","insert","undo_edit"]),path:X_(),file_text:X_().optional(),insert_line:yv().int().optional(),new_str:X_().optional(),old_str:X_().optional(),view_range:Pv(yv().int()).optional()}))))}),textEditor_20250429:Cf({id:"anthropic.text_editor_20250429",name:"str_replace_based_edit_tool",inputSchema:fm((()=>pm(Ov({command:Zv(["view","create","str_replace","insert"]),path:X_(),file_text:X_().optional(),insert_line:yv().int().optional(),new_str:X_().optional(),old_str:X_().optional(),view_range:Pv(yv().int()).optional()}))))}),textEditor_20250728:function(){return Yj(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})},webFetch_20250910:function(){return aL(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})},webSearch_20250305:function(){return nL(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}};function gL(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};var t;const n=null!=(t=xm(e.baseURL))?t:"https://api.anthropic.com/v1",r=()=>ef(so({"anthropic-version":"2023-06-01","x-api-key":af({apiKey:e.apiKey,environmentVariableName:"ANTHROPIC_API_KEY",description:"Anthropic"})},e.headers),"ai-sdk/anthropic/".concat("2.0.29")),o=t=>{var o;return new fL(t,{provider:"anthropic.messages",baseURL:n,headers:r,fetch:e.fetch,generateId:null!=(o=e.generateId)?o:Zh,supportedUrls:()=>({"image/*":[/^https?:\/\/.*$/]})})},a=function(e){if(new.target)throw new Error("The Anthropic model function cannot be called with the new keyword.");return o(e)};return a.languageModel=o,a.chat=o,a.messages=o,a.textEmbeddingModel=e=>{throw new Xu({modelId:e,modelType:"textEmbeddingModel"})},a.imageModel=e=>{throw new Xu({modelId:e,modelType:"imageModel"})},a.tools=mL,a}gL();const _L=[{id:"openai",name:"OpenAI",createProvider:e=>Sj({apiKey:e}),defaultModel:"gpt-4o",models:[{id:"gpt-4o",name:"GPT-4o",family:"GPT-4"},{id:"gpt-4o-mini",name:"GPT-4o Mini",family:"GPT-4"},{id:"gpt-4-turbo",name:"GPT-4 Turbo",family:"GPT-4"},{id:"gpt-3.5-turbo",name:"GPT-3.5 Turbo",family:"GPT-3.5"}]},{id:"grok",name:"xAI",createProvider:e=>Uj({apiKey:e}),defaultModel:"grok-beta",models:[{id:"grok-4-fast-reasoning",name:"Grok 4 Fast Reasoning",family:"Grok"},{id:"grok-4-fast-non-reasoning",name:"Grok 4 Fast Non-Reasoning",family:"Grok"},{id:"grok-3",name:"Grok 3",family:"Grok"},{id:"grok-3-mini",name:"Grok 3 Mini",family:"Grok"}]},{id:"anthropic",name:"Anthropic",createProvider:e=>gL({apiKey:e}),defaultModel:"claude-sonnet-4-0",models:[{id:"claude-opus-4-1",name:"Claude Opus 4.1",family:"Claude"},{id:"claude-opus-4-0",name:"Claude Opus 4.0",family:"Claude"},{id:"claude-sonnet-4-0",name:"Claude Sonnet 4.0",family:"Claude"},{id:"claude-3-7-sonnet-latest",name:"Claude 3.7 Sonnet",family:"Claude"},{id:"claude-3-5-haiku-latest",name:"Claude 3.5 Haiku",family:"Claude"}]}];function vL(e){return _L.find((t=>t.id===e))}function yL(e){const t=_L.find((t=>t.id===e));return t?t.models:[]}function wL(){var e;return(null===(e=_L[0])||void 0===e?void 0:e.id)||"openai"}function bL(e){const t=_L.find((t=>t.id===e));return(null===t||void 0===t?void 0:t.defaultModel)||"gpt-4o"}class xL extends bB{constructor(e,t){const n=vL("openai");if(!n)throw new Error("OpenAI provider config not found");super(n,e,t)}async generateSimilarPrompts(e,t,n){try{const o=this.getProvider()(this.modelId),a="Here is a test input to a model: ".concat(e," Generate 10 similar inputs, in the format of a js list. By similar, I mean: ").concat(t),{text:i}=await Ok({model:o,messages:[{role:"system",content:'You are a helpful assistant. Generate exactly 10 similar prompts in JavaScript array format like ["prompt1", "prompt2", ...].'},{role:"user",content:a}],temperature:n});try{const e=i.match(/\[[\s\S]*\]/);if(e){const t=e[0];return JSON.parse(t)}return JSON.parse(i)}catch(r){return console.error("Error parsing similar prompts:",r),i.split("\n").map((e=>e.trim())).filter((e=>e.length>0&&!e.startsWith("[")&&!e.startsWith("]"))).slice(0,10)}}catch(r){const e=r instanceof Error?r.message:String(r);return console.error("Error generating similar prompts:",r),alert("Error generating similar prompts: ".concat(e,"\n\nPlease check your API key and try again.")),[]}}}const kL=Gc.map((e=>{var t;return(null===(t=Pi(e))||void 0===t?void 0:t.copy({opacity:.3}).formatHex8())||"black"}));const CL=new class{constructor(){var e,t,n,r=this;this.loading=!1,this.prompts=[],this.numGenerations=30,this.similarityThreshold=.7,this.minOpacityThreshold=0,this.spread=.5,this.shuffle=!1,this.tokenizeMode="space",this.generationsCache={},this.disabledPrompts=[],this.failedFetches=new Set,this.selectedModelFamily=wL(),this.selectedModel=bL(wL()),this.llmInstanceCache={},this.getPromptColor=e=>kL[e%kL.length],this.addPrompt=function(){var e,t,n;let o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";const a=r.prompts[r.prompts.length-1],i=o||(null===a||void 0===a?void 0:a.text)||"",s=null!==(e=null===a||void 0===a?void 0:a.temp)&&void 0!==e?e:.7,l=null!==(t=null===a||void 0===a?void 0:a.modelFamily)&&void 0!==t?t:r.selectedModelFamily,c=null!==(n=null===a||void 0===a?void 0:a.model)&&void 0!==n?n:r.selectedModel;r.prompts=[...r.prompts,{text:i,temp:s,modelFamily:l,model:c}]},this.updatePromptTextAt=(e,t)=>{const n=[...this.prompts];n[e]=so(so({},n[e]),{},{text:t}),this.prompts=n},this.updatePromptTempAt=(e,t)=>{const n=[...this.prompts];n[e]=so(so({},n[e]),{},{temp:t}),this.prompts=n},this.updatePromptModelFamilyAt=(e,t)=>{const n=[...this.prompts];this.clearFailedFetchForPrompt(n[e]),n[e]=so(so({},n[e]),{},{modelFamily:t}),n[e]=so(so({},n[e]),{},{model:bL(t)}),this.prompts=n},this.updatePromptModelAt=(e,t)=>{const n=[...this.prompts];this.clearFailedFetchForPrompt(n[e]),n[e]=so(so({},n[e]),{},{model:t}),this.prompts=n},this.removePromptAt=Ut((e=>{if(0===e&&this.prompts.length<=1)return;const t=[...this.prompts];t.splice(e,1),this.prompts=t,this.disabledPrompts=this.disabledPrompts.filter((t=>t!==e)).map((t=>t>e?t-1:t))})),this.togglePromptDisabled=Ut((e=>{0===e&&this.prompts.length<=1||(this.disabledPrompts.includes(e)?this.disabledPrompts=this.disabledPrompts.filter((t=>t!==e)):this.disabledPrompts=[...this.disabledPrompts,e])})),this.isPromptDisabled=e=>this.disabledPrompts.includes(e),this.setNumGenerations=e=>{this.numGenerations=e},this.setSimilarityThreshold=e=>{this.similarityThreshold=e},this.setShuffle=e=>{this.shuffle=e},this.setTokenizeMode=e=>{this.tokenizeMode=e},this.setMinOpacityThreshold=e=>{this.minOpacityThreshold=e},this.setSpread=e=>{this.spread=e},this.setModelFamily=e=>{this.selectedModelFamily=e,this.selectedModel=bL(e)},this.setModel=e=>{this.selectedModel=e},this.clearFailedFetchForPrompt=e=>{const t="".concat(e.text,"|").concat(e.temp,"|").concat(e.modelFamily,"|").concat(e.model);this.failedFetches.delete(t);const n="".concat(e.modelFamily,":").concat(e.model);delete this.llmInstanceCache[n]},this.clearAllFailedFetches=()=>{this.failedFetches.clear(),this.llmInstanceCache={}},D(e=this)?tn(e,e,t,n):mr((function(){var r=$n(e,n)[J];if(!e[kn]){var o=Object.getPrototypeOf(e),a=new Set([].concat(P(e),P(o)));a.delete("constructor"),a.delete(J),E(o,kn,a)}e[kn].forEach((function(e){return r.make_(e,!t||!(e in t)||t[e])}))}));const o=wL(),a=bL(o);for(const[h,f]of Object.entries(lo)){var i,s,l,c,u,d;null!==(s=(i=this.generationsCache)[h])&&void 0!==s||(i[h]={}),null!==(c=(l=this.generationsCache[h])[.7])&&void 0!==c||(l[.7]={}),null!==(d=(u=this.generationsCache[h][.7])[o])&&void 0!==d||(u[o]={}),this.generationsCache[h][.7][o][a]=f}const p=Object.keys(lo)[0];this.prompts=[{text:p,temp:.7,modelFamily:o,model:a}]}getLLMInstance(e,t){const n="".concat(e,":").concat(t);return this.llmInstanceCache[n]||(this.llmInstanceCache[n]=function(e,t,n){if("openai"===e)return new xL(t,n);const r=vL(e);if(!r)throw new Error("Unknown provider: ".concat(e));return new bB(r,t,n)}(e,t)),this.llmInstanceCache[n]}async fetchFromLLM(e,t,n,r,o){try{const a=this.getLLMInstance(r,o);return await a.generateCompletions(e,t,n)}catch(a){return console.error("Error fetching from LLM:",a),[]}}async fetchGenerationsFor(e){var t,n,r,o,a,i,s,l;const c=this.prompts[e];if(!c)return[];const u=c.text,d=c.temp,p=c.modelFamily,h=c.model,f=this.numGenerations;if(!u)return[];null!==(n=(t=this.generationsCache)[u])&&void 0!==n||(t[u]={}),null!==(o=(r=this.generationsCache[u])[d])&&void 0!==o||(r[d]={}),null!==(i=(a=this.generationsCache[u][d])[p])&&void 0!==i||(a[p]={}),null!==(l=(s=this.generationsCache[u][d][p])[h])&&void 0!==l||(s[h]=[]);let m=this.generationsCache[u][d][p][h];const g=m.length;if(g>=f)return m.slice(0,f);const _="".concat(u,"|").concat(d,"|").concat(p,"|").concat(h);if(this.failedFetches.has(_))return m;const v=f-g;this.loading=!0;const y=await this.fetchFromLLM(u,d,v,p,h);return 0===y.length&&this.failedFetches.add(_),this.generationsCache[u][d][p][h].push(...y),this.loading=!1,this.generationsCache[u][d][p][h].slice(0,f)}async generateSimilarPrompts(e,t,n){try{const r=this.getLLMInstance("openai","gpt-4o");return await r.generateSimilarPrompts(e,t,n)}catch(r){return console.error("Error generating similar prompts:",r),[]}}};class DL{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.children={},this.numTotalChildren=void 0,this.isLeaf=void 0,this.parent=void 0,this.weight=0,this.children={},this.isLeaf=!1,this.numTotalChildren=0,this.parent=e}}class SL{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"space";this.root=void 0,this.tokenizeMode=void 0,this.root=new DL,this.tokenizeMode=e}async insert(e){const t=await mB(e,void 0,this.tokenizeMode);let n=this.root;for(let r of t)r=fB(r),n.children[r]||(n.children[r]=new DL(n)),n.isLeaf=!1,n=n.children[r],n.weight+=1;Object.keys(n.children).length||(n.isLeaf=!0)}async insertSents(e){for(const t of e)await this.insert(t);this.computeNumLeafChildren()}computeNumLeafChildren(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.root;if(e.isLeaf)return e.numTotalChildren=1,1;let t=0;for(const n of Object.values(e.children))t+=this.computeNumLeafChildren(n);return e.numTotalChildren=t,t}}var EL=n(579);class TL extends a.Component{constructor(){super(...arguments),this.trie=new SL,this.state={hoveredToken:"",trieReady:!1}}async componentDidMount(){await this.initializeTrie()}async componentDidUpdate(e){e.generations!==this.props.generations&&await this.initializeTrie()}async initializeTrie(){const e=this.props.generations;e&&(this.trie=new SL(CL.tokenizeMode),await this.trie.insertSents(e),this.setState({trieReady:!0}))}render(){const e=this.props.generations;if(!e||!this.state.trieReady)return null;const t=35*e.length,n=t/this.trie.root.numTotalChildren,r=(e,t,o,a,i)=>{const s=Object.entries(e.children),l=e.numTotalChildren*n,c=s.length;let u=0;const d=s.reverse().map((t=>{const[n,r]=t,o=r.numTotalChildren/e.numTotalChildren/2||0;return u+=o,u})),p=l/2,h=Fl().range([p,-p]).domain([0,1]);return s.map(((n,s)=>{const[l,u]=n,p=u.weight/10,f=Math.ceil(Math.max(12,30*p)),m=.6*f,g=h(d[s]),_=l.length*m,v=_+m*(1===Object.keys(u.children).length?1:5),y=o+g,w=t,b=w+_,x=y-f/2,k=1===c||e===this.trie.root?"":(0,EL.jsx)("path",{d:"M ".concat(a," ").concat(i," \n                            C ").concat((a+w)/2," ").concat(i,", \n                              ").concat((a+w)/2," ").concat(x,", \n                              ").concat(w-5," ").concat(x),stroke:"black",fill:"transparent"}),C=this.state.hoveredToken===l?"rgb(163, 198, 250)":"rgba(0, 0, 0, 0)";return(0,EL.jsxs)("g",{children:[k,(0,EL.jsx)("rect",{x:w,y:y-f,width:_,height:f,fill:C}),(0,EL.jsxs)("text",{x:w,y:y,onMouseEnter:()=>this.setState((e=>so(so({},e),{},{hoveredToken:l}))),fontSize:f,children:[l,(0,EL.jsxs)("title",{children:[s," ",c," ",l]})]},l+t+o),r(u,w+v,y,b+5,x)]})}))};return(0,EL.jsx)("svg",{className:"wordtree-holder",style:{height:.6*t},children:r(this.trie.root,0,t/8+5,0,0)})}}const AL=no(TL);class ML extends a.Component{constructor(){super(...arguments),this.state={hoveredToken:""}}render(){let e=this.props.generations;if(!e)return;let t=[...e];const[n,r]=this.getAllSubstrings(t),o=jl(Wl).domain(n),a=[...t].sort();return(0,EL.jsx)("div",{className:"outputs",children:a.map(((e,t)=>{const a=r.map((t=>{const r=n.find((e=>e.includes(t)))||"",a=Pi(o(r));a.opacity=.2;const i=e.replace(t,"<span style='background-color:".concat(a,"'>").concat(t,"</span>"));return(0,EL.jsx)("div",{className:"highlight",dangerouslySetInnerHTML:{__html:i}})}));return(0,EL.jsxs)("div",{className:"line-holder",children:[a,(0,EL.jsx)("div",{children:e})]},"".concat(e,"-").concat(t))}))})}getAllSubstrings(e){const t={};for(let o of e){let e,n;const r=o.split(" ");for(e=0;e<r.length;e++)for(n=e+1;n<r.length+1;n++){const o=r.slice(e,n).join(" ");o in t||(t[o]=0),t[o]+=1}}const n=Object.entries(t).filter((e=>{let[t,n]=e;return n>=2&&t.length>=2})).sort(((e,t)=>t[1]-e[1])).sort(((e,t)=>t[0].length-e[0].length)).map((e=>{let[t,n]=e;return t})),r=[];return n.forEach((e=>{r.join("").includes(e)||r.push(e)})),[r,n]}}const FL=no(ML);function IL(e){return function(){return e}}class PL extends a.Component{constructor(e){super(e),this.popupRef=a.createRef(),this.handleToggleMaximize=()=>{this.setState((e=>({isMaximized:!e.isMaximized})))},this.state={examples:[],matchingCount:0,totalGenerations:this.calculateTotalGenerations(e.promptGroups),isMaximized:!1}}componentDidUpdate(e){const t=!this.areNodeArraysEqual(e.nodes,this.props.nodes),n=e.isVisible!==this.props.isVisible,r=e.promptGroups!==this.props.promptGroups;if((this.props.isVisible&&(t||n||r)||!e.isVisible&&this.props.isVisible)&&this.updatePopupContent(),r&&!this.props.isVisible){const e=this.calculateTotalGenerations(this.props.promptGroups);e!==this.state.totalGenerations&&this.setState({totalGenerations:e})}if(!this.props.isVisible&&n){const e=this.calculateTotalGenerations(this.props.promptGroups);(this.state.examples.length||this.state.matchingCount)&&this.setState({examples:[],matchingCount:0,totalGenerations:e})}}updatePopupContent(){const{nodes:e,promptGroups:t}=this.props,n=this.calculateTotalGenerations(t);if(!e.length)return void((this.state.examples.length||this.state.matchingCount||this.state.totalGenerations!==n)&&this.setState({examples:[],matchingCount:0,totalGenerations:n}));const r=this.getCommonSentIndices(e);if(!r.length)return void((this.state.examples.length||this.state.matchingCount||this.state.totalGenerations!==n)&&this.setState({examples:[],matchingCount:0,totalGenerations:n}));const o=this.buildSentenceHighlights(e,r),a=this.buildExamples(t,r,o),i=a.length;this.areExamplesEqual(a,this.state.examples)&&i===this.state.matchingCount&&n===this.state.totalGenerations||this.setState({examples:a,matchingCount:i,totalGenerations:n})}buildExamples(e,t,n){const r=new Set(t),o=[];let a=0;return e.forEach((e=>{e.generations.forEach((t=>{if(a++,!r.has(a))return;const i=this.getPromptColor(e.promptId),s=n.get(a)||[],l=this.createHighlightedHtml(t,s);o.push({html:l,sentIdx:a,promptId:e.promptId,textColor:i})}))})),o}buildSentenceHighlights(e,t){const n=new Map,r=new Set(t),o=e.map(((e,t)=>{const n=this.getNodeKey(e,t),o=this.getNodeDisplayColor(e,t),a=new Map;return(e.origSentenceInfo||[]).forEach((e=>{if(!r.has(e.sentIdx))return;const t=e.origWords.join(" ").trim();t&&(a.has(e.sentIdx)||a.set(e.sentIdx,[]),a.get(e.sentIdx).push(t))})),{node:e,index:t,key:n,color:o,infoBySentence:a}}));return t.forEach((e=>{const t=[];o.forEach((n=>{let{node:r,key:o,color:a,infoBySentence:i}=n;const s=i.get(e)||[r.word],l=Array.from(new Set(s.map((e=>e.trim())).filter((e=>e.length))));t.push({key:o,color:a,nodeWord:r.word,phrases:l.length?l:[r.word]})})),n.set(e,t)})),n}createHighlightedHtml(e,t){const n=[];if(t.forEach((t=>{const r=[...t.phrases].sort(((e,t)=>t.length-e.length)),o=this.withAlpha(t.color,.2);r.forEach((t=>{const r=this.findMatches(e,t);for(const e of r)if(!this.overlapsExistingRange(e.start,e.end,n)){n.push({start:e.start,end:e.end,color:o});break}}))})),!n.length)return this.escapeHtml(e);n.sort(((e,t)=>e.start-t.start));let r="",o=0;return n.forEach((t=>{t.start>o&&(r+=this.escapeHtml(e.slice(o,t.start)));const n=this.escapeHtml(e.slice(t.start,t.end));r+='<b style="background-color: '.concat(t.color,';">').concat(n,"</b>"),o=t.end})),o<e.length&&(r+=this.escapeHtml(e.slice(o))),r}findMatches(e,t){const n=t.trim();if(!n.length)return[];const r=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),o=new RegExp(r,"gi"),a=[];let i;for(;null!==(i=o.exec(e));)a.push({start:i.index,end:i.index+i[0].length}),o.lastIndex===i.index&&o.lastIndex++;return a}overlapsExistingRange(e,t,n){return n.some((n=>!(t<=n.start||e>=n.end)))}escapeHtml(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/\r\n|\r|\n/g,"<br/>")}calculateTotalGenerations(e){return e.reduce(((e,t)=>e+t.generations.length),0)}getPromptColor(e){const t=e.match(/_(\d+)_/),n=t?parseInt(t[1],10):0;return Gc[n%Gc.length]}getNodeDisplayColor(e,t){if(e.origPromptIds&&e.origPromptIds.length){var n;const t=null===(n=e.origPromptIds[0])||void 0===n?void 0:n.match(/_(\d+)_/);if(t){const e=parseInt(t[1],10);return Gc[e%Gc.length]}}const r=(e.word.split("").reduce(((e,t)=>e+t.charCodeAt(0)),0)+7*t)%Gc.length;return Gc[r]}getCommonSentIndices(e){if(!e.length)return[];let t=Array.from(new Set(e[0].origSentIndices||[]));for(let n=1;n<e.length;n++){const r=new Set(e[n].origSentIndices||[]);if(t=t.filter((e=>r.has(e))),!t.length)break}return t}areNodeArraysEqual(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}areExamplesEqual(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n].html!==t[n].html||e[n].sentIdx!==t[n].sentIdx||e[n].promptId!==t[n].promptId||e[n].textColor!==t[n].textColor)return!1;return!0}getNodeKey(e,t){return"".concat(e.word,"-").concat(t)}withAlpha(e,t){const n=Pi(e);if(!n)return e;const r=n.rgb();return r.opacity=t,r.toString()}render(){const{isVisible:e,onClose:t,nodes:n,onRemoveNode:r}=this.props,{examples:o,matchingCount:a,totalGenerations:i,isMaximized:s}=this.state,l=i>0?Math.round(a/i*100):0,c=(0,EL.jsx)("div",{className:"selected-nodes",children:n.map(((e,t)=>{const n=this.getNodeDisplayColor(e,t),o=this.withAlpha(n,.15);return(0,EL.jsxs)("span",{className:"node-chip",style:{borderColor:n,color:n,backgroundColor:o},children:[(0,EL.jsx)("span",{className:"node-chip-label",children:fB(e.word)}),(0,EL.jsx)("button",{type:"button",className:"node-chip-remove",onClick:()=>r(e),"aria-label":"Remove ".concat(e.word),children:"\xd7"})]},"".concat(e.word,"-").concat(t))}))});return(0,EL.jsxs)("div",{ref:this.popupRef,className:"node-examples-popup".concat(s?" maximized":""),style:{display:e?"block":"none"},children:[(0,EL.jsxs)("div",{className:"popup-header",children:[(0,EL.jsx)("div",{className:"popup-title",children:(0,EL.jsxs)("div",{className:"popup-title-main",children:["Examples containing ",c,": ",a,"/",i," (",l,"%)"]})}),(0,EL.jsxs)("div",{className:"popup-actions",children:[(0,EL.jsx)("button",{type:"button",className:"popup-action-button popup-maximize",onClick:this.handleToggleMaximize,children:s?"\u2199":"\u2197"}),(0,EL.jsx)("button",{className:"popup-action-button popup-close",onClick:t,"aria-label":"Close examples panel",children:"\xd7"})]})]}),(0,EL.jsx)("div",{className:"popup-content",children:0===a?(0,EL.jsx)("div",{className:"no-examples-message",children:"No examples found containing all selected nodes."}):o.map((e=>(0,EL.jsx)("div",{className:"example-item",style:{color:e.textColor},dangerouslySetInnerHTML:{__html:e.html}},"".concat(e.promptId,"-").concat(e.sentIdx))))})]})}}const zL=PL;class OL extends a.Component{constructor(e){super(e),this.hoveredNode=null,this.selectedNodes=new Set,this.fontScale=null,this.opacityScale=null,this.simulation=null,this.nodesData=[],this.linksData=[],this.links=null,this.nodes=null,this.defs=null,this.getLinkEndpoints=null,this.height=0,this.width=0,this.handleKeyDown=e=>{"Escape"===e.key&&(this.selectedNodes.clear(),this.hoveredNode=null,this.hidePopup(),this.rebuildGraph())},this.handleResize=()=>{this.rebuildGraph()},this.togglePopupNode=e=>{this.setState((t=>{const n=t.popupNodes.some((t=>t===e))?t.popupNodes.filter((t=>t!==e)):[...t.popupNodes,e];return{popupNodes:n,isPopupVisible:n.length>0}}))},this.removePopupNode=e=>{this.setState((t=>{const n=t.popupNodes.filter((t=>t!==e));return{popupNodes:n,isPopupVisible:n.length>0}}))},this.state={popupNodes:[],isPopupVisible:!1}}componentDidMount(){window.addEventListener("resize",this.handleResize),window.addEventListener("keydown",this.handleKeyDown)}componentWillUnmount(){window.removeEventListener("resize",this.handleResize),window.removeEventListener("keydown",this.handleKeyDown)}nodeSelected(){return this.selectedNodes.size>0}createFontScale(){const e=this.props.promptGroups.reduce(((e,t)=>e+t.generations.length),0);this.fontScale=Fl().domain([1,e]).range([11,30]).clamp(!0),this.opacityScale=Ul().exponent(.5).domain([(this.props.minOpacityThreshold-.3)*e/2,e/2]).range([0,1]).clamp(!0).nice(),this.nodesData.forEach((e=>e.fontSize=this.fontSize(e))),this.nodesData.forEach((e=>e.textLength=this.textLength(e)))}render(){return(0,EL.jsxs)("div",{style:{position:"relative",width:"100%",height:"100%"},children:[(0,EL.jsx)("span",{id:"loader",className:"loader"}),(0,EL.jsx)("svg",{id:"graph-holder"}),(0,EL.jsx)(zL,{nodes:this.state.popupNodes,promptGroups:this.props.promptGroups,isVisible:this.state.isPopupVisible,onClose:()=>this.hidePopup(),onRemoveNode:this.removePopupNode})]})}async componentDidUpdate(e,t){if(e.promptGroups!==this.props.promptGroups||e.similarityThreshold!==this.props.similarityThreshold||e.minOpacityThreshold!==this.props.minOpacityThreshold||e.spread!==this.props.spread||function(e,t){return e.length===t.length&&e.every(((e,n)=>e===t[n]))}(t.popupNodes,this.state.popupNodes)&&t.isPopupVisible===this.state.isPopupVisible)return e.minOpacityThreshold!==this.props.minOpacityThreshold?(this.createFontScale(),void this.update()):void(e.spread===this.props.spread?this.rebuildGraph():this.updateSimulation())}toggleLoading(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];Gl("#graph-holder").classed("hidden",e),Gl("#loader").classed("hidden",!e)}async rebuildGraph(){this.toggleLoading(!0),setTimeout((async()=>{await this.rebuildGraphContent(),this.updateSimulation(!0),this.toggleLoading(!1)}),0)}async rebuildGraphContent(){const{nodesData:e,linksData:t}=await wB(this.props.promptGroups,this.props.similarityThreshold,CL.shuffle,CL.tokenizeMode);console.log("nodesData",e.length,"linksData",t.length),this.nodesData=e,this.linksData=t,this.createFontScale(),this.addBoundingBoxData(e),this.width=Math.min(window.innerWidth,5e3),this.height=Math.min(.8*window.innerHeight,800);const n=Gl("#graph-holder").html("").attr("width",this.width).attr("height",this.height).style("cursor","grab").on("click",(e=>{"svg"===e.target.tagName&&(this.selectedNodes.clear(),this.hoveredNode=null,this.hidePopup(),this.updateSimulation(),this.update())})),r=n.append("g"),o=Wc().scaleExtent([.5,3]).on("zoom",(e=>r.attr("transform",e.transform)));n.call(o).on("dblclick.zoom",null),this.defs=n.append("defs");const a=(e,t,n)=>{var r;const o=this.defs.append("linearGradient").attr("id",((e,t)=>"gradient-".concat(t))(0,t)).attr("gradientUnits","objectBoundingBox"),a=(e=>{const t=parseInt(e);return Gc[t%Gc.length]})(e.promptId&&(null===(r=e.promptId.match(/_(\d+)_/))||void 0===r?void 0:r[1])||"0");return o.append("stop").attr("offset","0%").attr("stop-color",a),o.append("stop").attr("offset","100%").attr("stop-color",a),o};t.forEach(((e,t)=>{a(e,t,this.linkIsInSents(e))})),this.getLinkEndpoints=e=>{var t;const n=t=>{const n=([...t.origSentIndices].indexOf(e.sentIdx)/t.origSentIndices.length-.75)*t.fontSize;return t.y+n},r=e=>{const t=e.x,n=t+e.textLength;return[t,n,(t+n)/2]},[o,a,i]=r(e.source),[s,l,c]=r(e.target),u=null!==(t=e.source)&&void 0!==t&&t.isRoot?o:i,d=e.target.isEnd?l:c,[p,h]=[n(e.source),n(e.target)];return{sourceX:u,targetX:d,y1:p,y2:h,sourceRightX:a,targetLeftX:s}},this.links=r.selectAll(".link").data(t).enter().append("path").attr("class","link").attr("fill","none"),this.nodes=r.selectAll(".node").data(e).enter().append("g").attr("class","node").on("mouseover",((e,t)=>{this.hoveredNode=t,this.update()})).on("mouseout",((e,t)=>{this.hoveredNode=null,this.update()})).on("click",((e,t)=>{this.nodeIsInSelectedSents(t)&&(this.selectedNodes.has(t)?(this.selectedNodes.delete(t),this.hoveredNode=null):(this.selectedNodes.add(t),this.hoveredNode=null),this.updateSimulation(),this.update(),this.togglePopupNode(t))})),this.nodes.append("text").call(this.wrapText).attr("font-size",(e=>e.fontSize))}update(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.links||!this.nodes||!this.defs||!this.getLinkEndpoints)return;const t=e=>{const t=e=>"blur(2px) opacity(".concat(e,")"),n=(e=>void 0!==e.word)(e)?e=>this.nodeIsInSelectedSents(e):e=>this.linkIsInSents(e);if(!this.nodeSelected()&&!this.hoveredNode)return"";const r=t(.2),o=t(.5);return this.hoveredNode?n(e)?"":o:this.nodeSelected()?n(e)?"":r:""};this.links.transition().duration(e?0:300).ease(Ps).attr("d",(e=>{const{sourceX:t,targetX:n,y1:r,y2:o,sourceRightX:a,targetLeftX:i}=this.getLinkEndpoints(e),s=[{x:t,y:r},{x:a,y:r},{x:i,y:o},{x:n,y:o}];return vc().x((e=>e.x)).y((e=>e.y)).curve(Sc)(s)})).attr("stroke",((e,t)=>"url(#gradient-".concat(t,")"))).attr("stroke-width",(e=>2)).style("filter",(e=>t(e)));const n=e=>""!==e.word&&this.opacityScale?this.opacityScale(e.count):0;this.links.each(((e,t)=>{const r=this.defs.select("#gradient-".concat(t)).selectAll("stop");r.filter(((e,t)=>0===t)).attr("stop-opacity",.2*n(e.source)),r.filter(((e,t)=>1===t)).attr("stop-opacity",.2*n(e.target))})),this.nodes.transition().duration(e?0:300).ease(Ps).attr("transform",(e=>"translate(".concat(e.x,", ").concat(e.y,")"))).attr("fill",(e=>Hc(e,this.linksData))).style("opacity",(e=>n(e))).style("font-weight",(e=>this.selectedNodes.has(e)||this.hoveredNode===e?"bold":"normal")).style("filter",(e=>t(e)))}updateSimulation(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.simulation&&(this.simulation.stop(),this.simulation.force("x",null),this.simulation.force("y",null),this.simulation.force("link",null),this.simulation.force("collide",null)),this.simulation=Rs(this.nodesData);const t=this.nodeSelected()?this.linksData.filter((e=>this.linkIsInSents(e))):this.linksData,n=this.nodeSelected()?this.nodesData.filter((e=>this.nodeIsInSelectedSents(e))):this.nodesData;this.simulation.nodes(n).force("collide",function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.5,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5;function o(o){const a=e.length,i=16*r,s=new Array(a);for(let n=0;n<a;++n){const r=e[n],o=+t(r,n,e),a=r.rx+o,i=r.ry+o;s[n]={w:a,h:i,w2:a*a,h2:i*i,wh:a*i,x:r.x+r.vx,y:r.y+r.vy,maxRadius:Math.max(a,i)}}for(let t=0;t<a;++t){const r=e[t],l=s[t];for(let c=t+1;c<a;++c){const t=e[c],a=s[c];let u=l.x-a.x,d=l.y-a.y;const p=u*u+d*d;if(p>(l.maxRadius+a.maxRadius+100)**2)continue;if(0===u&&0===d){const e=4*Math.random()-2,n=4*Math.random()-2;r.vx+=e,r.vy+=n,t.vx-=e,t.vy-=n;continue}let h,f,m,g,_,v;if(0===u)h=(l.h/l.w+a.h/a.w)/2,f=Math.abs(d),m=f-l.h-a.h;else if(0===d)h=1,f=Math.abs(u),m=f-l.w-a.w;else{const e=d/u,t=e*e,n=l.wh/Math.sqrt(l.h2+t*l.w2),r=e*n,o=Math.sqrt(n*n+r*r),i=o/l.w,s=a.wh/Math.sqrt(a.h2+t*a.w2),c=e*s,g=Math.sqrt(s*s+c*c),_=g/a.w;f=Math.sqrt(p),m=f-g-o,h=(i+_)/2}g=u/f,_=d/f,v=m<0?Math.min(Math.max(1,n*h*-m),5):Math.min(20,h*i*o/m),r.vx+=v*g,r.vy+=v*_,t.vx-=v*g,t.vy-=v*_}}}return"function"!==typeof t&&(t=IL(+t)),o.initialize=function(t){e=t},o.outerRepulsion=function(e){return void 0===e?r:(r=+e,o)},o.innerRepulsion=function(e){return void 0===e?n:(n=+e,o)},o.padding=function(e){return void 0===e?t:(t="function"===typeof e?e:IL(+e),o)},o}(n,10,5,5)).force("link",function(e){var t,n,r,o,a,i,s=Ns,l=function(e){return 1/Math.min(o[e.source.index],o[e.target.index])},c=zs(30),u=1;function d(r){for(var o=0,s=e.length;o<u;++o)for(var l,c,d,p,h,f,m,g=0;g<s;++g)c=(l=e[g]).source,p=(d=l.target).x+d.vx-c.x-c.vx||Os(i),h=d.y+d.vy-c.y-c.vy||Os(i),p*=f=((f=Math.sqrt(p*p+h*h))-n[g])/f*r*t[g],h*=f,d.vx-=p*(m=a[g]),d.vy-=h*m,c.vx+=p*(m=1-m),c.vy+=h*m}function p(){if(r){var i,l,c=r.length,u=e.length,d=new Map(r.map(((e,t)=>[s(e,t,r),e])));for(i=0,o=new Array(c);i<u;++i)(l=e[i]).index=i,"object"!==typeof l.source&&(l.source=Bs(d,l.source)),"object"!==typeof l.target&&(l.target=Bs(d,l.target)),o[l.source.index]=(o[l.source.index]||0)+1,o[l.target.index]=(o[l.target.index]||0)+1;for(i=0,a=new Array(u);i<u;++i)l=e[i],a[i]=o[l.source.index]/(o[l.source.index]+o[l.target.index]);t=new Array(u),h(),n=new Array(u),f()}}function h(){if(r)for(var n=0,o=e.length;n<o;++n)t[n]=+l(e[n],n,e)}function f(){if(r)for(var t=0,o=e.length;t<o;++t)n[t]=+c(e[t],t,e)}return null==e&&(e=[]),d.initialize=function(e,t){r=e,i=t,p()},d.links=function(t){return arguments.length?(e=t,p(),d):e},d.id=function(e){return arguments.length?(s=e,d):s},d.iterations=function(e){return arguments.length?(u=+e,d):u},d.strength=function(e){return arguments.length?(l="function"===typeof e?e:zs(+e),h(),d):l},d.distance=function(e){return arguments.length?(c="function"===typeof e?e:zs(+e),f(),d):c},d}(t).id((e=>e.word)).strength(.4)).force("y",function(e){var t,n,r,o=zs(.1);function a(e){for(var o,a=0,i=t.length;a<i;++a)(o=t[a]).vy+=(r[a]-o.y)*n[a]*e}function i(){if(t){var a,i=t.length;for(n=new Array(i),r=new Array(i),a=0;a<i;++a)n[a]=isNaN(r[a]=+e(t[a],a,t))?0:+o(t[a],a,t)}}return"function"!==typeof e&&(e=zs(null==e?0:+e)),a.initialize=function(e){t=e,i()},a.strength=function(e){return arguments.length?(o="function"===typeof e?e:zs(+e),i(),a):o},a.y=function(t){return arguments.length?(e="function"===typeof t?t:zs(+t),i(),a):e},a}(this.height/2).strength((e=>e.count/100))).force("x",(()=>n.forEach((e=>e.x=this.getExpectedX(e,n))))),this.simulation.on("tick",(()=>this.update())),this.runSimulationToConvergence(),this.update(e)}runSimulationToConvergence(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3;if(!this.simulation)return;this.simulation.stop();let n=!1,r=0;for(;!n&&r<t;)this.simulation.tick(),n=this.simulation.nodes().every((t=>Math.abs(t.vx)<e&&Math.abs(t.vy)<e)),r++;console.log("Simulation converged after ".concat(r," iterations"))}linkIsInSents(e){if(this.nodeSelected())return Array.from(this.selectedNodes).some((t=>t.origSentIndices.includes(e.sentIdx)));const t=this.hoveredNode;return null===t||void 0===t?void 0:t.origSentIndices.includes(e.sentIdx)}nodeIsInSelectedSents(e){if(this.nodeSelected()){const t=new Set;return Array.from(this.selectedNodes).forEach((e=>{e.origSentIndices.forEach((e=>t.add(e)))})),e.origSentIndices.some((e=>t.has(e)))}if(!this.hoveredNode)return!1;const t=[...this.hoveredNode.origSentIndices],n=e.origSentIndices,r=t.filter((e=>n.includes(e)));return r.length>0}addBoundingBoxData(e){e.forEach((e=>{e.rx=e.textLength/2,e.ry=this.textHeight(e)/2}))}getExpectedX(e,t){const n=e.parents.filter((e=>t.includes(e)));if(e.isRoot&&!n.length)return 30;if(!n.length)return e.x;const r=n.map((e=>e.x+e.textLength+30)),o=uo(r)||0,a=co(r)||0,i=function(e,t){let n=0,r=0;if(void 0===t)for(let o of e)null!=o&&(o=+o)>=o&&(++n,r+=o);else{let o=-1;for(let a of e)null!=(a=t(a,++o,e))&&(a=+a)>=a&&(++n,r+=a)}if(n)return r/n}(r)||0;return Fl().domain([0,.5,1]).range([o,i,a])(this.props.spread)}getExpectedY(e,t){const n=uo(e.origSentIndices||[])||0,r=this.props.promptGroups.reduce(((e,t)=>e+t.generations.length),0);return Fl().domain([0,r]).range([.1*t,.9*t])(n)}fontSize(e){return this.fontScale?this.fontScale(e.count):10}textLength(e){return co(BL(e.word).map((t=>t.length*e.fontSize*.6)))||0}textHeight(e){return BL(e.word).length*e.fontSize}wrapText(e){e.each((function(e){const t=Gl(this),n=BL(e.word);t.text(null).selectAll("tspan").data(n).enter().append("tspan").attr("x",0).attr("dy",((e,t)=>"".concat(0===t?0:1.2,"em"))).text((e=>e))}))}hidePopup(){(this.state.isPopupVisible||0!==this.state.popupNodes.length)&&this.setState({popupNodes:[],isPopupVisible:!1})}}const NL=new Map;function BL(e){if(NL.has(e))return NL.get(e);const t=fB(e).split(" "),n=[];for(let r=0;r<t.length;r+=3)n.push(t.slice(r,r+3).join(" "));return NL.set(e,n),n}const jL=no(OL);class LL extends a.Component{constructor(){super(...arguments),this.state={visType:"graph",promptGroups:[]},this.disposer=void 0}getPromptGroupKey(e,t){return"".concat(e.text,"_").concat(t,"_").concat(e.modelFamily,"_").concat(e.model)}render(){var e;if(CL.prompts.length&&null!==(e=CL.prompts[0])&&void 0!==e&&e.text)return(0,EL.jsx)("div",{className:"single-example",children:(0,EL.jsxs)("div",{children:[(0,EL.jsx)("div",{className:"inout"}),this.renderOutputs()]})})}renderOutputs(){if(!this.state.promptGroups)return;let e,t="";switch(this.state.visType){case"word tree":e=this.renderOutputsWordTree(),t="Hover over a word to highlight it across all generated sentences. \n                The size of the word corresponds to its frequency in the generated sentences.";break;case"graph":e=this.renderOutputsGraph(),t="Hover over any word or phrase to highlight all sentences containing it. \n                \nClick to pin the highlight - click again or click elsewhere to unpin.\n                \nDrag to pan, scroll to zoom in and out.";break;case"highlights":e=this.renderOutputsHighlights(),t="Highlighted words are the ones that are present in multiple generated sentences. The bolded output is the text you entered to compare against the LLM outputs (if provided). Color of highlights is not related to the colors used in the graph visualization.";break;case"first output":e=this.renderOutputsBasic(!0),t="First output generated by the LLM for each prompt.";break;default:e=this.renderOutputsBasic(),t="Outputs generated by the LLM."}return(0,EL.jsxs)("div",{children:[this.renderRadioButtons(),e]})}renderRadioButtons(){const e=e=>(0,EL.jsxs)("div",{className:"radio-holder",children:[(0,EL.jsx)("input",{type:"radio",id:e,name:"rendertype",value:e,checked:this.state.visType===e,onChange:e=>{const t=e.target.value;this.setState((e=>so(so({},e),{},{visType:t})))}}),(0,EL.jsx)("label",{htmlFor:e,children:e})]});return(0,EL.jsxs)("div",{className:"all-radio-holder",children:[e("graph"),e("raw outputs"),e("first output"),e("word tree"),e("highlights")]})}renderOutputsWordTree(){var e;const t=null===(e=this.state.promptGroups[0])||void 0===e?void 0:e.generations;return(0,EL.jsx)(AL,{generations:t})}renderOutputsGraph(){return(0,EL.jsx)(jL,{promptGroups:this.state.promptGroups,similarityThreshold:CL.similarityThreshold,minOpacityThreshold:CL.minOpacityThreshold,spread:CL.spread})}renderOutputsBasic(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.state.promptGroups&&0!==this.state.promptGroups.length?(0,EL.jsx)("div",{className:"outputs",children:this.state.promptGroups.map(((t,n)=>{var r,o,a;const i=t.promptId.match(/_(\d+)_/),s=i?parseInt(i[1]):0,l=CL.getPromptColor(s),c=(null===(r=CL.prompts[s])||void 0===r?void 0:r.text)||"",u=e?t.generations.slice(0,1):t.generations;return(0,EL.jsxs)("div",{className:"prompt-output-group",style:{borderColor:l},children:[(0,EL.jsxs)("div",{className:"prompt-output-header",style:{backgroundColor:l},children:[(0,EL.jsxs)("div",{className:"prompt-text",children:["Prompt ",s+1,": ",c]}),(0,EL.jsxs)("div",{className:"prompt-info",children:[!e&&"".concat(t.generations.length," outputs - "),null===(o=CL.prompts[s])||void 0===o?void 0:o.modelFamily,"/",null===(a=CL.prompts[s])||void 0===a?void 0:a.model]})]}),(0,EL.jsx)("div",{children:u.map(((e,t)=>(0,EL.jsx)("div",{className:"output-item",children:e},"".concat(e,"-").concat(t))))})]},"group-".concat(n))}))}):(0,EL.jsx)("div",{className:"outputs",children:"No outputs available"})}renderOutputsHighlights(){var e;const t=null===(e=this.state.promptGroups[0])||void 0===e?void 0:e.generations;return(0,EL.jsx)(FL,{generations:t})}componentDidMount(){this.disposer=function(e,t,n){var r,o,a;void 0===n&&(n=g);var i,s,l,c=null!=(r=n.name)?r:"Reaction",u=Ut(c,n.onError?(i=n.onError,s=t,function(){try{return s.apply(this,arguments)}catch(AC){i.call(this,AC)}}):t),d=!n.scheduler&&!n.delay,p=Zt(n),h=!0,f=!1,m=n.compareStructural?te.structural:n.equals||te.default,_=new At(c,(function(){h||d?v():f||(f=!0,p(v))}),n.onError,n.requiresObservable);function v(){if(f=!1,!_.isDisposed){var t=!1,r=l;_.track((function(){var n=Qe(!1,(function(){return e(_)}));t=h||!m(l,n),l=n})),(h&&n.fireImmediately||!h&&t)&&u(l,r,_),h=!1}}return null!=(o=n)&&null!=(o=o.signal)&&o.aborted||_.schedule_(),_.getDisposer_(null==(a=n)?void 0:a.signal)}((()=>[CL.prompts.map((e=>e.text)).join("\x01"),CL.prompts.map((e=>e.temp)).join(","),CL.prompts.map((e=>e.modelFamily)).join(","),CL.prompts.map((e=>e.model)).join(","),CL.numGenerations,CL.similarityThreshold,CL.minOpacityThreshold,CL.shuffle,CL.tokenizeMode,CL.disabledPrompts]),(async()=>{const e=CL.prompts.map(((e,t)=>({prompt:e,originalIndex:t}))).filter((e=>{let{prompt:t,originalIndex:n}=e;return t.text&&t.text.trim().length>0&&!CL.isPromptDisabled(n)}));if(0===e.length)return;const t=[];for(let n=0;n<e.length;n++){const{prompt:r,originalIndex:o}=e[n],a=await CL.fetchGenerationsFor(o);t.push({promptId:this.getPromptGroupKey(r,o),generations:a})}this.setState({promptGroups:t.length>=1?t:[]})}),{fireImmediately:!0})}componentWillUnmount(){this.disposer&&this.disposer()}}const RL=no(LL);function VL(e){var t,n,r="";if("string"==typeof e||"number"==typeof e)r+=e;else if("object"==typeof e)if(Array.isArray(e)){var o=e.length;for(t=0;t<o;t++)e[t]&&(n=VL(e[t]))&&(r&&(r+=" "),r+=n)}else for(n in e)e[n]&&(r&&(r+=" "),r+=n);return r}const qL=function(){for(var e,t,n=0,r="",o=arguments.length;n<o;n++)(e=arguments[n])&&(t=VL(e))&&(r&&(r+=" "),r+=t);return r};function UL(){return UL=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},UL.apply(null,arguments)}var WL=function(){function e(e){var t=this;this._insertTag=function(e){var n;n=0===t.tags.length?t.insertionPoint?t.insertionPoint.nextSibling:t.prepend?t.container.firstChild:t.before:t.tags[t.tags.length-1].nextSibling,t.container.insertBefore(e,n),t.tags.push(e)},this.isSpeedy=void 0===e.speedy||e.speedy,this.tags=[],this.ctr=0,this.nonce=e.nonce,this.key=e.key,this.container=e.container,this.prepend=e.prepend,this.insertionPoint=e.insertionPoint,this.before=null}var t=e.prototype;return t.hydrate=function(e){e.forEach(this._insertTag)},t.insert=function(e){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(function(e){var t=document.createElement("style");return t.setAttribute("data-emotion",e.key),void 0!==e.nonce&&t.setAttribute("nonce",e.nonce),t.appendChild(document.createTextNode("")),t.setAttribute("data-s",""),t}(this));var t=this.tags[this.tags.length-1];if(this.isSpeedy){var n=function(e){if(e.sheet)return e.sheet;for(var t=0;t<document.styleSheets.length;t++)if(document.styleSheets[t].ownerNode===e)return document.styleSheets[t]}(t);try{n.insertRule(e,n.cssRules.length)}catch(AC){}}else t.appendChild(document.createTextNode(e));this.ctr++},t.flush=function(){this.tags.forEach((function(e){var t;return null==(t=e.parentNode)?void 0:t.removeChild(e)})),this.tags=[],this.ctr=0},e}(),GL=Math.abs,HL=String.fromCharCode,KL=Object.assign;function ZL(e){return e.trim()}function $L(e,t,n){return e.replace(t,n)}function XL(e,t){return e.indexOf(t)}function JL(e,t){return 0|e.charCodeAt(t)}function QL(e,t,n){return e.slice(t,n)}function YL(e){return e.length}function eR(e){return e.length}function tR(e,t){return t.push(e),e}var nR=1,rR=1,oR=0,aR=0,iR=0,sR="";function lR(e,t,n,r,o,a,i){return{value:e,root:t,parent:n,type:r,props:o,children:a,line:nR,column:rR,length:i,return:""}}function cR(e,t){return KL(lR("",null,null,"",null,null,0),e,{length:-e.length},t)}function uR(){return iR=aR>0?JL(sR,--aR):0,rR--,10===iR&&(rR=1,nR--),iR}function dR(){return iR=aR<oR?JL(sR,aR++):0,rR++,10===iR&&(rR=1,nR++),iR}function pR(){return JL(sR,aR)}function hR(){return aR}function fR(e,t){return QL(sR,e,t)}function mR(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function gR(e){return nR=rR=1,oR=YL(sR=e),aR=0,[]}function _R(e){return sR="",e}function vR(e){return ZL(fR(aR-1,bR(91===e?e+2:40===e?e+1:e)))}function yR(e){for(;(iR=pR())&&iR<33;)dR();return mR(e)>2||mR(iR)>3?"":" "}function wR(e,t){for(;--t&&dR()&&!(iR<48||iR>102||iR>57&&iR<65||iR>70&&iR<97););return fR(e,hR()+(t<6&&32==pR()&&32==dR()))}function bR(e){for(;dR();)switch(iR){case e:return aR;case 34:case 39:34!==e&&39!==e&&bR(iR);break;case 40:41===e&&bR(e);break;case 92:dR()}return aR}function xR(e,t){for(;dR()&&e+iR!==57&&(e+iR!==84||47!==pR()););return"/*"+fR(t,aR-1)+"*"+HL(47===e?e:dR())}function kR(e){for(;!mR(pR());)dR();return fR(e,aR)}var CR="-ms-",DR="-moz-",SR="-webkit-",ER="comm",TR="rule",AR="decl",MR="@keyframes";function FR(e,t){for(var n="",r=eR(e),o=0;o<r;o++)n+=t(e[o],o,e,t)||"";return n}function IR(e,t,n,r){switch(e.type){case"@layer":if(e.children.length)break;case"@import":case AR:return e.return=e.return||e.value;case ER:return"";case MR:return e.return=e.value+"{"+FR(e.children,r)+"}";case TR:e.value=e.props.join(",")}return YL(n=FR(e.children,r))?e.return=e.value+"{"+n+"}":""}function PR(e){return _R(zR("",null,null,null,[""],e=gR(e),0,[0],e))}function zR(e,t,n,r,o,a,i,s,l){for(var c=0,u=0,d=i,p=0,h=0,f=0,m=1,g=1,_=1,v=0,y="",w=o,b=a,x=r,k=y;g;)switch(f=v,v=dR()){case 40:if(108!=f&&58==JL(k,d-1)){-1!=XL(k+=$L(vR(v),"&","&\f"),"&\f")&&(_=-1);break}case 34:case 39:case 91:k+=vR(v);break;case 9:case 10:case 13:case 32:k+=yR(f);break;case 92:k+=wR(hR()-1,7);continue;case 47:switch(pR()){case 42:case 47:tR(NR(xR(dR(),hR()),t,n),l);break;default:k+="/"}break;case 123*m:s[c++]=YL(k)*_;case 125*m:case 59:case 0:switch(v){case 0:case 125:g=0;case 59+u:-1==_&&(k=$L(k,/\f/g,"")),h>0&&YL(k)-d&&tR(h>32?BR(k+";",r,n,d-1):BR($L(k," ","")+";",r,n,d-2),l);break;case 59:k+=";";default:if(tR(x=OR(k,t,n,c,u,o,s,y,w=[],b=[],d),a),123===v)if(0===u)zR(k,t,x,x,w,a,d,s,b);else switch(99===p&&110===JL(k,3)?100:p){case 100:case 108:case 109:case 115:zR(e,x,x,r&&tR(OR(e,x,x,0,0,o,s,y,o,w=[],d),b),o,b,d,s,r?w:b);break;default:zR(k,x,x,x,[""],b,0,s,b)}}c=u=h=0,m=_=1,y=k="",d=i;break;case 58:d=1+YL(k),h=f;default:if(m<1)if(123==v)--m;else if(125==v&&0==m++&&125==uR())continue;switch(k+=HL(v),v*m){case 38:_=u>0?1:(k+="\f",-1);break;case 44:s[c++]=(YL(k)-1)*_,_=1;break;case 64:45===pR()&&(k+=vR(dR())),p=pR(),u=d=YL(y=k+=kR(hR())),v++;break;case 45:45===f&&2==YL(k)&&(m=0)}}return a}function OR(e,t,n,r,o,a,i,s,l,c,u){for(var d=o-1,p=0===o?a:[""],h=eR(p),f=0,m=0,g=0;f<r;++f)for(var _=0,v=QL(e,d+1,d=GL(m=i[f])),y=e;_<h;++_)(y=ZL(m>0?p[_]+" "+v:$L(v,/&\f/g,p[_])))&&(l[g++]=y);return lR(e,t,n,0===o?TR:s,l,c,u)}function NR(e,t,n){return lR(e,t,n,ER,HL(iR),QL(e,2,-2),0)}function BR(e,t,n,r){return lR(e,t,n,AR,QL(e,0,r),QL(e,r+1,-1),r)}var jR=function(e,t,n){for(var r=0,o=0;r=o,o=pR(),38===r&&12===o&&(t[n]=1),!mR(o);)dR();return fR(e,aR)},LR=function(e,t){return _R(function(e,t){var n=-1,r=44;do{switch(mR(r)){case 0:38===r&&12===pR()&&(t[n]=1),e[n]+=jR(aR-1,t,n);break;case 2:e[n]+=vR(r);break;case 4:if(44===r){e[++n]=58===pR()?"&\f":"",t[n]=e[n].length;break}default:e[n]+=HL(r)}}while(r=dR());return e}(gR(e),t))},RR=new WeakMap,VR=function(e){if("rule"===e.type&&e.parent&&!(e.length<1)){for(var t=e.value,n=e.parent,r=e.column===n.column&&e.line===n.line;"rule"!==n.type;)if(!(n=n.parent))return;if((1!==e.props.length||58===t.charCodeAt(0)||RR.get(n))&&!r){RR.set(e,!0);for(var o=[],a=LR(t,o),i=n.props,s=0,l=0;s<a.length;s++)for(var c=0;c<i.length;c++,l++)e.props[l]=o[s]?a[s].replace(/&\f/g,i[c]):i[c]+" "+a[s]}}},qR=function(e){if("decl"===e.type){var t=e.value;108===t.charCodeAt(0)&&98===t.charCodeAt(2)&&(e.return="",e.value="")}};function UR(e,t){switch(function(e,t){return 45^JL(e,0)?(((t<<2^JL(e,0))<<2^JL(e,1))<<2^JL(e,2))<<2^JL(e,3):0}(e,t)){case 5103:return SR+"print-"+e+e;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return SR+e+e;case 5349:case 4246:case 4810:case 6968:case 2756:return SR+e+DR+e+CR+e+e;case 6828:case 4268:return SR+e+CR+e+e;case 6165:return SR+e+CR+"flex-"+e+e;case 5187:return SR+e+$L(e,/(\w+).+(:[^]+)/,SR+"box-$1$2"+CR+"flex-$1$2")+e;case 5443:return SR+e+CR+"flex-item-"+$L(e,/flex-|-self/,"")+e;case 4675:return SR+e+CR+"flex-line-pack"+$L(e,/align-content|flex-|-self/,"")+e;case 5548:return SR+e+CR+$L(e,"shrink","negative")+e;case 5292:return SR+e+CR+$L(e,"basis","preferred-size")+e;case 6060:return SR+"box-"+$L(e,"-grow","")+SR+e+CR+$L(e,"grow","positive")+e;case 4554:return SR+$L(e,/([^-])(transform)/g,"$1"+SR+"$2")+e;case 6187:return $L($L($L(e,/(zoom-|grab)/,SR+"$1"),/(image-set)/,SR+"$1"),e,"")+e;case 5495:case 3959:return $L(e,/(image-set\([^]*)/,SR+"$1$`$1");case 4968:return $L($L(e,/(.+:)(flex-)?(.*)/,SR+"box-pack:$3"+CR+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+SR+e+e;case 4095:case 3583:case 4068:case 2532:return $L(e,/(.+)-inline(.+)/,SR+"$1$2")+e;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(YL(e)-1-t>6)switch(JL(e,t+1)){case 109:if(45!==JL(e,t+4))break;case 102:return $L(e,/(.+:)(.+)-([^]+)/,"$1"+SR+"$2-$3$1"+DR+(108==JL(e,t+3)?"$3":"$2-$3"))+e;case 115:return~XL(e,"stretch")?UR($L(e,"stretch","fill-available"),t)+e:e}break;case 4949:if(115!==JL(e,t+1))break;case 6444:switch(JL(e,YL(e)-3-(~XL(e,"!important")&&10))){case 107:return $L(e,":",":"+SR)+e;case 101:return $L(e,/(.+:)([^;!]+)(;|!.+)?/,"$1"+SR+(45===JL(e,14)?"inline-":"")+"box$3$1"+SR+"$2$3$1"+CR+"$2box$3")+e}break;case 5936:switch(JL(e,t+11)){case 114:return SR+e+CR+$L(e,/[svh]\w+-[tblr]{2}/,"tb")+e;case 108:return SR+e+CR+$L(e,/[svh]\w+-[tblr]{2}/,"tb-rl")+e;case 45:return SR+e+CR+$L(e,/[svh]\w+-[tblr]{2}/,"lr")+e}return SR+e+CR+e+e}return e}var WR=[function(e,t,n,r){if(e.length>-1&&!e.return)switch(e.type){case AR:e.return=UR(e.value,e.length);break;case MR:return FR([cR(e,{value:$L(e.value,"@","@"+SR)})],r);case TR:if(e.length)return function(e,t){return e.map(t).join("")}(e.props,(function(t){switch(function(e,t){return(e=t.exec(e))?e[0]:e}(t,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return FR([cR(e,{props:[$L(t,/:(read-\w+)/,":-moz-$1")]})],r);case"::placeholder":return FR([cR(e,{props:[$L(t,/:(plac\w+)/,":"+SR+"input-$1")]}),cR(e,{props:[$L(t,/:(plac\w+)/,":-moz-$1")]}),cR(e,{props:[$L(t,/:(plac\w+)/,CR+"input-$1")]})],r)}return""}))}}],GR=function(e){var t=e.key;if("css"===t){var n=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(n,(function(e){-1!==e.getAttribute("data-emotion").indexOf(" ")&&(document.head.appendChild(e),e.setAttribute("data-s",""))}))}var r,o,a=e.stylisPlugins||WR,i={},s=[];r=e.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+t+' "]'),(function(e){for(var t=e.getAttribute("data-emotion").split(" "),n=1;n<t.length;n++)i[t[n]]=!0;s.push(e)}));var l,c,u=[IR,(c=function(e){l.insert(e)},function(e){e.root||(e=e.return)&&c(e)})],d=function(e){var t=eR(e);return function(n,r,o,a){for(var i="",s=0;s<t;s++)i+=e[s](n,r,o,a)||"";return i}}([VR,qR].concat(a,u));o=function(e,t,n,r){l=n,FR(PR(e?e+"{"+t.styles+"}":t.styles),d),r&&(p.inserted[t.name]=!0)};var p={key:t,sheet:new WL({key:t,container:r,nonce:e.nonce,speedy:e.speedy,prepend:e.prepend,insertionPoint:e.insertionPoint}),nonce:e.nonce,inserted:i,registered:{},insert:o};return p.sheet.hydrate(s),p};var HR={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,scale:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1};function KR(e){var t=Object.create(null);return function(n){return void 0===t[n]&&(t[n]=e(n)),t[n]}}var ZR=/[A-Z]|^ms/g,$R=/_EMO_([^_]+?)_([^]*?)_EMO_/g,XR=function(e){return 45===e.charCodeAt(1)},JR=function(e){return null!=e&&"boolean"!==typeof e},QR=KR((function(e){return XR(e)?e:e.replace(ZR,"-$&").toLowerCase()})),YR=function(e,t){switch(e){case"animation":case"animationName":if("string"===typeof t)return t.replace($R,(function(e,t,n){return tV={name:t,styles:n,next:tV},t}))}return 1===HR[e]||XR(e)||"number"!==typeof t||0===t?t:t+"px"};function eV(e,t,n){if(null==n)return"";var r=n;if(void 0!==r.__emotion_styles)return r;switch(typeof n){case"boolean":return"";case"object":var o=n;if(1===o.anim)return tV={name:o.name,styles:o.styles,next:tV},o.name;var a=n;if(void 0!==a.styles){var i=a.next;if(void 0!==i)for(;void 0!==i;)tV={name:i.name,styles:i.styles,next:tV},i=i.next;return a.styles+";"}return function(e,t,n){var r="";if(Array.isArray(n))for(var o=0;o<n.length;o++)r+=eV(e,t,n[o])+";";else for(var a in n){var i=n[a];if("object"!==typeof i){var s=i;null!=t&&void 0!==t[s]?r+=a+"{"+t[s]+"}":JR(s)&&(r+=QR(a)+":"+YR(a,s)+";")}else if(!Array.isArray(i)||"string"!==typeof i[0]||null!=t&&void 0!==t[i[0]]){var l=eV(e,t,i);switch(a){case"animation":case"animationName":r+=QR(a)+":"+l+";";break;default:r+=a+"{"+l+"}"}}else for(var c=0;c<i.length;c++)JR(i[c])&&(r+=QR(a)+":"+YR(a,i[c])+";")}return r}(e,t,n);case"function":if(void 0!==e){var s=tV,l=n(e);return tV=s,eV(e,t,l)}}var c=n;if(null==t)return c;var u=t[c];return void 0!==u?u:c}var tV,nV=/label:\s*([^\s;{]+)\s*(;|$)/g;function rV(e,t,n){if(1===e.length&&"object"===typeof e[0]&&null!==e[0]&&void 0!==e[0].styles)return e[0];var r=!0,o="";tV=void 0;var a=e[0];null==a||void 0===a.raw?(r=!1,o+=eV(n,t,a)):o+=a[0];for(var i=1;i<e.length;i++){if(o+=eV(n,t,e[i]),r)o+=a[i]}nV.lastIndex=0;for(var s,l="";null!==(s=nV.exec(o));)l+="-"+s[1];var c=function(e){for(var t,n=0,r=0,o=e.length;o>=4;++r,o-=4)t=1540483477*(65535&(t=255&e.charCodeAt(r)|(255&e.charCodeAt(++r))<<8|(255&e.charCodeAt(++r))<<16|(255&e.charCodeAt(++r))<<24))+(59797*(t>>>16)<<16),n=1540483477*(65535&(t^=t>>>24))+(59797*(t>>>16)<<16)^1540483477*(65535&n)+(59797*(n>>>16)<<16);switch(o){case 3:n^=(255&e.charCodeAt(r+2))<<16;case 2:n^=(255&e.charCodeAt(r+1))<<8;case 1:n=1540483477*(65535&(n^=255&e.charCodeAt(r)))+(59797*(n>>>16)<<16)}return(((n=1540483477*(65535&(n^=n>>>13))+(59797*(n>>>16)<<16))^n>>>15)>>>0).toString(36)}(o)+l;return{name:c,styles:o,next:tV}}var oV=!!i.useInsertionEffect&&i.useInsertionEffect,aV=oV||function(e){return e()},iV=(oV||a.useLayoutEffect,a.createContext("undefined"!==typeof HTMLElement?GR({key:"css"}):null)),sV=(iV.Provider,function(e){return(0,a.forwardRef)((function(t,n){var r=(0,a.useContext)(iV);return e(t,r,n)}))}),lV=a.createContext({});var cV=function(e,t,n){var r=e.key+"-"+t.name;!1===n&&void 0===e.registered[r]&&(e.registered[r]=t.styles)},uV=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|disableRemotePlayback|download|draggable|encType|enterKeyHint|fetchpriority|fetchPriority|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|popover|popoverTarget|popoverTargetAction|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,dV=KR((function(e){return uV.test(e)||111===e.charCodeAt(0)&&110===e.charCodeAt(1)&&e.charCodeAt(2)<91})),pV=function(e){return"theme"!==e},hV=function(e){return"string"===typeof e&&e.charCodeAt(0)>96?dV:pV},fV=function(e,t,n){var r;if(t){var o=t.shouldForwardProp;r=e.__emotion_forwardProp&&o?function(t){return e.__emotion_forwardProp(t)&&o(t)}:o}return"function"!==typeof r&&n&&(r=e.__emotion_forwardProp),r},mV=function(e){var t=e.cache,n=e.serialized,r=e.isStringTag;return cV(t,n,r),aV((function(){return function(e,t,n){cV(e,t,n);var r=e.key+"-"+t.name;if(void 0===e.inserted[t.name]){var o=t;do{e.insert(t===o?"."+r:"",o,e.sheet,!0),o=o.next}while(void 0!==o)}}(t,n,r)})),null},gV=function e(t,n){var r,o,i=t.__emotion_real===t,s=i&&t.__emotion_base||t;void 0!==n&&(r=n.label,o=n.target);var l=fV(t,n,i),c=l||hV(s),u=!c("as");return function(){var d=arguments,p=i&&void 0!==t.__emotion_styles?t.__emotion_styles.slice(0):[];if(void 0!==r&&p.push("label:"+r+";"),null==d[0]||void 0===d[0].raw)p.push.apply(p,d);else{var h=d[0];p.push(h[0]);for(var f=d.length,m=1;m<f;m++)p.push(d[m],h[m])}var g=sV((function(e,t,n){var r=u&&e.as||s,i="",d=[],h=e;if(null==e.theme){for(var f in h={},e)h[f]=e[f];h.theme=a.useContext(lV)}"string"===typeof e.className?i=function(e,t,n){var r="";return n.split(" ").forEach((function(n){void 0!==e[n]?t.push(e[n]+";"):n&&(r+=n+" ")})),r}(t.registered,d,e.className):null!=e.className&&(i=e.className+" ");var m=rV(p.concat(d),t.registered,h);i+=t.key+"-"+m.name,void 0!==o&&(i+=" "+o);var g=u&&void 0===l?hV(r):c,_={};for(var v in e)u&&"as"===v||g(v)&&(_[v]=e[v]);return _.className=i,n&&(_.ref=n),a.createElement(a.Fragment,null,a.createElement(mV,{cache:t,serialized:m,isStringTag:"string"===typeof r}),a.createElement(r,_))}));return g.displayName=void 0!==r?r:"Styled("+("string"===typeof s?s:s.displayName||s.name||"Component")+")",g.defaultProps=t.defaultProps,g.__emotion_real=g,g.__emotion_base=s,g.__emotion_styles=p,g.__emotion_forwardProp=l,Object.defineProperty(g,"toString",{value:function(){return"."+o}}),g.withComponent=function(t,r){return e(t,UL({},n,r,{shouldForwardProp:fV(g,r,!0)})).apply(void 0,p)},g}}.bind(null);function _V(e,t){return gV(e,t)}["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"].forEach((function(e){gV[e]=gV(e)}));const vV=[];function yV(e){return vV[0]=e,rV(vV)}function wV(e){const t=new URL("https://mui.com/production-error/?code=".concat(e));for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];return r.forEach((e=>t.searchParams.append("args[]",e))),"Minified MUI error #".concat(e,"; visit ").concat(t," for the full message.")}function bV(e){if("string"!==typeof e)throw new Error(wV(7));return e.charAt(0).toUpperCase()+e.slice(1)}var xV=n(191);function kV(e){if("object"!==typeof e||null===e)return!1;const t=Object.getPrototypeOf(e);return(null===t||t===Object.prototype||null===Object.getPrototypeOf(t))&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)}function CV(e){if(a.isValidElement(e)||(0,xV.Hy)(e)||!kV(e))return e;const t={};return Object.keys(e).forEach((n=>{t[n]=CV(e[n])})),t}function DV(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{clone:!0};const r=n.clone?so({},e):e;return kV(e)&&kV(t)&&Object.keys(t).forEach((o=>{a.isValidElement(t[o])||(0,xV.Hy)(t[o])?r[o]=t[o]:kV(t[o])&&Object.prototype.hasOwnProperty.call(e,o)&&kV(e[o])?r[o]=DV(e[o],t[o],n):n.clone?r[o]=kV(t[o])?CV(t[o]):t[o]:r[o]=t[o]})),r}const SV=function(e,t){return t?DV(e,t,{clone:!1}):e};function EV(e,t){if(!e.containerQueries)return t;const n=Object.keys(t).filter((e=>e.startsWith("@container"))).sort(((e,t)=>{var n,r;const o=/min-width:\s*([0-9.]+)/;return+((null===(n=e.match(o))||void 0===n?void 0:n[1])||0)-+((null===(r=t.match(o))||void 0===r?void 0:r[1])||0)}));return n.length?n.reduce(((e,n)=>{const r=t[n];return delete e[n],e[n]=r,e}),so({},t)):t}const TV={xs:0,sm:600,md:900,lg:1200,xl:1536},AV={keys:["xs","sm","md","lg","xl"],up:e=>"@media (min-width:".concat(TV[e],"px)")},MV={containerQueries:e=>({up:t=>{let n="number"===typeof t?t:TV[t]||t;return"number"===typeof n&&(n="".concat(n,"px")),e?"@container ".concat(e," (min-width:").concat(n,")"):"@container (min-width:".concat(n,")")}})};function FV(e,t,n){const r=e.theme||{};if(Array.isArray(t)){const e=r.breakpoints||AV;return t.reduce(((r,o,a)=>(r[e.up(e.keys[a])]=n(t[a]),r)),{})}if("object"===typeof t){const e=r.breakpoints||AV;return Object.keys(t).reduce(((o,a)=>{if(function(e,t){return"@"===t||t.startsWith("@")&&(e.some((e=>t.startsWith("@".concat(e))))||!!t.match(/^@\d/))}(e.keys,a)){const e=function(e,t){const n=t.match(/^@([^/]+)?\/?(.+)?$/);if(!n)return null;const[,r,o]=n,a=Number.isNaN(+r)?r||0:+r;return e.containerQueries(o).up(a)}(r.containerQueries?r:MV,a);e&&(o[e]=n(t[a],a))}else if(Object.keys(e.values||TV).includes(a)){o[e.up(a)]=n(t[a],a)}else{const e=a;o[e]=t[e]}return o}),{})}return n(t)}function IV(){var e;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(null===(e=t.keys)||void 0===e?void 0:e.reduce(((e,n)=>(e[t.up(n)]={},e)),{}))||{}}function PV(e,t){return e.reduce(((e,t)=>{const n=e[t];return(!n||0===Object.keys(n).length)&&delete e[t],e}),t)}function zV(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(!t||"string"!==typeof t)return null;if(e&&e.vars&&n){const n="vars.".concat(t).split(".").reduce(((e,t)=>e&&e[t]?e[t]:null),e);if(null!=n)return n}return t.split(".").reduce(((e,t)=>e&&null!=e[t]?e[t]:null),e)}function OV(e,t,n){let r,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:n;return r="function"===typeof e?e(n):Array.isArray(e)?e[n]||o:zV(e,n)||o,t&&(r=t(r,o,e)),r}const NV=function(e){const{prop:t,cssProperty:n=e.prop,themeKey:r,transform:o}=e,a=e=>{if(null==e[t])return null;const a=e[t],i=zV(e.theme,r)||{};return FV(e,a,(e=>{let r=OV(i,o,e);return e===r&&"string"===typeof e&&(r=OV(i,o,"".concat(t).concat("default"===e?"":bV(e)),e)),!1===n?r:{[n]:r}}))};return a.propTypes={},a.filterProps=[t],a};const BV={m:"margin",p:"padding"},jV={t:"Top",r:"Right",b:"Bottom",l:"Left",x:["Left","Right"],y:["Top","Bottom"]},LV={marginX:"mx",marginY:"my",paddingX:"px",paddingY:"py"},RV=function(e){const t={};return n=>(void 0===t[n]&&(t[n]=e(n)),t[n])}((e=>{if(e.length>2){if(!LV[e])return[e];e=LV[e]}const[t,n]=e.split(""),r=BV[t],o=jV[n]||"";return Array.isArray(o)?o.map((e=>r+e)):[r+o]})),VV=["m","mt","mr","mb","ml","mx","my","margin","marginTop","marginRight","marginBottom","marginLeft","marginX","marginY","marginInline","marginInlineStart","marginInlineEnd","marginBlock","marginBlockStart","marginBlockEnd"],qV=["p","pt","pr","pb","pl","px","py","padding","paddingTop","paddingRight","paddingBottom","paddingLeft","paddingX","paddingY","paddingInline","paddingInlineStart","paddingInlineEnd","paddingBlock","paddingBlockStart","paddingBlockEnd"],UV=[...VV,...qV];function WV(e,t,n,r){var o;const a=null!==(o=zV(e,t,!0))&&void 0!==o?o:n;return"number"===typeof a||"string"===typeof a?e=>"string"===typeof e?e:"string"===typeof a?a.startsWith("var(")&&0===e?0:a.startsWith("var(")&&1===e?a:"calc(".concat(e," * ").concat(a,")"):a*e:Array.isArray(a)?e=>{if("string"===typeof e)return e;const t=Math.abs(e);const n=a[t];return e>=0?n:"number"===typeof n?-n:"string"===typeof n&&n.startsWith("var(")?"calc(-1 * ".concat(n,")"):"-".concat(n)}:"function"===typeof a?a:()=>{}}function GV(e){return WV(e,"spacing",8)}function HV(e,t){return"string"===typeof t||null==t?t:e(t)}function KV(e,t,n,r){if(!t.includes(n))return null;const o=function(e,t){return n=>e.reduce(((e,r)=>(e[r]=HV(t,n),e)),{})}(RV(n),r);return FV(e,e[n],o)}function ZV(e,t){const n=GV(e.theme);return Object.keys(e).map((r=>KV(e,t,r,n))).reduce(SV,{})}function $V(e){return ZV(e,VV)}function XV(e){return ZV(e,qV)}function JV(e){return ZV(e,UV)}$V.propTypes={},$V.filterProps=VV,XV.propTypes={},XV.filterProps=qV,JV.propTypes={},JV.filterProps=UV;const QV=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const r=t.reduce(((e,t)=>(t.filterProps.forEach((n=>{e[n]=t})),e)),{}),o=e=>Object.keys(e).reduce(((t,n)=>r[n]?SV(t,r[n](e)):t),{});return o.propTypes={},o.filterProps=t.reduce(((e,t)=>e.concat(t.filterProps)),[]),o};function YV(e){return"number"!==typeof e?e:"".concat(e,"px solid")}function eq(e,t){return NV({prop:e,themeKey:"borders",transform:t})}const tq=eq("border",YV),nq=eq("borderTop",YV),rq=eq("borderRight",YV),oq=eq("borderBottom",YV),aq=eq("borderLeft",YV),iq=eq("borderColor"),sq=eq("borderTopColor"),lq=eq("borderRightColor"),cq=eq("borderBottomColor"),uq=eq("borderLeftColor"),dq=eq("outline",YV),pq=eq("outlineColor"),hq=e=>{if(void 0!==e.borderRadius&&null!==e.borderRadius){const t=WV(e.theme,"shape.borderRadius",4),n=e=>({borderRadius:HV(t,e)});return FV(e,e.borderRadius,n)}return null};hq.propTypes={},hq.filterProps=["borderRadius"];QV(tq,nq,rq,oq,aq,iq,sq,lq,cq,uq,hq,dq,pq);const fq=e=>{if(void 0!==e.gap&&null!==e.gap){const t=WV(e.theme,"spacing",8),n=e=>({gap:HV(t,e)});return FV(e,e.gap,n)}return null};fq.propTypes={},fq.filterProps=["gap"];const mq=e=>{if(void 0!==e.columnGap&&null!==e.columnGap){const t=WV(e.theme,"spacing",8),n=e=>({columnGap:HV(t,e)});return FV(e,e.columnGap,n)}return null};mq.propTypes={},mq.filterProps=["columnGap"];const gq=e=>{if(void 0!==e.rowGap&&null!==e.rowGap){const t=WV(e.theme,"spacing",8),n=e=>({rowGap:HV(t,e)});return FV(e,e.rowGap,n)}return null};gq.propTypes={},gq.filterProps=["rowGap"];QV(fq,mq,gq,NV({prop:"gridColumn"}),NV({prop:"gridRow"}),NV({prop:"gridAutoFlow"}),NV({prop:"gridAutoColumns"}),NV({prop:"gridAutoRows"}),NV({prop:"gridTemplateColumns"}),NV({prop:"gridTemplateRows"}),NV({prop:"gridTemplateAreas"}),NV({prop:"gridArea"}));function _q(e,t){return"grey"===t?t:e}QV(NV({prop:"color",themeKey:"palette",transform:_q}),NV({prop:"bgcolor",cssProperty:"backgroundColor",themeKey:"palette",transform:_q}),NV({prop:"backgroundColor",themeKey:"palette",transform:_q}));function vq(e){return e<=1&&0!==e?"".concat(100*e,"%"):e}const yq=NV({prop:"width",transform:vq}),wq=e=>{if(void 0!==e.maxWidth&&null!==e.maxWidth){const t=t=>{var n,r;const o=(null===(n=e.theme)||void 0===n||null===(n=n.breakpoints)||void 0===n||null===(n=n.values)||void 0===n?void 0:n[t])||TV[t];return o?"px"!==(null===(r=e.theme)||void 0===r||null===(r=r.breakpoints)||void 0===r?void 0:r.unit)?{maxWidth:"".concat(o).concat(e.theme.breakpoints.unit)}:{maxWidth:o}:{maxWidth:vq(t)}};return FV(e,e.maxWidth,t)}return null};wq.filterProps=["maxWidth"];const bq=NV({prop:"minWidth",transform:vq}),xq=NV({prop:"height",transform:vq}),kq=NV({prop:"maxHeight",transform:vq}),Cq=NV({prop:"minHeight",transform:vq}),Dq=(NV({prop:"size",cssProperty:"width",transform:vq}),NV({prop:"size",cssProperty:"height",transform:vq}),QV(yq,wq,bq,xq,kq,Cq,NV({prop:"boxSizing"})),{border:{themeKey:"borders",transform:YV},borderTop:{themeKey:"borders",transform:YV},borderRight:{themeKey:"borders",transform:YV},borderBottom:{themeKey:"borders",transform:YV},borderLeft:{themeKey:"borders",transform:YV},borderColor:{themeKey:"palette"},borderTopColor:{themeKey:"palette"},borderRightColor:{themeKey:"palette"},borderBottomColor:{themeKey:"palette"},borderLeftColor:{themeKey:"palette"},outline:{themeKey:"borders",transform:YV},outlineColor:{themeKey:"palette"},borderRadius:{themeKey:"shape.borderRadius",style:hq},color:{themeKey:"palette",transform:_q},bgcolor:{themeKey:"palette",cssProperty:"backgroundColor",transform:_q},backgroundColor:{themeKey:"palette",transform:_q},p:{style:XV},pt:{style:XV},pr:{style:XV},pb:{style:XV},pl:{style:XV},px:{style:XV},py:{style:XV},padding:{style:XV},paddingTop:{style:XV},paddingRight:{style:XV},paddingBottom:{style:XV},paddingLeft:{style:XV},paddingX:{style:XV},paddingY:{style:XV},paddingInline:{style:XV},paddingInlineStart:{style:XV},paddingInlineEnd:{style:XV},paddingBlock:{style:XV},paddingBlockStart:{style:XV},paddingBlockEnd:{style:XV},m:{style:$V},mt:{style:$V},mr:{style:$V},mb:{style:$V},ml:{style:$V},mx:{style:$V},my:{style:$V},margin:{style:$V},marginTop:{style:$V},marginRight:{style:$V},marginBottom:{style:$V},marginLeft:{style:$V},marginX:{style:$V},marginY:{style:$V},marginInline:{style:$V},marginInlineStart:{style:$V},marginInlineEnd:{style:$V},marginBlock:{style:$V},marginBlockStart:{style:$V},marginBlockEnd:{style:$V},displayPrint:{cssProperty:!1,transform:e=>({"@media print":{display:e}})},display:{},overflow:{},textOverflow:{},visibility:{},whiteSpace:{},flexBasis:{},flexDirection:{},flexWrap:{},justifyContent:{},alignItems:{},alignContent:{},order:{},flex:{},flexGrow:{},flexShrink:{},alignSelf:{},justifyItems:{},justifySelf:{},gap:{style:fq},rowGap:{style:gq},columnGap:{style:mq},gridColumn:{},gridRow:{},gridAutoFlow:{},gridAutoColumns:{},gridAutoRows:{},gridTemplateColumns:{},gridTemplateRows:{},gridTemplateAreas:{},gridArea:{},position:{},zIndex:{themeKey:"zIndex"},top:{},right:{},bottom:{},left:{},boxShadow:{themeKey:"shadows"},width:{transform:vq},maxWidth:{style:wq},minWidth:{transform:vq},height:{transform:vq},maxHeight:{transform:vq},minHeight:{transform:vq},boxSizing:{},font:{themeKey:"font"},fontFamily:{themeKey:"typography"},fontSize:{themeKey:"typography"},fontStyle:{themeKey:"typography"},fontWeight:{themeKey:"typography"},letterSpacing:{},textTransform:{},lineHeight:{},textAlign:{},typography:{cssProperty:!1,themeKey:"typography"}}),Sq=Dq;const Eq=function(){function e(e,t,n,r){const o={[e]:t,theme:n},a=r[e];if(!a)return{[e]:t};const{cssProperty:i=e,themeKey:s,transform:l,style:c}=a;if(null==t)return null;if("typography"===s&&"inherit"===t)return{[e]:t};const u=zV(n,s)||{};if(c)return c(o);return FV(o,t,(t=>{let n=OV(u,l,t);return t===n&&"string"===typeof t&&(n=OV(u,l,"".concat(e).concat("default"===t?"":bV(t)),t)),!1===i?n:{[i]:n}}))}return function t(n){var r;const{sx:o,theme:a={},nested:i}=n||{};if(!o)return null;const s=null!==(r=a.unstable_sxConfig)&&void 0!==r?r:Sq;function l(n){let r=n;if("function"===typeof n)r=n(a);else if("object"!==typeof n)return n;if(!r)return null;const o=IV(a.breakpoints),l=Object.keys(o);let c=o;return Object.keys(r).forEach((n=>{const o=function(e,t){return"function"===typeof e?e(t):e}(r[n],a);if(null!==o&&void 0!==o)if("object"===typeof o)if(s[n])c=SV(c,e(n,o,a,s));else{const e=FV({theme:a},o,(e=>({[n]:e})));!function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const r=t.reduce(((e,t)=>e.concat(Object.keys(t))),[]),o=new Set(r);return t.every((e=>o.size===Object.keys(e).length))}(e,o)?c=SV(c,e):c[n]=t({sx:o,theme:a,nested:!0})}else c=SV(c,e(n,o,a,s))})),!i&&a.modularCssLayers?{"@layer sx":EV(a,PV(l,c))}:EV(a,PV(l,c))}return Array.isArray(o)?o.map(l):l(o)}}();Eq.filterProps=["sx"];const Tq=Eq,Aq=["sx"];function Mq(e){const{sx:t}=e,n=Kc(e,Aq),{systemProps:r,otherProps:o}=(e=>{var t,n;const r={systemProps:{},otherProps:{}},o=null!==(t=null===e||void 0===e||null===(n=e.theme)||void 0===n?void 0:n.unstable_sxConfig)&&void 0!==t?t:Sq;return Object.keys(e).forEach((t=>{o[t]?r.systemProps[t]=e[t]:r.otherProps[t]=e[t]})),r})(n);let a;return a=Array.isArray(t)?[r,...t]:"function"===typeof t?function(){const e=t(...arguments);return kV(e)?so(so({},r),e):r}:so(so({},r),t),so(so({},o),{},{sx:a})}const Fq=["values","unit","step"];function Iq(e){const{values:t={xs:0,sm:600,md:900,lg:1200,xl:1536},unit:n="px",step:r=5}=e,o=Kc(e,Fq),a=(e=>{const t=Object.keys(e).map((t=>({key:t,val:e[t]})))||[];return t.sort(((e,t)=>e.val-t.val)),t.reduce(((e,t)=>so(so({},e),{},{[t.key]:t.val})),{})})(t),i=Object.keys(a);function s(e){const r="number"===typeof t[e]?t[e]:e;return"@media (min-width:".concat(r).concat(n,")")}function l(e){const o="number"===typeof t[e]?t[e]:e;return"@media (max-width:".concat(o-r/100).concat(n,")")}function c(e,o){const a=i.indexOf(o);return"@media (min-width:".concat("number"===typeof t[e]?t[e]:e).concat(n,") and ")+"(max-width:".concat((-1!==a&&"number"===typeof t[i[a]]?t[i[a]]:o)-r/100).concat(n,")")}return so({keys:i,values:a,up:s,down:l,between:c,only:function(e){return i.indexOf(e)+1<i.length?c(e,i[i.indexOf(e)+1]):s(e)},not:function(e){const t=i.indexOf(e);return 0===t?s(i[1]):t===i.length-1?l(i[t]):c(e,i[i.indexOf(e)+1]).replace("@media","@media not all and")},unit:n},o)}const Pq={borderRadius:4};function zq(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:8,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:GV({spacing:e});if(e.mui)return e;const n=function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return(0===n.length?[1]:n).map((e=>{const n=t(e);return"number"===typeof n?"".concat(n,"px"):n})).join(" ")};return n.mui=!0,n}function Oq(e,t){const n=this;if(n.vars){var r;if(null===(r=n.colorSchemes)||void 0===r||!r[e]||"function"!==typeof n.getColorSchemeSelector)return{};let o=n.getColorSchemeSelector(e);return"&"===o?t:((o.includes("data-")||o.includes("."))&&(o="*:where(".concat(o.replace(/\s*&$/,""),") &")),{[o]:t})}return n.palette.mode===e?t:{}}const Nq=["breakpoints","palette","spacing","shape"];const Bq=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{breakpoints:t={},palette:n={},spacing:r,shape:o={}}=e,a=Kc(e,Nq),i=Iq(t),s=zq(r);let l=DV({breakpoints:i,direction:"ltr",components:{},palette:so({mode:"light"},n),spacing:s,shape:so(so({},Pq),o)},a);l=function(e){const t=(e,t)=>e.replace("@media",t?"@container ".concat(t):"@container");function n(n,r){n.up=function(){return t(e.breakpoints.up(...arguments),r)},n.down=function(){return t(e.breakpoints.down(...arguments),r)},n.between=function(){return t(e.breakpoints.between(...arguments),r)},n.only=function(){return t(e.breakpoints.only(...arguments),r)},n.not=function(){const n=t(e.breakpoints.not(...arguments),r);return n.includes("not all and")?n.replace("not all and ","").replace("min-width:","width<").replace("max-width:","width>").replace("and","or"):n}}const r={},o=e=>(n(r,e),r);return n(o),so(so({},e),{},{containerQueries:o})}(l),l.applyStyles=Oq;for(var c=arguments.length,u=new Array(c>1?c-1:0),d=1;d<c;d++)u[d-1]=arguments[d];return l=u.reduce(((e,t)=>DV(e,t)),l),l.unstable_sxConfig=so(so({},Sq),null===a||void 0===a?void 0:a.unstable_sxConfig),l.unstable_sx=function(e){return Tq({sx:e,theme:this})},l};const jq=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;const t=a.useContext(lV);return t&&(n=t,0!==Object.keys(n).length)?t:e;var n},Lq=Bq();const Rq=function(){return jq(arguments.length>0&&void 0!==arguments[0]?arguments[0]:Lq)},Vq=["className","component"];const qq=e=>e,Uq=(()=>{let e=qq;return{configure(t){e=t},generate:t=>e(t),reset(){e=qq}}})();const Wq=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Number.MIN_SAFE_INTEGER,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Number.MAX_SAFE_INTEGER;return Math.max(t,Math.min(e,n))};function Gq(e){return Wq(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,arguments.length>2&&void 0!==arguments[2]?arguments[2]:1)}function Hq(e){if(e.type)return e;if("#"===e.charAt(0))return Hq(function(e){e=e.slice(1);const t=new RegExp(".{1,".concat(e.length>=6?2:1,"}"),"g");let n=e.match(t);return n&&1===n[0].length&&(n=n.map((e=>e+e))),n?"rgb".concat(4===n.length?"a":"","(").concat(n.map(((e,t)=>t<3?parseInt(e,16):Math.round(parseInt(e,16)/255*1e3)/1e3)).join(", "),")"):""}(e));const t=e.indexOf("("),n=e.substring(0,t);if(!["rgb","rgba","hsl","hsla","color"].includes(n))throw new Error(wV(9,e));let r,o=e.substring(t+1,e.length-1);if("color"===n){if(o=o.split(" "),r=o.shift(),4===o.length&&"/"===o[3].charAt(0)&&(o[3]=o[3].slice(1)),!["srgb","display-p3","a98-rgb","prophoto-rgb","rec-2020"].includes(r))throw new Error(wV(10,r))}else o=o.split(",");return o=o.map((e=>parseFloat(e))),{type:n,values:o,colorSpace:r}}const Kq=(e,t)=>{try{return(e=>{const t=Hq(e);return t.values.slice(0,3).map(((e,n)=>t.type.includes("hsl")&&0!==n?"".concat(e,"%"):e)).join(" ")})(e)}catch(n){return e}};function Zq(e){const{type:t,colorSpace:n}=e;let{values:r}=e;return t.includes("rgb")?r=r.map(((e,t)=>t<3?parseInt(e,10):e)):t.includes("hsl")&&(r[1]="".concat(r[1],"%"),r[2]="".concat(r[2],"%")),r=t.includes("color")?"".concat(n," ").concat(r.join(" ")):"".concat(r.join(", ")),"".concat(t,"(").concat(r,")")}function $q(e){e=Hq(e);const{values:t}=e,n=t[0],r=t[1]/100,o=t[2]/100,a=r*Math.min(o,1-o),i=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(e+n/30)%12;return o-a*Math.max(Math.min(t-3,9-t,1),-1)};let s="rgb";const l=[Math.round(255*i(0)),Math.round(255*i(8)),Math.round(255*i(4))];return"hsla"===e.type&&(s+="a",l.push(t[3])),Zq({type:s,values:l})}function Xq(e){let t="hsl"===(e=Hq(e)).type||"hsla"===e.type?Hq($q(e)).values:e.values;return t=t.map((t=>("color"!==e.type&&(t/=255),t<=.03928?t/12.92:((t+.055)/1.055)**2.4))),Number((.2126*t[0]+.7152*t[1]+.0722*t[2]).toFixed(3))}function Jq(e,t){return e=Hq(e),t=Gq(t),"rgb"!==e.type&&"hsl"!==e.type||(e.type+="a"),"color"===e.type?e.values[3]="/".concat(t):e.values[3]=t,Zq(e)}function Qq(e,t,n){try{return Jq(e,t)}catch(r){return e}}function Yq(e,t){if(e=Hq(e),t=Gq(t),e.type.includes("hsl"))e.values[2]*=1-t;else if(e.type.includes("rgb")||e.type.includes("color"))for(let n=0;n<3;n+=1)e.values[n]*=1-t;return Zq(e)}function eU(e,t,n){try{return Yq(e,t)}catch(r){return e}}function tU(e,t){if(e=Hq(e),t=Gq(t),e.type.includes("hsl"))e.values[2]+=(100-e.values[2])*t;else if(e.type.includes("rgb"))for(let n=0;n<3;n+=1)e.values[n]+=(255-e.values[n])*t;else if(e.type.includes("color"))for(let n=0;n<3;n+=1)e.values[n]+=(1-e.values[n])*t;return Zq(e)}function nU(e,t,n){try{return tU(e,t)}catch(r){return e}}function rU(e,t,n){try{return function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.15;return Xq(e)>.5?Yq(e,t):tU(e,t)}(e,t)}catch(r){return e}}const oU={black:"#000",white:"#fff"},aU={50:"#fafafa",100:"#f5f5f5",200:"#eeeeee",300:"#e0e0e0",400:"#bdbdbd",500:"#9e9e9e",600:"#757575",700:"#616161",800:"#424242",900:"#212121",A100:"#f5f5f5",A200:"#eeeeee",A400:"#bdbdbd",A700:"#616161"},iU={50:"#f3e5f5",100:"#e1bee7",200:"#ce93d8",300:"#ba68c8",400:"#ab47bc",500:"#9c27b0",600:"#8e24aa",700:"#7b1fa2",800:"#6a1b9a",900:"#4a148c",A100:"#ea80fc",A200:"#e040fb",A400:"#d500f9",A700:"#aa00ff"},sU={50:"#ffebee",100:"#ffcdd2",200:"#ef9a9a",300:"#e57373",400:"#ef5350",500:"#f44336",600:"#e53935",700:"#d32f2f",800:"#c62828",900:"#b71c1c",A100:"#ff8a80",A200:"#ff5252",A400:"#ff1744",A700:"#d50000"},lU={50:"#fff3e0",100:"#ffe0b2",200:"#ffcc80",300:"#ffb74d",400:"#ffa726",500:"#ff9800",600:"#fb8c00",700:"#f57c00",800:"#ef6c00",900:"#e65100",A100:"#ffd180",A200:"#ffab40",A400:"#ff9100",A700:"#ff6d00"},cU={50:"#e3f2fd",100:"#bbdefb",200:"#90caf9",300:"#64b5f6",400:"#42a5f5",500:"#2196f3",600:"#1e88e5",700:"#1976d2",800:"#1565c0",900:"#0d47a1",A100:"#82b1ff",A200:"#448aff",A400:"#2979ff",A700:"#2962ff"},uU={50:"#e1f5fe",100:"#b3e5fc",200:"#81d4fa",300:"#4fc3f7",400:"#29b6f6",500:"#03a9f4",600:"#039be5",700:"#0288d1",800:"#0277bd",900:"#01579b",A100:"#80d8ff",A200:"#40c4ff",A400:"#00b0ff",A700:"#0091ea"},dU={50:"#e8f5e9",100:"#c8e6c9",200:"#a5d6a7",300:"#81c784",400:"#66bb6a",500:"#4caf50",600:"#43a047",700:"#388e3c",800:"#2e7d32",900:"#1b5e20",A100:"#b9f6ca",A200:"#69f0ae",A400:"#00e676",A700:"#00c853"},pU=["mode","contrastThreshold","tonalOffset","colorSpace"];function hU(){return{text:{primary:"rgba(0, 0, 0, 0.87)",secondary:"rgba(0, 0, 0, 0.6)",disabled:"rgba(0, 0, 0, 0.38)"},divider:"rgba(0, 0, 0, 0.12)",background:{paper:oU.white,default:oU.white},action:{active:"rgba(0, 0, 0, 0.54)",hover:"rgba(0, 0, 0, 0.04)",hoverOpacity:.04,selected:"rgba(0, 0, 0, 0.08)",selectedOpacity:.08,disabled:"rgba(0, 0, 0, 0.26)",disabledBackground:"rgba(0, 0, 0, 0.12)",disabledOpacity:.38,focus:"rgba(0, 0, 0, 0.12)",focusOpacity:.12,activatedOpacity:.12}}}const fU=hU();function mU(){return{text:{primary:oU.white,secondary:"rgba(255, 255, 255, 0.7)",disabled:"rgba(255, 255, 255, 0.5)",icon:"rgba(255, 255, 255, 0.5)"},divider:"rgba(255, 255, 255, 0.12)",background:{paper:"#121212",default:"#121212"},action:{active:oU.white,hover:"rgba(255, 255, 255, 0.08)",hoverOpacity:.08,selected:"rgba(255, 255, 255, 0.16)",selectedOpacity:.16,disabled:"rgba(255, 255, 255, 0.3)",disabledBackground:"rgba(255, 255, 255, 0.12)",disabledOpacity:.38,focus:"rgba(255, 255, 255, 0.12)",focusOpacity:.12,activatedOpacity:.24}}}const gU=mU();function _U(e,t,n,r){const o=r.light||r,a=r.dark||1.5*r;e[t]||(e.hasOwnProperty(n)?e[t]=e[n]:"light"===t?e.light=tU(e.main,o):"dark"===t&&(e.dark=Yq(e.main,a)))}function vU(e,t,n,r,o){const a=o.light||o,i=o.dark||1.5*o;t[n]||(t.hasOwnProperty(r)?t[n]=t[r]:"light"===n?t.light="color-mix(in ".concat(e,", ").concat(t.main,", #fff ").concat((100*a).toFixed(0),"%)"):"dark"===n&&(t.dark="color-mix(in ".concat(e,", ").concat(t.main,", #000 ").concat((100*i).toFixed(0),"%)")))}function yU(e){const{mode:t="light",contrastThreshold:n=3,tonalOffset:r=.2,colorSpace:o}=e,a=Kc(e,pU),i=e.primary||function(){return"dark"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light")?{main:cU[200],light:cU[50],dark:cU[400]}:{main:cU[700],light:cU[400],dark:cU[800]}}(t),s=e.secondary||function(){return"dark"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light")?{main:iU[200],light:iU[50],dark:iU[400]}:{main:iU[500],light:iU[300],dark:iU[700]}}(t),l=e.error||function(){return"dark"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light")?{main:sU[500],light:sU[300],dark:sU[700]}:{main:sU[700],light:sU[400],dark:sU[800]}}(t),c=e.info||function(){return"dark"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light")?{main:uU[400],light:uU[300],dark:uU[700]}:{main:uU[700],light:uU[500],dark:uU[900]}}(t),u=e.success||function(){return"dark"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light")?{main:dU[400],light:dU[300],dark:dU[700]}:{main:dU[800],light:dU[500],dark:dU[900]}}(t),d=e.warning||function(){return"dark"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light")?{main:lU[400],light:lU[300],dark:lU[700]}:{main:"#ed6c02",light:lU[500],dark:lU[900]}}(t);function p(e){if(o)return function(e){return"oklch(from ".concat(e," var(--__l) 0 h / var(--__a))")}(e);const t=function(e,t){const n=Xq(e),r=Xq(t);return(Math.max(n,r)+.05)/(Math.min(n,r)+.05)}(e,gU.text.primary)>=n?gU.text.primary:fU.text.primary;return t}const h=e=>{let{color:t,name:n,mainShade:a=500,lightShade:i=300,darkShade:s=700}=e;if(t=so({},t),!t.main&&t[a]&&(t.main=t[a]),!t.hasOwnProperty("main"))throw new Error(wV(11,n?" (".concat(n,")"):"",a));if("string"!==typeof t.main)throw new Error(wV(12,n?" (".concat(n,")"):"",JSON.stringify(t.main)));return o?(vU(o,t,"light",i,r),vU(o,t,"dark",s,r)):(_U(t,"light",i,r),_U(t,"dark",s,r)),t.contrastText||(t.contrastText=p(t.main)),t};let f;"light"===t?f=hU():"dark"===t&&(f=mU());return DV(so({common:so({},oU),mode:t,primary:h({color:i,name:"primary"}),secondary:h({color:s,name:"secondary",mainShade:"A400",lightShade:"A200",darkShade:"A700"}),error:h({color:l,name:"error"}),warning:h({color:d,name:"warning"}),info:h({color:c,name:"info"}),success:h({color:u,name:"success"}),grey:aU,contrastThreshold:n,getContrastText:p,augmentColor:h,tonalOffset:r},f),a)}function wU(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";function t(){for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];if(!r.length)return"";const a=r[0];return"string"!==typeof a||a.match(/(#|\(|\)|(-?(\d*\.)?\d+)(px|em|%|ex|ch|rem|vw|vh|vmin|vmax|cm|mm|in|pt|pc))|^(-?(\d*\.)?\d+)$|(\d+ \d+ \d+)/)?", ".concat(a):", var(--".concat(e?"".concat(e,"-"):"").concat(a).concat(t(...r.slice(1)),")")}return function(n){for(var r=arguments.length,o=new Array(r>1?r-1:0),a=1;a<r;a++)o[a-1]=arguments[a];return"var(--".concat(e?"".concat(e,"-"):"").concat(n).concat(t(...o),")")}}function bU(e){const t={};return Object.entries(e).forEach((e=>{const[n,r]=e;"object"===typeof r&&(t[n]="".concat(r.fontStyle?"".concat(r.fontStyle," "):"").concat(r.fontVariant?"".concat(r.fontVariant," "):"").concat(r.fontWeight?"".concat(r.fontWeight," "):"").concat(r.fontStretch?"".concat(r.fontStretch," "):"").concat(r.fontSize||"").concat(r.lineHeight?"/".concat(r.lineHeight," "):"").concat(r.fontFamily||""))})),t}const xU=function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],o=e;t.forEach(((e,a)=>{a===t.length-1?Array.isArray(o)?o[Number(e)]=n:o&&"object"===typeof o&&(o[e]=n):o&&"object"===typeof o&&(o[e]||(o[e]=r.includes(e)?[]:{}),o=o[e])}))};function kU(e,t){const{prefix:n,shouldSkipGeneratingVar:r}=t||{},o={},a={},i={};var s,l;return s=(e,t,s)=>{if(("string"===typeof t||"number"===typeof t)&&(!r||!r(e,t))){const r="--".concat(n?"".concat(n,"-"):"").concat(e.join("-")),l=((e,t)=>"number"===typeof t?["lineHeight","fontWeight","opacity","zIndex"].some((t=>e.includes(t)))||e[e.length-1].toLowerCase().includes("opacity")?t:"".concat(t,"px"):t)(e,t);Object.assign(o,{[r]:l}),xU(a,e,"var(".concat(r,")"),s),xU(i,e,"var(".concat(r,", ").concat(l,")"),s)}},l=e=>"vars"===e[0],function e(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];Object.entries(t).forEach((t=>{let[o,a]=t;(!l||l&&!l([...n,o]))&&void 0!==a&&null!==a&&("object"===typeof a&&Object.keys(a).length>0?e(a,[...n,o],Array.isArray(a)?[...r,o]:r):s([...n,o],a,r))}))}(e),{css:o,vars:a,varsWithDefaults:i}}const CU=["colorSchemes","components","defaultColorScheme"];const DU=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{getSelector:n=_,disableCssColorScheme:r,colorSchemeSelector:o,enableContrastVars:a}=t,{colorSchemes:i={},components:s,defaultColorScheme:l="light"}=e,c=Kc(e,CU),{vars:u,css:d,varsWithDefaults:p}=kU(c,t);let h=p;const f={},{[l]:m}=i,g=Kc(i,[l].map(oo));if(Object.entries(g||{}).forEach((e=>{let[n,r]=e;const{vars:o,css:a,varsWithDefaults:i}=kU(r,t);h=DV(h,i),f[n]={css:a,vars:o}})),m){const{css:e,vars:n,varsWithDefaults:r}=kU(m,t);h=DV(h,r),f[l]={css:e,vars:n}}function _(t,n){let r=o;if("class"===o&&(r=".%s"),"data"===o&&(r="[data-%s]"),null!==o&&void 0!==o&&o.startsWith("data-")&&!o.includes("%s")&&(r="[".concat(o,'="%s"]')),t){if("media"===r){var a;if(e.defaultColorScheme===t)return":root";const r=(null===(a=i[t])||void 0===a||null===(a=a.palette)||void 0===a?void 0:a.mode)||t;return{["@media (prefers-color-scheme: ".concat(r,")")]:{":root":n}}}if(r)return e.defaultColorScheme===t?":root, ".concat(r.replace("%s",String(t))):r.replace("%s",String(t))}return":root"}return{vars:h,generateThemeVars:()=>{let e=so({},u);return Object.entries(f).forEach((t=>{let[,{vars:n}]=t;e=DV(e,n)})),e},generateStyleSheets:()=>{const t=[],o=e.defaultColorScheme||"light";function s(e,n){Object.keys(n).length&&t.push("string"===typeof e?{[e]:so({},n)}:e)}s(n(void 0,so({},d)),d);const{[o]:l}=f,c=Kc(f,[o].map(oo));if(l){var u;const{css:e}=l,t=null===(u=i[o])||void 0===u||null===(u=u.palette)||void 0===u?void 0:u.mode,a=so(!r&&t?{colorScheme:t}:{},e);s(n(o,so({},a)),a)}return Object.entries(c).forEach((e=>{var t;let[o,{css:a}]=e;const l=null===(t=i[o])||void 0===t||null===(t=t.palette)||void 0===t?void 0:t.mode,c=so(!r&&l?{colorScheme:l}:{},a);s(n(o,so({},c)),c)})),a&&t.push({":root":{"--__l-threshold":"0.7","--__l":"clamp(0, (l / var(--__l-threshold) - 1) * -infinity, 1)","--__a":"clamp(0.87, (l / var(--__l-threshold) - 1) * -infinity, 1)"}}),t}}};function SU(e,t){return so({toolbar:{minHeight:56,[e.up("xs")]:{"@media (orientation: landscape)":{minHeight:48}},[e.up("sm")]:{minHeight:64}}},t)}const EU=["fontFamily","fontSize","fontWeightLight","fontWeightRegular","fontWeightMedium","fontWeightBold","htmlFontSize","allVariants","pxToRem"];function TU(e){return Math.round(1e5*e)/1e5}const AU={textTransform:"uppercase"},MU='"Roboto", "Helvetica", "Arial", sans-serif';function FU(e,t){const n="function"===typeof t?t(e):t,{fontFamily:r=MU,fontSize:o=14,fontWeightLight:a=300,fontWeightRegular:i=400,fontWeightMedium:s=500,fontWeightBold:l=700,htmlFontSize:c=16,allVariants:u,pxToRem:d}=n,p=Kc(n,EU);const h=o/14,f=d||(e=>"".concat(e/c*h,"rem")),m=(e,t,n,o,a)=>so(so(so({fontFamily:r,fontWeight:e,fontSize:f(t),lineHeight:n},r===MU?{letterSpacing:"".concat(TU(o/t),"em")}:{}),a),u),g={h1:m(a,96,1.167,-1.5),h2:m(a,60,1.2,-.5),h3:m(i,48,1.167,0),h4:m(i,34,1.235,.25),h5:m(i,24,1.334,0),h6:m(s,20,1.6,.15),subtitle1:m(i,16,1.75,.15),subtitle2:m(s,14,1.57,.1),body1:m(i,16,1.5,.15),body2:m(i,14,1.43,.15),button:m(s,14,1.75,.4,AU),caption:m(i,12,1.66,.4),overline:m(i,12,2.66,1,AU),inherit:{fontFamily:"inherit",fontWeight:"inherit",fontSize:"inherit",lineHeight:"inherit",letterSpacing:"inherit"}};return DV(so({htmlFontSize:c,pxToRem:f,fontFamily:r,fontSize:o,fontWeightLight:a,fontWeightRegular:i,fontWeightMedium:s,fontWeightBold:l},g),p,{clone:!1})}function IU(){return["".concat(arguments.length<=0?void 0:arguments[0],"px ").concat(arguments.length<=1?void 0:arguments[1],"px ").concat(arguments.length<=2?void 0:arguments[2],"px ").concat(arguments.length<=3?void 0:arguments[3],"px rgba(0,0,0,").concat(.2,")"),"".concat(arguments.length<=4?void 0:arguments[4],"px ").concat(arguments.length<=5?void 0:arguments[5],"px ").concat(arguments.length<=6?void 0:arguments[6],"px ").concat(arguments.length<=7?void 0:arguments[7],"px rgba(0,0,0,").concat(.14,")"),"".concat(arguments.length<=8?void 0:arguments[8],"px ").concat(arguments.length<=9?void 0:arguments[9],"px ").concat(arguments.length<=10?void 0:arguments[10],"px ").concat(arguments.length<=11?void 0:arguments[11],"px rgba(0,0,0,").concat(.12,")")].join(",")}const PU=["none",IU(0,2,1,-1,0,1,1,0,0,1,3,0),IU(0,3,1,-2,0,2,2,0,0,1,5,0),IU(0,3,3,-2,0,3,4,0,0,1,8,0),IU(0,2,4,-1,0,4,5,0,0,1,10,0),IU(0,3,5,-1,0,5,8,0,0,1,14,0),IU(0,3,5,-1,0,6,10,0,0,1,18,0),IU(0,4,5,-2,0,7,10,1,0,2,16,1),IU(0,5,5,-3,0,8,10,1,0,3,14,2),IU(0,5,6,-3,0,9,12,1,0,3,16,2),IU(0,6,6,-3,0,10,14,1,0,4,18,3),IU(0,6,7,-4,0,11,15,1,0,4,20,3),IU(0,7,8,-4,0,12,17,2,0,5,22,4),IU(0,7,8,-4,0,13,19,2,0,5,24,4),IU(0,7,9,-4,0,14,21,2,0,5,26,4),IU(0,8,9,-5,0,15,22,2,0,6,28,5),IU(0,8,10,-5,0,16,24,2,0,6,30,5),IU(0,8,11,-5,0,17,26,2,0,6,32,5),IU(0,9,11,-5,0,18,28,2,0,7,34,6),IU(0,9,12,-6,0,19,29,2,0,7,36,6),IU(0,10,13,-6,0,20,31,3,0,8,38,7),IU(0,10,13,-6,0,21,33,3,0,8,40,7),IU(0,10,14,-6,0,22,35,3,0,8,42,7),IU(0,11,14,-7,0,23,36,3,0,9,44,8),IU(0,11,15,-7,0,24,38,3,0,9,46,8)],zU=["duration","easing","delay"],OU={easeInOut:"cubic-bezier(0.4, 0, 0.2, 1)",easeOut:"cubic-bezier(0.0, 0, 0.2, 1)",easeIn:"cubic-bezier(0.4, 0, 1, 1)",sharp:"cubic-bezier(0.4, 0, 0.6, 1)"},NU={shortest:150,shorter:200,short:250,standard:300,complex:375,enteringScreen:225,leavingScreen:195};function BU(e){return"".concat(Math.round(e),"ms")}function jU(e){if(!e)return 0;const t=e/36;return Math.min(Math.round(10*(4+15*t**.25+t/5)),3e3)}function LU(e){const t=so(so({},OU),e.easing),n=so(so({},NU),e.duration);return so(so({getAutoHeightDuration:jU,create:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:["all"],r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{duration:o=n.standard,easing:a=t.easeInOut,delay:i=0}=r;Kc(r,zU);return(Array.isArray(e)?e:[e]).map((e=>"".concat(e," ").concat("string"===typeof o?o:BU(o)," ").concat(a," ").concat("string"===typeof i?i:BU(i)))).join(",")}},e),{},{easing:t,duration:n})}const RU={mobileStepper:1e3,fab:1050,speedDial:1050,appBar:1100,drawer:1200,modal:1300,snackbar:1400,tooltip:1500};function VU(){const e=so({},arguments.length>0&&void 0!==arguments[0]?arguments[0]:{});return function e(t){const n=Object.entries(t);for(let o=0;o<n.length;o++){const[a,i]=n[o];!kV(r=i)&&"undefined"!==typeof r&&"string"!==typeof r&&"boolean"!==typeof r&&"number"!==typeof r&&!Array.isArray(r)||a.startsWith("unstable_")?delete t[a]:kV(i)&&(t[a]=so({},i),e(t[a]))}var r}(e),"import { unstable_createBreakpoints as createBreakpoints, createTransitions } from '@mui/material/styles';\n\nconst theme = ".concat(JSON.stringify(e,null,2),";\n\ntheme.breakpoints = createBreakpoints(theme.breakpoints || {});\ntheme.transitions = createTransitions(theme.transitions || {});\n\nexport default theme;")}const qU=["breakpoints","mixins","spacing","palette","transitions","typography","shape","colorSpace"];function UU(e){return"number"===typeof e?"".concat((100*e).toFixed(0),"%"):"calc((".concat(e,") * 100%)")}function WU(e){Object.assign(e,{alpha(t,n){const r=this||e;return r.colorSpace?"oklch(from ".concat(t," l c h / ").concat("string"===typeof n?"calc(".concat(n,")"):n,")"):r.vars?"rgba(".concat(t.replace(/var\(--([^,\s)]+)(?:,[^)]+)?\)+/g,"var(--$1Channel)")," / ").concat("string"===typeof n?"calc(".concat(n,")"):n,")"):Jq(t,(e=>{if(!Number.isNaN(+e))return+e;const t=e.match(/\d*\.?\d+/g);if(!t)return 0;let n=0;for(let r=0;r<t.length;r+=1)n+=+t[r];return n})(n))},lighten(t,n){const r=this||e;return r.colorSpace?"color-mix(in ".concat(r.colorSpace,", ").concat(t,", #fff ").concat(UU(n),")"):tU(t,n)},darken(t,n){const r=this||e;return r.colorSpace?"color-mix(in ".concat(r.colorSpace,", ").concat(t,", #000 ").concat(UU(n),")"):Yq(t,n)}})}const GU=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{breakpoints:t,mixins:n={},spacing:r,palette:o={},transitions:a={},typography:i={},shape:s,colorSpace:l}=e,c=Kc(e,qU);if(e.vars&&void 0===e.generateThemeVars)throw new Error(wV(20));const u=yU(so(so({},o),{},{colorSpace:l})),d=Bq(e);let p=DV(d,{mixins:SU(d.breakpoints,n),palette:u,shadows:PU.slice(),typography:FU(u,i),transitions:LU(a),zIndex:so({},RU)});p=DV(p,c);for(var h=arguments.length,f=new Array(h>1?h-1:0),m=1;m<h;m++)f[m-1]=arguments[m];return p=f.reduce(((e,t)=>DV(e,t)),p),p.unstable_sxConfig=so(so({},Sq),null===c||void 0===c?void 0:c.unstable_sxConfig),p.unstable_sx=function(e){return Tq({sx:e,theme:this})},p.toRuntimeSource=VU,WU(p),p};const HU=["palette","opacity","overlays","colorSpace"],KU=[...Array(25)].map(((e,t)=>{if(0===t)return"none";const n=function(e){let t;return t=e<1?5.11916*e**2:4.5*Math.log(e+1)+2,Math.round(10*t)/1e3}(t);return"linear-gradient(rgba(255 255 255 / ".concat(n,"), rgba(255 255 255 / ").concat(n,"))")}));function ZU(e){return{inputPlaceholder:"dark"===e?.5:.42,inputUnderline:"dark"===e?.7:.42,switchTrackDisabled:"dark"===e?.2:.12,switchTrack:"dark"===e?.3:.38}}function $U(e){return"dark"===e?KU:[]}function XU(e){var t;return!!e[0].match(/(cssVarPrefix|colorSchemeSelector|modularCssLayers|rootSelector|typography|mixins|breakpoints|direction|transitions)/)||!!e[0].match(/sxConfig$/)||"palette"===e[0]&&!(null===(t=e[1])||void 0===t||!t.match(/(mode|contrastThreshold|tonalOffset)/))}const JU=e=>[...[...Array(25)].map(((t,n)=>"--".concat(e?"".concat(e,"-"):"","overlays-").concat(n))),"--".concat(e?"".concat(e,"-"):"","palette-AppBar-darkBg"),"--".concat(e?"".concat(e,"-"):"","palette-AppBar-darkColor")],QU=e=>(t,n)=>{const r=e.rootSelector||":root",o=e.colorSchemeSelector;let a=o;if("class"===o&&(a=".%s"),"data"===o&&(a="[data-%s]"),null!==o&&void 0!==o&&o.startsWith("data-")&&!o.includes("%s")&&(a="[".concat(o,'="%s"]')),e.defaultColorScheme===t){if("dark"===t){const o={};return JU(e.cssVarPrefix).forEach((e=>{o[e]=n[e],delete n[e]})),"media"===a?{[r]:n,"@media (prefers-color-scheme: dark)":{[r]:o}}:a?{[a.replace("%s",t)]:o,["".concat(r,", ").concat(a.replace("%s",t))]:n}:{[r]:so(so({},n),o)}}if(a&&"media"!==a)return"".concat(r,", ").concat(a.replace("%s",String(t)))}else if(t){if("media"===a)return{["@media (prefers-color-scheme: ".concat(String(t),")")]:{[r]:n}};if(a)return a.replace("%s",String(t))}return r},YU=["palette"],eW=["colorSchemes","defaultColorScheme","disableCssColorScheme","cssVarPrefix","nativeColor","shouldSkipGeneratingVar","colorSchemeSelector","rootSelector"];function tW(e,t,n){!e[t]&&n&&(e[t]=n)}function nW(e){return"string"===typeof e&&e.startsWith("hsl")?$q(e):e}function rW(e,t){"".concat(t,"Channel")in e||(e["".concat(t,"Channel")]=Kq(nW(e[t]),("MUI: Can't create `palette.".concat(t,"Channel` because `palette.").concat(t,"` is not one of these formats: #nnn, #nnnnnn, rgb(), rgba(), hsl(), hsla(), color()."),"To suppress this warning, you need to explicitly provide the `palette.".concat(t,'Channel` as a string (in rgb format, for example "12 12 12") or undefined if you want to remove the channel token.'))))}const oW=e=>{try{return e()}catch(t){}};function aW(e,t,n,r,o){var a,i,s;if(!n)return;n=!0===n?{}:n;const l="dark"===o?"dark":"light";var c;if(!r)return void(t[o]=function(e){const{palette:t={mode:"light"},opacity:n,overlays:r,colorSpace:o}=e,a=Kc(e,HU),i=yU(so(so({},t),{},{colorSpace:o}));return so({palette:i,opacity:so(so({},ZU(i.mode)),n),overlays:r||$U(i.mode)},a)}(so(so({},n),{},{palette:so({mode:l},null===(c=n)||void 0===c?void 0:c.palette),colorSpace:e})));const u=GU(so(so({},r),{},{palette:so({mode:l},null===(a=n)||void 0===a?void 0:a.palette),colorSpace:e})),{palette:d}=u,p=Kc(u,YU);return t[o]=so(so({},n),{},{palette:d,opacity:so(so({},ZU(l)),null===(i=n)||void 0===i?void 0:i.opacity),overlays:(null===(s=n)||void 0===s?void 0:s.overlays)||$U(l)}),p}function iW(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{colorSchemes:t={light:!0},defaultColorScheme:n,disableCssColorScheme:r=!1,cssVarPrefix:o="mui",nativeColor:a=!1,shouldSkipGeneratingVar:i=XU,colorSchemeSelector:s=(t.light&&t.dark?"media":void 0),rootSelector:l=":root"}=e,c=Kc(e,eW),u=Object.keys(t)[0],d=n||(t.light&&"light"!==u?"light":u),p=function(){return wU(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"mui")}(o),{[d]:h,light:f,dark:m}=t,g=so({},Kc(t,[d,"light","dark"].map(oo)));let _,v=h;if(("dark"===d&&!("dark"in t)||"light"===d&&!("light"in t))&&(v=!0),!v)throw new Error(wV(21,d));a&&(_="oklch");const y=aW(_,g,v,c,d);f&&!g.light&&aW(_,g,f,void 0,"light"),m&&!g.dark&&aW(_,g,m,void 0,"dark");let w=so(so({defaultColorScheme:d},y),{},{cssVarPrefix:o,colorSchemeSelector:s,rootSelector:l,getCssVar:p,colorSchemes:g,font:so(so({},bU(y.typography)),y.font),spacing:(b=c.spacing,"number"===typeof b?"".concat(b,"px"):"string"===typeof b||"function"===typeof b||Array.isArray(b)?b:"8px")});var b;Object.keys(w.colorSchemes).forEach((e=>{const t=w.colorSchemes[e].palette,n=e=>{const n=e.split("-"),r=n[1],o=n[2];return p(e,t[r][o])};function r(e,t,n){if(_){let r;return e===Qq&&(r="transparent ".concat((100*(1-n)).toFixed(0),"%")),e===eU&&(r="#000 ".concat((100*n).toFixed(0),"%")),e===nU&&(r="#fff ".concat((100*n).toFixed(0),"%")),"color-mix(in ".concat(_,", ").concat(t,", ").concat(r,")")}return e(t,n)}if("light"===t.mode&&(tW(t.common,"background","#fff"),tW(t.common,"onBackground","#000")),"dark"===t.mode&&(tW(t.common,"background","#000"),tW(t.common,"onBackground","#fff")),function(e,t){t.forEach((t=>{e[t]||(e[t]={})}))}(t,["Alert","AppBar","Avatar","Button","Chip","FilledInput","LinearProgress","Skeleton","Slider","SnackbarContent","SpeedDialAction","StepConnector","StepContent","Switch","TableCell","Tooltip"]),"light"===t.mode){tW(t.Alert,"errorColor",r(eU,t.error.light,.6)),tW(t.Alert,"infoColor",r(eU,t.info.light,.6)),tW(t.Alert,"successColor",r(eU,t.success.light,.6)),tW(t.Alert,"warningColor",r(eU,t.warning.light,.6)),tW(t.Alert,"errorFilledBg",n("palette-error-main")),tW(t.Alert,"infoFilledBg",n("palette-info-main")),tW(t.Alert,"successFilledBg",n("palette-success-main")),tW(t.Alert,"warningFilledBg",n("palette-warning-main")),tW(t.Alert,"errorFilledColor",oW((()=>t.getContrastText(t.error.main)))),tW(t.Alert,"infoFilledColor",oW((()=>t.getContrastText(t.info.main)))),tW(t.Alert,"successFilledColor",oW((()=>t.getContrastText(t.success.main)))),tW(t.Alert,"warningFilledColor",oW((()=>t.getContrastText(t.warning.main)))),tW(t.Alert,"errorStandardBg",r(nU,t.error.light,.9)),tW(t.Alert,"infoStandardBg",r(nU,t.info.light,.9)),tW(t.Alert,"successStandardBg",r(nU,t.success.light,.9)),tW(t.Alert,"warningStandardBg",r(nU,t.warning.light,.9)),tW(t.Alert,"errorIconColor",n("palette-error-main")),tW(t.Alert,"infoIconColor",n("palette-info-main")),tW(t.Alert,"successIconColor",n("palette-success-main")),tW(t.Alert,"warningIconColor",n("palette-warning-main")),tW(t.AppBar,"defaultBg",n("palette-grey-100")),tW(t.Avatar,"defaultBg",n("palette-grey-400")),tW(t.Button,"inheritContainedBg",n("palette-grey-300")),tW(t.Button,"inheritContainedHoverBg",n("palette-grey-A100")),tW(t.Chip,"defaultBorder",n("palette-grey-400")),tW(t.Chip,"defaultAvatarColor",n("palette-grey-700")),tW(t.Chip,"defaultIconColor",n("palette-grey-700")),tW(t.FilledInput,"bg","rgba(0, 0, 0, 0.06)"),tW(t.FilledInput,"hoverBg","rgba(0, 0, 0, 0.09)"),tW(t.FilledInput,"disabledBg","rgba(0, 0, 0, 0.12)"),tW(t.LinearProgress,"primaryBg",r(nU,t.primary.main,.62)),tW(t.LinearProgress,"secondaryBg",r(nU,t.secondary.main,.62)),tW(t.LinearProgress,"errorBg",r(nU,t.error.main,.62)),tW(t.LinearProgress,"infoBg",r(nU,t.info.main,.62)),tW(t.LinearProgress,"successBg",r(nU,t.success.main,.62)),tW(t.LinearProgress,"warningBg",r(nU,t.warning.main,.62)),tW(t.Skeleton,"bg",_?r(Qq,t.text.primary,.11):"rgba(".concat(n("palette-text-primaryChannel")," / 0.11)")),tW(t.Slider,"primaryTrack",r(nU,t.primary.main,.62)),tW(t.Slider,"secondaryTrack",r(nU,t.secondary.main,.62)),tW(t.Slider,"errorTrack",r(nU,t.error.main,.62)),tW(t.Slider,"infoTrack",r(nU,t.info.main,.62)),tW(t.Slider,"successTrack",r(nU,t.success.main,.62)),tW(t.Slider,"warningTrack",r(nU,t.warning.main,.62));const e=_?r(eU,t.background.default,.6825):rU(t.background.default,.8);tW(t.SnackbarContent,"bg",e),tW(t.SnackbarContent,"color",oW((()=>_?gU.text.primary:t.getContrastText(e)))),tW(t.SpeedDialAction,"fabHoverBg",rU(t.background.paper,.15)),tW(t.StepConnector,"border",n("palette-grey-400")),tW(t.StepContent,"border",n("palette-grey-400")),tW(t.Switch,"defaultColor",n("palette-common-white")),tW(t.Switch,"defaultDisabledColor",n("palette-grey-100")),tW(t.Switch,"primaryDisabledColor",r(nU,t.primary.main,.62)),tW(t.Switch,"secondaryDisabledColor",r(nU,t.secondary.main,.62)),tW(t.Switch,"errorDisabledColor",r(nU,t.error.main,.62)),tW(t.Switch,"infoDisabledColor",r(nU,t.info.main,.62)),tW(t.Switch,"successDisabledColor",r(nU,t.success.main,.62)),tW(t.Switch,"warningDisabledColor",r(nU,t.warning.main,.62)),tW(t.TableCell,"border",r(nU,r(Qq,t.divider,1),.88)),tW(t.Tooltip,"bg",r(Qq,t.grey[700],.92))}if("dark"===t.mode){tW(t.Alert,"errorColor",r(nU,t.error.light,.6)),tW(t.Alert,"infoColor",r(nU,t.info.light,.6)),tW(t.Alert,"successColor",r(nU,t.success.light,.6)),tW(t.Alert,"warningColor",r(nU,t.warning.light,.6)),tW(t.Alert,"errorFilledBg",n("palette-error-dark")),tW(t.Alert,"infoFilledBg",n("palette-info-dark")),tW(t.Alert,"successFilledBg",n("palette-success-dark")),tW(t.Alert,"warningFilledBg",n("palette-warning-dark")),tW(t.Alert,"errorFilledColor",oW((()=>t.getContrastText(t.error.dark)))),tW(t.Alert,"infoFilledColor",oW((()=>t.getContrastText(t.info.dark)))),tW(t.Alert,"successFilledColor",oW((()=>t.getContrastText(t.success.dark)))),tW(t.Alert,"warningFilledColor",oW((()=>t.getContrastText(t.warning.dark)))),tW(t.Alert,"errorStandardBg",r(eU,t.error.light,.9)),tW(t.Alert,"infoStandardBg",r(eU,t.info.light,.9)),tW(t.Alert,"successStandardBg",r(eU,t.success.light,.9)),tW(t.Alert,"warningStandardBg",r(eU,t.warning.light,.9)),tW(t.Alert,"errorIconColor",n("palette-error-main")),tW(t.Alert,"infoIconColor",n("palette-info-main")),tW(t.Alert,"successIconColor",n("palette-success-main")),tW(t.Alert,"warningIconColor",n("palette-warning-main")),tW(t.AppBar,"defaultBg",n("palette-grey-900")),tW(t.AppBar,"darkBg",n("palette-background-paper")),tW(t.AppBar,"darkColor",n("palette-text-primary")),tW(t.Avatar,"defaultBg",n("palette-grey-600")),tW(t.Button,"inheritContainedBg",n("palette-grey-800")),tW(t.Button,"inheritContainedHoverBg",n("palette-grey-700")),tW(t.Chip,"defaultBorder",n("palette-grey-700")),tW(t.Chip,"defaultAvatarColor",n("palette-grey-300")),tW(t.Chip,"defaultIconColor",n("palette-grey-300")),tW(t.FilledInput,"bg","rgba(255, 255, 255, 0.09)"),tW(t.FilledInput,"hoverBg","rgba(255, 255, 255, 0.13)"),tW(t.FilledInput,"disabledBg","rgba(255, 255, 255, 0.12)"),tW(t.LinearProgress,"primaryBg",r(eU,t.primary.main,.5)),tW(t.LinearProgress,"secondaryBg",r(eU,t.secondary.main,.5)),tW(t.LinearProgress,"errorBg",r(eU,t.error.main,.5)),tW(t.LinearProgress,"infoBg",r(eU,t.info.main,.5)),tW(t.LinearProgress,"successBg",r(eU,t.success.main,.5)),tW(t.LinearProgress,"warningBg",r(eU,t.warning.main,.5)),tW(t.Skeleton,"bg",_?r(Qq,t.text.primary,.13):"rgba(".concat(n("palette-text-primaryChannel")," / 0.13)")),tW(t.Slider,"primaryTrack",r(eU,t.primary.main,.5)),tW(t.Slider,"secondaryTrack",r(eU,t.secondary.main,.5)),tW(t.Slider,"errorTrack",r(eU,t.error.main,.5)),tW(t.Slider,"infoTrack",r(eU,t.info.main,.5)),tW(t.Slider,"successTrack",r(eU,t.success.main,.5)),tW(t.Slider,"warningTrack",r(eU,t.warning.main,.5));const e=_?r(nU,t.background.default,.985):rU(t.background.default,.98);tW(t.SnackbarContent,"bg",e),tW(t.SnackbarContent,"color",oW((()=>_?fU.text.primary:t.getContrastText(e)))),tW(t.SpeedDialAction,"fabHoverBg",rU(t.background.paper,.15)),tW(t.StepConnector,"border",n("palette-grey-600")),tW(t.StepContent,"border",n("palette-grey-600")),tW(t.Switch,"defaultColor",n("palette-grey-300")),tW(t.Switch,"defaultDisabledColor",n("palette-grey-600")),tW(t.Switch,"primaryDisabledColor",r(eU,t.primary.main,.55)),tW(t.Switch,"secondaryDisabledColor",r(eU,t.secondary.main,.55)),tW(t.Switch,"errorDisabledColor",r(eU,t.error.main,.55)),tW(t.Switch,"infoDisabledColor",r(eU,t.info.main,.55)),tW(t.Switch,"successDisabledColor",r(eU,t.success.main,.55)),tW(t.Switch,"warningDisabledColor",r(eU,t.warning.main,.55)),tW(t.TableCell,"border",r(eU,r(Qq,t.divider,1),.68)),tW(t.Tooltip,"bg",r(Qq,t.grey[700],.92))}rW(t.background,"default"),rW(t.background,"paper"),rW(t.common,"background"),rW(t.common,"onBackground"),rW(t,"divider"),Object.keys(t).forEach((e=>{const n=t[e];"tonalOffset"!==e&&n&&"object"===typeof n&&(n.main&&tW(t[e],"mainChannel",Kq(nW(n.main))),n.light&&tW(t[e],"lightChannel",Kq(nW(n.light))),n.dark&&tW(t[e],"darkChannel",Kq(nW(n.dark))),n.contrastText&&tW(t[e],"contrastTextChannel",Kq(nW(n.contrastText))),"text"===e&&(rW(t[e],"primary"),rW(t[e],"secondary")),"action"===e&&(n.active&&rW(t[e],"active"),n.selected&&rW(t[e],"selected")))}))}));for(var x=arguments.length,k=new Array(x>1?x-1:0),C=1;C<x;C++)k[C-1]=arguments[C];w=k.reduce(((e,t)=>DV(e,t)),w);const D={prefix:o,disableCssColorScheme:r,shouldSkipGeneratingVar:i,getSelector:QU(w),enableContrastVars:a},{vars:S,generateThemeVars:E,generateStyleSheets:T}=DU(w,D);return w.vars=S,Object.entries(w.colorSchemes[w.defaultColorScheme]).forEach((e=>{let[t,n]=e;w[t]=n})),w.generateThemeVars=E,w.generateStyleSheets=T,w.generateSpacing=function(){return zq(c.spacing,GV(this))},w.getColorSchemeSelector=function(e){return function(t){return"media"===e?"@media (prefers-color-scheme: ".concat(t,")"):e?e.startsWith("data-")&&!e.includes("%s")?"[".concat(e,'="').concat(t,'"] &'):"class"===e?".".concat(t," &"):"data"===e?"[data-".concat(t,"] &"):"".concat(e.replace("%s",t)," &"):"&"}}(s),w.spacing=w.generateSpacing(),w.shouldSkipGeneratingVar=i,w.unstable_sxConfig=so(so({},Sq),null===c||void 0===c?void 0:c.unstable_sxConfig),w.unstable_sx=function(e){return Tq({sx:e,theme:this})},w.toRuntimeSource=VU,w}const sW=["palette","cssVariables","colorSchemes","defaultColorScheme"];function lW(e,t,n){e.colorSchemes&&n&&(e.colorSchemes[t]=so(so({},!0!==n&&n),{},{palette:yU(so(so({},!0===n?{}:n.palette),{},{mode:t}))}))}function cW(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{palette:t,cssVariables:n=!1,colorSchemes:r=(t?void 0:{light:!0}),defaultColorScheme:o=(null===t||void 0===t?void 0:t.mode)}=e,a=Kc(e,sW),i=o||"light",s=null===r||void 0===r?void 0:r[i],l=so(so({},r),t?{[i]:so(so({},"boolean"!==typeof s&&s),{},{palette:t})}:void 0);for(var c=arguments.length,u=new Array(c>1?c-1:0),d=1;d<c;d++)u[d-1]=arguments[d];if(!1===n){if(!("colorSchemes"in e))return GU(e,...u);let n=t;"palette"in e||l[i]&&(!0!==l[i]?n=l[i].palette:"dark"===i&&(n={mode:"dark"}));const r=GU(so(so({},e),{},{palette:n}),...u);return r.defaultColorScheme=i,r.colorSchemes=l,"light"===r.palette.mode&&(r.colorSchemes.light=so(so({},!0!==l.light&&l.light),{},{palette:r.palette}),lW(r,"dark",l.dark)),"dark"===r.palette.mode&&(r.colorSchemes.dark=so(so({},!0!==l.dark&&l.dark),{},{palette:r.palette}),lW(r,"light",l.light)),r}return t||"light"in l||"light"!==i||(l.light=!0),iW(so(so({},a),{},{colorSchemes:l,defaultColorScheme:i},"boolean"!==typeof n&&n),...u)}const uW="$$material",dW={active:"active",checked:"checked",completed:"completed",disabled:"disabled",error:"error",expanded:"expanded",focused:"focused",focusVisible:"focusVisible",open:"open",readOnly:"readOnly",required:"required",selected:"selected"};function pW(e,t){const n=dW[t];return n?"".concat(arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Mui","-").concat(n):"".concat(Uq.generate(e),"-").concat(t)}function hW(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Mui";const r={};return t.forEach((t=>{r[t]=pW(e,t,n)})),r}const fW=hW("MuiBox",["root"]),mW=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{themeId:t,defaultTheme:n,defaultClassName:r="MuiBox-root",generateClassName:o}=e,i=_V("div",{shouldForwardProp:e=>"theme"!==e&&"sx"!==e&&"as"!==e})(Tq);return a.forwardRef((function(e,a){const s=Rq(n),l=Mq(e),{className:c,component:u="div"}=l,d=Kc(l,Vq);return(0,EL.jsx)(i,so({as:u,ref:a,className:qL(c,o?o(r):r),theme:t&&s[t]||s},d))}))}({themeId:uW,defaultTheme:cW(),defaultClassName:fW.root,generateClassName:Uq.generate}),gW=mW;const _W=a.createContext();function vW(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const r=a.useRef(void 0),o=a.useCallback((e=>{const n=t.map((t=>{if(null==t)return null;if("function"===typeof t){const n=t,r=n(e);return"function"===typeof r?r:()=>{n(null)}}return t.current=e,()=>{t.current=null}}));return()=>{n.forEach((e=>null===e||void 0===e?void 0:e()))}}),t);return a.useMemo((()=>t.every((e=>null==e))?null:e=>{r.current&&(r.current(),r.current=void 0),null!=e&&(r.current=o(e))}),t)}const yW=function(e){return"string"===typeof e};const wW=function(e,t,n){return void 0===e||yW(e)?t:so(so({},t),{},{ownerState:so(so({},t.ownerState),n)})};const bW=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(void 0===e)return{};const n={};return Object.keys(e).filter((n=>n.match(/^on[A-Z]/)&&"function"===typeof e[n]&&!t.includes(n))).forEach((t=>{n[t]=e[t]})),n};const xW=function(e){if(void 0===e)return{};const t={};return Object.keys(e).filter((t=>!(t.match(/^on[A-Z]/)&&"function"===typeof e[t]))).forEach((n=>{t[n]=e[n]})),t};const kW=function(e){const{getSlotProps:t,additionalProps:n,externalSlotProps:r,externalForwardedProps:o,className:a}=e;if(!t){const e=qL(null===n||void 0===n?void 0:n.className,a,null===o||void 0===o?void 0:o.className,null===r||void 0===r?void 0:r.className),t=so(so(so({},null===n||void 0===n?void 0:n.style),null===o||void 0===o?void 0:o.style),null===r||void 0===r?void 0:r.style),i=so(so(so({},n),o),r);return e.length>0&&(i.className=e),Object.keys(t).length>0&&(i.style=t),{props:i,internalRef:void 0}}const i=bW(so(so({},o),r)),s=xW(r),l=xW(o),c=t(i),u=qL(null===c||void 0===c?void 0:c.className,null===n||void 0===n?void 0:n.className,a,null===o||void 0===o?void 0:o.className,null===r||void 0===r?void 0:r.className),d=so(so(so(so({},null===c||void 0===c?void 0:c.style),null===n||void 0===n?void 0:n.style),null===o||void 0===o?void 0:o.style),null===r||void 0===r?void 0:r.style),p=so(so(so(so({},c),n),l),s);return u.length>0&&(p.className=u),Object.keys(d).length>0&&(p.style=d),{props:p,internalRef:c.ref}};const CW=function(e,t,n){return"function"===typeof e?e(t,n):e},DW=["elementType","externalSlotProps","ownerState","skipResolvingSlotProps"];const SW=function(e){var t;const{elementType:n,externalSlotProps:r,ownerState:o,skipResolvingSlotProps:a=!1}=e,i=Kc(e,DW),s=a?{}:CW(r,o),{props:l,internalRef:c}=kW(so(so({},i),{},{externalSlotProps:s})),u=vW(c,null===s||void 0===s?void 0:s.ref,null===(t=e.additionalProps)||void 0===t?void 0:t.ref);return wW(n,so(so({},l),{},{ref:u}),o)};function EW(e){return e&&e.ownerDocument||document}const TW="undefined"!==typeof window?a.useLayoutEffect:a.useEffect;const AW=function(e){const t=a.useRef(e);return TW((()=>{t.current=e})),a.useRef((function(){return(0,t.current)(...arguments)})).current};function MW(e){try{return e.matches(":focus-visible")}catch(t){0}return!1}const FW={border:0,clip:"rect(0 0 0 0)",height:"1px",margin:"-1px",overflow:"hidden",padding:0,position:"absolute",whiteSpace:"nowrap",width:"1px"};const IW=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:(e,t)=>e===t;return e.length===t.length&&e.every(((e,r)=>n(e,t[r])))};function PW(e,t,n,r,o){return 1===n?Math.min(e+t,o):Math.max(e-t,r)}function zW(e,t){return e-t}function OW(e,t){var n;const{index:r}=null!==(n=e.reduce(((e,n,r)=>{const o=Math.abs(t-n);return null===e||o<e.distance||o===e.distance?{distance:o,index:r}:e}),null))&&void 0!==n?n:{};return r}function NW(e,t){if(void 0!==t.current&&e.changedTouches){const n=e;for(let e=0;e<n.changedTouches.length;e+=1){const r=n.changedTouches[e];if(r.identifier===t.current)return{x:r.clientX,y:r.clientY}}return!1}return{x:e.clientX,y:e.clientY}}function BW(e,t,n){return 100*(e-t)/(n-t)}function jW(e,t,n){const r=Math.round((e-n)/t)*t+n;return Number(r.toFixed(function(e){if(Math.abs(e)<1){const t=e.toExponential().split("e-"),n=t[0].split(".")[1];return(n?n.length:0)+parseInt(t[1],10)}const t=e.toString().split(".")[1];return t?t.length:0}(t)))}function LW(e){let{values:t,newValue:n,index:r}=e;const o=t.slice();return o[r]=n,o.sort(zW)}function RW(e){var t,n;let{sliderRef:r,activeIndex:o,setActive:a}=e;const i=EW(r.current);var s;null!==(t=r.current)&&void 0!==t&&t.contains(i.activeElement)&&Number(null===i||void 0===i||null===(n=i.activeElement)||void 0===n?void 0:n.getAttribute("data-index"))===o||(null===(s=r.current)||void 0===s||s.querySelector('[type="range"][data-index="'.concat(o,'"]')).focus());a&&a(o)}function VW(e,t){return"number"===typeof e&&"number"===typeof t?e===t:"object"===typeof e&&"object"===typeof t&&IW(e,t)}const qW={horizontal:{offset:e=>({left:"".concat(e,"%")}),leap:e=>({width:"".concat(e,"%")})},"horizontal-reverse":{offset:e=>({right:"".concat(e,"%")}),leap:e=>({width:"".concat(e,"%")})},vertical:{offset:e=>({bottom:"".concat(e,"%")}),leap:e=>({height:"".concat(e,"%")})}},UW=e=>e;let WW;function GW(){return void 0===WW&&(WW="undefined"===typeof CSS||"function"!==typeof CSS.supports||CSS.supports("touch-action","none")),WW}function HW(e){const{"aria-labelledby":t,defaultValue:n,disabled:r=!1,disableSwap:o=!1,isRtl:i=!1,marks:s=!1,max:l=100,min:c=0,name:u,onChange:d,onChangeCommitted:p,orientation:h="horizontal",rootRef:f,scale:m=UW,step:g=1,shiftStep:_=10,tabIndex:v,value:y}=e,w=a.useRef(void 0),[b,x]=a.useState(-1),[k,C]=a.useState(-1),[D,S]=a.useState(!1),E=a.useRef(0),T=a.useRef(null),[A,M]=function(e){const{controlled:t,default:n,name:r,state:o="value"}=e,{current:i}=a.useRef(void 0!==t),[s,l]=a.useState(n);return[i?t:s,a.useCallback((e=>{i||l(e)}),[])]}({controlled:y,default:null!==n&&void 0!==n?n:c,name:"Slider"}),F=d&&((e,t,n)=>{const r=e.nativeEvent||e,o=new r.constructor(r.type,r);Object.defineProperty(o,"target",{writable:!0,value:{value:t,name:u}}),T.current=t,d(o,t,n)}),I=Array.isArray(A);let P=I?A.slice().sort(zW):[A];P=P.map((e=>null==e?c:Wq(e,c,l)));const z=!0===s&&null!==g?[...Array(Math.floor((l-c)/g)+1)].map(((e,t)=>({value:c+g*t}))):s||[],O=z.map((e=>e.value)),[N,B]=a.useState(-1),j=a.useRef(null),L=vW(f,j),R=e=>t=>{var n;const r=Number(t.currentTarget.getAttribute("data-index"));MW(t.target)&&B(r),C(r),null===e||void 0===e||null===(n=e.onFocus)||void 0===n||n.call(e,t)},V=e=>t=>{var n;MW(t.target)||B(-1),C(-1),null===e||void 0===e||null===(n=e.onBlur)||void 0===n||n.call(e,t)},q=(e,t)=>{const n=Number(e.currentTarget.getAttribute("data-index")),r=P[n],a=O.indexOf(r);let i=t;if(z&&null==g){const e=O[O.length-1];i=i>=e?e:i<=O[0]?O[0]:i<r?O[a-1]:O[a+1]}if(i=Wq(i,c,l),I){o&&(i=Wq(i,P[n-1]||-1/0,P[n+1]||1/0));const e=i;i=LW({values:P,newValue:i,index:n});let t=n;o||(t=i.indexOf(e)),RW({sliderRef:j,activeIndex:t})}var s;(M(i),B(n),F&&!VW(i,A)&&F(e,i,n),p)&&p(e,null!==(s=T.current)&&void 0!==s?s:i)},U=e=>t=>{var n;if(["ArrowUp","ArrowDown","ArrowLeft","ArrowRight","PageUp","PageDown","Home","End"].includes(t.key)){t.preventDefault();const e=Number(t.currentTarget.getAttribute("data-index")),n=P[e];let r=null;if(null!=g){const e=t.shiftKey?_:g;switch(t.key){case"ArrowUp":r=PW(n,e,1,c,l);break;case"ArrowRight":r=PW(n,e,i?-1:1,c,l);break;case"ArrowDown":r=PW(n,e,-1,c,l);break;case"ArrowLeft":r=PW(n,e,i?1:-1,c,l);break;case"PageUp":r=PW(n,_,1,c,l);break;case"PageDown":r=PW(n,_,-1,c,l);break;case"Home":r=c;break;case"End":r=l}}else if(z){const e=O[O.length-1],o=O.indexOf(n),a=[i?"ArrowLeft":"ArrowRight","ArrowUp","PageUp","End"];[i?"ArrowRight":"ArrowLeft","ArrowDown","PageDown","Home"].includes(t.key)?r=0===o?O[0]:O[o-1]:a.includes(t.key)&&(r=o===O.length-1?e:O[o+1])}null!=r&&q(t,r)}null===e||void 0===e||null===(n=e.onKeyDown)||void 0===n||n.call(e,t)};TW((()=>{var e;r&&j.current.contains(document.activeElement)&&(null===(e=document.activeElement)||void 0===e||e.blur())}),[r]),r&&-1!==b&&x(-1),r&&-1!==N&&B(-1);const W=a.useRef(void 0);let G=h;i&&"horizontal"===h&&(G+="-reverse");const H=e=>{let{finger:t,move:n=!1}=e;const{current:r}=j,{width:a,height:i,bottom:s,left:u}=r.getBoundingClientRect();let d,p;if(d=G.startsWith("vertical")?(s-t.y)/i:(t.x-u)/a,G.includes("-reverse")&&(d=1-d),p=function(e,t,n){return(n-t)*e+t}(d,c,l),g)p=jW(p,g,c);else{const e=OW(O,p);p=O[e]}p=Wq(p,c,l);let h=0;if(I){h=n?W.current:OW(P,p),o&&(p=Wq(p,P[h-1]||-1/0,P[h+1]||1/0));const e=p;p=LW({values:P,newValue:p,index:h}),o&&n||(h=p.indexOf(e),W.current=h)}return{newValue:p,activeIndex:h}},K=AW((e=>{const t=NW(e,w);if(!t)return;if(E.current+=1,"mousemove"===e.type&&0===e.buttons)return void Z(e);const{newValue:n,activeIndex:r}=H({finger:t,move:!0});RW({sliderRef:j,activeIndex:r,setActive:x}),M(n),!D&&E.current>2&&S(!0),F&&!VW(n,A)&&F(e,n,r)})),Z=AW((e=>{const t=NW(e,w);if(S(!1),!t)return;const{newValue:n}=H({finger:t,move:!0});var r;(x(-1),"touchend"===e.type&&C(-1),p)&&p(e,null!==(r=T.current)&&void 0!==r?r:n);w.current=void 0,X()})),$=AW((e=>{if(r)return;GW()||e.preventDefault();const t=e.changedTouches[0];null!=t&&(w.current=t.identifier);const n=NW(e,w);if(!1!==n){const{newValue:t,activeIndex:r}=H({finger:n});RW({sliderRef:j,activeIndex:r,setActive:x}),M(t),F&&!VW(t,A)&&F(e,t,r)}E.current=0;const o=EW(j.current);o.addEventListener("touchmove",K,{passive:!0}),o.addEventListener("touchend",Z,{passive:!0})})),X=a.useCallback((()=>{const e=EW(j.current);e.removeEventListener("mousemove",K),e.removeEventListener("mouseup",Z),e.removeEventListener("touchmove",K),e.removeEventListener("touchend",Z)}),[Z,K]);a.useEffect((()=>{const{current:e}=j;return e.addEventListener("touchstart",$,{passive:GW()}),()=>{e.removeEventListener("touchstart",$),X()}}),[X,$]),a.useEffect((()=>{r&&X()}),[r,X]);const J=BW(I?P[0]:c,c,l),Q=BW(P[P.length-1],c,l)-J,Y=e=>t=>{var n;null===(n=e.onMouseLeave)||void 0===n||n.call(e,t),C(-1)};let ee;"vertical"===h&&(ee=i?"vertical-rl":"vertical-lr");return{active:b,axis:G,axisProps:qW,dragging:D,focusedThumbIndex:N,getHiddenInputProps:function(){var n;let o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const a=bW(o),s={onChange:(d=a||{},e=>{var t;null===(t=d.onChange)||void 0===t||t.call(d,e),q(e,e.target.valueAsNumber)}),onFocus:R(a||{}),onBlur:V(a||{}),onKeyDown:U(a||{})};var d;const p=so(so({},a),s);return so(so(so({tabIndex:v,"aria-labelledby":t,"aria-orientation":h,"aria-valuemax":m(l),"aria-valuemin":m(c),name:u,type:"range",min:e.min,max:e.max,step:null===e.step&&e.marks?"any":null!==(n=e.step)&&void 0!==n?n:void 0,disabled:r},o),p),{},{style:so(so({},FW),{},{direction:i?"rtl":"ltr",width:"100%",height:"100%",writingMode:ee})})},getRootProps:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=bW(e),n={onMouseDown:(o=t||{},e=>{var t;if(null===(t=o.onMouseDown)||void 0===t||t.call(o,e),r)return;if(e.defaultPrevented)return;if(0!==e.button)return;e.preventDefault();const n=NW(e,w);if(!1!==n){const{newValue:t,activeIndex:r}=H({finger:n});RW({sliderRef:j,activeIndex:r,setActive:x}),M(t),F&&!VW(t,A)&&F(e,t,r)}E.current=0;const a=EW(j.current);a.addEventListener("mousemove",K,{passive:!0}),a.addEventListener("mouseup",Z)})};var o;const a=so(so({},t),n);return so(so({},e),{},{ref:L},a)},getThumbProps:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=bW(e),n={onMouseOver:(r=t||{},e=>{var t;null===(t=r.onMouseOver)||void 0===t||t.call(r,e);const n=Number(e.currentTarget.getAttribute("data-index"));C(n)}),onMouseLeave:Y(t||{})};var r;return so(so(so({},e),t),n)},marks:z,open:k,range:I,rootRef:L,trackLeap:Q,trackOffset:J,values:P,getThumbStyle:e=>({pointerEvents:-1!==b&&b!==e?"none":void 0})}}const KW=["variants"];function ZW(e){const{variants:t}=e,n=Kc(e,KW),r={variants:t,style:yV(n),isProcessed:!0};return r.style===n||t&&t.forEach((e=>{"function"!==typeof e.style&&(e.style=yV(e.style))})),r}const $W=["variants"],XW=["name","slot","skipVariantsResolver","skipSx","overridesResolver"],JW=Bq();function QW(e){return"ownerState"!==e&&"theme"!==e&&"sx"!==e&&"as"!==e}function YW(e,t){return t&&e&&"object"===typeof e&&e.styles&&!e.styles.startsWith("@layer")&&(e.styles="@layer ".concat(t,"{").concat(String(e.styles),"}")),e}function eG(e){return e?(t,n)=>n[e]:null}function tG(e,t,n){const r="function"===typeof t?t(e):t;if(Array.isArray(r))return r.flatMap((t=>tG(e,t,n)));if(Array.isArray(null===r||void 0===r?void 0:r.variants)){let t;if(r.isProcessed)t=n?YW(r.style,n):r.style;else{const{variants:e}=r,o=Kc(r,$W);t=n?YW(yV(o),n):o}return nG(e,r.variants,[t],n)}return null!==r&&void 0!==r&&r.isProcessed?n?YW(yV(r.style),n):r.style:n?YW(yV(r),n):r}function nG(e,t){let n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:void 0;e:for(let i=0;i<t.length;i+=1){const s=t[i];if("function"===typeof s.props){if(null!==n&&void 0!==n||(n=so(so(so({},e),e.ownerState),{},{ownerState:e.ownerState})),!s.props(n))continue}else for(const t in s.props){var a;if(e[t]!==s.props[t]&&(null===(a=e.ownerState)||void 0===a?void 0:a[t])!==s.props[t])continue e}"function"===typeof s.style?(null!==n&&void 0!==n||(n=so(so(so({},e),e.ownerState),{},{ownerState:e.ownerState})),r.push(o?YW(yV(s.style(n)),o):s.style(n))):r.push(o?YW(yV(s.style),o):s.style)}return r}function rG(e,t){}function oG(e){return e?e.charAt(0).toLowerCase()+e.slice(1):e}const aG=cW();const iG=function(e){return"ownerState"!==e&&"theme"!==e&&"sx"!==e&&"as"!==e},sG=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{themeId:t,defaultTheme:n=JW,rootShouldForwardProp:r=QW,slotShouldForwardProp:o=QW}=e;function a(e){!function(e,t,n){e.theme=function(e){for(const t in e)return!1;return!0}(e.theme)?n:e.theme[t]||e.theme}(e,t,n)}return function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!function(e,t){Array.isArray(e.__emotion_styles)&&(e.__emotion_styles=t(e.__emotion_styles))}(e,(e=>e.filter((e=>e!==Tq))));const{name:n,slot:i,skipVariantsResolver:s,skipSx:l,overridesResolver:c=eG(oG(i))}=t,u=Kc(t,XW),d=n&&n.startsWith("Mui")||i?"components":"custom",p=void 0!==s?s:i&&"Root"!==i&&"root"!==i||!1,h=l||!1;let f=QW;"Root"===i||"root"===i?f=r:i?f=o:function(e){return"string"===typeof e&&e.charCodeAt(0)>96}(e)&&(f=void 0);const m=_V(e,so({shouldForwardProp:f,label:rG(n,i)},u)),g=e=>{if(e.__emotion_real===e)return e;if("function"===typeof e)return function(t){return tG(t,e,t.theme.modularCssLayers?d:void 0)};if(kV(e)){const t=ZW(e);return function(e){return t.variants?tG(e,t,e.theme.modularCssLayers?d:void 0):e.theme.modularCssLayers?YW(t.style,d):t.style}}return e},_=function(){const t=[];for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];const s=o.map(g),l=[];if(t.push(a),n&&c&&l.push((function(e){var t;const r=null===(t=e.theme.components)||void 0===t||null===(t=t[n])||void 0===t?void 0:t.styleOverrides;if(!r)return null;const o={};for(const n in r)o[n]=tG(e,r[n],e.theme.modularCssLayers?"theme":void 0);return c(e,o)})),n&&!p&&l.push((function(e){var t;const r=e.theme,o=null===r||void 0===r||null===(t=r.components)||void 0===t||null===(t=t[n])||void 0===t?void 0:t.variants;return o?nG(e,o,[],e.theme.modularCssLayers?"theme":void 0):null})),h||l.push(Tq),Array.isArray(s[0])){const e=s.shift(),n=new Array(t.length).fill(""),r=new Array(l.length).fill("");let o;o=[...n,...e,...r],o.raw=[...n,...e.raw,...r],t.unshift(o)}const u=[...t,...s,...l],d=m(...u);return e.muiName&&(d.muiName=e.muiName),d};return m.withConfig&&(_.withConfig=m.withConfig),_}}({themeId:uW,defaultTheme:aG,rootShouldForwardProp:e=>iG(e)&&"classes"!==e}),lG=sG,cG={theme:void 0};const uG=function(e){let t,n;return function(r){let o=t;return void 0!==o&&r.theme===n||(cG.theme=r.theme,o=ZW(e(cG)),t=o,n=r.theme),o}},dG=uG;function pG(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=so({},t);for(const o in e)if(Object.prototype.hasOwnProperty.call(e,o)){const a=o;if("components"===a||"slots"===a)r[a]=so(so({},e[a]),r[a]);else if("componentsProps"===a||"slotProps"===a){const o=e[a],i=t[a];if(i)if(o){r[a]=so({},i);for(const e in o)if(Object.prototype.hasOwnProperty.call(o,e)){const t=e;r[a][t]=pG(o[t],i[t],n)}}else r[a]=i;else r[a]=o||{}}else"className"===a&&n&&t.className?r.className=qL(null===e||void 0===e?void 0:e.className,null===t||void 0===t?void 0:t.className):"style"===a&&n&&t.style?r.style=so(so({},null===e||void 0===e?void 0:e.style),null===t||void 0===t?void 0:t.style):void 0===r[a]&&(r[a]=e[a])}return r}const hG=a.createContext(void 0);function fG(e){let{props:t,name:n}=e;return function(e){const{theme:t,name:n,props:r}=e;if(!t||!t.components||!t.components[n])return r;const o=t.components[n];return o.defaultProps?pG(o.defaultProps,r,t.components.mergeClassNameAndStyle):o.styleOverrides||o.variants?r:pG(o,r,t.components.mergeClassNameAndStyle)}({props:t,name:n,theme:{components:a.useContext(hG)}})}const mG=e=>!e||!yW(e),gG=bV;function _G(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return t=>{let[,n]=t;return n&&function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(!function(e){return"string"===typeof e.main}(e))return!1;for(const n of t)if(!e.hasOwnProperty(n)||"string"!==typeof e[n])return!1;return!0}(n,e)}}function vG(e){return pW("MuiSlider",e)}const yG=hW("MuiSlider",["root","active","colorPrimary","colorSecondary","colorError","colorInfo","colorSuccess","colorWarning","disabled","dragging","focusVisible","mark","markActive","marked","markLabel","markLabelActive","rail","sizeSmall","thumb","thumbColorPrimary","thumbColorSecondary","thumbColorError","thumbColorSuccess","thumbColorInfo","thumbColorWarning","track","trackInverted","trackFalse","thumbSizeSmall","valueLabel","valueLabelOpen","valueLabelCircle","valueLabelLabel","vertical"]);const wG=["aria-label","aria-valuetext","aria-labelledby","component","components","componentsProps","color","classes","className","disableSwap","disabled","getAriaLabel","getAriaValueText","marks","max","min","name","onChange","onChangeCommitted","orientation","shiftStep","size","step","scale","slotProps","slots","tabIndex","track","value","valueLabelDisplay","valueLabelFormat"];function bG(e){return e}const xG=lG("span",{name:"MuiSlider",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,t["color".concat(gG(n.color))],"medium"!==n.size&&t["size".concat(gG(n.size))],n.marked&&t.marked,"vertical"===n.orientation&&t.vertical,"inverted"===n.track&&t.trackInverted,!1===n.track&&t.trackFalse]}})(dG((e=>{let{theme:t}=e;return{borderRadius:12,boxSizing:"content-box",display:"inline-block",position:"relative",cursor:"pointer",touchAction:"none",WebkitTapHighlightColor:"transparent","@media print":{colorAdjust:"exact"},["&.".concat(yG.disabled)]:{pointerEvents:"none",cursor:"default",color:(t.vars||t).palette.grey[400]},["&.".concat(yG.dragging)]:{["& .".concat(yG.thumb,", & .").concat(yG.track)]:{transition:"none"}},variants:[...Object.entries(t.palette).filter(_G()).map((e=>{let[n]=e;return{props:{color:n},style:{color:(t.vars||t).palette[n].main}}})),{props:{orientation:"horizontal"},style:{height:4,width:"100%",padding:"13px 0","@media (pointer: coarse)":{padding:"20px 0"}}},{props:{orientation:"horizontal",size:"small"},style:{height:2}},{props:{orientation:"horizontal",marked:!0},style:{marginBottom:20}},{props:{orientation:"vertical"},style:{height:"100%",width:4,padding:"0 13px","@media (pointer: coarse)":{padding:"0 20px"}}},{props:{orientation:"vertical",size:"small"},style:{width:2}},{props:{orientation:"vertical",marked:!0},style:{marginRight:44}}]}}))),kG=lG("span",{name:"MuiSlider",slot:"Rail"})({display:"block",position:"absolute",borderRadius:"inherit",backgroundColor:"currentColor",opacity:.38,variants:[{props:{orientation:"horizontal"},style:{width:"100%",height:"inherit",top:"50%",transform:"translateY(-50%)"}},{props:{orientation:"vertical"},style:{height:"100%",width:"inherit",left:"50%",transform:"translateX(-50%)"}},{props:{track:"inverted"},style:{opacity:1}}]}),CG=lG("span",{name:"MuiSlider",slot:"Track"})(dG((e=>{let{theme:t}=e;return{display:"block",position:"absolute",borderRadius:"inherit",border:"1px solid currentColor",backgroundColor:"currentColor",transition:t.transitions.create(["left","width","bottom","height"],{duration:t.transitions.duration.shortest}),variants:[{props:{size:"small"},style:{border:"none"}},{props:{orientation:"horizontal"},style:{height:"inherit",top:"50%",transform:"translateY(-50%)"}},{props:{orientation:"vertical"},style:{width:"inherit",left:"50%",transform:"translateX(-50%)"}},{props:{track:!1},style:{display:"none"}},...Object.entries(t.palette).filter(_G()).map((e=>{let[n]=e;return{props:{color:n,track:"inverted"},style:so({},t.vars?{backgroundColor:t.vars.palette.Slider["".concat(n,"Track")],borderColor:t.vars.palette.Slider["".concat(n,"Track")]}:so(so({backgroundColor:t.lighten(t.palette[n].main,.62),borderColor:t.lighten(t.palette[n].main,.62)},t.applyStyles("dark",{backgroundColor:t.darken(t.palette[n].main,.5)})),t.applyStyles("dark",{borderColor:t.darken(t.palette[n].main,.5)})))}}))]}}))),DG=lG("span",{name:"MuiSlider",slot:"Thumb",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.thumb,t["thumbColor".concat(gG(n.color))],"medium"!==n.size&&t["thumbSize".concat(gG(n.size))]]}})(dG((e=>{let{theme:t}=e;return{position:"absolute",width:20,height:20,boxSizing:"border-box",borderRadius:"50%",outline:0,backgroundColor:"currentColor",display:"flex",alignItems:"center",justifyContent:"center",transition:t.transitions.create(["box-shadow","left","bottom"],{duration:t.transitions.duration.shortest}),"&::before":{position:"absolute",content:'""',borderRadius:"inherit",width:"100%",height:"100%",boxShadow:(t.vars||t).shadows[2]},"&::after":{position:"absolute",content:'""',borderRadius:"50%",width:42,height:42,top:"50%",left:"50%",transform:"translate(-50%, -50%)"},["&.".concat(yG.disabled)]:{"&:hover":{boxShadow:"none"}},variants:[{props:{size:"small"},style:{width:12,height:12,"&::before":{boxShadow:"none"}}},{props:{orientation:"horizontal"},style:{top:"50%",transform:"translate(-50%, -50%)"}},{props:{orientation:"vertical"},style:{left:"50%",transform:"translate(-50%, 50%)"}},...Object.entries(t.palette).filter(_G()).map((e=>{let[n]=e;return{props:{color:n},style:{["&:hover, &.".concat(yG.focusVisible)]:{boxShadow:"0px 0px 0px 8px ".concat(t.alpha((t.vars||t).palette[n].main,.16)),"@media (hover: none)":{boxShadow:"none"}},["&.".concat(yG.active)]:{boxShadow:"0px 0px 0px 14px ".concat(t.alpha((t.vars||t).palette[n].main,.16))}}}}))]}}))),SG=lG((function(e){const{children:t,className:n,value:r}=e,o=(e=>{const{open:t}=e;return{offset:qL(t&&yG.valueLabelOpen),circle:yG.valueLabelCircle,label:yG.valueLabelLabel}})(e);return t?a.cloneElement(t,{className:t.props.className},(0,EL.jsxs)(a.Fragment,{children:[t.props.children,(0,EL.jsx)("span",{className:qL(o.offset,n),"aria-hidden":!0,children:(0,EL.jsx)("span",{className:o.circle,children:(0,EL.jsx)("span",{className:o.label,children:r})})})]})):null}),{name:"MuiSlider",slot:"ValueLabel"})(dG((e=>{let{theme:t}=e;return so(so({zIndex:1,whiteSpace:"nowrap"},t.typography.body2),{},{fontWeight:500,transition:t.transitions.create(["transform"],{duration:t.transitions.duration.shortest}),position:"absolute",backgroundColor:(t.vars||t).palette.grey[600],borderRadius:2,color:(t.vars||t).palette.common.white,display:"flex",alignItems:"center",justifyContent:"center",padding:"0.25rem 0.75rem",variants:[{props:{orientation:"horizontal"},style:{transform:"translateY(-100%) scale(0)",top:"-10px",transformOrigin:"bottom center","&::before":{position:"absolute",content:'""',width:8,height:8,transform:"translate(-50%, 50%) rotate(45deg)",backgroundColor:"inherit",bottom:0,left:"50%"},["&.".concat(yG.valueLabelOpen)]:{transform:"translateY(-100%) scale(1)"}}},{props:{orientation:"vertical"},style:{transform:"translateY(-50%) scale(0)",right:"30px",top:"50%",transformOrigin:"right center","&::before":{position:"absolute",content:'""',width:8,height:8,transform:"translate(-50%, -50%) rotate(45deg)",backgroundColor:"inherit",right:-8,top:"50%"},["&.".concat(yG.valueLabelOpen)]:{transform:"translateY(-50%) scale(1)"}}},{props:{size:"small"},style:{fontSize:t.typography.pxToRem(12),padding:"0.25rem 0.5rem"}},{props:{orientation:"vertical",size:"small"},style:{right:"20px"}}]})}))),EG=lG("span",{name:"MuiSlider",slot:"Mark",shouldForwardProp:e=>iG(e)&&"markActive"!==e,overridesResolver:(e,t)=>{const{markActive:n}=e;return[t.mark,n&&t.markActive]}})(dG((e=>{let{theme:t}=e;return{position:"absolute",width:2,height:2,borderRadius:1,backgroundColor:"currentColor",variants:[{props:{orientation:"horizontal"},style:{top:"50%",transform:"translate(-1px, -50%)"}},{props:{orientation:"vertical"},style:{left:"50%",transform:"translate(-50%, 1px)"}},{props:{markActive:!0},style:{backgroundColor:(t.vars||t).palette.background.paper,opacity:.8}}]}}))),TG=lG("span",{name:"MuiSlider",slot:"MarkLabel",shouldForwardProp:e=>iG(e)&&"markLabelActive"!==e})(dG((e=>{let{theme:t}=e;return so(so({},t.typography.body2),{},{color:(t.vars||t).palette.text.secondary,position:"absolute",whiteSpace:"nowrap",variants:[{props:{orientation:"horizontal"},style:{top:30,transform:"translateX(-50%)","@media (pointer: coarse)":{top:40}}},{props:{orientation:"vertical"},style:{left:36,transform:"translateY(50%)","@media (pointer: coarse)":{left:44}}},{props:{markLabelActive:!0},style:{color:(t.vars||t).palette.text.primary}}]})}))),AG=e=>{let{children:t}=e;return t},MG=a.forwardRef((function(e,t){var n,r,o,i,s,l,c,u,d,p,h,f,m,g,_,v,y,w,b,x,k,C,D,S;const E=fG({props:e,name:"MuiSlider"});const T=(()=>{const e=a.useContext(_W);return null!==e&&void 0!==e&&e})(),{"aria-label":A,"aria-valuetext":M,"aria-labelledby":F,component:I="span",components:P={},componentsProps:z={},color:O="primary",classes:N,className:B,disableSwap:j=!1,disabled:L=!1,getAriaLabel:R,getAriaValueText:V,marks:q=!1,max:U=100,min:W=0,name:G,onChange:H,onChangeCommitted:K,orientation:Z="horizontal",shiftStep:$=10,size:X="medium",step:J=1,scale:Q=bG,slotProps:Y,slots:ee,tabIndex:te,track:ne="normal",value:re,valueLabelDisplay:oe="off",valueLabelFormat:ae=bG}=E,ie=Kc(E,wG),se=so(so({},E),{},{isRtl:T,max:U,min:W,classes:N,disabled:L,disableSwap:j,orientation:Z,marks:q,color:O,size:X,step:J,shiftStep:$,scale:Q,track:ne,valueLabelDisplay:oe,valueLabelFormat:ae}),{axisProps:le,getRootProps:ce,getHiddenInputProps:ue,getThumbProps:de,open:pe,active:he,axis:fe,focusedThumbIndex:me,range:ge,dragging:_e,marks:ve,values:ye,trackOffset:we,trackLeap:be,getThumbStyle:xe}=HW(so(so({},se),{},{rootRef:t}));se.marked=ve.length>0&&ve.some((e=>e.label)),se.dragging=_e,se.focusedThumbIndex=me;const ke=(e=>{const{disabled:t,dragging:n,marked:r,orientation:o,track:a,classes:i,color:s,size:l}=e;return function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;const r={};for(const o in e){const a=e[o];let i="",s=!0;for(let e=0;e<a.length;e+=1){const r=a[e];r&&(i+=(!0===s?"":" ")+t(r),s=!1,n&&n[r]&&(i+=" "+n[r]))}r[o]=i}return r}({root:["root",t&&"disabled",n&&"dragging",r&&"marked","vertical"===o&&"vertical","inverted"===a&&"trackInverted",!1===a&&"trackFalse",s&&"color".concat(gG(s)),l&&"size".concat(gG(l))],rail:["rail"],track:["track"],mark:["mark"],markActive:["markActive"],markLabel:["markLabel"],markLabelActive:["markLabelActive"],valueLabel:["valueLabel"],thumb:["thumb",t&&"disabled",l&&"thumbSize".concat(gG(l)),s&&"thumbColor".concat(gG(s))],active:["active"],disabled:["disabled"],focusVisible:["focusVisible"]},vG,i)})(se),Ce=null!==(n=null!==(r=null===ee||void 0===ee?void 0:ee.root)&&void 0!==r?r:P.Root)&&void 0!==n?n:xG,De=null!==(o=null!==(i=null===ee||void 0===ee?void 0:ee.rail)&&void 0!==i?i:P.Rail)&&void 0!==o?o:kG,Se=null!==(s=null!==(l=null===ee||void 0===ee?void 0:ee.track)&&void 0!==l?l:P.Track)&&void 0!==s?s:CG,Ee=null!==(c=null!==(u=null===ee||void 0===ee?void 0:ee.thumb)&&void 0!==u?u:P.Thumb)&&void 0!==c?c:DG,Te=null!==(d=null!==(p=null===ee||void 0===ee?void 0:ee.valueLabel)&&void 0!==p?p:P.ValueLabel)&&void 0!==d?d:SG,Ae=null!==(h=null!==(f=null===ee||void 0===ee?void 0:ee.mark)&&void 0!==f?f:P.Mark)&&void 0!==h?h:EG,Me=null!==(m=null!==(g=null===ee||void 0===ee?void 0:ee.markLabel)&&void 0!==g?g:P.MarkLabel)&&void 0!==m?m:TG,Fe=null!==(_=null!==(v=null===ee||void 0===ee?void 0:ee.input)&&void 0!==v?v:P.Input)&&void 0!==_?_:"input",Ie=null!==(y=null===Y||void 0===Y?void 0:Y.root)&&void 0!==y?y:z.root,Pe=null!==(w=null===Y||void 0===Y?void 0:Y.rail)&&void 0!==w?w:z.rail,ze=null!==(b=null===Y||void 0===Y?void 0:Y.track)&&void 0!==b?b:z.track,Oe=null!==(x=null===Y||void 0===Y?void 0:Y.thumb)&&void 0!==x?x:z.thumb,Ne=null!==(k=null===Y||void 0===Y?void 0:Y.valueLabel)&&void 0!==k?k:z.valueLabel,Be=null!==(C=null===Y||void 0===Y?void 0:Y.mark)&&void 0!==C?C:z.mark,je=null!==(D=null===Y||void 0===Y?void 0:Y.markLabel)&&void 0!==D?D:z.markLabel,Le=null!==(S=null===Y||void 0===Y?void 0:Y.input)&&void 0!==S?S:z.input,Re=SW({elementType:Ce,getSlotProps:ce,externalSlotProps:Ie,externalForwardedProps:ie,additionalProps:so({},mG(Ce)&&{as:I}),ownerState:so(so({},se),null===Ie||void 0===Ie?void 0:Ie.ownerState),className:[ke.root,B]}),Ve=SW({elementType:De,externalSlotProps:Pe,ownerState:se,className:ke.rail}),qe=SW({elementType:Se,externalSlotProps:ze,additionalProps:{style:so(so({},le[fe].offset(we)),le[fe].leap(be))},ownerState:so(so({},se),null===ze||void 0===ze?void 0:ze.ownerState),className:ke.track}),Ue=SW({elementType:Ee,getSlotProps:de,externalSlotProps:Oe,ownerState:so(so({},se),null===Oe||void 0===Oe?void 0:Oe.ownerState),className:ke.thumb}),We=SW({elementType:Te,externalSlotProps:Ne,ownerState:so(so({},se),null===Ne||void 0===Ne?void 0:Ne.ownerState),className:ke.valueLabel}),Ge=SW({elementType:Ae,externalSlotProps:Be,ownerState:se,className:ke.mark}),He=SW({elementType:Me,externalSlotProps:je,ownerState:se,className:ke.markLabel}),Ke=SW({elementType:Fe,getSlotProps:ue,externalSlotProps:Le,ownerState:se});return(0,EL.jsxs)(Ce,so(so({},Re),{},{children:[(0,EL.jsx)(De,so({},Ve)),(0,EL.jsx)(Se,so({},qe)),ve.filter((e=>e.value>=W&&e.value<=U)).map(((e,t)=>{const n=BW(e.value,W,U),r=le[fe].offset(n);let o;return o=!1===ne?ye.includes(e.value):"normal"===ne&&(ge?e.value>=ye[0]&&e.value<=ye[ye.length-1]:e.value<=ye[0])||"inverted"===ne&&(ge?e.value<=ye[0]||e.value>=ye[ye.length-1]:e.value>=ye[0]),(0,EL.jsxs)(a.Fragment,{children:[(0,EL.jsx)(Ae,so(so(so({"data-index":t},Ge),!yW(Ae)&&{markActive:o}),{},{style:so(so({},r),Ge.style),className:qL(Ge.className,o&&ke.markActive)})),null!=e.label?(0,EL.jsx)(Me,so(so(so({"aria-hidden":!0,"data-index":t},He),!yW(Me)&&{markLabelActive:o}),{},{style:so(so({},r),He.style),className:qL(ke.markLabel,He.className,o&&ke.markLabelActive),children:e.label})):null]},t)})),ye.map(((e,t)=>{const n=BW(e,W,U),r=le[fe].offset(n),o="off"===oe?AG:Te;return(0,EL.jsx)(o,so(so(so({},!yW(o)&&{valueLabelFormat:ae,valueLabelDisplay:oe,value:"function"===typeof ae?ae(Q(e),t):ae,index:t,open:pe===t||he===t||"on"===oe,disabled:L}),We),{},{children:(0,EL.jsx)(Ee,so(so({"data-index":t},Ue),{},{className:qL(ke.thumb,Ue.className,he===t&&ke.active,me===t&&ke.focusVisible),style:so(so(so({},r),xe(t)),Ue.style),children:(0,EL.jsx)(Fe,so({"data-index":t,"aria-label":R?R(t):A,"aria-valuenow":Q(e),"aria-labelledby":F,"aria-valuetext":V?V(Q(e),t):M,value:ye[t]},Ke))}))}),t)}))]}))})),FG=MG;class IG extends a.Component{constructor(){super(...arguments),this.state={expanded:!1,generatingSimilar:!1,similarPrompts:[]},this.toggleExpanded=()=>{this.setState((e=>({expanded:!e.expanded})))},this.handleGenerateSimilar=async()=>{var e;const t=(null===(e=document.querySelector(".similarity-input-".concat(this.props.promptIndex)))||void 0===e?void 0:e.value)||"";this.setState({generatingSimilar:!0,similarPrompts:[]});try{const e=await CL.generateSimilarPrompts(this.props.prompt.text,t,this.props.prompt.temp);this.setState({similarPrompts:e,generatingSimilar:!1})}catch(n){console.error("Error generating similar prompts:",n),this.setState({generatingSimilar:!1})}},this.handlePromptSelect=e=>{CL.addPrompt(e)}}render(){const{prompt:e,promptIndex:t,onUpdateText:n,onUpdateTemp:r,onUpdateModelFamily:o,onUpdateModel:a,onDelete:i,onToggleDisabled:s,isDisabled:l,totalPrompts:c}=this.props,{expanded:u,generatingSimilar:d,similarPrompts:p}=this.state,h=CL.getPromptColor(t);return(0,EL.jsxs)("div",{className:"compare-prompt-container ".concat(l?"disabled":""),style:{backgroundColor:l?"#f0f0f0":h,color:l?"#666":"black",borderColor:l?"#ccc":h,opacity:l?.6:1},children:[(0,EL.jsxs)("div",{className:"controls-row",children:[(0,EL.jsx)("div",{className:"expand-caret",onClick:this.toggleExpanded,children:(0,EL.jsx)("span",{className:"material-icons ".concat(u?"expanded":""),children:u?"expand_less":"expand_more"})}),(0,EL.jsxs)("div",{className:"input-header",children:["Prompt ",t+1]}),(0,EL.jsx)(PG,{value:e.text||"",options:Object.keys(lo),onSubmit:e=>n(t,e)},"prompt-"+t+"-"+(e.text||"")),(0,EL.jsxs)("div",{className:"slider-container",children:[(0,EL.jsxs)("label",{children:["Temperature: ",e.temp]}),(0,EL.jsx)(gW,{sx:{width:150},children:(0,EL.jsx)(FG,{size:"small",min:0,max:1,step:.1,value:e.temp,onChange:(e,n)=>r(t,n),valueLabelDisplay:"auto","aria-label":"Temperature",disabled:l})})]}),(0,EL.jsxs)("div",{className:"dropdown-container",children:[(0,EL.jsx)("label",{children:"Model Family:"}),(0,EL.jsx)("select",{value:e.modelFamily,onChange:e=>o(t,e.target.value),disabled:l,children:_L.map((e=>(0,EL.jsx)("option",{value:e.id,children:e.name},e.id)))})]}),(0,EL.jsxs)("div",{className:"dropdown-container",children:[(0,EL.jsx)("label",{children:"Model:"}),(0,EL.jsx)("select",{value:e.model,onChange:e=>a(t,e.target.value),disabled:l,children:yL(e.modelFamily).map((e=>(0,EL.jsx)("option",{value:e.id,children:e.name},e.id)))})]}),c>1&&(0,EL.jsxs)(EL.Fragment,{children:[(0,EL.jsx)("button",{className:"toggle-disabled-button",onClick:()=>s(t),title:l?"Enable this prompt":"Disable this prompt",children:(0,EL.jsx)("span",{className:"material-icons",children:l?"visibility":"visibility_off"})}),(0,EL.jsx)("button",{className:"delete-prompt-button",onClick:()=>i(t),title:"Delete this prompt",children:(0,EL.jsx)("span",{className:"material-icons",children:"close"})})]})]}),u&&(0,EL.jsxs)("div",{className:"generate-similar-container",children:[(0,EL.jsxs)("div",{className:"controls-row",children:[(0,EL.jsx)("button",{className:"generate-similar-button",onClick:this.handleGenerateSimilar,disabled:d,children:"generate similar prompts"}),(0,EL.jsx)("div",{className:"similarity-input-container",children:(0,EL.jsxs)("div",{className:"input-with-hint",children:[(0,EL.jsx)("input",{type:"text",className:"input-field similarity-input-".concat(t),placeholder:"Optionally specify what aspect of the input you care about, e.g., 'about food', 'asking for advice', 'formal tone'",onKeyDown:e=>{"Enter"===e.key&&e.target.blur()}}),(0,EL.jsxs)("span",{className:"enter-hint",children:[(0,EL.jsx)("span",{className:"material-icons",children:"keyboard_return"})," Enter"]})]})})]}),p.length>0&&(0,EL.jsx)("div",{className:"controls-row",children:(0,EL.jsx)("div",{className:"similar-prompts-table-container",children:(0,EL.jsxs)("table",{className:"similar-prompts-table",children:[(0,EL.jsx)("thead",{children:(0,EL.jsx)("tr",{children:(0,EL.jsx)("th",{children:"Prompt"})})}),(0,EL.jsx)("tbody",{children:p.map(((e,t)=>(0,EL.jsx)("tr",{className:"clickable-row",onClick:()=>this.handlePromptSelect(e),children:(0,EL.jsx)("td",{children:e})},t)))})]})})}),d&&(0,EL.jsx)("div",{className:"similar-prompts-table-container",children:(0,EL.jsxs)("table",{className:"similar-prompts-table",children:[(0,EL.jsx)("thead",{children:(0,EL.jsx)("tr",{children:(0,EL.jsx)("th",{children:"Prompt"})})}),(0,EL.jsx)("tbody",{children:(0,EL.jsx)("tr",{children:(0,EL.jsxs)("td",{className:"loading-cell",children:[(0,EL.jsx)("span",{className:"loader"}),(0,EL.jsx)("span",{children:"Generating similar prompts..."})]})})})]})})]})]})}}class PG extends a.Component{constructor(){super(...arguments),this.state={open:!1,value:this.props.value||""},this.handleClickOutside=e=>{this.dropdownRef.current&&!this.dropdownRef.current.contains(e.target)&&this.setState({open:!1})},this.handleKeyDown=e=>{"Escape"===e.key&&this.setState({open:!1})},this.dropdownRef=a.createRef(),this.handleInputChange=e=>{this.setState({value:e.target.value})},this.handleInputKeyDown=e=>{var t,n;"Enter"===e.key&&(null===(t=(n=this.props).onSubmit)||void 0===t||t.call(n,this.state.value),this.setState({open:!1}))},this.handleSelect=e=>{this.setState({value:e,open:!1},(()=>{var t,n;null===(t=(n=this.props).onSubmit)||void 0===t||t.call(n,e)}))}}componentDidMount(){document.addEventListener("click",this.handleClickOutside),document.addEventListener("keydown",this.handleKeyDown)}componentWillUnmount(){document.removeEventListener("click",this.handleClickOutside),document.removeEventListener("keydown",this.handleKeyDown)}render(){const{options:e}=this.props,{open:t,value:n}=this.state;return(0,EL.jsxs)("div",{className:"input-with-hint",ref:this.dropdownRef,children:[(0,EL.jsx)("input",{type:"text",className:"input-field",value:n,placeholder:"Enter or select a prompt",onChange:this.handleInputChange,onFocus:()=>this.setState({open:!0}),onKeyDown:this.handleInputKeyDown}),t&&(0,EL.jsx)("ul",{className:"dropdown-list",children:e.map((e=>(0,EL.jsx)("li",{onClick:()=>this.handleSelect(e),title:e,children:e},e)))}),(0,EL.jsxs)("span",{className:"enter-hint",children:[(0,EL.jsx)("span",{className:"material-icons",children:"keyboard_return"})," Enter"]})]})}}const zG=IG,OG=Object.keys(lo)[0],NG=150;class BG extends a.Component{constructor(){var e,t;super(...arguments),this.state={selectedExample:OG,temperature:null!==(e=null===(t=CL.prompts[0])||void 0===t?void 0:t.temp)&&void 0!==e?e:.7,numGenerations:CL.numGenerations,similarityThreshold:CL.similarityThreshold,minOpacityThreshold:CL.minOpacityThreshold,spread:CL.spread,shuffle:CL.shuffle,tokenizeMode:CL.tokenizeMode},this.handleSliderChange=(e,t)=>{this.state[t]=e,this.setState({})},this.handleCheckboxChange=(e,t)=>{this.state[t]=e.target.checked,this.setState({})},this.handleDropdownChange=(e,t)=>{this.state[t]=e.target.value,this.setState({})},this.handleSubmit=e=>{const t=null!==e&&void 0!==e?e:this.state.selectedExample;this.setState({selectedExample:t}),CL.updatePromptTempAt(0,this.state.temperature),CL.setNumGenerations(this.state.numGenerations),CL.updatePromptTextAt(0,t)},this.handlePromptSelect=e=>{this.setState({selectedExample:e}),CL.updatePromptTextAt(0,e),CL.updatePromptTempAt(0,this.state.temperature),CL.setNumGenerations(this.state.numGenerations),CL.fetchGenerationsFor(0)}}render(){return(0,EL.jsxs)("div",{className:"single-input-holder",children:[(0,EL.jsx)("div",{className:"controls",children:(0,EL.jsxs)("div",{className:"controls-row",children:[(0,EL.jsx)("label",{children:(0,EL.jsx)("b",{children:"Global Controls"})}),(0,EL.jsxs)("div",{className:"slider-container",children:[(0,EL.jsxs)("label",{children:["Samples: ",this.state.numGenerations]}),(0,EL.jsx)("div",{className:"tooltip",children:"Number of Generations controls how many different responses the LLM will generate for the same prompt. More generations help visualize the diversity of possible responses."}),(0,EL.jsx)(gW,{sx:{width:NG},children:(0,EL.jsx)(FG,{size:"small",min:1,max:50,step:1,value:this.state.numGenerations,onChange:(e,t)=>this.handleSliderChange(t,"numGenerations"),onChangeCommitted:()=>CL.setNumGenerations(this.state.numGenerations),valueLabelDisplay:"auto","aria-label":"Number of Generations"})})]}),(0,EL.jsxs)("div",{className:"slider-container",children:[(0,EL.jsx)("label",{children:"Merging coefficient"}),(0,EL.jsx)("div",{className:"tooltip",children:"Controls how similar words need to be to be merged in the graph. Lower values merge more words together, higher values keep more words separate."}),(0,EL.jsx)(gW,{sx:{width:NG},children:(0,EL.jsx)(FG,{size:"small",min:0,max:1,step:.1,value:this.state.similarityThreshold,onChange:(e,t)=>this.handleSliderChange(t,"similarityThreshold"),onChangeCommitted:()=>CL.setSimilarityThreshold(this.state.similarityThreshold),valueLabelDisplay:"auto","aria-label":"Merging coefficient"})})]}),(0,EL.jsxs)("div",{className:"slider-container",children:[(0,EL.jsx)("label",{children:"Hide Rare Outputs"}),(0,EL.jsx)("div",{className:"tooltip",children:"Adjust how strongly rare outputs are faded. Higher values hide nodes and edges that appear infrequently across outputs."}),(0,EL.jsx)(gW,{sx:{width:NG},children:(0,EL.jsx)(FG,{size:"small",min:0,max:1,step:.1,value:this.state.minOpacityThreshold,onChange:(e,t)=>this.handleSliderChange(t,"minOpacityThreshold"),onChangeCommitted:()=>CL.setMinOpacityThreshold(this.state.minOpacityThreshold),valueLabelDisplay:"off","aria-label":"Hide Rare Outputs"})})]}),(0,EL.jsxs)("div",{className:"slider-container",children:[(0,EL.jsx)("label",{children:"Graph spread"}),(0,EL.jsx)("div",{className:"tooltip",children:"Controls how spread out the graph is. Higher values means every output is rendered more like standard LTR text, lower values means the graph is more compact."}),(0,EL.jsx)(gW,{sx:{width:NG},children:(0,EL.jsx)(FG,{size:"small",min:0,max:1,step:.1,value:this.state.spread,onChange:(e,t)=>this.handleSliderChange(t,"spread"),onChangeCommitted:()=>CL.setSpread(this.state.spread),valueLabelDisplay:"off","aria-label":"Graph spread"})})]}),(0,EL.jsxs)("div",{className:"dropdown-container",children:[(0,EL.jsx)("label",{children:"Tokenize Mode:"}),(0,EL.jsxs)("select",{value:this.state.tokenizeMode,onChange:e=>{this.handleDropdownChange(e,"tokenizeMode"),CL.setTokenizeMode(e.target.value)},children:[(0,EL.jsx)("option",{value:"space",children:"Space"}),(0,EL.jsx)("option",{value:"comma",children:"Comma"}),(0,EL.jsx)("option",{value:"sentence",children:"Sentence"})]})]})]})}),CL.prompts.map(((e,t)=>(0,EL.jsx)(zG,{promptIndex:t,prompt:e,onUpdateText:CL.updatePromptTextAt,onUpdateTemp:CL.updatePromptTempAt,onUpdateModelFamily:CL.updatePromptModelFamilyAt,onUpdateModel:CL.updatePromptModelAt,onDelete:CL.removePromptAt,onToggleDisabled:CL.togglePromptDisabled,isDisabled:CL.isPromptDisabled(t),totalPrompts:CL.prompts.length},"prompt-"+t))),(0,EL.jsx)("div",{className:"add-prompt-container",onClick:()=>CL.addPrompt(""),children:(0,EL.jsx)("div",{className:"controls-row",style:{width:"fit-content"},children:(0,EL.jsx)("div",{className:"input-header",children:(0,EL.jsx)("span",{className:"material-icons",children:"add"})})})}),CL.loading?this.renderLoading():(0,EL.jsx)(RL,{})]})}renderLoading(){return(0,EL.jsx)("span",{className:"loader"})}async componentDidMount(){CL.updatePromptTextAt(0,OG)}}const jG=no(BG);const LG=function(){return(0,EL.jsx)(jG,{})};s.createRoot(document.getElementById("root")).render((0,EL.jsx)(a.StrictMode,{children:(0,EL.jsx)(LG,{})}))})();
//# sourceMappingURL=main.6f073e7f.js.map